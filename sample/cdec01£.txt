      *%CSTD===========================================================*
      ** Application. : EMAGE      Logiciel métier DS Smith            *
      ** Composant. . : CDEC01£                       Type: RPG        *
      **===============================================================*
      ** Sous-système :                                                *
      ** Fonction . . :                                                *
      ** Sous-fonction:                                                *
      **%S=============================================================*
      ** Description des fonctionnalités:                              *
      **                                                               *
      **                                                               *
      **                                                               *
      **%E=============================================================*
      ** AUTEUR:                          00:00                        *
      ** MODIFS: 03 TMACOI     29/03/2024 14:11  98.08.01 FM 24/   61  *
      **           Besoin alerte credit client                         *
      **         03 TMACOI     29/03/2024 14:11  98.08.01 FM 24/   62  *
      **           Ajout Alerte dépassement crédit client              *
      **         02 TMALRE     01/10/2020 16:31  01.04.07 FM 24/   62  *
      **         01 TMAOCL     06/05/2020 15:12  01.03.26 FM 24/   62  *
      *%ECSTD==========================================================*
     *****************************************
     *                                       *
     * SAISIE DES COMMANDES CLIENTS DU JOUR  *
     *                                       *
     ************************************************************************
     **  HISTORIQUE                                                         *
     **                                                                     *
     **  AUTEUR !    DATE    ! OBJET DE LA MODIFICATION                     *
     ** --------!------------!--------------------------------------------- *
     ** PHILIPPE! 13-10-2014 ! Suppression du fichier Siècle                *
     **         !            ! Utilisation Fichier CALENS                   *
     **         !            ! pour détermnier le siècle                    *
     **NOUZIERES! 11-03-2015 ! Ajout d'une fenetre des observations clients *
     **BRUNEL   ! 31-03-2015 ! Code Incoterm                                *
     **NOUZIERES! 25-11-2016 ! PROTECTION DIVISION PAR ZEROS                *
     **MERLET   ! 21-09-2017 ! REMPLACER NICOLLET  PAR CONSUMER             *
     **TMAFBU   ! 05-10-2018 ! SEPARATION DES EXPEDITIONS DE LA             *
     **         !            ! FABRICATION PGM CDEC01£1                     *
     ************************************************************************
     FCDEC01D CF  E                    WORKSTN
     F                                        R1    KSFILE F7
     F                                        R2    KSFILE F9C
     F                                        R3    KSFILE F17
     F                                        R5    KSFILE F34
     F                                        R6    KSFILE F38
     F                                        R7    KSFILE F29
     F                                        RECNO KSFILE WGPS
     F                                        RECNO KSFILE F3WS
     F                                        RECNO KSFILE WAMLD
     *
     FPARAME  IF  E           K        DISK
     FCLIENTS1IF  E           K        DISK
     FCLISTAL1IF  E           K        DISK
     FCLIACHL7IF  E           K        DISK
     FCLIFACL4IF  E           K        DISK
     FCLIFACL3IF  E           K        DISK
     FCLILIVL3IF  E           K        DISK
     FPRODUI2 IF  E           K        DISK
     FPRODST2 IF  E           K        DISK
     FRECAPT  IF  E           K        DISK
     FPLAMAL1 IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FCALENAL2IF  E           K        DISK
     FCALENAL0IF  E           K        DISK
     F            CALENDF1                          KRENAMECALENDDD
     *---- Début ----- Philippe  ---- 13/10/2014 -----
     * - Mise en commentaire car utilisation variable système pour
     * déterminer le siècle
    F*SIECLE  IF  E           K        DISK
     *---- Fin   ----- Philippe  ---- 13/10/2014 -----
     FCLIOBIL1IF  E           K        DISK
     FCLIOBIL2IF  E           K        DISK
     F            CLIOBIF1                          KRENAMEZOBI
     FPREIMP2 IF  E           K        DISK
     FOBSPROL1IF  E           K        DISK
     FCODBARL1IF  E           K        DISK
     FCODBARL2IF  E           K        DISK
     F            CODBARF1                          KRENAMECODBAR2
     FCOMPREL1IF  E           K        DISK
     FCOMPREL5IF  E           K        DISK
     F            COMPREF1                          KRENAMECOMPREF2
    FCDES    O   E           K        DISK                      A
    FCDEOBS  O   E           K        DISK                      A
    FCDEXPO  O   E           K        DISK                      A
    FCDEMAT  O   E           K        DISK                      A
    FCARCDE  O   E           K        DISK                      A
    FCDESL1  UF  E           K        DISK
     F            CDESF1                            KRENAMECDEAAAAA
     FCDESL11 IF  E           K        DISK
     F            CDESF1                            KRENAMECDEBIDON
    FCDEOBSL1UF  E           K        DISK
     F            CDEOBSF1                          KRENAMECDEBBBBB
    FCDEXPOL1UF  E           K        DISK
     F            CDEXPOF1                          KRENAMECDECCCCC
    FCDEMATL1UF  E           K        DISK
     F            CDEMATF1                          KRENAMECDEDDDDD
    FCARCDEL1UF  E           K        DISK
     F            CARCDEF1                          KRENAMECDEEEEEE
     FLIEUSTL3IF  E           K        DISK                               PROD17
     FDEVISEL1IF  E           K        DISK                               PROD17
     FMNUUTIL1IF  E           K        DISK
     FREFSTKL1IF  E           K        DISK
     FCDENO   IF  E           K        DISK
     FCAISSEL1IF  E           K        DISK
     FPALETTL1IF  E           K        DISK
     FPRODS3L1IF  E           K        DISK
     FPRODST4 IF  E           K        DISK
     FCLICOML2IF  E           K        DISK
     FCLILOGL7IF  E           K        DISK
     FCLICOML1IF  E           K        DISK
     F            CLICOMF1                          KRENAMECLICOMF2
     FENCCLI  IF  E           K        DISK
     E                    TA         30  4 0
     E                    T1        160  1
     E                    TB         10  1
     E                    RE         10  1
     E                    EE         10  1
     E                    TABEX   1  22 10
     E                    TIM         7  1 0
     E                    TRE         7  1 0
     E                    COU         7  1
     E                    STO         8  9 0
     E                    STK         8  9 0 LIE     2
     E                    TI1     1  10 32
     E                    TI2     1   1 14
     E                    TBF        99  2 0
     E                    TBSI       99  2 0
     E                    TBIM       99  8 0
     E                    TBFA       99  8 0
     E                    TBEX       99  8 0
     E                    TBPX       99  2 0
     E                    TBPR       99  9 2
     E                    TBCD       99  7
     E                    TBSS       99  2 0
     E                    TBAD       99  2 0
     E                    TBSD       99  2 0
     E                    TBJD       99  1 0
     E                    TBBO       99  6 0
     E                    TBAF       99  2 0
     E                    TBAL       99  2 0
     E                    TSE        99  7
     E                    TER     1   3 11
     E                    TG      1   1 18
     E                    GAR     1  26  2
     E                    RDV         5  1
     E                    TAUG    1   6 60
     E                    TZO        10 15 2
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     ICLIOBIF1
     I              SEQACH                          SQSQ11
     I              RGFAC                           RGRG11
     I              RGLIV                           RGRG22
     IZOBI
     I              SEQACH                          SQSQ11
     I              RGFAC                           RGRG11
     I              RGLIV                           RGRG22
     ICLIENTF1
     I              CLIFOU                          FOUFOU
     ICLIFACF1
     I              CLIFOU                          FOUFOU
     ICLIFACF2
     I              STE                             STE999
     I              NOCLI                           NOC999
     I              RGFAC                           RGF999
     ICLILIVF1
     I              RECEP1                          RDV,1
     I              RECEP2                          RDV,2
     I              RECEP3                          RDV,3
     I              RECEP4                          RDV,4
     I              RECEP5                          RDV,5
     IMVTIMPF1
     I              UNITE                           TETETE
     I              NOCLI                           CLACLA
     I              NOPRO                           PROUT
     I              STE                             STSTST
     I              NCONF                           COU101
     ICLISTAF1
     I              GROUPE                          GROUPI
     IPRODUIF1
     I              AGENT                           NAGENT
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP1                           COU,1
     I              COUP2                           COU,2
     I              COUP3                           COU,3
     I              COUP4                           COU,4
     I              COUP5                           COU,5
     I              COUP6                           COU,6
     I              COUP7                           COU,7
     I              QTTOT                           TOTQT
     I              QTREN                           RENQ
     I              QTPRE                           PREQT
     I              QTFAB                           FAQTB
     I              MICLI                           TICLI
     I              MACLI                           TACLI
     I              TYPOR                           TYNPOR
     I              NCONF                           NCONFZ
     I              PROTO                           POTYPE
     I              NBLIV                           NNBLIV
     I              FRLIV                           FFRLIV
     I              STOCK2                          PTOCK2
     I              STOCK3                          PTOCK3
     I              STOCK4                          PTOCK4
     I              STOCK5                          PTOCK5
     I              STOCK6                          PTOCK6
     IPRODSTF2
     I              NOPRO                           WWPR
     I              BLOC1                           WWBL1
     I              BLOC2                           WWBL2
     IRECAPTF1
     I              AGENT                           RAGENT
     I              NCONF                           NCONFZ
     IPLAMAF1
     I              NOFOR                           FORTIC
     I              NCONF                           NCONFZ
     IOBSPROF1
     I              STE                             SSSS
     I              NOCLI                           NCLI
     I              NOPRO                           NPRO
     I              INICRE                          INICCC
     I              AA                              AA1111
     I              MM                              MM1111
     I              JJ                              JJ1111
     I              SEQOBS                          SEQ111
     I              NATOBS                          NAT111
     IF22
     I              XAPPS                           XAPPSS
     IF5
     I              COREGL                          COREG5
     I              CORECH                          COREC5
     I              FDM                             FDM5
     I              CORJOU                          CORJO5
     I              ESCPT                           ESCPT5
     I              AGIOS                           AGIOS5
     I              VALSUI                          VALSU5
     I              FACFOR                          FACFO5
     I              FACFRA                          FACFR5
     ICDEAAAAA
     I              NCONF                           COU101
     I              NOPRO                           COU102
     I              STE                             COU103
     I              NOCLI                           COU104
     I              CONFJ                           COU105
     I              CONFM                           COU106
     I              CONFA                           COU107
     I              CONFS                           COU107
     I              SEQSTA                          COU108
     I              SEQACH                          COU109
     I              CLIFOU                          COU110
     I              AGENT                           COU111
     I              GARNT                           COU112
     I              UVENT                           COU113
     I              USINE                           COU114
     I              TYPOR                           COU115
     I              PORAFA                          COU116
     I              PROTO                           COU118
     I              MICLI                           COU119
     I              MACLI                           COU120
     I              XAPPS                           COU121
     I              CODTA                           COU122
     I              CREGS                           COU123
     I              CECHES                          COU124
     I              JREGLS                          COU125
     I              ESCOMS                          COU126
     I              AGIOSS                          COU127
     I              FDMS                            COU128
     I              VALSUS                          COU129
     I              FACFRS                          COU130
     I              EXPFAS                          COU131
     I              CLIPRO                          COU132
     I              SANFAC                          COU133
     I              IMPSTO                          COU134
     I              PRESER                          COU135
     I              CDEPRE                          COU136
     I              BOBPDS                          COU137
     I              LIMULS                          COU138
     I              STIMP                           COU139
     I              STOND                           COU140
     I              STFAC                           COU141
     I              STASS                           COU142
     I              PRIUNS                          COU143
     I              PXS                             COU144
     I              QTOT                            COU145
     I              QTFAB                           COU146
     I              QTPRE                           COU147
     I              QTREN                           COU148
     I              NBLIV                           COU149
     I              FRLIV                           COU150
     I              PLANC                           COU151
     I              TAGBID                          COU152
     I              TAGREL                          COU153
     I              TAGMAJ                          COU154
     I              ARJ                             COU155
     I              ARM                             COU156
     I              ARA                             COU157
     I              ANULJ                           COU158
     I              ANULM                           COU159
     I              ANULA                           COU160
     I              TOTBOB                          COU161
     I              TAGCON                          COU162
     I              GROUPE                          GROOPE
     ICDEEEEEE
     I              STE                             CUO001
     I              NOCLI                           CUO002
     I              NOPRO                           CUO003
     I              NCONF                           CUO004
     I              SEQFAB                          CUO005
     I              SEQLIV                          CUO006
     I              ABRCLI                          CUO007
     I              GARNT                           CUO008
     I              UVENT                           CUO009
     I              SEQSTA                          CUO010
     I              AGENT                           CUO011
     I              USEXT                           CUO012
     I              USINT                           CUO013
     I              USINE                           CUO014
     I              CLIREF                          CUO015
     I              COMCLJ                          CUO016
     I              COMCLM                          CUO017
     I              COMCLA                          CUO018
     I              COMCLS                          CU0018
     I              CLIPRO                          CUO019
     I              RGFAC                           CUO020
     I              RGLIV                           CUO021
     I              NBEXP                           CUO022
     I              PUNIT                           CUO023
     I              PX                              CUO024
     I              QTIMP                           CUO025
     I              QTFAC                           CUO026
     I              QTDEXP                          CUO027
     I              JSDEL                           CUO028
     I              SEDEL                           CUO029
     I              ANDEL                           CUO030
     I              SSDEL                           CUO030
     I              MMDEL                           CUO031
     I              JJDEL                           CUO032
     I              NOJOUR                          CUO033
     I              CODEL                           CUO034
     I              DEPLIV                          CUO035
     I              PEXPA                           CUO036
     I              PEXPS                           CUO037
     I              PEXPJ                           CUO038
     I              EDIMPM                          CUO039
     I              EDIMPJ                          CUO040
     I              EDFABM                          CUO041
     I              EDFABJ                          CUO042
     I              EDEXPM                          CUO043
     I              EDEXPJ                          CUO044
     I              TOTEXP                          CUO045
     I              EXPEDJ                          CUO046
     I              EXPEDM                          CUO047
     I              EXPEDA                          CUO048
     I              SOLDE                           CUO049
     I              ANDEV                           CUO050
     I              ETUDE                           CUO051
     I              SEQDE                           CUO052
     I              NOFOR                           CUO053
     I              MOPOR                           CUO054
     I              TAGFA                           CUO055
     I              LANCIM                          CUO056
     I              LANCFA                          CUO057
     I              SEQIMP                          CUO058
     I              CDEPRE                          CUO059
     I              PRESER                          CUO060
     I              IMPSTO                          CUO061
     I              CONFJ                           CUO062
     I              CONFM                           CUO063
     I              CONFA                           CUO064
     I              CONFS                           CUO064
     I              TYPOR                           CUO065
     I              SANFAC                          CUO066
     I              PRIETR                          CUO067
     I              IMPD                            CUO068
     I              FABD                            CUO069
     I              EXPD                            CUO070
     I              NBRBOB                          CUO071
     I              SSDDEL                          CUO072
     I              ADEDEL                          CUO072
     I              SDEDEL                          CUO073
     I              JDEDEL                          CUO074
     I              GROUPE                          GROOPE
     ICDEBBBBB
     I              NCONF                           CUO101
     I              NOPRO                           CUO121
     I              STE                             CUO131
     I              NOCLI                           CUO141
     I              USINE                           CUO151
     I              TYPOBS                          CUO161
     I              SEQOBS                          CUO171
     I              OBSERV                          CUO181
     I              CODOBS                          CUO191
     ICDECCCCC
     I              NCONF                           CUO201
     I              NOPRO                           CUO202
     I              STE                             CUO203
     I              NOCLI                           CUO204
     I              USINE                           CUO205
     I              NOMTRA                          CUO206
     I              RAITRA                          CUO207
     I              RUETRA                          CUO208
     I              VILTRA                          CUO209
     I              DEPTRA                          CUO210
     I              CPTRA                           CUO211
     I              BDTRA                           CUO212
     I              CPAYTR                          CUO213
     I              PAYTRA                          CUO214
     I              CONDEX                          CUO215
     I              NBFAC                           CUO216
     I              EXPO1                           CUO221
     I              EXPO2                           CUO222
     ICDEDDDDD
     I              NCONF                           CUO301
     I              NOPRO                           CUO302
     I              STE                             CUO303
     I              NOCLI                           CUO304
     I              USINE                           CUO305
     I              CODMAT                          CUO306
     I              STATUM                          CUO307
     I              CODFAM                          CUO308
     I              MONMAT                          CUO309
     I              FRINCS                          CUO310
     I              MATSTE                          CUO321
     I              MATCLI                          CUO332
     I              MATFAC                          CUO343
     I              CLIMAT                          CUO354
     I              COMATJ                          CUO365
     I              COMATM                          CUO376
     I              COMATA                          CUO387
     I              COMATS                          CUO387
     ICDEBIDON
     I              NCONF                           KOU101
     I              NOPRO                           KOU102
     I              STE                             KOU103
     I              NOCLI                           KOU104
     I              CONFJ                           KOU105
     I              CONFM                           KOU106
     I              CONFA                           KOU107
     I              CONFS                           KOU107
     I              SEQSTA                          KOU108
     I              SEQACH                          KOU109
     I              CLIFOU                          KOU110
     I              AGENT                           KOU111
     I              GARNT                           KOU112
     I              UVENT                           KOU113
     I              USINE                           KOU114
     I              TYPOR                           KOU115
     I              PORAFA                          KOU116
     I              PROTO                           KOU118
     I              MICLI                           KOU119
     I              MACLI                           KOU120
     I              XAPPS                           KOU121
     I              CODTA                           KOU122
     I              CREGS                           KOU123
     I              CECHES                          KOU124
     I              JREGLS                          KOU125
     I              ESCOMS                          KOU126
     I              AGIOSS                          KOU127
     I              FDMS                            KOU128
     I              VALSUS                          KOU129
     I              FACFRS                          KOU130
     I              EXPFAS                          KOU131
     I              CLIPRO                          KOU132
     I              SANFAC                          KOU133
     I              IMPSTO                          KOU134
     I              PRESER                          KOU135
     I              CDEPRE                          KOU136
     I              BOBPDS                          KOU137
     I              LIMULS                          KOU138
     I              STIMP                           KOU139
     I              STOND                           KOU140
     I              STFAC                           KOU141
     I              STASS                           KOU142
     I              PRIUNS                          KOU143
     I              PXS                             KOU144
     I              QTOT                            KOU145
     I              QTFAB                           KOU146
     I              QTPRE                           KOU147
     I              QTREN                           KOU148
     I              NBLIV                           KOU149
     I              FRLIV                           KOU150
     I              PLANC                           KOU151
     I              TAGBID                          KOU152
     I              TAGREL                          KOU153
     I              TAGMAJ                          KOU154
     I              ARJ                             KOU155
     I              ARM                             KOU156
     I              ARA                             KOU157
     I              ANULJ                           KOU158
     I              ANULM                           KOU159
     I              ANULA                           KOU160
     I              TOTBOB                          KOU161
     I              TAGCON                          KOU162
     I              GROUPE                          KROOPE
     ICOMPREF1
     I              STE                             STEGAR
     I              NOCLI                           NOCLIG
     I              NOPRO                           NOPROZ
     I              GARNT                           GARGAR
     ICOMPREF2
     I              STE                             STEGAR
     I              NOCLI                           NOCLIG
     I              NOPRO                           LEPROD
     I              GARNT                           GARGAR
     *---- Début ----- Philippe  ---- 13/10/2014 -----
     * - Mis en commentaire car plus utilisé
    I**SIECLEF1
    I**              AA                              WWAA
     *---- Fin   ----- Philippe  ---- 13/10/2014 -----
     IREFSTKF1
     I              GROUPE                          GRPP
     I              CODMON                          CMON
     I              SEQSTA                          SSSSTA
     IDEVISEF1
     I              CODMON                          CODM
     ICODBARF1
     I              STE                             STE999
     I              NOCLI                           NOC999
     I              NOPRO                           PRO999
     I/EJECT
     **
    I*****************************************************
    I* DEFINITION DES DATA SRUCTURES
    I*****************************************************
    I*
     IDSPARM      DS
     I                                        1   1 USAISI
     I            DS
     I                                        1 256 DSCOMM
     I                                        1   10STE
     I                                        2   50NOCLI
     I                                        6   70AGENT
     I                                        8   90INDUS
     I                                       10  110RGFAC
     I                                       12  130RGLIV
     I                                       14  150SEQACH
     I                                       16  190NOPOUT
     I                                       22  22 ZONE95
     I                                       23  23 ZONE96
     I                                       24  24 ZONE97
     I                                       25  290NOFOR
     I                                       30  300SEQSTA
     I                                       31 246 INUTIL
     I                                      247 256 LIBSEL
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 EXTERIEUR
    I******************************************************
     I            DS
     I                                        1  22 DSEXT
     I I            0                         1   10STMEXX
     I                                        2   4 FACMEX
     I I            0                         5  100MONMAT
     I                                       11  11 TTA
     I I            0                        12  152FRINCS
     I I            0                        16  160MATSTE
     I I            0                        17  200MATCLI
     I I            0                        21  220MATFAC
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 INTERIEUR
    I******************************************************
     I            DS
     I                                        1  22 DSINT
     I I            0                         1   10STMINX
     I                                        2   4 FACMIN
     I I            0                         5  100MONMAI
     I                                       11  11 TTB
     I I            0                        12  152FRINCI
     I I            0                        16  160MATSTI
     I I            0                        17  200MATCIN
     I I            0                        21  220MATFAI
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 DORURE
    I***************************************************
     I            DS
     I                                        1  22 DSDOR
     I I            0                         1   10STMGOX
     I                                        2   4 FACMDO
     I I            0                         5  100MONMAD
     I                                       11  11 TTE
     I I            0                        12  152FRINCD
     I I            0                        16  160MATSTD
     I I            0                        17  200MATCLD
     I I            0                        21  220MATFAD
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 GAUFRAGE
    I*****************************************************
     I            DS
     I                                        1  22 DSGAU
     I I            0                         1   10STMGAX
     I                                        2   4 FACMGA
     I I            0                         5  100MONMAG
     I                                       11  11 TTC
     I I            0                        12  152FRINCG
     I I            0                        16  160MATSTG
     I I            0                        17  200MATCLG
     I I            0                        21  220MATFAG
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 DECOUPAGE
    I******************************************************
     I            DS
     I                                        1  22 DSDEC
     I I            0                         1   10STMDEX
     I                                        2   4 FACMDE
     I I            0                         5  100MONMDE
     I                                       11  11 TTD
     I I            0                        12  152FRINDE
     I I            0                        16  160MATSDE
     I I            0                        17  200MATCLE
     I I            0                        21  220MATFAE
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 GENERALE POUR TESTS
    I****************************************************************
     I            DS
     I                                        1  22 DSGEN
     I I            0                         1   10STMGEN
     I                                        2   4 FACGEN
     I I            0                         5  100MONGEN
     I                                       11  11 TTG
     I I            0                        12  152FRIGEN
     I I            0                        16  160MATGE1
     I I            0                        17  200MATGE2
     I I            0                        21  220MATGE3
     I            DS
     I I            0                         5   60SEQFAB
     I I            0                         7   80SEQIMP
     I I            0                         9  100SSDEL
     I I            0                        11  120ANDEL
     I                                        9  120SADEL
     I I            0                        13  140SEDEL
     I I            0                        15  150JSDEL
     I                                       16  17 CODEL
     I I            0                        18  240QTIMP
     I I            0                        25  310QTFAC
     I I            0                        32  380QTEXP
     I I            0                        39  440NBOBI
     * ZONE NBEXP SUPRIMEE DU FORMAT (FEVRIER 91)
     I I            0                        49  490NBEXP
     I I            0                        50  582PUNITX
     I I            0                        59  600PX
     I                                        6  60 DSCAD1
     ITSET        DS                              7
     I I            0                         1   20TSEIMP
     I I            0                         3   40TSEFAB
     I                                        5   70TSERAN
     ITSET1       DS                              7
     I I            0                         1   20TSEIM1
     I I            0                         3   40TSEFA1
     I I            0                         5   70TSERA1
     IZUN5        DS                              5
     I I            0                         1   20IMPRE9
     I I            0                         3   40FABRI9
     I            DS
     I                                        1   20SCDE
     I                                        3   40ACDE
     I                                        5   60MCDE
     I                                        7   80JCDE
     I I            0                         1   80DSCDE
     I            DS
     I                                        1   20SYEA
     I                                        3   40UYEA
     I                                        5   60UMONT
     I                                        7   80UDAI
     I I            0                         1   80DATSYS
     I                                        1   40SUYEA
     *
     I            DS
     I                                        1   40UYEM6
     I                                        5   60UMOM6
     I                                        7   80UDAM6
     I I            0                         1   80DATM6
     I            DS
     I                                        1   20COMCLS
     I                                        3   40COMCLA
     I                                        5   60COMCLM
     I                                        7   80COMCLJ
     I I            0                         1   80DACOMM
     I            DS
     I                                        1   20SSEDEL
     I                                        3   40ANEDEL
     I                                        5   60SEMDEL
     I                                        7   70JOUDEL
     I I            0                         1   70TESDEL
     I            DS
     I                                        1   20SS1DEL
     I                                        3   40AN1DEL
     I                                        5   60SE1DEL
     I                                        7   70JO1DEL
     I I            0                         1   70TE1DEL
     I            DS
     I                                        1   20CALSS
     I                                        3   40CALAA
     I                                        5   60CALMM
     I                                        7   80CALJJ
     I I            0                         1   80DATCAL
     *
     IDS13£       DS                             22
     I I            0                         1   10ST13£
     I I            0                         2   50CLI13£
     I I            0                         6   90ANP13£
     I I            0                        12  130RGL13£
     I I            0                        16  190PRO13£
     *
     I            DS                             10
     I I            'AA'                      1   2 AA10
     I I            0                         3   60NOC10
     I I            0                         7  100NOP10
     I                                        1  10 PARM10
     *
     IPARM65      DS                             11
     I                                        1   1 PARM0
     I I            0                         2   20STENO
     I I            0                         3   60CLINO
     *
     IPARM17      DS                             10
     I                                        1   1 PARM1
     I I            0                         2   20STEN1
     I I            0                         3   60ETUDE
     I I            0                         7  100SEQDE
     *
     IPARM27      DS
     I                                        1   1 £STE
     I                                        2   5 £NOCLI
     I                                        6   9 £NOPRO
     I                                       10  13 £TAUX
     *
     I£PARAM      DS                            200
     I I            0                         1   10£STE2
     I I            0                         2   50£NOCL2
     I I            0                         6   90£NOPR2
     I I            0                        10  132£WINC2
     I                                       14  14 £ERR
     *
     IDTPARM      DS                            164
     I                                        1 150 TZO
     I                                      151 153 DORIG
     I                                      154 156 DDEST
     I                                      157 1635CRS
     I                                      164 164 COEFF
     *
     IPRODU6      DS
     I I            'M'                       1   1 MAJ
     I                                        2   20STE60
     I                                        3   60NOC60
     I                                        7  100NOP60
     *
     I            DS
     I                                        1  72 STO
     I                                        1   90STOCK1
     I                                       10  180STOCK2
     I                                       19  270STOCK3
     I                                       28  360STOCK4
     I                                       37  450STOCK5
     I                                       46  540STOCK6
     I                                       55  630STOCK7
     I                                       64  720STOCK8
     *
     I            DS
     I                                        1  72 STK
     I                                        1   90STOC1
     I                                       10  180STOC2
     I                                       19  270STOC3
     I                                       28  360STOC4
     I                                       37  450STOC5
     I                                       46  540STOC6
     I                                       55  630STOC7
     I                                       64  720STOC8
     *
     I            DS
     I                                        1  16 LIE
     I                                        1   2 LSTOC1
     I                                        3   4 LSTOC2
     I                                        5   6 LSTOC3
     I                                        7   8 LSTOC4
     I                                        9  10 LSTOC5
     I                                       11  12 LSTOC6
     I                                       13  14 LSTOC7
     I                                       15  16 LSTOC8
     IDSPA29      DS                              6
     I                                        1   10STE29
     I                                        2   50CLI29
     I                                        6   6 ANN29
     *  POUR APPEL DEV002£
     IDEV002      DS
     I                                        1   8 TBLNOM
     I                                        9  18 TBVAR
     I                                       19  200LG
     I                                       21  30 CODE
     I                                       31  80 LIBEL
     I                                       81  81 FICH
     I           SDS
     I                                      244 253 LIBUS
     I                                      254 263 USRNAM
     * POUR APPEL WINOBI: FENETRE AFFICHAGE DES OBSERVATIONS CLIENTS
     IPAROBI      DS
     I                                        1   10STEOBI
     I                                        2   50CLIOBI
     I                                        6  13 CODOBI
     I/EJECT
     *
     C           *LIKE     DEFN INCLU     WINCLU
     **
     C                     Z-ADD0         WINCLU
     C                     SETON                     99
     C                     MOVE *YEAR     SUYEA
     C                     MOVE UMONTH    UMONT
     C                     MOVE UDAY      UDAI
     C                     MOVE *YEAR     UYEM6
     C                     MOVE UMONTH    UMOM6
     C                     MOVE UDAY      UDAM6
     C                     ADD  6         UMOM6
D1  C           UMOM6     IFGT 12
     C                     SUB  12        UMOM6
     C                     ADD  1         UYEM6
F1  C                     END
    C** REMISE A ZEROS DES ZONES NUMERIQUES DES DS
    C** POUR EVITER LES SIGNES OU CHIFFRES INVALIDES
    C***********************************************
     C                     Z-ADD*ZEROS    DATCAL
     C                     Z-ADD*ZEROS    STE
     C                     Z-ADD*ZEROS    NOCLI
     C                     Z-ADD*ZEROS    AGENT
     C                     Z-ADD*ZEROS    INDUS
     C                     Z-ADD*ZEROS    RGFAC
     C                     Z-ADD*ZEROS    RGLIV
     C                     Z-ADD*ZEROS    SEQACH
     C                     Z-ADD*ZEROS    NOPOUT
     C                     Z-ADD*ZEROS    NOFOR
     C                     Z-ADD*ZEROS    STMEXX
     C                     Z-ADD*ZEROS    MONMAT
     C                     Z-ADD*ZEROS    FRINCS
     C                     Z-ADD*ZEROS    MATSTE
     C                     Z-ADD*ZEROS    MATCLI
     C                     Z-ADD*ZEROS    MATFAC
     C                     Z-ADD*ZEROS    STMINX
     C                     Z-ADD*ZEROS    MONMAI
     C                     Z-ADD*ZEROS    FRINCI
     C                     Z-ADD*ZEROS    MATSTI
     C                     Z-ADD*ZEROS    MATCIN
     C                     Z-ADD*ZEROS    MATFAI
     C                     Z-ADD*ZEROS    STMGOX
     C                     Z-ADD*ZEROS    MONMAD
     C                     Z-ADD*ZEROS    FRINCD
     C                     Z-ADD*ZEROS    MATSTD
     C                     Z-ADD*ZEROS    MATCLD
     C                     Z-ADD*ZEROS    MATFAD
     C                     Z-ADD*ZEROS    STMGAX
     C                     Z-ADD*ZEROS    MONMAG
     C                     Z-ADD*ZEROS    FRINCG
     C                     Z-ADD*ZEROS    MATSTG
     C                     Z-ADD*ZEROS    MATCLG
     C                     Z-ADD*ZEROS    MATFAG
     C                     Z-ADD*ZEROS    STMDEX
     C                     Z-ADD*ZEROS    MONMDE
     C                     Z-ADD*ZEROS    FRINDE
     C                     Z-ADD*ZEROS    MATSDE
     C                     Z-ADD*ZEROS    MATCLE
     C                     Z-ADD*ZEROS    MATFAE
     C                     Z-ADD*ZEROS    STMGEN
     C                     Z-ADD*ZEROS    MONGEN
     C                     Z-ADD*ZEROS    FRIGEN
     C                     Z-ADD*ZEROS    MATGE1
     C                     Z-ADD*ZEROS    MATGE2
     C                     Z-ADD*ZEROS    MATGE3
     C                     Z-ADD*ZEROS    SEQFAB
     C                     Z-ADD*ZEROS    SEQIMP
     C                     Z-ADD*ZEROS    ANDEL
     C                     Z-ADD*ZEROS    SEDEL
     C                     Z-ADD*ZEROS    JSDEL
     C                     Z-ADD*ZEROS    QTIMP
     C                     Z-ADD*ZEROS    QTFAC
     C                     Z-ADD*ZEROS    QTEXP
     C                     Z-ADD*ZEROS    NBOBI
     C                     Z-ADD*ZEROS    NBEXP
     C                     Z-ADD*ZEROS    PUNITX
     C                     Z-ADD*ZEROS    PX
     C                     Z-ADD*ZEROS    TSEIMP
     C                     Z-ADD*ZEROS    TSEFAB
     C                     Z-ADD*ZEROS    TSERAN
     C                     Z-ADD*ZEROS    TSEIM1
     C                     Z-ADD*ZEROS    TSEFA1
     C                     Z-ADD*ZEROS    TSERA1
     C                     Z-ADD*ZEROS    IMPRE9
     C                     Z-ADD*ZEROS    FABRI9
     C                     Z-ADD*ZEROS    ACDE
     C                     Z-ADD*ZEROS    MCDE
     C                     Z-ADD*ZEROS    JCDE
     C                     Z-ADD*ZEROS    DSCDE
     C                     Z-ADD*ZEROS    SEQSTA
     C                     Z-ADD*ZEROS    STE
     C                     Z-ADD*ZEROS    NOCLI
     C/EJECT
    C*****************************************************
    C** CLES D'ACCES AUX DIFFERENTS FICHIERS             *
    C*****************************************************
    C** PARAME
    C*********
     C           CLPARA    KLIST
     C                     KFLD           ARGU    4
     C                     KFLD           VALE    8
    C** CLIENTS1
    C***********
     C           CLECLI    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
    C** CLISTAL1
    C***********
     C           CLESTA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C           CLEFIC    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEQUEN  20
     C           CLETES    KLIST
     C                     KFLD           MATGE1
     C                     KFLD           MATGE2
     C                     KFLD           MATGE3
    C** PRODUI2
    C**********
     C           CLEPRO    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           CLEPGR    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           SVPRO
     C                     KFLD           NOPRO
    C** PRODST3
    C**********
     C           CLEPR3    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           PRODOR  40
    C** PLAMAL1 ET LIEUSTL3
    C**********
     C           CLEPLA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           CLEPLX    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPROX  40
    C** CODBAR AMALGAME
    C***********************
     C           CLEALM    KLIST
     C                     KFLD           ALMSTE
     C                     KFLD           ALMCLI
     C                     KFLD           ALMPRO
    C** MVTIMPLF
    C***********
     C           CLEIM1    KLIST
     C                     KFLD           SOCIET  10
     C                     KFLD           IM11    40
     C                     KFLD           IM22    40
     C           CLEIM3    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
    C** CALENAL2
    C***********
     C           CLECAL    KLIST
     C                     KFLD           ANDEL
     C                     KFLD           SEDEL
     C                     KFLD           JSDEL
    C** CALENAL0
    C*********
     C           CLECA1    KLIST
     C                     KFLD           ACDE
     C                     KFLD           MCDE
     C                     KFLD           JCDE
     C           CLECAQ    KLIST
     C                     KFLD           COMCLA
     C                     KFLD           COMCLM
     C                     KFLD           COMCLJ
     *---- Début ----- Philippe  ---- 13/10/2014 -----
     * - CLé d'accès au fichier CALENS pour récupérer le siecle
     C           KCALL0    KLIST
     C                     KFLD           COMATA
     C                     KFLD           COMATM
     C                     KFLD           COMATJ
     *---- Fin   ----- Philippe  ---- 13/10/2014 -----
    C** CLIOBIL1
    C***********
     C           CLEOBI    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
    C** CLIOBIL2
    C***********
     C           CLEOB2    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           CODOBI
    C** PREIMP2
    C**********
     C           CPRIM2    KLIST
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
    C** CLIOBSL1
    C***********
     C           CLEOBS    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           DEST
    C** CAIPALL1
    C***********
     C           CLEEMB    KLIST
     C                     KFLD           USINE
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           EMBNO
     C** Ajout COI -- Clé d'accès au fichier CLICOM
     C           KCLI      KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C**Fin Ajout COI
     * PARAMETRE D'ENTREE DANS LE PROGRAMME
     C           *ENTRY    PLIST
     C                     PARM           DSPARM
    **
    ** Saisie USINE => P.Unit=1 PX=0 Forf.lanc.=0 Possibilité SANS VETO
    ** SI USAISI ='*' (passe en parametre)
    **
     C           USRNAM    CHAINMNUUTIL1             99
    C           *IN99     CABEQ'1'       FIN
     *
     * CDECRB = Dataarea pour REEL/BIDON
     C           *NAMVAR   DEFN           CDECRB  5
     C                     IN   CDECRB
     * CDECAU = Dataarea autorisation à retourner dans les commandes
     C           *NAMVAR   DEFN           CDECAU  1
     C/EJECT
    C*****************************************************
    C** PREMIER FORMAT DEMANDE DU GROUPE DU CODE SOCIETE *
    C** ET DU NUMERO DE CLIENT                           *
    C*****************************************************
     C           FORM01    TAG
    C**         ******    ***
     C                     MOVE '0'       *IN
     C                     MOVE '0'       *INU1
     C                     MOVE '0'       *INU2
     C                     MOVE '0'       *INU3
     C                     MOVE '0'       *INU4
     C                     MOVE '0'       *INU5
     C                     MOVE '0'       *INU6
     C                     MOVE '0'       *INU8
     C                     EXSR RAZ
     C                     Z-ADD0         NOCLI
     C                     Z-ADD0         NOPRO
     C                     MOVEL'SELECTIO'LIBSEL
     C                     MOVE 'N '      LIBSEL
     *
     C           STFM01    TAG
     *          ------    ---
     C                     MOVE *IN70     REF70   1
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      70
     C   70      CDECRB    COMP 'BIDON'                  71
     C                     MOVE 'NON'     NOVETO
     C                     EXFMTF1
     C                     SETOF                     37
     C                     MOVE REF70     *IN70
     C                     MOVE REF71     *IN71
    C           *IN03     CABEQ'1'       FIN
    C** TRAITEMENT DES COMMANDES EN COURS
    C************************************
     C                     IN   CDECAU
     C           CDECAU    COMP 'N'                      38
    C           *IN38     CABEQ'1'       STFM01           CDES EN COUR
    C** COMMANDE PREIMPRIMEE
    C***********************
D1  C           *IN08     IFEQ '1'
     C                     SETON                     84
D2  C           STE       IFNE 0
    C           GROUPE    ORNE *BLANKS
    C           NOCLI     ORNE *ZEROS
     C                     SETON                     40
    C                     GOTO FORM01
F2  C                     END
     C                     MOVE *BLANKS   NIMPE1
     C                     MOVE *BLANKS   NIMPI1
     C                     MOVE 'P'       IMPSTO
     C                     EXSR SPRIMP
     C                     SETON                     01
    C                     GOTO FORSUI
F1  C                     END
     C                     MOVE '1'       *IN99
     C                     SETOF                     9091
     ** VERIFICATION VALIDITE CODE GROUPE
     ************************************
D1  C           STE       IFNE 0
     C                     MOVE 'NOSO'    ARGU
     C                     MOVE STE       VALE      P
     C           CLPARA    CHAINPARAME               24
    C           *IN24     CABEQ'1'       STFM01
F1  C                     END
     C                     MOVE 'GRPS'    ARGU
     C                     MOVE *BLANKS   VALE
    C           GROUPE    CASEQ*BLANK    FENGP          44
    C                     END
    C           *IN44     CABEQ'1'       STFM01
     C                     MOVE GROUPE    VALE
     C           CLPARA    CHAINPARAME               31    GROUPE INCONNU
    C           *IN31     CABEQ'1'       STFM01
     *
     ** SI CLIENT SAISI VALIDITE EXISTENCE
     *************************************
D1  C           NOCLI     IFEQ *ZEROS
     *
     * Recherche du N° de Client
     * -------------------------
     C                     MOVE 'N'       PARM0
     C                     Z-ADD0         STENO
     C                     Z-ADD0         CLINO
     C                     CALL 'LAN065£'
     C                     PARM           PARM65
D2  C           PARM0     IFEQ 'O'
     C                     MOVE STENO     STE
     C                     MOVE CLINO     NOCLI
X2  C                     ELSE
    C                     GOTO STFM01
F2  C                     END
F1  C                     END
     * Ajout des observatiosnn clients code 'CREDIT'
     C                     MOVEL'CREDIT'  CODOBI
     C                     MOVE STE       STEOBI
     C                     MOVE NOCLI     CLIOBI
     C                     WRITEF1
     C                     CALL 'WINOBI£'
     C                     PARM           PAROBI
     C           CLECLI    CHAINCLIENTS1             33
    C           *IN33     CABEQ'1'       STFM01           CLIENT INCONNU
    C           PAYEUR    CABNE' '       STFM01     3737
     C           CLECLI    SETLLCLICOML2                 37
    C           *IN37     CABEQ'1'       STFM01           LIMITE DEPAS
     *
    C*****************************************************
    C** RECHERCHE SI OBSERVATION CLIENT : ALERTE         *
    C**                                   MAJPX          *
    C*****************************************************
D1  C           NOCLI     IFNE SVNC
    C           STE       ORNE SVSTE
     C                     SETOF                     25
F1  C                     END
    C*
D1  C           *IN25     IFEQ '0'
     C                     MOVE *BLANKS   AUGMEN
     C                     MOVEL'ALERTE  'CODOBI
     C           CLEOB2    SETLLCLIOBIL2                 25
D2  C           *IN25     IFEQ '1'
     C                     MOVELTAUG,1    AUGMEN
X2  C                     ELSE
     C                     MOVEL'MAJPX   'CODOBI
     C           CLEOB2    CHAINCLIOBIL2             38
D3  C           *IN38     IFEQ '0'
     C                     SETON                     25
     C                     MOVELLIBOBI    AUGMEN
F3  C                     END
F2  C                     END
    C*
D2  C           *IN25     IFEQ '1'
     C                     Z-ADDNOCLI     SVNC    40
     C                     Z-ADDSTE       SVSTE   10
    C                     GOTO STFM01
F2  C                     END
F1  C                     END
    C*****************************************************
    C** SELECTION DU BLOC STATISTIQUES    CALL CLIE03£   *
    C*****************************************************
     C           CLESTA    SETLLCLISTAL1
     C                     Z-ADD*ZEROS    I
D1  C                     DO   *HIVAL
     C           CLESTA    READECLISTAL1                 38
D2  C           *IN38     IFEQ '1'
D3  C           I         IFGT 1
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE03£'
     C                     PARM           DSCOMM
    C           ZONE95    CABEQ'0'       FORM01
    C                     GOTO RECHER
X3  C                     ELSE
    C                     GOTO RECHER
F3  C                     END
F2  C                     END
     C                     ADD  1         I
F1  C                     END
    C*****************************************************
    C** SELECTION DES ADRESSES D ACHAT   CALL CLIE08£    *
    C*****************************************************
     C           RECHER    TAG
    C**         ******    ***
     C           CLESTA    CHAINCLIACHL7             38
     C           CLESTA    READECLIACHL7                 38
    C           *IN38     CABEQ'1'       RECHE1
D1  C           USAISI    IFEQ '*'
     C           CLESTA    CHAINCLIACHL7             38
    C                     GOTO RECHE1
F1  C                     END
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE08£'
     C                     PARM           DSCOMM
    C           ZONE95    CABEQ'0'       FORM01
    C*****************************************************
    C** SELECTION DES ADRESSES DE FACTURATION  CLIE04£   *
    C*****************************************************
     C           RECHE1    TAG
    C**         ******    ***
     C           CLESTA    CHAINCLIFACL4             38
     C           CLESTA    READECLIFACL4                 38
    C           *IN38     CABEQ'1'       RECHE2
D1  C           USAISI    IFEQ '*'
     C           CLESTA    CHAINCLIFACL4             38
     C                     Z-ADD99        RGFAC
    C                     GOTO RECHE2
F1  C                     END
     C                     MOVE '1'       ZONE95
     C                     Z-ADD0         RGFAC
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
    C           ZONE95    CABEQ'0'       FORM01
    C*****************************************************
    C** SELECTION DES ADRESSES DE FACTURATION  CLIE05£   *
    C*****************************************************
     C           RECHE2    TAG
    C**         ******    ***
     C           CLESTA    CHAINCLILIVL3             38
     C           CLESTA    READECLILIVL3                 38
    C           *IN38     CABEQ'1'       FORM02
     C                     Z-ADD0         RGLIV
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
    C           ZONE95    CABEQ'0'       FORM01
     C/EJECT
    C*****************************************************
    C** AFFICHAGE DES ADRESSES RETENUES                  *
    C*****************************************************
     C           FORM02    TAG
    C**         ******    ***
    C** RECUP RENSEIGNEMENTS ADRESSE ACHAT
    C*************************************
     C                     Z-ADDSEQACH    SEQUEN
     C           CLEFIC    CHAINCLIACHL7             38
    C** RECUP RENSEIGNEMENTS ADRESSE FACTURATION
    C*******************************************
D1  C           RGFAC     IFNE *ZEROS
    C           RGFAC     ANDNE99
     C                     SETOF                     90U1U3
     C                     Z-ADDRGFAC     SEQUEN
     C           CLEFIC    CHAINCLIFACL4             38
X1  C                     ELSE
    C** ZONES ADRESSE FACTURATION
    C****************************
     C                     MOVE *BLANKS   NOMFAC
     C                     MOVE *BLANKS   RAIFAC
     C                     MOVE *BLANKS   RUEFAC
     C                     MOVE *BLANKS   PAYFAC
     C                     MOVE *BLANKS   DEPFAC
     C                     MOVE *BLANKS   VILFAC
     C                     MOVE *BLANKS   CPFAC
     C                     SETON                     90U1U3
F1  C                     END
D1  C           USAISI    IFEQ '*'
     C                     SETOF                     U1
F1  C                     END
    C** RECUP RENSEIGNEMENTS ADRESSE LIVRAISON
    C*****************************************
D1  C           RGLIV     IFNE *ZEROS
     C                     SETOF                     91U2U4
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             38
X1  C                     ELSE
    C** ZONES ADRESSE LIVRAISON
    C**************************
     C                     MOVE *BLANKS   NOMLIV
     C                     MOVE *BLANKS   RAILIV
     C                     MOVE *BLANKS   RUELIV
     C                     MOVE *BLANKS   PAYLIV
     C                     MOVE *BLANKS   DEPLIV
     C                     MOVE *BLANKS   VILLIV
     C                     MOVE *BLANKS   CPLIV
     C                     MOVE *BLANKS   LIBAG
     C                     SETON                     91U2U4
F1  C                     END
    C** RECUP LIBELLE DE L'AGENT
    C***************************
     C                     MOVE 'TVRP'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE AGENT     VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBAG
    C** AFFICHAGE DU FORMAT
    C**********************
     C           FORM03    TAG
    C**         ******    ***
     C           USAISI    COMP '*'                      44
     C                     EXFMTF2
    C** CHANGEMENT DE BLOC STATISTIQUE
    C*********************************
D1  C           *IN04     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE03£'
     C                     PARM           DSCOMM
D2  C           ZONE95    IFEQ '0'
     C                     EXSR RAZ
    C                     GOTO FORM01
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C** CHANGEMENT D'ADRESSE D'ACHAT
    C*******************************
D1  C           *IN05     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE08£'
     C                     PARM           DSCOMM
D2  C           ZONE95    IFEQ '0'
     C                     EXSR RAZ
    C                     GOTO FORM01
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D1  C           *IN24     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
D2  C           ZONE95    IFEQ '0'
     C                     EXSR RAZ
    C                     GOTO FORM01
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C** CHANGEMENT D'ADRESSE LIVRAISON
    C*********************************
D1  C           *IN07     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
D2  C           ZONE95    IFEQ '0'
     C                     EXSR RAZ
    C                     GOTO FORM01
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
     C/EJECT
    C*****************************************************
    C** AFFICHAGE DES CONDITIONS DE REGLEMENT DU CLIENT  *
    C*****************************************************
    C** MISE EN FORME DU FORMAT
    C**************************
     C                     SETOF                     252496
     C                     SETOF                     9798
     C           CLECLI    CHAINCLIENTS1             33
D1  C           *IN90     IFEQ '0'
     C                     Z-ADDRGFAC     SEQUEN
     C           CLEFIC    CHAINCLIFACL4             33
     C                     MOVE FOUFOU    CLIFOU
F1  C                     END
    C** RECUP LIBELLE DU MODE REGLEMENT
    C**********************************
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE COREGL    VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBREG
D1  C           FACFR     IFEQ '1'
     C                     MOVE '1'       *IN98
F1  C                     END
D1  C           EXPFA     IFEQ '1'
     C                     MOVE '1'       *IN97
F1  C                     END
D1  C           *IN98     IFEQ '1'
     C                     MOVE 'OUI'     FACFR5
X1  C                     ELSE
     C                     MOVE 'NON'     FACFR5
F1  C                     END
D1  C           *IN97     IFEQ '1'
     C                     MOVE 'OUI'     FACFO5
X1  C                     ELSE
     C                     MOVE 'NON'     FACFO5
F1  C                     END
    C** DECOUVERT
     *
    C*          DECOUC    IFGT DECOU
    C*          DECOUC    SUB  DECOU     DPDEC
    C*                    ELSE
    C*                    Z-ADD*ZEROS    DPDEC
    C*                    END
    C** SYNDIC
D1  C           SYNDIC    IFNE *BLANKS
     C                     MOVE '1'       *IN25
F1  C                     END
    C** MAUVAIS PAYEUR
D1  C           PAYEUR    IFNE *BLANKS
     C                     MOVE '1'       *IN24
F1  C                     END
    C** FDM
D1  C           FDM       IFEQ 'F'
     C                     MOVE '1'       *IN96
F1  C                     END
     *
     C                     MOVE NOCLI     NBCLI
    C           USAISI    CABEQ'*'       FORM07
     C                     Z-ADD0         NBCLI
     C                     MOVE *BLANK    CODMON
     C                     MOVE *BLANK    TYPMON  1
     C           MON05     TAG
    C**         ******    ***
D1  C           CODTA     IFNE 1
    C           EDICOU    ANDEQ'D'
     C                     MOVE 'E'       EDICOU
F1  C                     END
     C                     MOVE '0'       *IN26
     C                     MOVEL*BLANKS   LIBMO2
D1  C           CODTA     IFNE 1
     C                     MOVELTI1,2     LIBMO1
     C                     MOVE *BLANK    CODMON
X1  C                     ELSE
D2  C           EDICOU    IFEQ 'D'
     C                     MOVELTI1,4     LIBMO1
     C                     MOVELTI1,6     LIBMO2
F2  C                     END
D2  C           EDICOU    IFEQ 'E'
    C           EDICOU    OREQ *BLANK
     C                     MOVE *BLANK    CODMON
     C                     MOVELTI1,2     LIBMO1
     C                     MOVELTI1,7     LIBMO2
F2  C                     END
F1  C                     END
    C** AFFICHAGE DU FORMAT
    C**********************
     C           FORM04    TAG
    C**         ******    ***
     C                     WRITEF4
     C           FORM05    TAG
    C**         ******    ***
     C                     EXFMTF3
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
    C**CHANGEMENT MONNAIE
    C********************
D1  C           *IN06     IFEQ '1'
D2  C           CODTA     IFNE 1
     C                     MOVE 'E'       EDICOU
X2  C                     ELSE
D3  C           EDICOU    IFEQ *BLANK
    C           EDICOU    OREQ 'E'
     C                     MOVE 'D'       EDICOU
X3  C                     ELSE
     C                     MOVE 'E'       EDICOU
F3  C                     END
F2  C                     END
    C                     GOTO MON05
F1  C                     END
    C**CHOIX DEVISES
    C***************
D1  C           CODMON    IFEQ *BLANK
    C           EDICOU    ANDEQ'D'
     *          -----     ---
     C           AFF3W     TAG
     *          -----     ---
     C                     MOVE '1'       *IN93
     C                     WRITEF3WC
     C                     MOVEA'00'      *IN,93
     C                     MOVE *BLANK    CHW3
     C                     Z-ADD0         RECNO   30
     C           *LOVAL    SETLLDEVISEL1
     C                     READ DEVISEL1                 99
D2  C           *IN99     DOWEQ'0'
D3  C           CODM      IFNE TCM
     C                     MOVELCODM      TCM
     C                     MOVELNOMDEV    TLM
     C                     ADD  1         RECNO
     C                     MOVE '1'       *IN94
     C                     WRITEF3WS
F3  C                     END
     C                     READ DEVISEL1                 99
F2  C                     END
     C                     EXFMTF3WC
D2  C           *IN06     IFEQ '1'
     C                     MOVE 'E'       EDICOU
    C                     GOTO MON05
F2  C                     END
     C           LW3       TAG
     *
     C                     READCF3WS                     99
    C   99                GOTO MON05
D2  C           CHW3      IFNE *BLANK
     C                     MOVE TCM       CODMON
     C                     MOVE 'D'       EDICOU
X2  C                     ELSE
    C                     GOTO LW3
F2  C                     END
    C                     GOTO MON05
F1  C                     END
D1  C           *IN04     IFEQ '1'
     C                     EXSR CHARCR
     C                     WRITEF8
     C                     WRITEF3
D2  C           *IN98     IFEQ '1'
     C                     MOVE 'OUI'     FACFR5
X2  C                     ELSE
     C                     MOVE 'NON'     FACFR5
F2  C                     END
D2  C           *IN97     IFEQ '1'
     C                     MOVE 'OUI'     FACFO5
X2  C                     ELSE
     C                     MOVE 'NON'     FACFO5
F2  C                     END
     C                     MOVE FDM       FDM5
     C                     MOVE ESCPT     ESCPT5
     C                     MOVE AGIOS     AGIOS5
    C                     GOTO FORM06
X1  C                     ELSE
     C                     MOVE NOCLI     NBCLI
    C                     GOTO FORM07
F1  C                     END
     *
    C** CHANGEMENT DES CONDITIONS REGLEMENT
    C**************************************
     C           FORM06    TAG
    C**         ******    ***
     C                     SETON                     1011
     C                     WRITEF6
     C                     SETOF                     1011
     C                     EXFMTF5
    C** ANNULATION CONDITIONS SPECIALES
    C**********************************
D1  C           *IN05     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF6
     C                     SETOF                     12
    C                     GOTO FORM04
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
     C                     SETON                     12
     C                     WRITEF6
     C                     SETOF                     12
    C                     GOTO FORM01
F1  C                     END
     C                     MOVE '0'       *IN60
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN33
     C                     MOVE '0'       *IN34
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN55
    C** TEST DES CONDITIONS SPECIALES
    C********************************
D1  C           COREG5    IFNE '  '
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE COREG5    VALE
     C           CLPARA    CHAINPARAME               59
    C         59          GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ '04'
    C           COREG5    OREQ '05'
    C           COREG5    OREQ '09'
    C           COREG5    OREQ '14'
D2  C           COREC5    IFEQ 0
     C                     MOVE '1'       *IN60
    C                     GOTO FORM06
F2  C                     END
F1  C                     END
D1  C           COREG5    IFEQ '16'
D2  C           COREC5    IFNE 0
     C                     MOVE '1'       *IN25
    C                     GOTO FORM06
F2  C                     END
F1  C                     END
     *
D1  C           FDM5      IFNE ' '
    C           FDM5      ANDNE'F'
     C                     MOVE '1'       *IN33
    C                     GOTO FORM06
F1  C                     END
     *
D1  C           COREC5    IFEQ 0
    C           FDM5      ANDNE' '
     C                     MOVE '1'       *IN34
    C                     GOTO FORM06
F1  C                     END
D1  C           ESCPT5    IFNE 0
    C           AGIOS5    ANDNE0
     C                     MOVE '1'       *IN24
    C                     GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ *BLANKS
    C           COREC5    ANDNE*ZEROS
     C                     SETON                     55
    C                     GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ *BLANKS
    C           CORJO5    ANDNE0
     C                     SETON                     55
    C                     GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ *BLANKS
    C           AGIOS5    ANDNE0
     C                     SETON                     55
    C                     GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ *BLANKS
    C           ESCPT5    ANDNE0
     C                     SETON                     55
    C                     GOTO FORM06
F1  C                     END
D1  C           COREG5    IFEQ *BLANKS
    C           VALSU5    ANDNE0
     C                     SETON                     55
    C                     GOTO FORM06
F1  C                     END
    C** REMPLACEMENT DES ZONES SI SAISIES
    C************************************
D1  C           COREG5    IFNE *BLANKS
     C                     MOVE COREG5    COREGL
D2  C           COREC5    IFNE *ZEROS
     C                     MOVE COREC5    CORECH
F2  C                     END
D2  C           CORJO5    IFNE *ZEROS
     C                     MOVE CORJO5    CORJOU
F2  C                     END
     C                     MOVE ESCPT5    ESCPT
     C                     MOVE AGIOS5    AGIOS
D2  C           VALSU5    IFNE *ZEROS
     C                     MOVE VALSU5    VALSUI
F2  C                     END
F1  C                     END
D1  C           FACFO5    IFEQ 'OUI'
     C                     MOVE '1'       EXPFA
X1  C                     ELSE
     C                     MOVE '0'       EXPFA
F1  C                     END
D1  C           FACFR5    IFEQ 'OUI'
     C                     MOVE '1'       FACFR
X1  C                     ELSE
     C                     MOVE '0'       FACFR
F1  C                     END
     C                     SETON                     12
     C                     WRITEF6
     C                     SETOF                     12
     C                     MOVE NOCLI     NBCLI   40
     C/EJECT
    C** DEMANDE DU PRODUIT A COMMANDER
    C********************************
     C           FORM07    TAG
    C**         *******   ***
     C                     MOVE EDICOU    TYPMON
D1  C           TYPMON    IFEQ 'E'
    C           TYPMON    OREQ *BLANK
     C                     MOVE 'EUR'     CODMON
F1  C                     END
     *
     C                     MOVE NBCLI     NOCLI
     C                     SETOF                     558685
     C                     SETOF                     U896
    C* CLIENT PLATEFORME ?
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINREFSTKL1             38
D1  C           *IN38     IFEQ '0'
    C           CLIMUL    ANDEQ'O'
     C                     SETON                     96
F1  C                     END
     C                     EXFMTF9
    C** ANNULATION DE LA SAISIE
    C***************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
    C** CREATION PRODUIT FRUITIER
    C*****************************
D1  C           *IN07     IFEQ '1'
     C                     MOVE STE       STE29
     C                     MOVE NOCLI     CLI29
     C                     MOVE 'N'       ANN29
     C                     CALL 'LAN029£'
     C                     PARM           DSPA29
    C                     GOTO FORM07
F1  C                     END
     C           GARNIT    TAG
    C**         *****     ***
D1  C           *IN21     IFEQ '1'
    C           *IN63     OREQ '1'
     C         U1          SETON                     U3
     C         U2          SETON                     U4
     C                     MOVE *BLANKS   EXT
     C                     MOVE *BLANKS   INT
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
     C                     MOVE *BLANKS   STMEXX
     C                     MOVE *BLANKS   STMINX
     C   21                MOVE '1'       ZONE21  1
     C   63                MOVE '1'       ZONE63  1
     C                     MOVE '0'       *IN
     C                     MOVE ZONE21    *IN21
     C                     MOVE ZONE63    *IN63
     C                     MOVE '1'       *IN99
     C                     SETON                     01
F1  C                     END
D1  C           NOPRO     IFNE *ZEROS
     C           CLEPRO    CHAINPRODUI2              31
     C  N31      GARNT     COMP 'PP'                     31
     C                     MOVE *IN17     IN17    1
     * SAUVEGARDE DE TOUS LES PRODUITS D'UNE GARNITURE
     * -----------------------------------------------
     C           CLEPRO    SETLLCOMPREL1                 18
D2  C           *IN18     IFEQ '1'
     C                     Z-ADD*ZEROS    TA
     C                     Z-ADD1         L
     C                     MOVE 'RE'      GARNT
     C                     Z-ADDNOPRO     SVPRO   40
     C           CLEPRO    READECOMPREL1                 17
D3  C           *IN17     DOWEQ'0'
     C                     Z-ADDNOPGAR    TA,L
     C                     ADD  1         L
     C           CLEPRO    READECOMPREL1                 17
F3  C                     END
     C                     Z-ADD0         L
F2  C                     END
     C                     MOVE IN17      *IN17
     *
     C                     Z-ADD0         STO
     C           CLEPLA    CHAINLIEUSTL3             99
D2  C           *IN99     DOWEQ'0'
D3  C           LILIEU    IFEQ 2
     C                     ADD  STOLIE    STOCK2                          PROD17
F3  C                     END
D3  C           LILIEU    IFEQ 3
     C                     ADD  STOLIE    STOCK3                          PROD17
F3  C                     END
D3  C           LILIEU    IFEQ 4
     C                     ADD  STOLIE    STOCK4                          PROD17
F3  C                     END
D3  C           LILIEU    IFEQ 5
     C                     ADD  STOLIE    STOCK5                          PROD17
F3  C                     END
D3  C           LILIEU    IFEQ 6
     C                     ADD  STOLIE    STOCK6                          PROD17
F3  C                     END                                            PROD17
D3  C           LILIEU    IFEQ 7
     C                     ADD  STOLIE    STOCK7                          PROD17
F3  C                     END                                            PROD17
D3  C           LILIEU    IFEQ 8
     C                     ADD  STOLIE    STOCK8                          PROD17
F3  C                     END                                            PROD17
     C           CLEPLA    READELIEUSTL3                 99              *PROD17
F2  C        N99          END                                           *PROD17
     *                                                                   PROD13
     C                     MOVE TICLI     MICLI
     C                     MOVE TACLI     MACLI
     C                     Z-ADDTYNPOR    TYPOR
     C                     SETOF                     16
D2  C           *IN21     IFEQ '1'
     C                     Z-ADD1         GG      20
     C                     MOVE '0'       *IN63
     C           CLEPGR    CHAINCOMPREL5             18
D3  C           *IN18     IFEQ '0'
     C           GARGAR    LOKUPGAR,GG                   63
     C                     MOVE GARGAR    GARNT
F3  C                     END
     C   63                SETOF                     21
     C                     SETON                     1655
    C*                    GOTO GARNI1
F2  C                     END
     C  N31      ANNUL     COMP '*'                      31
     C   31      CLEPRO    CHAINRECAPT               85
     C  N85 31   ANNUL     COMP '*'                      85
     C   31N85             SETON                     86    TRT ULTERIEUR
     C   86                SETOF                     31
     C   85                SETON                     31
    C   31                GOTO FORM07
D2  C           PSERIE    IFEQ 'P'
    C           GARNT     ANDNE'MD'
     C                     SETON                     13
    C                     GOTO FORM07
F2  C                     END
D2  C           PSERIE    IFEQ ' '
    C           GARNT     ANDEQ'MD'
     C                     SETON                     50
    C                     GOTO FORM07
F2  C                     END
D2  C           PSERIE    IFEQ 'P'
    C           PREVIS    ANDEQ'P'
     C                     SETON                     81
    C                     GOTO FORM07
F2  C                     END
     *
     C                     SETOF                     62
D2  C           PREVIS    IFEQ 'P'
     C                     MOVE 'P'       CDEPRE
     C                     SETON                     62
F2  C                     END
D2  C           PSERIE    IFEQ 'P'
     C                     MOVE 'P'       PRESER
F2  C                     END
    C** DECODAGE UNITE DE VENTE
    C**************************
     C                     MOVE *BLANKS   UNITE
     C                     MOVE *BLANKS   CVUNIT
    C** AUX 1000
    C***********
D2  C           UVENT     IFEQ 1
     C                     MOVE 1000      UNITE
F2  C                     END
    C** 100 M2
    C*********
D2  C           UVENT     IFEQ 2
     C                     MOVE 100       UNITE
     C                     MOVE 'M2'      CVUNIT
F2  C                     END
    C** 100 ML
    C*********
D2  C           UVENT     IFEQ 3
     C                     MOVE 100       UNITE
     C                     MOVE 'ML'      CVUNIT
F2  C                     END
    C** 100 KG
    C*********
D2  C           UVENT     IFEQ 4
     C                     MOVE 100       UNITE
     C                     MOVE 'KG'      CVUNIT
F2  C                     END
    C** A L UNITE
    C************
D2  C           UVENT     IFEQ 5
     C                     MOVE 1         UNITE
F2  C                     END
    C* LIBELLE USINE
     C                     MOVE *BLANKS   LIBUSI
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINE     VALE      P
     C           CLPARA    CHAINPARAME               38
D2  C           *IN38     IFEQ '0'
     C                     MOVELPXLIBE    LIBUSI
F2  C                     END
    C*
D2  C           NCONFZ    IFNE 0
     C                     MOVE '1'       *INU8
F2  C                     END
D2  C           NCONFZ    IFEQ 0
D3  C           ANPRO     IFNE 0
     C                     SETON                     U8
F3  C                     END
F2  C                     END
     C           LAHAUT    TAG
    C**         ******    ***
     C                     SETON                     55
     C                     SETOF                     96
     C                     WRITEF9
    C                     GOTO FORM08
X1  C                     ELSE
    C           RECPRO    CABEQ*BLANKS   FORM07         24
     C           RECPRO    LOKUPTABEX                    78
     C                     SETOF                     U8
     * TEST SI 1ERE ZONE A BLANC
     C                     MOVE *BLANKS   TB
     C                     MOVE *BLANKS   RE
     C                     Z-ADD1         Z
     C                     Z-ADD1         Y0      20
     C                     MOVE ' '       BID     1
     C                     MOVEARECPRO    RE,1
     C           BOUCLE    TAG
D2  C           Z         IFNE 11
D3  C           RE,Z      IFNE ' '
    C           BID       ANDEQ' '
     C                     MOVE '1'       BID
F3  C                     END
D3  C           BID       IFEQ ' '
     C                     ADD  1         Z
    C                     GOTO BOUCLE
F3  C                     END
     C                     MOVE RE,Z      TB,Y0
     C                     ADD  1         Z
     C                     ADD  1         Y0
    C                     GOTO BOUCLE
F2  C                     END
     C                     MOVE *BLANKS   RE
     C                     MOVEATB        RECPRO
     C                     EXSR CHAPRO
     C           CLEPRO    CHAINPRODUI2              60
D2  C           PSERIE    IFEQ 'P'
    C           GARNT     ANDNE'MD'
     C                     SETON                     13
    C                     GOTO FORM07
F2  C                     END
D2  C           PSERIE    IFEQ ' '
    C           GARNT     ANDEQ'MD'
     C                     SETON                     50
    C                     GOTO FORM07
F2  C                     END
D2  C           PSERIE    IFEQ 'P'
    C           PREVIS    ANDEQ'P'
     C                     SETON                     81
    C                     GOTO FORM07
F2  C                     END
D2  C           *IN60     IFEQ '0'
     C                     MOVE *IN17     IN17    1
     * SAUVEGARDE DE TOUS LES PRODUITS D'UNE GARNITURE
     * -----------------------------------------------
     C           CLEPRO    SETLLCOMPREL1                 18
D3  C           *IN18     IFEQ '1'
     C                     Z-ADD*ZEROS    TA
     C                     Z-ADD1         L
     C                     MOVE 'RE'      GARNT
     C                     Z-ADDNOPRO     SVPRO   40
     C           CLEPRO    READECOMPREL1                 17
D4  C           *IN17     DOWEQ'0'
     C                     Z-ADDNOPGAR    TA,L
     C                     ADD  1         L
     C           CLEPRO    READECOMPREL1                 17
F4  C                     END
     C                     Z-ADD0         L
F3  C                     END
     C                     MOVE IN17      *IN17
     *
    C** DECODAGE UNITE DE VENTE
    C**************************
     C                     MOVE *BLANKS   UNITE
     C                     MOVE *BLANKS   CVUNIT
    C** AUX 1000
    C***********
D3  C           UVENT     IFEQ 1
     C                     MOVE 1000      UNITE
F3  C                     END
    C** 100 M2
    C*********
D3  C           UVENT     IFEQ 2
     C                     MOVE 100       UNITE
     C                     MOVE 'M2'      CVUNIT
F3  C                     END
    C** 100 ML
    C*********
D3  C           UVENT     IFEQ 3
     C                     MOVE 100       UNITE
     C                     MOVE 'ML'      CVUNIT
F3  C                     END
    C** 100 KG
    C*********
D3  C           UVENT     IFEQ 4
     C                     MOVE 100       UNITE
     C                     MOVE 'KG'      CVUNIT
F3  C                     END
    C** A L UNITE
    C************
D3  C           UVENT     IFEQ 5
     C                     MOVE 1         UNITE
F3  C                     END
F2  C                     END
    C* LIBELLE USINE
     C                     MOVE *BLANKS   LIBUSI
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINE     VALE      P
     C           CLPARA    CHAINPARAME               38
D2  C           *IN38     IFEQ '0'
     C                     MOVELPXLIBE    LIBUSI
F2  C                     END
    C*
     C                     MOVE TICLI     MICLI
     C                     MOVE TACLI     MACLI
     C                     MOVE TYNPOR    TYPOR
    C*
     C   60      CLEPRO    CHAINRECAPT               85
     C   60N85             SETON                     86    TRT ULTERIEUR
     C   86                SETOF                     60
D2  C           R2        IFNE 0
     C                     SETON                     55
     C                     SETOF                     96
     C                     WRITEF9
    C           NCONFZ    CABNE0                    U8U8
D3  C           NCONFZ    IFEQ 0
D4  C           ANPRO     IFNE 0
     C                     SETON                     U8
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     Z-ADD*ZEROS    NOPRO
     C                     SETON                     33
    C                     GOTO FORM07
F2  C                     END
F1  C                     END
     C           FORM08    TAG
    C**         ******    ***
     C                     MOVE ' '       RPAP
D1  C           ZB11      IFEQ '*'                        FORME SOFH.
     C                     SETON                     95
X1  C                     ELSE
     C                     SETOF                     95
F1  C                     END
     * RECHERCHE DES OBSPRO DEST=MODIF
     * -------------------------------
     *
     C                     MOVEL'CIAL'    DEST      P
     C                     MOVE *BLANKS   LIBOB1
     C                     MOVE *BLANKS   LIBOB2
     C           CLEOBS    CHAINOBSPROL1             88
D1  C           *IN88     IFEQ '0'
     C                     MOVE OBSLIB    LIBOB1
F1  C                     END
     C           CLEOBS    READEOBSPROL1                 88
D1  C           *IN88     IFEQ '0'
     C                     MOVE OBSLIB    LIBOB2
F1  C                     END
     *  REMPLACE PAR SI AMALGAME
     C                     MOVE STE       ALMSTE
     C                     MOVE NOCLI     ALMCLI
     C                     MOVE NOPRO     ALMPRO
     C           CLEALM    CHAINCODBARL1             88
     C  N88                MOVELTAUG,3    LIBOB2
     *
     C           TF9A      TAG
     C                     EXFMTF9A
     C                     MOVE NOPRO     NOPOUT
     *
     * Interrogation du Produit (DEV015£)
     * ----------------------------------
D1  C           *IN44     IFEQ '1'
     C                     MOVE NOCLI     NOC10
     C                     MOVE NOPRO     NOP10
     C                     CALL 'DEV015£'
     C                     PARM           PARM10
    C                     GOTO FORM08
F1  C                     END
    C** CHOIX D UN AUTRE PRODUIT
    C***************************
D1  C           *IN05     IFEQ '1'
     C                     MOVE *BLANKS   NOPRO
     C                     MOVE *BLANKS   PSERIE
     C                     MOVE *BLANKS   PREVIS
     C                     MOVE *BLANKS   RECPRO
    C                     GOTO FORM07
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
     C                     SETOF                     95
    C** SI PAS DE PRODST4 APPEL PRODU60£
    C************************************
D1  C           NOCLI     IFNE 8928
    C           NOCLI     ANDNE9999
    C           NOCLI     ANDNE9992
    C           NOCLI     ANDNE9993
    C           NOCLI     ANDNE9995
    C           NOCLI     ANDNE9996
     C           CLEPRO    SETLLPRODST4                  88
D2  C           *IN88     IFEQ '0'
     C                     MOVE STE       STE60
     C                     MOVE NOCLI     NOC60
     C                     MOVE NOPRO     NOP60
     C                     CALL 'PRODU60£'
     C                     PARM           PRODU6
    C                     GOTO TF9A
F2  C                     END
F1  C                     END
     *
     * RECHERCHE CONFORMITE ADRESSE DE LIVRAISON
     *
D1  C           RGLIV     IFNE 0
     C                     MOVE STE       ST13£
     C                     MOVE NOCLI     CLI13£
     C                     MOVE NOPRO     PRO13£
     C                     MOVE ANPRO     ANP13£
     C                     MOVE RGLIV     RGL13£
     C                     CALL 'CDEC13£'
     C                     PARM           DS13£
F1  C                     END
     *
     C/EJECT
    C*****************************************************
    C** AFFICHAGES FORMATS DOSSIERS MATERIELS            *
    C*****************************************************
     C           GARNI1    TAG
    C**         ******    ***
     C                     SETOF                     646566
     C                     SETOF                     676830
     C                     Z-ADD0         REP     10
     C                     Z-ADD0         REP1    10
     C                     Z-ADD0         EXT
     C                     Z-ADD0         INT
     C                     MOVE ' '       WXYZ
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
D1  C           *IN86     IFEQ '0'
    C** POUR CODE FACONNAGE 6 7 8 AFFICHAGE DU FORMAT
    C************************************************
D2  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
    C                     GOTO FORM09
X2  C                     ELSE
    C** POUR CODE DIFFERENTS MAIS AVEC IMPRESSION AFFICHAGE
    C******************************************************
     C                     XFOOTTIM       TIMZON  20
     C                     XFOOTTRE       TIMZOR  20
     C                     ADD  TIMZOR    TIMZON
    C           TIMZON    CABNE0         FORM09
     C                     MOVE '*'       WXYZ    1
    C                     GOTO FORSWX
F2  C                     END
     C           FORM09    TAG
    C**         ******    ***
    C** RECHERCHE DE L IMPRESSION PRINCIPALE
    C***************************************
D2  C           TIM,3     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,3     EXT     10
     C                     MOVE COU,3     COUPEX  1
    C                     GOTO IMPRES
F2  C                     END
D2  C           TIM,2     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,2     EXT     10
     C                     MOVE COU,2     COUPEX
    C                     GOTO IMPRES
F2  C                     END
D2  C           TIM,1     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,1     EXT     10
     C                     MOVE COU,2     COUPEX
F2  C                     END
     C           IMPRES    TAG
    C**         ******    ***
D2  C           TIM,4     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,4     INT     10
     C                     MOVE COU,4     COUPIN  1
    C                     GOTO IMPRE1
F2  C                     END
D2  C           TIM,5     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,5     INT
     C                     MOVE COU,5     COUPIN
    C                     GOTO IMPRE1
F2  C                     END
D2  C           TIM,6     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,6     INT
     C                     MOVE COU,6     COUPIN
    C                     GOTO IMPRE1
F2  C                     END
D2  C           TIM,7     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,7     INT
     C                     MOVE COU,7     COUPIN
F2  C                     END
     C           IMPRE1    TAG
    C**         ******    ***
D2  C           EXT       IFNE 0
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE EXT       VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPPEX
F3  C                     END
F2  C                     END
D2  C           INT       IFNE 0
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE INT       VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPPIN
F3  C                     END
F2  C                     END
D2  C           REFDOR    IFNE *BLANKS
     C                     SETON                     66
F2  C                     END
D2  C           GFRA      IFNE *BLANKS
     C                     SETON                     67
     C                     MOVE 'RT'      USGAUF
X2  C                     ELSE
     C                     MOVE '  '      USGAUF
F2  C                     END
D2  C           USINE     IFNE *ZEROS
     C                     SETON                     68
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINE     VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    USDECO
F3  C                     END
F2  C                     END
    C** RECHERCHE DE L IMPRESSION REPRISE
    C************************************
D2  C           TRE,1     IFNE 0
     C                     MOVE TRE,1     REP1    10
     C                     SETON                     64
F2  C                     END
D2  C           TRE,2     IFNE 0
     C                     MOVE TRE,2     REP1    10
     C                     SETON                     64
F2  C                     END
D2  C           TRE,3     IFNE 0
     C                     MOVE TRE,3     REP1    10
     C                     SETON                     64
F2  C                     END
D2  C           TRE,4     IFNE 0
     C                     MOVE TRE,4     REP     10
     C                     SETON                     65
F2  C                     END
D2  C           TRE,5     IFNE 0
     C                     MOVE TRE,5     REP     10
     C                     SETON                     65
F2  C                     END
D2  C           TRE,6     IFNE 0
     C                     MOVE TRE,6     REP     10
     C                     SETON                     65
F2  C                     END
D2  C           TRE,7     IFNE 0
     C                     MOVE TRE,7     REP     10
     C                     SETON                     65
F2  C                     END
D2  C           REP1      IFNE 0
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE REP1      VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPREX
F3  C                     END
F2  C                     END
D2  C           REP       IFNE 0
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE REP       VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPRIN
F3  C                     END
F2  C                     END
    C** SI AFFICHES
    C**********************************
     C           FORSWX    TAG
     C                     Z-ADDNOPRO     PRODOR
     C           CLEPR3    SETLLPRODS3L1
     C           STPR3     TAG
     C           CLEPR3    READEPRODS3L1                 88
D2  C           *IN88     IFEQ '0'
D3  C           GAUF1     IFNE *BLANKS
     C                     SETON                     67
     C                     MOVE 'RT'      USGAUF
F3  C                     END
D3  C           SUPOR     IFEQ 'E'
D4  C           IMPA      IFNE *ZEROS
     C                     SETON                     64
     C                     Z-ADDIMPA      EXT
     C                     Z-ADDUSA       USEXT
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE IMPA      VALE      P
     C           CLPARA    CHAINPARAME               38
D5  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPPEX
F5  C                     END
D5  C           RIMA1     IFNE *ZEROS
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE RIMA1     VALE      P
     C           CLPARA    CHAINPARAME               38
D6  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPREX
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           IMPA      IFNE *ZEROS
     C                     SETON                     65
     C                     Z-ADDIMPA      INT
     C                     Z-ADDUSA       USINT
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE IMPA      VALE      P
     C           CLPARA    CHAINPARAME               38
D5  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPPIN
F5  C                     END
D5  C           RIMA1     IFNE *ZEROS
     C                     MOVE 'IMPR'    ARGU
     C                     MOVE RIMA1     VALE      P
     C           CLPARA    CHAINPARAME               38
D6  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    IMPRIN
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
    C                     GOTO STPR3
F2  C                     END
    C           WXYZ      CABEQ'*'       FORSUI
    C** AFFICHAGE DES USINES
    C***********************
D2  C           USEXT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USEXT     VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    USIMEX
F3  C                     END
F2  C                     END
D2  C           USINT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINT     VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    USIMIN
F3  C                     END
F2  C                     END
    C** TEST EXISTANCE DOSSIER MATERIEL
    C**********************************
     C                     SETON                     88
     C           CLEPLA    CHAINPLAMAL1              38
D2  C           *IN38     IFEQ '0'
    C           MOKTRA    ANDEQ*ZEROS
     C                     EXSR SPPLAM
     C                     SETOF                     88
F2  C                     END
     C                     Z-ADDNOPRO     PRODOR
     C                     Z-ADDNOPRO     NOPROX
     C                     MOVEL'8'       NOPROX
     C           CLEPLX    CHAINPLAMAL1              38
D2  C           *IN38     IFEQ '0'
    C           MOKTRA    ANDEQ*ZEROS
     C                     EXSR SPPLAM
     C                     SETOF                     88
F2  C                     END
     C                     MOVEL'9'       NOPROX
     C           CLEPLX    CHAINPLAMAL1              38
D2  C           *IN38     IFEQ '0'
    C           MOKTRA    ANDEQ*ZEROS
     C                     EXSR SPPLAM
     C                     SETOF                     88
F2  C                     END
     C                     Z-ADDPRODOR    NOPRO
    C** DECODAGE UNITE DE VENTE
    C**************************
     C                     MOVE *BLANKS   UNITE
     C                     MOVE *BLANKS   CVUNIT
    C** AUX 1000
    C***********
D2  C           UVENT     IFEQ 1
     C                     MOVE 1000      UNITE
F2  C                     END
    C** 100 M2
    C*********
D2  C           UVENT     IFEQ 2
     C                     MOVE 100       UNITE
     C                     MOVE 'M2'      CVUNIT
F2  C                     END
    C** 100 ML
    C*********
D2  C           UVENT     IFEQ 3
     C                     MOVE 100       UNITE
     C                     MOVE 'ML'      CVUNIT
F2  C                     END
    C** 100 KG
    C*********
D2  C           UVENT     IFEQ 4
     C                     MOVE 100       UNITE
     C                     MOVE 'KG'      CVUNIT
F2  C                     END
    C** A L UNITE
    C************
D2  C           UVENT     IFEQ 5
     C                     MOVE 1         UNITE
F2  C                     END
    C** AFFICHAGE NUMERO DE MATERIEL EN TETE DU FORMAT
    C*************************************************
     C                     MOVE REREP     REREP0
     C                     MOVELDEMAN     REPIN0
     C           FORM10    TAG
    C**         ******    ***
D2  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN68     OREQ '1'
    C   88                GOTO SUISUI
X2  C                     ELSE
    C                     GOTO CDESOL
F2  C                     END
D2  C           *IN88     IFEQ '0'
     C                     WRITEF12
     C           FOR10A    TAG
    C**         ******    ***
     C                     EXFMTF13
F2  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F2  C                     END
     C                     MOVE *ZEROS    STMEXX
     C                     MOVE *ZEROS    STMINX
     C                     MOVE *ZEROS    STMGOX
     C                     MOVE *ZEROS    STMGAX
     C                     MOVE *ZEROS    STMDEX
D2  C           *IN88     IFEQ '0'
    C** FORMATAGE FORMAT 10 BAS
    C**************************
    C** IMPRESSION EXTERIEURE
    C************************
     * A LA DEMANDE DE J.LUC LASVERGNAS NE PLUS METTRE EN CRÉATION
D3  C           NCONFZ    IFEQ 0
D4  C           ETAT01    IFEQ 'C'
     C                     MOVE 1         STMEXX
F4  C                     END
F3  C                     END
D3  C           ETAT01    IFEQ 'M'
     C                     MOVE 2         STMEXX
F3  C                     END
D3  C           ETAT01    IFEQ ' '
     C                     MOVE 3         STMEXX
F3  C                     END
D3  C           ETAT01    IFEQ 'E'
     C                     MOVE 3         STMEXX
F3  C                     END
D3  C           ETAT01    IFEQ 'R'
     C                     MOVE 4         STMEXX
F3  C                     END
    C** IMPRESSION INTERIEURE
    C************************
     * A LA DEMANDE DE J.LUC LASVERGNAS NE PLUS METTRE EN CRÉATION
D3  C           NCONFZ    IFEQ 0
D4  C           ETAT03    IFEQ 'C'
     C                     MOVE 1         STMINX
F4  C                     END
F3  C                     END
D3  C           ETAT03    IFEQ 'M'
     C                     MOVE 2         STMINX
F3  C                     END
D3  C           ETAT03    IFEQ ' '
     C                     MOVE 3         STMINX
F3  C                     END
D3  C           ETAT03    IFEQ 'E'
     C                     MOVE 3         STMINX
F3  C                     END
D3  C           ETAT03    IFEQ 'R'
     C                     MOVE 4         STMINX
F3  C                     END
    C** DORURE
    C*********
     * A LA DEMANDE DE J.LUC LASVERGNAS NE PLUS METTRE EN CRÉATION
D3  C           NCONFZ    IFEQ 0
D4  C           ETAOR     IFEQ 'C'
     C                     MOVE 1         STMGOX
F4  C                     END
F3  C                     END
D3  C           ETAOR     IFEQ 'M'
     C                     MOVE 2         STMGOX
F3  C                     END
D3  C           ETAOR     IFEQ ' '
     C                     MOVE 3         STMGOX
F3  C                     END
D3  C           ETAOR     IFEQ 'E'
     C                     MOVE 3         STMGOX
F3  C                     END
D3  C           ETAOR     IFEQ 'R'
     C                     MOVE 4         STMGOX
F3  C                     END
    C** GAUFRAGE
    C***********
     * A LA DEMANDE DE J.LUC LASVERGNAS NE PLUS METTRE EN CRÉATION
D3  C           NCONFZ    IFEQ 0
D4  C           ETAGAU    IFEQ 'C'
     C                     MOVE 1         STMGAX
F4  C                     END
F3  C                     END
D3  C           ETAGAU    IFEQ 'M'
     C                     MOVE 2         STMGAX
F3  C                     END
D3  C           ETAGAU    IFEQ ' '
     C                     MOVE 3         STMGAX
F3  C                     END
D3  C           ETAGAU    IFEQ 'E'
     C                     MOVE 3         STMGAX
F3  C                     END
D3  C           ETAGAU    IFEQ 'R'
     C                     MOVE 4         STMGAX
F3  C                     END
    C** DECOUPAGE
    C************
     * A LA DEMANDE DE J.LUC LASVERGNAS NE PLUS METTRE EN CRÉATION
D3  C           NCONFZ    IFEQ 0
D4  C           ETAFOR    IFEQ 'C'
     C                     MOVE 1         STMDEX
F4  C                     END
F3  C                     END
D3  C           ETAFOR    IFEQ 'M'
     C                     MOVE 2         STMDEX
F3  C                     END
D3  C           ETAFOR    IFEQ ' '
     C                     MOVE 3         STMDEX
F3  C                     END
D3  C           ETAFOR    IFEQ 'E'
     C                     MOVE 3         STMDEX
F3  C                     END
D3  C           ETAFOR    IFEQ 'R'
     C                     MOVE 4         STMDEX
F3  C                     END
F2  C                     END
     C                     MOVEA'00000'   *IN,35
     C                     MOVEA'00000'   *IN,40
     C                     MOVEA'00000'   *IN,45
    C** AFFICHAGE DOSSIER MATERIEL SI EXISTANT
    C*****************************************
     C           SUISUI    TAG
    C**         ******    ***
     C                     WRITEF12
     C           SUISI1    TAG
    C**         ******    ***
    C** FORMATAGE DE F14
    C*******************
     C                     MOVE *IN70     REF70   1
     C           USAISI    COMP '*'                      70
     C                     EXFMTF14
     C                     MOVE REF70     *IN70
     C                     SETOF                     34
     *
     C                     MOVE 'NOSO'    ARGU
     C                     MOVE *BLANKS   VALE
D2  C           MATSTE    IFNE 0
     C                     MOVE MATSTE    VALE
     C           CLPARA    CHAINPARAME               25
    C           *IN25     CABEQ'1'       SUISI1
F2  C                     END
D2  C           MATSTI    IFNE 0
     C                     MOVE MATSTI    VALE
     C           CLPARA    CHAINPARAME               26
    C           *IN26     CABEQ'1'       SUISI1
F2  C                     END
D2  C           MATSTD    IFNE 0
     C                     MOVE MATSTD    VALE
     C           CLPARA    CHAINPARAME               27
    C           *IN27     CABEQ'1'       SUISI1
F2  C                     END
D2  C           MATSTG    IFNE 0
     C                     MOVE MATSTG    VALE
     C           CLPARA    CHAINPARAME               28
    C           *IN28     CABEQ'1'       SUISI1
F2  C                     END
D2  C           MATSDE    IFNE 0
     C                     MOVE MATSDE    VALE
     C           CLPARA    CHAINPARAME               29
    C           *IN29     CABEQ'1'       SUISI1
F2  C                     END
     *
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D2  C           *IN05     IFEQ '1'
     C                     MOVE *BLANKS   ZAZ256256
     C                     CALL 'CLIE04£'
     C                     PARM           ZAZ256
    C                     GOTO SUISUI
F2  C                     END
D2  C           *IN07     IFEQ '1'
    C                     GOTO FORM10
F2  C                     END
    C** APPEL DE PRODU03£ RECHERCHE DES PRODUITS PAR FORME
    C*****************************************************
D2  C           *IN08     IFEQ '1'
     C                     MOVE NOFOR     FORNO   50
     C                     MOVE '1'       ZONE95
     C                     CALL 'PRODU03£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
     C                     MOVE FORNO     NOFOR
    C                     GOTO SUISUI
F2  C                     END
     *
D2  C           *IN15     IFEQ '1'
     C                     MOVE STE       £STE
     C                     MOVE NOCLI     £NOCLI
     C                     MOVE NOPRO     £NOPRO
     C                     MOVE INCLU     £TAUX
     C                     CALL 'PRODU27£'
     C                     PARM           PARM27
     C                     MOVE £TAUX     INCLU
     C                     WRITEF12
    C                     GOTO SUISUI
F2  C                     END
     *
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU  1
    C                     GOTO SUISUI
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
    C** TEST SI STATUT MATERIEL SAISI
    C********************************
     C                     MOVE *BLANK    SAIMAT  1
D2  C           *IN64     IFEQ '1'
    C           STMEXX    ANDEQ0
     C                     Z-ADD12        ZLSM
     C                     EXFMTWSM
    C   22                GOTO SUISI1
     C                     MOVE '1'       SAIMAT
D3  C           STM1      IFEQ 'X'
     C                     Z-ADD1         STMEXX
F3  C                     END
D3  C           STM2      IFEQ 'X'
     C                     Z-ADD2         STMEXX
F3  C                     END
D3  C           STM3      IFEQ 'X'
     C                     Z-ADD3         STMEXX
F3  C                     END
D3  C           STM4      IFEQ 'X'
     C                     Z-ADD4         STMEXX
F3  C                     END
F2  C                     END
D2  C           *IN65     IFEQ '1'
    C           STMINX    ANDEQ0
     C                     Z-ADD24        ZLSM
     C                     EXFMTWSM
    C   22                GOTO SUISI1
     C                     MOVE '1'       SAIMAT
D3  C           STM1      IFEQ 'X'
     C                     Z-ADD1         STMINX
F3  C                     END
D3  C           STM2      IFEQ 'X'
     C                     Z-ADD2         STMINX
F3  C                     END
D3  C           STM3      IFEQ 'X'
     C                     Z-ADD3         STMINX
F3  C                     END
D3  C           STM4      IFEQ 'X'
     C                     Z-ADD4         STMINX
F3  C                     END
F2  C                     END
D2  C           *IN67     IFEQ '1'
    C           STMGAX    ANDEQ0
     C                     Z-ADD48        ZLSM
     C                     EXFMTWSM
    C   22                GOTO SUISI1
     C                     MOVE '1'       SAIMAT
D3  C           STM1      IFEQ 'X'
     C                     Z-ADD1         STMGAX
F3  C                     END
D3  C           STM2      IFEQ 'X'
     C                     Z-ADD2         STMGAX
F3  C                     END
D3  C           STM3      IFEQ 'X'
     C                     Z-ADD3         STMGAX
F3  C                     END
D3  C           STM4      IFEQ 'X'
     C                     Z-ADD4         STMGAX
F3  C                     END
F2  C                     END
D2  C           *IN68     IFEQ '1'
    C           STMDEX    ANDEQ0
     C                     Z-ADD61        ZLSM
     C                     EXFMTWSM
    C   22                GOTO SUISI1
     C                     MOVE '1'       SAIMAT
D3  C           STM1      IFEQ 'X'
     C                     Z-ADD1         STMDEX
F3  C                     END
D3  C           STM2      IFEQ 'X'
     C                     Z-ADD2         STMDEX
F3  C                     END
D3  C           STM3      IFEQ 'X'
     C                     Z-ADD3         STMDEX
F3  C                     END
D3  C           STM4      IFEQ 'X'
     C                     Z-ADD4         STMDEX
F3  C                     END
F2  C                     END
    C           SAIMAT    CABNE*BLANK    SUISI1
    C* EXTERIEUR
    C***********
D2  C           *IN64     IFEQ '1'
     C                     MOVE '1'       TTA
     C                     MOVE DSEXT     DSGEN
     C                     EXSR TESGEN
    C   23                GOTO SUISI1
    C   25                GOTO SUISI1
    C   35                GOTO SUISI1
    C   40                GOTO SUISI1
    C   45                GOTO SUISI1
    C   55                GOTO SUISI1
    C   24                GOTO SUISI1
    C   50                GOTO SUISI1
F2  C                     END
    C* INTERIEUR
    C***********
D2  C           *IN65     IFEQ '1'
     C                     MOVE '2'       TTB
     C                     MOVE DSINT     DSGEN
     C                     EXSR TESGEN
    C   31                GOTO SUISI1
    C   51                GOTO SUISI1
    C   74                GOTO SUISI1
    C   26                GOTO SUISI1
    C   36                GOTO SUISI1
    C   41                GOTO SUISI1
    C   46                GOTO SUISI1
    C   56                GOTO SUISI1
F2  C                     END
    C* GAUFRAGE
    C**********
D2  C           *IN66     IFEQ '1'
     C                     MOVE '5'       TTE
     C                     MOVE DSDOR     DSGEN
     C                     EXSR TESGEN
    C   32                GOTO SUISI1
    C   52                GOTO SUISI1
    C   76                GOTO SUISI1
    C   27                GOTO SUISI1
    C   37                GOTO SUISI1
    C   42                GOTO SUISI1
    C   47                GOTO SUISI1
    C   57                GOTO SUISI1
F2  C                     END
    C* GAUFRAGE
    C**********
D2  C           *IN67     IFEQ '1'
     C                     MOVE '3'       TTC
     C                     MOVE DSGAU     DSGEN
     C                     EXSR TESGEN
    C   33                GOTO SUISI1
    C   53                GOTO SUISI1
    C   83                GOTO SUISI1
    C   28                GOTO SUISI1
    C   38                GOTO SUISI1
    C   43                GOTO SUISI1
    C   48                GOTO SUISI1
    C   58                GOTO SUISI1
F2  C                     END
    C* DECOUPAGE
    C***********
D2  C           *IN68     IFEQ '1'
     C                     MOVE '4'       TTD
     C                     MOVE DSDEC     DSGEN
D3  C           STMGEN    IFEQ 0
     C                     Z-ADD61        ZLSM
     C                     EXFMTWSM
D4  C           STM1      IFEQ 'X'
     C                     Z-ADD1         STMGEN
F4  C                     END
D4  C           STM2      IFEQ 'X'
     C                     Z-ADD2         STMGEN
F4  C                     END
D4  C           STM3      IFEQ 'X'
     C                     Z-ADD3         STMGEN
F4  C                     END
D4  C           STM4      IFEQ 'X'
     C                     Z-ADD4         STMGEN
F4  C                     END
F3  C                     END
     C                     MOVE DSGEN     DSDEC
     C                     EXSR TESGEN
    C   34                GOTO SUISI1
    C   54                GOTO SUISI1
    C   94                GOTO SUISI1
    C   29                GOTO SUISI1
    C   39                GOTO SUISI1
    C   44                GOTO SUISI1
    C   49                GOTO SUISI1
    C   59                GOTO SUISI1
F2  C                     END
     * CONTRÔLE QUE LES % DE FRAIS INCLUS SOIENT IDENTIQUES AU TOTAL
     * RENSEIGNE AU PRODUIT
     C                     Z-ADDFRINCS    WINCLU
     C                     ADD  FRINCI    WINCLU
     C                     ADD  FRINCD    WINCLU
     C                     ADD  FRINCG    WINCLU
     C                     ADD  FRINDE    WINCLU
D2  C           INCLU     IFNE 0
    C           WINCLU    ANDNEINCLU
     C                     MOVE '1'       *IN81
    C                     GOTO SUISI1
F2  C                     END
F1  C                     END
    C** AFFICHAGE DERNIERE COMMANDE EN COURS
    C***************************************
     C           FORSUI    TAG
    C**         ******    ***
     C           CLECOU    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           CLECOU    SETLLCDESL11                  38
D1  C           *IN38     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     MOVE NOPRO     NOPOUT
     C                     CALL 'CDEC20L'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F1  C                     END
     C/EJECT
    C** AFFICHAGE DU STOCK EXISTANT
    C******************************
D1  C           *IN86     IFEQ '0'
     C                     MOVE *BLANKS   LIE
     C                     MOVE *BLANKS   STPFIN
     C                     Z-ADD0         STK
     C                     SETOF                     1617
     C                     XFOOTSTO       ZSTOC   90
D2  C           ZSTOC     IFNE 0
     C                     SETON                     16
F2  C                     END
     *
     C                     Z-ADD0         YY      10
D2  C           1         DO   8         XX      10
     C           0         COMP STO,XX               3838
D3  C           *IN38     IFEQ '1'
     C                     SETON                     17
     C                     ADD  1         YY
     C                     ADD  STO,XX    STPFIN
     C                     ADD  STO,XX    STK,YY
     C                     MOVE *BLANKS   VALE
     C                     MOVE 'LIEU'    ARGU
     C                     MOVE XX        VALE
     C           CLPARA    CHAINPARAME               80
     C        N80          MOVELPXABRG    LIE,YY                          PROD13
F3  C                     END
F2  C                     END
    C** RECHERCHE SI STOCK PRE IMPRIME
    C** OU STOCK PRE IMPRIME STOCKE
    C*********************************
    C** PREIMPRIME STOCKE
    C********************
     C                     Z-ADD*ZEROS    SOCIET
     C                     Z-ADD*ZEROS    R3
D2  C           NIMPE1    IFEQ *BLANKS
    C           NIMPI1    ANDEQ*BLANKS
    C                     GOTO RECIMP
F2  C                     END
D2  C           NIMPE1    IFNE *BLANKS
    C           NIMPE1    ANDNENIMPI1
    C           NIMPE2    ANDNENIMPI2
     C                     MOVE NIMPE1    IM11
     C                     MOVE NIMPE2    IM22
     C                     EXSR RECSTO
D3  C           FFF       IFNE 0
     C                     SETON                     17
F3  C                     END
F2  C                     END
D2  C           NIMPI1    IFNE *BLANKS
    C           NIMPI1    ANDNENIMPE1
    C           NIMPI2    ANDNENIMPE2
     C                     MOVE NIMPI1    IM11
     C                     MOVE NIMPI2    IM22
     C                     EXSR RECSTO
D3  C           FFF       IFNE 0
     C                     SETON                     17
F3  C                     END
F2  C                     END
D2  C           NIMPI1    IFEQ NIMPE1
    C           NIMPI2    ANDEQNIMPE2
     C                     MOVE NIMPE1    IM11
     C                     MOVE NIMPE2    IM22
     C                     SETON                     18
     C                     EXSR RECSTO
     C                     SETOF                     18
D3  C           FFF       IFNE 0
     C                     SETON                     17
F3  C                     END
F2  C                     END
     C           RECIMP    TAG
    C**         ******    ***
     C                     EXSR RECST1
D2  C           FFF       IFNE 0
     C                     SETON                     17
F2  C                     END
     C           FORM11    TAG
    C**         ******    ***
D2  C           *IN17     IFEQ '1'
     C                     WRITEF16
D3  C           FFF       IFEQ 0
     C                     EXFMTF15
    C** VISU DU STOCK PRODUITS FINIS
    C*******************************
D4  C           *IN05     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     MOVE NOPRO     NOPOUT
     C                     CALL 'PROD32L'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
    C                     GOTO FORM11
F4  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D4  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D5  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM11
F5  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D5  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F5  C                     END
    C                     GOTO FORM01
F4  C                     END
F3  C                     END
D3  C           FFF       IFNE 0
     C                     SETON                     1011
     C                     WRITEF15
     C                     EXFMTF18
     C                     SETOF                     1011
F3  C                     END
    C** VISU DU STOCK PRODUITS FINIS
    C*******************************
D3  C           *IN05     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'PROD32L'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
    C                     GOTO FORM11
F3  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D3  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D4  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM11
F4  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D4  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F4  C                     END
    C                     GOTO FORM01
F3  C                     END
F2  C                     END
    C                     GOTO OUIU8
F1  C                     END
     C/EJECT
    C** AFFICHAGE DU FORMAT 15
    C**************************
     C           OUIU8     TAG
D1  C           *INU8     IFEQ '1'
     C                     MOVE *BLANKS   ACTPRO
     C                     MOVE *BLANKS   ANCPRO
     C                     MOVE ANPRO     ALTPRO
     C                     MOVE NOPRO     NEUPRO
     C                     MOVE NOPRO     TUBESS  40
     C                     MOVE ANPRO     NOPRO
     C           CLEPRO    CHAINPRODUI2              14
     C                     MOVE TUBESS    NOPRO
     C           CLEPRO    CHAINPRODUI2              38
     C           FORM12    TAG
    C**         ******    ***
     C                     EXFMTF19
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM12
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
D2  C           ACTPRO    IFEQ ' '
    C           ANCPRO    ANDEQ' '
    C                     GOTO CDESOL
F2  C                     END
     C           FORM13    TAG
    C**         ******    ***
     C                     EXFMTF20
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM13
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
D2  C           BILCO     IFEQ ' '
    C           BILCA     ANDEQ' '
    C           BILHIS    ANDEQ' '
    C                     GOTO CDESOL
F2  C                     END
    C** AFFICHAGE DERNIERE COMMANDE ENREGISTREE
    C******************************************
D2  C           ACTPRO    IFNE ' '
     C                     MOVE NOPRO     NOPOUT
D3  C           BILCO     IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STAT402£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F3  C                     END
F2  C                     END
D2  C           *IN14     IFEQ '0'
D3  C           ANCPRO    IFNE ' '
     C                     MOVE ANPRO     NOPOUT
D4  C           BILCO     IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STAT402£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F4  C                     END
F3  C                     END
F2  C                     END
    C** AFFICHAGE CADENCEMENT MENSUEL DES EXPEDITIONS
    C************************************************
D2  C           *IN86     IFEQ '0'
D3  C           ACTPRO    IFNE ' '
     C                     MOVE NOPRO     NOPOUT
D4  C           BILCA     IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STA400£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           *IN14     IFEQ '0'
D3  C           *IN86     IFEQ '0'
D4  C           ANCPRO    IFNE ' '
     C                     MOVE ANPRO     NOPOUT
D5  C           BILCA     IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STA400£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
    C** AFFICHAGE HISTORIQUE DES FACTURATIONS
    C****************************************
D2  C           ACTPRO    IFNE ' '
     C                     MOVE NOPRO     NOPOUT
D3  C           BILHIS    IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STAT401£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F3  C                     END
F2  C                     END
D2  C           *IN14     IFEQ '0'
D3  C           ANCPRO    IFNE ' '
     C                     MOVE ANPRO     NOPOUT
D4  C           BILHIS    IFNE ' '
     C                     MOVE '1'       ZONE95
     C                     CALL 'STAT401£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F4  C                     END
F3  C                     END
F2  C                     END
    C                     GOTO FORM12
F1  C                     END
    C********************************************************************
     C/EJECT
    C********************************************************************
    C** FORMAT DE DEMANDE DE LA QUANTITE A COMMANDER                    *
    C********************************************************************
     C           CDESOL    TAG
    C**         ******    ***
     C                     SETOF                     U52087
     C                     SETOF                     303415
    C* QUANTITÉ IMPERATIVE SUR PALETTES
    C*-----------------------------------------
     C                     MOVE *BLANKS   IN82    1
D1  C           RUV1      IFEQ 'O'
     C                     Z-ADD1         EMBNO
     C           CLEEMB    CHAINCAISSEL1             99
    C   99                GOTO FINEMB
    C           EMBNAT    CABEQ'Q'       FINEMB
     C           EMBHT     DIV  10        HCAIS   31
     C           CLEEMB    CHAINPALETTL1             99
    C   99                GOTO FINEMB
    C           NBDECP    CABEQ*ZEROS    FINEMB
    C           HCAIS     CABEQ*ZEROS    FINEMB
D2  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D3  C           UVENT     IFEQ 3
     C                     MULT DECH      NBDECP
     C                     MULT DECH      NBRUNI
F3  C                     END
F2  C                     END
     C           EMBHT     SUB  15        HPAL    41
     C           HPAL      DIV  HCAIS     NBRC    20
     C           NBCAIP    DIV  NBRC      NBRCC   20
     C           NBRC      DIV  2         NBRCP   20
     C                     MVR            RESTEX  20
D2  C           RESTEX    IFNE *ZEROS
     C                     ADD  1         NBRCP
F2  C                     END
     C           NBRCP     MULT NBRCC     IMPCP
     C           IMPCP     MULT NBRUNI    IMPPP
     C                     MOVE '*'       IN82
F1  C                     END
     C           FINEMB    TAG
    C*
    C           *IN84     CABEQ'1'       FORM14
     C           CLEPRO    CHAINPRODUI2              U5
     C                     MOVE *IN17     IN17
     C           CLEPGR    CHAINCOMPREL5             17
D1  C           *IN17     IFEQ '0'
     C                     MOVE GARGAR    GARNT
F1  C                     END
     C                     MOVE IN17      *IN17
     C           CLEPRO    CHAINRECAPT               24
     C     N24 86          Z-ADD0         TYPOR
     C                     Z-ADD*ZEROS    FLD005
     C                     Z-ADD*ZEROS    BOBPDS
D1  C           *IN30     IFEQ '1'
    C           DECH      ANDEQ0
     C                     SETOF                     3034
F1  C                     END
     ** TRAITEMENT BOBINETTE POUR ARTICLE DE PRODUI2 UNIQUEMENT
     **********************************************************
D1  C           *INU5     IFEQ '0'
     C                     MOVE TYNPOR    TYPOR
D2  C           FACON     IFEQ 1
    C           FACON     OREQ 2
    C           UVENT     ANDEQ4
     C                     Z-ADDDECH      FLD005
X2  C                     ELSE
     C                     Z-ADD*ZEROS    FLD005
     C                     SETOF                     3034
    C                     GOTO FORM14
F2  C                     END
    C** TRADUCTION DU POIDS DE LA BOBINETTE
    C**************************************
D2  C           DECH      IFNE *ZEROS
     C                     SETON                     15
     C                     MOVELDECL      DECLM   43
    C** SURFACE BOBINE
    C*****************
     C           DECLM     MULT DECH      SURBOB  73
    C** POIDS SUPPORT 3
    C******************
D3  C           NIMPE1    IFEQ *BLANKS
    C           NIMPE2    ANDEQ*BLANKS
     C           SURBOB    MULT GRAM3     PDG3    50
X3  C                     ELSE
     C                     MOVE NIMPE1    ETUDE
     C                     MOVE NIMPE2    SEQDE
     C           CPRIM2    CHAINPREIMP2              38
     C                     MOVE GRAMS     GRAM3
     C           SURBOB    MULT GRAM3     PDG3    50
F3  C                     END
    C** POIDS SUPPORT 4
    C******************
     C           SURBOB    MULT GRAM4     PDG4    50
    C** POIDS TOTAL DE LA BOBINETTE
    C******************************
D3  C           CCOL      IFNE 8
    C           CCOL      ANDNE3
     C                     MOVE 'ONDU'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE ONDUL     VALE
     C           CLPARA    CHAINPARAME               17
     C  N17      PDG4      MULT PXMONT    PDG4
     C           PDG3      ADD  PDG4      PDTOT   60
     C           PDTOT     MULT 0,001     BOBPDS
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     END
     C           FORM14    TAG
    C**         ******    ***
     C                     MOVE ' '       OKQTE   1
    C         U6          GOTO ZIZI
     C                     SETON                     U6
     C                     Z-ADD0         PRIUNX
     C                     Z-ADD0         PXS
     C                     Z-ADD0         PLANC
     C                     Z-ADD0         COMCLJ
     C                     Z-ADD0         COMCLM
     C                     Z-ADD0         COMCLA
     C                     Z-ADD0         COMCLS
     C           ZIZI      TAG
     C                     SETOF                     203487
     C                     SETON                     304445
D1  C           EXT       IFEQ 1
    C           EXT       OREQ 2
    C           EXT       OREQ 4
    C           COUPEX    ANDNE'O'
    C           INT       OREQ 1
    C           INT       OREQ 2
    C           INT       OREQ 4
    C           COUPIN    ANDNE'O'
    C           REP       OREQ 1
    C           REP       OREQ 2
    C           REP       OREQ 4
    C           REP1      OREQ 1
    C           REP1      OREQ 2
    C           REP1      OREQ 4
     C                     SETOF                     30
F1  C                     END
D1  C           STMEXX    IFEQ 3
    C           STMINX    ANDEQ3
     C                     SETON                     34
F1  C                     END
D1  C           STMEXX    IFEQ 3
    C           STMINX    ANDEQ0
     C                     SETON                     34
F1  C                     END
D1  C           STMEXX    IFEQ 0
    C           STMINX    ANDEQ3
     C                     SETON                     34
F1  C                     END
D1  C           STMEXX    IFEQ 0
    C           STMINX    ANDEQ0
     C                     SETON                     34
F1  C                     END
     C  N30                SETON                     20
     C   86                SETOF                     20
     C  N20                SETON                     87
     C  N30 34             SETON                     87
     C                     SETOF                     29
D1  C           UVENT     IFEQ 4
    C           FACON     ANDEQ1
    C           DECH      ANDNE0
    C           UVENT     OREQ 4
    C           FACON     ANDEQ2
    C           DECH      ANDNE0
    C** SI BOBINETTE
    C***************
     C           BOBIF     TAG
     C                     EXFMTFBO
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM14
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
    C           OUINON    CABEQ'NON'     BOBIF1
D2  C           OUINON    IFNE 'NON'
    C           OUINON    ANDNE'OUI'
    C                     GOTO BOBIF
F2  C                     END
    C           OUINON    CABEQ'   '     BOBIF
     C           BOBIF2    TAG
     C                     EXFMTFBO1
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM14
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
    C           BOBFAB    CABEQ0         BOBIF2
    C           ENBOBI    CABEQ0         BOBIF2
     C           ENBOBI    DIV  BOBFAB    NBFAB
     C                     MVR            TRYRY   40
    C           TRYRY     CABNE0         BOBIF2     2424
     C           BOBFAB    MULT BOBPDS    QTFAB     H
     C           QTFAB     MULT NBFAB     QTTOT
F1  C                     END
     C           BOBIF1    TAG
D1  C           IN82      IFEQ '*'
     C                     SETON                     82
F1  C                     END
     C                     EXFMTF21
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D2  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM14
F2  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D2  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F2  C                     END
    C                     GOTO FORM01
F1  C                     END
    C** QUANTITé TOTALE OBLIGATOIRE
    C******************************
    C           QTTOT     CABEQ*ZEROS    BOBIF1         24
     C           QTTOT     MULT 0,95      TOTMIN  70H
     C           QTTOT     MULT 1,05      TOTMAX  70H
    C** QUANTITé PAR FABRICATION OBLIGATOIRE
    C***************************************
     C   84                Z-ADDQTTOT     QTFAB
    C** SI CDE PRE IMP QTREN = QTFAB
    C*******************************
     C   84                Z-ADDQTTOT     QTREN
     C   84                Z-ADDQTTOT     QTIMP
     C   84                Z-ADD1         NBIT
     C   84                Z-ADD1         NBIRE
    C** CALCUL DU NOMBRE DE LIVRAISON
    C********************************
D1  C           *IN84     IFEQ '0'
D2  C           *IN95     IFEQ '0'
     C           ENBOBI    COMP 0                        29
D3  C           ENBOBI    IFNE 0
    C           BOBPDS    ANDNE0
     C           ENBOBI    MULT BOBPDS    TOTMOY  80H
     C           TOTMOY    COMP TOTMIN                 69
     C   69                SETON                     95
    C   69                GOTO BOBIF1
     C           TOTMOY    COMP TOTMAX               69
    C   69                GOTO BOBIF1
    C   69                GOTO BOBIF1
F3  C                     END
F2  C                     END
     C                     Z-ADDQTTOT     QTECAD
     C                     Z-ADD0         QTERES
    C** COMPARAISON ENTRE LIVRAISONS CALCULEES ET SAISIES
    C****************************************************
D2  C           NBFAB     IFEQ *ZEROS
     C                     Z-ADD1         NBFAB
F2  C                     END
D2  C           NBLIV     IFNE *ZEROS
    C           FRLIV     CABEQ0         BOBIF1         25
    C           NBLIV     CABLTNBFAB     BOBIF1       45
X2  C                     ELSE
    C           FRLIV     CABNE0         BOBIF1     2525
F2  C                     END
     C           NBIMP     ADD  NBIRE     NBIT
    C   20      NBIT      CABEQ*ZEROS    BOBIF1         44
    C           NBFAB     CABLTNBIT      BOBIF1       44
    C** QUANTITE IMPERATIVE SUR PALETTE
    C************************************
D2  C           IN82      IFEQ '*'
     C           QTTOT     DIV  NBDECP    NBRPAL  30
     C                     MVR            RESTEZ  92
     C                     Z-ADDNBRPAL    NPMINI  30
    C*
D3  C           RESTEZ    IFNE *ZEROS
    C           OKQTE     ANDEQ*BLANKS
     C           QTTOT     COMP NBDECP               19
     C           NPMINI    MULT NBDECP    QTMINI
     C           NPMINI    ADD  1         NPMAXI
     C           NPMAXI    MULT NBDECP    QTMAXI
     C           DF21W     TAG
     C                     MOVE *BLANK    C1F21
     C                     MOVE *BLANK    C2F21
     C                     MOVE *BLANK    C3F21
     C                     EXFMTF21W
    C*
D4  C           *IN23     IFEQ '1'
     C                     MOVE '1'       OKQTE   1
    C                     GOTO BOBIF1
F4  C                     END
    C*
D4  C           *IN19     IFEQ '1'
D5  C           C1F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DF21W
F5  C                     END
D5  C           C1F21     IFNE *BLANKS
     C                     Z-ADDQTMINI    QTTOT
F5  C                     END
D5  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTTOT
F5  C                     END
X4  C                     ELSE
D5  C           C2F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C2F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DF21W
F5  C                     END
D5  C           C2F21     IFNE *BLANKS
     C                     Z-ADDIMPPP     QTTOT
     C                     MOVE '2'       OKQTE   1
F5  C                     END
D5  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTTOT
F5  C                     END
F4  C                     END
    C                     GOTO BOBIF1
F3  C                     END
    C*
D3  C           OKQTE     IFNE '1'
D4  C           OKQTE     IFEQ '2'
     C                     Z-ADD1         NBRPAL
X4  C                     ELSE
     C           QTTOT     DIV  NBDECP    NBRPAL
F4  C                     END
D4  C           NBLIV     IFGT NBRPAL
    C           NBLIV     ANDGT1
    C           NBFAC     ORGT NBRPAL
    C           NBFAC     ANDGT1
    C           NBIT      ORGT NBRPAL
    C           NBIT      ANDGT1
     C                     SETON                     43
    C                     GOTO BOBIF1
F4  C                     END
F3  C                     END
F2  C                     END
    C**         *         ***
D2  C           NBLIV     IFEQ *ZEROS
     C                     Z-ADDNBFAB     NBLIV
F2  C                     END
D2  C           IN82      IFEQ '*'
    C           OKQTE     ANDNE'1'
D3  C           OKQTE     IFEQ '2'
     C                     Z-ADDIMPPP     NBEPX   60
X3  C                     ELSE
     C                     Z-ADDNBDECP    NBEPX
F3  C                     END
     C           NBRPAL    DIV  NBFAB     NBRPF   30
     C           NBRPF     MULT NBEPX     QTFAB
     C           NBRPAL    DIV  NBLIV     NBRPL   30
     C           NBRPL     MULT NBEPX     QTLIV   80
     C           NBIMP     ADD  NBIRE     NBIT    20
D3  C           NBIT      IFNE *ZEROS
     C           NBRPAL    DIV  NBIT      NBRPI   30
     C           NBRPI     MULT NBEPX     QTIMP
D4  C           NBIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTPRE
F4  C                     END
D4  C           NBIRE     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTREN
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C           QTTOT     DIV  NBFAB     QTFAB
     C           QTTOT     DIV  NBLIV     QTLIV
     C           NBIMP     ADD  NBIRE     NBIT    20
D3  C           NBIT      IFNE *ZEROS
     C           QTTOT     DIV  NBIT      QTIMP
D4  C           NBIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTPRE
F4  C                     END
D4  C           NBIRE     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTREN
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C**         *         ***
D1  C           *IN84     IFEQ '1'
     C                     Z-ADD3         TYPOR
    C           PORAFA    CABNE' '       BOBIF1     1919
    C                     GOTO CADENS
X1  C                     ELSE
D2  C           *IN86     IFEQ '1'
    C           TYPOR     ANDEQ0
     C                     SETON                     32
    C                     GOTO BOBIF1
F2  C                     END
D2  C           TYPOR     IFEQ 3
D3  C           PORAFA    IFEQ ' '
    C                     GOTO FOR15X
F3  C                     END
F2  C                     END
D2  C           TYPOR     IFEQ 3
D3  C           PORAFA    IFNE ' '
D4  C           PORAFA    IFNE '*'
     C                     SETON                     32
    C                     GOTO BOBIF1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           TYPOR     IFNE 3
D3  C           PORAFA    IFNE ' '
     C                     SETON                     32
    C                     GOTO BOBIF1
F3  C                     END
F2  C                     END
     C                     MOVE *BLANKS   TOLE2
     C                     MOVE *BLANKS   TOLE1
     C                     MOVE *BLANKS   TRU
D2  C           GARNT     IFNE 'RE'
     C                     MOVELPOTYPE    TRU     1
D3  C           TRU       IFEQ 'P'
     C                     MOVE 'X'       TOLE2
F3  C                     END
D3  C           TRU       IFEQ 'T'
     C                     MOVE 'X'       TOLE1
F3  C                     END
F2  C                     END
    C                     GOTO FOR15X
     C                     MOVE 'O'       REFUNI
F1  C                     END
     C/EJECT
     C           FOR15X    TAG
    C**         *******   ***
     C                     MOVEL*BLANKS   LIBNCD
     C                     MOVE ' '       UNFOIS  1
D1  C           PSERIE    IFEQ 'P'
     C                     MOVE '2'       NATCDE
X1  C                     ELSE
     C                     MOVE ' '       NATCDE
F1  C                     END
     C                     MOVE 'NCDE'    ARGU
     C                     MOVE NATCDE    VALE      P
     C           CLPARA    CHAINPARAME               38
     C  N38                MOVELPXLIBE    LIBNCD    P
     C           FORM15    TAG
    C**         *******   ***
     C                     SETOF                     9572
     C                     MOVELGARNT     GARATO  1
D1  C           GARATO    IFNE 'R'
    C           GARATO    ANDNE'M'
    C           GARATO    ANDNE' '
     C                     SETON                     72
F1  C                     END
     C                     MOVE *BLANKS   CODOBI
     C                     MOVE 'TOLERE  'CODOBI
     C           CLEOB2    SETLLCLIOBIL2
D1  C                     DO   2         OB      10
     C           CLEOB2    READECLIOBIL2                 38
     C   38                MOVE XAPPS     XAPPSS
    C         38          GOTO MATANT
D2  C           OB        IFEQ 1
     C                     MOVELLIBOBI    LIBTO1
     C                     Z-ADDRGRG11    RGFAC1
     C                     Z-ADDRGRG22    RGLIV1
F2  C                     END
D2  C           OB        IFEQ 2
     C                     MOVELLIBOBI    LIBTO2
     C                     Z-ADDRGRG11    RGFAC2
     C                     Z-ADDRGRG22    RGLIV2
F2  C                     END
F1  C                     END
     C                     MOVE XAPPS     XAPPSS
    C*
     *
     C           MATANT    TAG
    C**         ******    ***
     C                     MOVE *IN70     REF70   1
     C           USAISI    COMP '*'                      70
D1  C           USAISI    IFEQ '*'
     C                     Z-ADD1         PRIUNX
     C                     Z-ADD0         PXS
     C                     Z-ADD0         PLANC
     C                     Z-ADD1         COURS
     C                     MOVE 'EUR'     CODMON
F1  C                     END
     *
     C                     EXFMTF22
     *
     C                     MOVE REF70     *IN70
     C                     SETOF                     72
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D2  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM15
F2  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D2  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F2  C                     END
    C                     GOTO FORM01
F1  C                     END
    C** AFFICHAGE DE L ECRAN D AIDE
    C******************************
D1  C           *IN25     IFEQ '1'
     C                     EXFMTF27
    C                     GOTO FORM15
F1  C                     END
    C** RECHERCHE
D1  C           *IN04     IFEQ '1'
     C                     CLEARDEV002
     C                     MOVEL'NCDE'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DEV002
D2  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      NATCDE
     C                     MOVELLIBEL     LIBNCD
F2  C                     END
    C                     GOTO FORM15
F1  C                     END
     **
D1  C           *IN84     IFEQ '0'
    C** PRIX UNITAIRE OBLIGATOIRE
    C****************************
D2  C           *IN63     IFEQ '0'
    C           *IN21     ANDEQ'0'
    C           USAISI    ANDEQ*BLANK
    C           PRIUNX    CABEQ0         FORM15         22
D3  C           CODMON    IFEQ 'EUR'
    C           PRIUNX    ANDGT99999
     C                     SETON                     22
    C                     GOTO FORM15
F3  C                     END
    C** PX OBLIGATOIRE
    C******************
    C           PXS       CABEQ0         FORM15         23
     C   86                Z-ADDPRIUNX    PIPI    92
     C   86                Z-ADDPXS       PIXS    20
F2  C                     END
F1  C                     END
D1  C           *IN63     IFEQ '1'
    C           *IN21     OREQ '1'
     C                     Z-ADD0         PRIUNX
     C                     Z-ADD0         PXS
F1  C                     END
D1  C           USAISI    IFEQ '*'
     C                     Z-ADD1         PRIUNX
     C                     Z-ADD0         PXS
     C                     Z-ADD0         PLANC
F1  C                     END
     C           PLANC     COMP 0                    0606
    C** IDENTIFICATION PRODUIT CLIENT OBLIGATOIRE
    C********************************************
    C           INDPCL    CABEQ*BLANKS   FORM15         24
    C* TEST DATE DE COMMANDE
    C***********************
     C                     MOVE *YEAR     SUYEA
     C                     MOVE UMONTH    UMONT
     C                     MOVE UDAY      UDAI
D1  C           DACOMM    IFNE 0
     C           CLECAQ    CHAINCALENAL0             25
    C   25                GOTO FORM15
     C                     Z-ADDCALSS     COMCLS
    C           DACOMM    CABGTDATSYS    FORM15     25
X1  C                     ELSE
     C                     Z-ADD*ZEROS    COMCLS
F1  C                     END
D1  C           CLIREF    IFNE *BLANKS
    C           REFUNI    ANDEQ*BLANKS
     C                     SETON                     76
    C                     GOTO FORM15
F1  C                     END
    C** VALIDATION TOLERENCE CLIENT
    C******************************
D1  C           TOLE1     IFNE *BLANKS
    C           TOLE2     ANDNE*BLANKS
     C                     SETON                     26
    C                     GOTO FORM15
F1  C                     END
D1  C           MICLI     IFNE *ZEROS
    C           MACLI     ORNE *ZEROS
D2  C           TOLE1     IFNE *BLANKS
    C           TOLE2     ORNE *BLANKS
     C                     SETON                     26
    C                     GOTO FORM15
F2  C                     END
F1  C                     END
D1  C           MICLI     IFNE *ZEROS
    C           MICLI     ANDLT1,00
     C                     SETON                     26
    C                     GOTO FORM15
F1  C                     END
D1  C           MACLI     IFNE *ZEROS
    C           MACLI     ANDLT1,00
     C                     SETON                     26
    C                     GOTO FORM15
F1  C                     END
    C** TVA  SI CODMON
    C****************************
D1  C           CODMON    IFNE 'EUR'
    C           CODTA     ANDEQ0
     C                     SETON                     32
    C                     GOTO FORM15
F1  C                     END
    C** CONTROLE NATURE COMMANDE
    C****************************
     C                     MOVE 'NCDE'    ARGU
     C                     MOVE NATCDE    VALE      P
     C           CLPARA    CHAINPARAME               33
    C           *IN33     CABEQ'1'       FORM15
     C  N33                MOVELPXLIBE    LIBNCD    P
    C*
D1  C           NATCDE    IFEQ '1'
    C           UNFOIS    ANDEQ' '
     C                     SETON                     34
     C                     MOVE '*'       UNFOIS  1
    C                     GOTO FORM15
F1  C                     END
    C**
D1  C           TOLE1     IFEQ *BLANKS
    C           TOLE2     ANDEQ*BLANKS
    C                     GOTO FORM16
F1  C                     END
    C**
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D2  C           TIM,3     IFNE *ZEROS
     C                     MOVE '4'       PROT    2
F2  C                     END
D2  C           TIM,3     IFEQ *ZEROS
    C           TIM,4     ANDNE*ZEROS
     C                     MOVE '4'       PROT
F2  C                     END
D2  C           TIM,3     IFEQ *ZEROS
    C           TIM,4     ANDEQ*ZEROS
     C                     MOVE '3'       PROT
F2  C                     END
    C                     GOTO TESSU1
F1  C                     END
D1  C           ONDUL     IFEQ *ZEROS
    C           ONDUL     OREQ 7
    C           CCOL      OREQ 8
D2  C           TIM,3     IFEQ *ZEROS
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,3     IFNE *ZEROS
    C           TIM,3     ANDNE3
    C           TIM,3     ANDNE5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
X2  C                     ELSE
    C                     GOTO TESSU2
F2  C                     END
X1  C                     ELSE
D2  C           CCOL      IFEQ 9
    C                     GOTO TESSU3
X2  C                     ELSE
    C                     GOTO TESSU4
F2  C                     END
F1  C                     END
     C           TESSU3    TAG
    C**         ******    ***
D1  C           TIM,2     IFNE *ZEROS
    C           TIM,2     ANDNE3
    C           TIM,2     ANDNE5
    C                     GOTO TESSU1
F1  C                     END
D1  C           TIM,2     IFEQ 3
    C           TIM,2     OREQ 5
    C           TIM,2     OREQ *ZEROS
D2  C           TIM,6     IFEQ *ZEROS
    C           TIM,2     ANDEQ0
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFEQ *ZEROS
    C           TIM,2     ANDEQ3
    C           TIM,6     OREQ *ZEROS
    C           TIM,2     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFEQ 3
    C           TIM,6     OREQ 5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFNE *ZEROS
    C           TIM,6     ANDNE3
    C           TIM,6     ANDNE5
    C                     GOTO TESSU2
F2  C                     END
F1  C                     END
     C           TESSU4    TAG
    C**         ******    ***
D1  C           TIM,3     IFNE *ZEROS
    C           TIM,3     ANDNE3
    C           TIM,3     ANDNE5
    C                     GOTO TESSU2
F1  C                     END
D1  C           TIM,3     IFEQ *ZEROS
    C           TIM,3     OREQ 3
    C           TIM,3     OREQ 5
D2  C           TIM,5     IFEQ 0
    C           TIM,3     ANDEQ0
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,5     IFEQ *ZEROS
    C           TIM,3     ANDEQ3
    C           TIM,5     OREQ *ZEROS
    C           TIM,3     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,5     IFNE *ZEROS
    C           TIM,3     ANDEQ0
    C                     GOTO TESSU2
F2  C                     END
D2  C           TIM,5     IFNE *ZEROS
    C           TIM,3     ANDEQ3
    C           TIM,5     ORNE *ZEROS
    C           TIM,3     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
F1  C                     END
     C           TESSU2    TAG
    C**         ******    ***
D1  C           FACON     IFEQ 8
     C                     MOVE '1'       PROT
    C                     GOTO TESSU1
X1  C                     ELSE
     C                     MOVE '2'       PROT
F1  C                     END
     C           TESSU1    TAG
D1  C           TOLE1     IFEQ *BLANKS
     C                     MOVEL'P'       PROT
X1  C                     ELSE
     C                     MOVEL'T'       PROT
F1  C                     END
     C/EJECT
     C           FORM16    TAG
    C**         ******    ***
    C* SI AMLAGAME
    C*                    GOTO ETZUT                      PROVISOIRE
D1  C           POSF1     IFNE *ZEROS
     C                     Z-ADDPOSF1     XXX     30
X1  C                     ELSE
     C                     Z-ADD1         XXX
F1  C                     END
     C                     MOVE '1'       *IN93
     C                     WRITEWAMLC
     C                     MOVEA'00'      *IN,93
     C                     Z-ADD0         RECNO   30
     C           CLEPRO    CHAINPRODST2              99
     C           CLEPLA    CHAINCODBARL2             99
D1  C           *IN99     DOWEQ'0'
     C                     MOVE '1'       *IN94
     C                     ADD  1         RECNO
     C                     MOVELREFCO     DESAML
     C                     MOVE CLICO     DESAML
     C           POSCO     DIV  XXX       WWW     74
     C           QTTOT     MULT WWW       QTEAML    H
D2  C           AMALFO    IFEQ 'B'
     C                     MOVE 'A'       LAAML
     C                     MOVE CODMON    MONAML
     C                     MOVE PPEAML    PPAML   22
     C           PRIUNX    MULT PPAML     PRXAML
     C           PRXAML    DIV  WWW       PRXAML    H
F2  C                     END
     C                     WRITEWAMLD
     C           CLEPLA    READECODBARL2                 99
F1  C                     END
D1  C           RECNO     IFNE *ZEROS
     C                     MOVELTAUG,6    TYPAML    P
D2  C           AMALFO    IFEQ 'A'
     C                     MOVELTAUG,4    TYPAML    P
F2  C                     END
D2  C           AMALFO    IFEQ 'B'
     C                     MOVELTAUG,5    TYPAML    P
F2  C                     END
     C                     EXFMTWAMLC
    C   02                GOTO FORM14
F1  C                     END
     C           ETZUT     TAG
     *
     C                     SETOF                     82
     C                     Z-ADD*ZEROS    TAYOYO  10
     C                     Z-ADDCODTA     TAYOYO
D1  C           CODTA     IFEQ 1
    C* Libéllé code incoterm
     C                     MOVE *BLANKS   VALE
     C                     MOVE *BLANKS   ARGU
     C                     MOVELFONLV1    CODINC
     C                     MOVE 'TEXP'    ARGU
     C                     MOVE CODINC    VALE
     C           CLPARA    CHAINPARAME               38
     C  N38                MOVELPXLIBE    LIBINC
     C                     SETON                     0382
     C                     EXFMTF23
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM15
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
F1  C                     END
     C* AJOUT COI
     C           KCLI      CHAINCLICOML1             99
     C* MTTLIG = Qte commandee * Prix unitaire / Unité de vente
     C           QTTOT     MULT PRIUNX    MTTLIG 132
     C           MTTLIG    DIV  UNITE     MTTLIG
     C           SOLENC    ADD  MTSTOC    MONT   112
     C           MONT      ADD  BLNFAC    MONT
     C           MONT      ADD  MTTLIG    MONT
     C           KCLI      SETLLENCCLI                   94
     C  N94                ADD  MTCDEE    MONT   112
     C           MONT      IFGT LIMCRE
     C           NOCLI     IFNE 0235
     C           NOCLI     ANDNE0329
     C           NOCLI     ANDNE3418
     C           NOCLI     ANDNE2356
     C           NOCLI     ANDNE1046
     C           NOCLI     ANDNE1280
     C           NOCLI     ANDNE1654
     C           NOCLI     ANDNE1817
     C           NOCLI     ANDNE2668
     C           NOCLI     ANDNE2852
     C           NOCLI     ANDNE3933
     C           NOCLI     ANDNE4021
     C           NOCLI     ANDNE4229
     C           NOCLI     ANDNE4293
     C           NOCLI     ANDNE4446
     C           NOCLI     ANDNE4816
     C           NOCLI     ANDNE4822
     C           NOCLI     ANDNE4916
     C           NOCLI     ANDNE4945
     C           NOCLI     ANDNE4698
     C           NOCLI     ANDNE5167
     C           NOCLI     ANDNE5169
     C           NOCLI     ANDNE5265
     C           NOCLI     ANDNE5288
     C           NOCLI     ANDNE5328
     C           NOCLI     ANDNE5373
     C           NOCLI     ANDNE6686
     C           MONT      SUB  LIMCRE    DEPAS  112
     C           LIMCRE    MULT 0,05      CINQP  102
     C                     ELSE
     C* Si client en marché annuel, on retire le carnet de commande
     C           MONT      SUB  MTCDEE    MONT
     C           MONT      SUB  LIMCRE    DEPAS  112
     C           LIMCRE    MULT 0,05      CINQP  102
     C                     END
     C                     END
     C           DEPAS     IFGT 5000
     C           DEPAS     ANDGTCINQP
     C           *IN12     DOWEQ'0'
     C                     EXFMTF22W
     C                     ENDDO
     C*remise à 0 de la valeur de dépassement
     C                     Z-ADD0         DEPAS
     C                     GOTO FORM01
     C                     END
     C* FIN AJOUT COI
     C/EJECT
    C*****************************************************
    C** TRAITEMENT DES CADENCEMENTS
    C*****************************************************
     C           CADENS    TAG
    C**         ******    ***
     C                     Z-ADD*ZEROS    I
     C                     SETON                     93
     C                     Z-ADD*ZEROS    DER     30
     C                     Z-ADD*ZEROS    RESTE   60
     C                     Z-ADD*ZEROS    TBFA
     C                     Z-ADD*ZEROS    TBSI
     C                     MOVE *HIVAL    TSE
     C                     Z-ADD*ZEROS    TBEX
     C                     Z-ADD*ZEROS    TBIM
     C                     Z-ADD*ZEROS    TBF
     C                     Z-ADD*ZEROS    TOTIMP  80
     C                     Z-ADD*ZEROS    TOTFA   80
     C                     Z-ADD*ZEROS    TATEXP  70
     C                     Z-ADD*ZEROS    TSEIMP
     C                     Z-ADD*ZEROS    TSEFAB
     C                     Z-ADD*ZEROS    TSERAN
     C           FORM22    TAG
    C**         ******    ***
D1  C           NBLIV     IFEQ NBFAB
     C                     Z-ADDQTFAB     QTLIV   80
     C                     SETOF                     93
F1  C                     END
    C**         *****     ***
     C           QTLIV     MULT NBLIV     TOLIV   80
     C           QTTOT     SUB  TOLIV     RESTE
     C           NBLIV     SUB  1         DER
     C           CCCC1     TAG
    C**         *****     ***
     C                     ADD  1         I
     C                     Z-ADDI         TBF,I
D1  C           *IN93     IFEQ '0'
     C                     Z-ADDQTLIV     TBFA,I
D2  C           BOBFAB    IFNE 0
     C                     Z-ADDBOBFAB    TBBO,I
F2  C                     END
F1  C                     END
     C                     Z-ADDQTLIV     TBEX,I
     C                     Z-ADDI         TSEFAB
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     Z-ADD0         TBSS,I
     C                     MOVE '  '      TBCD,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
D1  C           RESTE     IFEQ 0
    C           I         ANDLTNBLIV
    C                     GOTO CCCC1
F1  C                     END
D1  C           RESTE     IFNE 0
    C           I         ANDNEDER
    C           I         ANDLTNBLIV
    C                     GOTO CCCC1
F1  C                     END
D1  C           RESTE     IFNE 0
    C           I         ANDEQDER
     C                     ADD  RESTE     QTLIV
     C                     Z-ADD0         DER
    C                     GOTO CCCC1
F1  C                     END
     **********************************
    C  N93                GOTO FFFF1
     C                     Z-ADD0         I
     C                     Z-ADD0         IX      20
     C           QTFAB     MULT NBFAB     TOFABX  80
     C           QTTOT     SUB  TOFABX    RESTE
     C                     ADD  1         I
     C                     ADD  1         IX
     C                     Z-ADDQTFAB     TBFA,I
     C                     Z-ADDQTFAB     TOTFA   80
     C                     ADD  TBEX,I    TATEXP
     C                     Z-ADDI         TSEFAB
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSS,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     MOVE '  '      TBCD,I
D1  C           BOBFAB    IFNE 0
     C                     Z-ADDBOBFAB    TBBO,I
F1  C                     END
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
     C           EEEE1     TAG
    C**         *****     ***
D1  C           IX        IFEQ NBFAB
    C                     GOTO FFFF1
F1  C                     END
     C                     ADD  1         I
     C                     ADD  TBEX,I    TATEXP
     C                     Z-ADDI         TSEFAB
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSS,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     MOVE '  '      TBCD,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
    C           TATEXP    CABLETOTFA     EEEE1
     C                     Z-ADDQTFAB     TBFA,I
     C                     ADD  QTFAB     TOTFA
     C                     ADD  1         IX
D1  C           IX        IFEQ NBFAB
    C           RESTE     ANDNE*ZEROS
     C                     ADD  RESTE     TBFA,I
     C                     ADD  RESTE     TOTFA
F1  C                     END
     C                     Z-ADDI         TSEFAB
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     MOVE '  '      TBCD,I
D1  C           BOBFAB    IFNE 0
     C                     Z-ADDBOBFAB    TBBO,I
F1  C                     END
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
    C                     GOTO EEEE1
     C           FFFF1     TAG
    C**         *****     ***
     C                     Z-ADD0         I
     C                     Z-ADD0         IX
     C                     Z-ADD0         TOTFA
     C           QTIMP     MULT NBIT      TOIMPX  80
     C           QTTOT     SUB  TOIMPX    RESTE
D1  C           QTPRE     IFNE *ZEROS
     C                     ADD  1         I
     C                     ADD  1         IX
     C                     Z-ADD1         SEQIMP
     C                     Z-ADD1         TBSI,I
     C                     Z-ADDQTPRE     TBIM,I
     C                     Z-ADDQTPRE     TOTIMP
     C                     ADD  TBFA,I    TOTFA
     C                     MOVE TSE,I     TSET
     C                     Z-ADDSEQIMP    TSEIMP
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSS,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     MOVE '  '      TBCD,I
D2  C           BOBFAB    IFNE 0
     C                     Z-ADDBOBFAB    TBBO,I
F2  C                     END
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
    C                     GOTO FFFF2
F1  C                     END
D1  C           QTPRE     IFEQ 0
D2  C           QTREN     IFEQ 0
    C                     GOTO CHASOU
F2  C                     END
F1  C                     END
     C           FFFF2     TAG
    C**         *****     ***
    C           IX        CABEQNBIT      CHASOU
     C                     ADD  1         I
     C                     ADD  TBFA,I    TOTFA
    C           TOTFA     CABLETOTIMP    FFFF2
     C                     ADD  1         IX
     C                     ADD  1         SEQIMP
     C                     MOVE TSE,I     TSET
     C                     Z-ADDSEQIMP    TBSI,I
     C                     Z-ADDQTREN     TBIM,I
     C                     ADD  QTREN     TOTIMP
D1  C           SEQIMP    IFEQ NBIT
    C           RESTE     ANDNE*ZEROS
     C                     ADD  RESTE     TBIM,I
     C                     ADD  RESTE     TOTIMP
F1  C                     END
     C                     Z-ADDSEQIMP    TSEIMP
     C                     Z-ADDI         TSERAN
     C                     MOVE TSET      TSE,I
     C                     Z-ADD0         TBAD,I
     C                     Z-ADD0         TBSS,I
     C                     Z-ADD0         TBSD,I
     C                     Z-ADD0         TBJD,I
     C                     MOVE '  '      TBCD,I
     C                     Z-ADDTBBO,I    NBOBI
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIUNX    TBPR,I
     C                     MOVE PXS       TBPX,I
    C                     GOTO FFFF2
     C           CHASOU    TAG
    C**         ******    ***
D1  C                     DO   98        K       20
    C           TSE,K     CABEQ*HIVAL    HHIVAL
     C                     MOVE TSE,K     TSET
D2  C           TSEIMP    IFEQ 0
    C           *IN86     ANDEQ'0'
    C           QTPRE     ANDNE0
    C           TSEIMP    OREQ 0
    C           *IN86     ANDEQ'0'
    C           QTREN     ANDNE0
     C                     Z-ADDK         KK      20
     C           TAGIMP    TAG
     C                     SUB  1         KK
     C                     MOVE TSE,KK    TSET1
D3  C           TSEIM1    IFNE 0
     C                     MOVE TSEIM1    TSEIMP
     C                     MOVE TSET      TSE,K
X3  C                     ELSE
    C                     GOTO TAGIMP
F3  C                     END
F2  C                     END
D2  C           TSEFAB    IFEQ 0
     C                     Z-ADDK         KK      20
     C           TAGFAB    TAG
     C                     SUB  1         KK
     C                     MOVE TSE,KK    TSET1
D3  C           TSEFA1    IFNE 0
     C                     MOVE TSEFA1    TSEFAB
     C                     MOVE TSET      TSE,K
X3  C                     ELSE
    C                     GOTO TAGFAB
F3  C                     END
F2  C                     END
F1  C                     END
     C           HHIVAL    TAG
    C**         ******    ***
    C                     GOTO HHHVAL
     C                     SORTATSE
D1  C                     DO   98        K
    C           TSE,K     CABEQ*HIVAL    HHHVAL
     C                     MOVE TSE,K     TSET
     C                     MOVE TSERAN    I
D2  C           K         IFEQ 1
     C                     MOVE TSEIMP    IMPIMP  20
     C                     MOVE TSEFAB    IMPFAB  20
     C        N86          Z-ADD1         TSEIMP
     C                     Z-ADD1         TSEFAB
     C                     MOVE TSERAN    I
D3  C           TBIM,I    IFNE *ZEROS
     C                     Z-ADD1         TBSI,I
X3  C                     ELSE
     C                     Z-ADD0         TBSI,I
F3  C                     END
     C                     MOVE TSET      TSE,K
    C                     GOTO I2
F2  C                     END
     C                     MOVE TSERAN    I
D2  C           TBIM,I    IFNE 0
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
     C           TSEIM1    ADD  1         TSEIMP
D3  C           TBFA,I    IFNE 0
     C           TSEFA1    ADD  1         TSEFAB
F3  C                     END
     C                     MOVE TSET      TSE,K
     C                     MOVE TSERAN    I
     C                     Z-ADDTSEIMP    TBSI,I
    C*                    Z-ADDTSEFAB    TBF,I
     C                     MOVE TSEIMP    IMPIMP
     C                     MOVE TSEFAB    IMPFAB
F2  C                     END
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
D2  C           TSEIMP    IFLE TSEIM1
     C                     MOVE TSEIM1    TSEIMP
F2  C                     END
D2  C           TBIM,I    IFEQ 0
     C                     Z-ADD0         TBSI,I
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
     C                     MOVE TSEIM1    TSEIMP
     C                     MOVE TSET      TSE,K
F2  C                     END
D2  C           TBIM,I    IFNE 0
    C           TBFA,I    ANDEQ0
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
     C                     MOVE TSEFA1    TSEFAB
    C*                    MOVE TSEFA1    TBF,I
     C                     MOVE TSET      TSE,K
F2  C                     END
D2  C           TBIM,I    IFEQ 0
    C           TBFA,I    ANDNE0
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
     C                     MOVE TSERAN    I
D3  C           TBFA,I    IFNE 0
     C           TSEFA1    ADD  1         TSEFAB
X3  C                     ELSE
     C                     MOVE TSEFA1    TSEFAB
F3  C                     END
     C                     MOVE TSEIM1    TSEIMP
     C                     MOVE TSET      TSE,K
     C                     MOVE TSERAN    I
     C                     Z-ADD0         TBSI,I
    C*                    Z-ADDTSEFAB    TBF,I
     C                     MOVE TSEFAB    IMPFAB
X2  C                     ELSE
     C                     Z-ADDIMPFAB    TSEFAB
    C*                    Z-ADDTSEFAB    TBF,I
F2  C                     END
D2  C           TBFA,I    IFEQ 0
     C                     MOVE TSERAN    I
     C           K         SUB  1         KK
     C                     MOVE TSE,KK    TSET1
     C                     MOVE TSERA1    PP      20
     C                     MOVE TSEFA1    TSEFAB
    C*                    MOVE TSEFA1    TBF,I
     C                     Z-ADD1         OO      20
     C                     ADD  1         OO
     C                     MOVE TSET      TSE,K
     C                     MOVE TSERAN    I
F2  C                     END
     C           I2        TAG
    C**         **        ***
F1  C                     END
     C           HHHVAL    TAG
    C**         ******    ***
     C                     SORTATSE
     C                     Z-ADD0         R5      30
     C                     Z-ADD0         I
D1  C                     DO   98        I
D2  C           TSE,I     IFNE *HIVAL
     C                     MOVE TSE,I     TSET
     C                     Z-ADDTSERAN    K
     C                     Z-ADDI         TSEFAB
     C                     Z-ADDI         TBF,K
D3  C           TBIM,K    IFNE *ZEROS
     C                     ADD  1         R5
     C                     Z-ADDR5        TSEIMP
     C                     Z-ADDR5        TBSI,K
F3  C                     END
     C                     MOVE TSET      TSE,I
F2  C                     END
F1  C                     END
     C                     Z-ADD0         I
     C                     Z-ADD0         R5
     C                     Z-ADD*ZEROS    NBL     20
     C                     SORTATSE
     C           BOUCLI    TAG
    C**         ******    ***
     C                     Z-ADD*ZEROS    SEQFAB
     C                     Z-ADD*ZEROS    QTFAC
     C                     Z-ADD*ZEROS    QTEXP
     C                     Z-ADD*ZEROS    SEQIMP
     C                     Z-ADD*ZEROS    QTIMP
     C                     SETOF                     09
     C                     ADD  1         I
    C           I         CABGT98        FORM23
    C           TSE,I     CABEQ*HIVAL    FORM23
     C                     MOVE TSE,I     TSET
     C                     Z-ADDTSERAN    K
     C                     Z-ADDTBF,K     SEQFAB
     C                     Z-ADDTBFA,K    QTFAC
     C                     SETON                     09
     C                     Z-ADDTBEX,K    QTEXP
D1  C           TBEX,K    IFNE *ZEROS
     C                     ADD  1         NBL
F1  C                     END
     C                     MOVE TBSI,K    SEQIMP
     C                     Z-ADDTBIM,K    QTIMP
     C                     Z-ADDTBAD,K    ANDEL
     C                     Z-ADDTBSS,K    SSDEL
     C                     Z-ADDTBSD,K    SEDEL
     C                     Z-ADDTBJD,K    JSDEL
     C                     Z-ADDTBBO,K    NBOBI
     C  N01                Z-ADDTBPR,K    PUNITX
     C  N01                Z-ADDTBPX,K    PX
     C                     MOVE TBCD,K    CODEL
     C                     MOVE TBAF,K    RGFAC
     C                     MOVE TBAL,K    RGLIV
D1  C           *IN21     IFEQ '1'
    C           *IN63     OREQ '1'
D2  C           RGFAC     IFNE 99
     C   U1 09 U3          Z-ADD0         RGFAC
F2  C                     END
     C   U2 09 U4          Z-ADD0         RGLIV
F1  C                     END
     C   09                ADD  1         R5
     C   09                WRITEF34
    C                     GOTO BOUCLI
     C           FORM23    TAG
    C**         ******    ***
     C                     SETON                     11
D1  C           R5        IFNE 0
     C                     SETON                     10
X1  C                     ELSE
    C                     GOTO FORM14
F1  C                     END
     C                     MOVE *BLANKS   PORC
     C                     MOVE *BLANKS   TAXE
D1  C           TAYOYO    IFEQ 0
     C                     MOVE 'TVA '    TAXE
F1  C                     END
D1  C           TAYOYO    IFEQ 1
     C                     MOVE 'EXP.'    TAXE
F1  C                     END
D1  C           TAYOYO    IFEQ 2
     C                     MOVE 'SUSP'    TAXE
F1  C                     END
D1  C           TYPOR     IFEQ 1
     C                     MOVE 'FGAR'    PORC
F1  C                     END
D1  C           TYPOR     IFEQ 2
     C                     MOVE 'FDOM'    PORC
F1  C                     END
D1  C           TYPOR     IFEQ 3
     C                     MOVE 'DEPA'    PORC
F1  C                     END
D1  C           TYPOR     IFEQ 4
     C                     MOVE 'ECLI'    PORC
F1  C                     END
     C                     MOVE *IN70     REF70   1
     C           USAISI    COMP '*'                      70
     C                     WRITEF36
     C                     MOVE REF70     *IN70
     C                     SETON                     1011
     C   61
     COR 70
     COR 71
     COR 72
     COR 73
     COR 75                WRITEF33
     C  N70N61N72
     CANN71N73N75          EXFMTF33
     C   71                EXFMTF35A
     C   61                EXFMTF62
     C   72                EXFMTF35D
     C   73                EXFMTF35B
     C   75                EXFMTF35C
     C   70                EXFMTF61
     C                     SETOF                     1011
D1  C           *IN70     IFEQ '1'
     C                     SETOF                     70
    C                     GOTO FORM23
F1  C                     END
D1  C           *IN71     IFEQ '1'
     C                     SETOF                     71
    C                     GOTO FORM23
F1  C                     END
D1  C           *IN72     IFEQ '1'
     C                     SETOF                     72
    C                     GOTO FORM23
F1  C                     END
D1  C           *IN73     IFEQ '1'
     C                     SETOF                     73
    C                     GOTO FORM23
F1  C                     END
D1  C           *IN75     IFEQ '1'
     C                     SETOF                     75
    C                     GOTO FORM23
F1  C                     END
D1  C           *IN61     IFEQ '1'
     C                     SETOF                     61
    C                     GOTO FORM23
F1  C                     END
     C                     SETOF                     1011
    C** RETOUR ECRAN PRECEDENT
    C*************************
D1  C           *IN02     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF33
     C                     SETOF                     12
     C                     MOVE *BLANKS   TBF
     C                     MOVE *BLANKS   TBSI
     C                     MOVE *BLANKS   TBFA
     C                     MOVE *BLANKS   TBIM
     C                     MOVE *BLANKS   TBEX
     C                     MOVE *BLANKS   TBAD
     C                     MOVE *BLANKS   TBSS
     C                     MOVE *BLANKS   TBSD
     C                     MOVE *BLANKS   TBJD
     C                     MOVE *BLANKS   TBCD
     C                     MOVE *BLANKS   TBBO
     C                     MOVE *BLANKS   TBAF
     C                     MOVE *BLANKS   TBAL
     C                     MOVE *BLANKS   TBPR
     C                     MOVE *BLANKS   TBPX
D2  C           NBLIV     IFEQ 1
     C                     Z-ADD0         NBLIV
F2  C                     END
    C                     GOTO FORM14
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D2  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM23
F2  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D2  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F2  C                     END
    C                     GOTO FORM01
F1  C                     END
    C** VALIDATION DES CADENCEMENTS
    C******************************
D1  C           *IN24     IFEQ '1'
     C                     XFOOTTBIM      TBIMX   80
     C                     XFOOTTBFA      TBFAX   80
     C                     XFOOTTBEX      TBEXX   80
    C** NOMBRE DE LIVRAISON
    C*********************************************
D2  C           NBLIV     IFNE *ZEROS
    C           NBL       CABNENBLIV     FORM23     7272
F2  C                     END
    C** TOTAL IMPRESSION DIFFERENT QUANTITE TOTALE
    C*********************************************
D2  C           *IN20     IFEQ '1'
D3  C           TBIMX     IFNE QTTOT
    C           *IN86     ANDEQ'0'
     C                     MOVE TER,1     LIBER
     C                     SETON                     71
    C                     GOTO FORM23
F3  C                     END
F2  C                     END
    C** TOTAL FABRICATION DIFFERENT QUANTITE TOTALE
    C**********************************************
D2  C           TBFAX     IFNE QTTOT
     C                     MOVE TER,2     LIBER
     C                     SETON                     71
    C                     GOTO FORM23
F2  C                     END
    C** TOTAL  LIVRAISON  DIFFERENT QUANTITE TOTALE
    C**********************************************
D2  C           TBEXX     IFNE QTTOT
     C                     MOVE TER,3     LIBER
     C                     SETON                     71
    C                     GOTO FORM23
F2  C                     END
    C** CONTROLE LIGNE PAR LIGNE
    C***************************
     C                     Z-ADD0         TBIMX
     C                     Z-ADD0         TBFAX
     C                     Z-ADD0         TBEXX
     C           1         CHAINF34                  38
     C                     Z-ADDSSDEL     SSEDEL
     C                     Z-ADDANDEL     ANEDEL
     C                     Z-ADDSEDEL     SEMDEL
     C                     Z-ADDJSDEL     JOUDEL
D2  C           JSDEL     IFEQ 0
     C                     Z-ADD5         JOUDEL
F2  C                     END
D2  C                     DO   *HIVAL    R5
     C           R5        CHAINF34                  38
    C   38                GOTO FINCON
     C                     ADD  QTIMP     TBIMX
     C                     ADD  QTFAC     TBFAX
     C                     ADD  QTEXP     TBEXX
     C                     Z-ADDSSDEL     SS1DEL
     C                     Z-ADDANDEL     AN1DEL
     C                     Z-ADDSEDEL     SE1DEL
     C                     Z-ADDJSDEL     JO1DEL
D3  C           TE1DEL    IFNE 0
D4  C           JSDEL     IFEQ 0
     C                     Z-ADD5         JO1DEL
F4  C                     END
F3  C                     END
D3  C           TE1DEL    IFNE 0
D4  C           TE1DEL    IFLT TESDEL
     C                     SETON                     61
    C                     GOTO FORM23
F4  C                     END
F3  C                     END
D3  C           TESDEL    IFEQ 0
D4  C           TE1DEL    IFGT TESDEL
     C                     SETON                     61
    C                     GOTO FORM23
F4  C                     END
F3  C                     END
     C                     MOVE TE1DEL    TESDEL
D3  C           *IN84     IFEQ '0'
D4  C           RGLIV     IFEQ 0
     C                     SETON                     70
    C                     GOTO FORM23
F4  C                     END
D4  C           RGFAC     IFEQ 0
     C                     SETON                     70
    C                     GOTO FORM23
F4  C                     END
F3  C                     END
D3  C           *IN86     IFEQ '0'
D4  C           TBIMX     IFNE 0
    C           TBFAX     CABGTTBIMX     FORM23     73
F4  C                     END
F3  C                     END
    C           TBEXX     CABGTTBFAX     FORM23     75
F2  C                     END
     C           FINCON    TAG
    C**         ******    ***
    C   84                GOTO FORM27
    C                     GOTO FORM25
F1  C                     END
D1  C                     DO   *HIVAL    R5
     C                     READCF34                    3938
    C   39                GOTO CHASOU
D2  C           *IN38     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF33
     C                     SETOF                     12
    C                     GOTO CHASOU
F2  C                     END
     C                     Z-ADD0         SQIM
D2  C           MOSU      IFEQ 'A'
     C                     MOVE TSE,R5    TSET
     C                     MOVE TSEIMP    SQIM    20
    C                     GOTO FORM24
F2  C                     END
D2  C           MOSU      IFEQ 'M'
     C                     SUB  QTEXP     QTECAD
     C                     SETON                       U3U4
     C           FOR23A    TAG
    C**         ******    ***
     C                     MOVE *IN70     REF70   1
     C           USAISI    COMP '*'                      70
     C                     EXFMTF35
     C                     MOVE REF70     *IN70
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D3  C           *IN13     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     MOVE RGLIV     RLIRLI  20
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D4  C           RGLIV     IFEQ 0
     C                     MOVE RLIRLI    RGLIV
F4  C                     END
F3  C                     END
    C** CHANGEMENT D'ADRESSE LIVRAISON
    C*********************************
D3  C           *IN08     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     MOVE RGFAC     RLIRLI  20
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D4  C           RGFAC     IFEQ 0
     C                     MOVE RLIRLI    RGFAC
F4  C                     END
F3  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D3  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D4  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FOR23A
F4  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D4  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F4  C                     END
    C                     GOTO FORM01
F3  C                     END
    C** TEST VALIDITE DU DELAI
    C*************************
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
     C                     Z-ADD0         ANDEL
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           JSDEL     ANDNE0
     C           CLECAL    CHAINCALENAL2             79
    C   79                GOTO FOR23A
     C                     Z-ADDCALSS     SSDEL
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           JSDEL     ANDEQ0
     C                     Z-ADD5         JSDEL
     C           CLECAL    CHAINCALENAL2             79
     C                     Z-ADD0         JSDEL
    C   79                GOTO FOR23A
     C                     Z-ADDCALSS     SSDEL
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           DATCAL    CABLEDATSYS    FOR23A       7979
D4  C           *IN48     IFEQ '0'
    C           DATCAL    ANDGTDATM6
     C                     SETON                     4748
    C                     GOTO FOR23A
F4  C                     END
    C           CALJOU    CABEQ'FERIE   'FOR23A         79
F3  C                     END
     C                     SETOF                     48
D3  C           JSDEL     IFNE 0
    C           SEDEL     ANDEQ0
     C                     SETON                     79
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           CODEL     ANDEQ*BLANKS
     C                     SETON                     35
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           PREVIS    ANDEQ'P'
    C           CODEL     ANDNE'PR'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
    C*          SEDEL     IFNE 0
    C*          PREVIS    ANDNE'P'
    C*          PSERIE    ANDEQ'P'
    C*          CODEL     ANDNE'CO'
    C*                    SETON                     43
    C*                    GOTO FOR23A
    C*                    END
D3  C           SEDEL     IFNE 0
    C           PREVIS    ANDNE'P'
    C*          PSERIE    ANDNE'P'
    C           *IN84     ANDNE'1'
    C           CODEL     ANDEQ'CO'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           PREVIS    ANDNE'P'
    C*          PSERIE    ANDNE'P'
    C           *IN84     ANDNE'1'
    C           QTEXP     ANDEQ0
    C           CODEL     ANDEQ'DE'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           *IN84     ANDEQ'1'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDNE*BLANKS
     C                     SETON                     52
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDEQ*BLANKS
     C                     Z-ADD0         SSDEL
F3  C                     END
    C        N93QTEXP     CABNEQTFAC     FOR23A     1616
D3  C           QTEXP     IFEQ 0
    C           QTIMP     ANDEQ0
     C                     SETON                     25
    C                     GOTO FOR23A
F3  C                     END
     C           QTFAC     MULT 0,95      TOTMIN  70H
     C           QTFAC     MULT 1,05      TOTMAX  70H
D3  C           NBOBI     IFNE 0
    C           BOBPDS    ANDNE0
     C           NBOBI     MULT BOBPDS    TOTMOY  80H
     C           TOTMOY    COMP TOTMIN                 40
    C   40                GOTO FOR23A
     C           TOTMOY    COMP TOTMAX               40
    C   40                GOTO FOR23A
F3  C                     END
     *
D3  C           JSDEL     IFNE 0
     C                     Z-ADDJSDEL     RL      10
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             38
    C           RDV,RL    CABEQ'*'       FOR23A         50
D4  C     N46   RDV,RL    IFEQ 'R'
     C                     SETON                     4546
    C                     GOTO FOR23A
F4  C                     END
F3  C                     END
     C                     SETOF                     46
    C** VALIDITE ADRESSE FACTURATION
    C*******************************
D3  C           *IN84     IFNE '1'
    C           RGFAC     ANDNE99
     C                     MOVE RGFAC     SEQUEN
     C           CLEFIC    CHAINCLIFACL4             22
    C   22                GOTO FOR23A
F3  C                     END
    C** VALIDITE ADRESSE LIVRAISON
    C*****************************
D3  C           *IN84     IFNE '1'
    C           RGLIV     ANDNE99
     C                     MOVE RGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             23
    C   23                GOTO FOR23A
F3  C                     END
D3  C           *IN21     IFEQ '0'
    C           *IN63     ANDEQ'0'
D4  C           *IN42     IFEQ '0'
D5  C           CODMON    IFEQ 'EUR'
    C           PUNITX    ANDGT99999
     C                     SETON                     92
    C                     GOTO FOR23A
F5  C                     END
D5  C           PUNITX    IFNE PRIUNX
     C                     SETON                     2442
    C                     GOTO FOR23A
F5  C                     END
F4  C                     END
D4  C           *IN55     IFEQ '0'
D5  C           PX        IFNE PXS
     C                     SETON                     3655
    C                     GOTO FOR23A
F5  C                     END
F4  C                     END
F3  C                     END
    C** QUANTITES IMPERATIVES
    C**************************
D3  C           IN82      IFEQ '*'
    C           OKQTE     ANDNE'1'
     C                     SETOF                     97
D4  C           QTIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTIP    80
     C                     MOVELTI1,8     LIBQTI
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTIMP
F5  C                     END
F4  C                     END
D4  C           QTFAC     IFNE *ZEROS
     C                     Z-ADDQTFAC     QTIP
     C                     MOVELTI1,9     LIBQTI
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTFAC
F5  C                     END
F4  C                     END
D4  C           QTEXP     IFNE *ZEROS
     C                     Z-ADDQTEXP     QTIP
     C                     MOVELTI1,10    LIBQTI
     C                     SETON                     97
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTEXP
F5  C                     END
F4  C                     END
F3  C                     END
    C**************************
     C                     SETOF                     4255
     C                     MOVE DSCAD1    DSCAD2 60
     C                     Z-ADDRGFAC     RFACE   20
     C                     Z-ADDRGLIV     RLIVE   20
     C           R5        CHAINF34                  38
     C                     Z-ADDRFACE     RGFAC
     C                     Z-ADDRLIVE     RGLIV
     C                     MOVE DSCAD2    DSCAD1
     C                     MOVE TSE,R5    TSET
     C                     MOVE TSERAN    I
     C                     MOVE SEQFAB    TBF,I
D3  C           SEQFAB    IFNE *ZEROS
     C                     MOVE SEQFAB    TSEFAB
F3  C                     END
     C                     MOVE SEQIMP    TBSI,I
D3  C           SEQIMP    IFNE *ZEROS
     C                     MOVE SEQIMP    TSEIMP
F3  C                     END
     C                     MOVE ANDEL     TBAD,I
     C                     MOVE SSDEL     TBSS,I
     C                     MOVE SEDEL     TBSD,I
     C                     MOVE JSDEL     TBJD,I
     C                     MOVE CODEL     TBCD,I
     C                     MOVE QTIMP     TBIM,I
     C                     MOVE QTFAC     TBFA,I
     C                     MOVE QTEXP     TBEX,I
     C                     MOVE NBOBI     TBBO,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PUNITX    TBPR,I
     C                     MOVE PX        TBPX,I
     C                     MOVE TSET      TSE,R5
     C   U2                Z-ADD0         RGLIV
     C   U1                Z-ADD0         RGFAC
     C                     UPDATF34
     C                     SETON                     12
     C                     WRITEF33
     C                     SETOF                     12
     C                     SETOF                     U3U4
     C                     ADD  QTEXP     QTECAD
     C           QTECAD    SUB  QTTOT     QTERES
    C                     GOTO CHASOU
F2  C                     END
D2  C           MOSU      IFEQ 'S'
     C                     MOVE TSE,I     TSET
     C                     MOVE TSERAN    K
     C                     MOVE *BLANKS   TBF,K
     C                     MOVE *BLANKS   TBFA,K
     C                     MOVE *BLANKS   TBEX,K
     C                     MOVE *BLANKS   TBIM,K
     C                     MOVE *BLANKS   TBSI,K
     C                     MOVE *BLANKS   TBAD,K
     C                     MOVE *BLANKS   TBSS,K
     C                     MOVE *BLANKS   TBSD,K
     C                     MOVE *BLANKS   TBJD,K
     C                     MOVE *BLANKS   TBCD,K
     C                     MOVE *BLANKS   TBBO,K
     C                     MOVE *BLANKS   TBAF,K
     C                     MOVE *BLANKS   TBAL,K
     C                     MOVE *BLANKS   TBPR,K
     C                     MOVE *BLANKS   TBPX,K
     C                     MOVE *HIVAL    TSE,R5
     C                     SUB  QTEXP     QTECAD
     C           QTECAD    SUB  QTTOT     QTERES
F2  C                     END
F1  C                     END
     C           FORM24    TAG
    C**         ******    ***
     C                     MOVE *BLANKS   CODEL
     C                     Z-ADD*ZEROS    ANDEL
     C                     Z-ADD*ZEROS    SSDEL
     C                     Z-ADD*ZEROS    SEDEL
     C                     Z-ADD*ZEROS    JSDEL
     C                     Z-ADD*ZEROS    QTIMP
     C                     Z-ADD*ZEROS    QTFAC
     C                     Z-ADD*ZEROS    QTEXP
     C                     Z-ADD*ZEROS    SEQIMP
     C                     Z-ADD*ZEROS    SEQFAB
     C           FOR24A    TAG
    C**         ******    ***
     C                     MOVE *IN70     REF70   1
     C           USAISI    COMP '*'                      70
     C                     EXFMTF35
     C                     MOVE REF70     *IN70
    C** RETOUR ECRAN PRECEDENT
    C*************************
D1  C           *IN02     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF33
     C                     SETOF                     12
     C                     MOVE *BLANKS   TBF
     C                     MOVE *BLANKS   TBSI
     C                     MOVE *BLANKS   TBFA
     C                     MOVE *BLANKS   TBIM
     C                     MOVE *BLANKS   TBEX
     C                     MOVE *BLANKS   TBAD
     C                     MOVE *BLANKS   TBSS
     C                     MOVE *BLANKS   TBSD
     C                     MOVE *BLANKS   TBJD
     C                     MOVE *BLANKS   TBCD
     C                     MOVE *BLANKS   TBBO
     C                     MOVE *BLANKS   TBAF
     C                     MOVE *BLANKS   TBAL
     C                     MOVE *BLANKS   TBPR
     C                     MOVE *BLANKS   TBPX
    C                     GOTO FORM14
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D2  C           *IN13     IFEQ '1'
     C                     MOVE RGLIV     RLIRLI
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D3  C           RGLIV     IFEQ 0
     C                     MOVE RLIRLI    RGLIV
F3  C                     END
    C                     GOTO FOR24A
F2  C                     END
    C** CHANGEMENT D'ADRESSE LIVRAISON
    C*********************************
D2  C           *IN08     IFEQ '1'
     C                     MOVE RGFAC     RLIRLI  20
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D3  C           RGFAC     IFEQ 0
     C                     MOVE RLIRLI    RGFAC
F3  C                     END
    C                     GOTO FOR24A
F2  C                     END
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D2  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FOR24A
F2  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     SETOF                     12
D2  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F2  C                     END
    C                     GOTO FORM01
F1  C                     END
     C                     MOVE TSE,R5    TSET
     C                     MOVE TSEIMP    IMPRE9
     C                     MOVE TSEFAB    FABRI9
D1  C                     DO   98        ZZ      20
    C           TSE,ZZ    CABEQ*HIVAL    ECRISM
     C                     MOVELTSE,ZZ    ZIN5    5
    C           ZUN5      CABEQZIN5      FOR24A         24
F1  C                     END
     C           ECRISM    TAG
    C**         ******    ***
D1  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
     C                     Z-ADD0         ANDEL
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           JSDEL     ANDNE0
     C           CLECAL    CHAINCALENAL2             79
    C   79                GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFEQ 0
    C           JSDEL     ANDNE0
     C                     SETON                     79
    C                     GOTO FOR24A
F1  C                     END
D1  C           JSDEL     IFEQ 0
    C           SEDEL     ANDNE0
     C                     SETON                     79
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           CODEL     ANDEQ*BLANKS
     C                     SETON                     35
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           PREVIS    ANDEQ'P'
    C           CODEL     ANDNE'PR'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           PREVIS    ANDNE'P'
    C           PSERIE    ANDEQ'P'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           PREVIS    ANDNE'P'
    C           PSERIE    ANDNE'P'
    C           *IN84     ANDNE'1'
    C           CODEL     ANDEQ'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           PREVIS    ANDNE'P'
    C           PSERIE    ANDNE'P'
    C           *IN84     ANDNE'1'
    C           QTEXP     ANDEQ0
    C           CODEL     ANDEQ'DE'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           *IN84     ANDEQ'1'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDNE*BLANKS
     C                     SETON                     52
    C                     GOTO FOR24A
F1  C                     END
    C        N93QTEXP     CABNEQTFAC     FOR23A     1616
D1  C           QTEXP     IFEQ 0
    C           QTIMP     ANDEQ0
     C                     SETON                     25
    C                     GOTO FOR23A
F1  C                     END
     *
D1  C           JSDEL     IFNE 0
     C                     Z-ADDJSDEL     RL      10
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             38
    C           RDV,RL    CABEQ'*'       FOR24A         50
D2  C     N46   RDV,RL    IFEQ 'R'
     C                     SETON                     4546
    C                     GOTO FOR24A
F2  C                     END
F1  C                     END
     C                     SETOF                     46
     C                     Z-ADD1         K
    C** QUANTITES IMPERATIVES
    C**************************
D1  C           IN82      IFEQ '*'
    C           OKQTE     ANDNE'1'
     C                     SETOF                     97
D2  C           QTIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTIP    80
     C                     MOVELTI1,8     LIBQTI
     C                     EXSR TRTQIP
D3  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTIMP
F3  C                     END
F2  C                     END
D2  C           QTFAC     IFNE *ZEROS
     C                     Z-ADDQTFAC     QTIP
     C                     MOVELTI1,9     LIBQTI
     C                     EXSR TRTQIP
D3  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTFAC
F3  C                     END
F2  C                     END
D2  C           QTEXP     IFNE *ZEROS
     C                     Z-ADDQTEXP     QTIP
     C                     MOVELTI1,10    LIBQTI
     C                     SETON                     97
     C                     EXSR TRTQIP
D3  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTEXP
F3  C                     END
F2  C                     END
F1  C                     END
    C** VALIDITE ADRESSE FACTURATION
    C*******************************
D1  C           *IN84     IFNE '1'
    C           RGFAC     ANDNE99
     C                     MOVE RGFAC     SEQUEN
     C           CLEFIC    CHAINCLIFACL4             22
    C   22                GOTO FOR24A
F1  C                     END
    C** VALIDITE ADRESSE LIVRAISON
    C*****************************
D1  C           *IN84     IFNE '1'
    C           RGLIV     ANDNE99
     C                     MOVE RGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             23
    C   23                GOTO FOR24A
F1  C                     END
    C*
     C           *HIVAL    LOKUPTSE,K                    38
     C                     MOVE '00000000'TSE,K
     C                     MOVE TSE,K     TSET
     C                     MOVE FABRI9    TSEFAB
     C                     MOVE IMPRE9    TSEIMP
     C                     Z-ADD1         I
     C           *ZEROS    LOKUPTBF,I                    38
     C                     MOVE I         TSERAN
     C                     MOVE TSET      TSE,K
     C                     MOVE FABRI9    TBF,I
    C**         ******    ***
     C                     MOVE ANDEL     TBAD,I
     C                     MOVE SSDEL     TBSS,I
     C                     MOVE SEDEL     TBSD,I
     C                     MOVE JSDEL     TBJD,I
     C                     MOVE CODEL     TBCD,I
     C                     MOVE QTIMP     TBIM,I
     C                     MOVE QTFAC     TBFA,I
     C                     MOVE QTEXP     TBEX,I
     C                     MOVE NBOBI     TBBO,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PUNITX    TBPR,I
     C                     MOVE PX        TBPX,I
     C                     ADD  QTEXP     QTECAD
     C           QTECAD    SUB  QTTOT     QTERES
     C                     SETON                     12
     C                     WRITEF33
     C                     SETOF                     12
    C*
    C                     GOTO CHASOU
     C/EJECT
    C** FORMAT REFERENCE COMMANDE
    C****************************
     C           FORM25    TAG
    C**         ******    ***
D1  C           REFUNI    IFEQ 'N'
     C                     Z-ADD0         DSCDE
     C                     Z-ADD0         R6      30
D2  C                     DO   *HIVAL    R6
     C           R6        CHAINF34                  38
    C   38                GOTO AFIF38
     C                     MOVE COMCLJ    JCDE
     C                     MOVE COMCLM    MCDE
     C                     MOVE COMCLA    ACDE
     C                     MOVE COMCLS    SCDE
     C                     MOVE CLIREF    REFCDE
     C                     WRITEF38
F2  C                     END
     C           AFIF38    TAG
    C**         ******    ***
     C                     SETON                     1011
     C                     WRITEF40
     C                     EXFMTF37
     C                     SETOF                     1011
    C** FIN CONTROLE REFERENCES COMPLEMENTAIRES
    C******************************************
D2  C           *IN12     IFEQ '1'
     C                     MOVE '1'       *IN12
    C                     GOTO FORM26
F2  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO AFIF38
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
     C                     SETOF                     12
    C                     GOTO FORM01
F2  C                     END
D2  C                     DO   *HIVAL    R6
     C                     READCF38                      38
    C           *IN38     CABEQ'1'       AFIF38
     C           FOR25A    TAG
    C**         ******    ***
     C                     EXFMTF39
    C** ANNULATION DE LA SAISIE
    C**************************
D3  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D4  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO AFIF38
F4  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
     C                     SETOF                     12
D4  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F4  C                     END
    C                     GOTO FORM01
F3  C                     END
D3  C           DSCDE     IFNE *ZEROS
     C           CLECA1    CHAINCALENAL0             22
    C         22          GOTO FOR25A
     C                     Z-ADDCALSS     SCDE
    C           DSCDE     CABGTDATSYS    FOR25A     22
F3  C                     END
     C                     MOVE REFCDE    CDEREF 20
     C                     MOVE DSCDE     CDEDS   80
     C           R6        CHAINF38                  38
     C                     MOVE CDEREF    REFCDE
     C                     MOVE CDEDS     DSCDE
     C                     UPDATF38
F2  C                     END
    C                     GOTO AFIF38
F1  C                     END
     C/EJECT
    C** TRAITEMENT DES OBSERVATIONS DE LA CDE
    C****************************************
     C           FORM26    TAG
    C**         ******    ***
     C                     SETOF                     12
D1  C           *IN21     IFEQ '1'
    C           *IN63     OREQ '1'
    C                     GOTO FORM27
F1  C                     END
     C           CLEOBI    CHAINCLIOBIL1             38
     C                     Z-ADD0         R7      30
D1  C           *IN38     DOWEQ'0'
     C                     MOVE 'OBSI'    ARGU
     C                     MOVE CODOBI    VALE
     C           CLPARA    CHAINPARAME               31    CODE COMMECIAL
D2  C           PXMONT    IFEQ 1
     C                     ADD  1         R7
     C                     MOVE *BLANKS   LIBFIC
D3  C           R7        IFEQ 1
     C                     MOVELTG,1      LIBFIC
F3  C                     END
     C                     WRITEF29
F2  C                     END
     C           CLEOBI    READECLIOBIL1                 38
F1  C                     END
     C           FOR26A    TAG
    C**         *******   ***
     C                     Z-ADDR7        RX      30
     C           R7        COMP 0                    1010
     C                     SETON                     11
     C                     WRITEF31
     C                     WRITEF28
     C                     SETOF                     921110
     C           FOR26B    TAG
    C**         ******    ***
     C                     EXFMTF30
    C** RECHAR DES OBSERVATIONS
    C**************************
D1  C           *IN02     IFEQ '1'
     C                     MOVE *BLANKS   LBCDE1
     C                     MOVE *BLANKS   LBCDE2
     C                     MOVE *BLANKS   LBCDE3
     C                     MOVE *BLANKS   LBCDE4
     C                     MOVE *BLANKS   LBCDE5
     C                     MOVE *BLANKS   LBCDE6
     C                     MOVE *BLANKS   LBCDE7
     C                     MOVE *BLANKS   LBCDE8
     C                     SETON                     92
    C                     GOTO FOR26A
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D2  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FOR26B
F2  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
D2  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F2  C                     END
    C                     GOTO FORM01
F1  C                     END
    C* SI OBSERVATIONS SAISIES TAG DOIT ETRE SAISI
    C*********************************************
D1  C           *IN24     IFEQ '1'
D2  C           *IN86     IFEQ '0'
    C                     GOTO FORM27
X2  C                     ELSE
     C                     MOVE LBCDE1    LBCRE1 40
     C                     MOVE LBCDE2    LBCRE2 40
     C                     MOVE LBCDE3    LBCRE3 40
     C                     MOVE LBCDE4    LBCRE4 40
     C                     MOVE LBCDE5    LBCRE5 40
     C                     MOVE LBCDE6    LBCRE6 40
     C                     MOVE LBCDE7    LBCRE7 40
     C                     MOVE LBCDE8    LBCRE8 40
     C                     MOVE CDEPRE    CDPRRE  1
     C                     MOVE PRESER    PRESRE  1
     C                     SETOF                     1011
     C                     EXSR ECRIFI
     C                     SETON                     77
     C                     EXSR RAZ
     C                     SETOF                     77
     C                     ADD  1         L       20
D3  C           TA,L      IFNE *ZEROS
     C                     Z-ADDTA,L      NOPRO
F3  C                     END
    C*                    ADD  1         NOPRO
     C                     SETON                     2112
     C                     SETOF                     86
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
    C                     GOTO GARNIT
F2  C                     END
F1  C                     END
    C*
D1  C           *IN92     IFEQ '0'
D2  C           RX        IFNE 0
D3  C                     DO   *HIVAL    R7
     C                     READCF29                      38
    C   38                GOTO FOR26B
D4  C           SELECT    IFEQ 1
     C                     MOVE LIBOBI    LBCDE1
F4  C                     END
D4  C           SELECT    IFEQ 2
     C                     MOVE LIBOBI    LBCDE2
F4  C                     END
D4  C           SELECT    IFEQ 3
     C                     MOVE LIBOBI    LBCDE3
F4  C                     END
D4  C           SELECT    IFEQ 4
     C                     MOVE LIBOBI    LBCDE4
F4  C                     END
D4  C           SELECT    IFEQ 5
     C                     MOVE LIBOBI    LBCDE5
F4  C                     END
D4  C           SELECT    IFEQ 6
     C                     MOVE LIBOBI    LBCDE6
F4  C                     END
D4  C           SELECT    IFEQ 7
     C                     MOVE LIBOBI    LBCDE7
F4  C                     END
D4  C           SELECT    IFEQ 8
     C                     MOVE LIBOBI    LBCDE8
F4  C                     END
     C                     MOVE *BLANKS   SELECT
     C                     UPDATF29
F3  C                     END
F2  C                     END
F1  C                     END
    C                     GOTO FOR26B
     C/EJECT
    C** TRAITEMENT DES OBSERVATIONS INTERNES
    C***************************************
     C           FORM27    TAG
    C**         ******    ***
D1  C           *IN86     IFEQ '0'
    C**
D2  C           *IN84     IFNE '1'
     C                     MOVE INDPCL    PCLIND 20
     C           CLEPRO    CHAINPRODUI2              38
     C                     MOVE PCLIND    INDPCL
F2  C                     END
     C           FORM2E    TAG
     C                     EXFMTF32
    C*
D2  C           ANNREM    IFEQ 'OUI'
    C           NCDEAR    ANDEQ*ZEROS
    C           ANNREM    OREQ 'NON'
    C           NCDEAR    ANDNE*ZEROS
     C                     SETON                     55
    C                     GOTO FORM2E
F2  C                     END
    C* ELEMENT DE GARNITURE
D2  C           *IN21     IFEQ '1'
     C                     EXSR ECRIFI
     C                     ADD  1         L
D3  C           TA,L      IFNE *ZEROS
     C                     Z-ADDTA,L      NOPRO
F3  C                     END
     C                     SETON                     77
     C                     EXSR RAZ
     C                     SETOF                     77
     C                     SETON                     12
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
    C                     GOTO GARNIT
F2  C                     END
    C** AUTRE COMMANDE MEME CLIENT
    C*****************************
D2  C           *IN08     IFEQ '1'
     C                     EXSR ECRIFI
     C                     SETON                     77
     C                     EXSR RAZ
     C                     SETOF                     776301
    C                     GOTO FORM07
F2  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM27
F3  C                     END
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
     C                     EXSR ECRIFI
     C   21
     COR 63                SETON                     77
     C                     EXSR RAZ
     C                     SETOF                     77
    C                     GOTO FORM01
F1  C                     END
     C/EJECT
    C** FIN DES COMMANDES
    C********************
     C           FIN       TAG
    C**         ***       ***
     C                     MOVE '1'       *INLR
     C/EJECT
    C** SOUS PROGRAMMES CONDITIONS REGLEMENT
    C***************************************
    C           CHARCR    BEGSR
     C                     MOVE 'MRGC'    ARGU
     C           ARGU      SETLLPARAME
D1  C                     DO   *HIVAL    R1      20
     C           ARGU      READEPARAME                   33
    C           *IN33     CABEQ'1'       FINCHA
     C                     MOVELPXLIBE    LIBRGT
     C                     MOVE PXVALE    COREG
     C                     WRITEF7
F1  C                     END
    C           FINCHA    ENDSR
    C**         ******    *****
     C/EJECT
    C** SOUS PROGRAMMES PRE IMPRIME
    C******************************
    C           SPRIMP    BEGSR
     C           FOR7BI    TAG
    C**         ******    ***
     C                     SETOF                     24
     C                     EXFMTF10
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
     * Recherche du N° PREIMPRIME
     * -------------------------
D1  C           *IN05     IFEQ '1'
     C                     Z-ADD0         STEN1
D2  C           ETUDE     IFEQ *ZEROS
     C                     MOVE ' '       PARM1
     C                     Z-ADD0         ETUDE
     C                     Z-ADD0         SEQDE
X2  C                     ELSE
     C                     MOVE 'N'       PARM1
F2  C                     END
     C                     CALL 'LAN017£'
     C                     PARM           PARM17
D2  C           PARM1     IFNE 'O'
    C                     GOTO FOR7BI
F2  C                     END
F1  C                     END
     C                     MOVE ETUDE     IM11
     C                     MOVE SEQDE     IM22
     C                     MOVE ETUDE     NOCLI
     C                     MOVE SEQDE     NOPRO
     C           CPRIM2    CHAINPREIMP2              33
    C           *IN33     CABEQ'1'       FOR7BI
     C                     MOVE TIMPS     EXT
     C                     MOVE ETUDE     NOCLI
     C                     MOVE SEQDE     NOPRO
     C                     MOVELDPRIMP    BLOC1
    C** DECODAGE UNITE DE VENTE
    C**************************
     C                     MOVE *BLANKS   UNITE
     C                     MOVE *BLANKS   CVUNIT
    C** AUX 1000
    C***********
D1  C           UVENTP    IFEQ 1
     C                     MOVE 1000      UNITE
F1  C                     END
    C** 100 M2
    C*********
D1  C           UVENTP    IFEQ 2
     C                     MOVE 100       UNITE
     C                     MOVE 'M2'      CVUNIT
F1  C                     END
    C** 100 ML
    C*********
D1  C           UVENTP    IFEQ 3
     C                     MOVE 100       UNITE
     C                     MOVE 'ML'      CVUNIT
F1  C                     END
    C** 100 KG
    C*********
D1  C           UVENTP    IFEQ 4
     C                     MOVE 100       UNITE
     C                     MOVE 'KG'      CVUNIT
F1  C                     END
    C** A L UNITE
    C************
D1  C           UVENTP    IFEQ 5
     C                     MOVE 1         UNITE
F1  C                     END
     C           FOR7TE    TAG
    C**         ******    ***
     C                     SETON                     24
     C                     WRITEF10
     C                     EXFMTF11
    C           *IN05     CABEQ'1'       FOR7BI
D1  C           *IN22     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF18
     C                     WRITEF33
     C                     WRITEF37
     C                     WRITEF28
     C                     SETOF                     12
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
    C                     ENDSR
     C/EJECT
    C** SOUS PROGRAMMES RECHERCHE PRODUITS DU CLIENT
    C***********************************************
    C           CHAPRO    BEGSR
     C                     Z-ADD*ZEROS    R2      40
     C                     Z-ADD*ZEROS    P2      40
     C                     Z-ADD*ZEROS    LIG
     C           NOCLI     SETLLPRODUI2
     C                     SETOF                     89
     C           NOCLI     SETLLRECAPT
     C           CHARGE    TAG
    C*          ******    ***
     C  N89      NOCLI     READEPRODUI2                  80
     C   80N89             SETON                     89
     C   89      NOCLI     READERECAPT                   80
    C   80      R2        CABEQ0         FIRECH
    C   80                GOTO AFFPRO
D1  C           ANNUL     IFNE ' '
    C                     GOTO CHARGE
F1  C                     END
     C                     MOVEARECPRO    RE,1
     C                     MOVEABLOC1     T1,1
     C                     MOVEABLOC2     T1,81
    C** FORMATAGE DE LA ZONE A TESTER
    C********************************
     C                     Z-ADD11        Z       20
     C           REC1      TAG
    C**         ****      ***
     C                     SUB  1         Z
    C           RE,Z      CABEQ' '       REC1
     C                     MOVELRECPRO    AA      1
     C                     Z-ADD1         U       30
     C           REC2      TAG
    C**         ****      ***
     C           AA        LOKUPT1,U                     38
D1  C           *IN38     IFEQ '0'
    C                     GOTO CHARGE
F1  C                     END
D1  C           U         IFNE 1
     C           U         SUB  1         UU      30
D2  C           T1,UU     IFNE ' '
     C                     ADD  1         U
    C                     GOTO REC2
F2  C                     END
F1  C                     END
     C                     MOVEAT1,U      EE,1
     C   78                Z-ADDZ         ZZZ     30
     C   78                ADD  1         ZZZ
D1  C   78      EE,ZZZ    IFEQ ' '
     C   78                ADD  1         U
    C   78                GOTO REC2
F1  C                     END
     C                     Z-ADDZ         W       20
     C           BLANC     TAG
    C**         *****     ***
     C                     ADD  1         W
    C           W         CABEQ11        COMPAR
     C                     MOVE ' '       EE,W
    C                     GOTO BLANC
     C           COMPAR    TAG
    C**         ******    ***
     C                     MOVEAEE        Z10    10
    C           Z10       CABEQRECPRO    ECRI
     C                     ADD  1         U
    C           U         CABGT180       CHARGE
    C                     GOTO REC2
     C           ECRI      TAG
    C**         ****      ***
     C                     ADD  1         R2
     C                     ADD  1         LIG
     C                     ADD  1         P2
     C                     WRITEF9C
D1  C           P2        IFEQ 5
     C                     Z-ADD*ZEROS    P2
    C                     GOTO AFFPRO
F1  C                     END
    C                     GOTO CHARGE
     C           AFFPRO    TAG
    C**         ******    ***
     C                     WRITEF9D
     C           AFFPR1    TAG
    C**         ******    ***
     C                     SETON                     1011
     C                     EXFMTF9B
     C                     SETOF                     1011
D1  C           *IN25     IFEQ '1'
     C                     Z-ADDLIG       R2
    C                     GOTO CHARGE
F1  C                     END
D1  C           *IN22     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF9B
     C                     SETOF                     12
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
D1  C                     DO   *HIVAL    R2
     C                     READCF9C                      80
    C           *IN80     CABEQ'1'       AFFPR1
     C                     MOVE TYNPOR    TYPOR
    C           TRI       CABNE' '       FIRECH
F1  C                     END
     C           FIRECH    TAG
    C**         ******    ***
     C                     SETON                     12
     C                     WRITEF9B
     C                     SETOF                     12
    C                     ENDSR
     C/EJECT
    C** REMISE A BLANC DES ZONES
    C***************************
    C           RAZ       BEGSR
    C** REMISE A ZERO DES TABLEAUX
    C*****************************
     C                     MOVE *BLANKS   T1
     C                     MOVE *BLANKS   RE
     C                     MOVE *BLANKS   EE
     C                     MOVE *BLANKS   TIM
     C                     MOVE *BLANKS   TRE
     C                     MOVE *BLANKS   STO
     C                     MOVE *BLANKS   TBF
     C                     MOVE *BLANKS   TBSI
     C                     MOVE *BLANKS   TBIM
     C                     MOVE *BLANKS   TBFA
     C                     MOVE *BLANKS   TBEX
     C                     MOVE *BLANKS   TBPX
     C                     MOVE *BLANKS   TBPR
     C                     MOVE *BLANKS   TBCD
     C                     MOVE *BLANKS   TBAD
     C                     MOVE *BLANKS   TBSS
     C                     MOVE *BLANKS   TBSD
     C                     MOVE *BLANKS   TBJD
     C                     MOVE *BLANKS   TBBO
     C                     MOVE *BLANKS   TBAF
     C                     MOVE *BLANKS   TBAL
     C                     MOVE *HIVAL    TSE
     C   U1                Z-ADD0         RGFAC
     C   U2                Z-ADD0         RGLIV
     C                     SETOF                     U6
    C** REMISE A ZERO DES ZONES PAR FORMAT
    C*************************************
    C   77                GOTO ACDCLI
D1  C           *IN63     IFEQ '1'
    C           *IN21     OREQ '1'
     C                     EXSR ANURE
D2  C           NONANU    IFEQ '1'
    C                     GOTO FINRAZ
F2  C                     END
D2  C           ANUGAR    IFEQ '2'
    C                     GOTO FINRAZ
F2  C                     END
F1  C                     END
    C**        R F1
     C                     MOVE *BLANKS   GROUPE
     C                     MOVE *BLANKS   STE
     C                     Z-ADD*ZEROS    NOCLI
    C**        R F2
     C                     MOVE *BLANKS   AGENT
     C                     MOVE *BLANKS   NOMCLI
     C                     MOVE *BLANKS   LIBAG
     C                     MOVE *BLANKS   INDUS
     C                     MOVE *BLANKS   TAUCOM
     C                     MOVE *BLANKS   NOMACH
     C                     MOVE *BLANKS   RAIACH
     C                     MOVE *BLANKS   RUEACH
     C                     MOVE *BLANKS   DEPACH
     C                     MOVE *BLANKS   CPACH
     C                     MOVE *BLANKS   VILACH
     C                     MOVE *BLANKS   NOMFAC
     C                     MOVE *BLANKS   RAIFAC
     C                     MOVE *BLANKS   RUEFAC
     C                     MOVE *BLANKS   DEPFAC
     C                     MOVE *BLANKS   CPFAC
     C                     MOVE *BLANKS   VILFAC
     C                     MOVE *BLANKS   NOMLIV
     C                     MOVE *BLANKS   RAILIV
     C                     MOVE *BLANKS   RUELIV
     C                     MOVE *BLANKS   DEPLIV
     C                     MOVE *BLANKS   CPLIV
     C                     MOVE *BLANKS   VILLIV
    C**        R F3
     C                     MOVE *BLANKS   JDECOU
     C                     MOVE *BLANKS   MDECOU
     C                     MOVE *BLANKS   ADECOU
    C*                    MOVE *BLANKS   DPDEC
     C                     MOVE *BLANKS   JCONTX
     C                     MOVE *BLANKS   MCONTX
     C                     MOVE *BLANKS   ACONTX
     C                     MOVE *BLANKS   JIMPAY
     C                     MOVE *BLANKS   MIMPAY
     C                     MOVE *BLANKS   AIMPAY
     C                     MOVE *BLANKS   COREGL
     C                     MOVE *BLANKS   LIBREG
     C                     MOVE *BLANKS   CORECH
     C                     MOVE *BLANKS   CORJOU
     C                     MOVE *BLANKS   ESCPT
     C                     MOVE *BLANKS   AGIOS
     C                     MOVE *BLANKS   VALSUI
    C**        R F5
     C                     MOVE *BLANKS   COREGL
     C                     MOVE *BLANKS   CORECH
     C                     MOVE *BLANKS   FDM
     C                     MOVE *BLANKS   CORJOU
     C                     MOVE *BLANKS   ESCPT
     C                     MOVE *BLANKS   AGIOS
     C                     MOVE *BLANKS   VALSUI
     C                     MOVE *BLANKS   COREG5
     C                     MOVE *BLANKS   COREC5
     C                     MOVE *BLANKS   CORJO5
     C                     MOVE *BLANKS   FDM5
     C                     MOVE *BLANKS   ESCPT5
     C                     MOVE *BLANKS   AGIOS5
     C                     MOVE *BLANKS   VALSU5
     C                     MOVE *BLANKS   FACFR5
     C                     MOVE *BLANKS   FACFO5
    C**        R F7
     C                     MOVE *BLANKS   COREG
     C                     MOVE *BLANKS   LIBRGT
     C                     MOVE *BLANKS   NOPRO
     C                     MOVE *BLANKS   NCONF
     C                     MOVE *BLANKS   RGFAC
     C                     MOVE *BLANKS   RGLIV
     C                     MOVE *BLANKS   RGFAC
     C                     MOVE *BLANKS   PUNITX
     C                     MOVE *BLANKS   PX
     C                     MOVE *BLANKS   PRIETR
    C**        R F23
     C                     MOVE *BLANKS   CODTA
     C                     MOVE *BLANKS   TAYOYO
     C                     MOVE *BLANKS   CLIFOU
     C                     SETOF                     2163
    C**
     C                     MOVE *BLANKS   LBCRE1
     C                     MOVE *BLANKS   LBCRE2
     C                     MOVE *BLANKS   LBCRE3
     C                     MOVE *BLANKS   LBCRE4
     C                     MOVE *BLANKS   LBCRE5
     C                     MOVE *BLANKS   LBCRE6
     C                     MOVE *BLANKS   LBCRE7
     C           ACDCLI    TAG
    C**         ******    ***
    C**          F9
     C                     MOVE *BLANKS   PREVIS
     C                     MOVE *BLANKS   PSERIE
     C                     MOVE *BLANKS   RECPRO
    C**          F10
     C                     MOVE *BLANKS   ETUDE
     C                     MOVE *BLANKS   SEQDE
    C**          F11
     C                     MOVE *BLANKS   DPRIMP
     C                     MOVE *BLANKS   PAPIS
     C                     MOVE *BLANKS   GRAMS
     C                     MOVE *BLANKS   REFEXS
     C                     MOVE *BLANKS   ADPAPS
     C                     MOVE *BLANKS   ADGRAS
     C                     MOVE *BLANKS   TIMPS
     C                     MOVE *BLANKS   COULS
     C                     MOVE *BLANKS   TVERS
     C                     MOVE *BLANKS   LMINIS
     C                     MOVE *BLANKS   FORLS
     C                     MOVE *BLANKS   FORHS
    C**          F12
     C                     MOVE *BLANKS   GARNT
     C                     MOVE *BLANKS   BLOC1
     C                     MOVE *BLANKS   UNITE
     C                     MOVE *BLANKS   CVUNIT
     C                     MOVE *BLANKS   ANPRO
     C                     MOVE *BLANKS   BLOC2
     C                     MOVE *BLANKS   USIMEX
     C                     MOVE *BLANKS   USIMIN
     C                     MOVE *BLANKS   USDORU
     C                     MOVE *BLANKS   USGAUF
     C                     MOVE *BLANKS   USDECO
     C                     MOVE *BLANKS   IMPPEX
     C                     MOVE *BLANKS   IMPPIN
     C                     MOVE *BLANKS   REFEX
     C                     MOVE *BLANKS   REFIN
     C                     MOVE *BLANKS   REFDOR
     C                     MOVE *BLANKS   REFGAU
     C                     Z-ADD*ZEROS    NOFOR
     C                     MOVE *BLANKS   IMPREX
     C                     MOVE *BLANKS   IMPRIN
     C                     MOVE *BLANKS   REREP0
     C                     MOVE *BLANKS   REPIN0
    C**          F13
     C                     MOVE *BLANKS   NOSEQ
     C                     MOVE *BLANKS   STMEXT
     C                     MOVE *BLANKS   STMINT
     C                     MOVE *BLANKS   STMDOR
     C                     MOVE *BLANKS   STMDEC
     C                     MOVE *BLANKS   INCMEX
     C                     MOVE *BLANKS   INCMIN
     C                     MOVE *BLANKS   INCMDO
     C                     MOVE *BLANKS   INCMGA
     C                     MOVE *BLANKS   INCMDE
     C                     MOVE *BLANKS   JBAOR
     C                     MOVE *BLANKS   MBAOR
     C                     MOVE *BLANKS   ABAOR
     C                     MOVE *BLANKS   JBAGAU
     C                     MOVE *BLANKS   MBAGAU
     C                     MOVE *BLANKS   ABAGAU
     C                     MOVE *BLANKS   JBAFOR
     C                     MOVE *BLANKS   MBAFOR
     C                     MOVE *BLANKS   ABAFOR
     C                     MOVE *BLANKS   JDEF01
     C                     MOVE *BLANKS   MDEF01
     C                     MOVE *BLANKS   ADEF01
     C                     MOVE *BLANKS   JDEF03
     C                     MOVE *BLANKS   MDEF03
     C                     MOVE *BLANKS   ADEF03
     C                     MOVE *BLANKS   JDEOR
     C                     MOVE *BLANKS   MDEOR
     C                     MOVE *BLANKS   ADEOR
     C                     MOVE *BLANKS   JDEGAU
     C                     MOVE *BLANKS   MDEGAU
     C                     MOVE *BLANKS   ADEGAU
     C                     MOVE *BLANKS   JDEFOR
     C                     MOVE *BLANKS   MDEFOR
     C                     MOVE *BLANKS   ADEFOR
     C                     MOVE *BLANKS   REC01
     C                     MOVE *BLANKS   REC03
     C                     MOVE *BLANKS   RECOR
     C                     MOVE *BLANKS   RECGAU
     C                     MOVE *BLANKS   RECFOR
     C                     MOVE *BLANKS   STMEXX
     C                     MOVE *BLANKS   STMINX
     C                     MOVE *BLANKS   STMGOX
     C                     MOVE *BLANKS   STMGAX
     C                     MOVE *BLANKS   STMDEX
     C                     MOVE *BLANKS   FACMEX
     C                     MOVE *BLANKS   FACMIN
     C                     MOVE *BLANKS   FACMDO
     C                     MOVE *BLANKS   FACMGA
     C                     MOVE *BLANKS   FACMDE
     C                     MOVE *BLANKS   MONMAT
     C                     MOVE *BLANKS   MATETR
     C                     MOVE *BLANKS   MONMAI
     C                     MOVE *BLANKS   MONMAD
     C                     MOVE *BLANKS   MONMAG
     C                     MOVE *BLANKS   MONMDE
     C                     MOVE *BLANKS   FRINCS
     C                     MOVE *BLANKS   FRINCI
     C                     MOVE *BLANKS   FRINCD
     C                     MOVE *BLANKS   FRINCG
     C                     MOVE *BLANKS   FRINDE
     C                     MOVE *BLANKS   MATSTE
     C                     MOVE *BLANKS   MATSTI
     C                     MOVE *BLANKS   MATSTD
     C                     MOVE *BLANKS   MATSTG
     C                     MOVE *BLANKS   MATSDE
     C                     MOVE *BLANKS   MATCLI
     C                     MOVE *BLANKS   MATCIN
     C                     MOVE *BLANKS   MATCLD
     C                     MOVE *BLANKS   MATCLG
     C                     MOVE *BLANKS   MATCLE
     C                     MOVE *BLANKS   MATFAC
     C                     MOVE *BLANKS   MATFAI
     C                     MOVE *BLANKS   MATFAD
     C                     MOVE *BLANKS   MATFAG
     C                     MOVE *BLANKS   MATFAE
     C                     MOVE *BLANKS   CLIMAT
     C                     MOVE *BLANKS   COMATJ
     C                     MOVE *BLANKS   COMATM
     C                     MOVE *BLANKS   COMATA
     C                     MOVE *BLANKS   COMATS
    C** F15
     C                     MOVE *BLANKS   STOCK2
     C                     MOVE *BLANKS   LSTOC2
     C                     MOVE *BLANKS   STOCK3
     C                     MOVE *BLANKS   LSTOC3
     C                     MOVE *BLANKS   STOCK4
     C                     MOVE *BLANKS   LSTOC4
     C                     MOVE *BLANKS   STOCK5
     C                     MOVE *BLANKS   LSTOC5
     C                     MOVE *BLANKS   STOCK6
     C                     MOVE *BLANKS   LSTOC6
     C                     Z-ADD0         IMPSTY
     C                     Z-ADD0         R3      40
    C** F17
     C                     MOVE *BLANKS   RECVER
     C                     MOVE *BLANKS   IMPSTY
     C                     MOVE *BLANKS   USSTO
     C                     MOVE *BLANKS   PCLI
     C                     MOVE *BLANKS   STENKG
    C** F19
     C                     MOVE *BLANKS   STPFIN
     C                     MOVE *BLANKS   STIMPR
     C                     MOVE *BLANKS   ACTPRO
     C                     MOVE *BLANKS   ANCPRO
     C                     MOVE *BLANKS   ANPRO
    C** F20
     C                     MOVE *BLANKS   BILCO
     C                     MOVE *BLANKS   BILCA
     C                     MOVE *BLANKS   BILHIS
    C** F21
     C                     MOVE *BLANKS   QTTOT
     C                     MOVE *BLANKS   FLD005
     C                     MOVE *BLANKS   QTFAB
     C                     MOVE *BLANKS   BOBPDS
     C                     MOVE *BLANKS   QTPRE
     C                     MOVE *BLANKS   QTREN
     C                     MOVE *BLANKS   WAGON
     C                     MOVE *BLANKS   ENBOBI
     C                     MOVE *BLANKS   NBLIV
     C                     MOVE *BLANKS   FRLIV
     C                     MOVE *BLANKS   NBIMP
     C                     MOVE *BLANKS   NBIRE
     C                     MOVE *BLANKS   NBFAB
     C                     MOVE *BLANKS   TYPOR
     C                     MOVE *BLANKS   PORAFA
     C                     MOVE *BLANKS   BOBFAB
     C                     MOVE *BLANKS   QTECAD
     C                     MOVE *BLANKS   QTERES
     C                     MOVE *BLANKS   OUINON
    C** F22
     C                     MOVE *BLANKS   PRIUNX
     C                     MOVE *BLANKS   PXS
     C                     MOVE *BLANKS   PRIMET
     C                     MOVE *BLANKS   PLANC
     C                     MOVE *BLANKS   PLANET
     C                     MOVE *BLANKS   INDPCL
     C                     MOVE *BLANKS   COMCLJ
     C                     MOVE *BLANKS   COMCLM
     C                     MOVE *BLANKS   COMCLA
     C                     MOVE *BLANKS   COMCLS
     C                     MOVE *BLANKS   CLIREF
     C                     MOVE *BLANKS   REFUNI
     C                     MOVE *BLANKS   TOLE1
     C                     MOVE *BLANKS   TOLE2
     C                     MOVE *BLANKS   PROT
     C                     MOVE *BLANKS   MICLI
     C                     MOVE *BLANKS   MACLI
     C                     MOVE *BLANKS   LIBTO1
     C                     MOVE *BLANKS   RGFAC1
     C                     MOVE *BLANKS   RGLIV1
     C                     MOVE *BLANKS   LIBTO2
     C                     MOVE *BLANKS   RGFAC2
     C                     MOVE *BLANKS   RGLIV2
     C                     MOVE *BLANKS   XAPPSS
    C** F23
     C                     MOVE *BLANKS   CODINC
     C                     MOVE *BLANKS   LIBINC
     C                     MOVE *BLANKS   NOMTRA
     C                     MOVE *BLANKS   RAITRA
     C                     MOVE *BLANKS   RUETRA
     C                     MOVE *BLANKS   VILTRA
     C                     MOVE *BLANKS   DEPTRA
     C                     MOVE *BLANKS   CPTRA
     C                     MOVE *BLANKS   BDTRA
     C                     MOVE *BLANKS   CPAYTR
     C                     MOVE *BLANKS   PAYTRA
     C                     MOVE *BLANKS   EXPO1
     C                     MOVE *BLANKS   EXPO2
     C                     MOVE *BLANKS   NBEFAC
    C** F26
     C                     MOVE *BLANKS   PRIMET
     C                     MOVE *BLANKS   PLANET
    C** F29
     C                     MOVE *BLANKS   LIBFIC
     C                     MOVE *BLANKS   SELECT
     C                     MOVE *BLANKS   LIBOBI
     C                     MOVE *BLANKS   RGRG11
     C                     MOVE *BLANKS   RGRG22
    C** F30
     C                     MOVE *BLANKS   LBCDE1
     C                     MOVE *BLANKS   LBCDE2
     C                     MOVE *BLANKS   LBCDE3
     C                     MOVE *BLANKS   LBCDE4
     C                     MOVE *BLANKS   LBCDE5
     C                     MOVE *BLANKS   LBCDE6
     C                     MOVE *BLANKS   LBCDE7
     C                     MOVE *BLANKS   LBCDE8
    C** F32
     C                     MOVE *BLANKS   OBSI1
     C                     MOVE *BLANKS   OBSI2
     C                     MOVE *BLANKS   OBSI3
     C                     MOVE *BLANKS   LIBCD1
     C                     MOVE *BLANKS   LIBCD2
     C                     MOVE *BLANKS   LIBCD3
     C                     MOVE *BLANKS   LIBCD4
     C                     MOVE 'NON'     ANNREM
     C                     Z-ADD*ZEROS    NCDEAR
    C** F9A
     C                     MOVE *BLANKS   BLOC1
     C                     MOVE *BLANKS   ANDEV
     C                     MOVE *BLANKS   ETUDE
     C                     MOVE *BLANKS   ANPRO
     C                     MOVE *BLANKS   GARNT
     C                     MOVE *BLANKS   BLOC2
     C                     MOVE *BLANKS   SEQDE
     C                     MOVE *BLANKS   BLOC4
     C                     MOVE *BLANKS   BLOC5
     C                     MOVE *BLANKS   BLOC6
     C                     MOVE *BLANKS   BLOC7
     C                     MOVE *BLANKS   TOTBOB
     C                     MOVE *BLANKS   LIBUSI
     C                     MOVE *BLANKS   LIBOB1
     C                     MOVE *BLANKS   LIBOB2
    C** F9C
     C                     MOVE *BLANKS   TRI
     C                     MOVE *BLANKS   BLOC1
     C                     MOVE *BLANKS   BLOC2
    C** F9B
     C                     MOVE *BLANKS   LIG
    C** F34
     C                     MOVE *BLANKS   MOSU
     C                     MOVE *BLANKS   SEQFAB
     C                     MOVE *BLANKS   SEQIMP
     C                     MOVE *BLANKS   ANDEL
     C                     MOVE *BLANKS   SSDEL
     C                     MOVE *BLANKS   SEDEL
     C                     MOVE *BLANKS   JSDEL
     C                     MOVE *BLANKS   CODEL
     C                     MOVE *BLANKS   QTIMP
     C                     MOVE *BLANKS   QTFAC
     C                     MOVE *BLANKS   QTEXP
     C                     MOVE *BLANKS   NBOBI
    C** F33
     C                     MOVE *BLANKS   PORC
     C                     MOVE *BLANKS   QTFAB
     C                     MOVE *BLANKS   QTREN
     C                     MOVE *BLANKS   FRLIV
     C                     MOVE *BLANKS   TAXE
     C                     MOVE *BLANKS   WAGON
    C** F35
     C                     MOVE *BLANKS   SEQFAB
     C                     MOVE *BLANKS   SEQIMP
     C                     MOVE *BLANKS   QTIMP
     C                     MOVE *BLANKS   QTFAC
     C                     MOVE *BLANKS   QTEXP
    C** F38
     C                     MOVE *BLANKS   MOSU
     C                     MOVE *BLANKS   QTEXP
     C                     MOVE *BLANKS   NBOBI
     C                     MOVE *BLANKS   REFCDE
     C                     MOVE *BLANKS   JCDE
     C                     MOVE *BLANKS   MCDE
     C                     MOVE *BLANKS   ACDE
    C** F37
     C                     MOVE *BLANKS   QTREN8
     C                     MOVE *BLANKS   FRLIV
     C                     MOVE *BLANKS   TAXE
    C** F39
     C                     MOVE *BLANKS   SEQFAB
     C                     MOVE *BLANKS   QTEXP
     C                     MOVE *BLANKS   NBOBI
     C                     MOVE *BLANKS   REFCDE
    C** F35A
     C                     MOVE *BLANKS   LIBER
     C                     SETOF                     203034
     C                     SETOF                     87
    C** F50
     C                     MOVE *BLANKS   SUPGAR
     C                     MOVE *BLANKS   EXT
     C                     MOVE *BLANKS   INT
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
     C                     MOVE *BLANKS   STMEXX
     C                     MOVE *BLANKS   STMINX
    C** REMISE A ZEROS DES ZONES DES FICHIERS
    C****************************************
    C** CDES
    C*******
     C                     MOVE *BLANKS   CREGS
     C                     MOVE *BLANKS   CECHES
     C                     MOVE *BLANKS   JREGLS
     C                     MOVE *BLANKS   ESCOMS
     C                     MOVE *BLANKS   AGIOSS
     C                     MOVE *BLANKS   FDMS
     C                     MOVE *BLANKS   VALSUS
     C                     MOVE *BLANKS   FACFRS
     C                     MOVE *BLANKS   EXPFAS
     C                     MOVE *BLANKS   SANFAC
     C                     MOVE *BLANKS   IMPSTO
     C                     MOVE *BLANKS   PRESER
     C                     MOVE *BLANKS   CDEPRE
     C                     MOVE *BLANKS   BOBPDS
     C                     MOVE *BLANKS   LIMULS
     C                     MOVE *BLANKS   STIMP
     C                     MOVE *BLANKS   STOND
     C                     MOVE *BLANKS   STFAC
     C                     MOVE *BLANKS   STASS
     C                     MOVE *BLANKS   QTOT
     C                     MOVE *BLANKS   RRRLIV
    C** CDEOBS
    C*********
     C                     MOVE *BLANKS   TYPOBS
     C                     MOVE *BLANKS   SEQOBS
     C                     MOVE *BLANKS   OBSERV
     C                     MOVE *BLANKS   CODOBS
    C** CDEXPO
    C*********
     C                     MOVE *BLANKS   CONDEX
     C                     MOVE *BLANKS   NBFAC
     C                     MOVE *BLANKS   ANDEL
     C                     MOVE *BLANKS   SSDEL
     C                     MOVE *BLANKS   SEDEL
     C                     MOVE *BLANKS   JSDEL
     C                     MOVE *BLANKS   SSDDEL
     C                     MOVE *BLANKS   ADEDEL
     C                     MOVE *BLANKS   SDEDEL
     C                     MOVE *BLANKS   JDEDEL
    C** CDEMAT
    C*********
     C                     MOVE *BLANKS   CODMAT
    C** REMISE A ZEROS DES DATASTRUCTURES
    C************************************
     C                     SETON                     12
     C  N77                WRITEF6
     C                     WRITEF9B
     C                     WRITEF18
     C                     WRITEF28
     C                     WRITEF37
     C                     WRITEF33
     C                     SETOF                     12
     C  N77                MOVE '0'       *IN
     C                     MOVE '1'       *IN99
     C                     Z-ADD*ZEROS    FFF
     C                     Z-ADD*ZEROS    STMGOX
     C                     Z-ADD*ZEROS    STMGAX
     C                     Z-ADD*ZEROS    STMDEX
     C                     Z-ADD*ZEROS    MONMAD
     C                     Z-ADD*ZEROS    FRINCI
     C                     Z-ADD*ZEROS    FRINCS
     C                     Z-ADD*ZEROS    MATSTE
     C                     Z-ADD*ZEROS    MATCLI
     C                     Z-ADD*ZEROS    MATFAC
     C                     Z-ADD*ZEROS    MATSTI
     C                     Z-ADD*ZEROS    MATFAI
     C                     Z-ADD*ZEROS    MONMAI
     C                     Z-ADD*ZEROS    FRINCI
     C                     Z-ADD*ZEROS    MATCIN
     C                     Z-ADD*ZEROS    MONMAD
     C                     Z-ADD*ZEROS    FRINCD
     C                     Z-ADD*ZEROS    MATSTD
     C                     Z-ADD*ZEROS    MATCLD
     C                     Z-ADD*ZEROS    MATFAD
     C                     Z-ADD*ZEROS    MONMAG
     C                     Z-ADD*ZEROS    FRINCG
     C                     Z-ADD*ZEROS    MATSTG
     C                     Z-ADD*ZEROS    MATCLG
     C                     Z-ADD*ZEROS    MATFAG
     C                     Z-ADD*ZEROS    MONMDE
     C                     Z-ADD*ZEROS    FRINDE
     C                     Z-ADD*ZEROS    MATSDE
     C                     Z-ADD*ZEROS    MATCLE
     C                     Z-ADD*ZEROS    MATFAE
     C                     MOVE '0'       NONANU
     C                     MOVE '0'       ANUGAR
    C           FINRAZ    ENDSR
    C           ANURE     BEGSR
     C           FORM50    TAG
    C**         ******    ***
     C                     EXFMTF50
D1  C           *IN02     IFEQ '1'
     C                     MOVE '1'       NONANU
    C                     GOTO FINRE
F1  C                     END
    C           SUPGAR    CABEQ' '       FORM50
D1  C           SUPGAR    IFEQ '2'
     C                     SETON                     12
     C                     WRITEF28
     C                     WRITEF33
     C                     WRITEF37
     C                     SETOF                     12
     C                     MOVE '2'       ANUGAR  1
    C                     GOTO FINRE
F1  C                     END
D1  C           SUPGAR    IFEQ '1'
     C                     MOVE CONFIR    NCONF
     C           NCONF     SETLLCDESL1
     C           NCONF     SETLLCDEOBSL1
     C           NCONF     SETLLCDEMATL1
     C           NCONF     SETLLCARCDEL1
     C           NCONF     SETLLCDEXPOL1
    C** SUPPRESSION DANS CDESL1
    C**************************
D2  C                     DO   *HIVAL
     C           NCONF     READECDESL1                   38
    C   38                GOTO SUI38A
     C                     DELETCDEAAAAA
F2  C                     END
     C           SUI38A    TAG
    C**         ******    ***
    C** SUPPRESSION DANS CDEOBSL1
    C****************************
D2  C                     DO   *HIVAL
     C           NCONF     READECDEOBSL1                 38
    C   38                GOTO SUI38B
     C                     DELETCDEBBBBB
F2  C                     END
     C           SUI38B    TAG
    C**         ******    ***
    C** SUPPRESSION DANS CDEXPOL1
    C****************************
D2  C                     DO   *HIVAL
     C           NCONF     READECDEXPOL1                 38
    C   38                GOTO SUI38C
     C                     DELETCDECCCCC
F2  C                     END
     C           SUI38C    TAG
    C**         ******    ***
    C** SUPPRESSION DANS CDEMATL1
    C****************************
D2  C                     DO   *HIVAL
     C           NCONF     READECDEMATL1                 38
    C   38                GOTO SUI38D
     C                     DELETCDEDDDDD
F2  C                     END
     C           SUI38D    TAG
    C**         ******    ***
    C** SUPPRESSION DANS CARCDEL1
    C****************************
D2  C                     DO   *HIVAL
     C           NCONF     READECARCDEL1                 38
    C   38                GOTO SUI38E
     C                     DELETCDEEEEEE
F2  C                     END
     C           SUI38E    TAG
    C**         ******    ***
F1  C                     END
    C           FINRE     ENDSR
     C/EJECT
    C*****************************************************
    C** SOUS PROGRAMME DE TEST DE SAISIE MATERIEL F14    *
    C*****************************************************
    C           TESGEN    BEGSR
     C                     SETOF                     38
     ** STATUT MATERIEL SAISI ?
     **************************
D1  C           STMGEN    IFEQ 0
D2  C           TTG       IFEQ TTA
     C   64                SETON                     35
    C   35                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     36
    C   36                GOTO FINTES
F2  C                     END
    C*          TTG       IFEQ TTE
    C*  66                SETON                     37
    C*  37                GOTO FINTES
    C*                    END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     38
    C   38                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     39
    C   39                GOTO FINTES
F2  C                     END
F1  C                     END
    C** TEST SI STATUT = 3
    C*********************
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           FACGEN    IFNE *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MONGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE1    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE2    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE3    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT SAISIE ?
    C******************************
D1  C           STMGEN    IFEQ 1
    C           STMGEN    OREQ 2
D2  C           FACGEN    IFEQ *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     40
    C   40                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     41
    C   41                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     42
    C   42                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     43
    C   43                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     44
    C   44                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT = NON ET MONTANT SAISI
    C********************************************
D1  C           FACGEN    IFEQ 'NON'
    C           MONGEN    ANDNE*ZEROS
D2  C           TTG       IFEQ TTA
     C   64                SETON                     45
    C   45                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     46
    C   46                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTE
     C   66                SETON                     47
    C   47                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     48
    C   48                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     49
    C   49                GOTO FINTES
F2  C                     END
F1  C                     END
    C** SI FACT AUTRE CLIENT VERIF DE SON EXISTANCE
    C**********************************************
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFNE 0
     C           CLETES    CHAINCLIFACL3             38
D4  C           *IN38     IFEQ '1'
     C                     SETOF                     38
    C* CLIENT OU SEQUENCE INCONNU
    C****************************
D5  C           TTG       IFEQ TTA
     C         64          SETON                     55
    C         55          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTB
     C         65          SETON                     56
    C         56          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTE
     C         66          SETON                     57
    C         57          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTC
     C         67          SETON                     58
    C         58          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTD
     C         68          SETON                     59
    C         59          GOTO FINTES
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C* SAISIE INCOMPLETE
    C*******************
D1  C           MATGE1    IFEQ 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFEQ 0
D2  C           MATGE2    IFEQ 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFEQ 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFEQ 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT = NON ET AUTRE CLIENT SAISI
    C*************************************************
D1  C           FACGEN    IFEQ 'NON'
    C           MATGE1    ANDNE*ZEROS
    C           FACGEN    OREQ 'NON'
    C           MATGE1    ANDNE*ZEROS
    C           FACGEN    OREQ 'NON'
    C           MATGE1    ANDNE*ZEROS
D2  C           TTG       IFEQ TTA
     C   64                SETON                     24
    C   24                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     74
    C   74                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTE
     C   66                SETON                     76
    C   76                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     83
    C   83                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     94
    C   94                GOTO FINTES
F2  C                     END
F1  C                     END
    C** TEST SI STATUT = 3
    C*********************
D1  C           STMGEN    IFEQ 4
D2  C           FACGEN    IFNE *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MONGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE1    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE2    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE3    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           FRIGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     31
    C   31                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     32
    C   32                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     33
    C   33                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     34
    C   34                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C           FINTES    ENDSR
     C/EJECT
    C*****************************************************
    C** SOUS PROGRAMME DE RECHERCHE PRE IMPRIME STOCKE   *
    C*****************************************************
    C           RECSTO    BEGSR
     C                     Z-ADD0         FFF     40
     C                     Z-ADD0         GGG     40
     C                     Z-ADD0         IMPSTY
     C           CLEIM1    SETLLMVTIMPLF
     C           CLEIM1    READEMVTIMPLF                 80
    C         80          GOTO FRESTO
     C                     MOVELUSINE     ZZ7     7
     C                     MOVE PCLI      ZZ7
     C           CLEIM1    SETLLMVTIMPLF
D1  C                     DO   *HIVAL
     C           CLEIM1    READEMVTIMPLF                 80
D2  C           *IN80     IFEQ '1'
    C           GGG       CABNE0         OUI80
    C                     GOTO FRESTO
F2  C                     END
     C                     MOVELUSINE     ZZZ7    7
     C                     MOVE PCLI      ZZZ7
D2  C           ZZZ7      IFEQ ZZ7
     C                     Z-ADDPDSBOB    TRUC
     C                     ADD  TRUC      IMPSTY
F2  C                     END
     C                     ADD  1         GGG
D2  C           ZZZ7      IFNE ZZ7
     C           OUI80     TAG
    C**         ******    ****
     C                     ADD  1         FFF
     C                     ADD  1         R3
     C                     MOVELZZ7       US7     10
     C                     MOVE 'USIN'    ARGU
     C                     MOVE US7       VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    USSTO
F3  C                     END
     C                     MOVE ZZ7       PCLI77  6
     C                     MOVE PCLI      PCLA    7
     C                     MOVE PCLI77    PCLI
D3  C           *IN18     IFEQ '1'
     C                     MOVE TI1,1     RECVER
F3  C                     END
     C                     MOVE TI2,1     STENKG
     C                     ADD  IMPSTY    STIMPR
     C                     WRITEF17
     C                     MOVE *BLANKS   RECVER
     C                     MOVE *BLANKS   STENKG
     C                     Z-ADD0         IMPSTY
    C   80                GOTO FRESTO
     C                     Z-ADDPDSBOB    TRUC    70
     C                     ADD  TRUC      IMPSTY
     C                     MOVE PCLA      PCLI
     C                     MOVE ZZZ7      ZZ7
F2  C                     END
F1  C                     END
    C           FRESTO    ENDSR
     C/EJECT
    C*****************************************************
    C** SOUS PROGRAMME DE RECHERCHE PRE IMPRIME          *
    C*****************************************************
    C           RECST1    BEGSR
     C                     Z-ADD0         IMPSTY
     C           CLEIM3    SETLLMVTIMPLF
     C           CLEIM3    READEMVTIMPLF                 80
    C         80          GOTO FREST1
     C                     MOVELUSINE     ZZ7     7
     C                     MOVE PCLI      ZZ7
     C           CLEIM3    SETLLMVTIMPLF
D1  C                     DO   *HIVAL
     C           CLEIM3    READEMVTIMPLF                 80
D2  C           *IN80     IFEQ '1'
    C           GGG       CABNE0         OUI8A
    C                     GOTO FREST1
F2  C                     END
     C                     MOVELUSINE     ZZZ7    7
     C                     MOVE PCLI      ZZZ7
     C           TREHOT    TAG
D2  C           ZZZ7      IFEQ ZZ7
    C********************************************
D3  C           *IN84     IFEQ '0'
     C                     ADD  PROFIN    IMPSTY
F3  C                     END
D3  C           *IN84     IFEQ '1'
     C                     ADD  PDSBOB    IMPSTY
F3  C                     END
     C                     ADD  1         GGG
F2  C                     END
D2  C           ZZZ7      IFNE ZZ7
     C           OUI8A     TAG
    C**         ******    ****
     C                     ADD  1         FFF
     C                     ADD  1         R3
     C                     MOVELZZ7       US7     10
     C                     MOVE 'USIN'    ARGU
     C                     MOVE US7       VALE      P
     C           CLPARA    CHAINPARAME               38
D3  C           *IN38     IFEQ '0'
     C                     MOVELPXABRG    USSTO
F3  C                     END
     C                     MOVE ZZ7       PCLI77  6
     C                     MOVE PCLI      PCLA    7
     C                     MOVE PCLI77    PCLI
     C                     MOVE *BLANKS   RECVER
     C                     MOVE *BLANKS   STENKG
D3  C           REFEX     IFEQ REFIN
    C           REFEX     ANDNE*BLANKS
     C                     MOVE TI1,1     RECVER
F3  C                     END
D3  C           *IN84     IFEQ '1'
     C                     MOVE TI2,1     STENKG
F3  C                     END
    C** TRANSFORMATION DU POIDS EN UNITE DE VENTE
    C********************************************
     C                     ADD  IMPSTY    STIMPR
     C                     WRITEF17
     C                     MOVE PCLA      PCLI
     C                     MOVE ZZZ7      ZZ7
     C   80                MOVE *BLANKS   RECVER
     C   80                MOVE *BLANKS   STENKG
     C                     Z-ADD0         IMPSTY
    C  N80                GOTO TREHOT
    C   80                GOTO FREST1
F2  C                     END
F1  C                     END
    C           FREST1    ENDSR
     C/EJECT
    C** ECRITURE DANS LES FICHIERS
    C*****************************
    C           ECRIFI    BEGSR
     C   84                MOVE *BLANKS   ABRCLI
     C   84                MOVE *BLANKS   GROUPE
     C           *NAMVAR   DEFN           CONFIR  50
D1  C           *IN63     IFEQ '0'
    C           *IN21     ANDEQ'0'
     C           *LOCK     IN   CONFIR
     C           PLUSHO    TAG
     C                     ADD  1         CONFIR
     C           CONFIR    CHAINCDENO                80
    C           *IN80     CABEQ'0'       PLUSHO
D2  C           CONFIR    IFGE 99000
     C                     Z-ADD1         CONFIR
F2  C                     END
     C           *LOCK     OUT  CONFIR
     C                     UNLCKCONFIR
     C                     Z-ADDCONFIR    NCONF
F1  C                     END
D1  C           *IN21     IFEQ '1'
    C           *IN63     OREQ '1'
     C                     MOVE LBCRE1    LBCDE1
     C                     MOVE LBCRE2    LBCDE2
     C                     MOVE LBCRE3    LBCDE3
     C                     MOVE LBCRE4    LBCDE4
     C                     MOVE LBCRE5    LBCDE5
     C                     MOVE LBCRE6    LBCDE6
     C                     MOVE LBCRE7    LBCDE7
     C                     MOVE LBCRE8    LBCDE8
     C                     MOVE CDPRRE    CDEPRE
     C                     MOVE PRESRE    PRESER
     C                     MOVE '*'       SANFAC
F1  C                     END
D1  C           *IN86     IFEQ '0'
    C           *IN21     ANDEQ'0'
     C           FORM51    TAG
     C                     EXFMTF51
    C** ANNULATION DE LA SAISIE
    C**************************
D2  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
D3  C           NONANU    IFEQ '1'
     C                     MOVE '0'       NONANU
    C                     GOTO FORM51
F3  C                     END
D3  C           ANUGAR    IFEQ '2'
     C                     MOVE '0'       ANUGAR
    C                     GOTO GARNIT
F3  C                     END
    C                     GOTO FORM01
F2  C                     END
F1  C                     END
    C*****************************************************
    C**                   C D E S
    C*****************************************************
D1  C           COREG5    IFNE *BLANKS
     C                     MOVE COREG5    CREGS
     C                     MOVE COREC5    CECHES
     C                     MOVE CORJO5    JREGLS
     C                     MOVE FDM5      FDMS
     C                     MOVE ESCPT5    ESCOMS
     C                     MOVE AGIOS5    AGIOSS
     C                     MOVE VALSU5    VALSUS
F1  C                     END
D1  C           FACFR5    IFNE 'NON'
    C           FACFR5    ANDNE'   '
     C                     MOVE '1'       FACFRS
X1  C                     ELSE
     C                     MOVE '0'       FACFRS
F1  C                     END
D1  C           FACFO5    IFNE 'NON'
    C           FACFO5    ANDNE'   '
     C                     MOVE '1'       EXPFAS
X1  C                     ELSE
     C                     MOVE '0'       EXPFAS
F1  C                     END
     C                     Z-ADDQTTOT     QTOT
     C                     MOVE INDPCL    CLIPRO
     C                     MOVE PROT      PROTO
D1  C           *IN84     IFEQ '0'
     C                     MOVE COMCLS    CONFS
     C                     MOVE COMCLA    CONFA
     C                     MOVE COMCLM    CONFM
     C                     MOVE COMCLJ    CONFJ
X1  C                     ELSE
     C                     Z-ADD0         COMCLJ
     C                     Z-ADD0         COMCLM
     C                     Z-ADD0         COMCLA
     C                     Z-ADD0         COMCLS
F1  C                     END
    C** TRAITEMENT DE LA ZONE LIMULS
    C*******************************
     C  N84N86N63
D1  CANN21                DO
D2  C           PORKG     IFEQ *ZEROS
    C           TYPOR     ANDNE3
    C           TYPOR     ANDNE4
     C                     Z-ADD1         R5
     C           R5        CHAINF34                  38
     C                     MOVE RGLIV     RRRLIV  20
D3  C                     DO   *HIVAL    R5
     C           R5        CHAINF34                  38
    C         38          GOTO FILIMU
D4  C           RGLIV     IFNE RRRLIV
     C                     MOVE '*'       LIMULS
    C                     GOTO FILIMU
F4  C                     END
F3  C                     END
F2  C                     END
     C           FILIMU    TAG
    C**         ******    ***
F1  C                     END
    C*
D1  C           RPAP      IFEQ 'N'
     C                     MOVE '*'       STFAC
F1  C                     END
    C*
     C                     MOVE *BLANKS   SOLDES
     C                     MOVE *BLANKS   TAGBID
     C                     MOVE *BLANKS   TAGMAJ
     * Cde saisie en Usine SANS passage Bibon
D1  C           USAISI    IFEQ '*'
    C           NOVETO    ANDEQ'OUI'
     C                     MOVE 'U'       TAGBID
     C                     MOVE '*'       TAGMAJ
F1  C                     END
     *
     C                     MOVE *BLANKS   TAGREL
     C                     MOVE *BLANKS   TAGCON
     C                     Z-ADD*ZEROS    ARJ
     C                     Z-ADD*ZEROS    ARM
     C                     Z-ADD*ZEROS    ARA
     C                     Z-ADD*ZEROS    ANULJ
     C                     Z-ADD*ZEROS    ANULM
     C                     Z-ADD*ZEROS    ANULA
     C                     MOVELGARNT     VC      1
D1  C           VC        IFEQ 'M'
     C                     MOVE *BLANKS   GARNT
F1  C                     END
     C   86                Z-ADD*ZEROS    USEXT
     C   86                Z-ADD*ZEROS    USINT
     C                     MOVEL*YEAR     CONFS
     C                     MOVE *YEAR     CONFA
     C                     MOVE UMONTH    CONFM
     C                     MOVE UDAY      CONFJ
D1  C           FACON     IFEQ 1
    C           UVENT     ANDEQ4
    C           FACON     OREQ 2
    C           UVENT     ANDEQ4
     C                     Z-ADDENBOBI    TOTBOB
F1  C                     END
     C                     MOVE LIBUS     POSTE
     C                     Z-ADDTAYOYO    CODTA
     C                     MOVE INITIA    INICRE
     C                     MOVE XAPPSS    XAPPS
     C         84          MOVE USINEP    USINE
     C         84          MOVE USINEP    USINE
     C         84          Z-ADDUVENTP    UVENT
D1  C           USAISI    IFEQ '*'
     C                     MOVE '*'       STIMP
F1  C                     END
D1  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDPRIUNX    PRIMET
     C                     Z-ADDPLANC     PLANET
     C                     Z-ADDPRIUNX    TZO,1
     C                     Z-ADDPLANC     TZO,2
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     PRIUNX
     C                     Z-ADDTZO,2     PLANC
     C                     EXSR SPCOUR
X1  C                     ELSE
     C                     Z-ADD1         COURS
F1  C                     END
     C                     Z-ADDPRIUNX    PRIUNS
D1  C           NBFAB     IFNE *ZEROS
    C           IN82      ANDEQ'*'
     C           QTTOT     DIV  NBFAB     QTFAB
F1  C                     END
     C                     MOVE NATCDE    STOND
     C                     WRITECDESF1
    C*****************************************************
    C**                   C D E O B S
    C*****************************************************
    C** OBSERVATIONS AU CLIENT
    C************************
D1  C           LBCDE1    IFNE *BLANKS
     C                     MOVE LBCDE1    OBSERV
     C                     Z-ADD1         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LBCDE2    IFNE *BLANKS
     C                     MOVE LBCDE2    OBSERV
     C                     Z-ADD2         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LBCDE3    IFNE *BLANKS
     C                     MOVE LBCDE3    OBSERV
     C                     Z-ADD3         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LBCDE4    IFNE *BLANKS
     C                     MOVE LBCDE4    OBSERV
     C                     Z-ADD4         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C** OBSERVATION FICHIER CLIENT
    C*****************************
D1  C           LBCDE5    IFNE *BLANKS
     C                     MOVE LBCDE5    OBSERV
     C                     Z-ADD5         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LBCDE6    IFNE *BLANKS
     C                     MOVE LBCDE6    OBSERV
     C                     Z-ADD6         SEQOBS
     C                     MOVE 'C'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C** OBSERVATION MARCHE
    C*********************
D1  C           LBCDE7    IFNE *BLANKS
     C                     MOVE LBCDE7    OBSERV
     C                     Z-ADD7         SEQOBS
     C                     MOVE 'M'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C** OBSERVATION FACTURE
    C**********************
D1  C           LBCDE8    IFNE *BLANKS
     C                     MOVE LBCDE8    OBSERV
     C                     Z-ADD1         SEQOBS
     C                     MOVE 'F'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C** OBSERVATION ANNULE ET REMPLACE
    C*********************************
D1  C           ANNREM    IFEQ 'OUI'
     C                     MOVELTAUG,2    OBSERV
     C                     MOVE NCDEAR    OBSERV
     C                     Z-ADD8         SEQOBS
     C                     MOVE 'A'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C** OBSERVATIONS COMMANDE
    C************************
D1  C           LIBCD1    IFNE *BLANKS
     C                     MOVE LIBCD1    OBSERV
     C                     Z-ADD1         SEQOBS
     C                     MOVE 'I'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LIBCD2    IFNE *BLANKS
     C                     MOVE LIBCD2    OBSERV
     C                     Z-ADD2         SEQOBS
     C                     MOVE 'I'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LIBCD3    IFNE *BLANKS
     C                     MOVE LIBCD3    OBSERV
     C                     Z-ADD3         SEQOBS
     C                     MOVE 'I'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
D1  C           LIBCD4    IFNE *BLANKS
     C                     MOVE LIBCD4    OBSERV
     C                     Z-ADD4         SEQOBS
     C                     MOVE 'I'       TYPOBS
     C                     WRITECDEOBSF1
F1  C                     END
    C*****************************************************
    C**                   C D E X P O
    C*****************************************************
D1  C           *IN82     IFEQ '1'
     C                     MOVELCODINC    CONDEX
     C                     MOVE NBEFAC    NBFAC
     C                     WRITECDEXPOF1
     C                     SETOF                     82
F1  C                     END
    C*****************************************************
    C**          C D E M A T
    C*****************************************************
    C** EXTERIEURE
    C*************
D1  C           COMATA    IFNE *ZEROS
     *---- Début ----- Philippe  ---- 13/10/2014 -----
     * - Mis en commentaire car plus utilisé; utilisation de CALENS à la place
    C**         COMATA    CHAINSIECLE               38
    C**                   Z-ADDSS        COMATS
     C                     Z-ADD20        COMATS
     C           KCALL0    CHAINCALENAL0             38
     C  N38                Z-ADDCALSS     COMATS
D2  C   38      COMATA    IFGE 90
     C                     Z-ADD19        COMATS
F2  C                     ENDIF
     *---- Fin   ----- Philippe  ---- 13/10/2014 -----
F1  C                     END
D1  C           STMEXX    IFEQ 1
    C           STMEXX    OREQ 2
    C           STMEXX    OREQ 4
    C           STMEXX    OREQ 3
    C           FRINCS    ANDNE0
     C                     MOVE STMEXX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMEX    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
     C                     MOVE 'IE'      CODMAT
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMONMAT    MATETR
     C                     Z-ADDMONMAT    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
     C                     WRITECDEMATF1
F1  C                     END
    C** INTERIEUR
    C************
D1  C           STMINX    IFEQ 1
    C           STMINX    OREQ 2
    C           STMINX    OREQ 4
    C           STMINX    OREQ 3
    C           FRINCI    ANDNE0
     C                     MOVE STMINX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMIN    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
     C                     MOVE 'II'      CODMAT
     C                     MOVE MONMAI    MONMAT
     C                     MOVE FRINCI    FRINCS
     C                     MOVE MATSTI    MATSTE
     C                     MOVE MATCIN    MATCLI
     C                     MOVE MATFAI    MATFAC
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMONMAT    MATETR
     C                     Z-ADDMONMAT    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
     C                     WRITECDEMATF1
F1  C                     END
    C** GAUFFRAGE
    C************
D1  C           STMGOX    IFEQ 1
    C           STMGOX    OREQ 2
    C           STMGOX    OREQ 4
    C           STMGOX    OREQ 3
    C           FRINCD    ANDNE0
     C                     MOVE STMGOX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMDO    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
     C                     MOVE 'DO'      CODMAT
     C                     MOVE MONMAD    MONMAT
     C                     MOVE FRINCD    FRINCS
     C                     MOVE MATSTD    MATSTE
     C                     MOVE MATCLD    MATCLI
     C                     MOVE MATFAD    MATFAC
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMONMAT    MATETR
     C                     Z-ADDMONMAT    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
     C                     WRITECDEMATF1
F1  C                     END
    C** DORURE
    C*********
D1  C           STMGAX    IFEQ 1
    C           STMGAX    OREQ 2
    C           STMGAX    OREQ 4
    C           STMGAX    OREQ 3
    C           FRINCG    ANDNE0
     C                     MOVE STMGAX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMGA    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
     C                     MOVE 'GA'      CODMAT
     C                     MOVE MONMAG    MONMAT
     C                     MOVE FRINCG    FRINCS
     C                     MOVE MATSTG    MATSTE
     C                     MOVE MATCLG    MATCLI
     C                     MOVE MATFAG    MATFAC
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMONMAT    MATETR
     C                     Z-ADDMONMAT    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
     C                     WRITECDEMATF1
F1  C                     END
    C** DECOUPAGE
    C************
D1  C           STMDEX    IFEQ 1
    C           STMDEX    OREQ 2
    C           STMDEX    OREQ 4
    C           STMDEX    OREQ 3
    C           FRINDE    ANDNE0
     C                     MOVE STMDEX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMDE    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
     C                     MOVE 'FO'      CODMAT
     C                     MOVE MONMDE    MONMAT
     C                     MOVE FRINDE    FRINCS
     C                     MOVE MATSDE    MATSTE
     C                     MOVE MATCLE    MATCLI
     C                     MOVE MATFAE    MATFAC
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMONMAT    MATETR
     C                     Z-ADDMONMAT    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
     C                     WRITECDEMATF1
F1  C                     END
    C*****************************************************
    C**         C A R C D E
    C*****************************************************
D1  C           QTFAB     IFNE *ZEROS
     C           QTOT      DIV  QTFAB     NBRFAB  20
X1  C                     ELSE
     C                     Z-ADD1         NBRFAB
F1  C                     END
     C                     Z-ADD0         II      20
    C*
D1  C                     DO   *HIVAL    R5
     C           R5        CHAINF34                  38
     C                     Z-ADD0         MMDEL
     C                     Z-ADD0         JJDEL
     C                     Z-ADD0         NOJOUR
     C                     MOVE '0'       IJSDEL  1
D2  C           JSDEL     IFEQ 0
     C                     MOVE '1'       IJSDEL  1
     C                     Z-ADD5         JSDEL
F2  C                     END
D2  C           SEDEL     IFNE *ZEROS
     C           CLECAL    CHAINCALENAL2             39
     C        N39          MOVE CALMM     MMDEL
     C        N39          MOVE CALJJ     JJDEL
     C        N39          MOVE CALNOJ    NOJOUR
     C        N39          MOVE CALSS     SSDEL
F2  C                     END
D2  C           IJSDEL    IFEQ '1'
     C                     Z-ADD0         JSDEL
     C                     MOVE '0'       IJSDEL
F2  C                     END
    C*
D2  C           REFUNI    IFEQ 'N'
     C           R5        CHAINF38                  38
     C  N38                MOVE REFCDE    CLIREF
D3  C  N38      DSCDE     IFNE 0
     C                     MOVE JCDE      COMCLJ
     C                     MOVE MCDE      COMCLM
     C                     MOVE ACDE      COMCLA
     C                     MOVE SCDE      COMCLS
F3  C                     END
F2  C                     END
    C   38                GOTO MOUET
     C                     Z-ADDQTEXP     QTDEXP
     C                     Z-ADDNBOBI     NBRBOB
     C         84          MOVE USINEP    USINE
     C         84          MOVE USINEP    USEXT
     C                     MOVELGARNT     VC      1
D2  C           VC        IFEQ 'M'
     C                     MOVE *BLANKS   GARNT
F2  C                     END
D2  C           *IN21     IFEQ '1'
    C           *IN63     OREQ '1'
     C                     Z-ADD*ZEROS    PUNITX
     C                     Z-ADD*ZEROS    PX
F2  C                     END
     C                     MOVE INDPCL    CLIPRO
     C                     Z-ADD*ZEROS    SSDDEL
     C                     Z-ADD*ZEROS    ADEDEL
     C                     Z-ADD*ZEROS    SDEDEL
     C                     Z-ADD*ZEROS    JDEDEL
D2  C           CODEL     IFNE 'PR'
     C                     Z-ADDSSDEL     SSDDEL
     C                     Z-ADDANDEL     ADEDEL
     C                     Z-ADDSEDEL     SDEDEL
     C                     Z-ADDJSDEL     JDEDEL
F2  C                     END
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL3             23
     C         84          MOVE USINEP    USINE
     C         84          MOVE USINEP    USEXT
    C*
D2  C           EXT       IFEQ 0
    C           REP1      ANDNE0
     C                     Z-ADDUSINE     USEXT
F2  C                     END
D2  C           INT       IFEQ 0
    C           REP       ANDNE0
     C                     Z-ADDUSINE     USINT
F2  C                     END
D2  C           EXT       IFEQ 4
    C           COUPEX    ANDEQ'O'
     C                     Z-ADD*ZERO     USEXT
F2  C                     END
D2  C           INT       IFEQ 4
    C           COUPIN    ANDEQ'O'
     C                     Z-ADD*ZERO     USINT
F2  C                     END
D2  C           EXT       IFEQ 3
    C           EXT       OREQ 5
     C                     Z-ADD*ZERO     USEXT
F2  C                     END
D2  C           INT       IFEQ 3
    C           INT       OREQ 5
     C                     Z-ADD*ZERO     USINT
F2  C                     END
    C*
D2  C           CODMON    IFNE 'EUR'
    C           USAISI    ANDNE'*'
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDPUNITX    PRIETR
     C                     Z-ADDPUNITX    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     PUNITX
     C                     EXSR SPCOUR
X2  C                     ELSE
     C                     Z-ADD1         COURS
F2  C                     END
    C*
     C                     Z-ADDPUNITX    PUNIT
    C*
     C           NBLIV     DIV  NBRFAB    XX2     20
D2  C           XX2       IFLT 10
D3  C           NBRFAB    IFLT 10
D4  C           SEQFAB    IFNE 1
D5  C           QTFAC     IFEQ *ZEROS
     C                     ADD  1         II
X5  C                     ELSE
     C                     ADD  10        II
     C                     MOVE '0'       II
F5  C                     END
X4  C                     ELSE
     C                     Z-ADDSEQFAB    II
F4  C                     END
     C                     Z-ADDII        SEQFAB
F3  C                     END
F2  C                     END
    C*
     C                     Z-ADD0         SEQIMP
D2  C           RGLIV     IFEQ 99
     C                     Z-ADD*ZEROS    DEPLIV
F2  C                     END
     C                     WRITECARCDEF1
F1  C                     END
     C           MOUET     TAG
     * MISE A JOUR DES POURCENTAGES DE FRAIS INCLUS :
     *
D1  C           GARNT     IFNE 'RE'
     *
D2  C           INCLU     IFEQ 0
    C           WINCLU    ANDNE0
     C           TAGERR    TAG
     C                     Z-ADDSTE       £STE2
     C                     Z-ADDNOCLI     £NOCL2
     C                     Z-ADDNOPRO     £NOPR2
     C                     Z-ADDWINCLU    £WINC2
     C                     MOVEL'0'       £ERR
     C                     CALL 'PROINC£'
     C                     PARM           £PARAM
D3  C           £ERR      IFEQ '1'
     C                     EXFMTFERR
    C                     GOTO TAGERR
F3  C                     END
F2  C                     END
F1  C                     END
    C* Séparation des expéditions de la fabrication si paramétré
    C* dans CLILOG
     C           CLECLI    SETLLCLILOGL7                 80
D1  C           *IN80     IFEQ '1'
     C                     Z-ADDNCONF     PCONF   50
     C                     CALL 'CDEC01£1'
     C                     PARM           PCONF
F1  C                     END
    C**         *****     ***
    C                     ENDSR
     *
     * RECHERCHE GROUPE
     * ----------------
    C           FENGP     BEGSR
     C                     MOVE '1'       *IN93
     C                     WRITEWGPC
     C                     MOVEA'00'      *IN,93
     C                     MOVE *BLANK    CHXGP
     C                     Z-ADD0         RECNO   30
     C           ARGU      CHAINPARAME               99
D1  C           *IN99     DOWEQ'0'
     C                     MOVE '1'       *IN94
     C                     ADD  1         RECNO
     C                     MOVE PXVALE    GROUPE
     C                     WRITEWGPS
     C           PXARGU    READEPARAME                   99
F1  C                     END
     C                     EXFMTWGPC
     C           SELGP     TAG
     *          -----     ---
     C   94                READCWGPS                     99
    C  N99      CHXGP     CABEQ*BLANK    SELGP
D1  C           *IN99     IFEQ '1'
     C                     MOVE *BLANK    GROUPE
F1  C                     END
    C                     ENDSR
     *
     * CALCUL COURS
     * ----------------
    C           SPCOUR    BEGSR
     C                     Z-ADDCRS       COURS
D1  C           COEFF     IFEQ '1'
     C                     DIV  10        COURS
F1  C                     END
D1  C           COEFF     IFEQ '2'
     C                     DIV  100       COURS
F1  C                     END
D1  C           COEFF     IFEQ '3'
     C                     DIV  1000      COURS
F1  C                     END
D1  C           COEFF     IFEQ 'D'
     C                     MULT 10        COURS
F1  C                     END
D1  C           COEFF     IFEQ 'C'
     C                     MULT 100       COURS
F1  C                     END
D1  C           COEFF     IFEQ 'M'
     C                     MULT 1000      COURS
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : QUANTITE IMPERATIVE PAR PALETTE          *
     *--------------------------------------------------------*
    C           TRTQIP    BEGSR
     *          ---------------
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D2  C           UVENT     IFEQ 3
     C                     MULT DECH      NBDECP
     C                     MULT DECH      NBRUNI
F2  C                     END
F1  C                     END
     C                     MOVE ' '       OKQTIP
D1  C           NBDECP    IFNE *ZEROS
     C           QTIP      DIV  NBDECP    NBRPAL  30
     C                     MVR            RESTEZ
X1  C                     ELSE
     C                     Z-ADD1         NBRPAL  30
     C                     Z-ADD0         RESTEZ
F1  C                     END
     C                     Z-ADDNBRPAL    NPMINI  30
     C                     Z-ADDNBRPAL    NPMINP  30
    C*
D1  C           RESTEZ    IFNE *ZEROS
    C           OKQTIP    ANDEQ*BLANKS
     C           QTIP      COMP NBDECP               19
     C           NPMINI    MULT NBDECP    QTMINI
     C           QTMINI    ADD  IMPPP     QTMINP
     C           NPMINI    ADD  1         NPMAXI
     C           NPMAXI    MULT NBDECP    QTMAXI
     C           DQIPW     TAG
     C                     MOVE *BLANK    C1F21
     C                     MOVE *BLANK    C2F21
     C                     MOVE *BLANK    C3F21
     C                     EXFMTF35W
    C*
D2  C           *IN23     IFEQ '1'
     C                     MOVE '1'       OKQTIP  1
    C                     GOTO FQIP
F2  C                     END
    C*
D2  C           *IN19     IFEQ '1'
D3  C           C1F21     IFNE *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     ORNE *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDEQ*BLANKS
    C           C1F21     ORNE *BLANKS
    C           C2F21     ANDEQ*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C2F21     ANDEQ*BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DQIPW
F3  C                     END
D3  C           C1F21     IFNE *BLANKS
     C                     Z-ADDQTMINI    QTIP
F3  C                     END
D3  C           C2F21     IFNE *BLANKS
     C                     Z-ADDQTMINP    QTIP
F3  C                     END
D3  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTIP
F3  C                     END
X2  C                     ELSE
D3  C           C2F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C2F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DQIPW
F3  C                     END
D3  C           C2F21     IFNE *BLANKS
     C                     Z-ADDIMPPP     QTIP
F3  C                     END
D3  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTIP
F3  C                     END
F2  C                     END
    C*
F1  C                     END
    C*
    C           FQIP      ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : SI PLANING MATERIEL                      *
     *--------------------------------------------------------*
    C           SPPLAM    BEGSR
     *          ---------------
    C** IMPRESSION EXTERIEURE
    C************************
D1  C           ETAT01    IFEQ 'R'
     C                     MOVE *BLANKS   STMEXT
     C                     MOVEL'REFECTIO'STMEXT
     C                     MOVE 'N'       STMEXT
F1  C                     END
D1  C           ETAT01    IFEQ 'M'
     C                     MOVE *BLANKS   STMEXT
     C                     MOVEL'MODIFICA'STMEXT
     C                     MOVE 'T'       STMEXT
F1  C                     END
D1  C           ETAT01    IFEQ 'C'
     C                     MOVE *BLANKS   STMEXT
     C                     MOVEL'A CREER 'STMEXT
F1  C                     END
D1  C           ETAT01    IFEQ 'E'
     C                     MOVE *BLANKS   STMEXT
     C                     MOVEL'EXISTANT'STMEXT
F1  C                     END
    C** DORURE
    C*********
D1  C           ETAOR     IFEQ 'R'
     C                     MOVE *BLANKS   STMDOR
     C                     MOVEL'REFECTIO'STMDOR
     C                     MOVE 'N'       STMDOR
F1  C                     END
D1  C           ETAOR     IFEQ 'M'
     C                     MOVE *BLANKS   STMDOR
     C                     MOVEL'MODIFICA'STMDOR
     C                     MOVE 'T'       STMDOR
F1  C                     END
D1  C           ETAOR     IFEQ 'C'
     C                     MOVE *BLANKS   STMDOR
     C                     MOVEL'A CREER 'STMDOR
F1  C                     END
D1  C           ETAOR     IFEQ 'E'
     C                     MOVE *BLANKS   STMDOR
     C                     MOVEL'EXISTANT'STMDOR
F1  C                     END
    C** GAUFRAGE
    C***********
D1  C           ETAGAU    IFEQ 'R'
     C                     MOVE *BLANKS   SRMGAU
     C                     MOVEL'REFECTIO'SRMGAU
     C                     MOVE 'N'       SRMGAU
F1  C                     END
D1  C           ETAGAU    IFEQ 'M'
     C                     MOVE *BLANKS   SRMGAU
     C                     MOVEL'MODIFICA'SRMGAU
     C                     MOVE 'T'       SRMGAU
F1  C                     END
D1  C           ETAGAU    IFEQ 'C'
     C                     MOVE *BLANKS   SRMGAU
     C                     MOVEL'A CREER 'SRMGAU
F1  C                     END
D1  C           ETAGAU    IFEQ 'E'
     C                     MOVE *BLANKS   SRMGAU
     C                     MOVEL'EXISTANT'SRMGAU
F1  C                     END
    C** DECOUPAGE
    C************
D1  C           ETAFOR    IFEQ 'R'
     C                     MOVE *BLANKS   STMDEC
     C                     MOVEL'REFECTIO'STMDEC
     C                     MOVE 'N'       STMDEC
F1  C                     END
D1  C           ETAFOR    IFEQ 'M'
     C                     MOVE *BLANKS   STMDEC
     C                     MOVEL'MODIFICA'STMDEC
     C                     MOVE 'T'       STMDEC
F1  C                     END
D1  C           ETAFOR    IFEQ 'C'
     C                     MOVE *BLANKS   STMDEC
     C                     MOVEL'A CREER 'STMDEC
F1  C                     END
D1  C           ETAFOR    IFEQ 'E'
     C                     MOVE *BLANKS   STMDEC
     C                     MOVEL'EXISTANT'STMDEC
F1  C                     END
    C** INCIDENCES MATERIELS
    C***********************
     C                     MOVE *BLANKS   INCMEX
     C                     MOVE *BLANKS   INCMIN
     C                     MOVE *BLANKS   INCMDE
D1  C           INCF01    IFEQ 'N'
     C                     MOVE 'NON'     INCMEX
F1  C                     END
D1  C           INCF03    IFEQ 'N'
     C                     MOVE 'NON'     INCMIN
F1  C                     END
D1  C           INCIMP    IFEQ 'N'
     C                     MOVE 'NON'     INCMDE
F1  C                     END
    C** IMPRESSION EXTERIEURE
    C************************
D1  C           INCF01    IFEQ 'O'
     C                     MOVE 'OUI'     INCMEX
F1  C                     END
    C** IMPRESSION INTERIEURE
    C************************
D1  C           INCF03    IFEQ 'O'
     C                     MOVE 'OUI'     INCMIN
F1  C                     END
    C** DECOUPAGE
    C************
D1  C           INCIMP    IFEQ 'O'
     C                     MOVE 'OUI'     INCMDE
F1  C                     END
    C** IMPRESSION INTERIEURE
    C************************
D1  C           ETAT03    IFEQ 'R'
     C                     MOVE *BLANKS   STMINT
     C                     MOVEL'REFECTIO'STMINT
     C                     MOVE 'N'       STMINT
F1  C                     END
D1  C           ETAT03    IFEQ 'M'
     C                     MOVE *BLANKS   STMINT
     C                     MOVEL'MODIFICA'STMINT
     C                     MOVE 'T'       STMINT
F1  C                     END
D1  C           ETAT03    IFEQ 'C'
     C                     MOVE *BLANKS   STMINT
     C                     MOVEL'A CREER 'STMINT
F1  C                     END
D1  C           ETAT03    IFEQ 'E'
     C                     MOVE *BLANKS   STMINT
     C                     MOVEL'EXISTANT'STMINT
F1  C                     END
    C                     ENDSR
** TABEX **
LE
ET
LES
LA
DE
DES
DU
AU
AUX
OU
STE
ETS
CIE
SOCIETE
&
D
L
S.A.
SA
SARL
S.A.R.L.
CIE
**
ATTENTION IMPRESSION RECTO VERSO
==>  PRIX EN EUROS  <==

==> PRIX EN DEVISES <==

  (F6= prix en euros)
 (F6= prix en devises)
d'impression :
de façonnage :
d'expédition :
**
"STOCKE" EN KG
**
IMPRESSION
FABRICATION
LIVRAISON
**
DU FICHIER CLIENTS
**

BB
CC
DD
EE
FF
GG
HH
II
JJ
KK
LL
MM
NN
OO
PP
QQ
RR
SS
TT
UU
VV
WW
XX
YY
ZZ
**
VEUILLEZ CONTACTER LE CLIENT POUR APPLICATION DE LA HAUSSE
ANNULE ET REMPLACE LA COMMANDE N°
ATTENTION: COMPOSANT D'AMALGAME
L'ENSEMBLE DES ELEMENTS DU PRODUIT EST VENDU COMME UN TOUT
CHACUN DES ELEMENTS DU PRODUIT EST VENDU SEPAREMENT
AMALGAME DE DECORS
