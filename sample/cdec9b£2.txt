     H             /J
     ***************************************************************
     *                                                             *
     *          PGM: CDEC9B£  REALISE PAR REMI COURTAINE           *
     *                                                             *
     *            BON DE COMMANDE IMPRESSION TOURY                 *
     *            --------------------------------                 *
     ***************************************************************
     *            INDICATEURS UTILISES DANS LE PROGAMME            *
     * -> U1  INDIQUE LA NOTION DE BON DE COMMANDE OU FABRICATION  *
     * -> U2  INDIQUE LA NOTION DE PASSAGE DE NUIT OU REEL         *
     * -> U8  INDIQUE LA NOTION D'EDITION FORCEE DU BON            *
     * -> 30  INDIQUE LA NOTION DE BOBINE OU FORMAT DE V029        *
     * -> 31  INDIQUE LA NOTION DE BOBINE OU FORMAT DE V031        *
     * -> V086 = INDICE IS                                         *
     *                                                             *
     *  TOUTES LES ZONES D'EDITION SONT NOMMEES VXXX EN MARGE      *
     *                                                             *
     ***************************************************************
     *  Modif : 04/05/2015  Par : Philippe Le Cardinal                *
     *  But   : Suppression du fichier "Siecle" & recherche du siècle *
     *   via le fichier CALENAL0 (AA/MM/JJ)                           *
     *----------------------------------------------------------------*
     *  Modif : xx/xx/xxxx  Par : Xxxxxxxxxxxxxxxxxxxxxxxxx           *
     *  But   : Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx *
     *------------------------------------------------------------------*
     FPRLANCL1IF  E           K        DISK
     FPRLANCL8IF  E           K        DISK
     FCARCDEL1IF  E           K        DISK
     FCARCDEL2IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDE2
     FCARCDEZ8IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEU
     FCLIENTS1IF  E           K        DISK
     FPRODUI2 UF  E           K        DISK                      A
     FPRODST2 IF  E           K        DISK
     FPRODUL10IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUIF
     FPREIMPL IF  E           K        DISK
     FCALENJL7IF  E           K        DISK
     FCALENS  IF  E           K        DISK
     *--- Début --- Philippe  --- 04/05/2015 --*
    F**SIECLE  IF  E           K        DISK
     *--- Fin   --- Philippe  --- 04/05/2015 --*
     FPARAME  IF  E           K        DISK
     FQUAUSI  IF  E           K        DISK
     FHISTOF15IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FBESOMAL1IF  E           K        DISK
     FPLAMAL1 IF  E           K        DISK
     FRESPAPL5IF  E           K        DISK
     FRESIMPL2IF  E           K        DISK
     FRESCXHL3IF  E           K        DISK
     FCDESL1  IF  E           K        DISK
     FPLAIMPL5IF  E           K        DISK
     FPLANIFL3IF  E           K        DISK
     FOBSPROL1UF  E           K        DISK
     FFORINTL3IF  E           K        DISK
     FBONIMT  O   F    3484            DISK
     FCAROFL3 UF  E           K        DISK                      A
    F*SORTI  O   F     173            DISK
     FXTBASE01IF  E           K        DISK
     *
     FLIEUSTL3IF  E           K        DISK                               PROD17
     *
     FSTACOML8IF  E           K        DISK
     *
     *****************************************************************
     *     TABLES INTERNES
     *****************************************************************
     E                    TI      1  11  2 0 LIM    13
     E                    CON     1  17 40
     E                    ETA     1   5  1   LET    12
     E                    TIM         7  1 0 TRE     1 0
     E                    COP         7  1   NAT     1
     E                    FOH         7  4 0 FOL     4 0
     E                    VAR        20 40   VDT     6
     E                    VEM        20  6
     E                    CDE        10  7 0
     E                    SUP        12 76
     E                    TAL         7  3 2 STD     4 1
     E                    RED         5  5 0
     E                    UFA         9  1 0
     E                    CVE         7  2 1
     E                    TSX         9  7 0A
     E                    TB          9  2 0
     E                    QFS         9  8 0A
     E                    QFP         9 10
     E                    QF          9  3 0
     E                    ADPA        7  6
     E                    CXT       100  2               CODES EXTER.
     E                    SEF         6 24
     *****************************************************************
     *  ZONES DE QUAUSI  RENOMMEES  COMMENCENT PAR Y
     IQUAUSIF1
     I              SUIVI                           SUISUI
     *
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     *
     *  ZONES DE PRODUI2 RENOMMEES  COMMENCENT PAR Y
     IPRODUIF1
     I              ADPAP1                          ADPA,1
     I              ADPAP2                          ADPA,2
     I              ADPAP3                          ADPA,3
     I              ADPAP4                          ADPA,4
     I              ADPAP5                          ADPA,5
     I              ADPAP6                          ADPA,6
     I              ADPAP7                          ADPA,7
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              NOFOR                           YOFOR
     I              ONDH                            YNDH
     I              ONDL                            YNDL
     I              POSF1                           YOSF1
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              NATE2                           NAT,2
     I              NATE3                           NAT,3
     I              NATE4                           NAT,4
     I              NATE5                           NAT,5
     I              NATE6                           NAT,6
     I              NATE7                           NAT,7
     I              CVER1                           CVE,1
     I              CVER2                           CVE,2
     I              CVER3                           CVE,3
     I              CVER4                           CVE,4
     I              CVER5                           CVE,5
     I              CVER6                           CVE,6
     I              CVER7                           CVE,7
     IPRODUIF
     I              ADPAP2                          ADPA,2
     I              ADPAP3                          ADPA,3
     I              ADPAP4                          ADPA,4
     I              ADPAP5                          ADPA,5
     I              ADPAP6                          ADPA,6
     I              CCOL                            YCOL
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              NOFOR                           YOFOR
     I              ONDH                            YNDH
     I              ONDL                            YNDL
     I              POSF1                           YOSF1
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP1                           COP,1
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              NATE1                           NAT,1
     I              NATE2                           NAT,2
     I              NATE3                           NAT,3
     I              NATE4                           NAT,4
     I              NATE5                           NAT,5
     I              NATE6                           NAT,6
     I              NATE7                           NAT,7
     I              CVER1                           CVE,1
     I              CVER2                           CVE,2
     I              CVER3                           CVE,3
     I              CVER4                           CVE,4
     I              CVER5                           CVE,5
     I              CVER6                           CVE,6
     I              CVER7                           CVE,7
     *  ZONES DE CDES   RENOMMEES  COMMENCENT PAR W
     ICDESF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              CDEPRE                          WW4
     I              AGENT                           WW1
     I              USINE                           WW2
     I              QTOT                            WTOT
     I              MICLI                           WICLI
     I              MACLI                           WACLI
     I              PROTO                           WPROTO
     *  ZONES DE PRLANC RENOMMEES  COMMENCENT PAR W
     IPRLANCF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WWPR
     I              SUIMP                           WUIMP
     I              USDEST                          WSDEST
     *  ZONES DE CARCDE RENOMMEES  COMMENCENT PAR W
     ICARCDEF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              USEXT                           WSEXT
     I              USINT                           WSINT
     I              USINE                           WSINE
     I              AGENT                           WGENT
     I              CDEPRE                          WDEPR2
     I              GARNT                           WARNT
     I              ANDEL                           WNDEL
     I              MMDEL                           WMDEL
     I              RGFAC                           WGFAC
     I              RGLIV                           WGLIV
     I              EDIMPM                          WDIMPM
     I              EDIMPJ                          WDIMPJ
     I              EDEXPM                          WDEXPM
     I              EDEXPJ                          WDEXPJ
     I              QTIMP                           WTIMP
     I              QTFAC                           WTFAC
     ICARCDE2
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     ICARCDEU
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     *  ZONES DE HISTOFA2 RENOMMEES  COMMENCENT PAR X
     IHISTOFA
     I              NCONF                           XCONF
     I              NOSEQ                           XOSEQ
     *  ZONES DE RESPAP RENOMMEES  COMMENCENT PAR H
     IRESPAPF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     I              SUPOR                           HUPOR
     I              PRIORI                          HRIORI
     *  ZONES DE RESCXH RENOMMEES  COMMENCENT PAR H
     IRESCXHF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     I              SUPOR                           HUPOR
     *  ZONES DE OBSPRO RENOMMEES
     IOBSPROF1
     I              AA                              ACRE
     I              MM                              MCRE
     I              JJ                              JCRE
     *  ZONES DE MVTIMP   RENOMMEES  COMMENCENT PAR I
     IMVTIMPF1
     I              NCONF                           ICONF
     I              NOSEQ                           IOSEQ
     I              PAPI                            IAPI
     I              GRAMM                           IRAMM
     I              REFOUR                          IEFOUR
     I              GRAREL                          IRAREL
     *  ZONES DE BESOMAT  RENOMMEES  COMMENCENT PAR B
     IBESOMATF
     I              LMINI                           BMINI
     I              UVENT                           BVENT
     I              QTFAB                           BTFAB
     I              QTTOT                           BTTOT
     I              QTPRE                           BTPRE
     I              QTREN                           BTREN
     I              TALO1                           TAL,1
     I              TALO2                           TAL,2
     I              TALO3                           TAL,3
     I              TALO4                           TAL,4
     I              TALO5                           TAL,5
     I              TALO6                           TAL,6
     I              TALO7                           TAL,7
     I              STD1                            STD,1
     I              STD2                            STD,2
     I              STD3                            STD,3
     I              STD4                            STD,4
     I              STD5                            STD,5
     I              STD6                            STD,6
     I              STD7                            STD,7
     I              SUREG                           BUREG
     *  ZONES DE PLAIMPL5 RENOMMEES
     IPLAIMPF1
     I              I                               PAS
     *  ZONES DE PLANIFL1 RENOMMEES
     IPLANIFF1
     I              I                               PAS
     I              SUREG                           WUREG
     I              USFAB                           WUSFAB
     *  ZONES DE PLAMA    RENOMMEES
     IPLAMAF1
     I              USFAC                           XUSFAC
     ISTACOMF1
     I              AGENT                           WW1
     I              NCONF                           WWC
     I              NOPRO                           WWP
     I              GARNT                           WWG
     I              STE                             WWE
     I              NOCLI                           WWNO
     I              QTOT                            WWQ
     I              USINE                           WWU
     I              GROUPE                          WWGR
     *
     ICAROFF1
     I              SECT                            CECT
     I              SSECT                           CSECT
     I              NOMAC                           COMAC
     I              TIMP                            CIMP
     I              PCLI                            CCLI
     I              SOBESO                          COBESO
     I              FEFAB                           FEFABW
     I              KGFAB                           KGFABW
     I              FORCXH                          FORCX
     I              STECXH                          STECX
     I              CLICXH                          CLICX
     I              PROCXH                          PROCX
     *
     ***************************************************************
     I/COPY QRPGSRC,XVERDS
     *****************************************************************
     *     RUPTURES   ET  DS
     *****************************************************************
     * Zone de Communications de Données DATCDE
     * ----------------------------------------
     *
     I            DS
     I                                        1   20AA
     I                                        3   40MM
     I                                        5   60JJ
     I                                        1   60DATEJ
     *
     I            DS
     I                                        1   20TITIMP
     I                                        1   10TITREP
     I                                        2   20TITPRI
     *
     I            DS
     I                                        1  12 V003
     I                                        1   2 V0031
     I                                        3   5 V003X
     I                                       11  12 V0032
     *
     IBT3         DS
     I                                        1   1 BLANC
     I                                        2   20YACON
     I                                        3   40COAS1
     *
     I            DS
     I                                        1   40DALAN
     I                                        1   20LANIMP
     I                                        3   40LANFAC
     *
     I            DS
     I                                        1  10 V002
     I                                        1   20DAY
     I                                        5   60MONTH
     I                                        9  100YEAR1
     *
     I            DS
     I                                        1   60X014
     I                                        1   20DAYX
     I                                        3   40MONTHX
     I                                        5   60YEAR1X
     *
     I            DS
     I                                        1   60DINTER
     I                                        1   20JINTER
     I                                        3   40MINTER
     I                                        5   60AINTER
     *
     I            DS
     I                                        1   60DATFAB
     I                                        1   20AFAB
     I                                        3   40MFAB
     I                                        5   60JFAB
     *
     I            DS
     I                                        1   60DTMAJ
     I                                        1   20JMAJ
     I                                        3   40MMAJ
     I                                        5   60AMAJ
     *
     I            DS
     I                                        1   60DTPAN
     I                                        1   20PANAA
     I                                        3   40PANMM
     I                                        5   60PANJJ
     *
     I            DS
     I                                        1   60DTPRDE
     I                                        1   20AAPRDE
     I                                        3   40MMPRDE
     I                                        5   60JJPRDE
     *
     I            DS
     I                                        1   60DTCRE
     I                                        1   20JCRE
     I                                        3   40MCRE
     I                                        5   60ACRE
     *
     I            DS
     I                                        1   6 DSFH1
     I                                        1   30LITRAM
     I                                        4   4 DSFHX
     I                                        5   60DEPENC
     *
     I            DS
     I                                        1   60V008
     I                                        1   20V0081
     I                                        3   40V0082
     I                                        5   60V0083
     *
     I            DS
     I                                        1 100 PARAM2
     I                                        1   10PUS
     I                                        2   60WCONF
     I                                        7   80WEQFAB
     I                                        9   9 PECPAP
     I                                       10  130WOPRO
     I                                       14  17 RESS
     *
     I            DS
     I                                        1   60V009
     I                                        1   20V0091
     I                                        3   40V0092
     I                                        5   60V0093
     *
     I            DS
     I                                        1  40 V014
     I                                       25  40 V0141
     I                                       28  280V0142
     *
     I            DS
     I                                        1  11 V019
     I                                        1   40V0191
     I                                        6   6 V0192
     I                                        8  110V0193
     *
     I            DS
     I                                        1 240 VCTL1
     I                                      241 320 VCTL2
     I                                        1  40 V032
     I                                       41  80 V033
     I                                       81 120 V034
     I                                      121 160 V035
     I                                      161 200 V036
     I                                      201 240 V037
     I                                      241 280 V038
     I                                      281 320 V039
     *
     I            DS
     I                                        1  48 VDTL
     I                                        1   60V040
     I                                        7  120V041
     I                                       13  180V042
     I                                       19  240V043
     I                                       25  300V044
     I                                       31  360V045
     I                                       37  420V046
     I                                       43  480V047
     *
     I            DS
     I                                        1 240 VCON
     I                                        1  40 V1141
     I                                       41  80 V1151
     I                                       81 120 V1161
     I                                      121 160 V1171
     I                                      161 200 V1181
     I                                      201 240 V1191
     *
     I            DS
     I                                        1  36 VDON
     I                                        1   60V1142
     I                                        7  120V1152
     I                                       13  180V1162
     I                                       19  240V1172
     I                                       25  300V1182
     I                                       31  360V1192
     *
     I            DS
     I                                        1 240 VIMPL1
     I                                      241 320 VIMPL2
     I                                        1  40 V060
     I                                       41  80 V061
     I                                       81 120 V062
     I                                      121 160 V063
     I                                      161 200 V064
     I                                      201 240 V065
     I                                      241 280 V066
     I                                      281 320 V067
     *
     I            DS
     I                                        1  72 VIMPD
     I                                        1   60V076
     I                                        7  120V077
     I                                       13  180V078
     I                                       19  240V079
     I                                       25  300V080
     I                                       31  360V081
     I                                       37  420V082
     I                                       43  480V083
     *
     I            DS
     I                                        1  72 VIMPE
     I                                        1   6 V068
     I                                        7  12 V069
     I                                       13  18 V070
     I                                       19  24 V071
     I                                       25  30 V072
     I                                       31  36 V073
     I                                       37  42 V074
     I                                       43  48 V075
     *
     I            DS
     I                                        1  24 VARNT
     I                                        1   9 YARNT2
     I                                       12  13 YARNT
     I                                       12  12 YARNT1
     I                                       13  13 YARNT3
     I                                       15  15 EGAL
     I                                       16  20 OFCONF
     I                                       21  22 OFSEQ
     I                                       23  23 OFSUP
     I                                       24  24 OFLETR
     *
     I            DS
     I                                        1   70PRECDE
     I                                        1   50ICONF
     I                                        6   70IOSEQ
     *
     IDSPARA      DS
     I                                        1   50WCONF1
     I                                        6   90WOPRO1
     I                                       10  160SURF
     I                                       17  203SF
     I                                       21  270MIN
     I                                       28  340MAX
     I                                       35  35 DS1
     I                                       36  420SURFF
     I                                       43  43 PROT
     I                                       44  470WOCLI1
     *
     I            DS
     I                                        1  56 W114
     I                                       24  25 W1142
     I                                       25  250W1141
     *
     I            DS
     I                                        1   50DTDEL
     I                                        1   20WNDEL
     I                                        3   40SEDEL
     I                                        5   50JSDEL
     *
     I            DS
     I                                        1   50DTPRFI
     I                                        1   20AAPRFI
     I                                        3   40SEPRFI
     I                                        5   50JSPRFI
     *
     I            DS
     I                                        1  31 V125
     I                                        1   20V1251
     I                                        7  150V1252
     I                                       21  250V1253
     I                                       30  31 V1254
     *
     I            DS
     I                                        1  31 V126
     I                                        1   20V1261
     I                                        7  150V1262
     I                                       21  250V1263
     I                                       30  31 V1264
     *
     I            DS
     I                                        1  31 V127
     I                                        1   20V1271
     I                                        7  150V1272
     I                                       21  250V1273
     I                                       30  31 V1274
     *
     I            DS
     I                                        1  31 V128
     I                                        1   20V1281
     I                                        7  150V1282
     I                                       21  250V1283
     I                                       30  31 V1284
     *
     I            DS
     I                                        1   60DDEF
     I                                        1   20ADEF
     I                                        3   40MDEF
     I                                        5   60JDEF
     *
     I            DS
     I                                        1   60DDEF01
     I                                        1   20ADEF01
     I                                        3   40MDEF01
     I                                        5   60JDEF01
     *
     I            DS
     I                                        1   60DDEF02
     I                                        1   20ADEF02
     I                                        3   40MDEF02
     I                                        5   60JDEF02
     *
     I            DS
     I                                        1   60DDEF03
     I                                        1   20ADEF03
     I                                        3   40MDEF03
     I                                        5   60JDEF03
     *
     I            DS
     I                                        1   60DDEF04
     I                                        1   20ADEF04
     I                                        3   40MDEF04
     I                                        5   60JDEF04
     I            DS
     I                                        1  27 DSFA1
     I                                        1   30FAOND
     I                                        1   10UFA1
     I                                        4   60FACOL
     I                                        4   40UFA2
     I                                        7   90FATYE
     I                                        7   70UFA3
     I                                       10  120FATYI
     I                                       10  100UFA4
     I                                       13  150FADEC
     I                                       13  130UFA5
     I                                       16  180FAAUT
     I                                       16  160UFA6
     I                                       19  210FAFEN
     I                                       19  190UFA7
     I                                       22  240FAAS1
     I                                       22  220UFA8
     I                                       25  270FAAS2
     I                                       25  250UFA9
     *
     I            DS
     I                                        1   2 WSECT
     I                                        1   1 SECT
     I                                        2   2 SSECT
     *
     I            DS
     I                                        1  24 W097
     I                                        1   70W0971
     I                                        8  130W0972
     I                                       14  190W0973
     I                                       20  220W0974
     I                                       23  24 W0975
     *
     I            DS
     I                                        1  24 W098
     I                                        1   70W0981
     I                                        8  130W0982
     I                                       14  190W0983
     I                                       20  220W0984
     I                                       23  24 W0985
     *
     I            DS
     I                                        1  24 W099
     I                                        1   70W0991
     I                                        8  130W0992
     I                                       14  190W0993
     I                                       20  220W0994
     I                                       23  24 W0995
     *
     I            DS
     I                                        1  24 W100
     I                                        1   70W1001
     I                                        8  130W1002
     I                                       14  190W1003
     I                                       20  220W1004
     I                                       23  24 W1005
     *
     I            DS
     I                                        1  24 W101
     I                                        1   70W1011
     I                                        8  130W1012
     I                                       14  190W1013
     I                                       20  220W1014
     I                                       23  24 W1015
     *
     I            DS
     I                                        1  24 W102
     I                                        1   70W1021
     I                                        8  130W1022
     I                                       14  190W1023
     I                                       20  220W1024
     I                                       23  24 W1025
     *
     I            DS
     I                                        1   7 DEMAN
     I                                        1   6 RIREP
     *
     I            DS
     I                                        1  40 ZONZON
     I                                       27  300ZON2
     I                                       33  360ZON3
     *
     I            DS
     I                                        1  40 CQU
     I                                        1  10 LIBCON
     I                                       13  22 LIBQUA
     I                                       25  34 LIBUTC
     *
     *****************************************************************
     *     CLES D'ACCES AUX FICHIERS
     *****************************************************************
     *
     *  CLE D'ACCES FICHIER XTBASE01
     C           KTBA01    KLIST
     C                     KFLD           TBLNOM
     C                     KFLD           TBVARG
     C                     KFLD           TBNSEG
     *
     *
     * cle pour le fichier parametre .
     C           KPARAM    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *
     * cle pour le fichier PRLANC .
     C           CLEPRI    KLIST
     C                     KFLD           PUS
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     *
     * cle pour le fichier PRLANCL8
     C           KPRLA8    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     * cle pour le fichier CARCDE .
     C           KCARCD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     C           KCAR22    KLIST
     C                     KFLD           ICONF
     C                     KFLD           WOPRO
     *
     C           KCARC2    KLIST
     C                     KFLD           ICONF
     C                     KFLD           WOPRO
     C                     KFLD           IOSEQ
     *
     C           KCAR12    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     C           KCARCU    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KCARL6    KLIST
     C                     KFLD           NCONF
     C                     KFLD           NOPRO
     C                     KFLD           SEQFAB
     *
     * cle pour le fichier CARCDEZ8
     C           KSTAL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           SSS
     C                     KFLD           AAA
     C                     KFLD           MMM
     *
     * cle pour le fichier CALENS .
     C           KCALEN    KLIST
     C                     KFLD           YEARS   20
     C                     KFLD           YEAR    20
     C                     KFLD           MONTH
     C                     KFLD           DAY
     *
     C           KCAL01    KLIST
     C                     KFLD           SDEF    20
     C                     KFLD           ADEF
     C                     KFLD           MDEF
     C                     KFLD           JDEF
     *
     C           KCALFI    KLIST
     C                     KFLD           SSPRFI
     C                     KFLD           AAPRFI
     C                     KFLD           MMPRFI
     C                     KFLD           JJPRFI
     *
     * cle pour le fichier CALENJL7 .
     C           KCAL07    KLIST
     C                     KFLD           YEARS
     C                     KFLD           YEAR
     C                     KFLD           CALNOJ
     *
     *  CLE D'ACCES FICHIER CLIENTS
     C           KCLIL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     *
     *  CLE D'ACCES FICHIER HISTOF15
     C           KHIS05    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           NPRO    40
     C                     KFLD           SHIVAL  20
     C                     KFLD           HIVAL   60
     *
     C           KHIS15    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           NPRO
     *
     *  CLE D'ACCES FICHIER CDESL1
     C           KCDES1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER PRODUI2 ET MVTIMP
     C           KPRO10    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KHIVAL    KLIST
     C                     KFLD           CLIVAL
     C                     KFLD           PROVAL
     *
     *  CLE D'ACCES FICHIER OBSPRO
     C           KOBSP1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     *
     C           KOBSP2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     C                     KFLD           EMET
     *
     *  CLE D'ACCES FICHIER PREIMPL
     C           KPREI1    KLIST
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KPREI3    KLIST
     C                     KFLD           WOCLI3  40
     C                     KFLD           WOPRO3  40
     *
     *  CLE D'ACCES FICHIER PLAMA
     C           KPLAM1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     *
     C           KPLAM2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     *
     *  CLE D'ACCES FICHIER RESCXHL3
     C           KCXHL3    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     C                     KFLD           TRIORI
     *
     *  CLE D'ACCES FICHIER RESPAPL5
     C           KRESPA    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     *
     *  CLE D'ACCES FICHIER RESIMPL2
     C           KRESIM    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           WOPRO
     C                     KFLD           SUIMP
     *
     *  CLE D'ACCES FICHIER BESOMAT
     C           KBESL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER QUAUSI
     C           KUSIL1    KLIST
     C                     KFLD           PUS
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     C                     KFLD           HOUB
     *
     *  CLE D'ACCES FICHIER PLAIMPL5
     *
     C           KPLAL5    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           SU
     *
     C           KPLA15    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           SU
     C                     KFLD           R
     *
     *  CLE D'ACCES FICHIER FORINTL3
     *
     C           KINTL3    KLIST
     C                     KFLD           YOFOR
     C                     KFLD           CODINT
     *
     *  CLE D'ACCES FICHIER CAROFL3
     C           KCOFL3    KLIST
     C                     KFLD           PUS
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           WOPRO
     C                     KFLD           TRIORI
     *
     C           *ENTRY    PLIST
     C                     PARM           PARAM 100
     C                     MOVE PARAM     PARAM2
     ***************************************************************
     *   DEBUT DU PROGRAMME                                        *
     ***************************************************************
     C                     Z-ADD0         C       30
     C                     MOVE 'CEXT'    PXARGU
     C           PXARGU    CHAINPARAME               80
D1  C           *IN80     DOWEQ'0'
D2  C           PXMONT    IFEQ 0
     C                     ADD  1         C
     C                     MOVE PXVALE    CXT,C
F2  C                     END
     C           PXARGU    READEPARAME                   80
F1  C  N80                END
     C           *NAMVAR   DEFN           DATCDE  6
D1  C           *INU1     IFEQ '0'
     C                     IN   DATCDE
     C                     MOVE DATCDE    DATEJ
     *--- Début --- Philippe  --- 06/03/2015 --*
     * - Mise ne commentaire car utilisation de CALENAL0 pour recherche de
     * valeur siècle
    C**         AA        CHAINSIECLE               99
    C**                   Z-ADDSS        SSJ     20
     *
     C                     Z-ADD20        SSJ     20
     *--- Fin   --- Philippe  --- 06/03/2015 --*
X1  C                     ELSE
     C                     MOVEL*YEAR     SSJ
     C                     Z-ADDUYEAR     AA
     C                     Z-ADDUMONTH    MM
     C                     Z-ADDUDAY      JJ
F1  C                     END
     C                     MOVE 'P'       PRIREP  1
     C                     MOVE *BLANKS   V130   15
     C                     MOVE *ZEROS    DSFA1
     *
     C                     MOVE 'USFO'    PXARGU
     C           PXARGU    SETLLPARAME
D1  C                     DO   *HIVAL    I
     C           PXARGU    READEPARAME                   50
D2  C           *IN50     IFEQ '0'
     C                     MOVE PXVALE    TSX,I
     C                     Z-ADDPXMONT    TB,I
F2  C                     END
F1  C  N50                END
     *
     C                     MOVE 'QFTY'    PXARGU
     C           PXARGU    SETLLPARAME
D1  C                     DO   *HIVAL    I
     C           PXARGU    READEPARAME                   50
D2  C           *IN50     IFEQ '0'
     C                     MOVE PXVALE    QFS,I
     C                     MOVE PXABRG    QFP,I
     C                     Z-ADDPXMONT    QF,I
F2  C                     END
F1  C  N50                END
     C                     Z-ADD20        SSS     20
     C                     Z-ADD99        AAA     20
     C                     Z-ADD99        MMM     20
     C                     Z-ADD0         UFA
     C                     Z-ADD0         YACON
     C                     Z-ADD0         COAS1
     C                     Z-ADD0         TITIMP
     C                     Z-ADD0         SURF
     C                     Z-ADD0         SF
     C                     Z-ADD0         MAX
     C                     Z-ADD0         MIN
     C                     Z-ADD0         DTMAJ
     C                     Z-ADD0         DTCRE
     C                     Z-ADD0         WCONF1
     C                     Z-ADD0         WOPRO1
     C                     MOVE *HIVAL    SHIVAL
     C                     MOVE *HIVAL    HIVAL
     C                     Z-ADDAA        YEAR1
     C                     Z-ADDSSJ       YEARS   20
     C                     Z-ADDAA        YEAR
     C                     Z-ADDMM        MONTH
     C                     Z-ADDJJ        DAY
     C                     Z-ADDAA        YEAR1X
     C                     Z-ADDMM        MONTHX
     C                     Z-ADDJJ        DAYX
     C                     MOVE *ZEROS    V009
     C                     Z-ADD9999      CLIVAL  40
     C                     Z-ADD9999      PROVAL  40
     C                     Z-ADD9999      NOCLI
     C                     Z-ADD9999      NOPRO
     C           KHIVAL    CHAINPRODUI2              81
     C   81                WRITEPRODUIF1
     *
D1  C           *INU1     IFEQ '0'
     C           PUS       COMP 3                        03
     *
D2  C           *INU2     IFEQ '0'
     C           *NAMVAR   DEFN           DALANT  4
     C                     IN   DALANT
     C                     MOVE DALANT    DALAN
X2  C                     ELSE
     C           *NAMVAR   DEFN           DANUIT  4
     C                     IN   DANUIT
     C                     MOVE DANUIT    DALAN
F2  C                     END
     *
    C           LANIMP    CABEQ0         FIN
     *
     *  RECHERCHE DE LA DATE DU TRAITEMENT
     *  ==================================
     *
     C           KCALEN    CHAINCALENS               80
     C           KCAL07    CHAINCALENJL7             80
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
     *
     * SI JOUR = OV  FAIRE COMME SI  =  FIN DE S.(RECHERCHE DE LA SEM.
     * =========================================             SUIVANTE)
     C                     Z-ADD0         CPT     20
D2  C           *IN80     DOWEQ'0'
     *
D3  C           CALJOU    IFEQ 'SAMEDI  '
    C           CALJOU    OREQ 'DIMANCHE'
    C           CALJOU    OREQ 'FERIE   '
    C           CALJOU    OREQ 'OV      '
    C           OVRT      OREQ 1
    C           PUS       ANDEQ2
    C           OVTY      OREQ 1
    C           PUS       ANDEQ3
    C           OVNE      OREQ 1
    C           PUS       ANDEQ4
    C           OVCH      OREQ 1
    C           PUS       ANDEQ5
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
X3  C                     ELSE
     C                     ADD  1         CPT
     C           CPT       COMP LANIMP                   80
     C  N80                READ CALENJL7                 80
F3  C                     END
F2  C  N80                END
     *
     C                     Z-ADDCALSS     PANSS   20
     C                     Z-ADDCALAA     PANAA   20
     C                     Z-ADDCALMM     PANMM   20
     C                     Z-ADDCALJJ     PANJJ   20
F1  C                     END
     *
     *              ///////////////////////////
     *              /  DEBUT DU TRAITEMENT :  /
     *              ///////////////////////////
     *
     C           DEBUT     TAG
     C   U8                SETON                     18
     *
     C                     MOVE PECPAP    SUPOR
     C                     MOVE 'I'       PECPAP
     C           CLEPRI    CHAINPRLANCL1             80
     *
D1  C           *IN80     IFEQ '0'
     *
     C                     SETOF                     303144
    C           OFETA     CABEQ'TR'      FIN
     *  LA CDE NE DOIT PAS AVOIR ETE EDITEE
     *  ...................................
     C           KCARCD    CHAINCARCDEL1             81
    C           *IN81     CABEQ'1'       FIN
     *
    C           WARNT     CABEQ'RE'      FIN
     *
     C                     Z-ADDPRIORI    TRIORI  31
     C                     SETOF                     99
     *
     C           KCOFL3    CHAINCAROFL3              90
    C           *IN90     CABEQ'1'       FIN
D2  C           *IN90     DOWEQ'0'
     C           MSO       COMP 0                    9999
     C  N99      SOBESO    COMP ' '                  9999
     C           KCOFL3    READECAROFL3                  90
F2  C  N90N99             END
    C           *IN99     CABEQ'1'       FIN
     *
     C           KCOFL3    DELETCAROFL3              9099
D2  C           *IN90     DOWEQ'0'
     C           KCOFL3    DELETCAROFL3              9099
F2  C  N90                END
     *
     C           KBESL1    CHAINBESOMAL1             81
    C           *IN81     CABEQ'1'       FIN
D2  C           SBFE      IFEQ *ZEROS
     C           FORLBM    MULT 0,001     WORLBM  43
     C           FORHBM    MULT 0,001     WORHBM  43
     C           WORLBM    MULT WORHBM    SBFE
D3  C           SBFE      IFEQ *ZEROS
     C                     Z-ADDSBZ       SBFE
F3  C                     END
F2  C                     END
     *  ---> TITRE IMPRESSION
     *  ---------------------
     *
     C                     MOVE *BLANKS   V001   13
     C                     Z-ADD0         USFAC
     C                     Z-ADD0         FAIME
     C                     Z-ADD0         FAIMI
     C           KHIVAL    CHAINPRODUI2              81
D2  C           WTE       IFNE 0
     C           KPRO10    CHAINPRODUL10             81
    C           *IN81     CABEQ'1'       FIN
     C           KPREI1    CHAINPRODST2              81
     C                     Z-ADDUFA1      UFA,1
     C                     Z-ADDUFA2      UFA,2
     C                     Z-ADDUFA3      UFA,3
     C                     Z-ADDUFA4      UFA,4
     C                     Z-ADDUFA5      UFA,5
     C                     Z-ADDUFA6      UFA,6
     C                     Z-ADDUFA7      UFA,7
     C                     Z-ADDUFA8      UFA,8
     C                     Z-ADDUFA9      UFA,9
D3  C           1         DO   9         I
D4  C           UFA,I     IFNE 0
     C                     Z-ADDUFA,I     USFAC
     C                     SETON                     55
F4  C                     END
F3  C  N55                END
X2  C                     ELSE
     C           KPREI1    CHAINPREIMPL              81
    C           *IN81     CABEQ'1'       FIN
     C                     Z-ADDWSINE     USFAC
F2  C                     END
     *
D2  C           WTE       IFEQ 0
     C                     MOVE TIMPS     TITIMP  20
     C                     MOVELTREPS     TITIMP
     C                     Z-ADD3         SU      10
     *
X2  C                     ELSE
D3  C           SUPOR     IFEQ 'E'
D4  C           1         DO   3         I
     C           TIM,I     COMP 0                    50
     C  N50      TRE,I     COMP 0                    50
F4  C  N50                END
     C                     MOVE TIM,I     TITIMP  20
     C                     MOVELTRE,I     TITIMP
     C                     Z-ADDI         SU      10
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
D4  C           4         DO   7         I
     C           TIM,I     COMP 0                    50
     C  N50      TRE,I     COMP 0                    50
F4  C  N50                END
     C                     MOVE TIM,I     TITIMP  20
     C                     MOVELTRE,I     TITIMP
     C                     Z-ADDI         SU
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD1         I
     C           TITIMP    LOKUPTI,I                     50
D2  C           *IN50     IFEQ '1'
     C                     MOVELLIM,I     V001
F2  C                     END
     *
     *  ---> DATE D'EDITION DU DOCUMENT
     *  -------------------------------
     *
     *       YEAR,MONTH,DAY
     *
     *  ---> USINE IMPRESSION ,USINE FACONNAGE
     *  --------------------------------------
     *
     C                     MOVE *BLANKS   V003
     C                     MOVE '___'     V003X
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USIN'    PXARGU
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE WSEXT     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0031
     C                     Z-ADDWSEXT     USIMP   10
F3  C                     END
F2  C                     END
     *
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE WSINT     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0031
     C                     Z-ADDWSINT     USIMP
F3  C                     END
F2  C                     END
     *
D2  C           WTE       IFNE 0
     *
D3  C           WSDEST    IFEQ 0
     C                     Z-ADD0         WUSFAB
     C           KCDES1    CHAINPLANIFL3             82
D4  C           *IN82     IFEQ '0'
D5  C           WSECT     IFEQ '22'
    C           WSECT     OREQ '13'
    C           WSECT     OREQ '15'
     C           KCDES1    READEPLANIFL3                 82
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDWSDEST    WUSFAB
F3  C                     END
     *
D3  C           WUSFAB    IFNE 0
     C                     MOVE WUSFAB    PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0032
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     MOVE USFAC     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0032
F3  C                     END
F2  C                     END
     *
D2  C           USFAC     IFEQ 0
     C                     Z-ADDWUSFAB    USFAC   10
F2  C                     END
     *
     *
     *
     *  ---> NOM DU CLIENT OU "PRE-IMPRIME STOCKE"
     *  ------------------------------------------
     *
     C                     MOVE *BLANKS   V004   40
     C                     MOVE *BLANKS   X002   15
D2  C           WTE       IFEQ 0
     C                     MOVELCON,1     V004
     C                     MOVELCON,1     X002
X2  C                     ELSE
     C           KCLIL1    CHAINCLIENTS1             71
    C           *IN71     CABEQ'1'       FIN
     C                     MOVE NOMCLI    V004
     C                     MOVE ABRCLI    X002
F2  C                     END
     *
     *  ---> NUMERO DU CLIENT
     *  ---------------------
     *
     C                     MOVE WOCLI     V005    40
     *
     *  ---> NUMERO DU PRODUIT
     *  ----------------------
     *
     C                     MOVE WOPRO     V006    40
     *
     *  ---> CONFIRMATION + SEQUENCE
     *  ----------------------------
     *
     C                     MOVELWCONF     V0071   50
     C                     MOVE WEQFAB    V0072   20
     *
     *  ---> DELAI CLIENT CONFIRME
     *  --------------------------
     *
     C                     MOVELDTDEL     V056    50
     *
     *  ---> FIN AU PLUS TARD
     *  ---------------------
     *
     C           KCALFI    CHAINCALENS               81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDCALNOS    SEPRFI
     C                     Z-ADDCALNJ     JSPRFI
X2  C                     ELSE
     C                     Z-ADD0         DTPRFI
F2  C                     END
     C                     MOVELDTPRFI    V057    50
     *
     *  ---> DATE DERNIERE FABRICATION
     *  ------------------------------
     *
     C                     MOVE *ZEROS    V009
     C                     Z-ADDWOPRO     NPRO
     C           KHIS05    SETLLHISTOF15
     C           KHIS15    READEHISTOF15                 81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D3  C           *IN81     DOWEQ'0'
     C           KHIS15    READEHISTOF15                 81
D4  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDNEXOSEQ1
     C                     READPHISTOF15                 81
     C                     Z-ADDAFAB      V0093
     C                     Z-ADDMFAB      V0092
     C                     Z-ADDJFAB      V0091
     C                     SETON                     81
F4  C                     END
F3  C  N81                END
     *
X2  C                     ELSE
D3  C           STE       IFNE 0
     C                     Z-ADDANPRO     NPRO
     C           KHIS05    SETLLHISTOF15
     C           KHIS15    READEHISTOF15                 81
     C                     Z-ADDXCONF     XCONF1
     C                     Z-ADDXOSEQ     XOSEQ1
D4  C           *IN81     DOWEQ'0'
     C           KHIS15    READEHISTOF15                 81
D5  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDNEXOSEQ1
     C                     READPHISTOF15                 81
     C                     Z-ADDAFAB      V0083
     C                     Z-ADDMFAB      V0082
     C                     Z-ADDJFAB      V0081
     C                     SETON                     81
F5  C                     END
F4  C  N81                END
F3  C                     END
F2  C                     END
     *
     *  ---> DATE MISE A DISPOSITION
     *  ----------------------------
     *
     C                     MOVE *ZEROS    V008
     C           KPRLA8    CHAINPRLANCL8             81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDLANSS     YEARS
     C                     Z-ADDLANAA     YEAR
     C                     Z-ADDLANJOU    CALNOJ
     C           KCAL07    CHAINCALENJL7             81
     C                     Z-ADDCALAA     V0093
     C                     Z-ADDCALMM     V0092
     C                     Z-ADDCALJJ     V0091
F2  C                     END
     *
     *  ---> ANCIEN NUMERO DE PRODUIT
     *  -----------------------------
     *
     C                     MOVE *ZEROS    V010    40
D2  C           WTE       IFNE 0
     C                     MOVE ANPRO     V010
F2  C                     END
     *
     *  ---> CAUSE CHANGEMENT DE PRODUIT
     *  --------------------------------
     *
     C                     MOVE *BLANKS   V011   40
     C                     MOVEL'CAUSE '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V011
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
F2  C                     END
     *
     *  ---> DESIGNATION PRODUIT
     *  ------------------------
     *
     C                     MOVE *BLANKS   V012   40
     C                     MOVE *BLANKS   V013   40
     C                     MOVE *BLANKS   V014   40
     C                     MOVE *BLANKS   V015   40
     C                     MOVE *BLANKS   V016   40
     C                     MOVE *BLANKS   V017   40
     C                     MOVE *BLANKS   V018   40
     C                     MOVE *BLANKS   CQU
     *
     * SI PRE-IMP
D2  C           WTE       IFEQ 0
     C                     MOVELDPRIMP    V012
     C                     MOVEL'DEFINI'  DEST
     C                     Z-ADD0         CPT
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     DOWEQ'0'
    C           CPT       ANDLT5
     C                     ADD  1         CPT
D4  C           CPT       IFEQ 1
     C                     MOVE OBSLIB    V013
F4  C                     END
D4  C           CPT       IFEQ 2
     C                     MOVE OBSLIB    V014
F4  C                     END
D4  C           CPT       IFEQ 3
     C                     MOVE OBSLIB    V015
F4  C                     END
D4  C           CPT       IFEQ 4
     C                     MOVE OBSLIB    V016
F4  C                     END
D4  C           CPT       IFEQ 5
     C                     MOVE OBSLIB    V017
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 82
F3  C  N82                END
     *
     C                     MOVEL'PRELEV'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     DOWEQ'0'
    C           CPT       ANDLT5
     C                     ADD  1         CPT
D4  C           CPT       IFEQ 1
     C                     MOVE OBSLIB    V013
F4  C                     END
D4  C           CPT       IFEQ 2
     C                     MOVE OBSLIB    V014
F4  C                     END
D4  C           CPT       IFEQ 3
     C                     MOVE OBSLIB    V015
F4  C                     END
D4  C           CPT       IFEQ 4
     C                     MOVE OBSLIB    V016
F4  C                     END
D4  C           CPT       IFEQ 5
     C                     MOVE OBSLIB    V017
D5  C           NATOBS    IFEQ 'T'
     C     NU1             DELETOBSPROF1
F5  C                     END
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 82
F3  C  N82                END
     *
     *
     * SI PRODUIT
X2  C                     ELSE
     C                     MOVE BLOC1     V012
     C                     MOVE BLOC2     V013
     *
     * CONSTITUTUION DU BLOC3
D3  C           SUPB3     IFEQ ' '
     C                     MOVE ' BL3'    PXARGU
     C                     MOVE BT3       PXVALE
     C           KPARAM    CHAINPARAME               99
D4  C           *IN99     IFEQ '0'
     C                     MOVE PXLIBE    V014
D5  C           NBRFE     IFGT 0
     C                     MOVE ' 999'    PXVALE
     C           KPARAM    CHAINPARAME               98
D6  C           *IN98     IFEQ '0'
     C                     MOVELPXLIBE    V0141
     C                     MOVE NBRFE     V0142
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C                     MOVE BLOC4     V015
     C                     MOVE BLOC5     V016
     C                     MOVE BLOC6     V017
     C                     MOVE BLOC7     V018
     *
     * CONCEPTION,QUALITE,UTILISATION
     C                     MOVE GRAP1     PXVALE    P
     C                     MOVE 'TUTC'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBUTC
F3  C                     END
     C                     MOVE COUP1     PXVALE    P
     C                     MOVE 'TCON'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBCON
F3  C                     END
     C                     MOVE NATE1     PXVALE    P
     C                     MOVE 'TQUA'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBQUA
F3  C                     END
     C                     ADD  1         I
     C                     MOVELCQU       VAR,I
F2  C                     END
     *
     *  ---> MATERIEL IMPRESSION, MATERIEL DECOUPAGE
     *  --------------------------------------------
     *
     C                     MOVE *BLANKS   V020   12
     C                     MOVE *BLANKS   V021   12
     C           KPLAM2    SETLLPLAMAL1
     C           KPLAM1    READEPLAMAL1                  82
D2  C           *IN82     IFEQ '0'
     C                     Z-ADD1         I       30
     C                     Z-ADD1         J       30
D3  C           SUPOR     IFEQ 'E'
D4  C           TIM01     IFNE ' '
     C           ETAT01    LOKUPETA,I                    55
     C   55                MOVELLET,I     V020
     C   55                Z-ADDDDEF01    DV020   60
F4  C                     END
D4  C           TIM02     IFNE ' '
     C           ETAT02    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF02    DV020
F4  C                     END
D4  C           TIM01     IFNE ' '
    C           TIM02     ANDNE' '
F4  C                     END
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
D4  C           TIM03     IFNE ' '
     C           ETAT03    LOKUPETA,I                    55
     C   55                MOVELLET,I     V020
     C   55                Z-ADDDDEF03    DV020
F4  C                     END
D4  C           TIM04     IFNE ' '
     C           ETAT04    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF04    DV020
F4  C                     END
F3  C                     END
     *
D3  C           WTE       IFNE 0
D4  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     Z-ADD1         J
     C           ETAFOR    LOKUPETA,J                    55
     C   55                MOVELLET,J     V021
F4  C                     END
F3  C                     END
     *
X2  C                     ELSE
     *
     C                     MOVELLET,5     V020
D3  C           WTE       IFNE 0
D4  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     MOVELLET,5     V021
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> SUPPORT
     *  ------------
     *
D2  C           WTE       IFNE 0
     C                     MOVE *BLANKS   V022    9
D3  C           SUPOR     IFEQ 'E'
     C                     MOVELCON,2     V022
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
     C                     MOVELCON,3     V022
F3  C                     END
F2  C                     END
     *
     *  ---> CLICHE
     *  ------------
     *
D2  C           WTE       IFNE 0
     C                     MOVE *ZEROS    V023    60
     C                     MOVE *ZEROS    V058    60
D3  C           SUPOR     IFEQ 'E'
     C                     MOVE REFEX     V023
     C                     MOVELREREP     V058
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
     C                     MOVE REFIN     V023
     C                     MOVE RIREP     V058
F3  C                     END
X2  C                     ELSE
     C                     MOVE REFEXS    V023
     C                     MOVELACLEXS    V058
F2  C                     END
     *
     *  ---> NUMERO DE FORME
     *  --------------------
     C                     MOVE *ZEROS    V024    50
D2  C           WTE       IFNE 0
     C                     MOVE YOFOR     V024
F2  C                     END
     *
     *  ---> QUALITE
     *  ------------
     *
     C                     MOVE ' '       API     1
D2  C           TRIORI    IFEQ 62,0
     C                     MOVE APIECX    API
X2  C                     ELSE
     C                     MOVE APIICX    API
F2  C                     END
     C                     Z-ADD0         LAIZE
     C                     Z-ADD0         LMINI
     C                     MOVE ADPA,WUIMPSOF     3
D2  C           SOF       IFEQ 'CXH'
    C           API       ANDNE'O'
     C           KCXHL3    CHAINRESCXHL3             81
X2  C                     ELSE
     C           KRESPA    CHAINRESPAPL5             81
F2  C                     END
D2  C           *IN81     IFEQ '0'
     C                     MOVE PAPI      V0251   3
     C                     MOVE GRAMM     V0252   30
     C                     MOVE REFOUR    V0261   6
     C                     MOVE GRAREL    V0262   30
     C                     Z-ADDKGBESO    X011    70
     C                     Z-ADDLAIZE     WLAIZ   41
X2  C                     ELSE
D3  C           TITPRI    IFNE 0
     C                     MOVE *BLANKS   V0251   3
     C                     MOVE *ZEROS    V0252   30
     C                     MOVE *BLANKS   V0261   6
     C                     MOVE *ZEROS    V0262   30
     C                     MOVE 'ERREUR'  V0261
X3  C                     ELSE
D4  C           TITREP    IFEQ 2
D5  C           SUPOR     IFEQ 'E'
     C                     Z-ADD3         SUIMP
X5  C                     ELSE
     C                     Z-ADD5         SUIMP
F5  C                     END
     C           KRESIM    CHAINRESIMPL2             81
D5  C           *IN81     IFEQ '0'
     C                     MOVE NIMP2     WOCLI3
     C                     MOVE NIMP3     WOPRO3
F5  C                     END
     C           KPREI3    CHAINPREIMPL              81
D5  C           *IN81     IFEQ '0'
     C                     MOVE PAPIS     V0251
     C                     MOVE GRAMS     V0252
     C                     MOVE ADPAPS    V0261
     C                     MOVE ADGRAS    V0262
     C                     Z-ADDKGBESO    X011
     C                     MOVELLAIZS     V0294
     C                     Z-ADDLMINIS    V0314
     C                     Z-ADDTIMPS     CIMP
     C                     SETON                     44
     C                     SETOF                     3031
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     C                     MOVE *BLANKS   X012    6
     *
     *  ---> DEVELOPPE
     *  --------------
     *
     C                     MOVE *ZEROS    V027    40
D2  C           TITPRI    IFEQ 4
     C           HORL      COMP HORH                 606160
     C   60                MOVE HORH      V027
     C   61                MOVE HORL      V027
F2  C                     END
     *
D2  C           WTE       IFNE 0
    C           TITPRI    ANDEQ1
    C           WTE       ORNE 0
    C           TITPRI    ANDEQ2
    C           WTE       ORNE 0
    C           TITPRI    ANDEQ0
    C           TITREP    ANDEQ2
D3  C           COP,SU    IFEQ 'R'
    C           COP,SU    OREQ 'V'
     C                     MOVE YNDH      V027
F3  C                     END
F2  C                     END
     *
     *  ---> NOMBRE DE POSES
     *  --------------------
     *
     C                     MOVE *ZEROS    V028    31
D2  C           WTE       IFNE 0
     C                     Z-ADDYOSF1     WOSF1   20
     C                     Z-ADDWOSF1     V028
F2  C                     END
     *
    C           *IN44     CABEQ'1'       TAGOBS
     *
     *  ---> LAIZE OU FORMAT
     *  --------------------
     *
     C                     MOVE *ZEROS    V0291   40
     C                     MOVE 'X'       V0292   1
     C                     MOVE *ZEROS    V0293   40
     C                     MOVE *ZEROS    V0294   41
     *
D2  C           V0261     IFNE 'ERREUR'
D3  C           HOUB      IFEQ 'B'
D4  C           TITPRI    IFEQ 4
     C                     SETON                     30
     C                     Z-ADDFORLBM    V0291
     C                     Z-ADDFORHBM    V0293
X4  C                     ELSE
     C                     SETOF                     30
     C                     Z-ADDLAIZE     V0294
F4  C                     END
F3  C                     END
     *
D3  C           HOUB      IFEQ 'F'
     C                     SETON                     30
     C                     Z-ADDHORL      V0291
     C                     Z-ADDHORH      V0293
F3  C                     END
F2  C                     END
     *
     *  ---> DEVELOPPE MINI
     *  -------------------
     *
     C                     MOVE *ZEROS    V030    40
D2  C           WTE       IFNE 0
    C           TITPRI    ANDEQ1
    C           WTE       ORNE 0
    C           TITPRI    ANDEQ2
D3  C           COP,SU    IFEQ 'R'
    C           COP,SU    OREQ 'V'
     C                     Z-ADDDEVMIN    V030
F3  C                     END
F2  C                     END
     *
     *  ---> LAIZE OU FORMAT MINI
     *  -------------------------
     *
     C                     Z-ADD1         RAP
     C                     MOVE *ZEROS    V0311   40
     C                     MOVE 'X'       V0312   1
     C                     MOVE *ZEROS    V0313   40
     C                     MOVE *ZEROS    V0314   41
     *
D2  C           V0261     IFNE 'ERREUR'
D3  C           WTE       IFNE 0
D4  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 0
    C           TITPRI    ANDEQ2
     C                     SETOF                     31
     C                     Z-ADDLMINI     V0314
D5  C           STD,SU    IFNE BMINI
D6  C           BMINI     IFNE *ZEROS
D7  C           SU        IFNE 4
     C           STD,SU    DIV  BMINI     RAP     54H
X7  C                     ELSE
D8  C           YCOL      IFNE 5
     C                     Z-ADDBMINI     LMU     41
X8  C                     ELSE
     C           FORHBM    SUB  5         LMUX    40
     C                     MOVE LMUX      LMU
F8  C                     END
     C           STD,SU    DIV  LMU       RAP       H
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           TITPRI    IFEQ 4
     C                     SETON                     31
     C                     Z-ADDFOL,SU    V0311
     C                     Z-ADDFOH,SU    V0313
     C           FOL,SU    MULT 0,001     WFOL    43
     C           FOH,SU    MULT 0,001     WFOH    43
     C           WFOL      MULT WFOH      SBFE
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> OBSERVATIONS TEINTES
     *  -------------------------
     *
     C           TAGOBS    TAG
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     Z-ADD0         I
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'COLORE'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'COLORI'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'ENCREE'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'ENCREI'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *  - PREMIERE COMMANDE
     C           KSTAL1    SETLLSTACOML8
     C           KCARCU    READESTACOML8                 81
D2  C           *IN81     IFEQ '0'
D3  C           WWC       IFEQ WCONF
     C           KCARCU    READESTACOML8                 81
D4  C           *IN81     IFEQ '1'
     C                     MOVELCON,15    VAR,8
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     MOVELCON,15    VAR,8
F2  C                     END
     *
     C                     MOVEAVAR,1     VCTL1
     C                     MOVEAVAR,7     VCTL2
     C                     MOVEAVDT,1     VDTL
     *
     *
     *  ---> OBSERVATION IMPRESSION
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     MOVE *BLANKS   VEM
     C                     Z-ADD0         I
     C                     ADD  1         I
     C                     MOVE CQU       VAR,I
     *
     C                     MOVE 'PRODUI'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT8
    C           EMET      ANDNE'QUALIT'
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE EMET      VEM,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT8
D3  C           EMET      IFNE 'QUALIT'
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE EMET      VEM,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F4  C                     END
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'CLICHE'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'CLICHI'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT8
D3  C           EMET      IFNE 'QUALIT'
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE EMET      VEM,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F4  C                     END
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *  - COMMANDE D'ESSAIS
D2  C           YARNT     IFEQ 'MD'
    C           I         ANDLT8
     C                     ADD  1         I
     C                     MOVELCON,6     VAR,I
F2  C                     END
     *
     C                     MOVEAVAR,1     VIMPL1
     C                     MOVEAVAR,7     VIMPL2
     C                     MOVEAVDT,1     VIMPD
     C                     MOVEAVEM,1     VIMPE
     *
     *  ---> FORMAT ONDULE  (PAS POUR LE PRE-IMP)
     *  -----------------------------------------
     *
     C                     MOVE *BLANKS   V019
D2  C           STE       IFNE 0
    C           YNDL      ANDNE0
     C                     Z-ADDYNDL      V0191
     C                     MOVE 'X'       V0192
     C                     Z-ADDYNDH      V0193
F2  C                     END
     *
     *
     *  ---> QTE DEMANDEE
     *  -----------------
     *
     C                     Z-ADDWTIMP     V088    70
     *
     *
     *  ---> QTE EN STOCK
     *  -----------------
     *
     C                     Z-ADD*ZEROS    V089    70
     C                     Z-ADD*ZEROS    J
     C           KPRO10    CHAINMVTIMPLF             81
D2  C           *IN81     DOWEQ'0'
D3  C           SUPOR     IFEQ 'E'
    C           SUIMP     ANDGT3
    C                     GOTO SUISTO
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
    C           SUIMP     ANDLT4
    C                     GOTO SUISTO
F3  C                     END
     *
D3  C           WTE       IFEQ 0
D4  C           UNITE     IFEQ 'B'
     C                     ADD  MLBON     V089
X4  C                     ELSE
     C           NBFE      SUB  FEUBOU    Z1      70
     C                     ADD  Z1        V089
F4  C                     END
     *
X3  C                     ELSE
     *
     C                     Z-ADD1         I
     C           PRECDE    LOKUPCDE                      55
D4  C           *IN55     IFEQ '0'
     C                     ADD  1         J
     C                     Z-ADDPRECDE    CDE,J
F4  C                     END
     *
     C                     ADD  PROFIN    V089
F3  C                     END
     C           SUISTO    TAG
     C           KPRO10    READEMVTIMPLF                 81
F2  C  N81                END
     *
     *
     *  ---> SEQUENCES DE FABRICATION ET EXPEDITION
     *  -------------------------------------------
     *
     C                     Z-ADD0         W0971
     C                     Z-ADD0         W0972
     C                     Z-ADD0         W0973
     C                     Z-ADD0         W0974
     C                     MOVE *BLANKS   W0975
     C                     Z-ADD0         F       10
     C                     MOVE W097      W098
     C                     MOVE W097      W099
     C                     MOVE W097      W100
     C                     MOVE W097      W101
     C                     MOVE W097      W102
     C                     MOVE W097      SEF
     C           KCARCD    CHAINCARCDEL2             81
D2  C           *IN81     DOWEQ'0'
     C                     Z-ADDQTIMP     W0971
     C                     Z-ADDQTFAC     W0972
     C                     Z-ADDQTDEXP    W0973
     C                     MOVELSEDEL     W0974
     C                     MOVE JSDEL     W0974
     C                     MOVE CODEL     W0975
     C                     ADD  1         F
     C           F         COMP 6                    81
     C  N81                MOVEAW097      SEF,F
     C  N81      KCAR12    READECARCDEL2                 81
     C  N81      QTIMP     COMP 0                    81
F2  C  N81                END
     C                     MOVE SEF,1     W097
     C                     MOVE SEF,2     W098
     C                     MOVE SEF,3     W099
     C                     MOVE SEF,4     W100
     C                     MOVE SEF,5     W101
     C                     MOVE SEF,6     W102
     *
     *  ---> QTE EN RELIQUAT
     *  --------------------
     *
     C                     Z-ADD*ZEROS    V090    70
     C                     Z-ADD*ZEROS    I
D2  C           WTE       IFNE 0
    C           V089      ANDGT*ZEROS
     *
     C                     Z-ADDV089      V090
D3  C           1         DO   J         I
     C                     Z-ADDCDE,I     PRECDE
     C           KCARC2    CHAINCARCDEL2             81
D4  C           *IN81     DOWEQ'0'
D5  C           LANCFA    IFEQ ' '
    C           NCONF     ANDNEWCONF
    C           LANCFA    OREQ ' '
    C           NCONF     ANDEQWCONF
    C           SEQFAB    ANDLTWEQFAB
     C                     SUB  QTFAC     V090    70
     C           V090      COMP 0                      82
     C   82                Z-ADD0         V090
F5  C                     END
     C           KCAR22    READECARCDEL2                 81
     C  N81      QTIMP     COMP *ZEROS               81
F4  C  N81                END
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD0         STOCK   90
     C           KPRO10    CHAINLIEUSTL3             99
D2  C           *IN99     DOWEQ'0'
     C                     SETON                     92
D3  C           LILIEU    IFEQ 6
    C           CODEXT    ANDNE'  '
     C                     Z-ADD1         C
     C           CODEXT    LOKUPCXT,C                    92
F3  C                     END
D3  C           LILIEU    IFNE 8
    C           *IN92     ANDEQ'1'
     C                     ADD  STOLIE    STOCK                           PROD17
F3  C                     END
     C           KPRO10    READELIEUSTL3                 99              *PROD17
F2  C        N99          END                                           *PROD17
     C                     ADD  V090      STOCK
     C                     SETOF                     50
     *
     C           KSTAL1    SETLLCARCDEZ8
     C           KCARCU    READECARCDEZ8                 81
D2  C           *IN81     DOWEQ'0'
D3  C           NCONF     IFNE WCONF
     C                     SETON                     8150
F3  C                     END
     C  N81      KCARCU    READECARCDEZ8                 81
F2  C  N81                END
     C           STOCK     COMP 0                      82
     C   82                Z-ADD0         STOCK
     *
     *  ---> QTE A LANCER
     *  -----------------
     *
     C                     Z-ADD*ZEROS    V0951   70
     C                     MOVE *BLANKS   V0952   2
     C                     Z-ADD*ZEROS    V0961   70
     C                     MOVE *BLANKS   V0962   2
     C                     Z-ADD*ZEROS    V091    70
     C                     Z-ADD*ZEROS    RED
     C                     Z-ADDV088      V091
D2  C           *IN50     IFEQ '1'
     C                     Z-ADD0         V090
F2  C                     END
D2  C           *IN50     IFEQ '0'
    C           WEQFAB    ANDEQ01
D3  C           V088      IFGT STOCK
     C           V088      SUB  STOCK     V091
     C                     Z-ADDSTOCK     V090
X3  C                     ELSE
     C                     Z-ADD0         V091
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD*ZEROS    I
     C                     SETOF                     9998
     *
     C           *LIKE     DEFN ROUL      ROUL1
     C           *LIKE     DEFN SURGFA    SURGF1
     C           *LIKE     DEFN REDEC     REDEC1
     C                     Z-ADD0         ROUL1
     C                     Z-ADD0         SURGF1
     *
     C                     Z-ADD9         R
     C           KPLA15    SETLLPLAIMPL5
     C           KPLAL5    READEPLAIMPL5                 81
     C  N81                MOVE PR        WPR     1
     C  N81      SSECT     COMP '4'                  9898
D2  C           *IN81     DOWEQ'0'
D3  C           SSECT     IFEQ '2'
    C           SECT      ANDEQ'1'
     C                     ADD  1         I
     C  N99                Z-ADDROUL      ROUL1
     C  N99                Z-ADDSURGFA    SURGF1
     C                     Z-ADDREDEC     RED,I
     C                     SETON                     99
F3  C                     END
     C           KPLAL5    READEPLAIMPL5                 81
     C  N81      PR        COMP WPR                  8181
F2  C  N81                END
     C                     Z-ADDROUL1     ROUL
     C                     Z-ADDSURGF1    SURGFA
     C                     XFOOTRED       REDEC1
     C                     SUB  RED,1     REDEC1
D2  C           *IN98     IFEQ '1'
     C           REDEC1    MULT 0,01      W1
     C           W1        MULT BMINI     REDEC1    H
F2  C                     END
     C                     Z-ADDRED,1     REDEC
     *
     *  ---> QTE A REALISER MINI ET MAXI
     *  --------------------------------
     *
D2  C           *INU1     IFEQ '0'
     C           KCDES1    CHAINCDESL1               82
F2  C                     END
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           WTOT      MULT 0,01      SURFF     H
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           WTOT      MULT 0,001     SURFF     H
F2  C                     END
     *
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDWTOT      SURFF     H
F2  C                     END
     *
     C           SURFF     MULT SUVENT    SURFF
     *
D2  C           SURFF     IFEQ 0
     C                     Z-ADD1         SURFF
F2  C                     END
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           V091      MULT 0,01      W4     103
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           V091      MULT 0,001     W4
F2  C                     END
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDV091      W4
F2  C                     END
     *
     C           W4        MULT SUVENT    SUFNET 100H
     *
D2  C           BTFAB     IFNE *ZEROS
     C           BTTOT     DIV  BTFAB     NBF     31H
X2  C                     ELSE
     C                     Z-ADD1         NBF
F2  C                     END
     C           BTTOT     SUB  BTPRE     QTR    100
D2  C           BTREN     IFNE *ZEROS
     C           QTR       DIV  BTREN     NBI     31H
X2  C                     ELSE
     C                     Z-ADD1         NBI
F2  C                     END
D2  C           BTPRE     IFNE *ZEROS
     C                     ADD  1         NBI
F2  C                     END
     C           NBF       DIV  NBI       NB      31H
     *
     C           SUFNET    MULT DECFAZ    SUROUL 100H
     *
     C           BUREG     MULT NB        SUREGF  60
     C                     Z-ADDSUFNET    SUFTH  100
     C                     ADD  SUROUL    SUFTH
     *
D2  C           SUFNET    IFGT *ZEROS
     C                     ADD  SUREGF    SUFTH
F2  C                     END
     *
D2  C           SBFE      IFEQ *ZEROS
     C                     Z-ADD1         SF
X2  C                     ELSE
     C                     Z-ADDSBFE      SF
F2  C                     END
     *
     C                     Z-ADD*ZERO     MIN
     C                     Z-ADD*ZERO     MAX
     C                     MULT TAL,SU    SUFTH
     C                     MULT TAL,SU    SUFNET
     C                     MULT TAL,SU    SURFF
D2  C           SUFTH     IFNE *ZEROS
     C                     Z-ADDSUFTH     SURF
     C                     Z-ADDWCONF     WCONF1
     C                     Z-ADDWOPRO     WOPRO1
     C                     Z-ADDWOCLI     WOCLI1
     C                     CALL 'CDEC92£'
     C                     PARM           DSPARA
F2  C                     END
     C                     Z-ADDMIN       SFMIN   80
     C                     Z-ADDMAX       SFMAX   80
     * DEMANDE DE SERGE PIERRE LE 7/03/96
     *  QUANTITE A REALISER AVEC ARRONDI A LA CENTAINE SUPERIEUR
     *  SI PREIMP QUANTITE A REALISER = CARCDE
     C                     Z-ADD1         I
     C           SFMIN     LOKUPQFS,I                10
D2  C           QFP,I     IFNE *BLANKS
     C                     MOVE QFP,I     PLAFON 100
X2  C                     ELSE
     C                     Z-ADD0         PLAFON
F2  C                     END
     *
     C           SFMIN     MULT 0,01      ARRON  102
     C           ARRON     MULT QF,I      ARRON
     C           SFMIN     ADD  ARRON     SFMIN
D2  C           SFMIN     IFGT PLAFON
    C           PLAFON    ANDNE0
     C                     Z-ADDPLAFON    SFMIN
F2  C                     END
     *
     *
     C                     Z-ADD*ZEROS    USFO1   31
     C                     Z-ADD*ZEROS    USFO2   31
     C                     MOVE *BLANKS   USFO    8
     *
     * TOLERANCE SUR QUANTITES
     *------------------------
     *
     C                     MOVE ' '       MOINS   1
     C                     MOVE ' '       PLUS    1
     C                     MOVELWPROTO    WROTO   1
     *
     C                     MOVELCON,14    V109   40
     *
D2  C           WACLI     IFEQ 0
    C           WICLI     ANDEQ0
    C           WROTO     ANDNE'T'
     *
     C                     Z-ADD1         I
     C           SURFF     LOKUPTSX,I                10
     C                     Z-ADDTB,I      USFO1     H
     C                     Z-ADDTB,I      USFO2     H
     C                     MOVEL'USFO   :'USFO
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
     *
X2  C                     ELSE
D3  C           WROTO     IFEQ 'T'
     C                     MOVEL'ZERO.'   USFO
F3  C                     END
D3  C           WROTO     IFEQ 'P'
     C                     MOVEL'PROMO  :'USFO
     C                     Z-ADDWICLI     USFO1
     C                     Z-ADDWACLI     USFO2
     C                     MOVE '+'       PLUS
F3  C                     END
D3  C           WROTO     IFEQ ' '
     C                     MOVE 'CLIENT :'USFO
     C                     Z-ADDWICLI     USFO1
     C                     Z-ADDWACLI     USFO2
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
F3  C                     END
F2  C                     END
     *
     *
D2  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 4
    C           TITPRI    OREQ 0
     C           BMINI     MULT 0,01      WMINI   43
     C           SFMIN     DIV  WMINI     V0951
     C           SFMAX     DIV  WMINI     V0961
     C                     MOVE 'ML'      V0952
     C                     MOVE 'ML'      V0962
D4  C           SU        IFGT 3
    C           FAIMI     ANDEQ14
    C           TITPRI    ANDEQ2
    C           SU        ORLT 4
    C           FAIME     ANDEQ14
    C           TITPRI    ANDEQ2
     C           V0951     MULT 1,2       V0951
     C           V0961     MULT 1,2       V0961
F4  C                     END
F3  C                     END
F2  C                     END
     *
D2  C           TITREP    IFEQ 0
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
     C           BMINI     MULT 0,01      WMINI
     C           SFMIN     DIV  WMINI     V0951
     C           SFMAX     DIV  WMINI     V0961
     C                     MOVE 'ML'      V0952
     C                     MOVE 'ML'      V0962
D4  C           SU        IFLT 4
    C           FAIMI     ANDEQ14
    C           SU        ORGT 3
    C           FAIME     ANDEQ14
     C           V0951     MULT 1,2       V0951
     C           V0961     MULT 1,2       V0961
F4  C                     END
F3  C                     END
F2  C                     END
     *
D2  C           TITPRI    IFEQ 4
D3  C           TITREP    IFNE 1
    C           TITREP    ANDNE2
     C           SFMIN     DIV  SBFE      V0951
     C           SFMAX     DIV  SBFE      V0961
     C                     MOVE 'FE'      V0952
     C                     MOVE 'FE'      V0962
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD*ZEROS    V0961
     C                     MOVE *BLANKS   V0962
     *
D2  C           V0951     IFNE 0
    C           V0951     ANDGT100
     C                     Z-ADDV0951     A100    20
D3  C           A100      IFNE 0
     C                     MOVE '00'      V0951
     C                     ADD  100       V0951
F3  C                     END
F2  C                     END
     *
D2  C           IMPSTO    IFNE ' '
     C                     Z-ADDV091      V0951
F2  C                     END
     *
     C                     Z-ADDSUFTH     WUFTH  100
     *
     *
     *  ---> QTE A APPROVISIONNER
     *  -------------------------
     *
     C                     Z-ADD*ZEROS    V0941   70
     C                     MOVE *BLANKS   V0942   2
     *
D2  C           SUPOR     IFEQ 'E'
     C           SUFNET    MULT EXDEC     ROUEXT  70H
     C                     Z-ADDSFMAX     SUFTH
D3  C           SFMAX     IFNE *ZEROS
     C                     ADD  ROUEXT    SUFTH
     C                     ADD  RIMPE     SUFTH
F3  C                     END
F2  C                     END
     *
D2  C           SUPOR     IFEQ 'I'
     C           SUFNET    MULT INDEC     ROUINT  70H
     C                     Z-ADDSFMAX     SUFTH
D3  C           SFMAX     IFNE *ZEROS
     C                     ADD  ROUINT    SUFTH
     C                     ADD  RIMPI     SUFTH
F3  C                     END
F2  C                     END
     *
     C                     MULT RAP       SUFTH
     *
D2  C           SOF       IFEQ 'CXH'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
     C                     MOVE 'KG'      V0942
F2  C                     END
     *
D2  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 4
    C           TITPRI    OREQ 0
     *
     C                     MOVE HOUB      FOUB
     C           KUSIL1    CHAINQUAUSI               81
D4  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
X4  C                     ELSE
D5  C           FOUB      IFEQ 'F'
     C                     MOVE 'B'       FOUB
     *
     C           KUSIL1    CHAINQUAUSI               81
D6  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
F6  C                     END
F5  C                     END
F4  C                     END
     C                     MOVE 'KG'      V0942
F3  C                     END
F2  C                     END
     *
D2  C           TITREP    IFEQ 0
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
     *
     C                     MOVE HOUB      FOUB
     C           KUSIL1    CHAINQUAUSI               81
D4  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
X4  C                     ELSE
D5  C           FOUB      IFEQ 'F'
     C                     MOVE 'B'       FOUB
     *
     C           KUSIL1    CHAINQUAUSI               81
D6  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
F6  C                     END
F5  C                     END
F4  C                     END
D4  C           SU        IFGT 3
    C           FAIME     ANDEQ14
    C           TITPRI    ANDEQ2
    C           SU        ORLT 4
    C           FAIMI     ANDEQ14
    C           TITPRI    ANDEQ2
     C           V0941     MULT 1,2       V0941
F4  C                     END
     *
     C                     MOVE 'KG'      V0942
F3  C                     END
F2  C                     END
     *
D2  C           TITPRI    IFEQ 4
D3  C           TITREP    IFNE 1
    C           TITREP    ANDNE2
     C           SUFTH     DIV  SBFE      V0941     H
     C           V0941     DIV  0,99      V0941     H
     C                     MOVE 'FE'      V0942
F3  C                     END
F2  C                     END
     *
    C*          V0942     IFEQ 'KG'
    C*          WLAIZ     DIV  BMINI     W3      54H
    C*          V0941     MULT W3        V0941     H
    C*                    END
     *
D2  C           SU        IFEQ 4
    C*          V0941     MULT TAL,4     V0941     H
F2  C                     END
     *
     *
     *  ---> INFORMATIONS DES PASSAGES
     *  ------------------------------
     *
     C                     MOVE *BLANKS   V052    6
     C                     MOVE *BLANKS   V053    6
     C                     MOVE *BLANKS   V054    6
     C                     MOVE *BLANKS   V055    6
     C                     MOVE *BLANKS   V1221   1
     C                     MOVE *BLANKS   V1222   1
     C                     MOVE *BLANKS   V1231   1
     C                     MOVE *BLANKS   V1232   1
     C                     MOVE *BLANKS   V084   24
     C                     MOVE *BLANKS   V085   24
     C                     MOVEL'REPERE'  REPERE 13
     C                     MOVEL'TOTAL'   TOTAL  13
     C                     Z-ADD0         I
     C                     Z-ADD9         R
     C                     MOVE ' '       WPR
     *
     C           KPLA15    SETLLPLAIMPL5
     C           KPLAL5    READEPLAIMPL5                 81
     C  N81                MOVE PR        WPR
     C  N81                MOVE R         WR      10
     *
D2  C           *IN81     DOWEQ'0'
    C           PR        CABNEWPR       SUITPI     8181
    C           SSECT     CABEQ'3'       SUITPI
    C           SECT      CABEQ'2'       SUITPI
     *
D3  C           PAS       IFEQ 1
    C           R         ANDEQWR
    C           *IN44     ANDEQ'0'
     C                     MOVELNOMAC     V052
    C*                    MOVELPAS       V054
     C                     MOVEL'P'       V054
D4  C           COULX     IFNE 0
     C                     MOVELCOULX     V1221
F4  C                     END
     C                     MOVE VERNIS    V1222
D4  C           V1222     IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE SSECT     XVERA1
     C                     MOVE V1222     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             82
D5  C           *IN82     IFEQ '0'
     C                     MOVELTBVRES    XVER00
     C                     MOVELXVER02    V084
D6  C           CVE,SU    IFLT 1
     C                     MOVE REPERE    V084
X6  C                     ELSE
     C                     MOVE TOTAL     V084
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           R         IFNE WR
    C           PAS       OREQ 2
    C           *IN44     OREQ '1'
     C                     MOVELNOMAC     V053
    C*                    MOVELPAS       V055
     C                     MOVEL'R'       V055
D4  C           COULX     IFNE 0
     C                     MOVELCOULX     V1231
F4  C                     END
     C                     MOVE VERNIS    V1232
D4  C           V1232     IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE SSECT     XVERA1
     C                     MOVE V1232     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             82
D5  C           *IN82     IFEQ '0'
     C                     MOVELTBVRES    XVER00
     C                     MOVELXVER02    V085
D6  C           CVE,SU    IFLT 1
     C                     MOVE REPERE    V085
X6  C                     ELSE
     C                     MOVE TOTAL     V085
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           *IN22     IFEQ '0'
     C                     MOVE SECT      CECT
     C                     MOVE SSECT     CSECT
     C                     MOVE NOMAC     COMAC
     C                     SETON                     22
F3  C                     END
     *
     C           SUITPI    TAG
     C  N81      KPLAL5    READEPLAIMPL5                 81
F2  C  N81                END
     *
     *
     *
     *  ---> OBSERVATIONS QUALITE
     *  -------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     Z-ADD0         I
     *
     C                     MOVE 'QUALIT'  EMET
    C*                    MOVE 'FICLAB'  DEST
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          *IN81     DOWEQ'0'
    C*          I         ANDLT6
    C*                    ADD  1         I
    C*                    MOVE OBSLIB    VAR,I
    C*                    MOVE DTCRE     VDT,I
    C*          NATOBS    IFEQ 'T'
    C* NU1                DELETOBSPROF1
    C*                    END
    C*          KOBSP2    READEOBSPROL1                 81
    C* N81                END
     *
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'CONTEX'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'CONTIN'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT6
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVE 'QUALIT'  EMET
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT6
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *
D2  C           SUPOR     IFEQ 'E'
    C           SUPOR     OREQ 'I'
     C                     MOVE 'BM    '  EMET
     C                     MOVE 'CLIREF'  DEST
F2  C                     END
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT6
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *
     *   SUPPRIME LE 4/10/94 A LA DEMANDE DE JCC(TOURY)
     *
    C*                    MOVE 'QUALIT'  EMET
    C*                    MOVE 'PRODUI'  DEST
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          *IN81     DOWEQ'0'
    C*          I         ANDLT6
    C*                    ADD  1         I
    C*                    MOVE OBSLIB    VAR,I
    C*                    MOVE DTCRE     VDT,I
    C*          NATOBS    IFEQ 'T'
    C* NU1                DELETOBSPROF1
    C*                    END
    C*          KOBSP2    READEOBSPROL1                 81
    C* N81                END
     *
     * OBSERVATION PLAN D'IMPRESSION CODE ANALYTIQUE "PL".
     C                     MOVE 'PL'      CODINT
     C           KINTL3    CHAINFORINTL3             81
D2  C           *IN81     IFEQ '0'
    C           I         ANDLT6
     C                     ADD  1         I
     C                     MOVE OBSINT    VAR,I
     C                     MOVE DINTER    VDT,I
F2  C                     END
     *
     * OBSERVATION STOCKE (CIPIERRE)
D2  C           WTE       IFEQ 0
    C           I         ANDLT6
     C                     ADD  1         I
     C                     MOVELCON,16    ZON    25
     C                     MOVE WOCLI     ZON
     C                     MOVEAZON       VAR,I
F2  C                     END
     * OBSERVATION STOCKE SI REPIQUAGE
D2  C           *IN44     IFEQ '1'
     C                     MOVELCON,17    ZONZON
     C                     MOVE NIMP2     ZON2
     C                     MOVE NIMP3     ZON3
     C                     MOVE ZONZON    V067
F2  C                     END
     *
     *
     C                     MOVEAVAR,1     VCON
     C                     MOVEAVDT,1     VDON
     *
     *
     C                     EXCPTBONIM
     *
     *
D2  C           *INU1     IFEQ '0'
     C                     MOVEL*YEAR     SSFABD
     C                     MOVE *YEAR     AAFABD
     C                     Z-ADDMONTH     MMFABD
     C                     Z-ADDDAY       JJFABD
     *
F2  C                     END
     *
D2  C           *INU1     IFEQ '0'
     C                     MOVE *BLANKS   PARTIE  7
     *
D3  C           SOF       IFNE 'CXH'
     C           KRESPA    CHAINRESPAPL5             81
D4  C           *IN81     DOWEQ'0'
     C                     ADD  KGBESO    KGTOT  100
     C           KRESPA    READERESPAPL5                 81
D5  C           *IN81     IFEQ '0'
     C                     MOVE 'PARTIEL' PARTIE
F5  C                     END
F4  C  N81                END
F3  C                     END
     *
D3  C           SOF       IFEQ 'CXH'
    C           API       ANDNE'O'
     C           KCXHL3    CHAINRESCXHL3             81
X3  C                     ELSE
     C           KRESPA    CHAINRESPAPL5             81
D4  C           *IN81     IFEQ '1'
     C           KRESIM    CHAINRESIMPL2             81
F4  C                     END
F3  C                     END
D3  C           *IN81     DOWEQ'0'
     C                     SETOF                     4041
D4  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
    C           TITPRI    OREQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 0
     C                     Z-ADDKGBESO    X011    70
     *
D5  C           HOUB      IFEQ 'B'
     C                     Z-ADDLAIZE     X0104   41
     C                     Z-ADD*ZEROS    X0101   40
     C                     MOVE ' '       X0102   1
     C                     Z-ADD*ZEROS    X0103   40
F5  C                     END
     *
D5  C           HOUB      IFEQ 'F'
     C                     SETON                     30
     C                     Z-ADDHORL      X0101
     C                     MOVE 'X'       X0102
     C                     Z-ADDHORH      X0103
     C                     Z-ADDLAIZE     X0104
F5  C                     END
     *
     C                     MOVE PAPI      X0081   3
     C                     MOVE GRAMM     X0082   30
     C                     MOVE REFOUR    X0091   6
     C                     MOVE GRAREL    X0092   30
     *
     C           X0104     COMP *ZEROS                   32
     C                     SETON                     40
F4  C                     END
     *
D4  C           *IN40     IFEQ '1'
     C                     Z-ADDUSIMP     USINE
     C                     Z-ADDWCONF     NCONF
     C                     Z-ADDWEQFAB    SEQFAB
     C                     Z-ADDWOCLI     NOCLI
     C                     Z-ADDWOPRO     NOPRO
     C                     Z-ADDSUIMP     SUPPOR
     C                     MOVE *BLANKS   TITETE
     C                     MOVELLIM,2     TITETE
     C                     MOVE NOMAC     TITETE
     C                     MOVE NOMAC     COMAC
     C                     MOVELV022      LIBSUP
     C                     Z-ADDX0101     FORL
     C                     Z-ADDX0103     FORH
     C                     Z-ADDX0104     LAIZE
D5  C           FORL      IFEQ 0
     C                     Z-ADDX011      KGPRE
     C                     MOVE 'B'       FOUB
X5  C                     ELSE
     C                     Z-ADDX011      FEPRE
     C                     MOVE 'F'       FOUB
F5  C                     END
     C                     MOVE X0081     PAPI
     C                     MOVE X0082     GRAMM
     C                     MOVE X0091     REFOUR
     C                     MOVE X0092     GRAREL
     C                     Z-ADD0         CIMP
     C                     MOVE *BLANKS   LIBIMP
D5  C           V058      IFEQ *ZEROS
     C                     MOVE *BLANKS   CCLI
X5  C                     ELSE
D6  C           *IN44     IFEQ '1'
     C                     MOVELLIM,2     LIBIMP
     C                     MOVE 'REP'     LIBIMP
     C                     MOVE V0294     LAIZE
     C                     MOVE 'B'       FOUB
     C                     MOVE '2'       CIMP
F6  C                     END
F5  C                     END
     C                     MOVE REFOUR    SOF
D5  C           SOF       IFEQ 'CXH'
     C                     Z-ADDFORCXH    FORCX
     C                     Z-ADDSTECXH    STECX
     C                     Z-ADDCLICXH    CLICX
     C                     Z-ADDPROCXH    PROCX
X5  C                     ELSE
     C                     Z-ADD0         FORCX
     C                     Z-ADD0         STECX
     C                     Z-ADD0         CLICX
     C                     Z-ADD0         PROCX
F5  C                     END
     C                     WRITECAROFF1
F4  C                     END
     *
     C           KRESPA    READERESPAPL5                 81
     *
     *
    C*  40                EXCPTBONSO
F3  C  N81                END
     *
F2  C                     END
     *
     *
F1  C                     END
     *
     C           FIN       TAG
     C                     SETON                     LR
     C           KHIVAL    DELETPRODUIF1             81
     *
     OBONIMT  E                BONIM                                      PROD02
     O                         V001      13                               PROD02
     O                         V002      23                               PROD02
     O                         V003      35                               PROD02
     O                         V004      75                               PROD02
     O                         V005  4   79                               PROD02
     O                         V006  4   83                               PROD02
     O                         V0071 4   88                               PROD02
     O                         V0072 4   92                               PROD02
     O                         V008     100 '  /  / 0'                    PROD02
     O                         V009     108 '  /  / 0'                    PROD02
     O                         V010  4  112                               PROD02
     O                         V011     152                               PROD02
     O                         V012     192                               PROD02
     O                         V013     232                               PROD02
     O                         V014     272                               PROD02
     O                         V015     312                               PROD02
     O                         V016     352                               PROD02
     O                         V017     392                               PROD02
     O                         V018     432                               PROD02
     O                         V019     443                               PROD02
     O                         V020     455                               PROD02
     O                         V021     467                               PROD02
     O                         V022     476                               PROD02
     O                         V023  4  482                               PROD02
     O                         V024  4  487                               PROD02
     O                         V0251    490                               PROD02
     O                         V0252 4  494                               PROD02
     O                         V0261    500                               PROD02
     O                         V0262 4  505                               PROD02
     O                         V027  4  509                               PROD02
     O                         V028  4  513                               PROD02
     O                N30      V0294 4  518                               PROD02
     O                         V030  4  528                               PROD02
     O                N31      V0314 4  533                               PROD02
     O                         V032     579                               PROD02
     O                         V033     619                               PROD02
     O                         V034     659                               PROD02
     O                         V035     699                               PROD02
     O                         V036     739                               PROD02
     O                         V037     779                               PROD02
     O                         V038     819                               PROD02
     O                         V039     859                               PROD02
     O                         V040     867 '  /  / 0'                    PROD02
     O                         V041     875 '  /  / 0'                    PROD02
     O                         V042     883 '  /  / 0'                    PROD02
     O                         V043     891 '  /  / 0'                    PROD02
     O                         V044     899 '  /  / 0'                    PROD02
     O                         V045     907 '  /  / 0'                    PROD02
     O                         V046     915 '  /  / 0'                    PROD02
     O                         V047     923 '  /  / 0'                    PROD02
    O*                        V048     963                               PROD02
     O                         V052    1089                               PROD02
     O                         V053    1095                               PROD02
     O                         V054    1101                               PROD02
     O                         V055    1107                               PROD02
     O                         V056    1114 '  .  .0'                     PROD02
     O                         V057    1122 '  .  .0'                     PROD02
     O                         V058  4 1129                               PROD02
     O                         V060    1179                               PROD02
     O                         V061    1219                               PROD02
     O                         V062    1259                               PROD02
     O                         V063    1299                               PROD02
     O                         V064    1339                               PROD02
     O                         V065    1379                               PROD02
     O                         V066    1419                               PROD02
     O                         V067    1459                               PROD02
     O                         V068    1465                               PROD02
     O                         V069    1471                               PROD02
     O                         V070    1477                               PROD02
     O                         V071    1483                               PROD02
     O                         V072    1489                               PROD02
     O                         V073    1495                               PROD02
     O                         V074    1501                               PROD02
     O                         V075    1507                               PROD02
     O                         V076    1515 '  /  / 0'                    PROD02
     O                         V077    1523 '  /  / 0'                    PROD02
     O                         V078    1531 '  /  / 0'                    PROD02
     O                         V079    1539 '  /  / 0'                    PROD02
     O                         V080    1547 '  /  / 0'                    PROD02
     O                         V081    1555 '  /  / 0'                    PROD02
     O                         V082    1563 '  /  / 0'                    PROD02
     O                         V083    1571 '  /  / 0'                    PROD02
     O                         V084    1595                               PROD02
     O                         V085    1619                               PROD02
     O                NU1              1643 'IS/ IMP 96 T / 008      '    PROD02
     O                 U1              1643 'IS/ IMP 96 T / 009      '    PROD02
     O                         V088  2 1676                               PROD02
     O                         V089  2 1685                               PROD02
     O                         V090  2 1694                               PROD02
     O                         V091  2 1703                               PROD02
     O                N44      V0941 2 1720                               PROD02
     O                 44      X011  2 1720                               PROD02
     O                         V0942   1723                               PROD02
     O                         V0951 2 1732                               PROD02
     O                         V0952   1735                               PROD02
     O                         V0961 2 1744                               PROD02
     O                         V0962   1747                               PROD02
     O                         W0971 2 1755                               PROD02
     O                         W0972 2 1763                               PROD02
     O                         W0973 2 1772                               PROD02
     O                         W0974   1778 '  . '                        PROD02
     O                         W0975   1781                               PROD02
     O                         W0981 2 1831                               PROD02
     O                         W0982 2 1839                               PROD02
     O                         W0983 2 1848                               PROD02
     O                         W0984   1854 '  . '                        PROD02
     O                         W0985   1857                               PROD02
     O                         W0991 2 1907                               PROD02
     O                         W0992 2 1915                               PROD02
     O                         W0993 2 1924                               PROD02
     O                         W0994   1930 '  . '                        PROD02
     O                         W0995   1933                               PROD02
     O                         W1001 2 1983                               PROD02
     O                         W1002 2 1991                               PROD02
     O                         W1003 2 2000                               PROD02
     O                         W1004   2006 '  . '                        PROD02
     O                         W1005   2009                               PROD02
     O                         W1011 2 2059                               PROD02
     O                         W1012 2 2067                               PROD02
     O                         W1013 2 2076                               PROD02
     O                         W1014   2082 '  . '                        PROD02
     O                         W1015   2085                               PROD02
     O                         W1021 2 2135                               PROD02
     O                         W1022 2 2143                               PROD02
     O                         W1023 2 2152                               PROD02
     O                         W1024   2158 '  . '                        PROD02
     O                         W1025   2161                               PROD02
     O                         V109    2699                               PROD02
     O                         USFO    2686
     O                                 2687 '-'
     O                         USFO1 3 2691
     O                                 2692 '%'
     O                         PLUS    2694
     O                         USFO2 3 2698
     O                                 2699 '%'
     O                         V1141   2899                               PROD02
     O                         V1142   2915 '  /  / 0'                    PROD02
     O                         V1151   2955                               PROD02
     O                         V1152   2971 '  /  / 0'                    PROD02
     O                         V1161   3011                               PROD02
     O                         V1162   3027 '  /  / 0'                    PROD02
     O                         V1171   3067                               PROD02
     O                         V1172   3083 '  /  / 0'                    PROD02
     O                         V1181   3123                               PROD02
     O                         V1182   3139 '  /  / 0'                    PROD02
     O                         V1191   3178                               PROD02
     O                         V1192   3195 '  /  / 0'                    PROD02
     O                         V1221   3308                               PROD02
     O                         V1222   3311                               PROD02
     O                         V1231   3318                               PROD02
     O                         V1232   3321                               PROD02
     O                         USFAC   3460P                              PROD02
     O                         USIMP   3461P                              PROD02
     O                         V130    3480                               PROD02
    O*SORTI  E                BONSO                                      PROD02
    O*                        V005  4    4                               PROD02
    O*                        X002      19                               PROD02
    O*                        V0071 4   24                               PROD02
    O*                        V0072     26                               PROD02
    O*                        V006  4   30                               PROD02
    O*                        V012      70                               PROD02
    O*                        V013     110                               PROD02
    O*                        X0081    113                               PROD02
    O*                        X0082 4  117                               PROD02
    O*                        X0091    123                               PROD02
    O*                        X0092 4  127                               PROD02
    O*                32      X0101 4  131                               PROD02
    O*                32      X0102    133                               PROD02
    O*                32      X0103 4  138                               PROD02
    O*               N32      X0104    135 '   .0'                       PROD02
    O*                        X011  2  147                               PROD02
    O*                        PARTIE   154                               PROD02
    O*                        V0971    160                               PROD02
    O*                        V0972    163                               PROD02
    O*                        X014  Y  171                               PROD02
    O*                        WSINE    172P                              PROD02
    O*                        USIMP    173P                              PROD02
**  TABLE DES TYPES D'IMPRESSION
01HELIO
02FLEXO
04OFFSET
12HELIO-FLEXO
14HELIO-OFFSET
21FLEXO-HELIO
24FLEXO-OFFSET
44OFFSET-OFFSET
10HELIO
20FLEXO
40OFFSET
**  TABLE DES CONSTANTES
PRE-IMPRIME STOCKE
EXTERIEUR
INTERIEUR
GROUPAGE
GARNITURE
COMMANDE D'ESSAIS
COMMANDE D'HOMOLOGATION
IMPRESSION EXT. INT.
SOUS-TRAITANCE
PRODUIT DE LUXE
BANDE DE GUIDAGE COTE MOTEUR
AMALGAME
ATTENTION !!!    COMMANDE SANS VETO
TOLERANCE QUANTITE
PREMIERE COMMANDE
S T O C K E . . N° :
REPIQUAGE SUR STOCKE N° :
**  TABLE DES ETAT MATERIEL
CCREATION
MMODIFICATION
RREFECTION
EEXISTANT
 EXISTANT
