     **********************************************************
     *                                                        *
     *    AFFICHAGE ET PELLICULLAGE                           *
     *    -----------------------------------------           *
     **********************************************************
     H             /J
     FDEV013D CF  E                    WORKSTN
    FPRODS3L1UF  E           K        DISK                      A
    FDEVIS2  UF  E           K        DISK                      A
    FOFFRES2 UF  E           K        DISK                      A
     FMATPREL1IF  E           K        DISK
     FCXHENTL1IF  E           K        DISK
     FCXHLIGL1IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FXTBASE01IF  E           K        DISK
     FMACHIN  IF  E           K        DISK
     FPRODUL40IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
    FPRODST5 UF  E           K        DISK                      A
     FPREACFI2IF  E           K        DISK
     E                    TA      1   4 30
     E                    TL      1   3 40
     E                    TLS     1  16 14
     E                    BL0        40  1                BLOC 0
     E                    TABI    1   4  1 0 TABIM   6    TYP IMP.
     E                    ERR     1  11 60
     IPREIMPF1
     I              ETUDE                           WWW1
     I              SEQDE                           WWW2
     IPRODSTF2
     I              SSD1                            WSD1
     I              PRDID1                          WRDID1
     I              PRGRD1                          WRGRD1
     I              PROUD1                          WROUD1
     I              PEFFD1                          WEFFD1
     I              PDECD1                          WDECD1
     I              RETPD1                          WETPD1
     I              ROCAD1                          WOCAD1
     I              SSD2                            WSD2
     I              PRDID2                          WRDID2
     I              PRGRD2                          WRGRD2
     I              PROUD2                          WROUD2
     I              PEFFD2                          WEFFD2
     I              PDECD2                          WDECD2
     I              RETPD2                          WETPD2
     I              ROCAD2                          WOCAD2
     I              SSDA                            WSDA
     I              PRDIDA                          WRDIDA
     I              PRGRDA                          WRGRDA
     I              PROUDA                          WROUDA
     I              PEFFDA                          WEFFDA
     I              PDECDA                          WDECDA
     I              RETPDA                          WETPDA
     I              ROCADA                          WOCADA
     I              SSDB                            WSDB
     I              PRDIDB                          WRDIDB
     I              PRGRDB                          WRGRDB
     I              PROUDB                          WROUDB
     I              PEFFDB                          WEFFDB
     I              PDECDB                          WDECDB
     I              RETPDB                          WETPDB
     I              ROCADB                          WOCADB
     I              REFDO2                          WEFDO2
     I              DORGAM                          WORGAM
     IPRODSTF5
     I              PAPI                            PAPA
     I              GRAMM                           GRAA
     I              REFOUR                          REFA
     I              GRAREL                          GRELA
     *
     IPREACFIF
     I              SECT                            SECTFT
     I              SSECT                           SSECFT
     I              CLINO                           CLICHX
     I              LAIZE                           LAIZEX
     *
     IPARAM       DS                             28
     I                                        1   1 ODP
     I                                        2   2 IM
     I                                        3   4 Z1
     I                                        5   8 Z2
     I                                        9  12 Z3
     I                                       13  13 PELL
     I                                       14  14 AFFI
     I                                       15  15 AFFIC
     I                                       16  16 AUTCO
     I                                       17  24 PASS
     I                                       25  250TCOEP
     I                                       26  28 OUMEP
     I                                       26  260USIEP
     I                                       27  28 MACEP
     IDS120       DS
     I                                      001 025 LIBTRA
     I                                      026 035 LIBDEV
     I                                      036 065 NOMCLP
     I                                      066 0670ANDEVP
     I                                      068 0710ETUDEP
     I                                      072 0750SEQDEP
     I                                      076 115 BLOC1
     I                                      116 116 MAJVIS
    I*****************  EXTPRI
     I                                      117 1170USA1
     I                                      118 120 PAPA1
     I                                      121 1230GRAA1
     I                                      124 129 REFA1
     I                                      130 1320GRELA1
     I                                      133 1340COUA1
     I                                      135 136 ACOMRV
     I                                      137 1370ATCOEP
     I                                      138 139 AMACEP
     I                                      140 1410AGEEP1
     I                                      142 1430AGEEP2
     I                                      144 1450AGEEP3
     I                                      146 146 ATE1EP
     I                                      147 147 ANE1EP
     I                                      148 1491APE1EP
     I                                      150 150 ATE2EP
     I                                      151 151 ANE2EP
     I                                      152 1531APE2EP
     I                                      154 155 ATOAEP
     I                                      156 1571APOAEP
     I                                      158 158 ATEFEP
     I                                      159 1601APEFEP
     I                                      161 1621AMESEP
     I                                      163 163 ATEMEP
     I                                      164 1651APEMEP
     I                                      166 1660ADPEP
     I                                      167 168 ADF1EP
     I                                      169 170 ADF2EP
     I                                      171 172 ADF3EP
     I                                      173 1770ADS1EP
     I                                      178 1820ADS2EP
     I                                      183 1870ADS3EP
     I                                      188 188 ATV1EP
     I                                      189 1901APV1EP
     I                                      191 1921AMV1EP
     I                                      193 193 AV1EP1
     I                                      194 194 AV1EP2
     I                                      195 195 AV1EP3
     I                                      196 196 ATV2EP
     I                                      197 1981APV2EP
     I                                      199 2001AMV2EP
     I                                      201 201 AV2EP1
     I                                      202 202 AV2EP2
     I                                      203 203 AV2EP3
     I                                      204 204 ATV3EP
     I                                      205 2061APV3EP
     I                                      207 2081AMV3EP
     I                                      209 209 AV3EP1
     I                                      210 210 AV3EP2
     I                                      211 211 AV3EP3
     I                                      212 212 ADPREP
     I                                      213 213 ATGEP
     I                                      214 214 AGGEP
     I                                      215 215 ADDEP
     I                                      216 216 ADAEP
     I                                      217 217 ATSSEP
     I                                      218 218 ATMEP
    I*****************  EXTREP
     I                                      219 2200AGEER1
     I                                      221 2220AGEER2
     I                                      223 2240AGEER3
     I                                      225 225 ATE1ER
     I                                      226 226 ANE1ER
     I                                      227 2281APE1ER
     I                                      229 229 ATE2ER
     I                                      230 230 ANE2ER
     I                                      231 2321APE2ER
     I                                      233 234 ATOAER
     I                                      235 2361APOAER
     I                                      237 237 ATEFER
     I                                      238 2391APEFER
     I                                      240 2411AMESER
     I                                      242 242 ATEMER
     I                                      243 2441APEMER
     I                                      245 2450ADPER
     I                                      246 247 ADF1ER
     I                                      248 249 ADF2ER
     I                                      250 251 ADF3ER
     I                                      252 2560ADS1ER
     I                                      257 2610ADS2ER
     I                                      262 2660ADS3ER
     I                                      267 267 ATV1ER
     I                                      268 2691APV1ER
     I                                      270 2711AMV1ER
     I                                      272 272 AV1ER1
     I                                      273 273 AV1ER2
     I                                      274 274 AV1ER3
     I                                      275 275 ATV2ER
     I                                      276 2771APV2ER
     I                                      278 2791AMV2ER
     I                                      280 280 AV2ER1
     I                                      281 281 AV2ER2
     I                                      282 282 AV2ER3
     I                                      283 283 ATV3ER
     I                                      284 2851APV3ER
     I                                      286 2871AMV3ER
     I                                      288 288 AV3ER1
     I                                      289 289 AV3ER2
     I                                      290 290 AV3ER3
     I                                      291 291 ADPRER
     I                                      292 292 ATGER
     I                                      293 293 AGGER
     I                                      294 294 ADDER
     I                                      295 295 ADAER
     I                                      296 296 ATSSER
     I                                      297 297 ATMER
    I*****************  INTPRI
     I                                      298 2980USA2
     I                                      299 301 PAPA2
     I                                      302 3040GRAA2
     I                                      305 310 REFA2
     I                                      311 3130GRELA2
     I                                      314 3150COUA2
     I                                      316 3170AGEIP1
     I                                      318 3190AGEIP2
     I                                      320 3210AGEIP3
     I                                      322 322 ATE1IP
     I                                      323 323 ANE1IP
     I                                      324 3251APE1IP
     I                                      326 326 ATE2IP
     I                                      327 327 ANE2IP
     I                                      328 3291APE2IP
     I                                      330 331 ATOAIP
     I                                      332 3331APOAIP
     I                                      334 334 ATEFIP
     I                                      335 3361APEFIP
     I                                      337 3381AMESIP
     I                                      339 339 ATEMIP
     I                                      340 3411APEMIP
     I                                      342 3420ADPIP
     I                                      343 344 ADF1IP
     I                                      345 346 ADF2IP
     I                                      347 348 ADF3IP
     I                                      349 3530ADS1IP
     I                                      354 3580ADS2IP
     I                                      359 3630ADS3IP
     I                                      364 364 ATV1IP
     I                                      365 3661APV1IP
     I                                      367 3681AMV1IP
     I                                      369 369 AV1IP1
     I                                      370 370 AV1IP2
     I                                      371 371 AV1IP3
     I                                      372 372 ATV2IP
     I                                      373 3741APV2IP
     I                                      375 3761AMV2IP
     I                                      377 377 AV2IP1
     I                                      378 378 AV2IP2
     I                                      379 379 AV2IP3
     I                                      380 380 ATV3IP
     I                                      381 3821APV3IP
     I                                      383 3841AMV3IP
     I                                      385 385 AV3IP1
     I                                      386 386 AV3IP2
     I                                      387 387 AV3IP3
     I                                      388 388 ATGIP
     I                                      389 389 AGGIP
     I                                      390 390 ADDIP
     I                                      391 391 ADAIP
     I                                      392 392 ATSSIP
     I                                      393 393 ATMIP
    I*****************  INTREP
     I                                      394 3950AGEIR1
     I                                      396 396 ATE1IR
     I                                      397 397 ANE1IR
     I                                      398 3991APE1IR
     I                                      400 4011AMESIR
     I                                      402 402 ATV1IR
     I                                      403 4041APV1IR
     I                                      405 4061AMV1IR
    I*****************  DIVERS
     I                                      407 4100FORL
     I                                      411 4140FORH
     I                                      415 4150IMPA1
     I                                      416 4160IMPA2
     I                                      417 4170ZOUEXR
     I                                      418 418 CODDOR
     I                                      419 420 CODRET
     I                                      421 421 DEAFPR
     I                                      422 4220OSIMAC
     I                                      423 423 UV1
    I*****************  DORURE A FROID PRODUITS
     I                                      424 427 ADT1EP
     I                                      428 4300ADL1EP
     I                                      431 434 ADT2EP
     I                                      435 4370ADL2EP
     I                                      438 441 ADT3EP
     I                                      442 4440ADL3EP
     I                                      445 448 ADT1IP
     I                                      449 4510ADL1IP
     I                                      452 455 ADT2IP
     I                                      456 4580ADL2IP
     I                                      459 462 ADT3IP
     I                                      463 4650ADL3IP
     I                                      466 469 ADT1ER
     I                                      470 4720ADL1ER
     I                                      473 476 ADT2ER
     I                                      477 4790ADL2ER
     I                                      480 483 ADT3ER
     I                                      484 4860ADL3ER
    I*****************  REFERENCE CLICHÉ SPECIFIQUE AFFICHE PRODUIT
     I                                      487 492 CLIA1
     I                                      493 493 INDPA1
     I                                      494 499 CLIA2
     I                                      500 500 INDPA2
     *
     I/COPY QRPGSRC,XVERDS
     I/COPY QRPGSRC,XTRADS
     I/COPY QRPGSRC,XENCDS
     I/COPY QRPGSRC,XORCDS
     I/COPY QRPGSRC,XFLUDS
     I/COPY QRPGSRC,XCOLDS
     I/COPY QRPGSRC,XDECDS
     I/COPY QRPGSRC,XTIMDS
     IXPOOAR      DS
     I                                        1  10 XPOOKE
     I                                        1   1 XPOOA1                USINE
     I                                        2   2 SECT
     I                                        3   3 SSECT
     I                                        4   5 NOMAC
     IXPOOS1      DS
     I                                       02  03 XPOO01                MAC 1
     IDSPOP       DS
     I                                        1   1 OP0
     I                                        2   20STPOP
     I                                        3   60NOCPOP
     I                                        7  100NOPPOP
     I                                       11  18 MPASSE
    C*
     IDSPARM      DS
     I                                        1   8 TBLNOM
     I                                        9  18 TBVAR
     I                                       19  200LG
     I                                       21  30 CODE
     I                                       31  80 LIBEL
     I                                       81  81 FICH
    C*
     IàINFDS      DS
     I                                    B 370 3710£CURSO
     *
     C           KPRO      KLIST
     C                     KFLD           NOCLI
     C                     KFLD           PRODOR
    C*
     C           KPROX     KLIST
     C                     KFLD           NOCLI
     C                     KFLD           PRODOR
     C                     KFLD           NOPRO
    C*
     C           KPROW     KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           PRODOR
    C*
     C           KDEV      KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
    C*
     C           KPREI     KLIST
     C                     KFLD           PI1     40
     C                     KFLD           PI2     40
     *  CLE D'ACCES FICHIER PARAME
     C           CLE3      KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *  CLE D'ACCES FICHIER MATPRE
     C           CLE4      KLIST
     C                     KFLD           PAPI    3
     C                     KFLD           GRAM    30
     C                     KFLD           REFOUR  6
     C                     KFLD           GRAREL  30
     *  CLE D'ACCES FICHIER CXHLIG
     C           CLE4B     KLIST
     C                     KFLD           QUACXH
     C                     KFLD           GRACXH
     C                     KFLD           ADPCXH
     C                     KFLD           ADGCXH
     *  CLE D'ACCES FICHIER XTBASE01
     C           KTBA01    KLIST
     C                     KFLD           TBLNOM
     C                     KFLD           TBVARG
     C                     KFLD           TBNSEG
     *  CLE D'ACCES PRODST5
     C           KPST5     KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           PAPA
     C                     KFLD           GRAA
     C                     KFLD           REFA
     C                     KFLD           GRELA
     C           KPST5B    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
    C*
     C           CLEMAC    KLIST
     C                     KFLD           USZ     10
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     * - Clé d'accès à PREACFI
     C           KPREAC    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           SECTFT
     C                     KFLD           SSECFT
    C*
     C           *ENTRY    PLIST
     C                     PARM           PARAM
     *
     C                     CLEARDS120
     *
     C                     MOVE '0'       *IN58
     C           AUTCO     COMP '*'                  8888
     C           IM        COMP 'I'                      30
D1  C           ODP       IFEQ 'P'
     C                     MOVE '1'       *IN58
     C                     EXSR PREPA
X1  C                     ELSE
     C                     MOVE Z1        ANDEV
     C                     MOVE Z2        ETUDE
     C                     MOVE Z3        SEQDE
D2  C           ODP       IFEQ 'O'
     C           KDEV      CHAINOFFRES2              01
X2  C                     ELSE
     C           KDEV      CHAINDEVIS2               01
F2  C                     END
F1  C                     END
     C                     MOVE ' '       PLUS1
     C                     MOVE ' '       PLUS2
D1  C           IMPA1     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA1     PXVALE    P
     C           CLE3      CHAINPARAME               90
     C                     MOVELPXLIBE    LIMPA1
D2  C           IMPA1     IFEQ 2
     C                     MOVE REFA1     CXH     3 P
D3  C           CXH       IFEQ 'CXH'
     C                     MOVE '+'       PLUS1
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           GAUF11    IFNE *BLANKS
    C           MASS11    ORNE *BLANKS
    C           SSINT1    ORNE *BLANKS
    C           CXHAI1    ORNE *BLANKS
    C           RASPA1    ORNE *ZEROS
    C           SCO1A1    ORNE *BLANKS
    C           SCO2A1    ORNE *BLANKS
    C           SCO3A1    ORNE *BLANKS
    C           MASA1L    ORNE *ZEROS
    C           £CODDO    ORNE *BLANKS
     C                     MOVE '+'       PLUS1
F1  C                     END
D1  C           IMPA2     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA2     PXVALE    P
     C           CLE3      CHAINPARAME               90
     C                     MOVELPXLIBE    LIMPA2
D2  C           IMPA2     IFEQ 2
     C                     MOVE REFA2     CXH     3 P
D3  C           CXH       IFEQ 'CXH'
     C                     MOVE '+'       PLUS2
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           GAUF12    IFNE *BLANKS
    C           MASS12    ORNE *BLANKS
    C           SSINT2    ORNE *BLANKS
    C           CXHAI2    ORNE *BLANKS
    C           RASPA2    ORNE *ZEROS
    C           SCO1A2    ORNE *BLANKS
    C           SCO2A2    ORNE *BLANKS
    C           SCO3A2    ORNE *BLANKS
    C           MASA2L    ORNE *ZEROS
    C           $CODDO    ORNE *BLANKS
     C                     MOVE '+'       PLUS2
F1  C                     END
     C/SPACE 3
     *          ---------------
     *          PELLICULLAGE
     *          ---------------
D1  C           PELL      IFEQ '*'
     C           ST01      TAG
    C*          ---------------
     C                     EXFMTWA
    C           *IN12     CABEQ'1'       FINPG
D2  C           *IN30     IFEQ '0'
D3  C           AVANT     IFEQ *BLANK
    C           APRES     ANDEQ*BLANK
    C           AVANT     OREQ '*'
    C           APRES     ANDEQ'*'
     C                     SETON                     51
    C                     GOTO ST01
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 3
     *          ---------------
     *          AFFICHAGE
     *          ---------------
D1  C           AFFI      IFEQ '*'
     C                     SETOF                     31
     C                     MOVE PLUS1     SVPLU1  1
     C                     MOVE PLUS2     SVPLU2  1
     C           ST02      TAG
    C*          ---------------
D2  C           IMPA1     IFEQ 4
    C           IMPA2     OREQ 4
     C                     MOVE '1'       *IN65            DONNÉES OFFSET
     * OFFSET SELECTIONNÉ DANS LE DEVIS (PASSÉE EN PARAMETRE)
     * SINON CELLE DE L'AFFICHE (TCOEP = 9)
     * USINE DE LA MACHINE AFFICHE STOKÉE DANS MATA1M (DEVIS/OFFRE)
     *                                         AUSIP POUR PRODUIT
D3  C           TCOEP     IFNE 9                          SELECT° DU DEVIS
D4  C           ODP       IFNE 'P'
     C                     MOVE MACEP     AMACEP
     C                     Z-ADDTCOEP     ATCOEP
X4  C                     ELSE
     C                     Z-ADDATCOP     ATCOEP
     C                     Z-ADDAUSIP     USIEP
     C                     MOVE AMACP     AMACEP
F4  C                     END
X3  C                     ELSE                            SELECT° DE L'AFFICHE
D4  C           ODP       IFNE 'P'
     C                     Z-ADDMATA1M    USIEP
F4  C                     END
F3  C                     END
     *
     C                     MOVEL'OFCO'    PXARGU
     C                     MOVE ATCOEP    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LCOEP
     C                     MOVEL'OFMA'    PXARGU
     C                     MOVE AMACEP    MACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LMAC
D3  C           ODP       IFNE 'P'
     C                     Z-ADDUSIEP     MATA1M
F3  C                     END
X2  C                     ELSE
     C                     MOVE '0'       *IN65
F2  C                     END
     C                     Z-ADDIMPA1     IMPA1S  10
     C                     Z-ADDIMPA2     IMPA2S  10
     * GESTION DU LIBELLÉ 'SELECTIN PAR F4'
D2  C           TCOEP     IFEQ 9
    C           IM        ANDEQ'M'
     * SIL EXISTE UNE FICHE TECHNIQUE, LA CONFIG NE DOIT PAS CHANGER
     C                     MOVE '1'       SECTFT
     C                     MOVE '4'       SSECFT
     C           KPREAC    SETLLPREACFI2                 50
     C  N50                MOVE '1'       *IN33
     C   50                MOVE '0'       *IN33
X2  C                     ELSE
     C                     MOVE '0'       *IN33
F2  C                     END
     C                     EXFMTWB
    C           *IN12     CABEQ'1'       FINPG
    C           IMPA1     CABNEIMPA1S    ST02
    C           IMPA2     CABNEIMPA2S    ST02
     *  AIDE SI PAS DE SELECTION DEPUIS LE DEVIS ( ET PAS EN INTERRO)
D2  C           *IN07     IFEQ '1'
D3  C           *IN33     IFEQ '1'
     C                     EXSR TRTAID
F3  C                     END
    C                     GOTO ST02
F2  C                     END
D2  C           SVPLU1    IFNE *BLANKS
    C           PLUS1     ANDEQ*BLANKS
     C                     MOVE SVPLU1    PLUS1
F2  C                     END
D2  C           SVPLU2    IFNE *BLANKS
    C           PLUS2     ANDEQ*BLANKS
     C                     MOVE SVPLU2    PLUS2
F2  C                     END
D2  C           *IN58     IFEQ '1'                        PRODUITS
D3  C           *IN30     IFEQ '1'
     C                     MOVE *BLANKS   MPASSE
X3  C                     ELSE
     C                     MOVELPASS      MPASSE
F3  C                     END
D3  C           *IN15     IFEQ '1'
D4  C           NOPAFE    IFNE *ZEROS
     C                     MOVE 'O'       OP0
     C                     MOVE STE       STPOP
     C                     MOVE NOCLI     NOCPOP
     C                     MOVE NOPAFE    NOPPOP
     C                     CALL 'LAN015£'
     C                     PARM           DSPOP
F4  C                     END
    C                     GOTO ST02
F3  C                     END
D3  C           *IN16     IFEQ '1'
D4  C           NOPAFI    IFNE *ZEROS
     C                     MOVE 'O'       OP0
     C                     MOVE STE       STPOP
     C                     MOVE NOCLI     NOCPOP
     C                     MOVE NOPAFI    NOPPOP
     C                     CALL 'LAN015£'
     C                     PARM           DSPOP
F4  C                     END
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*  EXTERIEUR
    C*  PAPIER
    C*-------------------------
D2  C           PAPA1     IFNE *BLANKS
    C           GRAA1     ORNE *ZEROS
    C           REFA1     ORNE *BLANKS
    C           GRELA1    ORNE *ZEROS
     C                     MOVELPAPA1     PAPI
     C                     Z-ADDGRAA1     GRAM
     C                     MOVELREFA1     REFOUR
     C                     MOVELGRELA1    GRAREL
     C                     MOVE REFA1     CXH     3
D3  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             78
    C   78                GOTO ST02                       MESSAGE 28
    C*
D4  C           CATEGO    IFGT 'B'
D5  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X5  C                     ELSE
     C                     MOVEL'20'      VALSA
F5  C                     END
     C                     MOVE VALAN     VALSA   40
D5  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     71
    C  N30                GOTO ST02                       MESSAGE 29
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
     C           CLE4      CHAINCXHENTL1             78
     C  N78      CXHUTI    COMP 'N'                      78
    C   78                GOTO ST02                       MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     78
    C   78                GOTO ST02                       MESSAGE 28
    C           LAIA1     CABNE0         ST02       2222
F3  C                     END
    C*  DIMENSIONS
    C*-------------------------
D3  C           LA1       IFEQ *ZEROS
    C           HA1       OREQ *ZEROS
     C                     SETON                     77
    C                     GOTO ST02
F3  C                     END
     *
X2  C                     ELSE
D3  C           LA1       IFNE *ZEROS
    C           HA1       ORNE *ZEROS
    C           LAIA1     ORNE *ZEROS
    C           IMPA1     ORNE *ZEROS
     C                     SETON                     77
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*   IMPRESSION
    C*-------------------------
D2  C           IMPA1     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA1     PXVALE    P
     C           CLE3      CHAINPARAME               73    MESSAGE 92
    C   73                GOTO ST02
     C                     MOVELPXLIBE    LIMPA1
D3  C           IMPA1     IFEQ 2
    C           LAIA1     ANDEQ*ZEROS
     C                     SETON                     77
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*   PRE IMPRIME
    C*-------------------------
D2  C           PI1A1     IFNE *BLANKS
D3  C           PAPA1     IFNE *BLANKS
     C                     SETON                     93
    C                     GOTO ST02
F3  C                     END
     C                     MOVE PI1A1     PI1
     C                     MOVE PI2A1     PI2
     C           KPREI     CHAINPREIMP2              89
     C  N89      TIMPS     COMP 4                    8989
    C   89                GOTO ST02
     C                     Z-ADDFORLS     SLA1    40
     C                     Z-ADDFORHS     SHA1    40
F2  C                     END
    C*   SI +
    C*-------------------------
D2  C           PLUS1     IFNE *BLANKS
D3  C           PAPA1     IFEQ *BLANKS
    C           PI1A1     ANDEQ*BLANKS
     C                     SETON                     62
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*  INTERIEUR
    C*  PAPIER
    C*-------------------------
D2  C           PAPA2     IFNE *BLANKS
    C           GRAA2     ORNE *ZEROS
    C           REFA2     ORNE *BLANKS
    C           GRELA2    ORNE *ZEROS
     C                     MOVELPAPA2     PAPI
     C                     Z-ADDGRAA2     GRAM
     C                     MOVELREFA2     REFOUR
     C                     MOVELGRELA2    GRAREL
     C                     MOVE REFA1     CXH
D3  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             79
    C   78                GOTO ST02                       MESSAGE 28
    C*
D4  C           CATEGO    IFGT 'B'
D5  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X5  C                     ELSE
     C                     MOVEL'20'      VALSA
F5  C                     END
     C                     MOVE VALAN     VALSA   40
D5  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     72
    C                     GOTO ST02                       MESSAGE 29
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
     C           CLE4      CHAINCXHENTL1             79
     C  N78      CXHUTI    COMP 'N'                      79
    C   78                GOTO ST02                       MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     79
    C   78                GOTO ST02                       MESSAGE 28
F3  C                     END
    C*  DIMENSIONS
    C*-------------------------
D3  C           LA2       IFEQ *ZEROS
    C           HA2       OREQ *ZEROS
     C                     SETON                     76
    C                     GOTO ST02
F3  C                     END
     *
X2  C                     ELSE
D3  C           LA2       IFNE *ZEROS
    C           HA2       ORNE *ZEROS
    C           LAIA2     ORNE *ZEROS
    C           IMPA2     ORNE *ZEROS
     C                     SETON                     76
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*   IMPRESSION
    C*-------------------------
D2  C           IMPA2     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA2     PXVALE    P
     C           CLE3      CHAINPARAME               74    MESSAGE 92
    C   73                GOTO ST02
     C                     MOVELPXLIBE    LIMPA2
D3  C           IMPA2     IFEQ 2
    C           LAIA2     ANDEQ*ZEROS
     C                     SETON                     76
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*   PRE IMPRIME
    C*-------------------------
D2  C           PI1A2     IFNE *BLANKS
D3  C           PAPA2     IFNE *BLANKS
     C                     SETON                     96
    C                     GOTO ST02
F3  C                     END
     C                     MOVE PI1A2     PI1
     C                     MOVE PI2A2     PI2
     C           KPREI     CHAINPREIMP2              94
     C  N94      TIMPS     COMP 4                    9494
    C   94                GOTO ST02
     C                     Z-ADDFORLS     SLA2    40
     C                     Z-ADDFORHS     SHA2    40
F2  C                     END
    C*   SI +
    C*-------------------------
D2  C           PLUS2     IFNE *BLANKS
D3  C           PAPA2     IFEQ *BLANKS
    C           PI1A2     ANDEQ*BLANKS
     C                     SETON                     64
    C                     GOTO ST02
F3  C                     END
F2  C                     END
     *
D2  C           VAVR      IFEQ '*'
D3  C           PAPA1     IFEQ *BLANKS
    C           PAPA2     OREQ *BLANKS
     C                     SETON                     66
    C                     GOTO ST02
F3  C                     END
F2  C                     END
    C*
D2  C           PAPA1     IFEQ *BLANKS
    C           PAPA2     ANDEQ*BLANKS
    C           PI1A1     ANDEQ*BLANKS
    C           PI1A2     ANDEQ*BLANKS
     C                     SETON                     68
    C                     GOTO ST02
F2  C                     END
     *
    C*   SI AFFICHES EN PELCXH
    C*----------------------------------
     *
     C                     MOVELREFA1     PEL1    3 P
     C                     MOVELREFA2     PEL2    3 P
D2  C           PEL1      IFEQ 'PEL'
     C                     MOVE 'E'       EIPEL   1
     C                     EXSR PREWH
     C           STWH1     TAG
    C*          ---------------
     C                     EXFMTWH
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERWH
    C           *IN40     CABEQ'1'       STWH1
     C                     EXSR MAJWH
F2  C                     END
     *
D2  C           PEL2      IFEQ 'PEL'
     C                     MOVE 'I'       EIPEL   1
     C                     EXSR PREWH
     C           STWH2     TAG
    C*          ---------------
     C                     EXFMTWH
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERWH
    C           *IN40     CABEQ'1'       STWH2
     C                     EXSR MAJWH
F2  C                     END
     *
    C*   SI UNE DES AFFICHES IMPRIMEE EN 3B
    C*--------------------------------------
     *
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
    C           IMPA2     OREQ 4
    C           ATCOEP    ANDGT0
D3  C           IM        IFEQ 'I'                        INTERRO/VISU
     C                     MOVE 'V'       MAJVIS
X3  C                     ELSE
     C                     MOVE 'M'       MAJVIS           MAJ
F3  C                     END
     C  N58                MOVE 'A'       DEAFPR
     C   58                MOVE 'F'       DEAFPR
     C                     MOVELTL,3      LIBTRA
     C                     Z-ADDUSIEP     OSIMAC
     C  N58                MOVE ANDEV     ANDEVP
     C  N58                MOVE ETUDE     ETUDEP
     C  N58                MOVE SEQDE     SEQDEP
     C   58                MOVE STE       ANDEVP
     C   58                MOVE NOCLI     ETUDEP
     C   58                MOVE NOPRO     SEQDEP
     * RAZ ET RAB DES DONNÉES NON UTILISÉES
     C                     EXSR SSIMP
     C                     CALL 'DEV120£'
     C                     PARM           DS120
    C           CODRET    CABEQ'KO'      ST02
      * CALCUL DES DONNÉES REPIQUAGE EXT ET INT
     C           IMPA1     IFEQ 4
     C           ATE1ER    IFNE ' '
     C           ATV1ER    ORNE ' '
     C                     MOVE IMPA1     RIMA11
     C                     Z-ADDAGEER1    COUA1R
     C                     Z-ADDAGEER1    GRPA1R
     C                     ELSE
     C                     MOVE *BLANK    RIMA11
     C                     Z-ADD*ZEROS    COUA1R
     C                     Z-ADD*ZEROS    GRPA1R
     C                     END
     C                     ELSE
     C                     MOVE *BLANK    RIMA11
     C                     Z-ADD*ZEROS    COUA1R
     C                     Z-ADD*ZEROS    GRPA1R
     C                     END
     C           IMPA2     IFEQ 4
     C           ATE1IR    IFNE ' '
     C           ATV1IR    ORNE ' '
     C                     MOVE IMPA2     RIMA12
     C                     Z-ADDAGEIR1    COUA2R
     C                     Z-ADDAGEIR1    GRPA2R
     C                     ELSE
     C                     MOVE *BLANK    RIMA12
     C                     Z-ADD*ZEROS    COUA2R
     C                     Z-ADD*ZEROS    GRPA2R
     C                     END
     C                     ELSE
     C                     MOVE *BLANK    RIMA12
     C                     Z-ADD*ZEROS    COUA2R
     C                     Z-ADD*ZEROS    GRPA2R
     C                     END
X2  C                     ELSE
     C                     EXSR SSIMP
F2  C                     END
     *
     *
    C*   SI UNE DES AFFICHES IMPRIMEE
    C*----------------------------------
D2  C           IMPA1     IFNE *ZEROS
    C           IMPA1     ANDNE4
    C           IMPA1     OREQ 4
    C           ATCOEP    ANDEQ0
    C           IMPA2     ORNE *ZEROS
    C           IMPA2     ANDNE4
    C           IMPA2     OREQ 4
    C           ATCOEP    ANDEQ0
     C                     SETOF                     4142
D3  C           IMPA1     IFNE *ZEROS
     C                     SETON                     41
     C                     EXSR PREIMP
     C           ST03      TAG
    C*          ---------------
     C                     EXFMTWD
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERIMP
    C           *IN40     CABEQ'1'       ST03
     C                     EXSR APIMP
     C                     SETON                     31
F3  C                     END
     *
     C                     SETOF                     41
D3  C           IMPA2     IFNE *ZEROS
     C                     SETON                     42
     C                     EXSR PREIMP
     C           ST04      TAG
    C*          ---------------
     C                     EXFMTWD
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERIMP
    C           *IN40     CABEQ'1'       ST04
     C                     EXSR APIMP
     C                     SETON                     31
F3  C                     END
    C*
     C                     EXSR SSIMP
    C*
X2  C                     ELSE
     C                     SETON                     31
F2  C                     END
     *
     * SI + EXTERIEUR
     * -------------------------
D2  C           PLUS1     IFEQ '+'
     C                     SETON                         81
     C                     SETOF                         8260
     C                     EXSR PREWE
D3  C           IMPA1     IFEQ 2
     C                     MOVE REFA1     CXH
D4  C           CXH       IFEQ 'CXH'
     C                     SETON                         60
F4  C                     END
F3  C                     END
     C           ST06      TAG
    C*          ---------------
     C                     EXFMTWE
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERPLU
    C           *IN40     CABEQ'1'       ST06
     C                     EXSR APPLUS
     *
     * SI DORURE EXTERIEUR
     * ---------------------------
D3  C           XODDOR    IFEQ '*'
     C                     SETON                         81
     C                     SETOF                         82
     C                     EXSR PREWI
     C           ST10      TAG
    C*          ---------------
     C  N58                EXFMTWI
     C   58                EXFMTWIP
    C           *IN12     CABEQ'1'       ST02
    C   58      *IN07     CASEQ'1'       TRTAID         20
    C                     END
    C           *IN20     CABEQ'1'       ST10
     *
     C  N58N30             EXSR VERDOR
     C   58N30             EXSR VERDOP
    C           ERRDOR    CABNE*BLANKS   ST10
     C                     EXSR APPDOR
X3  C                     ELSE
     C                     EXSR RZDOR
F3  C                     END
     * SI SOUS TRAITANCE EXTERIEUR
     * ---------------------------
D3  C           XOPST     IFEQ '*'
     C                     SETON                         81
     C                     SETOF                         82
     C                     EXSR PREWG
     C           ST08      TAG
    C*          ---------------
     C                     EXFMTWG
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERST
    C           *IN40     CABEQ'1'       ST08
     C                     EXSR APPST
X3  C                     ELSE
     C                     EXSR RZST
F3  C                     END
     *
X2  C                     ELSE
     C                     SETON                         81
     C                     SETOF                         82
     C                     EXSR RZPLUS
     C                     EXSR RZST
     C                     EXSR RZDOR
F2  C                     END
     *
     * Test OFFSET HORS STANDARDS
     C                     Z-ADDLA1       FFORL   40
     C                     Z-ADDHA1       FFORH   40
     C                     MOVE TIMPE1    WIMPEX  10
     C                     MOVE TVEE1     WVEEX   1
     C                     MOVE UVEX1     WVEXT   1
     C                     MOVE £CODDO    WCODOR  1
     C                     EXSR CTLOFF
     *
     * SI + INTERIEUR
     * -------------------------
D2  C           PLUS2     IFEQ '+'
     C                     SETON                         82
     C                     SETOF                         8160
     C                     EXSR PREWE
     C           ODP       COMP 'P'                      58
D3  C           IMPA2     IFEQ 2
     C                     MOVE REFA2     CXH
D4  C           CXH       IFEQ 'CXH'
     C                     SETON                         60
F4  C                     END
F3  C                     END
     C           ST07      TAG
    C*          ---------------
     C                     EXFMTWE
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERPLU
    C           *IN40     CABEQ'1'       ST07
     C                     EXSR APPLUS
     * SI DORURE INTERIEUR
     * ---------------------------
D3  C           XODDOR    IFEQ '*'
     C                     SETON                         82
     C                     SETOF                         81
     C                     EXSR PREWI
     C           ST11      TAG
    C*          ---------------
     C  N58                EXFMTWI
     C   58                EXFMTWIP
    C           *IN12     CABEQ'1'       ST02
     C  N58N30             EXSR VERDOR
     C   58N30             EXSR VERDOP
    C           ERRDOR    CABNE*BLANKS   ST11
     C                     EXSR APPDOR
X3  C                     ELSE
     C                     EXSR RZDOR
F3  C                     END
     * SI SOUS TRAITANCE INTERIEUR
     * ---------------------------
D3  C           XOPST     IFEQ '*'
     C                     SETON                         82
     C                     SETOF                         81
     C                     EXSR PREWG
     C           ST09      TAG
    C*          ---------------
     C                     EXFMTWG
    C           *IN12     CABEQ'1'       ST02
     C  N30                EXSR VERST
    C           *IN40     CABEQ'1'       ST09
     C                     EXSR APPST
X3  C                     ELSE
     C                     EXSR RZST
F3  C                     END
     *
X2  C                     ELSE
     C                     SETON                         82
     C                     SETOF                         81
     C                     EXSR RZPLUS
     C                     EXSR RZST
     C                     EXSR RZDOR
F2  C                     END
     *
     * Test OFFSET HORS STANDARDS
     C                     Z-ADDLA2       FFORL
     C                     Z-ADDHA2       FFORH
     C                     MOVE TIMPE2    WIMPEX
     C                     MOVE TVEE2     WVEEX
     C                     MOVE UVEX2     WVEXT
     C                     MOVE $CODDO    WCODOR
     C                     EXSR CTLOFF
     *
    C*   PONDERATIONS
    C*------------------------------------
D2  C           IMPA1     IFNE *ZEROS
    C           IMPA2     ORNE *ZEROS
    C           GAUF11    ORNE *BLANKS
    C           GAUF12    ORNE *BLANKS
    C           £CODDO    ORNE *BLANKS
    C           $CODDO    ORNE *BLANKS
     C                     EXSR PREPON
    C*
     C                     EXFMTWF
    C           *IN12     CABEQ'1'       ST02
     C                     EXSR VALPON
F2  C                     END
     *
     * SI PRODUIT : MACHINES
     * -------------------------
D2  C           ODP       IFEQ 'P'
D3  C           IMPA1     IFNE *ZEROS
    C           IMPA2     ORNE *ZEROS
    C*
D4  C           IMPA1     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA1     PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVELPXLIBE    LIBEXP
D5  C           IMPA1     IFEQ 3
    C           USA1      ANDEQ2
     C                     MOVEL'GENCO '  LIBEXP
F5  C                     END
     C                     SETON                     32
F4  C                     END
    C*
D4  C           RIMA11    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMA11    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C                     MOVELPXLIBE    LIBEXR
D5  C           RIMA11    IFEQ 3
    C           USA1      ANDEQ2
     C                     MOVEL'GENCO '  LIBEXR
F5  C                     END
     C                     SETON                     33
F4  C                     END
D4  C           IMPA2     IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE IMPA2     PXVALE    P
     C           CLE3      CHAINPARAME               90
     C                     MOVELPXLIBE    LIBINP
D5  C           IMPA2     IFEQ 3
    C           USA2      ANDEQ2
     C                     MOVEL'GENCO '  LIBINP
F5  C                     END
     C                     SETON                     34
F4  C                     END
    C*
D4  C           RIMA12    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMA12    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C                     MOVELPXLIBE    LIBINR
D5  C           RIMA12    IFEQ 3
    C           USA2      ANDEQ2
     C                     MOVEL'GENCO '  LIBINR
F5  C                     END
     C                     SETON                     35
F4  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USA1      PXVALE    P
     C           CLE3      CHAINPARAME               51
     C  N51                MOVELPXLIBE    LIBUIE
     C                     MOVE USA2      PXVALE    P
     C           CLE3      CHAINPARAME               51
     C  N51                MOVELPXLIBE    LIBUII
     C           ST05      TAG
    C*          ---------------
     C                     EXFMTWC
    C           *IN12     CABEQ'1'       ST02
    C*
     C  N30                EXSR VALMAC
    C           *IN47     CABEQ'1'       ST05
    C*
F3  C                     END
F2  C                     END
     *
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   FIN                                                  *
     *--------------------------------------------------------*
     C           FINPG     TAG
     *          ---------------
D1  C           PAPA1     IFNE *BLANKS
    C           PAPA2     ANDEQ*BLANKS
    C           PI1A2     ANDEQ*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PAPA2     ANDEQ*BLANKS
    C           PI1A2     ANDEQ*BLANKS
     C                     MOVE '1'       AFFIC
F1  C                     END
D1  C           PAPA2     IFNE *BLANKS
    C           PAPA1     ANDEQ*BLANKS
    C           PI1A1     ANDEQ*BLANKS
    C           PI1A2     ORNE *BLANKS
    C           PAPA1     ANDEQ*BLANKS
    C           PI1A1     ANDEQ*BLANKS
     C                     MOVE '2'       AFFIC
F1  C                     END
D1  C           PAPA1     IFNE *BLANKS
    C           PAPA2     ANDNE*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PAPA2     ANDNE*BLANKS
    C           PAPA1     ORNE *BLANKS
    C           PI1A2     ANDNE*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PI1A2     ANDNE*BLANKS
D2  C           VAVR      IFNE '*'
     C                     MOVE '3'       AFFIC
X2  C                     ELSE
     C                     MOVE '4'       AFFIC
F2  C                     END
F1  C                     END
D1  C           *IN30     IFEQ '0'
    C           *IN31     ANDEQ'1'
D2  C           ODP       IFEQ 'O'
     C  N01                UPDATOFFRE2F1
     C   01                WRITEOFFRE2F1
F2  C                     END
D2  C           ODP       IFEQ 'D'
     C  N01                UPDATDEVIS2F1
     C   01                WRITEDEVIS2F1
F2  C                     END
D2  C           ODP       IFEQ 'P'
     C                     EXSR MAJPRO
F2  C                     END
F1  C                     END
    C*
     C                     SETON                     LR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE - COMPOSANT                     *
     *--------------------------------------------------------*
    C           COMCXH    BEGSR
     *          ---------------
     C           CLE4      SETLLCXHLIGL1
     C                     SETOF                     98
    C*
D1  C                     DO   *HIVAL
     C           CLE4      READECXHLIGL1                 50
    C   50                GOTO FCOMCX
D2  C           SUPCXH    IFNE 'F'
     C           CLE4B     CHAINMATPREL1             98
D3  C           CATEGO    IFGT 'B'
    C           *IN98     ANDEQ'0'
D4  C           UYEAR     IFGT VALAN
    C           UYEAR     OREQ VALAN
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     98
F4  C                     END
F3  C                     END
    C   98                GOTO FCOMCX
F2  C                     END
F1  C                     END
    C           FCOMCX    ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION IMPRESSION                  *
     *--------------------------------------------------------*
    C           VERIMP    BEGSR
     *          ---------------
     C                     SETOF                     40
    C* USINE
    C*-------------------------
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               51
     C  N51      PXMONT    COMP 999                      51
    C   51                GOTO TAG41                      MESSAGE 70
     C                     MOVELPXLIBE    LIBUIA
    C*
     C                     MOVE TIMPEX    XTIMA1
     C                     MOVE USEXT     XTIMA2
     C                     MOVELXTIMKE    TBVARG
     C                     MOVEL'XTIMPUSI'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             51
    C   51                GOTO TAG41                      MESSAGE 70
    C*
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D1  C           COUEX     IFEQ *ZEROS
    C           ENCEX     ANDNE*ZEROS
    C           COUEX     ORNE *ZEROS
    C           ENCEX     ANDEQ*ZEROS
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG41
F1  C                     END
D1  C           TIMPEX    IFEQ 3
D2  C           COUEX     IFEQ *ZERO
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG41
F2  C                     END
F1  C                     END
     C/SPACE 2
    C* ENCRE OU VERNIS OBLIGATOIRE
    C*----------------------------
D1  C           COUEX     IFEQ *ZEROS
    C           TVEEX     ANDEQ*BLANKS
     C                     SETON                     91    MESSAGE 149
    C                     GOTO TAG41
F1  C                     END
     C                     Z-ADDCOUEX     GPEX    20
     C/SPACE 2
    C* TRAIT OU SELECTION EXT
    C*-------------------------
D1  C           TSEXT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XTRAA1
     C                     MOVE TSEXT     XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             55    MESSAGE 74
    C           *IN55     CABEQ'1'       TAG41
X1  C                     ELSE
    C           TIMPEX    CABEQ1         TAG41          55MESSAGE 74
F1  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D1  C           GRPEX     IFNE *ZEROS
    C           GRPEX     ANDLTCOUEX
     C                     SETON                     23    MESSAGE 150
    C                     GOTO TAG41
F1  C                     END
D1  C           GRPEX     IFNE *ZEROS
     C                     Z-ADDGRPEX     GPEX    20
X1  C                     ELSE
     C                     Z-ADDCOUEX     GPEX    20
F1  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D1  C           UVEXT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XENCA1
     C                     MOVE UVEXT     XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             57    MESSAGE 76
    C           *IN57     CABEQ'1'       TAG41
F1  C                     END
     C/SPACE 2
    C* NATURE ENCRE
    C*-------------------------
D1  C           NATEX     IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATEX     PXVALE    P
     C           CLE3      CHAINPARAME               57    MESSAGE 76
    C           *IN57     CABEQ'1'       TAG41
F1  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D1  C           TVEEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             59    MESSAGE 78
    C           *IN59     CABEQ'1'       TAG41
    C           CVEEX     CABEQ*ZEROS    TAG41          59MESSAGE 78
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPEX
X1  C                     ELSE
    C           CVEEX     CABNE*ZEROS    TAG41      5959  MESSAGE 78
F1  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D1  C           ORALEX    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XORCA1
     C                     MOVE ORALEX    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             61    MESSAGE 80
    C           *IN61     CABEQ'1'       TAG41
    C           CORALE    CABEQ*ZEROS    TAG41          61MESSAGE 80
    C           CORALE    CABGT1         TAG41      61  61MESSAGE 80
     C                     ADD  1         GPEX
X1  C                     ELSE
    C           CORALE    CABNE*ZEROS    TAG41      6161  MESSAGE 80
F1  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D1  C           FLUEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XFLUA1
     C                     MOVE FLUEX     XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             63    MESSAGE 82
    C           *IN63     CABEQ'1'       TAG41
    C           CFLEX     CABEQ*ZEROS    TAG41          63MESSAGE 82
X1  C                     ELSE
    C           CFLEX     CABNE*ZEROS    TAG41      6363  MESSAGE 82
F1  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D1  C           VSPEX     IFNE *ZEROS
    C           TVEEX     ANDEQ*BLANKS
     C                     SETON                     95
    C                     GOTO TAG41                      MESSAGE 151
F1  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D1  C           DDEEX     IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEEX     PXVALE    P
     C           CLE3      CHAINPARAME               65
    C   65                GOTO TAG41                      MESSAGE 84
F1  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D1  C           DAPEX     IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPEX     PXVALE    P
     C           CLE3      CHAINPARAME               67
    C   67                GOTO TAG41                      MESSAGE 86
    C           TIMPEX    CABNE4         TAG41      6767  MESSAGE 86
F1  C                     END
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*---------------------------------------
D1  C           TIMPEX    IFEQ 4
    C           TIMPEX    OREQ 2
D2  C           GP1EX     IFEQ *ZEROS
    C           GP2EX     ANDNE*ZEROS
    C           GP1EX     OREQ *ZEROS
    C           GP3EX     ANDNE*ZEROS
    C           GP2EX     OREQ *ZEROS
    C           GP3EX     ANDNE*ZEROS
     C                     SETON                     84    MESSAGE 90
    C                     GOTO TAG41
F2  C                     END
     C           GP1EX     ADD  GP2EX     GPT     20
     C                     ADD  GP3EX     GPT
D2  C           GPT       IFGT GPEX
     C                     SETON                     84    MESSAGE 90
    C                     GOTO TAG41
F2  C                     END
X1  C                     ELSE
D2  C           GP1EX     IFNE *ZEROS
    C           GP2EX     ORNE *ZEROS
    C           GP3EX     ORNE *ZEROS
     C                     SETON                     84    MESSAGE 90
    C                     GOTO TAG41
F2  C                     END
F1  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D1  C           MATEC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATEC     PXVALE    P
     C           CLE3      CHAINPARAME               85
    C   85                GOTO TAG41                      MESSAGE 88
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION EXTERIEUR REPIQUAGE                       *
     *--------------------------------------------------------*
D1  C           TIMPEX    IFNE *ZEROS
    C* TYPE IMPRESSION
    C*-------------------------
D2  C           RIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               73    MESSAGE 92
    C   73                GOTO TAG41
     C                     MOVELPXLIBE    LIBIMR
D3  C           RIMPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO '  LIBIMR
F3  C                     END
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D3  C           COUEXR    IFEQ *ZEROS
    C           ENCEXR    ANDNE*ZEROS
    C           COUEXR    ORNE *ZEROS
    C           ENCEXR    ANDEQ*ZEROS
     C                     SETON                     74    MESSAGE 93
    C                     GOTO TAG41
F3  C                     END
D3  C           COUEXR    IFEQ *ZERO
    C           RIMPEX    ANDEQ3
     C                     SETON                     74    MESSAGE 93
    C                     GOTO TAG41
F3  C                     END
     C/SPACE 2
    C* ENCRE OU VERNIS OBIGATOIRE
    C*----------------------------
D3  C           COUEXR    IFEQ *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     92    MESSAGE 149
    C                     GOTO TAG41
F3  C                     END
     C/SPACE 2
    C* TRAIT OU SELECTION
    C*-------------------------
D3  C           TSEXTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XTRAA1
     C                     MOVE TSEXTR    XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             75    MESSAGE 93
    C           *IN75     CABEQ'1'       TAG41
X3  C                     ELSE
    C           RIMPEX    CABEQ1         TAG41          75MESSAGE 93
F3  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D3  C           GRPEXR    IFNE *ZEROS
    C           GRPEXR    ANDLTCOUEXR
     C                     SETON                     24    MESSAGE 150
    C                     GOTO TAG41
F3  C                     END
D3  C           GRPEXR    IFNE *ZEROS
     C                     Z-ADDGRPEXR    GPEXR   20
X3  C                     ELSE
     C                     Z-ADDCOUEXR    GPEXR
F3  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D3  C           UVEXTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XENCA1
     C                     MOVE UVEXTR    XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             76    MESSAGE 95
    C           *IN76     CABEQ'1'       TAG41
F3  C                     END
    C* NATURE ENCRE
    C*-------------------------
D3  C           NATEXR    IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATEXR    PXVALE    P
     C           CLE3      CHAINPARAME               76    MESSAGE 95
    C           *IN76     CABEQ'1'       TAG41
F3  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D3  C           TVEEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             77    MESSAGE 96
    C           *IN77     CABEQ'1'       TAG41
    C           CVEEXR    CABEQ*ZEROS    TAG41          77MESSAGE 96
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPEXR
X3  C                     ELSE
    C           CVEEXR    CABNE*ZEROS    TAG41      7777  MESSAGE 96
F3  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D3  C           ORAEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XORCA1
     C                     MOVE ORAEXR    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             19    MESSAGE 152
    C           *IN19     CABEQ'1'       TAG41
    C           CORAER    CABEQ*ZEROS    TAG41          19MESSAGE 152
    C           CORAER    CABGT1         TAG41      19  19MESSAGE 152
     C                     ADD  1         GPEXR
X3  C                     ELSE
    C           CORAER    CABNE*ZEROS    TAG41      1919  MESSAGE 152
F3  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D3  C           FLUEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XFLUA1
     C                     MOVE FLUEXR    XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             21    MESSAGE 154
    C           *IN21     CABEQ'1'       TAG41
    C           CFLEXR    CABEQ*ZEROS    TAG41          21MESSAGE 154
X3  C                     ELSE
    C           CFLEXR    CABNE*ZEROS    TAG41      2121  MESSAGE 154
F3  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D3  C           VSPEXR    IFNE *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     23
    C                     GOTO TAG41                      MESSAGE 151
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D3  C           DDEEXR    IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEEXR    PXVALE    P
     C           CLE3      CHAINPARAME               78
    C   78                GOTO TAG41                      MESSAGE 97
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D3  C           DAPEXR    IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPEXR    PXVALE    P
     C           CLE3      CHAINPARAME               79
    C   79                GOTO TAG41                      MESSAGE 98
    C           RIMPEX    CABNE4         TAG41      7979  MESSAGE 98
F3  C                     END
     C/SPACE 1
X2  C                     ELSE
D3  C           COUEXR    IFNE *ZEROS
    C           TVEEXR    ORNE *BLANKS
     C                     SETON                     92    MESSAGE 149
    C                     GOTO TAG41
F3  C                     END
F2  C                     END
F1  C                     END
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*---------------------------------------
D1  C           RIMPEX    IFEQ 4
    C           RIMPEX    OREQ 2
D2  C           GP1EXR    IFEQ *ZEROS
    C           GP2EXR    ANDNE*ZEROS
     C                     SETON                     86    MESSAGE 99
    C                     GOTO TAG41
F2  C                     END
     C           GP1EXR    ADD  GP2EXR    GPT     20
D2  C           GPT       IFGT GPEXR
     C                     SETON                     86    MESSAGE 99
    C                     GOTO TAG41
F2  C                     END
X1  C                     ELSE
D2  C           GP1EXR    IFNE *ZEROS
    C           GP2EXR    ORNE *ZEROS
     C                     SETON                     86    MESSAGE 99
    C                     GOTO TAG41
F2  C                     END
F1  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D1  C           MATERC    IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATERC    PXVALE    P
     C           CLE3      CHAINPARAME               87
    C   87                GOTO TAG41                      MESSAGE 100
F1  C                     END
     C/SPACE 1
    C                     GOTO FINSP
    C*
     C           TAG41     TAG
     C                     SETON                     40
    C           FINSP     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION ZONE IMPRESSION                      *
    C* ---------------------------------------------------*
    C           PREIMP    BEGSR
    C*          ---------------
D1  C           *IN41     IFEQ '1'
     C                     MOVELTA,1      NOMECR
     C                     MOVE IMPA1     TIMPEX  10
     C                     MOVE USA1      USEXT
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               51
     C                     MOVELPXLIBE    LIBUIA
     C                     MOVE COUA1     COUEX
     C                     MOVE ENCA1     ENCEX
     C                     MOVE TSA1      TSEXT
     C                     MOVE GRPA1     GRPEX
     C                     MOVE UVA1      UVEXT
     C                     MOVE NATA1     NATEX
     C                     MOVE TVEA1     TVEEX
     C                     MOVE CVEA1     CVEEX
D2  C           ORA1      IFNE *BLANKS
     C                     MOVE ORA1      X1
     C                     MOVELORA1      ORALEX
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALE
X3  C                     ELSE
     C                     MOVE X1        CORALE
F3  C                     END
F2  C                     END
     C                     MOVE FLUA1     FLUEX
     C                     MOVE CFLA1     CFLEX
     C                     MOVE ESPA1     ESPEX
     C                     MOVE VSPA1     VSPEX
     C                     MOVE DDEA1     DDEEX
     C                     MOVE DAPA1     DAPEX
     C                     Z-ADDGP1A1     GP1EX
     C                     Z-ADDGP2A1     GP2EX
     C                     Z-ADDGP3A1     GP3EX
     C                     MOVE MATA1C    MATEC
    C*                    MOVE MATA1M    MATEM
     C                     MOVE RIMA11    RIMPEX  10
     C                     MOVE COUA1R    COUEXR
     C                     MOVE ENCA1R    ENCEXR
     C                     MOVE TSA1R     TSEXTR
     C                     MOVE GRPA1R    GRPEXR
     C                     MOVE UVA1R     UVEXTR
     C                     MOVE NATA1R    NATEXR
     C                     MOVE TVEA1R    TVEEXR
     C                     MOVE CVEA1R    CVEEXR
D2  C           ORA1R     IFNE *BLANKS
     C                     MOVE ORA1R     X1      10
     C                     MOVELORA1R     ORAEXR
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORAER
X3  C                     ELSE
     C                     MOVE X1        CORAER
F3  C                     END
F2  C                     END
     C                     MOVE FLUA1R    FLUEXR
     C                     MOVE CFLA1R    CFLEXR
     C                     MOVE ESPA1R    ESPEXR
     C                     MOVE VSPA1R    VSPEXR
     C                     MOVE DDEA1R    DDEEXR
     C                     MOVE DAPA1R    DAPEXR
     C                     MOVE CLIA1     CLICHP
     C                     MOVE CLIA1R    CLICHR
     C                     Z-ADDGP1A1R    GP1EXR
     C                     Z-ADDGP2A1R    GP2EXR
     C                     MOVE MAA1RC    MATERC
     C                     MOVE MAA1RM    MATERM
     C                     MOVE INDPA1    INDPX
F1  C                     END
D1  C           *IN42     IFEQ '1'
     C                     MOVELTA,2      NOMECR
     C                     MOVE IMPA2     TIMPEX  10
     C                     MOVE USA2      USEXT
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               51
     C                     MOVELPXLIBE    LIBUIA
     C                     MOVE COUA2     COUEX
     C                     MOVE ENCA2     ENCEX
     C                     MOVE TSA2      TSEXT
     C                     MOVE GRPA2     GRPEX
     C                     MOVE UVA2      UVEXT
     C                     MOVE NATA2     NATEX
     C                     MOVE TVEA2     TVEEX
     C                     MOVE CVEA2     CVEEX
D2  C           ORA2      IFNE *BLANKS
     C                     MOVE ORA2      X1
     C                     MOVELORA2      ORALEX
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALE
X3  C                     ELSE
     C                     MOVE X1        CORALE
F3  C                     END
F2  C                     END
     C                     MOVE FLUA2     FLUEX
     C                     MOVE CFLA2     CFLEX
     C                     MOVE ESPA2     ESPEX
     C                     MOVE VSPA2     VSPEX
     C                     MOVE DDEA2     DDEEX
     C                     MOVE DAPA2     DAPEX
     C                     Z-ADDGP1A2     GP1EX
     C                     Z-ADDGP2A2     GP2EX
     C                     Z-ADDGP3A2     GP3EX
     C                     MOVE MATA2C    MATEC
     C                     MOVE MATA2M    MATEM
     C                     MOVE RIMA12    RIMPEX  10
     C                     MOVE COUA2R    COUEXR
     C                     MOVE ENCA2R    ENCEXR
     C                     MOVE TSA2R     TSEXTR
     C                     MOVE GRPA2R    GRPEXR
     C                     MOVE NATA2R    NATEXR
     C                     MOVE TVEA2R    TVEEXR
     C                     MOVE CVEA2R    CVEEXR
D2  C           ORA2R     IFNE *BLANKS
     C                     MOVE ORA2R     X1      10
     C                     MOVELORA2R     ORAEXR
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORAER
X3  C                     ELSE
     C                     MOVE X1        CORAER
F3  C                     END
F2  C                     END
     C                     MOVE FLUA2R    FLUEXR
     C                     MOVE CFLA2R    CFLEXR
     C                     MOVE ESPA2R    ESPEXR
     C                     MOVE VSPA2R    VSPEXR
     C                     MOVE DDEA2R    DDEEXR
     C                     MOVE DAPA2R    DAPEXR
     C                     MOVE CLIA2     CLICHP
     C                     MOVE CLIA2R    CLICHR
     C                     Z-ADDGP1A2R    GP1EXR
     C                     Z-ADDGP2A2R    GP2EXR
     C                     MOVE MAA2RC    MATERC
     C                     MOVE MAA2RM    MATERM
     C                     MOVE INDPA2    INDPX
F1  C                     END
    C*
     C                     MOVEL*BLANKS   LIBUIE
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVELPXLIBE    LIBUIE
    C*
     C                     MOVEL*BLANKS   LIBIMP
D1  C           TIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVELPXLIBE    LIBIMP
D2  C           TIMPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO '  LIBIMP
F2  C                     END
F1  C                     END
    C*
     C                     MOVEL*BLANKS   LIBIMR
D1  C           RIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVELPXLIBE    LIBIMR
D2  C           RIMPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO '  LIBIMR
F2  C                     END
F1  C                     END
    C*
    C* Sauvegarde valeur OFFSET
     C                     EXSR SAVOFF
    C*
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   FIN IMPRESSION                                   *
    C* ---------------------------------------------------*
    C           APIMP     BEGSR
    C*          ---------------
D1  C           *IN41     IFEQ '1'
     C                     MOVE TIMPEX    IMPA1
     C                     MOVE USEXT     USA1
     C                     MOVE COUEX     COUA1
     C                     MOVE ENCEX     ENCA1
     C                     MOVE TSEXT     TSA1
     C                     MOVE GRPEX     GRPA1
     C                     MOVE UVEXT     UVA1
     C                     MOVE NATEX     NATA1
     C                     MOVE TVEEX     TVEA1
     C                     MOVE CVEEX     CVEA1
D2  C           ORALEX    IFNE *BLANKS
D3  C           CORALE    IFEQ 1
     C                     MOVE '0'       ORA1
X3  C                     ELSE
     C                     MOVE CORALE    X1
     C                     MOVE X1        ORA1
F3  C                     END
     C                     MOVELORALEX    ORA1
X2  C                     ELSE
     C                     MOVE *BLANKS   ORA1
F2  C                     END
     C                     MOVE FLUEX     FLUA1
     C                     MOVE CFLEX     CFLA1
     C                     MOVE ESPEX     ESPA1
     C                     MOVE VSPEX     VSPA1
     C                     MOVE DDEEX     DDEA1
     C                     MOVE DAPEX     DAPA1
     C                     Z-ADDGP1EX     GP1A1
     C                     Z-ADDGP2EX     GP2A1
     C                     Z-ADDGP3EX     GP3A1
     C                     MOVE MATEC     MATA1C
    C*                    MOVE MATEM     MATA1M
     C                     Z-ADDGP1EXR    GP1A1R
     C                     Z-ADDGP2EXR    GP2A1R
     C                     MOVE MATERC    MAA1RC
     C                     MOVE MATERM    MAA1RM
     C                     MOVE RIMPEX    RIMA11
     C                     MOVE UVEXTR    UVA1R
     C                     MOVE COUEXR    COUA1R
     C                     MOVE ENCEXR    ENCA1R
     C                     MOVE TSEXTR    TSA1R
     C                     MOVE GRPEXR    GRPA1R
     C                     MOVE NATEXR    NATA1R
     C                     MOVE TVEEXR    TVEA1R
     C                     MOVE CVEEXR    CVEA1R
D2  C           ORAEXR    IFNE *BLANKS
D3  C           CORAER    IFEQ 1
     C                     MOVE '0'       ORA1R
X3  C                     ELSE
     C                     MOVE CORAER    X1
     C                     MOVE X1        ORA1R
F3  C                     END
     C                     MOVELORAEXR    ORA1R
X2  C                     ELSE
     C                     MOVE *BLANKS   ORA1R
F2  C                     END
     C                     MOVE FLUEXR    FLUA1R
     C                     MOVE CFLEXR    CFLA1R
     C                     MOVE ESPEXR    ESPA1R
     C                     MOVE VSPEXR    VSPA1R
     C                     MOVE DDEEXR    DDEA1R
     C                     MOVE DAPEXR    DAPA1R
     C                     MOVE CLICHP    CLIA1
     C                     MOVE CLICHR    CLIA1R
     C                     MOVE INDPX     INDPA1
F1  C                     END
D1  C           *IN42     IFEQ '1'
     C                     MOVE TIMPEX    IMPA2
     C                     MOVE USEXT     USA2
     C                     MOVE COUEX     COUA2
     C                     MOVE ENCEX     ENCA2
     C                     MOVE TSEXT     TSA2
     C                     MOVE GRPEX     GRPA2
     C                     MOVE UVEXT     UVA2
     C                     MOVE NATEX     NATA2
     C                     MOVE TVEEX     TVEA2
     C                     MOVE CVEEX     CVEA2
D2  C           ORALEX    IFNE *BLANKS
D3  C           CORALE    IFEQ 1
     C                     MOVE '0'       ORA2
X3  C                     ELSE
     C                     MOVE CORALE    X1
     C                     MOVE X1        ORA2
F3  C                     END
     C                     MOVELORALEX    ORA2
X2  C                     ELSE
     C                     MOVE *BLANKS   ORA2
F2  C                     END
     C                     MOVE FLUEX     FLUA2
     C                     MOVE CFLEX     CFLA2
     C                     MOVE ESPEX     ESPA2
     C                     MOVE VSPEX     VSPA2
     C                     MOVE DDEEX     DDEA2
     C                     MOVE DAPEX     DAPA2
     C                     Z-ADDGP1EX     GP1A2
     C                     Z-ADDGP2EX     GP2A2
     C                     Z-ADDGP3EX     GP3A2
     C                     MOVE MATEC     MATA2C
     C                     MOVE MATEM     MATA2M
     C                     Z-ADDGP1EXR    GP1A2R
     C                     Z-ADDGP2EXR    GP2A2R
     C                     MOVE MATERC    MAA2RC
     C                     MOVE MATERM    MAA2RM
     C                     MOVE RIMPEX    RIMA12
     C                     MOVE COUEXR    COUA2R
     C                     MOVE ENCEXR    ENCA2R
     C                     MOVE TSEXTR    TSA2R
     C                     MOVE GRPEXR    GRPA2R
     C                     MOVE NATEXR    NATA2R
     C                     MOVE TVEEXR    TVEA2R
     C                     MOVE CVEEXR    CVEA2R
D2  C           ORAEXR    IFNE *BLANKS
D3  C           CORAER    IFEQ 1
     C                     MOVE '0'       ORA2R
X3  C                     ELSE
     C                     MOVE CORAER    X1
     C                     MOVE X1        ORA2R
F3  C                     END
     C                     MOVELORAEXR    ORA2R
X2  C                     ELSE
     C                     MOVE *BLANKS   ORA2R
F2  C                     END
     C                     MOVE FLUEXR    FLUA2R
     C                     MOVE CFLEXR    CFLA2R
     C                     MOVE ESPEXR    ESPA2R
     C                     MOVE VSPEXR    VSPA2R
     C                     MOVE DDEEXR    DDEA2R
     C                     MOVE DAPEXR    DAPA2R
     C                     MOVE CLICHP    CLIA2
     C                     MOVE CLICHR    CLIA2R
     C                     MOVE INDPX     INDPA2
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   SANS IMPRESSION                                  *
    C* ---------------------------------------------------*
    C           SSIMP     BEGSR
    C*          ---------------
D1  C           IMPA1     IFEQ *ZEROS                     SANS IMPEXT
     C                     Z-ADD*ZEROS    COUA1
F1  C                     END
D1  C           IMPA1     IFEQ *ZEROS                     SANS IMPEXT
    C           IMPA1     OREQ 4                          OU OFFSET 3B
    C           ATCOEP    ANDGT0
    C*                    MOVE *BLANKS   USA1
     C                     MOVE *BLANKS   ENCA1
     C                     MOVE *BLANKS   TSA1
     C                     MOVE *BLANKS   GRPA1
     C                     MOVE *BLANKS   UVA1
     C                     MOVE *BLANKS   NATA1
     C                     MOVE *BLANKS   TVEA1
     C                     MOVE *BLANKS   CVEA1
     C                     MOVE *BLANKS   ORA1
     C                     MOVE *BLANKS   FLUA1
     C                     MOVE *BLANKS   CFLA1
     C                     MOVE *BLANKS   ESPA1
     C                     MOVE *BLANKS   VSPA1
     C                     MOVE *BLANKS   DDEA1
     C                     MOVE *BLANKS   DAPA1
     C                     Z-ADD*ZEROS    GP1A1
     C                     Z-ADD*ZEROS    GP2A1
     C                     Z-ADD*ZEROS    GP3A1
     C                     MOVE *BLANKS   MATA1C
    C*                    MOVE *BLANKS   MATA1M
     C                     Z-ADD*ZEROS    GP1A1R
     C                     Z-ADD*ZEROS    GP2A1R
     C                     MOVE *BLANKS   MAA1RC
     C                     MOVE *BLANKS   MAA1RM
     C                     MOVE *BLANKS   RIMA11
     C                     MOVE *BLANKS   COUA1R
     C                     MOVE *BLANKS   ENCA1R
     C                     MOVE *BLANKS   TSA1R
     C                     MOVE *BLANKS   GRPA1R
     C                     MOVE *BLANKS   NATA1R
     C                     MOVE *BLANKS   TVEA1R
     C                     MOVE *BLANKS   CVEA1R
     C                     MOVE *BLANKS   ORA1R
     C                     MOVE *BLANKS   FLUA1R
     C                     MOVE *BLANKS   CFLA1R
     C                     MOVE *BLANKS   ESPA1R
     C                     MOVE *BLANKS   VSPA1R
     C                     MOVE *BLANKS   DDEA1R
     C                     MOVE *BLANKS   DAPA1R
    C*                    MOVE *BLANKS   CLIA1
     C                     MOVE *BLANKS   CLIA1R
F1  C                     END
     *
D1  C           IMPA1     IFEQ *ZEROS                     SANS IMP EXT
    C           IMPA1     OREQ 4                          OU STANDARD
    C           ATCOEP    ANDEQ0
     C                     MOVE *BLANKS   ACOMRV
     C                     MOVE *BLANKS   AMACEP
     C                     Z-ADD*ZEROS    AGEEP1
     C                     Z-ADD*ZEROS    AGEEP2
     C                     Z-ADD*ZEROS    AGEEP3
     C                     MOVE *BLANKS   ATE1EP
     C                     MOVE *BLANKS   ANE1EP
     C                     Z-ADD*ZEROS    APE1EP
     C                     MOVE *BLANKS   ATE2EP
     C                     MOVE *BLANKS   ANE2EP
     C                     Z-ADD*ZEROS    APE2EP
     C                     MOVE *BLANKS   ATOAEP
     C                     Z-ADD*ZEROS    APOAEP
     C                     MOVE *BLANKS   ATEFEP
     C                     Z-ADD*ZEROS    APEFEP
     C                     Z-ADD*ZEROS    AMESEP
     C                     MOVE *BLANKS   ATEMEP
     C                     Z-ADD*ZEROS    APEMEP
     C                     Z-ADD*ZEROS    ADPEP
     C                     MOVE *BLANKS   ADF1EP
     C                     MOVE *BLANKS   ADF2EP
     C                     MOVE *BLANKS   ADF3EP
     C                     Z-ADD*ZEROS    ADS1EP
     C                     Z-ADD*ZEROS    ADS2EP
     C                     Z-ADD*ZEROS    ADS3EP
     C                     MOVE *BLANKS   ATV1EP
     C                     Z-ADD*ZEROS    APV1EP
     C                     Z-ADD*ZEROS    AMV1EP
     C                     MOVE *BLANKS   AV1EP1
     C                     MOVE *BLANKS   AV1EP2
     C                     MOVE *BLANKS   AV1EP3
     C                     MOVE *BLANKS   ATV2EP
     C                     Z-ADD*ZEROS    APV2EP
     C                     Z-ADD*ZEROS    AMV2EP
     C                     MOVE *BLANKS   AV2EP1
     C                     MOVE *BLANKS   AV2EP2
     C                     MOVE *BLANKS   AV2EP3
     C                     MOVE *BLANKS   ATV3EP
     C                     Z-ADD*ZEROS    APV3EP
     C                     Z-ADD*ZEROS    AMV3EP
     C                     MOVE *BLANKS   AV3EP1
     C                     MOVE *BLANKS   AV3EP2
     C                     MOVE *BLANKS   AV3EP3
     C                     MOVE *BLANKS   ADPREP
     C                     MOVE *BLANKS   ATGEP
     C                     MOVE *BLANKS   AGGEP
     C                     MOVE *BLANKS   ADDEP
     C                     MOVE *BLANKS   ADAEP
     C                     MOVE *BLANKS   ATSSEP
     C                     MOVE *BLANKS   ATMEP
    I*****************  EXTREP
     C                     Z-ADD*ZEROS    AGEER1
     C                     MOVE *BLANKS   ATE1ER
     C                     MOVE *BLANKS   ANE1ER
     C                     Z-ADD*ZEROS    APE1ER
     C                     Z-ADD*ZEROS    AMESER
     C                     MOVE *BLANKS   ATV1ER
     C                     Z-ADD*ZEROS    APV1ER
     C                     Z-ADD*ZEROS    AMV1ER
F1  C                     END
D1  C           IMPA2     IFEQ *ZEROS                     SANS IMPEXT
     C                     Z-ADD*ZEROS    COUA2
F1  C                     END
D1  C           IMPA2     IFEQ *ZEROS                     SANS IMP EXT
    C           IMPA2     OREQ 4                          OU OFFSET 3B
    C           ATCOEP    ANDGT0
    C*                    MOVE *BLANKS   IMPA2
     C                     MOVE *BLANKS   ENCA2
     C                     MOVE *BLANKS   TSA2
     C                     MOVE *BLANKS   GRPA2
     C                     MOVE *BLANKS   UVA2
     C                     MOVE *BLANKS   NATA2
     C                     MOVE *BLANKS   TVEA2
     C                     MOVE *BLANKS   CVEA2
     C                     MOVE *BLANKS   ORA2
     C                     MOVE *BLANKS   FLUA2
     C                     MOVE *BLANKS   CFLA2
     C                     MOVE *BLANKS   ESPA2
     C                     MOVE *BLANKS   VSPA2
     C                     MOVE *BLANKS   DDEA2
     C                     MOVE *BLANKS   DAPA2
     C                     Z-ADD*ZEROS    GP1A2
     C                     Z-ADD*ZEROS    GP2A2
     C                     Z-ADD*ZEROS    GP3A2
     C                     MOVE *BLANKS   MATA2C
     C                     MOVE *BLANKS   MATA2M
     C                     Z-ADD*ZEROS    GP1A2R
     C                     Z-ADD*ZEROS    GP2A2R
     C                     MOVE *BLANKS   MAA2RC
     C                     MOVE *BLANKS   MAA2RM
     C                     MOVE *BLANKS   RIMA12
     C                     MOVE *BLANKS   COUA2R
     C                     MOVE *BLANKS   ENCA2R
     C                     MOVE *BLANKS   TSA2R
     C                     MOVE *BLANKS   GRPA2R
     C                     MOVE *BLANKS   NATA2R
     C                     MOVE *BLANKS   TVEA2R
     C                     MOVE *BLANKS   CVEA2R
     C                     MOVE *BLANKS   ORA2R
     C                     MOVE *BLANKS   FLUA2R
     C                     MOVE *BLANKS   CFLA2R
     C                     MOVE *BLANKS   ESPA2R
     C                     MOVE *BLANKS   VSPA2R
     C                     MOVE *BLANKS   DDEA2R
     C                     MOVE *BLANKS   DAPA2R
    C*                    MOVE *BLANKS   CLIA2
     C                     MOVE *BLANKS   CLIA2R
F1  C                     END
    I*****************  INTPRI
D1  C           IMPA2     IFEQ *ZEROS                     SANS IMP EXT
    C           IMPA2     OREQ 4                          OU STANDARD
    C           ATCOEP    ANDEQ0
     C                     Z-ADD*ZEROS    AGEIP1
     C                     Z-ADD*ZEROS    AGEIP2
     C                     Z-ADD*ZEROS    AGEIP3
     C                     MOVE *BLANKS   ATE1IP
     C                     MOVE *BLANKS   ANE1IP
     C                     Z-ADD*ZEROS    APE1IP
     C                     MOVE *BLANKS   ATE2IP
     C                     MOVE *BLANKS   ANE2IP
     C                     Z-ADD*ZEROS    APE2IP
     C                     MOVE *BLANKS   ATOAIP
     C                     Z-ADD*ZEROS    APOAIP
     C                     MOVE *BLANKS   ATEFIP
     C                     Z-ADD*ZEROS    APEFIP
     C                     Z-ADD*ZEROS    AMESIP
     C                     MOVE *BLANKS   ATEMIP
     C                     Z-ADD*ZEROS    APEMIP
     C                     Z-ADD*ZEROS    ADPIP
     C                     MOVE *BLANKS   ADF1IP
     C                     MOVE *BLANKS   ADF2IP
     C                     MOVE *BLANKS   ADF3IP
     C                     Z-ADD*ZEROS    ADS1IP
     C                     Z-ADD*ZEROS    ADS2IP
     C                     Z-ADD*ZEROS    ADS3IP
     C                     MOVE *BLANKS   ATV1IP
     C                     Z-ADD*ZEROS    APV1IP
     C                     Z-ADD*ZEROS    AMV1IP
     C                     MOVE *BLANKS   AV1IP1
     C                     MOVE *BLANKS   AV1IP2
     C                     MOVE *BLANKS   AV1IP3
     C                     MOVE *BLANKS   ATV2IP
     C                     Z-ADD*ZEROS    APV2IP
     C                     Z-ADD*ZEROS    AMV2IP
     C                     MOVE *BLANKS   AV2IP1
     C                     MOVE *BLANKS   AV2IP2
     C                     MOVE *BLANKS   AV2IP3
     C                     MOVE *BLANKS   ATV3IP
     C                     Z-ADD*ZEROS    APV3IP
     C                     Z-ADD*ZEROS    AMV3IP
     C                     MOVE *BLANKS   AV3IP1
     C                     MOVE *BLANKS   AV3IP2
     C                     MOVE *BLANKS   AV3IP3
     C                     MOVE *BLANKS   ATGIP
     C                     MOVE *BLANKS   AGGIP
     C                     MOVE *BLANKS   ADDIP
     C                     MOVE *BLANKS   ADAIP
     C                     MOVE *BLANKS   ATSSIP
     C                     MOVE *BLANKS   ATMIP
    C*****************  INTREP
     C                     Z-ADD*ZEROS    AGEIR1
     C                     MOVE *BLANKS   ATE1IR
     C                     MOVE *BLANKS   ANE1IR
     C                     Z-ADD*ZEROS    APE1IR
     C                     Z-ADD*ZEROS    AMESIR
     C                     MOVE *BLANKS   ATV1IR
     C                     Z-ADD*ZEROS    APV1IR
     C                     Z-ADD*ZEROS    AMV1IR
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION PONDERARTION                         *
    C* ---------------------------------------------------*
    C           PREPON    BEGSR
    C*          ---------------
D1  C           IMPA1     IFNE *ZEROS
     C                     SETON                     32
     C                     Z-ADD1         SS1
     C                     MOVELTLS,1     LSS1
     C                     Z-ADDRETPA1    RETP1
     C                     Z-ADDROCAA1    ROCA1
     C                     Z-ADDPRDIA1    PRDI1
     C                     Z-ADDPRGRA1    PRGR1
     C                     Z-ADDPROUA1    PROU1
     C                     Z-ADDPEFFA1    PEFF1
     C                     Z-ADDPDECA1    PDEC1
F1  C                     END
D1  C           RIMA11    IFNE *ZEROS
     C                     SETON                     33
     C                     Z-ADD2         SS2
     C                     MOVELTLS,2     LSS2
     C                     Z-ADDRETA1R    RETP2
     C                     Z-ADDROCA1R    ROCA2
     C                     Z-ADDPRDA1R    PRDI2
     C                     Z-ADDPRGA1R    PRGR2
     C                     Z-ADDPROA1R    PROU2
     C                     Z-ADDPEFA1R    PEFF2
     C                     Z-ADDPDEA1R    PDEC2
F1  C                     END
D1  C           IMPA2     IFNE *ZEROS
     C                     SETON                     34
     C                     Z-ADD3         SS3
     C                     MOVELTLS,3     LSS3
     C                     Z-ADDRETPA2    RETP3
     C                     Z-ADDROCAA2    ROCA3
     C                     Z-ADDPRDIA2    PRDI3
     C                     Z-ADDPRGRA2    PRGR3
     C                     Z-ADDPROUA2    PROU3
     C                     Z-ADDPEFFA2    PEFF3
     C                     Z-ADDPDECA2    PDEC3
F1  C                     END
D1  C           RIMA12    IFNE *ZEROS
     C                     SETON                     35
     C                     Z-ADD4         SS4
     C                     MOVELTLS,4     LSS4
     C                     Z-ADDRETA2R    RETP4
     C                     Z-ADDROCA2R    ROCA4
     C                     Z-ADDPRDA2R    PRDI4
     C                     Z-ADDPRGA2R    PRGR4
     C                     Z-ADDPROA2R    PROU4
     C                     Z-ADDPEFA2R    PEFF4
     C                     Z-ADDPDEA2R    PDEC4
F1  C                     END
D1  C           GAUF11    IFNE *BLANKS
     C                     SETON                     36
     C                     Z-ADD5         SS5
     C                     MOVELTLS,5     LSS5
     C                     Z-ADDRETPG1    RETP5
     C                     Z-ADDROCAG1    ROCA5
     C                     Z-ADDPRDIG1    PRDI5
     C                     Z-ADDPRGRG1    PRGR5
     C                     Z-ADDPROUG1    PROU5
     C                     Z-ADDPEFFG1    PEFF5
     C                     Z-ADDPDECG1    PDEC5
F1  C                     END
D1  C           GAUF21    IFNE *BLANKS
     C                     SETON                     37
     C                     Z-ADD6         SS6
     C                     MOVELTLS,6     LSS6
     C                     Z-ADDRETPG2    RETP6
     C                     Z-ADDROCAG2    ROCA6
     C                     Z-ADDPRDIG2    PRDI6
     C                     Z-ADDPRGRG2    PRGR6
     C                     Z-ADDPROUG2    PROU6
     C                     Z-ADDPEFFG2    PEFF6
     C                     Z-ADDPDECG2    PDEC6
F1  C                     END
D1  C           GAUF12    IFNE *BLANKS
     C                     SETON                     38
     C                     Z-ADD7         SS7
     C                     MOVELTLS,7     LSS7
     C                     Z-ADDRETPG3    RETP7
     C                     Z-ADDROCAG3    ROCA7
     C                     Z-ADDPRDIG3    PRDI7
     C                     Z-ADDPRGRG3    PRGR7
     C                     Z-ADDPROUG3    PROU7
     C                     Z-ADDPEFFG3    PEFF7
     C                     Z-ADDPDECG3    PDEC7
F1  C                     END
D1  C           GAUF22    IFNE *BLANKS
     C                     SETON                     39
     C                     Z-ADD8         SS8
     C                     MOVELTLS,8     LSS8
     C                     Z-ADDRETPG4    RETP8
     C                     Z-ADDROCAG4    ROCA8
     C                     Z-ADDPRDIG4    PRDI8
     C                     Z-ADDPRGRG4    PRGR8
     C                     Z-ADDPROUG4    PROU8
     C                     Z-ADDPEFFG4    PEFF8
     C                     Z-ADDPDECG4    PDEC8
F1  C                     END
D1  C           £NATP1    IFNE *BLANKS
     C                     SETON                     02
     C                     Z-ADD9         SS9
     C                     MOVELTLS,9     LSS9
     C                     Z-ADDRETPD1    RETP9
     C                     Z-ADDROCAD1    ROCA9
     C                     Z-ADDPRDID1    PRDI9
     C                     Z-ADDPRGRD1    PRGR9
     C                     Z-ADDPROUD1    PROU9
     C                     Z-ADDPEFFD1    PEFF9
     C                     Z-ADDPDECD1    PDEC9
F1  C                     END
D1  C           £NATP2    IFNE *BLANKS
     C                     SETON                     03
     C                     Z-ADD10        SS10
     C                     MOVELTLS,10    LSS10
     C                     Z-ADDRETPD2    RETP10
     C                     Z-ADDROCAD2    ROCA10
     C                     Z-ADDPRDID2    PRDI10
     C                     Z-ADDPRGRD2    PRGR10
     C                     Z-ADDPROUD2    PROU10
     C                     Z-ADDPEFFD2    PEFF10
     C                     Z-ADDPDECD2    PDEC10
F1  C                     END
D1  C           $NATP1    IFNE *BLANKS
     C                     SETON                     04
     C                     Z-ADD11        SS11
     C                     MOVELTLS,11    LSS11
     C                     Z-ADDRETPD3    RETP11
     C                     Z-ADDROCAD3    ROCA11
     C                     Z-ADDPRDID3    PRDI11
     C                     Z-ADDPRGRD3    PRGR11
     C                     Z-ADDPROUD3    PROU11
     C                     Z-ADDPEFFD3    PEFF11
     C                     Z-ADDPDECD3    PDEC11
F1  C                     END
D1  C           $NATP2    IFNE *BLANKS
     C                     SETON                     05
     C                     Z-ADD12        SS12
     C                     MOVELTLS,12    LSS12
     C                     Z-ADDRETPD4    RETP12
     C                     Z-ADDROCAD4    ROCA12
     C                     Z-ADDPRDID4    PRDI12
     C                     Z-ADDPRGRD4    PRGR12
     C                     Z-ADDPROUD4    PROU12
     C                     Z-ADDPEFFD4    PEFF12
     C                     Z-ADDPDECD4    PDEC12
F1  C                     END
D1  C           £NATP3    IFNE *BLANKS
     C                     SETON                     06
     C                     Z-ADD13        SS13
     C                     MOVELTLS,13    LSS13
     C                     Z-ADDRETPDA    RETP13
     C                     Z-ADDROCADA    ROCA13
     C                     Z-ADDPRDIDA    PRDI13
     C                     Z-ADDPRGRDA    PRGR13
     C                     Z-ADDPROUDA    PROU13
     C                     Z-ADDPEFFDA    PEFF13
     C                     Z-ADDPDECDA    PDEC13
F1  C                     END
D1  C           £NATP4    IFNE *BLANKS
     C                     SETON                     10
     C                     Z-ADD14        SS14
     C                     MOVELTLS,14    LSS14
     C                     Z-ADDRETPDB    RETP14
     C                     Z-ADDROCADB    ROCA14
     C                     Z-ADDPRDIDB    PRDI14
     C                     Z-ADDPRGRDB    PRGR14
     C                     Z-ADDPROUDB    PROU14
     C                     Z-ADDPEFFDB    PEFF14
     C                     Z-ADDPDECDB    PDEC14
F1  C                     END
D1  C           $NATP3    IFNE *BLANKS
     C                     SETON                     08
     C                     Z-ADD15        SS15
     C                     MOVELTLS,15    LSS15
     C                     Z-ADDRETPDC    RETP15
     C                     Z-ADDROCADC    ROCA15
     C                     Z-ADDPRDIDC    PRDI15
     C                     Z-ADDPRGRDC    PRGR15
     C                     Z-ADDPROUDC    PROU15
     C                     Z-ADDPEFFDC    PEFF15
     C                     Z-ADDPDECDC    PDEC15
F1  C                     END
D1  C           $NATP4    IFNE *BLANKS
     C                     SETON                     09
     C                     Z-ADD16        SS16
     C                     MOVELTLS,16    LSS16
     C                     Z-ADDRETPDD    RETP16
     C                     Z-ADDROCADD    ROCA16
     C                     Z-ADDPRDIDD    PRDI16
     C                     Z-ADDPRGRDD    PRGR16
     C                     Z-ADDPROUDD    PROU16
     C                     Z-ADDPEFFDD    PEFF16
     C                     Z-ADDPDECDD    PDEC16
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   VALIDATION  PONDERATIONS                         *
    C* ---------------------------------------------------*
    C           VALPON    BEGSR
    C*          ---------------
D1  C           IMPA1     IFNE *ZEROS
     C                     Z-ADD1         SSA1
     C                     Z-ADDRETP1     RETPA1
     C                     Z-ADDROCA1     ROCAA1
     C                     Z-ADDPRDI1     PRDIA1
     C                     Z-ADDPRGR1     PRGRA1
     C                     Z-ADDPROU1     PROUA1
     C                     Z-ADDPEFF1     PEFFA1
     C                     Z-ADDPDEC1     PDECA1
     C                     ELSE
     C                     Z-ADD*ZEROS    SSA1
     C                     Z-ADD*ZEROS    RETPA1
     C                     Z-ADD*ZEROS    ROCAA1
     C                     Z-ADD*ZEROS    PRDIA1
     C                     Z-ADD*ZEROS    PRGRA1
     C                     Z-ADD*ZEROS    PROUA1
     C                     Z-ADD*ZEROS    PEFFA1
     C                     Z-ADD*ZEROS    PDECA1
F1  C                     END
D1  C           RIMA11    IFNE *ZEROS
     C                     Z-ADD2         SSA1R
     C                     Z-ADDRETP2     RETA1R
     C                     Z-ADDROCA2     ROCA1R
     C                     Z-ADDPRDI2     PRDA1R
     C                     Z-ADDPRGR2     PRGA1R
     C                     Z-ADDPROU2     PROA1R
     C                     Z-ADDPEFF2     PEFA1R
     C                     Z-ADDPDEC2     PDEA1R
     C                     ELSE
     C                     Z-ADD*ZEROS    SSA1R
     C                     Z-ADD*ZEROS    RETA1R
     C                     Z-ADD*ZEROS    ROCA1R
     C                     Z-ADD*ZEROS    PRDA1R
     C                     Z-ADD*ZEROS    PRGA1R
     C                     Z-ADD*ZEROS    PROA1R
     C                     Z-ADD*ZEROS    PEFA1R
     C                     Z-ADD*ZEROS    PDEA1R
F1  C                     END
D1  C           IMPA2     IFNE *ZEROS
     C                     Z-ADD3         SSA2
     C                     Z-ADDRETP3     RETPA2
     C                     Z-ADDROCA3     ROCAA2
     C                     Z-ADDPRDI3     PRDIA2
     C                     Z-ADDPRGR3     PRGRA2
     C                     Z-ADDPROU3     PROUA2
     C                     Z-ADDPEFF3     PEFFA2
     C                     Z-ADDPDEC3     PDECA2
     C                     ELSE
     C                     Z-ADD*ZEROS    SSA2
     C                     Z-ADD*ZEROS    RETPA2
     C                     Z-ADD*ZEROS    ROCAA2
     C                     Z-ADD*ZEROS    PRDIA2
     C                     Z-ADD*ZEROS    PRGRA2
     C                     Z-ADD*ZEROS    PROUA2
     C                     Z-ADD*ZEROS    PEFFA2
     C                     Z-ADD*ZEROS    PDECA2
F1  C                     END
D1  C           RIMA12    IFNE *ZEROS
     C                     Z-ADD4         SSA2R
     C                     Z-ADDRETP4     RETA2R
     C                     Z-ADDROCA4     ROCA2R
     C                     Z-ADDPRDI4     PRDA2R
     C                     Z-ADDPRGR4     PRGA2R
     C                     Z-ADDPROU4     PROA2R
     C                     Z-ADDPEFF4     PEFA2R
     C                     Z-ADDPDEC4     PDEA2R
     C                     ELSE
     C                     Z-ADD*ZEROS    SSA2R
     C                     Z-ADD*ZEROS    RETA2R
     C                     Z-ADD*ZEROS    ROCA2R
     C                     Z-ADD*ZEROS    PRDA2R
     C                     Z-ADD*ZEROS    PRGA2R
     C                     Z-ADD*ZEROS    PROA2R
     C                     Z-ADD*ZEROS    PEFA2R
     C                     Z-ADD*ZEROS    PDEA2R
F1  C                     END
D1  C           GAUF11    IFNE *BLANKS
     C                     Z-ADD6         SSG1
     C                     Z-ADDRETP5     RETPG1
     C                     Z-ADDROCA5     ROCAG1
     C                     Z-ADDPRDI5     PRDIG1
     C                     Z-ADDPRGR5     PRGRG1
     C                     Z-ADDPROU5     PROUG1
     C                     Z-ADDPEFF5     PEFFG1
     C                     Z-ADDPDEC5     PDECG1
     C                     ELSE
     C                     Z-ADD*ZEROS    SSG1
     C                     Z-ADD*ZEROS    RETPG1
     C                     Z-ADD*ZEROS    ROCAG1
     C                     Z-ADD*ZEROS    PRDIG1
     C                     Z-ADD*ZEROS    PRGRG1
     C                     Z-ADD*ZEROS    PROUG1
     C                     Z-ADD*ZEROS    PEFFG1
     C                     Z-ADD*ZEROS    PDECG1
F1  C                     END
D1  C           GAUF21    IFNE *BLANKS
     C                     Z-ADD66        SSG2
     C                     Z-ADDRETP6     RETPG2
     C                     Z-ADDROCA6     ROCAG2
     C                     Z-ADDPRDI6     PRDIG2
     C                     Z-ADDPRGR6     PRGRG2
     C                     Z-ADDPROU6     PROUG2
     C                     Z-ADDPEFF6     PEFFG2
     C                     Z-ADDPDEC6     PDECG2
     C                     ELSE
     C                     Z-ADD*ZEROS    SSG2
     C                     Z-ADD*ZEROS    RETPG2
     C                     Z-ADD*ZEROS    ROCAG2
     C                     Z-ADD*ZEROS    PRDIG2
     C                     Z-ADD*ZEROS    PRGRG2
     C                     Z-ADD*ZEROS    PROUG2
     C                     Z-ADD*ZEROS    PEFFG2
     C                     Z-ADD*ZEROS    PDECG2
F1  C                     END
D1  C           GAUF12    IFNE *BLANKS
     C                     Z-ADD6         SSG2
     C                     Z-ADDRETP7     RETPG3
     C                     Z-ADDROCA7     ROCAG3
     C                     Z-ADDPRDI7     PRDIG3
     C                     Z-ADDPRGR7     PRGRG3
     C                     Z-ADDPROU7     PROUG3
     C                     Z-ADDPEFF7     PEFFG3
     C                     Z-ADDPDEC7     PDECG3
     C                     ELSE
     C                     Z-ADD*ZEROS    SSG2
     C                     Z-ADD*ZEROS    RETPG3
     C                     Z-ADD*ZEROS    ROCAG3
     C                     Z-ADD*ZEROS    PRDIG3
     C                     Z-ADD*ZEROS    PRGRG3
     C                     Z-ADD*ZEROS    PROUG3
     C                     Z-ADD*ZEROS    PEFFG3
     C                     Z-ADD*ZEROS    PDECG3
F1  C                     END
D1  C           GAUF22    IFNE *BLANKS
     C                     Z-ADD66        SSG4
     C                     Z-ADDRETP8     RETPG4
     C                     Z-ADDROCA8     ROCAG4
     C                     Z-ADDPRDI8     PRDIG4
     C                     Z-ADDPRGR8     PRGRG4
     C                     Z-ADDPROU8     PROUG4
     C                     Z-ADDPEFF8     PEFFG4
     C                     Z-ADDPDEC8     PDECG4
     C                     ELSE
     C                     Z-ADD*ZEROS    SSG4
     C                     Z-ADD*ZEROS    RETPG4
     C                     Z-ADD*ZEROS    ROCAG4
     C                     Z-ADD*ZEROS    PRDIG4
     C                     Z-ADD*ZEROS    PRGRG4
     C                     Z-ADD*ZEROS    PROUG4
     C                     Z-ADD*ZEROS    PEFFG4
     C                     Z-ADD*ZEROS    PDECG4
F1  C                     END
D1  C           £NATP1    IFNE *BLANKS
     C                     Z-ADD26        SSD1
     C                     Z-ADDRETP9     RETPD1
     C                     Z-ADDROCA9     ROCAD1
     C                     Z-ADDPRDI9     PRDID1
     C                     Z-ADDPRGR9     PRGRD1
     C                     Z-ADDPROU9     PROUD1
     C                     Z-ADDPEFF9     PEFFD1
     C                     Z-ADDPDEC9     PDECD1
     C                     ELSE
     C                     Z-ADD*ZEROS    SSD1
     C                     Z-ADD*ZEROS    RETPD1
     C                     Z-ADD*ZEROS    ROCAD1
     C                     Z-ADD*ZEROS    PRDID1
     C                     Z-ADD*ZEROS    PRGRD1
     C                     Z-ADD*ZEROS    PROUD1
     C                     Z-ADD*ZEROS    PEFFD1
     C                     Z-ADD*ZEROS    PDECD1
F1  C                     END
D1  C           £NATP2    IFNE *BLANKS
     C                     Z-ADD27        SSD2
     C                     Z-ADDRETP10    RETPD2
     C                     Z-ADDROCA10    ROCAD2
     C                     Z-ADDPRDI10    PRDID2
     C                     Z-ADDPRGR10    PRGRD2
     C                     Z-ADDPROU10    PROUD2
     C                     Z-ADDPEFF10    PEFFD2
     C                     Z-ADDPDEC10    PDECD2
     C                     ELSE
     C                     Z-ADD*ZEROS    SSD2
     C                     Z-ADD*ZEROS    RETPD2
     C                     Z-ADD*ZEROS    ROCAD2
     C                     Z-ADD*ZEROS    PRDID2
     C                     Z-ADD*ZEROS    PRGRD2
     C                     Z-ADD*ZEROS    PROUD2
     C                     Z-ADD*ZEROS    PEFFD2
     C                     Z-ADD*ZEROS    PDECD2
F1  C                     END
D1  C           $NATP1    IFNE *BLANKS
     C                     Z-ADD26        SSD3
     C                     Z-ADDRETP11    RETPD3
     C                     Z-ADDROCA11    ROCAD3
     C                     Z-ADDPRDI11    PRDID3
     C                     Z-ADDPRGR11    PRGRD3
     C                     Z-ADDPROU11    PROUD3
     C                     Z-ADDPEFF11    PEFFD3
     C                     Z-ADDPDEC11    PDECD3
     C                     ELSE
     C                     Z-ADD*ZEROS    SSD3
     C                     Z-ADD*ZEROS    RETPD3
     C                     Z-ADD*ZEROS    ROCAD3
     C                     Z-ADD*ZEROS    PRDID3
     C                     Z-ADD*ZEROS    PRGRD3
     C                     Z-ADD*ZEROS    PROUD3
     C                     Z-ADD*ZEROS    PEFFD3
     C                     Z-ADD*ZEROS    PDECD3
F1  C                     END
D1  C           $NATP2    IFNE *BLANKS
     C                     Z-ADD27        SSD4
     C                     Z-ADDRETP12    RETPD4
     C                     Z-ADDROCA12    ROCAD4
     C                     Z-ADDPRDI12    PRDID4
     C                     Z-ADDPRGR12    PRGRD4
     C                     Z-ADDPROU12    PROUD4
     C                     Z-ADDPEFF12    PEFFD4
     C                     Z-ADDPDEC12    PDECD4
     C                     ELSE
     C                     Z-ADD*ZEROS    SSD4
     C                     Z-ADD*ZEROS    RETPD4
     C                     Z-ADD*ZEROS    ROCAD4
     C                     Z-ADD*ZEROS    PRDID4
     C                     Z-ADD*ZEROS    PRGRD4
     C                     Z-ADD*ZEROS    PROUD4
     C                     Z-ADD*ZEROS    PEFFD4
     C                     Z-ADD*ZEROS    PDECD4
F1  C                     END
D1  C           £NATP3    IFNE *BLANKS
     C                     Z-ADD30        SSDA
     C                     Z-ADDRETP13    RETPDA
     C                     Z-ADDROCA13    ROCADA
     C                     Z-ADDPRDI13    PRDIDA
     C                     Z-ADDPRGR13    PRGRDA
     C                     Z-ADDPROU13    PROUDA
     C                     Z-ADDPEFF13    PEFFDA
     C                     Z-ADDPDEC13    PDECDA
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDA
     C                     Z-ADD*ZEROS    RETPDA
     C                     Z-ADD*ZEROS    ROCADA
     C                     Z-ADD*ZEROS    PRDIDA
     C                     Z-ADD*ZEROS    PRGRDA
     C                     Z-ADD*ZEROS    PROUDA
     C                     Z-ADD*ZEROS    PEFFDA
     C                     Z-ADD*ZEROS    PDECDA
F1  C                     END
D1  C           £NATP4    IFNE *BLANKS
     C                     Z-ADD31        SSDB
     C                     Z-ADDRETP14    RETPDB
     C                     Z-ADDROCA14    ROCADB
     C                     Z-ADDPRDI14    PRDIDB
     C                     Z-ADDPRGR14    PRGRDB
     C                     Z-ADDPROU14    PROUDB
     C                     Z-ADDPEFF14    PEFFDB
     C                     Z-ADDPDEC14    PDECDB
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDB
     C                     Z-ADD*ZEROS    RETPDB
     C                     Z-ADD*ZEROS    ROCADB
     C                     Z-ADD*ZEROS    PRDIDB
     C                     Z-ADD*ZEROS    PRGRDB
     C                     Z-ADD*ZEROS    PROUDB
     C                     Z-ADD*ZEROS    PEFFDB
     C                     Z-ADD*ZEROS    PDECDB
F1  C                     END
D1  C           $NATP3    IFNE *BLANKS
     C                     Z-ADD30        SSDC
     C                     Z-ADDRETP15    RETPDC
     C                     Z-ADDROCA15    ROCADC
     C                     Z-ADDPRDI15    PRDIDC
     C                     Z-ADDPRGR15    PRGRDC
     C                     Z-ADDPROU15    PROUDC
     C                     Z-ADDPEFF15    PEFFDC
     C                     Z-ADDPDEC15    PDECDC
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDC
     C                     Z-ADD*ZEROS    RETPDC
     C                     Z-ADD*ZEROS    ROCADC
     C                     Z-ADD*ZEROS    PRDIDC
     C                     Z-ADD*ZEROS    PRGRDC
     C                     Z-ADD*ZEROS    PROUDC
     C                     Z-ADD*ZEROS    PEFFDC
     C                     Z-ADD*ZEROS    PDECDC
F1  C                     END
D1  C           $NATP4    IFNE *BLANKS
     C                     Z-ADD31        SSDD
     C                     Z-ADDRETP16    RETPDD
     C                     Z-ADDROCA16    ROCADD
     C                     Z-ADDPRDI16    PRDIDD
     C                     Z-ADDPRGR16    PRGRDD
     C                     Z-ADDPROU16    PROUDD
     C                     Z-ADDPEFF16    PEFFDD
     C                     Z-ADDPDEC16    PDECDD
     C                     ELSE
     C                     Z-ADD*ZEROS    SSDD
     C                     Z-ADD*ZEROS    RETPDD
     C                     Z-ADD*ZEROS    ROCADD
     C                     Z-ADD*ZEROS    PRDIDD
     C                     Z-ADD*ZEROS    PRGRDD
     C                     Z-ADD*ZEROS    PROUDD
     C                     Z-ADD*ZEROS    PEFFDD
     C                     Z-ADD*ZEROS    PDECDD
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION MACHINE                     *
     *--------------------------------------------------------*
    C           VALMAC    BEGSR
     *          ---------------
     C                     SETOF                     47
     C                     MOVEL'XPOOLMAC'TBLNOM
    C*
     C                     Z-ADDUSA1      USZ
     C                     MOVEL'1'       SECT
     C                     MOVE IMPA1     SSECT
     C                     MOVE USA1      XPOOA1
D1  C           XAIME1    IFNE *ZEROS
     C                     MOVE XAIME1    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN36
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
     C           AGEEP1    COMP 0                    3636
F2  C                     END
F1  C                     END
D1  C           XAIME2    IFNE *ZEROS
     C                     MOVE XAIME2    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN36
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEEP2    IFGT 0
     C                     MOVE '1'       *IN36
X3  C                     ELSE
D4  C           ATGEP     IFEQ 'X'
     C                     MOVE '1'       *IN36
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIME3    IFNE *ZEROS
     C                     MOVE XAIME3    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN36
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEEP3    IFGT 0
     C                     MOVE '1'       *IN36
X3  C                     ELSE
D4  C           ATGEP     IFEQ 'X'
    C           AGEEP2    ANDGT0
     C                     MOVE '1'       *IN36
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIME4    IFNE *ZEROS
     C                     MOVE XAIME4    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN36
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           ATGEP     IFEQ 'X'
    C           AGEEP3    ANDGT0
     C                     MOVE '1'       *IN36
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIME5    IFNE *ZEROS
     C                     MOVE XAIME5    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN36
F2  C                     END
F1  C                     END
D1  C           XMIME1    IFNE *ZEROS
     C                     MOVE XMIME1    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN38
F2  C                     END
F1  C                     END
D1  C           XMIME2    IFNE *ZEROS
     C                     MOVE XMIME2    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN38
F2  C                     END
F1  C                     END
D1  C           XMIME3    IFNE *ZEROS
     C                     MOVE XMIME3    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN38
F2  C                     END
F1  C                     END
D1  C           XMIME4    IFNE *ZEROS
     C                     MOVE XMIME4    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN38
F2  C                     END
F1  C                     END
D1  C           XMIME5    IFNE *ZEROS
     C                     MOVE XMIME5    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN38
F2  C                     END
F1  C                     END
    C*
     C                     MOVE RIMA11    SSECT
D1  C           XIMRE1    IFNE *ZEROS
     C                     MOVE XIMRE1    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN37
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
     C           AGEER1    COMP 0                    3737
F2  C                     END
F1  C                     END
D1  C           XIMRE2    IFNE *ZEROS
     C                     MOVE XIMRE2    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN37
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEER2    IFGT 0
     C                     MOVE '1'       *IN37
X3  C                     ELSE
D4  C           ATGER     IFEQ 'X'
     C                     MOVE '1'       *IN37
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XIMRE3    IFNE *ZEROS
     C                     MOVE XIMRE3    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN37
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEER3    IFGT 0
     C                     MOVE '1'       *IN37
X3  C                     ELSE
D4  C           ATGER     IFEQ 'X'
    C           AGEER2    ANDGT0
     C                     MOVE '1'       *IN37
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XIMRE4    IFNE *ZEROS
     C                     MOVE XIMRE4    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN37
F2  C                     END
X1  C                     ELSE
D2  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           ATGER     IFEQ 'X'
    C           AGEER3    ANDGT0
     C                     MOVE '1'       *IN37
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XIMRE5    IFNE *ZEROS
     C                     MOVE XIMRE5    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN37
F2  C                     END
F1  C                     END
D1  C           XMIRE1    IFNE *ZEROS
     C                     MOVE XMIRE1    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN39
F2  C                     END
F1  C                     END
D1  C           XMIRE2    IFNE *ZEROS
     C                     MOVE XMIRE2    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN39
F2  C                     END
F1  C                     END
D1  C           XMIRE3    IFNE *ZEROS
     C                     MOVE XMIRE3    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN39
F2  C                     END
F1  C                     END
D1  C           XMIRE4    IFNE *ZEROS
     C                     MOVE XMIRE4    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN39
F2  C                     END
F1  C                     END
D1  C           XMIRE5    IFNE *ZEROS
     C                     MOVE XMIRE5    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
     C                     EXSR TSTME
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN39
F2  C                     END
F1  C                     END
    C*
     C                     Z-ADDUSA2      USZ
     C                     MOVEL'1'       SECT
     C                     MOVE IMPA2     SSECT
     C                     MOVE USA2      XPOOA1
D1  C           XAIMI1    IFNE *ZEROS
     C                     MOVE XAIMI1    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN43
F2  C                     END
X1  C                     ELSE
D2  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
     C           AGEIP1    COMP 0                    4343
F2  C                     END
F1  C                     END
D1  C           XAIMI2    IFNE *ZEROS
     C                     MOVE XAIMI2    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN43
F2  C                     END
X1  C                     ELSE
D2  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEIP2    IFGT 0
     C                     MOVE '1'       *IN43
X3  C                     ELSE
D4  C           ATGIP     IFEQ 'X'
     C                     MOVE '1'       *IN43
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIMI3    IFNE *ZEROS
     C                     MOVE XAIMI3    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN43
F2  C                     END
X1  C                     ELSE
D2  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           AGEIP3    IFGT 0
     C                     MOVE '1'       *IN43
X3  C                     ELSE
D4  C           ATGER     IFEQ 'X'
    C           AGEEP2    ANDGT0
     C                     MOVE '1'       *IN43
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIMI4    IFNE *ZEROS
     C                     MOVE XAIMI4    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN43
F2  C                     END
X1  C                     ELSE
D2  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
D3  C           ATGIP     IFEQ 'X'
    C           AGEIP3    ANDGT0
     C                     MOVE '1'       *IN36
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           XAIMI5    IFNE *ZEROS
     C                     MOVE XAIMI5    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN43
F2  C                     END
F1  C                     END
D1  C           XMIMI1    IFNE *ZEROS
     C                     MOVE XMIMI1    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN45
F2  C                     END
F1  C                     END
D1  C           XMIMI2    IFNE *ZEROS
     C                     MOVE XMIMI2    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN45
F2  C                     END
F1  C                     END
D1  C           XMIMI3    IFNE *ZEROS
     C                     MOVE XMIMI3    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN45
F2  C                     END
F1  C                     END
D1  C           XMIMI4    IFNE *ZEROS
     C                     MOVE XMIMI4    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN45
F2  C                     END
F1  C                     END
D1  C           XMIMI5    IFNE *ZEROS
     C                     MOVE XMIMI5    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN45
F2  C                     END
F1  C                     END
    C*
     C                     MOVE RIMA12    SSECT
D1  C           XIMRI1    IFNE *ZEROS
     C                     MOVE XIMRI1    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN44
F2  C                     END
X1  C                     ELSE
D2  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
     C           AGEIR1    COMP 0                    4444
F2  C                     END
F1  C                     END
D1  C           XIMRI2    IFNE *ZEROS
     C                     MOVE XIMRI2    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN44
F2  C                     END
F1  C                     END
D1  C           XIMRI3    IFNE *ZEROS
     C                     MOVE XIMRI3    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN44
F2  C                     END
F1  C                     END
D1  C           XIMRI4    IFNE *ZEROS
     C                     MOVE XIMRI4    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN44
F2  C                     END
F1  C                     END
D1  C           XIMRI5    IFNE *ZEROS
     C                     MOVE XIMRI5    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN44
F2  C                     END
F1  C                     END
D1  C           XMIRI1    IFNE *ZEROS
     C                     MOVE XMIRI1    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN46
F2  C                     END
F1  C                     END
D1  C           XMIRI2    IFNE *ZEROS
     C                     MOVE XMIRI2    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN46
F2  C                     END
F1  C                     END
D1  C           XMIRI3    IFNE *ZEROS
     C                     MOVE XMIRI3    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN46
F2  C                     END
F1  C                     END
D1  C           XMIRI4    IFNE *ZEROS
     C                     MOVE XMIRI4    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN46
F2  C                     END
F1  C                     END
D1  C           XMIRI5    IFNE *ZEROS
     C                     MOVE XMIRI5    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
     C                     EXSR TSTMI
D2  C           ERREUR    IFEQ '1'
     C                     MOVE '1'       *IN46
F2  C                     END
F1  C                     END
    C*
D1  C           *IN36     IFEQ '1'
    C           *IN37     OREQ '1'
    C           *IN38     OREQ '1'
    C           *IN39     OREQ '1'
    C           *IN43     OREQ '1'
    C           *IN44     OREQ '1'
    C           *IN45     OREQ '1'
    C           *IN46     OREQ '1'
     C                     SETON                     47
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   TEST MACHINE EXT FONCTION DE CONFIG OFFSET       *
    C* ---------------------------------------------------*
    C           TSTME     BEGSR
     C                     MOVE '0'       ERREUR  1
D1  C           IMPA1     IFEQ 4
    C           ATCOEP    ANDGT0
D2  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F2  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSA1      USIEP
     C                     MOVE NOMAC     MACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLE3      SETLLPARAME
     C           CLE3      READEPARAME                   50
    C           *IN50     CABEQ'1'       RIEN3
D2  C           *IN50     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ATCOEP    YYY1    1
    C           ZZZ1      CABEQYYY1                     50
     C  N50      CLE3      READEPARAME                   50
F2  C                     END
D2  C           ZZZ1      IFNE YYY1
     C           RIEN3     TAG
     C                     MOVE '1'       ERREUR
F2  C                     END
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   TEST MACHINE INT FONCTION DE CONFIG OFFSET       *
    C* ---------------------------------------------------*
    C           TSTMI     BEGSR
     C                     MOVE '0'       ERREUR  1
D1  C           IMPA2     IFEQ 4
    C           ATCOEP    ANDGT0
D2  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F2  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSA2      USIEP
     C                     MOVE NOMAC     MACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLE3      SETLLPARAME
     C           CLE3      READEPARAME                   50
    C           *IN50     CABEQ'1'       RIEN5
D2  C           *IN50     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ATCOEP    YYY1    1
    C           ZZZ1      CABEQYYY1                     50
     C  N50      CLE3      READEPARAME                   50
F2  C                     END
D2  C           ZZZ1      IFNE YYY1
     C           RIEN5     TAG
     C                     MOVE '1'       ERREUR
F2  C                     END
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION ZONE FORMAT WE                       *
    C* ---------------------------------------------------*
    C           PREWE     BEGSR
    C*          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVELTA,3      NOMEWE
     C                     MOVE GAUF11    XAUF1
     C                     MOVE NOGF11    XOGF1
     C                     MOVE GAUF21    XAUF2
     C                     MOVE NOGF21    XOGF2
     C                     MOVE MASS11    XASSI
     C                     MOVE SSINT1    XSINT
     C                     MOVE CXHAI1    XXHAPI
     C                     MOVE XAGA11    XAGAU1
     C                     MOVE XRGA11    XRGAU1
     C                     MOVE XAGA21    XAGAU2
     C                     MOVE XRGA21    XRGAU2
     C                     MOVE XSGF11    XSGF1
     C                     MOVE XSGF21    XSGF2
     C                     MOVE XSMAS1    XSMAS
     C                     MOVE XAMAS1    XAMAS
     C                     Z-ADDRASPA1    RASPX
     C                     Z-ADDMASA1L    XMASL
     C                     Z-ADDMASA1H    XMASH
D2  C           SLA1      IFEQ *ZEROS
     C                     Z-ADDLA1       XLA     40
     C                     Z-ADDHA1       XHA     40
X2  C                     ELSE
     C                     Z-ADDSLA1      XLA
     C                     Z-ADDSHA1      XHA
F2  C                     END
     C                     MOVE ' '       XOPST
D2  C           SCO1A1    IFNE *BLANKS
    C           SCO2A1    ORNE *BLANKS
    C           SCO3A1    ORNE *BLANKS
     C                     MOVE '*'       XOPST
F2  C                     END
     C                     MOVE £CODDO    XODDOR
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVELTA,4      NOMEWE
     C                     MOVE GAUF12    XAUF1
     C                     MOVE NOGF12    XOGF1
     C                     MOVE GAUF22    XAUF2
     C                     MOVE NOGF22    XOGF2
     C                     MOVE MASS12    XASSI
     C                     MOVE SSINT2    XSINT
     C                     MOVE CXHAI2    XXHAPI
     C                     MOVE XAGA12    XAGAU1
     C                     MOVE XRGA12    XRGAU2
     C                     MOVE XAGA22    XAGAU2
     C                     MOVE XRGA22    XRGAU1
     C                     MOVE XSGF12    XSGF1
     C                     MOVE XSGF22    XSGF2
     C                     MOVE XSMAS2    XSMAS
     C                     MOVE XAMAS2    XAMAS
     C                     Z-ADDRASPA2    RASPX
     C                     Z-ADDMASA2L    XMASL
     C                     Z-ADDMASA2H    XMASH
D2  C           SLA2      IFNE *ZEROS
     C                     Z-ADDLA2       XLA     40
     C                     Z-ADDHA2       XHA     40
X2  C                     ELSE
     C                     Z-ADDSLA2      XLA
     C                     Z-ADDSHA2      XHA
F2  C                     END
     C                     MOVE ' '       XOPST
D2  C           SCO1A2    IFNE *BLANKS
    C           SCO2A2    ORNE *BLANKS
    C           SCO3A2    ORNE *BLANKS
     C                     MOVE '*'       XOPST
F2  C                     END
     C                     MOVE $CODDO    XODDOR
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION ZONE FORMAT WG                       *
    C* ---------------------------------------------------*
    C           PREWG     BEGSR
    C*          ---------------
     C                     MOVE *BLANK    STCOD1
     C                     Z-ADD*ZEROS    STRE1
     C                     Z-ADD*ZEROS    STRO1
     C                     Z-ADD*ZEROS    STDEC1
     C                     MOVE *BLANK    STCOD2
     C                     Z-ADD*ZEROS    STRE2
     C                     Z-ADD*ZEROS    STRO2
     C                     Z-ADD*ZEROS    STDEC2
     C                     MOVE *BLANK    STCOD3
     C                     Z-ADD*ZEROS    STRE3
     C                     Z-ADD*ZEROS    STRO3
     C                     Z-ADD*ZEROS    STDEC3
     C                     MOVE *BLANKS   LIBST1
     C                     MOVE *BLANKS   LIBST2
     C                     MOVE *BLANKS   LIBST3
D1  C           *IN81     IFEQ '1'
     C                     MOVE SCO1A1    STCOD1
     C                     MOVE SRE1A1    STRE1
     C                     MOVE SRO1A1    STRO1
     C                     MOVE SDE1A1    STDEC1
     C                     MOVE SCO2A1    STCOD2
     C                     MOVE SRE2A1    STRE2
     C                     MOVE SRO2A1    STRO2
     C                     MOVE SDE2A1    STDEC2
     C                     MOVE SCO3A1    STCOD3
     C                     MOVE SRE3A1    STRE3
     C                     MOVE SRO3A1    STRO3
     C                     MOVE SDE3A1    STDEC3
D2  C           £CODDO    IFEQ *BLANKS
    C           *IN58     ANDEQ'1'
     C                     MOVE RFDORA    REFDSS
X2  C                     ELSE
     C                     MOVE *BLANKS   REFDSS
F2  C                     END
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE SCO1A2    STCOD1
     C                     MOVE SRE1A2    STRE1
     C                     MOVE SRO1A2    STRO1
     C                     MOVE SDE1A2    STDEC1
     C                     MOVE SCO2A2    STCOD2
     C                     MOVE SRE2A2    STRE2
     C                     MOVE SRO2A2    STRO2
     C                     MOVE SDE2A2    STDEC2
     C                     MOVE SCO3A2    STCOD3
     C                     MOVE SRE3A2    STRE3
     C                     MOVE SRO3A2    STRO3
     C                     MOVE SDE3A2    STDEC3
D2  C           $CODDO    IFEQ *BLANKS
    C           *IN58     ANDEQ'1'
     C                     MOVE RFDORA    REFDSS
X2  C                     ELSE
     C                     MOVE *BLANKS   REFDSS
F2  C                     END
F1  C                     END
D1  C           STCOD1    IFNE *BLANKS
     C                     MOVE STCOD1    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST1
F1  C                     END
D1  C           STCOD2    IFNE *BLANKS
     C                     MOVE STCOD2    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST2
F1  C                     END
D1  C           STCOD3    IFNE *BLANKS
     C                     MOVE STCOD3    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST3
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION ZONE FORMAT WI                       *
    C* ---------------------------------------------------*
    C           PREWI     BEGSR
    C*          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVELTA,3      NOMEWI
     C                     MOVE £NATP1    DNATP1
     C                     MOVE £DIFP1    DDIFP1
     C                     MOVE £NATP2    DNATP2
     C                     MOVE £DIFP2    DDIFP2
     C                     MOVE £NATP3    DNATP3
     C                     MOVE £DIFP3    DDIFP3
     C                     MOVE £NATP4    DNATP4
     C                     MOVE £DIFP4    DDIFP4
     C                     MOVE £FPXF1    DFPXF1
     C                     Z-ADD£SFF1     DSFF1
     C                     MOVE £NPAF1    DNPAF1
     C                     MOVE £FPXF2    DFPXF2
     C                     Z-ADD£SFF2     DSFF2
     C                     MOVE £NPAF2    DNPAF2
     C                     MOVE £FPXF3    DFPXF3
     C                     Z-ADD£SFF3     DSFF3
     C                     MOVE £NPAF3    DNPAF3
     C                     MOVE £FPXF4    DFPXF4
     C                     Z-ADD£SFF4     DSFF4
     C                     MOVE £NPAF4    DNPAF4
     C                     MOVE £FPXF5    DFPXF5
     C                     Z-ADD£SFF5     DSFF5
     C                     MOVE £NPAF5    DNPAF5
     C                     MOVE £FPXF6    DFPXF6
     C                     Z-ADD£SFF6     DSFF6
     C                     MOVE £NPAF6    DNPAF6
     C                     MOVE £FPXF7    DFPXF7
     C                     Z-ADD£SFF7     DSFF7
     C                     MOVE £NPAF7    DNPAF7
     C                     MOVE £FPXF8    DFPXF8
     C                     Z-ADD£SFF8     DSFF8
     C                     MOVE £NPAF8    DNPAF8
     C                     MOVE £FPXF9    DFPXF9
     C                     Z-ADD£SFF9     DSFF9
     C                     MOVE £NPAF9    DNPAF9
     C                     MOVE £FPXFA    DFPXFA
     C                     Z-ADD£SFFA     DSFFA
     C                     MOVE £NPAFA    DNPAFA
     C                     MOVE £FPXFB    DFPXFB
     C                     Z-ADD£SFFB     DSFFB
     C                     MOVE £NPAFB    DNPAFB
     C                     MOVE £FPXFC    DFPXFC
     C                     Z-ADD£SFFC     DSFFC
     C                     MOVE £NPAFC    DNPAFC
     C                     MOVE £TYPF1    DTYPF1
     C                     MOVE £TYPF2    DTYPF2
     C                     MOVE £TYPF3    DTYPF3
     C                     MOVE £TYPF4    DTYPF4
     C                     MOVE £TYPF5    DTYPF5
     C                     MOVE £TYPF6    DTYPF6
     C                     MOVE £TYPF7    DTYPF7
     C                     MOVE £TYPF8    DTYPF8
     C                     MOVE £TYPF9    DTYPF9
     C                     Z-ADD£LZF1     DLZF1
     C                     Z-ADD£LZF2     DLZF2
     C                     Z-ADD£LZF3     DLZF3
     C                     Z-ADD£LZF4     DLZF4
     C                     Z-ADD£LZF5     DLZF5
     C                     Z-ADD£LZF6     DLZF6
     C                     Z-ADD£LZF7     DLZF7
     C                     Z-ADD£LZF8     DLZF8
     C                     Z-ADD£LZF9     DLZF9
     C                     Z-ADD£SMIP1    DSMIP1
     C                     Z-ADD£SMAP1    DSMAP1
     C                     Z-ADD£SMIP2    DSMIP2
     C                     Z-ADD£SMAP2    DSMAP2
     C                     MOVE £EFDOR    REFDOR
     C                     MOVE £EFDO2    REFDO2
     C                     MOVE £ORGAM    DORGAM
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVELTA,4      NOMEWI
     C                     MOVE $NATP1    DNATP1
     C                     MOVE $DIFP1    DDIFP1
     C                     MOVE $NATP2    DNATP2
     C                     MOVE $DIFP2    DDIFP2
     C                     MOVE $NATP3    DNATP3
     C                     MOVE $DIFP3    DDIFP3
     C                     MOVE $NATP4    DNATP4
     C                     MOVE $DIFP4    DDIFP4
     C                     MOVE $FPXF1    DFPXF1
     C                     Z-ADD$SFF1     DSFF1
     C                     MOVE $NPAF1    DNPAF1
     C                     MOVE $FPXF2    DFPXF2
     C                     Z-ADD$SFF2     DSFF2
     C                     MOVE $NPAF2    DNPAF2
     C                     MOVE $FPXF3    DFPXF3
     C                     Z-ADD$SFF3     DSFF3
     C                     MOVE $NPAF3    DNPAF3
     C                     MOVE $FPXF4    DFPXF4
     C                     Z-ADD$SFF4     DSFF4
     C                     MOVE $NPAF4    DNPAF4
     C                     MOVE $FPXF5    DFPXF5
     C                     Z-ADD$SFF5     DSFF5
     C                     MOVE $NPAF5    DNPAF5
     C                     MOVE $FPXF6    DFPXF6
     C                     Z-ADD$SFF6     DSFF6
     C                     MOVE $NPAF6    DNPAF6
     C                     MOVE $FPXF7    DFPXF7
     C                     Z-ADD$SFF7     DSFF7
     C                     MOVE $NPAF7    DNPAF7
     C                     MOVE $FPXF8    DFPXF8
     C                     Z-ADD$SFF8     DSFF8
     C                     MOVE $NPAF8    DNPAF8
     C                     MOVE $FPXF9    DFPXF9
     C                     Z-ADD$SFF9     DSFF9
     C                     MOVE $NPAF9    DNPAF9
     C                     MOVE $FPXFA    DFPXFA
     C                     Z-ADD$SFFA     DSFFA
     C                     MOVE $NPAFA    DNPAFA
     C                     MOVE $FPXFB    DFPXFB
     C                     Z-ADD$SFFB     DSFFB
     C                     MOVE $NPAFB    DNPAFB
     C                     MOVE $FPXFC    DFPXF9
     C                     Z-ADD$SFFC     DSFFC
     C                     MOVE $NPAFC    DNPAFC
     C                     MOVE $TYPF1    DTYPF1
     C                     MOVE $TYPF2    DTYPF2
     C                     MOVE $TYPF3    DTYPF3
     C                     MOVE $TYPF4    DTYPF4
     C                     MOVE $TYPF5    DTYPF5
     C                     MOVE $TYPF6    DTYPF6
     C                     MOVE $TYPF7    DTYPF7
     C                     MOVE $TYPF8    DTYPF8
     C                     MOVE $TYPF9    DTYPF9
     C                     Z-ADD$LZF1     DLZF1
     C                     Z-ADD$LZF2     DLZF2
     C                     Z-ADD$LZF3     DLZF3
     C                     Z-ADD$LZF4     DLZF4
     C                     Z-ADD$LZF5     DLZF5
     C                     Z-ADD$LZF6     DLZF6
     C                     Z-ADD$LZF7     DLZF7
     C                     Z-ADD$LZF8     DLZF8
     C                     Z-ADD$LZF9     DLZF9
     C                     Z-ADD$SMIP1    DSMIP1
     C                     Z-ADD$SMAP1    DSMAP1
     C                     Z-ADD$SMIP2    DSMIP2
     C                     Z-ADD$SMAP2    DSMAP2
     C                     MOVE $EFDOR    REFDOR
     C                     MOVE $EFDO2    REFDO2
     C                     MOVE $ORGAM    DORGAM
F1  C                     END
     *
     C                     MOVE *BLANKS   DLIBP1
     C                     MOVE *BLANKS   DLIBP2
     C                     MOVE *BLANKS   DLIBP3
     C                     MOVE *BLANKS   DLIBP4
     C                     MOVE *BLANKS   LTFF1
     C                     MOVE *BLANKS   LTFF2
     C                     MOVE *BLANKS   LTFF3
     C                     MOVE *BLANKS   LTFF4
     C                     MOVE *BLANKS   LTFF5
     C                     MOVE *BLANKS   LTFF6
     C                     MOVE *BLANKS   LTFF7
     C                     MOVE *BLANKS   LTFF8
     C                     MOVE *BLANKS   LTFF9
     C                     MOVE *BLANKS   LTFFA
     C                     MOVE *BLANKS   LTFFB
     C                     MOVE *BLANKS   LTFFC
     C                     MOVE *BLANKS   LTYF1
     C                     MOVE *BLANKS   LTYF2
     C                     MOVE *BLANKS   LTYF3
     C                     MOVE *BLANKS   LTYF4
     C                     MOVE *BLANKS   LTYF5
     C                     MOVE *BLANKS   LTYF6
     C                     MOVE *BLANKS   LTYF7
     C                     MOVE *BLANKS   LTYF8
     C                     MOVE *BLANKS   LTYF9
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    DLIBP1
     C                     MOVE DNATP2    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    DLIBP2
     C                     MOVE DNATP3    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    DLIBP3
     C                     MOVE DNATP4    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    DLIBP4
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF1
     C                     MOVE DFPXF2    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF2
     C                     MOVE DFPXF3    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF3
     C                     MOVE DFPXF4    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF4
     C                     MOVE DFPXF5    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF5
     C                     MOVE DFPXF6    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF6
     C                     MOVE DFPXF7    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF7
     C                     MOVE DFPXF8    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF8
     C                     MOVE DFPXF9    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFF9
     C                     MOVE DFPXFA    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFFA
     C                     MOVE DFPXFB    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFFB
     C                     MOVE DFPXFC    PXVALE    P
     C           CLE3      CHAINPARAME               90
     C  N90                MOVE PXABRG    LTFFC
     C                     MOVE *BLANKS   ERRDOR
D1  C           *IN58     IFEQ '1'
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF1    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF1
     C                     MOVE DTYPF2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF2
     C                     MOVE DTYPF3    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF3
     C                     MOVE DTYPF4    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF4
     C                     MOVE DTYPF5    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF5
     C                     MOVE DTYPF6    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF6
     C                     MOVE DTYPF7    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF7
     C                     MOVE DTYPF8    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF8
     C                     MOVE DTYPF9    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF9
     C                     Z-ADD2         DUSP1
     C                     Z-ADD1         DMACP1
D2  C           DNATP2    IFNE *BLANKS
     C                     Z-ADD2         DUSP2
     C                     Z-ADD1         DMACP2
F2  C                     END
D2  C           DNATP3    IFNE *BLANKS
     C                     Z-ADD2         DUSP3
     C                     Z-ADD1         DMACP3
F2  C                     END
D2  C           DNATP4    IFNE *BLANKS
     C                     Z-ADD2         DUSP4
     C                     Z-ADD1         DMACP4
F2  C                     END
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION FORMAT +                    *
     *--------------------------------------------------------*
    C           VERPLU    BEGSR
     *          ---------------
     C                     SETOF                     40
    C*
D1  C           XOGF1     IFNE *ZEROS
    C           XAUF1     ANDEQ*BLANKS
     C                     SETON                     52
    C                     GOTO STVPLU
F1  C                     END
D1  C           XSGF1     IFNE *ZEROS
D2  C           XAUF1     IFEQ *BLANKS
     C                     SETON                     70
    C                     GOTO STVPLU
F2  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE XSGF1     PXVALE    P
     C           CLE3      CHAINPARAME               70
    C   70                GOTO STVPLU
F1  C                     END
     C                     MOVE XSGF1     USZ       P
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           XAGAU1    IFNE *ZEROS
    C           XAUF1     CABEQ*BLANKS   STVPLU         49
     C                     MOVE XAGAU1    NOMAC
     C           CLEMAC    CHAINMACHIN               49
    C   49                GOTO STVPLU
F1  C                     END
D1  C           XRGAU1    IFNE *ZEROS
    C           XAUF1     CABEQ*BLANKS   STVPLU         49
     C                     MOVE XRGAU1    NOMAC
     C           CLEMAC    CHAINMACHIN               49
    C   49                GOTO STVPLU
F1  C                     END
D1  C           XAUF2     IFNE *BLANKS
    C           XAUF1     ANDEQ*BLANKS
     C                     SETON                     48
    C                     GOTO STVPLU
F1  C                     END
D1  C           XOGF2     IFNE *ZEROS
    C           XAUF2     ANDEQ*BLANKS
     C                     SETON                     54
    C                     GOTO STVPLU
F1  C                     END
D1  C           XSGF2     IFNE *ZEROS
D2  C           XAUF2     IFEQ *BLANKS
     C                     SETON                     80
    C                     GOTO STVPLU
F2  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE XSGF2     PXVALE    P
     C           CLE3      CHAINPARAME               80
    C   80                GOTO STVPLU
F1  C                     END
     C                     MOVE XSGF2     USZ       P
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           XAGAU2    IFNE *ZEROS
    C           XAUF2     CABEQ*BLANKS   STVPLU         56
     C                     MOVE XAGAU2    NOMAC
     C           CLEMAC    CHAINMACHIN               56
    C   56                GOTO STVPLU
F1  C                     END
D1  C           XRGAU2    IFNE *ZEROS
    C           XAUF2     CABEQ*BLANKS   STVPLU         56
     C                     MOVE XRGAU2    NOMAC
     C           CLEMAC    CHAINMACHIN               56
    C   56                GOTO STVPLU
F1  C                     END
D1  C           XMASL     IFNE *ZEROS
    C           XMASH     ANDEQ*ZEROS
    C           XMASL     OREQ *ZEROS
    C           XMASH     ANDNE*ZEROS
     C                     SETON                     97
    C                     GOTO STVPLU
F1  C                     END
D1  C           XMASL     IFNE *ZEROS
    C           XASSI     ANDNE*BLANKS
     C                     SETON                     29
    C                     GOTO STVPLU
F1  C                     END
D1  C           XMASL     IFNE *ZEROS
D2  C           XMASL     IFLT XLA
    C           XMASH     ORLT XHA
    C           XMASL     OREQ XLA
    C           XMASH     ANDEQXHA
     C                     SETON                     97
    C                     GOTO STVPLU
F2  C                     END
F1  C                     END
D1  C           XSMAS     IFNE *ZEROS
D2  C           XASSI     IFEQ *BLANKS
    C           XMASL     ANDEQ*ZEROS
     C                     SETON                     69
    C                     GOTO STVPLU
F2  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE XSMAS     PXVALE    P
     C           CLE3      CHAINPARAME               69
    C   69                GOTO STVPLU
F1  C                     END
     C                     MOVE XSMAS     USZ       P
     C                     MOVE '1'       SECT
     C                     MOVE '5'       SSECT
D1  C           XAMAS     IFNE *ZEROS
D2  C           XASSI     IFEQ *BLANKS
    C           XMASL     ANDEQ*ZEROS
     C                     SETON                     83
    C                     GOTO STVPLU
F2  C                     END
     C                     MOVE XAMAS     NOMAC
     C           CLEMAC    CHAINMACHIN               83
    C   83                GOTO STVPLU
F1  C                     END
D1  C           XSINT     IFEQ '*'
    C           XOPST     ANDEQ'*'
     C                     SETON                     28
    C                     GOTO STVPLU
F1  C                     END
D1  C           XODDOR    IFEQ '*'
D2  C           *IN81     IFEQ '1'
    C           LA1       ANDEQ*ZEROS
    C           *IN82     OREQ '1'
    C           LA2       ANDEQ*ZEROS
     C                     SETON                     22
    C                     GOTO STVPLU
F2  C                     END
F1  C                     END
    C*
     C           STVPLU    TAG
     *          ---------------
D1  C           *IN52     IFEQ '1'
    C           *IN70     OREQ '1'
    C           *IN49     OREQ '1'
    C           *IN48     OREQ '1'
    C           *IN54     OREQ '1'
    C           *IN80     OREQ '1'
    C           *IN56     OREQ '1'
    C           *IN69     OREQ '1'
    C           *IN83     OREQ '1'
    C           *IN28     OREQ '1'
    C           *IN29     OREQ '1'
    C           *IN97     OREQ '1'
    C           *IN22     OREQ '1'
     C                     SETON                     40
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION FORMAT SOUS TRAITANCE       *
     *--------------------------------------------------------*
    C           VERST     BEGSR
     *          ---------------
     C                     SETOF                     4099
D1  C           STCOD1    IFNE *BLANKS
     C                     MOVE STCOD1    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               25
     C  N25      PXMONT    COMP 12                   2525
    C   25                GOTO STVST
     C                     MOVELPXLIBE    LIBST1
D2  C           STRE1     IFEQ *ZEROS
    C           STRO1     ANDEQ*ZEROS
     C                     SETON                     2599
    C                     GOTO STVST
F2  C                     END
F1  C                     END
D1  C           STCOD2    IFNE *BLANKS
     C                     MOVE STCOD2    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               26
     C  N25      PXMONT    COMP 12                   2525
    C   26                GOTO STVST
     C                     MOVELPXLIBE    LIBST2
D2  C           STRE2     IFEQ *ZEROS
    C           STRO2     ANDEQ*ZEROS
     C                     SETON                     2699
    C                     GOTO STVST
F2  C                     END
F1  C                     END
D1  C           STCOD3    IFNE *BLANKS
     C                     MOVE STCOD3    PXVALE    P
     C                     MOVE 'TDST'    PXARGU
     C           CLE3      CHAINPARAME               27
     C  N27      PXMONT    COMP 12                   2727
    C   27                GOTO STVST
     C                     MOVELPXLIBE    LIBST3
D2  C           STRE3     IFEQ *ZEROS
    C           STRO3     ANDEQ*ZEROS
     C                     SETON                     2799
    C                     GOTO STVST
F2  C                     END
F1  C                     END
    C*
D1  C           *IN58     IFEQ '1'
D2  C           STCOD1    IFEQ 'O'
    C           STCOD2    OREQ 'O'
    C           STCOD3    OREQ 'O'
D3  C           REFDSS    IFEQ *BLANKS
     C                     SETON                     28
    C                     GOTO STVST
F3  C                     END
F2  C                     END
D2  C           REFDSS    IFNE *BLANKS
D3  C           STCOD1    IFNE 'O'
    C           STCOD2    ANDNE'O'
    C           STCOD3    ANDNE'O'
     C                     SETON                     28
    C                     GOTO STVST
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           STVST     TAG
     *          ---------------
D1  C           *IN25     IFEQ '1'
    C           *IN26     OREQ '1'
    C           *IN27     OREQ '1'
    C           *IN28     OREQ '1'
     C                     SETON                     40
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION FORMAT DORURE               *
     *--------------------------------------------------------*
    C           VERDOR    BEGSR
     *          ---------------
     C                     MOVE *BLANKS   ERRDOR
D1  C           DNATP1    IFNE *BLANKS
D2  C           DDIFP1    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    DLIBP1
     C                     MOVE '1'       NPDOR   1
X1  C                     ELSE
     C                     MOVELERR,1     ERRDOR
    C                     GOTO SWDOR
F1  C                     END
    C*
D1  C           DNATP2    IFNE *BLANKS
D2  C           DDIFP2    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP2    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    DLIBP2
     C                     MOVE '2'       NPDOR
X1  C                     ELSE
D2  C           DDIFP2    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   DLIBP2
F1  C                     END
    C*
D1  C           DNATP3    IFNE *BLANKS
D2  C           DDIFP3    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP3    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    DLIBP3
     C                     MOVE '3'       NPDOR
X1  C                     ELSE
D2  C           DDIFP3    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   DLIBP3
F1  C                     END
    C*          R
D1  C           DNATP4    IFNE *BLANKS
D2  C           DDIFP4    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP4    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    DLIBP4
     C                     MOVE '4'       NPDOR
X1  C                     ELSE
D2  C           DDIFP4    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   DLIBP4
F1  C                     END
     *
D1  C           DFPXF1    IFNE *BLANKS
D2  C           DSFF1     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF1
D2  C           DNPAF1    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
     C                     MOVELERR,6     ERRDOR
    C                     GOTO SWDOR
F1  C                     END
    C*
D1  C           DFPXF2    IFNE *BLANKS
D2  C           DSFF2     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF2    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF2
D2  C           DNPAF2    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF2     IFNE *ZEROS
    C           DNPAF2    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF2
F1  C                     END
    C*
D1  C           DFPXF3    IFNE *BLANKS
D2  C           DSFF3     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF3    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF3
D2  C           DNPAF3    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF3     IFNE *ZEROS
    C           DNPAF3    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF3
F1  C                     END
    C*
D1  C           DFPXF4    IFNE *BLANKS
D2  C           DSFF4     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF4    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF4
D2  C           DNPAF4    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF4     IFNE *ZEROS
    C           DNPAF4    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF4
F1  C                     END
    C*
D1  C           DFPXF5    IFNE *BLANKS
D2  C           DSFF5     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF5    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF5
D2  C           DNPAF5    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF5     IFNE *ZEROS
    C           DNPAF5    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF5
F1  C                     END
    C*
D1  C           DFPXF6    IFNE *BLANKS
D2  C           DSFF6     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF6    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF6
D2  C           DNPAF6    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF6     IFNE *ZEROS
    C           DNPAF6    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF6
F1  C                     END
    C*
D1  C           DFPXF7    IFNE *BLANKS
D2  C           DSFF7     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF7    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF7
D2  C           DNPAF7    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF7     IFNE *ZEROS
    C           DNPAF7    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF7
F1  C                     END
    C*
D1  C           DFPXF8    IFNE *BLANKS
D2  C           DSFF8     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF8    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF8
D2  C           DNPAF8    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF8     IFNE *ZEROS
    C           DNPAF8    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF8
F1  C                     END
    C*
D1  C           DFPXF9    IFNE *BLANKS
D2  C           DSFF9     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF9    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFF9
D2  C           DNPAF9    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFF9     IFNE *ZEROS
    C           DNPAF9    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFF9
F1  C                     END
    C*
D1  C           DFPXFA    IFNE *BLANKS
D2  C           DSFFA     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFA    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFFA
D2  C           DNPAFA    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFFA     IFNE *ZEROS
    C           DNPAFA    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFFA
F1  C                     END
    C*
D1  C           DFPXFB    IFNE *BLANKS
D2  C           DSFFB     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFB    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFFB
D2  C           DNPAFB    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFFB     IFNE *ZEROS
    C           DNPAFB    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFFB
F1  C                     END
    C*
D1  C           DFPXFC    IFNE *BLANKS
D2  C           DSFFC     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFC    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE PXABRG    LTFFC
D2  C           DNPAFC    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
X1  C                     ELSE
D2  C           DSFFC     IFNE *ZEROS
    C           DNPAFC    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOR
F2  C                     END
     C                     MOVE *BLANKS   LTFFC
F1  C                     END
     *
    C           SWDOR     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION FORMAT DORURE POUR PRODUIT  *
     *--------------------------------------------------------*
    C           VERDOP    BEGSR
     *          ---------------
     C                     MOVE *BLANKS   ERRDOR
D1  C           DNATP1    IFNE *BLANKS
D2  C           DDIFP1    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    DLIBP1
     C                     MOVE '1'       NPDOR   1
X1  C                     ELSE
     C                     MOVELERR,1     ERRDOR
    C                     GOTO SWDOP
F1  C                     END
    C*
D1  C           DNATP2    IFNE *BLANKS
D2  C           DDIFP2    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP2    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    DLIBP2
     C                     MOVE '2'       NPDOR
X1  C                     ELSE
D2  C           DDIFP2    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   DLIBP2
F1  C                     END
     *
D1  C           DNATP3    IFNE *BLANKS
D2  C           DDIFP3    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP3    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    DLIBP3
     C                     MOVE '3'       NPDOR   1
X1  C                     ELSE
D2  C           DDIFP3    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
    C*
D1  C           DNATP4    IFNE *BLANKS
D2  C           DDIFP4    IFEQ *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP4    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,3     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    DLIBP4
     C                     MOVE '4'       NPDOR
X1  C                     ELSE
D2  C           DDIFP4    IFNE *BLANKS
     C                     MOVELERR,2     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   DLIBP4
F1  C                     END
     *
D1  C           DNATP2    IFEQ *BLANKS
D2  C           DSMIP2    IFNE *ZEROS
    C           DSMAP2    ORNE *ZEROS
    C           REFDO2    ORNE *BLANKS
     C                     MOVELERR,11    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DNATP3    IFEQ *BLANKS
D2  C           DSMIP3    IFNE *ZEROS
    C           DSMAP3    ORNE *ZEROS
    C           REFDO3    ORNE *BLANKS
     C                     MOVELERR,11    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DNATP4    IFEQ *BLANKS
D2  C           DSMIP4    IFNE *ZEROS
    C           DSMAP4    ORNE *ZEROS
    C           REFDO4    ORNE *BLANKS
     C                     MOVELERR,11    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DTYPF1    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF1
F1  C                     END
D1  C           DTYPF2    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF2
F1  C                     END
D1  C           DTYPF3    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF3
F1  C                     END
D1  C           DTYPF4    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF4
F1  C                     END
D1  C           DTYPF5    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF5
F1  C                     END
D1  C           DTYPF6    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF6
F1  C                     END
D1  C           DTYPF7    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF7
F1  C                     END
D1  C           DTYPF8    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF8
F1  C                     END
D1  C           DTYPF9    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXF9
F1  C                     END
D1  C           DTYPFA    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXFA
F1  C                     END
D1  C           DTYPFB    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXFB
F1  C                     END
D1  C           DTYPFC    IFEQ *BLANKS
     C                     MOVE *BLANKS   DFPXFC
F1  C                     END
    C*
D1  C           DTYPF1    IFNE *BLANKS
D2  C           DLZF1     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF1    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF1
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       DFPXF1
D2  C           DNPAF1    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF1     IFNE *ZEROS
    C           DTYPF1    ORNE *BLANKS
    C           DNPAF1    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF1    IFNE *BLANKS
D2  C           DSFF1     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF1
D2  C           DNPAF1    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
     C                     MOVELERR,6     ERRDOR
    C                     GOTO SWDOP
F1  C                     END
    C*
D1  C           DTYPF2    IFNE *BLANKS
D2  C           DLZF2     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF2    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF2
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF2
D2  C           DNPAF2    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF2     IFNE *ZEROS
    C           DTYPF2    ORNE *BLANKS
    C           DNPAF2    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF2    IFNE *BLANKS
D2  C           DSFF2     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF2    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF2
D2  C           DNPAF2    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF2     IFNE *ZEROS
    C           DNPAF2    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF2
F1  C                     END
    C*
D1  C           DTYPF3    IFNE *BLANKS
D2  C           DLZF3     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF3    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF3
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF3
D2  C           DNPAF3    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF3     IFNE *ZEROS
    C           DTYPF3    ORNE *BLANKS
    C           DNPAF3    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF3    IFNE *BLANKS
D2  C           DSFF3     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF3    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF3
D2  C           DNPAF3    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF3     IFNE *ZEROS
    C           DNPAF3    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF3
F1  C                     END
    C*
D1  C           DTYPF4    IFNE *BLANKS
D2  C           DLZF4     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF4    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF4
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF4
D2  C           DNPAF4    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF4     IFNE *ZEROS
    C           DTYPF4    ORNE *BLANKS
    C           DNPAF4    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF4    IFNE *BLANKS
D2  C           DSFF4     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF4    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF4
D2  C           DNPAF4    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF4     IFNE *ZEROS
    C           DNPAF4    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF4
F1  C                     END
    C*
D1  C           DTYPF5    IFNE *BLANKS
D2  C           DLZF5     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF5    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF5
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF5
D2  C           DNPAF5    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF5     IFNE *ZEROS
    C           DTYPF5    ORNE *BLANKS
    C           DNPAF5    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF5    IFNE *BLANKS
D2  C           DSFF5     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF5    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF5
D2  C           DNPAF5    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF5     IFNE *ZEROS
    C           DNPAF5    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF5
F1  C                     END
    C*
D1  C           DTYPF6    IFNE *BLANKS
D2  C           DLZF6     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF6    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF6
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF6
D2  C           DNPAF6    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF6     IFNE *ZEROS
    C           DTYPF6    ORNE *BLANKS
    C           DNPAF6    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF6    IFNE *BLANKS
D2  C           DSFF6     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF6    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF6
D2  C           DNPAF6    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF6     IFNE *ZEROS
    C           DNPAF6    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF6
F1  C                     END
    C*
D1  C           DTYPF7    IFNE *BLANKS
D2  C           DLZF7     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF7    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF7
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF7
D2  C           DNPAF7    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF7     IFNE *ZEROS
    C           DTYPF7    ORNE *BLANKS
    C           DNPAF7    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF7    IFNE *BLANKS
D2  C           DSFF7     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF7    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF7
D2  C           DNPAF7    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF7     IFNE *ZEROS
    C           DNPAF7    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF7
F1  C                     END
    C*
D1  C           DTYPF8    IFNE *BLANKS
D2  C           DLZF8     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF8    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF8
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF8
D2  C           DNPAF8    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF8     IFNE *ZEROS
    C           DTYPF8    ORNE *BLANKS
    C           DNPAF8    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF8    IFNE *BLANKS
D2  C           DSFF8     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF8    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF8
D2  C           DNPAF8    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF8     IFNE *ZEROS
    C           DNPAF8    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF8
F1  C                     END
    C*
D1  C           DTYPF9    IFNE *BLANKS
D2  C           DLZF9     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF9    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYF9
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF9
D2  C           DNPAF9    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZF9     IFNE *ZEROS
    C           DTYPF9    ORNE *BLANKS
    C           DNPAF9    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXF9    IFNE *BLANKS
D2  C           DSFF9     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF9    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFF9
D2  C           DNPAF9    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFF9     IFNE *ZEROS
    C           DNPAF9    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFF9
F1  C                     END
    C*
D1  C           DTYPFA    IFNE *BLANKS
D2  C           DLZFA     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFA    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYFA
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXFA
D2  C           DNPAFA    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZFA     IFNE *ZEROS
    C           DTYPFA    ORNE *BLANKS
    C           DNPAFA    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXFA    IFNE *BLANKS
D2  C           DSFFA     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFA    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFFA
D2  C           DNPAFA    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFFA     IFNE *ZEROS
    C           DNPAFA    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFFA
F1  C                     END
    C*
D1  C           DTYPFB    IFNE *BLANKS
D2  C           DLZFB     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFB    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYFB
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXFB
D2  C           DNPAFB    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZFB     IFNE *ZEROS
    C           DTYPFB    ORNE *BLANKS
    C           DNPAFB    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXFB    IFNE *BLANKS
D2  C           DSFFB     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFB    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFFB
D2  C           DNPAFB    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFFB     IFNE *ZEROS
    C           DNPAFB    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFFB
F1  C                     END
    C*
D1  C           DTYPFC    IFNE *BLANKS
D2  C           DLZFC     IFEQ *ZEROS
     C                     MOVELERR,8     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFC    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,9     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTYFC
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXFC
D2  C           DNPAFC    IFEQ *BLANK
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DLZFC     IFNE *ZEROS
    C           DTYPFC    ORNE *BLANKS
    C           DNPAFC    ORNE *BLANK
     C                     MOVELERR,10    ERRDOR
    C                     GOTO SWDOP
F2  C                     END
F1  C                     END
D1  C           DFPXFC    IFNE *BLANKS
D2  C           DSFFC     IFEQ *ZEROS
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFC    PXVALE    P
     C           CLE3      CHAINPARAME               90
D2  C           *IN90     IFEQ '1'
     C                     MOVELERR,5     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE PXABRG    LTFFC
D2  C           DNPAFC    IFGT NPDOR
     C                     MOVELERR,7     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
X1  C                     ELSE
D2  C           DSFFC     IFNE *ZEROS
    C           DNPAFC    ORNE *BLANK
     C                     MOVELERR,4     ERRDOR
    C                     GOTO SWDOP
F2  C                     END
     C                     MOVE *BLANKS   LTFFC
F1  C                     END
     *
    C           SWDOP     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : MAJ ZONES FORMAT +                       *
     *--------------------------------------------------------*
    C           APPLUS    BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE XAUF1     GAUF11
     C                     MOVE XOGF1     NOGF11
     C                     MOVE XAUF2     GAUF21
     C                     MOVE XOGF2     NOGF21
     C                     MOVE XASSI     MASS11
     C                     MOVE XSINT     SSINT1
     C                     MOVE XXHAPI    CXHAI1
     C                     MOVE XAGAU1    XAGA11
     C                     MOVE XRGAU1    XRGA11
     C                     MOVE XAGAU2    XAGA21
     C                     MOVE XRGAU2    XRGA21
     C                     MOVE XSGF1     XSGF11
     C                     MOVE XSGF2     XSGF21
     C                     MOVE XSMAS     XSMAS1
     C                     MOVE XAMAS     XAMAS1
     C                     Z-ADDRASPX     RASPA1
     C                     Z-ADDXMASL     MASA1L
     C                     Z-ADDXMASH     MASA1H
     C                     MOVE XODDOR    £CODDO
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE XAUF1     GAUF12
     C                     MOVE XOGF1     NOGF12
     C                     MOVE XAUF2     GAUF22
     C                     MOVE XOGF2     NOGF22
     C                     MOVE XASSI     MASS12
     C                     MOVE XSINT     SSINT2
     C                     MOVE XXHAPI    CXHAI2
     C                     MOVE XAGAU1    XAGA12
     C                     MOVE XRGAU2    XRGA12
     C                     MOVE XAGAU2    XAGA22
     C                     MOVE XRGAU1    XRGA22
     C                     MOVE XSGF1     XSGF12
     C                     MOVE XSGF2     XSGF22
     C                     MOVE XSMAS     XSMAS2
     C                     MOVE XAMAS     XAMAS2
     C                     Z-ADDRASPX     RASPA2
     C                     Z-ADDXMASL     MASA2L
     C                     Z-ADDXMASH     MASA2H
     C                     MOVE XODDOR    $CODDO
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : MAJ ZONES FORMAT SOUS TRAITANCE          *
     *--------------------------------------------------------*
    C           APPST     BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE STCOD1    SCO1A1
     C                     MOVE STRE1     SRE1A1
     C                     MOVE STRO1     SRO1A1
     C                     MOVE STDEC1    SDE1A1
     C                     MOVE STCOD2    SCO2A1
     C                     MOVE STRE2     SRE2A1
     C                     MOVE STRO2     SRO2A1
     C                     MOVE STDEC2    SDE2A1
     C                     MOVE STCOD3    SCO3A1
     C                     MOVE STRE3     SRE3A1
     C                     MOVE STRO3     SRO3A1
     C                     MOVE STDEC3    SDE3A1
D2  C           £CODDO    IFEQ *BLANKS
     C                     MOVE REFDSS    £EFDOR
F2  C                     END
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE STCOD1    SCO1A2
     C                     MOVE STRE1     SRE1A2
     C                     MOVE STRO1     SRO1A2
     C                     MOVE STDEC1    SDE1A2
     C                     MOVE STCOD2    SCO2A2
     C                     MOVE STRE2     SRE2A2
     C                     MOVE STRO2     SRO2A2
     C                     MOVE STDEC2    SDE2A2
     C                     MOVE STCOD3    SCO3A2
     C                     MOVE STRE3     SRE3A2
     C                     MOVE STRO3     SRO3A2
     C                     MOVE STDEC3    SDE3A2
D2  C           $CODDO    IFEQ *BLANKS
     C                     MOVE REFDSS    $EFDOR
F2  C                     END
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : MAJ ZONES FORMAT DORURE                  *
     *--------------------------------------------------------*
    C           APPDOR    BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE DNATP1    £NATP1
     C                     MOVE DDIFP1    £DIFP1
     C                     MOVE DNATP2    £NATP2
     C                     MOVE DDIFP2    £DIFP2
     C                     MOVE DNATP3    £NATP3
     C                     MOVE DDIFP3    £DIFP3
     C                     MOVE DNATP4    £NATP4
     C                     MOVE DDIFP4    £DIFP4
     C                     MOVE DFPXF1    £FPXF1
     C                     Z-ADDDSFF1     £SFF1
     C                     MOVE DNPAF1    £NPAF1
     C                     MOVE DFPXF2    £FPXF2
     C                     Z-ADDDSFF2     £SFF2
     C                     MOVE DNPAF2    £NPAF2
     C                     MOVE DFPXF3    £FPXF3
     C                     Z-ADDDSFF3     £SFF3
     C                     MOVE DNPAF3    £NPAF3
     C                     MOVE DFPXF4    £FPXF4
     C                     Z-ADDDSFF4     £SFF4
     C                     MOVE DNPAF4    £NPAF4
     C                     MOVE DFPXF5    £FPXF5
     C                     Z-ADDDSFF5     £SFF5
     C                     MOVE DNPAF5    £NPAF5
     C                     MOVE DFPXF6    £FPXF6
     C                     Z-ADDDSFF6     £SFF6
     C                     MOVE DNPAF6    £NPAF6
     C                     MOVE DFPXF7    £FPXF7
     C                     Z-ADDDSFF7     £SFF7
     C                     MOVE DNPAF7    £NPAF7
     C                     MOVE DFPXF8    £FPXF8
     C                     Z-ADDDSFF8     £SFF8
     C                     MOVE DNPAF8    £NPAF8
     C                     MOVE DFPXF9    £FPXF9
     C                     Z-ADDDSFF9     £SFF9
     C                     MOVE DNPAF9    £NPAF9
     C                     MOVE DFPXFA    £FPXFA
     C                     Z-ADDDSFFA     £SFFA
     C                     MOVE DNPAFA    £NPAFA
     C                     MOVE DFPXFB    £FPXFB
     C                     Z-ADDDSFFB     £SFFB
     C                     MOVE DNPAFB    £NPAFB
     C                     MOVE DFPXFC    £FPXFC
     C                     Z-ADDDSFFC     £SFFC
     C                     MOVE DNPAFC    £NPAFC
     C                     Z-ADDDLZF1     £LZF1
     C                     Z-ADDDLZF2     £LZF2
     C                     Z-ADDDLZF3     £LZF3
     C                     Z-ADDDLZF4     £LZF4
     C                     Z-ADDDLZF5     £LZF5
     C                     Z-ADDDLZF6     £LZF6
     C                     Z-ADDDLZF7     £LZF7
     C                     Z-ADDDLZF8     £LZF8
     C                     Z-ADDDLZF9     £LZF9
     C                     MOVE DTYPF1    £TYPF1
     C                     MOVE DTYPF2    £TYPF2
     C                     MOVE DTYPF3    £TYPF3
     C                     MOVE DTYPF4    £TYPF4
     C                     MOVE DTYPF5    £TYPF5
     C                     MOVE DTYPF6    £TYPF6
     C                     MOVE DTYPF7    £TYPF7
     C                     MOVE DTYPF8    £TYPF8
     C                     MOVE DTYPF9    £TYPF9
     C                     Z-ADDDSMIP1    £SMIP1
     C                     Z-ADDDSMAP1    £SMAP1
     C                     Z-ADDDSMIP2    £SMIP2
     C                     Z-ADDDSMAP2    £SMAP2
     C                     MOVE REFDOR    £EFDOR
     C                     MOVE REFDO2    £EFDO2
     C                     MOVE DORGAM    £ORGAM
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE DNATP1    $NATP1
     C                     MOVE DDIFP1    $DIFP1
     C                     MOVE DNATP2    $NATP2
     C                     MOVE DDIFP2    $DIFP2
     C                     MOVE DNATP3    $NATP3
     C                     MOVE DDIFP3    $DIFP3
     C                     MOVE DNATP4    $NATP4
     C                     MOVE DDIFP4    $DIFP4
     C                     MOVE DFPXF1    $FPXF1
     C                     Z-ADDDSFF1     $SFF1
     C                     MOVE DNPAF1    $NPAF1
     C                     MOVE DFPXF2    $FPXF2
     C                     Z-ADDDSFF2     $SFF2
     C                     MOVE DNPAF2    $NPAF2
     C                     MOVE DFPXF3    $FPXF3
     C                     Z-ADDDSFF3     $SFF3
     C                     MOVE DNPAF3    $NPAF3
     C                     MOVE DFPXF4    $FPXF4
     C                     Z-ADDDSFF4     $SFF4
     C                     MOVE DNPAF4    $NPAF4
     C                     MOVE DFPXF5    $FPXF5
     C                     Z-ADDDSFF5     $SFF5
     C                     MOVE DNPAF5    $NPAF5
     C                     MOVE DFPXF6    $FPXF6
     C                     Z-ADDDSFF6     $SFF6
     C                     MOVE DNPAF6    $NPAF6
     C                     MOVE DFPXF7    $FPXF7
     C                     Z-ADDDSFF7     $SFF7
     C                     MOVE DNPAF7    $NPAF7
     C                     MOVE DFPXF8    $FPXF8
     C                     Z-ADDDSFF8     $SFF8
     C                     MOVE DNPAF8    $NPAF8
     C                     MOVE DFPXF9    $FPXF9
     C                     Z-ADDDSFF9     $SFF9
     C                     MOVE DNPAF9    $NPAF9
     C                     MOVE DFPXFA    $FPXFA
     C                     Z-ADDDSFFA     $SFFA
     C                     MOVE DNPAFA    $NPAFA
     C                     MOVE DFPXFB    $FPXFB
     C                     Z-ADDDSFFB     $SFFB
     C                     MOVE DNPAFB    $NPAFB
     C                     MOVE DFPXFC    $FPXFC
     C                     Z-ADDDSFFC     $SFFC
     C                     MOVE DNPAFC    $NPAFC
     C                     Z-ADDDLZF1     $LZF1
     C                     Z-ADDDLZF2     $LZF2
     C                     Z-ADDDLZF3     $LZF3
     C                     Z-ADDDLZF4     $LZF4
     C                     Z-ADDDLZF5     $LZF5
     C                     Z-ADDDLZF6     $LZF6
     C                     Z-ADDDLZF7     $LZF7
     C                     Z-ADDDLZF8     $LZF8
     C                     Z-ADDDLZF9     $LZF9
     C                     MOVE DTYPF1    $TYPF1
     C                     MOVE DTYPF2    $TYPF2
     C                     MOVE DTYPF3    $TYPF3
     C                     MOVE DTYPF4    $TYPF4
     C                     MOVE DTYPF5    $TYPF5
     C                     MOVE DTYPF6    $TYPF6
     C                     MOVE DTYPF7    $TYPF7
     C                     MOVE DTYPF8    $TYPF8
     C                     MOVE DTYPF9    $TYPF9
     C                     Z-ADDDSMIP1    $SMIP1
     C                     Z-ADDDSMAP1    $SMAP1
     C                     Z-ADDDSMIP2    $SMIP2
     C                     Z-ADDDSMAP2    $SMAP2
     C                     MOVE REFDOR    $EFDOR
     C                     MOVE REFDO2    $EFDO2
     C                     MOVE DORGAM    $ORGAM
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : RAZ ZONES FORMAT +                       *
     *--------------------------------------------------------*
    C           RZPLUS    BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE *BLANKS   GAUF11
     C                     MOVE *BLANKS   NOGF11
     C                     MOVE *BLANKS   GAUF21
     C                     MOVE *BLANKS   NOGF21
     C                     MOVE *BLANKS   MASS11
     C                     MOVE *BLANKS   SSINT1
     C                     MOVE *BLANKS   CXHAI1
     C                     Z-ADD*ZEROS    XAGA11
     C                     Z-ADD*ZEROS    XRGA11
     C                     Z-ADD*ZEROS    XAGA21
     C                     Z-ADD*ZEROS    XRGA21
     C                     Z-ADD*ZEROS    XSGF11
     C                     Z-ADD*ZEROS    XSGF21
     C                     Z-ADD*ZEROS    XSMAS1
     C                     Z-ADD*ZEROS    XAMAS1
     C                     Z-ADD*ZEROS    RASPA1
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE *BLANKS   GAUF12
     C                     MOVE *BLANKS   NOGF12
     C                     MOVE *BLANKS   GAUF22
     C                     MOVE *BLANKS   NOGF22
     C                     MOVE *BLANKS   MASS12
     C                     MOVE *BLANKS   SSINT2
     C                     MOVE *BLANKS   CXHAI2
     C                     Z-ADD*ZEROS    XAGA12
     C                     Z-ADD*ZEROS    XRGA12
     C                     Z-ADD*ZEROS    XAGA22
     C                     Z-ADD*ZEROS    XRGA22
     C                     Z-ADD*ZEROS    XSGF12
     C                     Z-ADD*ZEROS    XSGF22
     C                     Z-ADD*ZEROS    XSMAS2
     C                     Z-ADD*ZEROS    XAMAS2
     C                     Z-ADD*ZEROS    RASPA2
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : RAZ ZONES FORMAT SOUS TRAITANCE          *
     *--------------------------------------------------------*
    C           RZST      BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE *BLANKS   SCO1A1
     C                     MOVE *BLANKS   SRE1A1
     C                     MOVE *BLANKS   SRO1A1
     C                     MOVE *BLANKS   SDE1A1
     C                     MOVE *BLANKS   SCO2A1
     C                     MOVE *BLANKS   SRE2A1
     C                     MOVE *BLANKS   SRO2A1
     C                     MOVE *BLANKS   SDE2A1
     C                     MOVE *BLANKS   SCO3A1
     C                     MOVE *BLANKS   SRE3A1
     C                     MOVE *BLANKS   SRO3A1
     C                     MOVE *BLANKS   SDE3A1
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE *BLANKS   SCO1A2
     C                     MOVE *BLANKS   SRE1A2
     C                     MOVE *BLANKS   SRO1A2
     C                     MOVE *BLANKS   SDE1A2
     C                     MOVE *BLANKS   SCO2A2
     C                     MOVE *BLANKS   SRE2A2
     C                     MOVE *BLANKS   SRO2A2
     C                     MOVE *BLANKS   SDE2A2
     C                     MOVE *BLANKS   SCO3A2
     C                     MOVE *BLANKS   SRE3A2
     C                     MOVE *BLANKS   SRO3A2
     C                     MOVE *BLANKS   SDE3A2
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : RAZ ZONES FORMAT SOUS TRAITANCE          *
     *--------------------------------------------------------*
    C           RZDOR     BEGSR
     *          ---------------
D1  C           *IN81     IFEQ '1'
     C                     MOVE *BLANKS   £CODDO
     C                     MOVE *BLANKS   £NATP1
     C                     MOVE *BLANKS   £DIFP1
     C                     MOVE *BLANKS   £NATP2
     C                     MOVE *BLANKS   £DIFP2
     C                     MOVE *BLANKS   £NATP3
     C                     MOVE *BLANKS   £DIFP3
     C                     MOVE *BLANKS   £NATP4
     C                     MOVE *BLANKS   £DIFP4
     C                     MOVE *BLANKS   £FPXF1
     C                     Z-ADD*ZEROS    £SFF1
     C                     MOVE *BLANKS   £NPAF1
     C                     MOVE *BLANKS   £FPXF2
     C                     Z-ADD*ZEROS    £SFF2
     C                     MOVE *BLANKS   £NPAF2
     C                     MOVE *BLANKS   £FPXF3
     C                     Z-ADD*ZEROS    £SFF3
     C                     MOVE *BLANKS   £NPAF3
     C                     MOVE *BLANKS   £FPXF4
     C                     Z-ADD*ZEROS    £SFF4
     C                     MOVE *BLANKS   £NPAF4
     C                     MOVE *BLANKS   £FPXF5
     C                     Z-ADD*ZEROS    £SFF5
     C                     MOVE *BLANKS   £NPAF5
     C                     MOVE *BLANKS   £FPXF6
     C                     Z-ADD*ZEROS    £SFF6
     C                     MOVE *BLANKS   £NPAF6
     C                     MOVE *BLANKS   £FPXF7
     C                     Z-ADD*ZEROS    £SFF7
     C                     MOVE *BLANKS   £NPAF7
     C                     MOVE *BLANKS   £FPXF8
     C                     Z-ADD*ZEROS    £SFF8
     C                     MOVE *BLANKS   £NPAF8
     C                     MOVE *BLANKS   £FPXF9
     C                     Z-ADD*ZEROS    £SFF9
     C                     MOVE *BLANKS   £NPAF9
     C                     MOVE *BLANKS   £FPXFA
     C                     Z-ADD*ZEROS    £SFFA
     C                     MOVE *BLANKS   £NPAFA
     C                     MOVE *BLANKS   £FPXFB
     C                     Z-ADD*ZEROS    £SFFB
     C                     MOVE *BLANKS   £NPAFB
     C                     MOVE *BLANKS   £FPXFC
     C                     Z-ADD*ZEROS    £SFFC
     C                     MOVE *BLANKS   £NPAFC
     C                     Z-ADD*ZEROS    £LZF1
     C                     Z-ADD*ZEROS    £LZF2
     C                     Z-ADD*ZEROS    £LZF3
     C                     Z-ADD*ZEROS    £LZF4
     C                     Z-ADD*ZEROS    £LZF5
     C                     Z-ADD*ZEROS    £LZF6
     C                     Z-ADD*ZEROS    £LZF7
     C                     Z-ADD*ZEROS    £LZF8
     C                     Z-ADD*ZEROS    £LZF9
     C                     MOVE *BLANKS   £TYPF1
     C                     MOVE *BLANKS   £TYPF2
     C                     MOVE *BLANKS   £TYPF3
     C                     MOVE *BLANKS   £TYPF4
     C                     MOVE *BLANKS   £TYPF5
     C                     MOVE *BLANKS   £TYPF6
     C                     MOVE *BLANKS   £TYPF7
     C                     MOVE *BLANKS   £TYPF8
     C                     MOVE *BLANKS   £TYPF9
     C                     Z-ADD*ZEROS    £SMIP1
     C                     Z-ADD*ZEROS    £SMAP1
     C                     Z-ADD*ZEROS    £SMIP2
     C                     Z-ADD*ZEROS    £SMAP2
     C                     MOVE *BLANKS   £EFDOR
     C                     MOVE *BLANKS   £EFDO2
     C                     MOVE *BLANKS   £ORGAM
F1  C                     END
D1  C           *IN82     IFEQ '1'
     C                     MOVE *BLANKS   $CODDO
     C                     MOVE *BLANKS   $NATP1
     C                     MOVE *BLANKS   $DIFP1
     C                     MOVE *BLANKS   $NATP2
     C                     MOVE *BLANKS   $DIFP2
     C                     MOVE *BLANKS   $NATP3
     C                     MOVE *BLANKS   $DIFP3
     C                     MOVE *BLANKS   $NATP4
     C                     MOVE *BLANKS   $DIFP4
     C                     MOVE *BLANKS   $FPXF1
     C                     Z-ADD*ZEROS    $SFF1
     C                     MOVE *BLANKS   $NPAF1
     C                     MOVE *BLANKS   $FPXF2
     C                     Z-ADD*ZEROS    $SFF2
     C                     MOVE *BLANKS   $NPAF2
     C                     MOVE *BLANKS   $FPXF3
     C                     Z-ADD*ZEROS    $SFF3
     C                     MOVE *BLANKS   $NPAF3
     C                     MOVE *BLANKS   $FPXF4
     C                     Z-ADD*ZEROS    $SFF4
     C                     MOVE *BLANKS   $NPAF4
     C                     MOVE *BLANKS   $FPXF5
     C                     Z-ADD*ZEROS    $SFF5
     C                     MOVE *BLANKS   $NPAF5
     C                     MOVE *BLANKS   $FPXF6
     C                     Z-ADD*ZEROS    $SFF6
     C                     MOVE *BLANKS   $NPAF6
     C                     MOVE *BLANKS   $FPXF7
     C                     Z-ADD*ZEROS    $SFF7
     C                     MOVE *BLANKS   $NPAF7
     C                     MOVE *BLANKS   $FPXF8
     C                     Z-ADD*ZEROS    $SFF8
     C                     MOVE *BLANKS   $NPAF8
     C                     MOVE *BLANKS   $FPXF9
     C                     Z-ADD*ZEROS    $SFF9
     C                     MOVE *BLANKS   $NPAF9
     C                     MOVE *BLANKS   $FPXFA
     C                     Z-ADD*ZEROS    $SFFA
     C                     MOVE *BLANKS   $NPAFA
     C                     MOVE *BLANKS   $FPXFB
     C                     Z-ADD*ZEROS    $SFFB
     C                     MOVE *BLANKS   $NPAFB
     C                     MOVE *BLANKS   $FPXFC
     C                     Z-ADD*ZEROS    $SFFC
     C                     MOVE *BLANKS   $NPAFC
     C                     Z-ADD*ZEROS    $LZF1
     C                     Z-ADD*ZEROS    $LZF2
     C                     Z-ADD*ZEROS    $LZF3
     C                     Z-ADD*ZEROS    $LZF4
     C                     Z-ADD*ZEROS    $LZF5
     C                     Z-ADD*ZEROS    $LZF6
     C                     Z-ADD*ZEROS    $LZF7
     C                     Z-ADD*ZEROS    $LZF8
     C                     Z-ADD*ZEROS    $LZF9
     C                     MOVE *BLANKS   $TYPF1
     C                     MOVE *BLANKS   $TYPF2
     C                     MOVE *BLANKS   $TYPF3
     C                     MOVE *BLANKS   $TYPF4
     C                     MOVE *BLANKS   $TYPF5
     C                     MOVE *BLANKS   $TYPF6
     C                     MOVE *BLANKS   $TYPF7
     C                     MOVE *BLANKS   $TYPF8
     C                     MOVE *BLANKS   $TYPF9
     C                     Z-ADD*ZEROS    $SMIP1
     C                     Z-ADD*ZEROS    $SMAP1
     C                     Z-ADD*ZEROS    $SMIP2
     C                     Z-ADD*ZEROS    $SMAP2
     C                     MOVE *BLANKS   $EFDOR
     C                     MOVE *BLANKS   $EFDO2
     C                     MOVE *BLANKS   $ORGAM
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   SI PRODUIT PREPARATION                           *
    C* ---------------------------------------------------*
    C           PREPA     BEGSR
    C*          ---------------
     C                     MOVE Z1        STE     10
     C                     MOVE Z2        NOCLI
     C                     MOVE Z3        PRODOR
     C           KPRO      CHAINPRODS3L1             50
D1  C           *IN50     DOWEQ'0'
D2  C           SUPOR     IFEQ 'E'
     C                     Z-ADDNOPRO     NOPAFE
     C                     MOVE PAPA      PAPA1
     C                     MOVE GRAA      GRAA1
     C                     MOVE REFA      REFA1
     C                     MOVE GRELA     GRELA1
     C                     MOVE LA        LA1
     C                     MOVE HA        HA1
     C                     MOVE LAIA      LAIA1
     C                     MOVE IMPA      IMPA1
     C                     MOVE USA       USA1
     C                     MOVE COUA      COUA1
     C                     MOVE ENCA      ENCA1
     C                     MOVE TSA       TSA1
     C                     MOVE GRPA      GRPA1
     C                     MOVE UVA       UVA1
     C                     MOVE NATA      NATA1
     C                     MOVE TVEA      TVEA1
     C                     MOVE CVEA      CVEA1
     C                     MOVE ORA       ORA1
     C                     MOVE FLUA      FLUA1
     C                     MOVE CFLA      CFLA1
     C                     MOVE ESPA      ESPA1
     C                     MOVE VSPA      VSPA1
     C                     MOVE DDEA      DDEA1
     C                     MOVE DAPA      DAPA1
     C                     MOVE RIMA1     RIMA11
     C                     MOVE COUAR     COUA1R
     C                     MOVE ENCAR     ENCA1R
     C                     MOVE TSAR      TSA1R
     C                     MOVE GRPAR     GRPA1R
     C                     MOVE UVAR      UVA1R
     C                     MOVE NATAR     NATA1R
     C                     MOVE TVEAR     TVEA1R
     C                     MOVE CVEAR     CVEA1R
     C                     MOVE ORAR      ORA1R
     C                     MOVE FLUAR     FLUA1R
     C                     MOVE CFLAR     CFLA1R
     C                     MOVE ESPAR     ESPA1R
     C                     MOVE VSPAR     VSPA1R
     C                     MOVE DDEAR     DDEA1R
     C                     MOVE DAPAR     DAPA1R
     C                     MOVE CLIA      CLIA1
     C                     MOVE CLIAR     CLIA1R
     C                     MOVE GAUF1     GAUF11
     C                     MOVE NOGF1     NOGF11
     C                     MOVE GAUF2     GAUF21
     C                     MOVE NOGF2     NOGF21
     C                     MOVE MASSI     MASS11
     C                     MOVE SSINT     SSINT1
     C                     MOVE CXHAPI    CXHAI1
     C                     MOVE MAIME1    XAIME1
     C                     MOVE MAIME2    XAIME2
     C                     MOVE MAIME3    XAIME3
     C                     MOVE MAIME4    XAIME4
     C                     MOVE MAIME5    XAIME5
     C                     MOVE MIMRE1    XIMRE1
     C                     MOVE MIMRE2    XIMRE2
     C                     MOVE MIMRE3    XIMRE3
     C                     MOVE MIMRE4    XIMRE4
     C                     MOVE MIMRE5    XIMRE5
     C                     MOVE RMIME1    XMIME1
     C                     MOVE RMIME2    XMIME2
     C                     MOVE RMIME3    XMIME3
     C                     MOVE RMIME4    XMIME4
     C                     MOVE RMIME5    XMIME5
     C                     MOVE RMIRE1    XMIRE1
     C                     MOVE RMIRE2    XMIRE2
     C                     MOVE RMIRE3    XMIRE3
     C                     MOVE RMIRE4    XMIRE4
     C                     MOVE RMIRE5    XMIRE5
     C                     MOVE MAGAU1    XAGA11  20
     C                     MOVE MRGAU1    XRGA11  20
     C                     MOVE MAGAU2    XAGA21  20
     C                     MOVE MRGAU2    XRGA21  20
     C                     MOVE USGF1     XSGF11  10
     C                     MOVE USGF2     XSGF21  10
     C                     MOVE USMAS     XSMAS1  10
     C                     MOVE MAMAS     XAMAS1  20
     C                     MOVE GP1       GP1A1
     C                     MOVE GP2       GP2A1
     C                     MOVE GP3       GP3A1
     C                     MOVE MATC      MATA1C
    C*                    MOVE MATM      MATA1M
     C                     MOVE GP1R      GP1A1R
     C                     MOVE GP2R      GP2A1R
     C                     MOVE MATCR     MAA1RC
     C                     MOVE MATMR     MAA1RM
     C                     MOVE SS        SSA1
     C                     MOVE PRDI      PRDIA1
     C                     MOVE PRGR      PRGRA1
     C                     MOVE PROU      PROUA1
     C                     MOVE PEFF      PEFFA1
     C                     MOVE PDEC      PDECA1
     C                     MOVE RETP      RETPA1
     C                     MOVE ROCA      ROCAA1
     C                     MOVE SSR       SSA1R
     C                     MOVE PRDIR     PRDA1R
     C                     MOVE PRGRR     PRGA1R
     C                     MOVE PROUR     PROA1R
     C                     MOVE PEFFR     PEFA1R
     C                     MOVE PDECR     PDEA1R
     C                     MOVE RETPR     RETA1R
     C                     MOVE ROCAR     ROCA1R
     C                     MOVE SSGA      SSG1
     C                     MOVE PRDIGA    PRDIG1
     C                     MOVE PRGRGA    PRGRG1
     C                     MOVE PROUGA    PROUG1
     C                     MOVE PEFFGA    PEFFG1
     C                     MOVE PDECGA    PDECG1
     C                     MOVE RETPGA    RETPG1
     C                     MOVE ROCAGA    ROCAG1
     C                     MOVE SSGB      SSG2
     C                     MOVE PRDIGB    PRDIG2
     C                     MOVE PRGRGB    PRGRG2
     C                     MOVE PROUGB    PROUG2
     C                     MOVE PEFFGB    PEFFG2
     C                     MOVE PDECGB    PDECG2
     C                     MOVE RETPGB    RETPG2
     C                     MOVE ROCAGB    ROCAG2
     C                     Z-ADDRASPA     RASPA1  32
     C                     MOVE INPLAA    INDPA1  1
     C                     MOVE PI1A      PI1A1
     C                     MOVE PI2A      PI2A1
     C                     Z-ADDFMASAL    MASA1L  40
     C                     Z-ADDFMASAH    MASA1H  40
     C                     MOVE SCOD1     SCO1A1
     C                     MOVE SREG1     SRE1A1
     C                     MOVE SROU1     SRO1A1
     C                     MOVE SDEC1     SDE1A1
     C                     MOVE SCOD2     SCO2A1
     C                     MOVE SREG2     SRE2A1
     C                     MOVE SROU2     SRO2A1
     C                     MOVE SDEC2     SDE2A1
     C                     MOVE SCOD3     SCO3A1
     C                     MOVE SRER3     SRE3A1
     C                     MOVE SROU3     SRO3A1
     C                     MOVE SDEC3     SDE3A1
     C                     Z-ADDLFPEAP    LPEAP1
     C                     Z-ADDLFPEUT    LPEUT1
     C                     MOVE INVPEL    INVPA1
     C                     MOVE CODDOR    £CODDO
     C                     MOVE DNATP1    £NATP1
     C                     MOVE DDIFP1    £DIFP1
     C                     MOVE DNATP2    £NATP2
     C                     MOVE DDIFP2    £DIFP2
     C                     MOVE DNATP3    £NATP3
     C                     MOVE DDIFP3    £DIFP3
     C                     MOVE DNATP4    £NATP4
     C                     MOVE DDIFP4    £DIFP4
     C                     MOVE DFPXF1    £FPXF1
     C                     Z-ADDDSFF1     £SFF1
     C                     MOVE DNPAF1    £NPAF1
     C                     MOVE DFPXF2    £FPXF2
     C                     Z-ADDDSFF2     £SFF2
     C                     MOVE DNPAF2    £NPAF2
     C                     MOVE DFPXF3    £FPXF3
     C                     Z-ADDDSFF3     £SFF3
     C                     MOVE DNPAF3    £NPAF3
     C                     MOVE DFPXF4    £FPXF4
     C                     Z-ADDDSFF4     £SFF4
     C                     MOVE DNPAF4    £NPAF4
     C                     MOVE DFPXF5    £FPXF5
     C                     Z-ADDDSFF5     £SFF5
     C                     MOVE DNPAF5    £NPAF5
     C                     MOVE DFPXF6    £FPXF6
     C                     Z-ADDDSFF6     £SFF6
     C                     MOVE DNPAF6    £NPAF6
     C                     MOVE DFPXF7    £FPXF7
     C                     Z-ADDDSFF7     £SFF7
     C                     MOVE DNPAF7    £NPAF7
     C                     MOVE DFPXF8    £FPXF8
     C                     Z-ADDDSFF8     £SFF8
     C                     MOVE DNPAF8    £NPAF8
     C                     MOVE DFPXF9    £FPXF9
     C                     Z-ADDDSFF9     £SFF9
     C                     MOVE DNPAF9    £NPAF9
     C                     MOVE DFPXFA    £FPXFA
     C                     Z-ADDDSFFA     £SFFA
     C                     MOVE DNPAFA    £NPAFA
     C                     MOVE DFPXFB    £FPXFB
     C                     Z-ADDDSFFB     £SFFB
     C                     MOVE DNPAFB    £NPAFB
     C                     MOVE DFPXFC    £FPXFC
     C                     Z-ADDDSFFC     £SFFC
     C                     MOVE DNPAFC    £NPAFC
     C                     Z-ADDDLZF1     £LZF1   30
     C                     Z-ADDDLZF2     £LZF2   30
     C                     Z-ADDDLZF3     £LZF3   30
     C                     Z-ADDDLZF4     £LZF4   30
     C                     Z-ADDDLZF5     £LZF5   30
     C                     Z-ADDDLZF6     £LZF6   30
     C                     Z-ADDDLZF7     £LZF7   30
     C                     Z-ADDDLZF8     £LZF8   30
     C                     Z-ADDDLZF9     £LZF9   30
     C                     Z-ADDDLZFA     £LZFA   30
     C                     Z-ADDDLZFB     £LZFB   30
     C                     Z-ADDDLZFC     £LZFC   30
     C                     MOVE DTYPF1    £TYPF1  4
     C                     MOVE DTYPF2    £TYPF2  4
     C                     MOVE DTYPF3    £TYPF3  4
     C                     MOVE DTYPF4    £TYPF4  4
     C                     MOVE DTYPF5    £TYPF5  4
     C                     MOVE DTYPF6    £TYPF6  4
     C                     MOVE DTYPF7    £TYPF7  4
     C                     MOVE DTYPF8    £TYPF8  4
     C                     MOVE DTYPF9    £TYPF9  4
     C                     MOVE DTYPFA    £TYPFA  4
     C                     MOVE DTYPFB    £TYPFB  4
     C                     MOVE DTYPFC    £TYPFC  4
     C                     MOVE WSD1      SSD1
     C                     MOVE WRDID1    PRDID1
     C                     MOVE WRGRD1    PRGRD1
     C                     MOVE WROUD1    PROUD1
     C                     MOVE WEFFD1    PEFFD1
     C                     MOVE WDECD1    PDECD1
     C                     MOVE WETPD1    RETPD1
     C                     MOVE WOCAD1    ROCAD1
     C                     MOVE WSD2      SSD2
     C                     MOVE WRDID2    PRDID2
     C                     MOVE WRGRD2    PRGRD2
     C                     MOVE WROUD2    PROUD2
     C                     MOVE WEFFD2    PEFFD2
     C                     MOVE WDECD2    PDECD2
     C                     MOVE WETPD2    RETPD2
     C                     MOVE WOCAD2    ROCAD2
     C                     MOVE WSDA      SSDA
     C                     MOVE WRDIDA    PRDIDA
     C                     MOVE WRGRDA    PRGRDA
     C                     MOVE WROUDA    PROUDA
     C                     MOVE WEFFDA    PEFFDA
     C                     MOVE WDECDA    PDECDA
     C                     MOVE WETPDA    RETPDA
     C                     MOVE WOCADA    ROCADA
     C                     MOVE WSDB      SSDB
     C                     MOVE WRDIDB    PRDIDB
     C                     MOVE WRGRDB    PRGRDB
     C                     MOVE WROUDB    PROUDB
     C                     MOVE WEFFDB    PEFFDB
     C                     MOVE WDECDB    PDECDB
     C                     MOVE WETPDB    RETPDB
     C                     MOVE WOCADB    ROCADB
     C                     Z-ADDDSMIP1    £SMIP1  30
     C                     Z-ADDDSMAP1    £SMAP1  30
     C                     Z-ADDDSMIP2    £SMIP2  30
     C                     Z-ADDDSMAP2    £SMAP2  30
     C                     MOVE RFDORA    £EFDOR  3
     C                     MOVE WEFDO2    £EFDO2  3
     C                     MOVE REFDO3    £EFDO3  3
     C                     MOVE REFDO4    £EFDO4  3
     C                     MOVE WORGAM    £ORGAM  1
     C                     Z-ADD*ZEROS    LZAPA1  41
     C                     Z-ADD*ZEROS    FLAPA1  40
     C                     Z-ADD*ZEROS    FHAPA1  40
     * OFFSET 3B
     C                     Z-ADDATCOP     ATCOEP
     C                     Z-ADDAUSIP     OSIMAC
     C                     MOVE AMACP     AMACEP
     C                     Z-ADDAGEP1     AGEEP1
     C                     Z-ADDAGEP2     AGEEP2
     C                     Z-ADDAGEP3     AGEEP3
     C                     MOVE ATE1P     ATE1EP
     C                     MOVE ANE1P     ANE1EP
     C                     Z-ADDAPE1P     APE1EP
     C                     MOVE ATE2P     ATE2EP
     C                     MOVE ANE2P     ANE2EP
     C                     Z-ADDAPE2P     APE2EP
     C                     MOVE ATOAP     ATOAEP
     C                     Z-ADDAPOAP     APOAEP
     C                     MOVE ATEFP     ATEFEP
     C                     Z-ADDAPEFP     APEFEP
     C                     Z-ADDAMESP     AMESEP
     C                     MOVE ATEMP     ATEMEP
     C                     Z-ADDAPEMP     APEMEP
     C                     Z-ADDADPP      ADPEP
     C                     MOVE ADF1P     ADF1EP
     C                     Z-ADDADS1P     ADS1EP
     C                     MOVE ADT1P     ADT1EP
     C                     Z-ADDADL1P     ADL1EP
     C                     MOVE ADF2P     ADF2EP
     C                     Z-ADDADS2P     ADS2EP
     C                     MOVE ADT2P     ADT2EP
     C                     Z-ADDADL2P     ADL2EP
     C                     MOVE ADF3P     ADF3EP
     C                     Z-ADDADS3P     ADS3EP
     C                     MOVE ADT3P     ADT3EP
     C                     Z-ADDADL3P     ADL3EP
     C                     MOVE ATV1P     ATV1EP
     C                     Z-ADDAPV1P     APV1EP
     C                     Z-ADDAMV1P     AMV1EP
     C                     MOVE AV1P1     AV1EP1
     C                     MOVE AV1P2     AV1EP2
     C                     MOVE AV1P3     AV1EP3
     C                     MOVE ATV2P     ATV2EP
     C                     Z-ADDAPV2P     APV2EP
     C                     Z-ADDAMV2P     AMV2EP
     C                     MOVE AV2P1     AV2EP1
     C                     MOVE AV2P2     AV2EP2
     C                     MOVE AV2P3     AV2EP3
     C                     MOVE ATV3P     ATV3EP
     C                     Z-ADDAPV3P     APV3EP
     C                     Z-ADDAMV3P     AMV3EP
     C                     MOVE AV3P1     AV3EP1
     C                     MOVE AV3P2     AV3EP2
     C                     MOVE AV3P3     AV3EP3
     C                     MOVE ADPRP     ADPREP
     C                     MOVE ATGP      ATGEP
     C                     MOVE AGGP      AGGEP
     C                     MOVE ADDP      ADDEP
     C                     MOVE ADAP      ADAEP
     C                     MOVE ATSSP     ATSSEP
     C                     MOVE ATMP      ATMEP
     C                     Z-ADDAGER1     AGEER1
     C                     MOVE ATE1R     ATE1ER
     C                     MOVE ANE1R     ANE1ER
     C                     Z-ADDAPE1R     APE1ER
     C                     Z-ADDAMESR     AMESER
     C                     MOVE ATV1R     ATV1ER
     C                     Z-ADDAPV1R     APV1ER
     C                     Z-ADDAMV1R     AMV1ER
     *
     C           KPST5     CHAINPRODST5              99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDLZAPP     LZAPA1
     C                     Z-ADDFLAPP     FLAPA1
     C                     Z-ADDFHAPP     FHAPA1
F3  C                     END
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     Z-ADDNOPRO     NOPAFI
     C                     MOVELNOPRO     XX1     10
     C                     MOVE PAPA      PAPA2
     C                     MOVE GRAA      GRAA2
     C                     MOVE REFA      REFA2
     C                     MOVE GRELA     GRELA2
     C                     MOVE LA        LA2
     C                     MOVE HA        HA2
     C                     MOVE LAIA      LAIA2
     C                     MOVE IMPA      IMPA2
     C                     MOVE USA       USA2
     C                     MOVE COUA      COUA2
     C                     MOVE ENCA      ENCA2
     C                     MOVE TSA       TSA2
     C                     MOVE GRPA      GRPA2
     C                     MOVE UVA       UVA2
     C                     MOVE NATA      NATA2
     C                     MOVE TVEA      TVEA2
     C                     MOVE CVEA      CVEA2
     C                     MOVE ORA       ORA2
     C                     MOVE FLUA      FLUA2
     C                     MOVE CFLA      CFLA2
     C                     MOVE ESPA      ESPA2
     C                     MOVE VSPA      VSPA2
     C                     MOVE DDEA      DDEA2
     C                     MOVE DAPA      DAPA2
     C                     MOVE RIMA1     RIMA12
     C                     MOVE COUAR     COUA2R
     C                     MOVE ENCAR     ENCA2R
     C                     MOVE TSAR      TSA2R
     C                     MOVE GRPAR     GRPA2R
     C                     MOVE UVAR      UVA2R
     C                     MOVE NATAR     NATA2R
     C                     MOVE TVEAR     TVEA2R
     C                     MOVE CVEAR     CVEA2R
     C                     MOVE ORAR      ORA2R
     C                     MOVE FLUAR     FLUA2R
     C                     MOVE CFLAR     CFLA2R
     C                     MOVE ESPAR     ESPA2R
     C                     MOVE VSPAR     VSPA2R
     C                     MOVE DDEAR     DDEA2R
     C                     MOVE DAPAR     DAPA2R
     C                     MOVE CLIA      CLIA2
     C                     MOVE CLIAR     CLIA2R
     C                     MOVE GAUF1     GAUF12
     C                     MOVE NOGF1     NOGF12
     C                     MOVE GAUF2     GAUF22
     C                     MOVE NOGF2     NOGF22
     C                     MOVE MASSI     MASS12
     C                     MOVE SSINT     SSINT2
     C                     MOVE CXHAPI    CXHAI2
     C                     MOVE MAIME1    XAIMI1
     C                     MOVE MAIME2    XAIMI2
     C                     MOVE MAIME3    XAIMI3
     C                     MOVE MAIME4    XAIMI4
     C                     MOVE MAIME5    XAIMI5
     C                     MOVE MIMRE1    XIMRI1
     C                     MOVE MIMRE2    XIMRI2
     C                     MOVE MIMRE3    XIMRI3
     C                     MOVE MIMRE4    XIMRI4
     C                     MOVE MIMRE5    XIMRI5
     C                     MOVE RMIME1    XMIMI1
     C                     MOVE RMIME2    XMIMI2
     C                     MOVE RMIME3    XMIMI3
     C                     MOVE RMIME4    XMIMI4
     C                     MOVE RMIME5    XMIMI5
     C                     MOVE RMIRE1    XMIRI1
     C                     MOVE RMIRE2    XMIRI2
     C                     MOVE RMIRE3    XMIRI3
     C                     MOVE RMIRE4    XMIRI4
     C                     MOVE RMIRE5    XMIRI5
     C                     MOVE MAGAU1    XAGA12  20
     C                     MOVE MRGAU1    XRGA12  20
     C                     MOVE MAGAU2    XAGA22  20
     C                     MOVE MRGAU2    XRGA22  20
     C                     MOVE USGF1     XSGF12  10
     C                     MOVE USGF2     XSGF22  10
     C                     MOVE USMAS     XSMAS2  10
     C                     MOVE MAMAS     XAMAS2  20
     C                     MOVE GP1       GP1A2
     C                     MOVE GP2       GP2A2
     C                     MOVE GP3       GP3A2
     C                     MOVE MATC      MATA2C
     C                     MOVE MATM      MATA2M
     C                     MOVE GP1R      GP1A2R
     C                     MOVE GP2R      GP2A2R
     C                     MOVE MATCR     MAA2RC
     C                     MOVE MATMR     MAA2RM
     C                     MOVE SS        SSA2
     C                     MOVE PRDI      PRDIA2
     C                     MOVE PRGR      PRGRA2
     C                     MOVE PROU      PROUA2
     C                     MOVE PEFF      PEFFA2
     C                     MOVE PDEC      PDECA2
     C                     MOVE RETP      RETPA2
     C                     MOVE ROCA      ROCAA2
     C                     MOVE SSR       SSA2R
     C                     MOVE PRDIR     PRDA2R
     C                     MOVE PRGRR     PRGA2R
     C                     MOVE PROUR     PROA2R
     C                     MOVE PEFFR     PEFA2R
     C                     MOVE PDECR     PDEA2R
     C                     MOVE RETPR     RETA2R
     C                     MOVE ROCAR     ROCA2R
     C                     MOVE SSGA      SSG3
     C                     MOVE PRDIGA    PRDIG3
     C                     MOVE PRGRGA    PRGRG3
     C                     MOVE PROUGA    PROUG3
     C                     MOVE PEFFGA    PEFFG3
     C                     MOVE PDECGA    PDECG3
     C                     MOVE RETPGA    RETPG3
     C                     MOVE ROCAGA    ROCAG3
     C                     MOVE SSGB      SSG4
     C                     MOVE PRDIGB    PRDIG4
     C                     MOVE PRGRGB    PRGRG4
     C                     MOVE PROUGB    PROUG4
     C                     MOVE PEFFGB    PEFFG4
     C                     MOVE PDECGB    PDECG4
     C                     MOVE RETPGB    RETPG4
     C                     MOVE ROCAGB    ROCAG4
     C                     Z-ADDRASPA     RASPA2  32
     C                     MOVE INPLAA    INDPA2  1
     C                     MOVE PI1A      PI1A2
     C                     MOVE PI2A      PI2A2
     C                     Z-ADDFMASAL    MASA2L  40
     C                     Z-ADDFMASAH    MASA2H  40
     C                     MOVE SCOD1     SCO1A2
     C                     MOVE SREG1     SRE1A2
     C                     MOVE SROU1     SRO1A2
     C                     MOVE SDEC1     SDE1A2
     C                     MOVE SCOD2     SCO2A2
     C                     MOVE SREG2     SRE2A2
     C                     MOVE SROU2     SRO2A2
     C                     MOVE SDEC2     SDE2A2
     C                     MOVE SCOD3     SCO3A2
     C                     MOVE SRER3     SRE3A2
     C                     MOVE SROU3     SRO3A2
     C                     MOVE SDEC3     SDE3A2
     C                     Z-ADDLFPEAP    LPEAP2
     C                     Z-ADDLFPEUT    LPEUT2
     C                     MOVE INVPEL    INVPA2
     C                     MOVE CODDOR    $CODDO
     C                     MOVE DNATP1    $NATP1
     C                     MOVE DDIFP1    $DIFP1
     C                     MOVE DNATP2    $NATP2
     C                     MOVE DDIFP2    $DIFP2
     C                     MOVE DNATP3    $NATP3
     C                     MOVE DDIFP3    $DIFP3
     C                     MOVE DNATP4    $NATP4
     C                     MOVE DDIFP4    $DIFP4
     C                     MOVE DFPXF1    $FPXF1
     C                     Z-ADDDSFF1     $SFF1
     C                     MOVE DNPAF1    $NPAF1
     C                     MOVE DFPXF2    $FPXF2
     C                     Z-ADDDSFF2     $SFF2
     C                     MOVE DNPAF2    $NPAF2
     C                     MOVE DFPXF3    $FPXF3
     C                     Z-ADDDSFF3     $SFF3
     C                     MOVE DNPAF3    $NPAF3
     C                     MOVE DFPXF4    $FPXF4
     C                     Z-ADDDSFF4     $SFF4
     C                     MOVE DNPAF4    $NPAF4
     C                     MOVE DFPXF5    $FPXF5
     C                     Z-ADDDSFF5     $SFF5
     C                     MOVE DNPAF5    $NPAF5
     C                     MOVE DFPXF6    $FPXF6
     C                     Z-ADDDSFF6     $SFF6
     C                     MOVE DNPAF6    $NPAF6
     C                     MOVE DFPXF7    $FPXF7
     C                     Z-ADDDSFF7     $SFF7
     C                     MOVE DNPAF7    $NPAF7
     C                     MOVE DFPXF8    $FPXF8
     C                     Z-ADDDSFF8     $SFF8
     C                     MOVE DNPAF8    $NPAF8
     C                     MOVE DFPXF9    $FPXF9
     C                     Z-ADDDSFF9     $SFF9
     C                     MOVE DNPAF9    $NPAF9
     C                     MOVE DFPXFA    $FPXFA
     C                     Z-ADDDSFFA     $SFFA
     C                     MOVE DNPAFA    $NPAFA
     C                     MOVE DFPXFB    $FPXFB
     C                     Z-ADDDSFFB     $SFFB
     C                     MOVE DNPAFB    $NPAFB
     C                     MOVE DFPXFC    $FPXFC
     C                     Z-ADDDSFFC     $SFFC
     C                     MOVE DNPAFC    $NPAFC
     C                     Z-ADDDLZF1     $LZF1   30
     C                     Z-ADDDLZF2     $LZF2   30
     C                     Z-ADDDLZF3     $LZF3   30
     C                     Z-ADDDLZF4     $LZF4   30
     C                     Z-ADDDLZF5     $LZF5   30
     C                     Z-ADDDLZF6     $LZF6   30
     C                     Z-ADDDLZF7     $LZF7   30
     C                     Z-ADDDLZF8     $LZF8   30
     C                     Z-ADDDLZF9     $LZF9   30
     C                     Z-ADDDLZFA     $LZFA   30
     C                     Z-ADDDLZFB     $LZFB   30
     C                     Z-ADDDLZFC     $LZFC   30
     C                     MOVE DTYPF1    $TYPF1  4
     C                     MOVE DTYPF2    $TYPF2  4
     C                     MOVE DTYPF3    $TYPF3  4
     C                     MOVE DTYPF4    $TYPF4  4
     C                     MOVE DTYPF5    $TYPF5  4
     C                     MOVE DTYPF6    $TYPF6  4
     C                     MOVE DTYPF7    $TYPF7  4
     C                     MOVE DTYPF8    $TYPF8  4
     C                     MOVE DTYPF9    $TYPF9  4
     C                     MOVE DTYPFA    $TYPFA  4
     C                     MOVE DTYPFB    $TYPFB  4
     C                     MOVE DTYPFC    $TYPFC  4
     C                     MOVE WSD1      SSD3
     C                     MOVE WRDID1    PRDID3
     C                     MOVE WRGRD1    PRGRD3
     C                     MOVE WROUD1    PROUD3
     C                     MOVE WEFFD1    PEFFD3
     C                     MOVE WDECD1    PDECD3
     C                     MOVE WETPD1    RETPD3
     C                     MOVE WOCAD1    ROCAD3
     C                     MOVE WSD2      SSD4
     C                     MOVE WRDID2    PRDID4
     C                     MOVE WRGRD2    PRGRD4
     C                     MOVE WROUD2    PROUD4
     C                     MOVE WEFFD2    PEFFD4
     C                     MOVE WDECD2    PDECD4
     C                     MOVE WETPD2    RETPD4
     C                     MOVE WOCAD2    ROCAD4
     C                     MOVE WSDA      SSDC
     C                     MOVE WRDIDA    PRDIDC
     C                     MOVE WRGRDA    PRGRDC
     C                     MOVE WROUDA    PROUDC
     C                     MOVE WEFFDA    PEFFDC
     C                     MOVE WDECDA    PDECDC
     C                     MOVE WETPDA    RETPDC
     C                     MOVE WOCADA    ROCADC
     C                     MOVE WSDB      SSDD
     C                     MOVE WRDIDB    PRDIDD
     C                     MOVE WRGRDB    PRGRDD
     C                     MOVE WROUDB    PROUDD
     C                     MOVE WEFFDB    PEFFDD
     C                     MOVE WDECDB    PDECDD
     C                     MOVE WETPDB    RETPDD
     C                     MOVE WOCADB    ROCADD
     C                     Z-ADDDSMIP1    $SMIP1  30
     C                     Z-ADDDSMAP1    $SMAP1  30
     C                     Z-ADDDSMIP2    $SMIP2  30
     C                     Z-ADDDSMAP2    $SMAP2  30
     C                     MOVE RFDORA    $EFDOR  3
     C                     MOVE WEFDO2    $EFDO2  3
     C                     MOVE REFDO3    $EFDO3  3
     C                     MOVE REFDO4    $EFDO4  3
     C                     MOVE WORGAM    $ORGAM  1
     C                     Z-ADD*ZEROS    LZAPA1  41
     C                     Z-ADD*ZEROS    FLAPA1  40
     C                     Z-ADD*ZEROS    FHAPA1  40
     * OFFSET 3B
     C                     Z-ADDATCOP     ATCOEP
    C*                    Z-ADDAUSIP     OSIMAC
     C                     MOVE AMACP     AMACEP
     C                     Z-ADDAGEP1     AGEIP1
     C                     Z-ADDAGEP2     AGEIP2
     C                     Z-ADDAGEP3     AGEIP3
     C                     MOVE ATE1P     ATE1IP
     C                     MOVE ANE1P     ANE1IP
     C                     Z-ADDAPE1P     APE1IP
     C                     MOVE ATE2P     ATE2IP
     C                     MOVE ANE2P     ANE2IP
     C                     Z-ADDAPE2P     APE2IP
     C                     MOVE ATOAP     ATOAIP
     C                     Z-ADDAPOAP     APOAIP
     C                     MOVE ATEFP     ATEFIP
     C                     Z-ADDAPEFP     APEFIP
     C                     Z-ADDAMESP     AMESIP
     C                     MOVE ATEMP     ATEMIP
     C                     Z-ADDAPEMP     APEMIP
     C                     Z-ADDADPP      ADPIP
     C                     MOVE ADF1P     ADF1IP
     C                     Z-ADDADS1P     ADS1IP
     C                     MOVE ADT1P     ADT1IP
     C                     Z-ADDADL1P     ADL1IP
     C                     MOVE ADF2P     ADF2IP
     C                     Z-ADDADS2P     ADS2IP
     C                     MOVE ADT2P     ADT2IP
     C                     Z-ADDADL2P     ADL2IP
     C                     MOVE ADF3P     ADF3IP
     C                     Z-ADDADS3P     ADS3IP
     C                     MOVE ADT3P     ADT3IP
     C                     Z-ADDADL3P     ADL3IP
     C                     MOVE ATV1P     ATV1IP
     C                     Z-ADDAPV1P     APV1IP
     C                     Z-ADDAMV1P     AMV1IP
     C                     MOVE AV1P1     AV1IP1
     C                     MOVE AV1P2     AV1IP2
     C                     MOVE AV1P3     AV1IP3
     C                     MOVE ATV2P     ATV2IP
     C                     Z-ADDAPV2P     APV2IP
     C                     Z-ADDAMV2P     AMV2IP
     C                     MOVE AV2P1     AV2IP1
     C                     MOVE AV2P2     AV2IP2
     C                     MOVE AV2P3     AV2IP3
     C                     MOVE ATV3P     ATV3IP
     C                     Z-ADDAPV3P     APV3IP
     C                     Z-ADDAMV3P     AMV3IP
     C                     MOVE AV3P1     AV3IP1
     C                     MOVE AV3P2     AV2IP2
     C                     MOVE AV3P3     AV2IP3
    C*                    MOVE ADPRP     ADPRIP
     C                     MOVE ATGP      ATGIP
     C                     MOVE AGGP      AGGIP
     C                     MOVE ADDP      ADDIP
     C                     MOVE ADAP      ADAIP
     C                     MOVE ATSSP     ATSSIP
     C                     MOVE ATMP      ATMIP
     C                     Z-ADDAGER1     AGEIR1
     C                     MOVE ATE1R     ATE1IR
     C                     MOVE ANE1R     ANE1IR
     C                     Z-ADDAPE1R     APE1IR
     C                     Z-ADDAMESR     AMESIR
     C                     MOVE ATV1R     ATV1IR
     C                     Z-ADDAPV1R     APV1IR
     C                     Z-ADDAMV1R     AMV1IR
     *
     C           KPST5     CHAINPRODST5              99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDLZAPP     LZAPA2  41
     C                     Z-ADDFLAPP     FLAPA2  40
     C                     Z-ADDFHAPP     FHAPA2  40
F3  C                     END
F2  C                     END
     C           KPRO      READEPRODS3L1                 50
F1  C                     END
D1  C           PAPA1     IFNE *BLANKS
    C           PAPA2     ANDNE*BLANKS
    C           XX1       ANDEQ8
     C                     MOVE '*'       VAVR
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   SI PRODUIT : MAJ / ECRITURE PRODST3              *
    C* ---------------------------------------------------*
    C           MAJPRO    BEGSR
    C*          ---------------
     C                     Z-ADDPRODOR    NOPRO
     C                     MOVEL'8'       NOPRO
     C           KPROX     CHAINPRODS3L1             50
     C  N50                DELETPRODSTF2
     C           KPST5B    CHAINPRODST5              50
     C  N50                DELETPRODSTF5
     C                     MOVEL'9'       NOPRO
     C           KPROX     CHAINPRODS3L1             50
     C  N50                DELETPRODSTF2
     C           KPST5B    CHAINPRODST5              50
     C  N50                DELETPRODSTF5
    C*
     C           KPROW     CHAINPRODUL40             90
    C*  UNE AFFICHE
D1  C           PAPA1     IFNE *BLANKS
    C           PAPA2     ANDEQ*BLANKS
    C           PI1A2     ANDEQ*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PAPA2     ANDEQ*BLANKS
    C           PI1A2     ANDEQ*BLANKS
     C                     Z-ADDPRODOR    NOPRO
     C                     MOVEL'8'       NOPRO
     C                     EXSR PREPE
     C                     EXSR B4A
     C                     MOVEABL0       BLOC4
     C                     WRITEPRODSTF2
D2  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F2  C                     END
F1  C                     END
D1  C           PAPA2     IFNE *BLANKS
    C           PAPA1     ANDEQ*BLANKS
    C           PI1A1     ANDEQ*BLANKS
    C           PI1A2     ORNE *BLANKS
    C           PAPA1     ANDEQ*BLANKS
    C           PI1A1     ANDEQ*BLANKS
     C                     Z-ADDPRODOR    NOPRO
     C                     MOVEL'8'       NOPRO
     C                     EXSR PREPI
     C                     EXSR B4A
     C                     MOVEABL0       BLOC4
     C                     WRITEPRODSTF2
D2  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F2  C                     END
F1  C                     END
    C*  DEUX AFFICHES
D1  C           PAPA1     IFNE *BLANKS
    C           PAPA2     ANDNE*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PAPA2     ANDNE*BLANKS
    C           PAPA1     ORNE *BLANKS
    C           PI1A2     ANDNE*BLANKS
    C           PI1A1     ORNE *BLANKS
    C           PI1A2     ANDNE*BLANKS
D2  C           VAVR      IFEQ '*'
     C                     Z-ADDPRODOR    NOPRO
     C                     MOVEL'8'       NOPRO
     C                     EXSR PREPI
     C                     WRITEPRODSTF2
D3  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F3  C                     END
     C                     MOVEL'9'       NOPRO
     C                     EXSR PREPE
     C                     EXSR B4A
     C                     MOVEABL0       BLOC4
     C                     WRITEPRODSTF2
D3  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F3  C                     END
X2  C                     ELSE
     C                     Z-ADDPRODOR    NOPRO
     C                     MOVEL'8'       NOPRO
     C                     EXSR PREPE
     C                     EXSR B4A
     C                     MOVEABL0       BLOC4
     C                     WRITEPRODSTF2
D3  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F3  C                     END
     C                     MOVEL'9'       NOPRO
     C                     EXSR PREPI
     C                     EXSR B4A
     C                     MOVEABL0       BLOC4
     C                     WRITEPRODSTF2
D3  C           LZAPP     IFNE *ZEROS
    C           FLAPP     ORNE *ZEROS
     C                     WRITEPRODSTF5
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PREPARATION SORTIE EXTERIEUR                     *
    C* ---------------------------------------------------*
    C           PREPE     BEGSR
    C*          ---------------
     C                     MOVE PAPA1     PAPA
     C                     MOVE GRAA1     GRAA
     C                     MOVE REFA1     REFA
     C                     MOVE GRELA1    GRELA
     C                     MOVE LA1       LA
     C                     MOVE HA1       HA
     C                     MOVE LAIA1     LAIA
     C                     MOVE IMPA1     IMPA
     C                     MOVE USA1      USA
     C                     MOVE COUA1     COUA
     C                     MOVE ENCA1     ENCA
     C                     MOVE TSA1      TSA
     C                     MOVE GRPA1     GRPA
     C                     MOVE UVA1      UVA
     C                     MOVE NATA1     NATA
     C                     MOVE TVEA1     TVEA
     C                     MOVE CVEA1     CVEA
     C                     MOVE ORA1      ORA
     C                     MOVE FLUA1     FLUA
     C                     MOVE CFLA1     CFLA
     C                     MOVE ESPA1     ESPA
     C                     MOVE VSPA1     VSPA
     C                     MOVE DDEA1     DDEA
     C                     MOVE DAPA1     DAPA
     C                     MOVE RIMA11    RIMA1
     C                     MOVE COUA1R    COUAR
     C                     MOVE ENCA1R    ENCAR
     C                     MOVE TSA1R     TSAR
     C                     MOVE GRPA1R    GRPAR
     C                     MOVE UVA1R     UVAR
     C                     MOVE NATA1R    NATAR
     C                     MOVE TVEA1R    TVEAR
     C                     MOVE CVEA1R    CVEAR
     C                     MOVE ORA1R     ORAR
     C                     MOVE FLUA1R    FLUAR
     C                     MOVE CFLA1R    CFLAR
     C                     MOVE ESPA1R    ESPAR
     C                     MOVE VSPA1R    VSPAR
     C                     MOVE DDEA1R    DDEAR
     C                     MOVE DAPA1R    DAPAR
     C                     MOVE CLIA1     CLIA
     C                     MOVE CLIA1R    CLIAR
     C                     MOVE GAUF11    GAUF1
     C                     MOVE NOGF11    NOGF1
     C                     MOVE GAUF21    GAUF2
     C                     MOVE NOGF21    NOGF2
     C                     MOVE MASS11    MASSI
     C                     MOVE SSINT1    SSINT
     C                     MOVE CXHAI1    CXHAPI
     C                     MOVE XAIME1    MAIME1
     C                     MOVE XAIME2    MAIME2
     C                     MOVE XAIME3    MAIME3
     C                     MOVE XAIME4    MAIME4
     C                     MOVE XAIME5    MAIME5
     C                     MOVE XIMRE1    MIMRE1
     C                     MOVE XIMRE2    MIMRE2
     C                     MOVE XIMRE3    MIMRE3
     C                     MOVE XIMRE4    MIMRE4
     C                     MOVE XIMRE5    MIMRE5
     C                     MOVE XMIME1    RMIME1
     C                     MOVE XMIME2    RMIME2
     C                     MOVE XMIME3    RMIME3
     C                     MOVE XMIME4    RMIME4
     C                     MOVE XMIME5    RMIME5
     C                     MOVE XMIRE1    RMIRE1
     C                     MOVE XMIRE2    RMIRE2
     C                     MOVE XMIRE3    RMIRE3
     C                     MOVE XMIRE4    RMIRE4
     C                     MOVE XMIRE5    RMIRE5
     C                     MOVE XAGA11    MAGAU1
     C                     MOVE XRGA11    MRGAU1
     C                     MOVE XAGA21    MAGAU2
     C                     MOVE XRGA21    MRGAU2
     C                     MOVE XSGF11    USGF1
     C                     MOVE XSGF21    USGF2
     C                     MOVE XSMAS1    USMAS
     C                     MOVE XAMAS1    MAMAS
     C                     MOVE GP1A1     GP1
     C                     MOVE GP2A1     GP2
     C                     MOVE GP3A1     GP3
     C                     MOVE MATA1C    MATC
    C*                    MOVE MATA1M    MATM
     C                     MOVE GP1A1R    GP1R
     C                     MOVE GP2A1R    GP2R
     C                     MOVE MAA1RC    MATCR
     C                     MOVE MAA1RM    MATMR
     C                     MOVE SSA1      SS
     C                     MOVE PRDIA1    PRDI
     C                     MOVE PRGRA1    PRGR
     C                     MOVE PROUA1    PROU
     C                     MOVE PEFFA1    PEFF
     C                     MOVE PDECA1    PDEC
     C                     MOVE RETPA1    RETP
     C                     MOVE ROCAA1    ROCA
     C                     MOVE SSA1R     SSR
     C                     MOVE PRDA1R    PRDIR
     C                     MOVE PRGA1R    PRGRR
     C                     MOVE PROA1R    PROUR
     C                     MOVE PEFA1R    PEFFR
     C                     MOVE PDEA1R    PDECR
     C                     MOVE RETA1R    RETPR
     C                     MOVE ROCA1R    ROCAR
     C                     MOVE 'E'       SUPOR
     C                     MOVELTL,1      BLOC2
     C                     MOVE PRODOR    BLOC2
     C                     Z-ADD6         SSGA
     C                     MOVE PRDIG1    PRDIGA
     C                     MOVE PRGRG1    PRGRGA
     C                     MOVE PROUG1    PROUGA
     C                     MOVE PEFFG1    PEFFGA
     C                     MOVE PDECG1    PDECGA
     C                     MOVE RETPG1    RETPGA
     C                     MOVE ROCAG1    ROCAGA
     C                     Z-ADD66        SSGB
     C                     MOVE PRDIG2    PRDIGB
     C                     MOVE PRGRG2    PRGRGB
     C                     MOVE PROUG2    PROUGB
     C                     MOVE PEFFG2    PEFFGB
     C                     MOVE PDECG2    PDECGB
     C                     MOVE RETPG2    RETPGB
     C                     MOVE ROCAG2    ROCAGB
     C                     Z-ADDRASPA1    RASPA
     C                     MOVE INDPA1    INPLAA
     C                     MOVE PI1A1     PI1A
     C                     MOVE PI2A1     PI2A
     C                     Z-ADDMASA1L    FMASAL
     C                     Z-ADDMASA1H    FMASAH
     C                     MOVE SCO1A1    SCOD1
     C                     MOVE SRE1A1    SREG1
     C                     MOVE SRO1A1    SROU1
     C                     MOVE SDE1A1    SDEC1
     C                     MOVE SCO2A1    SCOD2
     C                     MOVE SRE2A1    SREG2
     C                     MOVE SRO2A1    SROU2
     C                     MOVE SDE2A1    SDEC2
     C                     MOVE SCO3A1    SCOD3
     C                     MOVE SRE3A1    SRER3
     C                     MOVE SRO3A1    SROU3
     C                     MOVE SDE3A1    SDEC3
     C                     Z-ADDLPEAP1    LFPEAP
     C                     Z-ADDLPEUT1    LFPEUT
     C                     MOVE INVPA1    INVPEL
     C                     MOVE £CODDO    CODDOR
     C                     MOVE £NATP1    DNATP1
     C                     MOVE £DIFP1    DDIFP1
     C                     MOVE £NATP2    DNATP2
     C                     MOVE £DIFP2    DDIFP2
     C                     MOVE £FPXF1    DFPXF1
     C                     MOVE £NATP3    DNATP3
     C                     MOVE £DIFP3    DDIFP3
     C                     MOVE £NATP4    DNATP4
     C                     MOVE £DIFP4    DDIFP4
     C                     MOVE £FPXF1    DFPXF1
     C                     Z-ADD£SFF1     DSFF1
     C                     MOVE £NPAF1    DNPAF1
     C                     MOVE £FPXF2    DFPXF2
     C                     Z-ADD£SFF2     DSFF2
     C                     MOVE £NPAF2    DNPAF2
     C                     MOVE £FPXF3    DFPXF3
     C                     Z-ADD£SFF3     DSFF3
     C                     MOVE £NPAF3    DNPAF3
     C                     MOVE £FPXF4    DFPXF4
     C                     Z-ADD£SFF4     DSFF4
     C                     MOVE £NPAF4    DNPAF4
     C                     MOVE £FPXF5    DFPXF5
     C                     Z-ADD£SFF5     DSFF5
     C                     MOVE £NPAF5    DNPAF5
     C                     MOVE £FPXF6    DFPXF6
     C                     Z-ADD£SFF6     DSFF6
     C                     MOVE £NPAF6    DNPAF6
     C                     MOVE £FPXF7    DFPXF7
     C                     Z-ADD£SFF7     DSFF7
     C                     MOVE £NPAF7    DNPAF7
     C                     MOVE £FPXF8    DFPXF8
     C                     Z-ADD£SFF8     DSFF8
     C                     MOVE £NPAF8    DNPAF8
     C                     MOVE £FPXF9    DFPXF9
     C                     Z-ADD£SFF9     DSFF9
     C                     MOVE £NPAF9    DNPAF9
     C                     MOVE £FPXFA    DFPXFA
     C                     Z-ADD£SFFA     DSFFA
     C                     MOVE £NPAFA    DNPAFA
     C                     MOVE £FPXFB    DFPXFB
     C                     Z-ADD£SFFB     DSFFB
     C                     MOVE £NPAFB    DNPAFB
     C                     MOVE £FPXFC    DFPXFC
     C                     Z-ADD£SFFC     DSFFC
     C                     MOVE £NPAFC    DNPAFC
     C                     Z-ADD£LZF1     DLZF1
     C                     Z-ADD£LZF2     DLZF2
     C                     Z-ADD£LZF3     DLZF3
     C                     Z-ADD£LZF4     DLZF4
     C                     Z-ADD£LZF5     DLZF5
     C                     Z-ADD£LZF6     DLZF6
     C                     Z-ADD£LZF7     DLZF7
     C                     Z-ADD£LZF8     DLZF8
     C                     Z-ADD£LZF9     DLZF9
     C                     Z-ADD£LZFA     DLZFA
     C                     Z-ADD£LZFB     DLZFB
     C                     Z-ADD£LZFC     DLZFC
     C                     MOVE £TYPF1    DTYPF1
     C                     MOVE £TYPF2    DTYPF2
     C                     MOVE £TYPF3    DTYPF3
     C                     MOVE £TYPF4    DTYPF4
     C                     MOVE £TYPF5    DTYPF5
     C                     MOVE £TYPF6    DTYPF6
     C                     MOVE £TYPF7    DTYPF7
     C                     MOVE £TYPF8    DTYPF8
     C                     MOVE £TYPF9    DTYPF9
     C                     MOVE £TYPFA    DTYPFA
     C                     MOVE £TYPFB    DTYPFB
     C                     MOVE £TYPFC    DTYPFC
     C                     Z-ADD26        WSD1
     C                     MOVE PRDID1    WRDID1
     C                     MOVE PRGRD1    WRGRD1
     C                     MOVE PROUD1    WROUD1
     C                     MOVE PEFFD1    WEFFD1
     C                     MOVE PDECD1    WDECD1
     C                     MOVE RETPD1    WETPD1
     C                     MOVE ROCAD1    WOCAD1
     C                     Z-ADD27        WSD2
     C                     MOVE PRDID2    WRDID2
     C                     MOVE PRGRD2    WRGRD2
     C                     MOVE PROUD2    WROUD2
     C                     MOVE PEFFD2    WEFFD2
     C                     MOVE PDECD2    WDECD2
     C                     MOVE RETPD2    WETPD2
     C                     MOVE ROCAD2    WOCAD2
     C                     Z-ADD30        WSDA
     C                     MOVE PRDIDA    WRDIDA
     C                     MOVE PRGRDA    WRGRDA
     C                     MOVE PROUDA    WROUDA
     C                     MOVE PEFFDA    WEFFDA
     C                     MOVE PDECDA    WDECDA
     C                     MOVE RETPDA    WETPDA
     C                     MOVE ROCADA    WOCADA
     C                     Z-ADD31        WSDB
     C                     MOVE PRDIDB    WRDIDB
     C                     MOVE PRGRDB    WRGRDB
     C                     MOVE PROUDB    WROUDB
     C                     MOVE PEFFDB    WEFFDB
     C                     MOVE PDECDB    WDECDB
     C                     MOVE RETPDB    WETPDB
     C                     MOVE ROCADB    WOCADB
     C                     Z-ADD£SMIP1    DSMIP1
     C                     Z-ADD£SMAP1    DSMAP1
     C                     Z-ADD£SMIP2    DSMIP2
     C                     Z-ADD£SMAP2    DSMAP2
     C                     MOVE £EFDOR    RFDORA
     C                     MOVE £EFDO2    WEFDO2
     C                     MOVE £EFDO3    REFDO3
     C                     MOVE £EFDO4    REFDO4
     C                     MOVE £ORGAM    WORGAM
     C                     Z-ADDLZAPA1    LZAPP
     C                     Z-ADDFLAPA1    FLAPP
     C                     Z-ADDFHAPA1    FHAPP
     * DONNÉES OFFSET 3B
     C                     Z-ADDATCOEP    ATCOP
    C*                    Z-ADDOSIMAC    AUSIP
    C*                    MOVE AMACEP    AMACP
     C                     Z-ADDAGEEP1    AGEP1
     C                     Z-ADDAGEEP2    AGEP2
     C                     Z-ADDAGEEP3    AGEP3
     C                     MOVE ATE1EP    ATE1P
     C                     MOVE ANE1EP    ANE1P
     C                     Z-ADDAPE1EP    APE1P
     C                     MOVE ATE2EP    ATE2P
     C                     MOVE ANE2EP    ANE2P
     C                     Z-ADDAPE2EP    APE2P
     C                     MOVE ATOAEP    ATOAP
     C                     Z-ADDAPOAEP    APOAP
     C                     MOVE ATEFEP    ATEFP
     C                     Z-ADDAPEFEP    APEFP
     C                     Z-ADDAMESEP    AMESP
     C                     MOVE ATEMEP    ATEMP
     C                     Z-ADDAPEMEP    APEMP
     C                     Z-ADDADPEP     ADPP
     C                     MOVE ADF1EP    ADF1P
     C                     Z-ADDADS1EP    ADS1P
     C                     MOVE ADT1EP    ADT1P
     C                     Z-ADDADL1EP    ADL1P
     C                     MOVE ADF2EP    ADF2P
     C                     Z-ADDADS2EP    ADS2P
     C                     MOVE ADT2EP    ADT2P
     C                     Z-ADDADL2EP    ADL2P
     C                     MOVE ADF3EP    ADF3P
     C                     Z-ADDADS3EP    ADS3P
     C                     MOVE ADT3EP    ADT3P
     C                     Z-ADDADL3EP    ADL3P
     C                     MOVE ATV1EP    ATV1P
     C                     Z-ADDAPV1EP    APV1P
     C                     Z-ADDAMV1EP    AMV1P
     C                     MOVE AV1EP1    AV1P1
     C                     MOVE AV1EP2    AV1P2
     C                     MOVE AV1EP3    AV1P3
     C                     MOVE ATV2EP    ATV2P
     C                     Z-ADDAPV2EP    APV2P
     C                     Z-ADDAMV2EP    AMV2P
     C                     MOVE AV2EP1    AV2P1
     C                     MOVE AV2EP2    AV2P2
     C                     MOVE AV2EP3    AV2P3
     C                     MOVE ATV3EP    ATV3P
     C                     Z-ADDAPV3EP    APV3P
     C                     Z-ADDAMV3EP    AMV3P
     C                     MOVE AV3EP1    AV3P1
     C                     MOVE AV3EP2    AV3P2
     C                     MOVE AV3EP3    AV3P3
     C                     MOVE ADPREP    ADPRP
     C                     MOVE ATGEP     ATGP
     C                     MOVE AGGEP     AGGP
     C                     MOVE ADDEP     ADDP
     C                     MOVE ADAEP     ADAP
     C                     MOVE ATSSEP    ATSSP
     C                     MOVE ATMEP     ATMP
     C                     Z-ADDAGEER1    AGER1
     C                     MOVE ATE1ER    ATE1R
     C                     MOVE ANE1ER    ANE1R
     C                     Z-ADDAPE1ER    APE1R
     C                     Z-ADDAMESER    AMESR
     C                     MOVE ATV1ER    ATV1R
     C                     Z-ADDAPV1ER    APV1R
     C                     Z-ADDAMV1ER    AMV1R
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PREPARATION SORTIE INTERIEUR                     *
    C* ---------------------------------------------------*
    C           PREPI     BEGSR
    C*          ---------------
     C                     MOVE PAPA2     PAPA
     C                     MOVE GRAA2     GRAA
     C                     MOVE REFA2     REFA
     C                     MOVE GRELA2    GRELA
     C                     MOVE LA2       LA
     C                     MOVE HA2       HA
     C                     MOVE LAIA2     LAIA
     C                     MOVE IMPA2     IMPA
     C                     MOVE USA2      USA
     C                     MOVE COUA2     COUA
     C                     MOVE ENCA2     ENCA
     C                     MOVE TSA2      TSA
     C                     MOVE GRPA2     GRPA
     C                     MOVE UVA2      UVA
     C                     MOVE NATA2     NATA
     C                     MOVE TVEA2     TVEA
     C                     MOVE CVEA2     CVEA
     C                     MOVE ORA2      ORA
     C                     MOVE FLUA2     FLUA
     C                     MOVE CFLA2     CFLA
     C                     MOVE ESPA2     ESPA
     C                     MOVE VSPA2     VSPA
     C                     MOVE DDEA2     DDEA
     C                     MOVE DAPA2     DAPA
     C                     MOVE RIMA12    RIMA1
     C                     MOVE COUA2R    COUAR
     C                     MOVE ENCA2R    ENCAR
     C                     MOVE TSA2R     TSAR
     C                     MOVE GRPA2R    GRPAR
     C                     MOVE UVA2R     UVAR
     C                     MOVE NATA2R    NATAR
     C                     MOVE TVEA2R    TVEAR
     C                     MOVE CVEA2R    CVEAR
     C                     MOVE ORA2R     ORAR
     C                     MOVE FLUA2R    FLUAR
     C                     MOVE CFLA2R    CFLAR
     C                     MOVE ESPA2R    ESPAR
     C                     MOVE VSPA2R    VSPAR
     C                     MOVE DDEA2R    DDEAR
     C                     MOVE DAPA2R    DAPAR
     C                     MOVE CLIA2     CLIA
     C                     MOVE CLIA2R    CLIAR
     C                     MOVE GAUF12    GAUF1
     C                     MOVE NOGF12    NOGF1
     C                     MOVE GAUF22    GAUF2
     C                     MOVE NOGF22    NOGF2
     C                     MOVE MASS12    MASSI
     C                     MOVE SSINT2    SSINT
     C                     MOVE CXHAI2    CXHAPI
     C                     MOVE XAIMI1    MAIME1
     C                     MOVE XAIMI2    MAIME2
     C                     MOVE XAIMI3    MAIME3
     C                     MOVE XAIMI4    MAIME4
     C                     MOVE XAIMI5    MAIME5
     C                     MOVE XIMRI1    MIMRE1
     C                     MOVE XIMRI2    MIMRE2
     C                     MOVE XIMRI3    MIMRE3
     C                     MOVE XIMRI4    MIMRE4
     C                     MOVE XIMRI5    MIMRE5
     C                     MOVE XMIMI1    RMIME1
     C                     MOVE XMIMI2    RMIME2
     C                     MOVE XMIMI3    RMIME3
     C                     MOVE XMIMI4    RMIME4
     C                     MOVE XMIMI5    RMIME5
     C                     MOVE XMIRI1    RMIRE1
     C                     MOVE XMIRI2    RMIRE2
     C                     MOVE XMIRI3    RMIRE3
     C                     MOVE XMIRI4    RMIRE4
     C                     MOVE XMIRI5    RMIRE5
     C                     MOVE XAGA21    MAGAU1
     C                     MOVE XRGA21    MRGAU1
     C                     MOVE XAGA22    MAGAU2
     C                     MOVE XRGA22    MRGAU2
     C                     MOVE XSGF12    USGF1
     C                     MOVE XSGF22    USGF2
     C                     MOVE XSMAS2    USMAS
     C                     MOVE XAMAS2    MAMAS
     C                     MOVE GP1A2     GP1
     C                     MOVE GP2A2     GP2
     C                     MOVE GP3A2     GP3
     C                     MOVE MATA2C    MATC
     C                     MOVE MATA2M    MATM
     C                     MOVE GP1A2R    GP1R
     C                     MOVE GP2A2R    GP2R
     C                     MOVE MAA2RC    MATCR
     C                     MOVE MAA2RM    MATMR
     C                     MOVE SSA2      SS
     C                     MOVE PRDIA2    PRDI
     C                     MOVE PRGRA2    PRGR
     C                     MOVE PROUA2    PROU
     C                     MOVE PEFFA2    PEFF
     C                     MOVE PDECA2    PDEC
     C                     MOVE RETPA2    RETP
     C                     MOVE ROCAA2    ROCA
     C                     MOVE SSA2R     SSR
     C                     MOVE PRDA2R    PRDIR
     C                     MOVE PRGA2R    PRGRR
     C                     MOVE PROA2R    PROUR
     C                     MOVE PEFA2R    PEFFR
     C                     MOVE PDEA2R    PDECR
     C                     MOVE RETA2R    RETPR
     C                     MOVE ROCA2R    ROCAR
     C                     MOVE 'I'       SUPOR
     C                     MOVELTL,2      BLOC2
     C                     MOVE PRODOR    BLOC2
     C                     Z-ADD6         SSGA
     C                     MOVE PRDIG3    PRDIGA
     C                     MOVE PRGRG3    PRGRGA
     C                     MOVE PROUG3    PROUGA
     C                     MOVE PEFFG3    PEFFGA
     C                     MOVE PDECG3    PDECGA
     C                     MOVE RETPG3    RETPGA
     C                     MOVE ROCAG3    ROCAGA
     C                     Z-ADD66        SSGB
     C                     MOVE PRDIG4    PRDIGB
     C                     MOVE PRGRG4    PRGRGB
     C                     MOVE PROUG4    PROUGB
     C                     MOVE PEFFG4    PEFFGB
     C                     MOVE PDECG4    PDECGB
     C                     MOVE RETPG4    RETPGB
     C                     MOVE ROCAG4    ROCAGB
     C                     Z-ADDRASPA2    RASPA
     C                     MOVE INDPA2    INPLAA
     C                     MOVE PI1A2     PI1A
     C                     MOVE PI2A2     PI2A
     C                     Z-ADDMASA2L    FMASAL
     C                     Z-ADDMASA2H    FMASAH
     C                     MOVE SCO1A2    SCOD1
     C                     MOVE SRE1A2    SREG1
     C                     MOVE SRO1A2    SROU1
     C                     MOVE SDE1A2    SDEC1
     C                     MOVE SCO2A2    SCOD2
     C                     MOVE SRE2A2    SREG2
     C                     MOVE SRO2A2    SROU2
     C                     MOVE SDE2A2    SDEC2
     C                     MOVE SCO3A2    SCOD3
     C                     MOVE SRE3A2    SRER3
     C                     MOVE SRO3A2    SROU3
     C                     MOVE SDE3A2    SDEC3
     C                     Z-ADDLPEAP2    LFPEAP
     C                     Z-ADDLPEUT2    LFPEUT
     C                     MOVE INVPA2    INVPEL
     C                     MOVE $CODDO    CODDOR
     C                     MOVE $NATP1    DNATP1
     C                     MOVE $DIFP1    DDIFP1
     C                     MOVE $NATP2    DNATP2
     C                     MOVE $DIFP2    DDIFP2
     C                     MOVE $NATP3    DNATP3
     C                     MOVE $DIFP3    DDIFP3
     C                     MOVE $NATP4    DNATP4
     C                     MOVE $DIFP4    DDIFP4
     C                     MOVE $FPXF1    DFPXF1
     C                     Z-ADD$SFF1     DSFF1
     C                     MOVE $NPAF1    DNPAF1
     C                     MOVE $FPXF2    DFPXF2
     C                     Z-ADD$SFF2     DSFF2
     C                     MOVE $NPAF2    DNPAF2
     C                     MOVE $FPXF3    DFPXF3
     C                     Z-ADD$SFF3     DSFF3
     C                     MOVE $NPAF3    DNPAF3
     C                     MOVE $FPXF4    DFPXF4
     C                     Z-ADD$SFF4     DSFF4
     C                     MOVE $NPAF4    DNPAF4
     C                     MOVE $FPXF5    DFPXF5
     C                     Z-ADD$SFF5     DSFF5
     C                     MOVE $NPAF5    DNPAF5
     C                     MOVE $FPXF6    DFPXF6
     C                     Z-ADD$SFF6     DSFF6
     C                     MOVE $NPAF6    DNPAF6
     C                     MOVE $FPXF7    DFPXF7
     C                     Z-ADD$SFF7     DSFF7
     C                     MOVE $NPAF7    DNPAF7
     C                     MOVE $FPXF8    DFPXF8
     C                     Z-ADD$SFF8     DSFF8
     C                     MOVE $NPAF8    DNPAF8
     C                     MOVE $FPXF9    DFPXF9
     C                     Z-ADD$SFF9     DSFF9
     C                     MOVE $NPAF9    DNPAF9
     C                     MOVE $FPXFA    DFPXFA
     C                     Z-ADD$SFFA     DSFFA
     C                     MOVE $NPAFA    DNPAFA
     C                     MOVE $FPXFB    DFPXFB
     C                     Z-ADD$SFFB     DSFFB
     C                     MOVE $NPAFB    DNPAFB
     C                     MOVE $FPXFC    DFPXFC
     C                     Z-ADD$SFFC     DSFFC
     C                     MOVE $NPAFC    DNPAFC
     C                     Z-ADD$LZF1     DLZF1
     C                     Z-ADD$LZF2     DLZF2
     C                     Z-ADD$LZF3     DLZF3
     C                     Z-ADD$LZF4     DLZF4
     C                     Z-ADD$LZF5     DLZF5
     C                     Z-ADD$LZF6     DLZF6
     C                     Z-ADD$LZF7     DLZF7
     C                     Z-ADD$LZF8     DLZF8
     C                     Z-ADD$LZF9     DLZF9
     C                     Z-ADD$LZFA     DLZFA
     C                     Z-ADD$LZFB     DLZFB
     C                     Z-ADD$LZFC     DLZFC
     C                     MOVE $TYPF1    DTYPF1
     C                     MOVE $TYPF2    DTYPF2
     C                     MOVE $TYPF3    DTYPF3
     C                     MOVE $TYPF4    DTYPF4
     C                     MOVE $TYPF5    DTYPF5
     C                     MOVE $TYPF6    DTYPF6
     C                     MOVE $TYPF7    DTYPF7
     C                     MOVE $TYPF8    DTYPF8
     C                     MOVE $TYPF9    DTYPF9
     C                     MOVE $TYPFA    DTYPFA
     C                     MOVE $TYPFB    DTYPFB
     C                     MOVE $TYPFC    DTYPFC
     C                     Z-ADD26        WSD1
     C                     MOVE PRDID3    WRDID1
     C                     MOVE PRGRD3    WRGRD1
     C                     MOVE PROUD3    WROUD1
     C                     MOVE PEFFD3    WEFFD1
     C                     MOVE PDECD3    WDECD1
     C                     MOVE RETPD3    WETPD1
     C                     MOVE ROCAD3    WOCAD1
     C                     Z-ADD27        WSD2
     C                     MOVE PRDID4    WRDID2
     C                     MOVE PRGRD4    WRGRD2
     C                     MOVE PROUD4    WROUD2
     C                     MOVE PEFFD4    WEFFD2
     C                     MOVE PDECD4    WDECD2
     C                     MOVE RETPD4    WETPD2
     C                     MOVE ROCAD4    WOCAD2
     C                     Z-ADD30        WSDA
     C                     MOVE PRDIDC    WRDIDA
     C                     MOVE PRGRDC    WRGRDA
     C                     MOVE PROUDC    WROUDA
     C                     MOVE PEFFDC    WEFFDA
     C                     MOVE PDECDC    WDECDA
     C                     MOVE RETPDC    WETPDA
     C                     MOVE ROCADC    WOCADA
     C                     Z-ADD31        WSDB
     C                     MOVE PRDIDD    WRDIDB
     C                     MOVE PRGRDD    WRGRDB
     C                     MOVE PROUDD    WROUDB
     C                     MOVE PEFFDD    WEFFDB
     C                     MOVE PDECDD    WDECDB
     C                     MOVE RETPDD    WETPDB
     C                     MOVE ROCADD    WOCADB
     C                     Z-ADD$SMIP1    DSMIP1
     C                     Z-ADD$SMAP1    DSMAP1
     C                     Z-ADD$SMIP2    DSMIP2
     C                     Z-ADD$SMAP2    DSMAP2
     C                     MOVE $EFDOR    RFDORA
     C                     MOVE $EFDO2    WEFDO2
     C                     MOVE $EFDO3    REFDO3
     C                     MOVE $EFDO4    REFDO4
     C                     MOVE $ORGAM    WORGAM
     C                     Z-ADDLZAPA1    LZAPP
     C                     Z-ADDFLAPA1    FLAPP
     C                     Z-ADDFHAPA1    FHAPP
     * DONNÉES OFFSET 3B
     C                     Z-ADDATCOEP    ATCOP
    C*                    Z-ADDOSIMAC    AUSIP
    C*                    MOVE AMACEP    AMACP
     C                     Z-ADDAGEIP1    AGEP1
     C                     Z-ADDAGEIP2    AGEP2
     C                     Z-ADDAGEIP3    AGEP3
     C                     MOVE ATE1IP    ATE1P
     C                     MOVE ANE1IP    ANE1P
     C                     Z-ADDAPE1IP    APE1P
     C                     MOVE ATE2IP    ATE2P
     C                     MOVE ANE2IP    ANE2P
     C                     Z-ADDAPE2IP    APE2P
     C                     MOVE ATOAIP    ATOAP
     C                     Z-ADDAPOAIP    APOAP
     C                     MOVE ATEFIP    ATEFP
     C                     Z-ADDAPEFIP    APEFP
     C                     Z-ADDAMESIP    AMESP
     C                     MOVE ATEMIP    ATEMP
     C                     Z-ADDAPEMIP    APEMP
     C                     Z-ADDADPIP     ADPP
     C                     MOVE ADF1IP    ADF1P
     C                     Z-ADDADS1IP    ADS1P
     C                     MOVE ADT1IP    ADT1P
     C                     Z-ADDADL1IP    ADL1P
     C                     MOVE ADF2IP    ADF2P
     C                     Z-ADDADS2IP    ADS2P
     C                     MOVE ADT2IP    ADT2P
     C                     Z-ADDADL2IP    ADL2P
     C                     MOVE ADF3IP    ADF3P
     C                     Z-ADDADS3IP    ADS3P
     C                     MOVE ADT3IP    ADT3P
     C                     Z-ADDADL3IP    ADL3P
     C                     MOVE ATV1IP    ATV1P
     C                     Z-ADDAPV1IP    APV1P
     C                     Z-ADDAMV1IP    AMV1P
     C                     MOVE AV1IP1    AV1P1
     C                     MOVE AV1IP2    AV1P2
     C                     MOVE AV1IP3    AV1P3
     C                     MOVE ATV2IP    ATV2P
     C                     Z-ADDAPV2IP    APV2P
     C                     Z-ADDAMV2IP    AMV2P
     C                     MOVE AV2IP1    AV2P1
     C                     MOVE AV2IP2    AV2P2
     C                     MOVE AV2IP3    AV2P3
     C                     MOVE ATV3IP    ATV3P
     C                     Z-ADDAPV3IP    APV3P
     C                     Z-ADDAMV3IP    AMV3P
     C                     MOVE AV3IP1    AV3P1
     C                     MOVE AV2IP2    AV3P2
     C                     MOVE AV2IP3    AV3P3
    C*                    MOVE ADPRIP    ADPRP
     C                     MOVE ATGIP     ATGP
     C                     MOVE AGGIP     AGGP
     C                     MOVE ADDIP     ADDP
     C                     MOVE ADAIP     ADAP
     C                     MOVE ATSSIP    ATSSP
     C                     MOVE ATMIP     ATMP
     C                     Z-ADDAGEIR1    AGER1
     C                     MOVE ATE1IR    ATE1R
     C                     MOVE ANE1IR    ANE1R
     C                     Z-ADDAPE1IR    APE1R
     C                     Z-ADDAMESIR    AMESR
     C                     MOVE ATV1IR    ATV1R
     C                     Z-ADDAPV1IR    APV1R
     C                     Z-ADDAMV1IR    AMV1R
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PREPARATION BLOC4 POUR IMPRESSION                *
    C* ---------------------------------------------------*
    C           B4A       BEGSR
     C                     MOVE *BLANK    BL0
     *
     C           IMPA      LOKUPTABI      TABIM          99
D1  C           *IN99     IFEQ '1'
     C                     MOVEATABIM     BL0,1                          *LAN020
F1  C                     END
D1  C           COUA      IFGT 0                                        *LAN020
D2  C           IMPA      IFNE 0
     C                     MOVE COUA      BL0,8                          *LAN020
     C                     MOVE TSA       BL0,14                         *LAN020
     C                     MOVEA'C.'      BL0,9                          *LAN020
     C                     MOVELCOUA      COULDA  10
     C           COULDA    IFGE 1
     C                     MOVE COULDA    BL0,7
     C                     END
F2  C                     END
F1  C                     END
D1  C           TSA       IFEQ 'V'                                      *LAN020
     C                     MOVE 'U'       BL0,11                         *LAN020
     C                     MOVE TSA       BL0,12                         *LAN020
F1  C                     END
     *            TYPE DE VERNIS                                        *LAN020
D1  C           TVEA      IFNE ' '
     C                     MOVEA'+V.'     BL0,13                         *LAN020
     C                     MOVE TVEA      BL0,16                         *LAN020
     C                     MOVEA'.'       BL0,27
D2  C           TVEA      IFEQ 'D'
     C                     MOVEA'FU'      BL0,16
F2  C                     END
D2  C           TVEA      IFNE 'T'
    C           TVEA      ANDNE'R'
D3  C           CVEA      IFGE 1
     C                     MOVEA'T'       BL0,18
X3  C                     ELSE
     C                     MOVEA'R'       BL0,18
F3  C                     END
F2  C                     END
F1  C                     END
     *                                                                  *LAN020
     *            OR,ALU,CUIVRE                                         *LAN020
     *                                                                  *LAN020
D1  C           ORA       IFEQ 'O'                                      *LAN020
     C                     MOVE '+'       BL0,20                         *LAN020
     C                     MOVEA'OR'      BL0,21                         *LAN020
X1  C                     ELSE
D2  C           ORA       IFEQ 'A'                                      *LAN020
     C                     MOVE '+'       BL0,20                         *LAN020
     C                     MOVEA'AL'      BL0,21                         *LAN020
X2  C                     ELSE
D3  C           ORA       IFEQ 'C'
     C                     MOVE '+'       BL0,20
     C                     MOVEA'CU'      BL0,21
F3  C                     END
F2  C                     END
F1  C                     END
     *   REPRISE
D1  C           COUAR     IFNE 0
     C           AGER1     ORNE 0
2    C           RIMA1     LOKUPTABI      TABIM          99
D2  C           *IN99     IFEQ '1'
     C                     MOVEATABIM     BL0,29
F2  C                     END
     C                     MOVE COUAR     BL0,35
     C                     MOVEA'C.'      BL0,36
     C           COUAR     IFEQ 0
     C                     MOVE AGER1     BL0,35
     C                     END
F1  C                     END
     *
D1  C           TVEAR     IFNE ' '
     C                     MOVEA'+V.'     BL0,37
     C                     MOVE TVEAR     BL0,40
F1  C                     END
     * OFFSET 3B
D1  C           ATCOP     IFGT 0
     * OFFSTD, OFFK2V OU OFF3B SI CONFIG 1, 2 OU 3
D2  C           ATCOP     IFEQ 1
     C                     MOVEA'STD'     BL0,4
F2  C                     END
D2  C           ATCOP     IFEQ 2
     C                     MOVEA'K2V'     BL0,4
F2  C                     END
D2  C           ATCOP     IFEQ 3
     C                     MOVEA'3B '     BL0,4
F2  C                     END
     C                     Z-ADD*ZEROS    OPVER   21
     *
     C                     MOVE ATSSP     BL0,11
D2  C           AV1P1     IFNE ' '
    C           AV1P2     ORNE ' '
    C           AV1P3     ORNE ' '
     C                     MOVEA'+V.'     BL0,13
D3  C           ATV1P     IFNE ' '
    C           AV1P1     ANDNE'E'
    C           AV1P2     ANDNE'E'
    C           AV1P3     ANDNE'E'
     C                     MOVE ATV1P     BL0,16
     C                     MOVEA'.'       BL0,17
     C                     Z-ADDAPV1P     OPVER
F3  C                     END
D3  C           ATV2P     IFNE ' '
    C           AV2P1     ANDNE'E'
    C           AV2P2     ANDNE'E'
    C           AV2P3     ANDNE'E'
D4  C           BL0,17    IFNE '.'
     C                     MOVE ATV2P     BL0,16
     C                     MOVEA'.'       BL0,17
     C                     Z-ADDAPV2P     OPVER
X4  C                     ELSE
     C                     MOVE ATV2P     BL0,17
     C                     MOVEA'.'       BL0,18
D5  C           APV2P     IFGT OPVER
     C                     Z-ADDAPV2P     OPVER
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           ATV3P     IFNE ' '
    C           AV3P1     ANDNE'E'
    C           AV3P2     ANDNE'E'
    C           AV3P3     ANDNE'E'
D4  C           BL0,18    IFNE '.'
     C                     MOVE ATV3P     BL0,17
     C                     MOVEA'.'       BL0,18
D5  C           APV3P     IFGT OPVER
     C                     Z-ADDAPV3P     OPVER
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           ATOAP     IFEQ 'O'                                      *LAN020
     C                     MOVE '+'       BL0,20                         *LAN020
     C                     MOVEA'OR'      BL0,21                         *LAN020
X2  C                     ELSE
D3  C           ATOAP     IFEQ 'A'                                      *LAN020
     C                     MOVE '+'       BL0,20                         *LAN020
     C                     MOVEA'AL'      BL0,21                         *LAN020
X3  C                     ELSE
D4  C           ATOAP     IFEQ 'C'
     C                     MOVE '+'       BL0,20
     C                     MOVEA'CU'      BL0,21
F4  C                     END
F3  C                     END
F2  C                     END
     * PAR MANQUE DE PLACE, SI DAF => DAF, SI GA => GA, SI GAX => GAX
     *   SI DAF + GA => GADF, SI DAF + GAX => GXDF POS 24 À 27
D2  C           ATEMP     IFNE ' '
D3  C           ATGP      IFEQ ' '
     C                     MOVEA'+DAF'    BL0,23
X3  C                     ELSE
D4  C           ATGP      IFEQ 'X'
     C                     MOVEA'+GXDF'   BL0,23
X4  C                     ELSE
     C                     MOVEA'+GADF'   BL0,23
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           ATGP      IFEQ ' '
     C                     MOVEA'    '    BL0,23
X3  C                     ELSE
D3  C           ATGP      IFEQ 'X'
     C                     MOVEA'+GAX'    BL0,23
X3  C                     ELSE
     C                     MOVEA'+GA '    BL0,23
F3  C                     END
F2  C                     END
F2  C                     END
     * REPIQUAGE
D2  C           COUAR     IFNE 0
     C           AGER1     ORNE 0
     * OFFSTD, OFFK2V OU OFF3B SI CONFIG 1, 2 OU 3
D3  C           ATCOP     IFEQ 1
     C                     MOVEA'STD'     BL0,32
F3  C                     END
D3  C           ATCOP     IFEQ 2
     C                     MOVEA'K2V'     BL0,32
F3  C                     END
D3  C           ATCOP     IFEQ 3
     C                     MOVEA'3B '     BL0,32
F3  C                     END
F2  C                     END
     *
D2  C           ATV1R     IFNE ' '
     C                     MOVEA'+V.'     BL0,37
     C                     MOVE ATV1R     BL0,40
F2  C                     END
     *COMMUN
D2  C           BL0,11    IFEQ 'V'                                      *LAN020
     C                     MOVE BL0,11    BL0,12                         *LAN020
     C                     MOVE 'U'       BL0,11                         *LAN020
F2  C                     END
D2  C           BL0,16    IFEQ 'D'
     C                     MOVEA'FU'      BL0,16
F2  C                     END
D2  C           BL0,18    IFEQ 'D'
     C                     MOVEA'FU'      BL0,18
F2  C                     END
D2  C           BL0,16    IFNE 'T'
    C           BL0,16    ANDNE'R'
    C           BL0,16    ANDNE' '
    C           BL0,17    ANDNE'T'
    C           BL0,17    ANDNE'R'
D3  C           OPVER     IFGE 1
     C                     MOVEA'T'       BL0,19
X3  C                     ELSE
     C                     MOVEA'R'       BL0,19
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   PRÉPARATION ZONE FORMAT WH                       *
    C* ---------------------------------------------------*
    C           PREWH     BEGSR
    C*          ---------------
D1  C           EIPEL     IFEQ 'E'
     C                     MOVELTA,3      NOMEWE
     C                     Z-ADDLPEAP1    LZPEAP
     C                     Z-ADDLPEUT1    LZPEUT
     C                     MOVE INVPA1    INVAFF
     C                     Z-ADDLZAPA1    LZAPPX
     C                     Z-ADDFLAPA1    FLAPPX
     C                     Z-ADDFHAPA1    FHAPPX
X1  C                     ELSE
     C                     MOVELTA,4      NOMEWE
     C                     Z-ADDLPEAP2    LZPEAP
     C                     Z-ADDLPEUT2    LZPEUT
     C                     MOVE INVPA2    INVAFF
     C                     Z-ADDLZAPA2    LZAPPX
     C                     Z-ADDFLAPA2    FLAPPX
     C                     Z-ADDFHAPA2    FHAPPX
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   VERIFICATION ZONE FORMAT WH                      *
    C* ---------------------------------------------------*
    C           VERWH     BEGSR
    C*          ---------------
     C                     SETOF                     40
D1  C           LZPEAP    IFEQ *ZEROS
    C           LZPEUT    OREQ *ZEROS
     C                     SETON                     4065
F1  C                     END
D1  C           LZPEUT    IFGT LZPEAP
     C                     SETON                     4066
F1  C                     END
     *
D1  C           *IN58     IFEQ '1'
D2  C           EIPEL     IFEQ 'E'
     C                     Z-ADDLA1       FLCXH   40
     C                     Z-ADDHA1       FHCXH   40
X2  C                     ELSE
     C                     Z-ADDLA2       FLCXH   40
     C                     Z-ADDHA2       FHCXH   40
F2  C                     END
    C*
D2  C           LZAPPX    IFNE *ZEROS
     C           LZAPPX    MULT 10        LZAPPC  40
D3  C           LZAPPC    IFLT FLCXH
     C                     SETON                     5140
F3  C                     END
F2  C                     END
D2  C           FLAPPX    IFNE *ZEROS
    C           FHAPPX    ANDEQ*ZEROS
    C           FLAPPX    OREQ *ZEROS
    C           FHAPPX    ANDNE*ZEROS
     C                     SETON                     5240
F2  C                     END
D2  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ANDNE*ZEROS
     C                     SETON                     5440
F2  C                     END
D2  C           FLAPPX    IFNE *ZEROS
D3  C           FLAPPX    IFLT FLCXH
    C           FHAPPX    ORLT FHCXH
    C           FLAPPX    OREQ FLCXH
    C           FHAPPX    ANDEQFHCXH
     C                     SETON                     5340
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
    C* ---------------------------------------------------*
    C*   MAJ ZONES FORMAT WH                              *
    C* ---------------------------------------------------*
    C           MAJWH     BEGSR
    C*          ---------------
D1  C           EIPEL     IFEQ 'E'
     C                     Z-ADDLZPEAP    LPEAP1
     C                     Z-ADDLZPEUT    LPEUT1
     C                     MOVE INVAFF    INVPA1
     C                     Z-ADDLZAPPX    LZAPA1
     C                     Z-ADDFLAPPX    FLAPA1
     C                     Z-ADDFHAPPX    FHAPA1
X1  C                     ELSE
     C                     Z-ADDLZPEAP    LPEAP2
     C                     Z-ADDLZPEUT    LPEUT2
     C                     MOVE INVAFF    INVPA2
     C                     Z-ADDLZAPPX    LZAPA2
     C                     Z-ADDFLAPPX    FLAPA2
     C                     Z-ADDFHAPPX    FHAPA2
F1  C                     END
     *
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : OFFSET   - SAUVEGARDE FORMAT OFFSET      *
     * EXTERIEURE ET INTERIEURE                               *
     *--------------------------------------------------------*
    C           SAVOFF    BEGSR
     *          ---------------
     *
     * Sauvegarde OFFSET impression extérieure
D1  C           *IN41     IFEQ '1'
     C                     MOVE TIMPEX    TIMPE1  10
     C                     MOVE TVEEX     TVEE1   1
     C                     MOVE UVEXT     UVEX1   1
F1  C                     END
     *
     * Sauvegarde OFFSET impression intérieure
D1  C           *IN42     IFEQ '1'
     C                     MOVE TIMPEX    TIMPE2  10
     C                     MOVE TVEEX     TVEE2   1
     C                     MOVE UVEXT     UVEX2   1
F1  C                     END
     *
    C           FAVOFF    ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : OFFSET   - CONTROLE FORMAT OFFSET        *
     *--------------------------------------------------------*
    C           CTLOFF    BEGSR
     *          ---------------
D1  C           FFORL     IFNE *ZEROS
    C           FFORH     ANDNE*ZEROS
     C                     Z-ADD0         WAFF    10
     * Recherche du plus petit et du plus grand
     * OUVERT = le plus grand, DEFIL = le plus petit
D2  C           FFORL     IFLT FFORH
     C                     Z-ADDFFORH     OUVERT  40
     C                     Z-ADDFFORL     DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFFORL     OUVERT
     C                     Z-ADDFFORH     DEFIL
F2  C                     END
     * Test Mini Offset
D2  C           OUVERT    IFGE 850
    C           DEFIL     ANDGE620
X2  C                     ELSE
     C                     Z-ADD1         WAFF
F2  C                     END
     *
     * Impression offset en UV
D2  C           WIMPEX    IFEQ 4
    C           WVEEX     ANDEQ'U'
    C           WIMPEX    OREQ 4
    C           WVEXT     ANDEQ'U'
D3  C           DEFIL     IFLE 1020
    C           OUVERT    ANDLE1420
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
X2  C                     ELSE
     *
     * impression offset en TRADI
D3  C           DEFIL     IFLE 1050
    C           OUVERT    ANDLE1450
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
F2  C                     END
     *
     * impression avec dorure
D2  C           WCODOR    IFEQ '*'
D3  C           OUVERT    IFGE 850
    C           DEFIL     ANDGE620
D4  C           DEFIL     IFLE 890
    C           OUVERT    ANDLE1260
X4  C                     ELSE
     C                     Z-ADD1         WAFF
F4  C                     END
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
F2  C                     END
     *
     * Affichage d'une fenetre avec alerte sur le format
D2  C           WAFF      IFEQ 1
     C                     Z-ADDFFORL     EFORL
     C                     Z-ADDFFORH     EFORH
     C                     EXFMTWOFFSET
F2  C                     END
     *
F1  C                     END
    C           FTLOFF    ENDSR
      /EJECT
     *--------------------------------------------------------*
     * S/PROGRAMME : TOUCHE CDE 4                             *
     *--------------------------------------------------------*
    C           TRTAID    BEGSR
     *          ---------------
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
     *
    C           ZONZON    CASEQ'DNATP1'  AID51
    C           ZONZON    CASEQ'DNATP2'  AID51
    C           ZONZON    CASEQ'DNATP3'  AID51
    C           ZONZON    CASEQ'DNATP4'  AID51
    C           ZONZON    CASEQ'DFPXF1'  AID52
    C           ZONZON    CASEQ'DFPXF2'  AID52
    C           ZONZON    CASEQ'DFPXF3'  AID52
    C           ZONZON    CASEQ'DFPXF4'  AID52
    C           ZONZON    CASEQ'DFPXF5'  AID52
    C           ZONZON    CASEQ'DFPXF6'  AID52
    C           ZONZON    CASEQ'DFPXF7'  AID52
    C           ZONZON    CASEQ'DFPXF8'  AID52
    C           ZONZON    CASEQ'DFPXF9'  AID52
    C           ZONZON    CASEQ'DFPXFA'  AID52
    C           ZONZON    CASEQ'DFPXFB'  AID52
    C           ZONZON    CASEQ'DFPXFC'  AID52
    C           ZONZON    CASEQ'DTYPF1'  AID53
    C           ZONZON    CASEQ'DTYPF2'  AID53
    C           ZONZON    CASEQ'DTYPF3'  AID53
    C           ZONZON    CASEQ'DTYPF4'  AID53
    C           ZONZON    CASEQ'DTYPF5'  AID53
    C           ZONZON    CASEQ'DTYPF6'  AID53
    C           ZONZON    CASEQ'DTYPF6'  AID53
    C           ZONZON    CASEQ'DTYPF8'  AID53
    C           ZONZON    CASEQ'DTYPF9'  AID53
    C           ZONZON    CASEQ'DTYPFA'  AID53
    C           ZONZON    CASEQ'DTYPFB'  AID53
    C           ZONZON    CASEQ'DTYPFC'  AID53
    C           ZONZON    CASEQ'ATCOEP'  AID54
    C           ZONZON    CASEQ'LCOEP'   AID54
    C                     CAS            AID0
    C                     END
    C                     ENDSR
      /SPACE 2
    C           AID0      BEGSR
     *          ---------------
     C                     EXFMTWERR
    C                     ENDSR
      /SPACE 2
    C           AID51     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DONA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DNATP1'
     C                     MOVELCODE      DNATP1
     C                     MOVELLIBEL     DLIBP1
F2  C                     END
D2  C           ZONZON    IFEQ 'DNATP2'
     C                     MOVELCODE      DNATP2
     C                     MOVELLIBEL     DLIBP2
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID52     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DOFF'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DFPXF1'
     C                     MOVELCODE      DFPXF1
     C                     MOVELLIBEL     LTFF1
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF2'
     C                     MOVELCODE      DFPXF2
     C                     MOVELLIBEL     LTFF2
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF3'
     C                     MOVELCODE      DFPXF3
     C                     MOVELLIBEL     LTFF3
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF4'
     C                     MOVELCODE      DFPXF4
     C                     MOVELLIBEL     LTFF4
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF5'
     C                     MOVELCODE      DFPXF5
     C                     MOVELLIBEL     LTFF5
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF6'
     C                     MOVELCODE      DFPXF6
     C                     MOVELLIBEL     LTFF6
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF7'
     C                     MOVELCODE      DFPXF7
     C                     MOVELLIBEL     LTFF7
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF8'
     C                     MOVELCODE      DFPXF8
     C                     MOVELLIBEL     LTFF8
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF9'
     C                     MOVELCODE      DFPXF9
     C                     MOVELLIBEL     LTFF9
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID53     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DOTF'    TBLNOM
     C                     Z-ADD4         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DTYPF1'
     C                     MOVELCODE      DTYPF1
     C                     MOVELLIBEL     LTYF1
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF2'
     C                     MOVELCODE      DTYPF2
     C                     MOVELLIBEL     LTYF2
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF3'
     C                     MOVELCODE      DTYPF3
     C                     MOVELLIBEL     LTYF3
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF4'
     C                     MOVELCODE      DTYPF4
     C                     MOVELLIBEL     LTYF4
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF5'
     C                     MOVELCODE      DTYPF5
     C                     MOVELLIBEL     LTYF5
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF6'
     C                     MOVELCODE      DTYPF6
     C                     MOVELLIBEL     LTYF6
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF7'
     C                     MOVELCODE      DTYPF7
     C                     MOVELLIBEL     LTYF7
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF8'
     C                     MOVELCODE      DTYPF8
     C                     MOVELLIBEL     LTYF8
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF9'
     C                     MOVELCODE      DTYPF9
     C                     MOVELLIBEL     LTYF9
F2  C                     END
F1  C                     END
    C                     ENDSR
    C           AID54     BEGSR
     C                     CLEARDSPARM
     C                     MOVEL'OFCO'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      ATCOEP
     C                     MOVELLIBEL     LCOEP
     *SI PRODUIT, PAS DE RECHERCHE DE MACHINE: ELLE EST GÉRÉE PLUS TARD
    C   58                GOTO FIN54
     *RECHERCHE SI CONFIG A PLUSIEURS OFFSETS
     C                     MOVEL'OFCO'    PXARGU
     C                     MOVE ATCOEP    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C                     MOVELPXLIBE    LCOEP
D2  C           PXMONT    IFGT 0
     * 1 MACHINE PAR CONFIG => RECHERCHE AUTOMATIQUE
D3  C           PXMONT    IFEQ 1
     C  N58                MOVEL'OFMA'    PXARGU
     C   58                MOVEL'OFMP'    PXARGU
     C                     MOVE *BLANK    PXVALE    P
     C           PXARGU    CHAINPARAME               50
D4  C           *IN50     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVELCODE      YYY1    1
    C           ZZZ1      CABEQYYY1                     50
     C  N50      PXARGU    READEPARAME                   50
F4  C                     END
     C                     MOVE PXVALE    OUMEP
     C                     MOVE MACEP     AMACEP
D4  C           ODP       IFNE 'P'
     C                     Z-ADDUSIEP     MATA1M
    C*                    ELSE
    C*                    Z-ADDUSIEP     AUSIP
F4  C                     END
     C                     MOVELPXLIBE    LMAC
X3  C                     ELSE
     * N MACHINE PAR CONFIG => AFFICHAGE FENETRE SELECTION
     C  N58                MOVEL'OFMA'    TBLNOM
     C   58                MOVEL'OFMP'    TBLNOM
     C                     Z-ADD5         LG
     C                     MOVELCODE      FICH
     C                     WRITEWB
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D4  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      OUMEP
     C                     MOVE MACEP     AMACEP
D5  C           ODP       IFNE 'P'
     C                     Z-ADDUSIEP     MATA1M
F5  C                     END
     C                     MOVELLIBEL     LMAC
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C           FIN54     ENDSR
**
Impression Extérieur ou Recto:
Impression Intérieur ou Verso:
Extérieur ou Recto:
Intérieur ou Verso:
**
AFFICHE EXTERIEURE POUR PRODUIT :
AFFICHE INTERIEURE POUR PRODUIT :
 ***  A F F I C H E  ***
**
IMP. EXT. PRINC                 01
IMP. EXT. REP.                  02
IMP. INT. PRINC                 03
IMP. INT. REP.                  04
1° GAUF. EXT.                   05
2° GAUF. EXT.                   06
1° GAUF. INT.                   07
2° GAUF. INT.                   08
1° DORURE EXT.                  09
2° DORURE EXT.                  10
1° DORURE INT.                  11
2° DORURE INT.                  12
3° DORURE EXT.                  13
4° DORURE EXT.                  14
3° DORURE INT.                  15
4° DORURE INT.                  16
**  TYPE D'IMPRESSION
1HELIO
2FLEXO
3POST.P
4OFFSET
**  ERR
1° PASSAGE DORURE OBLIGATOIRE
NATURE ET DIFFICULTE OBLIGATOIRE
NATURE DORURE INVALIDE
FAMILLE FILM ET SURFACE OBLIGATOIRE
FAMILLE FILM INVALIDE
1° FILM OBLIGATOIRE
N° PASSAGE INVALIDE
LAIZE FILM OBLIGATOIRE
TYPE DE FILM INVALIDE
RENSEIGNEMENT MANQUENT POUR FILM
TEMPS ET N° BLOC QUE SI NATURE
