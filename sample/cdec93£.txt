     ***************************************************************
     *                                                             *
     *          PGM: CDEC93£  REALISE PAR REMI COURTAINE           *
     *                                                             *
     *            BON DE COMMANDE IMPRESSION                       *
     *            --------------------------                       *
     ***************************************************************
     *  TMAEDE : NOUVEAUTE SUR PRODUIT 8016/ CONF 6042 CLIENT 3781 :
     *              LE BM A CRÉÉ UN N° DE PASSAGE = 6
     *           VU AVEC M. VIGNAUD ==> PASSER LA TABLE À 6 POSTES
     *           (INC0172580)
     *              6 postes ne suffisent pas : mettre 7...
     *
     *            INDICATEURS UTILISES DANS LE PROGAMME            *
     *                                                             *
     * -> U1  INDIQUE LA NOTION DE BON DE COMMANDE OU FABRICATION  *
     * -> U2  INDIQUE LA NOTION DE PASSAGE DE NUIT OU REEL         *
     * -> U8  INDIQUE LA NOTION D'EDITION FORCEE DU BON            *
     *                                                             *
     * -> 30  INDIQUE LA NOTION DE BOBINE OU FORMAT DE V029        *
     * -> 31  INDIQUE LA NOTION DE BOBINE OU FORMAT DE V031        *
     *                                                             *
     *  TOUTES LES ZONES D'EDITION SONT NOMMEES VXXX EN MARGE      *
     *                                                             *
     ***************************************************************
     *  Modif : 05/01/2015  Par : Philippe Le Cardinal                *
     *  But   : Suppression du fichier "Siecle" & recherche du siècle *
     *   via le fichier CALENAL0 (AA/MM/JJ)                           *
     *----------------------------------------------------------------*
     *  Modif : 29/07/2015  Par : NOUZIERES                           *
     *  But   : tester l'indice du tableau CAD avant chargement       *
     *          suite depassement des 11 postes: 7 editées sur FICCDI *
     *------------------------------------------------------------------*
     *----------------------------------------------------------------*
     *  Modif : xx/xx/xxxx  Par : Xxxxxxxxxxxxxxxxxxxxxxxxx           *
     *  But   : Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx *
     *------------------------------------------------------------------*
     FPRLANCXGIF  E           K        DISK
     FPRLANCL9IF  E           K        DISK
     F            PRLANCF1                          KRENAMEPRLANC9
    FPRLANCX4UF  E           K        DISK
     F            PRLANCF1                          KRENAMEPRLANC4
    FPRLANCL0UF  E           K        DISK
     F            PRLANCF1                          KRENAMEPRLANCF
     FRESTPSLDIF  E           K        DISK
     FRESTPSLBIF  E           K        DISK
     F            RESTPSF1                          KRENAMEWESTPSF1
     FPRLANCL8IF  E           K        DISK
     FCARCDEL1IF  E           K        DISK
     FCARCDEL2IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDE2
     FCARCDEZ8IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEU
     FCARCDEZ2IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEZ
     FCLIENTS1IF  E           K        DISK
    FPRODUI2 UF  E           K        DISK                      A
     FPRODST2 IF  E           K        DISK
     FPRODST3 IF  E           K        DISK
     FPRODUL10IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUIF
     FPREIMPL IF  E           K        DISK
     FCALENJL7IF  E           K        DISK
     FCALENS  IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FQUAUSI  IF  E           K        DISK
     FCLIOBIL2IF  E           K        DISK
     FPLAIMPL5IF  E           K        DISK
    F*LANIF7 IF  E           K        DISK
     FCODBARL2IF  E           K        DISK
     FHISTOF15IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FBESOMAL1IF  E           K        DISK
     FPLAMAL1 IF  E           K        DISK
     FRESPAPL5IF  E           K        DISK
     FRESCXHL3IF  E           K        DISK
     FCDESL1  IF  E           K        DISK
     FCDESLC  IF  E           K        DISK
    FOBSPROL1UF  E           K        DISK
     FCAIPALL1IF  E           K        DISK
     FCDEOBSL2IF  E           K        DISK
     *
     FLIEUSTL3IF  E           K        DISK                               PROD17
    FBONIMP  O   F    3091            DISK
    FBSORTI  O   F     292            DISK
    FBONEMB  O   F    2774            DISK
    FBONJAG  O   F     638            DISK
    FCAROFL3 UF  E           K        DISK                      A
     *--- Début --- Philippe  --- 05/01/2015 --*
     * - suppression du ficheir siécle pour récupérer le siécle car il existe
     * dans le fichier CALENS; Utilisation de ce dernier pour le rechercher
    F**SIECLE  IF  E           K        DISK                             PROD17
     FCALENAL0IF  E           K        DISK
     F            CALENDF1                          KRENAMECALENSF1
     *--- Fin   --- Philippe  --- 05/01/2015 --*
     *
     *****************************************************************
     *     TABLES INTERNES
     *****************************************************************
     E                    TI      1  16  2 0 LIM    13
     E                    CON     1  25 40
     E                    ETA     1   5  1   LET    12
     E                    TIM         7  1 0 TRE     1 0
     E                    COP         7  1   NAT     1
     E                    FOH         7  4 0 FOL     4 0
     E                    VAR        20 40   VDT     6
     E                    VEM        20  6
     E                    CDE        10  7 0
    E*                   SUP         5 73
     E                    SUP         7 73
     E                    BAR         8 56
     E                    CAD        11 31
     E                    TAL         7  3 2 STD     4 1
     E                    RED         7  5 0
     E                    CAR        75  1
     E                    WAR        40  1
     E                    TMA         5  2 0
     E                    EMB        10 90
     E                    UFA         9  1 0
     E                    ADPA        7  6
     E                    ADGR        7  3 0
     E                    CXT       100  2               CODES EXTER.
     E                    TPAP        7  3
     E                    TGRA        7  3 0
     E                    OVU         9  1 0 YU      1 0 DECALAGE/U
     E                    OBS         5 40
     *****************************************************************
     *
     ICODBARF1
     I              SUIMP                           BUIMP
     *
     ICAROFF1
     I              SECT                            CECT
     I              SSECT                           CSECT
     I              NOMAC                           COMAC
     I              TIMP                            CIMP
     I              PCLI                            CCLI
     I              SOBESO                          COBESO
     I              FEFAB                           FEFABW
     I              KGFAB                           KGFABW
     I              FORCXH                          FORCX
     I              STECXH                          STECX
     I              CLICXH                          CLICX
     I              PROCXH                          PROCX
     *
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     *
     *  ZONES DE QUAUSI  RENOMMEES  COMMENCENT PAR Y
     IQUAUSIF1
     I              SUIVI                           SUISUI
     *  ZONES DE PRODUI2 RENOMMEES  COMMENCENT PAR Y
     IPRODUIF1
     I              CCOL                            YCOL
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              NOFOR                           YOFOR
     I              ONDH                            YNDH
     I              ONDUL                           YNDUL
     I              POSF1                           YOSF1
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP1                           COP,1
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              NATE1                           NAT,1
     I              NATE2                           NAT,2
     I              NATE3                           NAT,3
     I              NATE4                           NAT,4
     I              NATE5                           NAT,5
     I              NATE6                           NAT,6
     I              NATE7                           NAT,7
     I              USEXT                           YSEXT
     I              USINT                           YSINT
     I              QTFAB                           YTFAB
     I              QTTOT                           YTTOT
     I              QTPRE                           YTPRE
     I              QTREN                           YTREN
     IPRODUIF
     I              ADPAP1                          ADPA,1
     I              ADPAP2                          ADPA,2
     I              ADPAP3                          ADPA,3
     I              ADPAP4                          ADPA,4
     I              ADPAP5                          ADPA,5
     I              ADPAP6                          ADPA,6
     I              ADPAP7                          ADPA,7
     I              ADGRA1                          ADGR,1
     I              ADGRA2                          ADGR,2
     I              ADGRA3                          ADGR,3
     I              ADGRA4                          ADGR,4
     I              ADGRA5                          ADGR,5
     I              ADGRA6                          ADGR,6
     I              ADGRA7                          ADGR,7
     I              PAPI1                           TPAP,1
     I              PAPI2                           TPAP,2
     I              PAPI3                           TPAP,3
     I              PAPI4                           TPAP,4
     I              PAPI5                           TPAP,5
     I              PAPI6                           TPAP,6
     I              PAPI7                           TPAP,7
     I              GRAM1                           TGRA,1
     I              GRAM2                           TGRA,2
     I              GRAM3                           TGRA,3
     I              GRAM4                           TGRA,4
     I              GRAM5                           TGRA,5
     I              GRAM6                           TGRA,6
     I              GRAM7                           TGRA,7
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              NOFOR                           YOFOR
     I              ONDH                            YNDH
     I              ONDUL                           YNDUL
     I              CCOL                            YCOL
     I              POSF1                           YOSF1
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP1                           COP,1
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              NATE1                           NAT,1
     I              NATE2                           NAT,2
     I              NATE3                           NAT,3
     I              NATE4                           NAT,4
     I              NATE5                           NAT,5
     I              NATE6                           NAT,6
     I              NATE7                           NAT,7
     I              USEXT                           YSEXT
     I              USINT                           YSINT
     I              QTFAB                           YTFAB
     I              QTTOT                           YTTOT
     I              QTPRE                           YTPRE
     I              QTREN                           YTREN
     *  ZONES DE CDES   RENOMMEES  COMMENCENT PAR W
     ICDESF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              CDEPRE                          WW4
     I              AGENT                           WW1
     I              QTOT                            WTOT
     *  ZONES DE PRLANC RENOMMEES  COMMENCENT PAR W
     IPRLANCF2
     I              USFAB                           USFAB2
     IPRLANCF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WWPR
     I              SUIMP                           WUIMP
     IPRLANC9
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WWPR
     I              SUIMP                           WUIMP
     IPRLANCF
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WWPR
     I              SUIMP                           WUIMP
     IPRLANC4
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WWPR
     I              SUIMP                           WUIMP
     *  ZONES DE CARCDE RENOMMEES  COMMENCENT PAR W
     ICARCDEF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              USEXT                           WSEXT
     I              USINT                           WSINT
     I              USINE                           WSINE
     I              AGENT                           WGENT
     I              CDEPRE                          WDEPR2
     I              GARNT                           WARNT
     I              SSDEL                           WSDEL
     I              ANDEL                           WNDEL
     I              RGFAC                           WGFAC
     I              RGLIV                           WGLIV
     I              EDIMPM                          WDIMPM
     I              EDIMPJ                          WDIMPJ
     I              EDEXPM                          WDEXPM
     I              EDEXPJ                          WDEXPJ
     I              QTIMP                           WTIMP
     I              QTFAC                           WTFAC
     ICARCDEZ
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     ICARCDE2
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     ICARCDEU
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     *  ZONES DE HISTOFA2 RENOMMEES  COMMENCENT PAR X
     IHISTOFA
     I              NCONF                           XCONF
     I              NOSEQ                           XOSEQ
     *  ZONES DE RESPAP RENOMMEES  COMMENCENT PAR H
     IRESPAPF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     I              SUPOR                           HUPOR
     *  ZONES DE RESPAP RENOMMEES  COMMENCENT PAR H
     IRESCXHF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     I              SUPOR                           HUPOR
     *  ZONES DE OBSPROL RENOMMEES
     IOBSPROF1
     I              AA                              ACRE
     I              MM                              MCRE
     I              JJ                              JCRE
     *  ZONES DE MVTIMP   RENOMMEES  COMMENCENT PAR I
     IMVTIMPF1
     I              NCONF                           ICONF
     I              NOSEQ                           IOSEQ
     I              PAPI                            IAPI
     I              GRAMM                           IRAMM
     I              REFOUR                          IEFOUR
     I              GRAREL                          IRAREL
     *  ZONES DE BESOMAT  RENOMMEES  COMMENCENT PAR B
     IBESOMATF
     I              LMINI                           BMINI
     I              UVENT                           BVENT
     I              QTFAB                           BTFAB
     I              QTTOT                           BTTOT
     I              QTPRE                           BTPRE
     I              QTREN                           BTREN
     I              TALO1                           TAL,1
     I              TALO2                           TAL,2
     I              TALO3                           TAL,3
     I              TALO4                           TAL,4
     I              TALO5                           TAL,5
     I              TALO6                           TAL,6
     I              TALO7                           TAL,7
     I              STD1                            STD,1
     I              STD2                            STD,2
     I              STD3                            STD,3
     I              STD4                            STD,4
     I              STD5                            STD,5
     I              STD6                            STD,6
     I              STD7                            STD,7
     I              SUREG                           BUREG
     *  ZONES DE RESTPSLC RENOMMEES
     IRESTPSF1
     I              I                               PAS
     I              USFAB                           WUSFAB
     I              NOMAC                           WOMAC
     IWESTPSF1
     I              I                               PAS
     I              USFAB                           WUSFAB
     I              NOMAC                           WOMAC
     *  ZONES DE PLAIMPL5 RENOMMEES
     IPLAIMPF1
     I              I                               PAS
     *  ZONES DE PLANIFL1 RENOMMEES
    I*LANIFF1
    I*             I                               PAS
    I*             SUREG                           WUREG
    I*             USFAB                           WUSFAB
     *  ZONES DE PLAMA    RENOMMEES
     IPLAMAF1
     I              USFAC                           XUSFAC
     ICALENDJ
     I              OVRT                            OVU,2
     I              OVTY                            OVU,3
     I              OVNE                            OVU,4
     I              OVCH                            OVU,5
     I              OV06                            OVU,6
     I              OV07                            OVU,7
     I              OV08                            OVU,8
     I              OV09                            OVU,9
     *  ZONES DE PLAIMPL5 RENOMMEES
     IPRODSTF2
     I              SUPOR                           SUPOR3
     *****************************************************************
     *     RUPTURES   ET  DS
     *****************************************************************
     * Zone de Communications de Données DATCDE
     * ----------------------------------------
     *
     I            DS
     I                                        1   20AA
     I                                        3   40MM
     I                                        5   60JJ
     I                                        1   60DATEJ
     *
     I            DS
     I                                        1   20TITIMP
     I                                        1   10TITREP
     I                                        2   20TITPRI
     *
     IBT3         DS
     I                                        1   1 BLANC
     I                                        2   20YACON
     I                                        3   40COAS1
     *
     I            DS
     I                                        1   40DALAN
     I                                        1   20LANIMP
     I                                        3   40LANFAC
     *
     I            DS
     I                                        1  10 V002
     I                                        1   20DAY
     I                                        5   60MONTH
     I                                        9  100YEAR1
     *
     I            DS
     I                                        1   60X014
     I                                        1   20DAYX
     I                                        3   40MONTHX
     I                                        5   60YEAR1X
     *
     I            DS
     I                                        1   60DATFAB
     I                                        1   20AFAB
     I                                        3   40MFAB
     I                                        5   60JFAB
     *
     I            DS
     I                                        1   60DTMAJ
     I                                        1   20JMAJ
     I                                        3   40MMAJ
     I                                        5   60AMAJ
     *
     I            DS
     I                                        1   60DTPAN
     I                                        1   20PANAA
     I                                        3   40PANMM
     I                                        5   60PANJJ
     *
     I            DS
     I                                        1   60DTPRDE
     I                                        1   20AAPRDE
     I                                        3   40MMPRDE
     I                                        5   60JJPRDE
     *
     I            DS
     I                                        1   60DTCRE
     I                                        1   20JCRE
     I                                        3   40MCRE
     I                                        5   60ACRE
     *
     I            DS
     I                                        1   60V008
     I                                        1   20V0081
     I                                        3   40V0082
     I                                        5   60V0083
     *
     I            DS
     I                                        1 100 PARAM2
     I                                        1   10PUS
     *
     I            DS
     I                                        1   60V009
     I                                        1   20V0091
     I                                        3   40V0092
     I                                        5   60V0093
     *
     I            DS
     I                                        1  40 V014
     I                                       25  40 V0141
     I                                       28  280V0142
     *
     I            DS
     I                                        1 160 VCTL
     I                                        1  40 V032
     I                                       41  80 V033
     I                                       81 120 V034
     I                                      121 160 V035
     *
     I            DS
     I                                        1  24 VDTL
     I                                        1   60V036
     I                                        7  120V037
     I                                       13  180V038
     I                                       19  240V039
     *
     I            DS
     I                                        1 160 VCON
     I                                        1  40 V040
     I                                       41  80 V041
     I                                       81 120 V042
     I                                      121 160 V043
     *
     I            DS
     I                                        1  24 VDON
     I                                        1   60V044
     I                                        7  120V045
     I                                       13  180V046
     I                                       19  240V047
     *
     I            DS
     I                                        1 240 VIMPL1
     I                                      241 480 VIMPL2
     I                                        1  40 V048
     I                                       41  80 V049
     I                                       81 120 V050
     I                                      121 160 V051
     I                                      161 200 V052
     I                                      201 240 V053
     I                                      241 280 V054
     I                                      281 320 V055
     I                                      321 360 V056
     I                                      361 400 V057
     I                                      401 440 V058
     I                                      441 480 V059
     *
     I            DS
     I                                        1  72 VIMPD
     I                                        1   60V072
     I                                        7  120V073
     I                                       13  180V074
     I                                       19  240V075
     I                                       25  300V076
     I                                       31  360V077
     I                                       37  420V078
     I                                       43  480V079
     I                                       49  540V080
     I                                       55  600V081
     I                                       61  660V082
     I                                       67  720V083
     *
     I            DS
     I                                        1  72 VIMPE
     I                                        1   6 V060
     I                                        7  12 V061
     I                                       13  18 V062
     I                                       19  24 V063
     I                                       25  30 V064
     I                                       31  36 V065
     I                                       37  42 V066
     I                                       43  48 V067
     I                                       49  54 V068
     I                                       55  60 V069
     I                                       61  66 V070
     I                                       67  72 V071
     *
     I            DS
     I                                        1   70PRECDE
     I                                        1   50ICONF
     I                                        6   70IOSEQ
     *
     IDSPARA      DS
     I                                        1   50WCONF1
     I                                        6   90WOPRO1
     I                                       10  160SURF
     I                                       17  203SF
     I                                       21  270MIN
     I                                       28  340MAX
     I                                       35  35 DS1
     I                                       36  420SURFF
     I                                       43  43 PROT
     I                                       44  470WOCLI1
     *
     I            DS
     I                                        1  73 V097
     I                                        1   6 V0971
     I                                        7   7 V097P
     I                                        8   80V097I
     I                                       10  11 V0972
     I                                       12  13 V097S
     I                                       15  150V0973
     I                                       16  170V097R
     I                                       20  200V0974
     I                                       25  25 V0975
     I                                       31  350V0976
     I                                       38  442V0977
     I                                       47  532V0978
     I                                       56  560V0979
     I                                       58  640V097A
     I                                       67  732V097B
     *
     I            DS
     I                                        1  73 V098
     I                                        1   6 V0981
     I                                        7   7 V098P
     I                                        8   80V098I
     I                                       10  11 V0982
     I                                       12  13 V098S
     I                                       15  150V0983
     I                                       16  170V098R
     I                                       20  200V0984
     I                                       25  25 V0985
     I                                       31  350V0986
     I                                       38  442V0987
     I                                       47  532V0988
     I                                       56  560V0989
     I                                       58  640V098A
     I                                       67  732V098B
     *
     I            DS
     I                                        1  73 V099
     I                                        1   6 V0991
     I                                        7   7 V099P
     I                                        8   80V099I
     I                                       10  11 V0992
     I                                       12  13 V099S
     I                                       15  150V0993
     I                                       16  170V099R
     I                                       20  200V0994
     I                                       25  25 V0995
     I                                       31  350V0996
     I                                       38  442V0997
     I                                       47  532V0998
     I                                       56  560V0999
     I                                       58  640V099A
     I                                       67  732V099B
     *
     I            DS
     I                                        1  73 V100
     I                                        1   6 V1001
     I                                        7   7 V100P
     I                                        8   80V100I
     I                                       10  11 V1002
     I                                       12  13 V100S
     I                                       15  150V1003
     I                                       16  170V100R
     I                                       20  200V1004
     I                                       25  25 V1005
     I                                       31  350V1006
     I                                       38  442V1007
     I                                       47  532V1008
     I                                       56  560V1009
     I                                       58  640V100A
     I                                       67  732V100B
     *
     I            DS
     I                                        1  73 V101
     I                                        1   6 V1011
     I                                        7   7 V101P
     I                                        8   80V101I
     I                                       10  11 V1012
     I                                       12  13 V101S
     I                                       15  150V1013
     I                                       16  170V101R
     I                                       20  200V1014
     I                                       25  25 V1015
     I                                       31  350V1016
     I                                       38  442V1017
     I                                       47  532V1018
     I                                       56  560V1019
     I                                       58  640V101A
     I                                       67  732V101B
     *
     I            DS
     I                                        1  56 W104
     I                                       55  56 W1042
     I                                       56  560W1041
     *
     I            DS
     I                                        1  20 REFCO
     I                                       21  40 CLICO
     I                                        1  40 REFPRO
     *
     I            DS
     I                                        1 448 BAR
     I                                        1  56 V104
     I                                       57 112 V105
     I                                      113 168 V106
     I                                      169 224 V107
     I                                      225 280 V108
     I                                      281 336 V109
     I                                      337 392 V110
     I                                      393 448 V111
     *
     I            DS
     I                                        1   50DTDEL
     I                                        1   20ANDEL
     I                                        3   40SEDEL
     I                                        5   50JSDEL
     *
     I            DS
     I                                        1  31 V115
     I                                        1   20V1151
     I                                        7  150V1152
     I                                       21  250V1153
     I                                       30  31 V1154
     *
     I            DS
     I                                        1  31 V116
     I                                        1   20V1161
     I                                        7  150V1162
     I                                       21  250V1163
     I                                       30  31 V1164
     *
     I            DS
     I                                        1  31 V117
     I                                        1   20V1171
     I                                        7  150V1172
     I                                       21  250V1173
     I                                       30  31 V1174
     *
     I            DS
     I                                        1  31 V118
     I                                        1   20V1181
     I                                        7  150V1182
     I                                       21  250V1183
     I                                       30  31 V1184
     *
     I            DS
     I                                        1  31 V119
     I                                        1   20V1191
     I                                        7  150V1192
     I                                       21  250V1193
     I                                       30  31 V1194
     *
     I            DS
     I                                        1  31 V120
     I                                        1   20V1201
     I                                        7  150V1202
     I                                       21  250V1203
     I                                       30  31 V1204
     *
     I            DS
     I                                        1  31 V121
     I                                        1   20V1211
     I                                        7  150V1212
     I                                       21  250V1213
     I                                       30  31 V1214
     *
     I            DS                             31
     I                                        1  31 V122
     *
     I            DS                             31
     I                                        1  31 V123
     *
     I            DS                             31
     I                                        1  31 V124
     I                                        1  10 V1241
     I                                       11  11 V124S
     I                                       12  15 V124C
     I                                       16  19 V124P
     I                                       20  24 V124N
     I                                       25  26 V124Q
     *
     I            DS
     I                                        1   60DDEF
     I                                        1   20ADEF
     I                                        3   40MDEF
     I                                        5   60JDEF
     *
     I            DS
     I                                        1   60DDEF01
     I                                        1   20ADEF01
     I                                        3   40MDEF01
     I                                        5   60JDEF01
     *
     I            DS
     I                                        1   60DDEF02
     I                                        1   20ADEF02
     I                                        3   40MDEF02
     I                                        5   60JDEF02
     *
     I            DS
     I                                        1   60DDEF03
     I                                        1   20ADEF03
     I                                        3   40MDEF03
     I                                        5   60JDEF03
     *
     I            DS
     I                                        1   60DDEF04
     I                                        1   20ADEF04
     I                                        3   40MDEF04
     I                                        5   60JDEF04
     *
     I            DS
     I                                        1  24 VARNT
     I                                        1   9 YARNT2
     I                                       11  12 YARNT
     I                                       11  11 YARNT1
     I                                       12  12 YARNT3
     I                                       14  14 EGAL
     I                                       16  20 OFCONF
     I                                       21  22 OFSEQ
     I                                       23  23 OFSUP
     I                                       24  24 OFLETR
     *
     I            DS
     I                                        1  90 T007
     I                                        1  75 T0071
     I                                       76  800T0072
     I                                       82  840T0073
     I                                       86  900T0074
     *
     I            DS
     I                                        1  90 T008
     I                                        1  75 T0081
     I                                       76  800T0082
     I                                       82  840T0083
     I                                       86  900T0084
     *
     I            DS
     I                                        1  90 T009
     I                                        1  75 T0091
     I                                       76  800T0092
     I                                       82  840T0093
     I                                       86  900T0094
     *
     I            DS
     I                                        1  90 T010
     I                                        1  75 T0101
     I                                       76  800T0102
     I                                       82  840T0103
     I                                       86  900T0104
     *
     I            DS
     I                                        1   2 HABIL1
     I                                        1   1 HABI11
     I                                        2   2 HABI12
     *
     I            DS
     I                                        1   2 HABIL2
     I                                        1   1 HABI21
     I                                        2   2 HABI22
     *
     I            DS
     I                                        1   2 HABIL3
     I                                        1   1 HABI31
     I                                        2   2 HABI32
     *
     *
     I            DS
     I                                        1  27 DSFA
     I                                        1   30FAOND
     I                                        1   10UFA1
     I                                        4   60FACOL
     I                                        4   40UFA2
     I                                        7   90FATYE
     I                                        7   70UFA3
     I                                       10  120FATYI
     I                                       10  100UFA4
     I                                       13  150FADEC
     I                                       13  130UFA5
     I                                       16  180FAAUT
     I                                       16  160UFA6
     I                                       19  210FAFEN
     I                                       19  190UFA7
     I                                       22  240FAAS1
     I                                       22  220UFA8
     I                                       25  270FAAS2
     I                                       25  250UFA9
     *
     IHLIREF      DS
     I                                        1   1 HTE
     I                                        3   6 HOCLI
     I                                        8  11 HOPRO
     I                                       13  17 HCONF
     I                                       19  20 HEQFAB
     I            DS
     I                                        1   5 DSSSSM
     I                                        1   10USFAB
     I                                        2   2 SECTD
     I                                        3   3 SSECTD
     I                                        4   5 NOMAC
     *
     IDSPROG      DS
     I                                        1   10STEP
     I                                        2   50NOCLIP
     I                                        6   90NOPROP
     I                                       10  100USP
     I                                       11  12 WSECT
     I                                       11  11 SECT
     I                                       12  12 SSECT
     I                                       13  13 INN
     I                                       21  300TMA
     *
     ICDEPRO      DS
     I                                        1   50CBCONF
     I                                        6   70CBSEQ
     I                                        8  110CBPRO
     *
     I            DS
     I                                        1  10 ISO
     I                                        1   10USISO
     I                                        2  10 PXVA
     *
     I            DS
     I                                        1   70V0941
     I                                        1   50CENT1
     I                                        6   70CENT2
     *
     I            DS
     I                                        1   7 DEMAN
     I                                        1   6 RIREP
     *
     I            DS
     I                                        1   1 DZPNBR
     I                                        2   2 DZPNB2
     I                                        1   2 SUPHA2
     *
     *****************************************************************
     *     CLES D'ACCES AUX FICHIERS
     *****************************************************************
     *
     * cle pour le fichier parametre .
     C           KPARAM    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *
     * cle pour le fichier PRLANC .
     C           KPRLAN    KLIST
     C                     KFLD           PUS
     C                     KFLD           PECPAP
     C                     KFLD           PANSA
     C                     KFLD           PANMM
     C                     KFLD           PANJJ
     *
     C           KPRLA9    KLIST
     C                     KFLD           PUS
     C                     KFLD           PECPAP
     C                     KFLD           PANSS
     C                     KFLD           PANAA
     C                     KFLD           PANMM
     C                     KFLD           PANJJ
     *
     C           KPRLA2    KLIST
     C                     KFLD           PUS
     C                     KFLD           PECPAP
     *
     *  CLE D'ACCES FICHIER PRLANCL0
     C           KPRLA1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WWQFAB
     C                     KFLD           PECPAP
     *
     * cle pour le fichier PRLANCL8
     C           KPRLA8    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     C           KPRL18    KLIST
     C                     KFLD           NCONF
     C                     KFLD           NOPRO
     C                     KFLD           SEQFAB
     *
     * cle pour le fichier CARCDE .
     C           KCARCD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     C           KCAR22    KLIST
     C                     KFLD           ICONF
     C                     KFLD           WOPRO
     *
     C           KCARC2    KLIST
     C                     KFLD           ICONF
     C                     KFLD           WOPRO
     C                     KFLD           IOSEQ
     *
     C           KCAR12    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     C           KCARCU    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     * cle pour le fichier CARCDEZ8
     C           KCARZ8    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           SSS
     C                     KFLD           AAA
     C                     KFLD           MMM
     *
     * cle pour le fichier CALENS .
     C           KCALEN    KLIST
     C                     KFLD           YEARS
     C                     KFLD           YEAR
     C                     KFLD           MONTH
     C                     KFLD           DAY
     *
     C           KCAL01    KLIST
     C                     KFLD           SDEF    20
     C                     KFLD           ADEF
     C                     KFLD           MDEF
     C                     KFLD           JDEF
     *
     * cle pour le fichier CALENJL7 .
     C           KCAL07    KLIST
     C                     KFLD           YEARS
     C                     KFLD           YEAR
     C                     KFLD           CALNOJ
     *
     *  CLE D'ACCES FICHIER CLIENTS
     C           KCLIL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     *
     *  CLE D'ACCES FICHIER HISTOF15
     C           KHIS05    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           NPRO    40
     C                     KFLD           SHIVAL  20
     C                     KFLD           HIVAL   60
     *
     C           KHIS15    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           NPRO
     *
     *  CLE D'ACCES FICHIER CDESL1
     C           KCDES1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER PRODUI2 ET MVTIMP
     C           KPRO10    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KPRODO    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           PRODOR
     *
     C           KHIVAL    KLIST
     C                     KFLD           CLIVAL
     C                     KFLD           PROVAL
     *
     *  CLE D'ACCES FICHIER OBSPROL
     C           KOBSP1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     *
     C           KOBSP2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     C                     KFLD           EMET
     *
     *  CLE D'ACCES FICHIER PRODUL15 ET PRODUL16
     *  CLE D'ACCES FICHIER PREIMPL
     C           KPREI1    KLIST
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER PLAMA
     C           KPLAM1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     *
     C           KPLAM2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     *
     *
     *  CLE D'ACCES FICHIER RESCXHL3
     C           KCXHL3    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     C                     KFLD           TRIORI
     *  CLE D'ACCES FICHIER RESPAPL5
     C           KRESPA    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     C           KRESP     KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PEC     1
     C                     KFLD           PUP     1
     C                     MOVE 'C'       PEC
     *
     *  CLE D'ACCES FICHIER
     C           KBARL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER CLIOBI
     C           KCLIOB    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WCOD    8
     *
     *  CLE D'ACCES FICHIER BESOMAT
     C           KBESL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER QUAUSI
     C           KUSIL1    KLIST
     C                     KFLD           PUS
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     C                     KFLD           FOUB
     *
     *  CLE D'ACCES FICHIER RESTPSLD
     C           KRESLD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     C                     KFLD           PRIORI
     *
     *  CLE D'ACCES FICHIER PLAIMPL5
     *
     C           KPLAL5    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           SU
     *
     C           KPLA15    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           SU
     C                     KFLD           R
     *
     * cle pour le fichier CAIPALL1
     C           KCAIL1    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           EMBNO
     *  CLE D'ACCES FICHIER CAROFL3
     C           KCOFL3    KLIST
     C                     KFLD           PUS
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           WOPRO
     C                     KFLD           TRIORI
     *
     *  CLE D'ACCES FICHIER CDESLC
     C           KCDESC    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER CDESLC
     C           KCDSC     KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WCONF
     C                     KFLD           PRODOR
     *  CLE D'ACCES FICHIER CDESLC
     C           KRESLB    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           SECT1   1
     C                     KFLD           SSECT5  1
     C                     KFLD           WUIMP
     C                     MOVE '1'       SECT1
     C                     MOVE '5'       SSECT5
     *--- Début --- Philippe  --- 05/01/2015 --*
     * - Clé d'accès au ficheir CALENAL0
     C           KL0       KLIST
     C                     KFLD           AA
     C                     KFLD           MM
     C                     KFLD           JJ
     *--- Fin   --- Philippe  --- 05/01/2015 --*
     *
     C           *ENTRY    PLIST
     C                     PARM           PARAM 100
     C                     MOVE PARAM     PARAM2
     ***************************************************************
     *   DEBUT DU PROGRAMME                                        *
     ***************************************************************
     C                     Z-ADD0         C       30
     C                     MOVE 'CEXT'    PXARGU
     C           PXARGU    CHAINPARAME               80
D1  C           *IN80     DOWEQ'0'
D2  C           PXMONT    IFEQ 0
     C                     ADD  1         C
     C                     MOVE PXVALE    CXT,C
F2  C                     END
     C           PXARGU    READEPARAME                   80
F1  C  N80                END
     C           *NAMVAR   DEFN           DATCDE  6
D1  C           *INU1     IFEQ '0'
     C           PUS       COMP 5                        05
     C           PUS       COMP 7                        07
     C  N05N07   PUS       COMP 3                    040203
     C                     IN   DATCDE
     C                     MOVE DATCDE    DATEJ
     *--- Début --- Philippe  --- 05/01/2015 --*
     * - Mise ne commentaire car utilisation de CALENAL0 pour recherche de
     * valeur siècle
    C**         AA        CHAINSIECLE               99
    C**                   Z-ADDSS        SSJ     20
     *
     C           KL0       CHAINCALENAL0             99
     C  N99                Z-ADDCALSS     SSJ     20
     C   99                Z-ADD20        SSJ
D2  C   99      AA        IFGE 90
     C                     Z-ADD19        SSJ
F2  C                     ENDIF
     *--- Fin   --- Philippe  --- 05/01/2015 --*
X1  C                     ELSE
     C                     MOVEL*YEAR     SSJ
     C                     Z-ADDUYEAR     AA
     C                     Z-ADDUMONTH    MM
     C                     Z-ADDUDAY      JJ
F1  C                     END
     C                     Z-ADDPUS       PUSI    10
     C                     Z-ADDPUS       USISO
     C                     MOVE 'P'       PRIREP  1
     C                     MOVE *BLANKS   V127   15
     C                     MOVE *ZEROS    DSFA
     C                     Z-ADD20        SSS     20
     C                     Z-ADD99        AAA     20
     C                     Z-ADD99        MMM     20
     C                     Z-ADD0         YACON
     C                     Z-ADD0         COAS1
     C                     Z-ADD0         TITIMP
     C                     Z-ADD0         SURF
     C                     Z-ADD0         SF
     C                     Z-ADD0         MAX
     C                     Z-ADD0         MIN
     C                     Z-ADD0         DTMAJ
     C                     Z-ADD0         DTCRE
     C                     Z-ADD0         WCONF1
     C                     Z-ADD0         WOPRO1
     C                     MOVE 'I'       PECPAP  1
     C                     MOVE *HIVAL    SHIVAL
     C                     MOVE *HIVAL    HIVAL
     C                     Z-ADDAA        YEAR1
     C                     Z-ADDSSJ       YEARS
     C                     Z-ADDAA        YEAR
     C                     Z-ADDMM        MONTH
     C                     Z-ADDJJ        DAY
     C                     Z-ADDAA        YEAR1X
     C                     Z-ADDMM        MONTHX
     C                     Z-ADDJJ        DAYX
     C                     Z-ADD9999      CLIVAL  40
     C                     Z-ADD9999      PROVAL  40
     C                     Z-ADD9999      NOCLI
     C                     Z-ADD9999      NOPRO
     C                     Z-ADD0         UFA
     C           KHIVAL    CHAINPRODUI2              81
     C   81                WRITEPRODUIF1
     *
D1  C           *INU1     IFEQ '0'
D2  C           *INU2     IFEQ '0'
D3  C           *IN02     IFEQ '1'
     C           *NAMVAR   DEFN           DALANR  4
     C                     IN   DALANR
     C                     MOVE DALANR    DALAN
F3  C                     END
     *
D3  C           *IN04     IFEQ '1'
     C           *NAMVAR   DEFN           DALANN  4
     C                     IN   DALANN
     C                     MOVE DALANN    DALAN
F3  C                     END
     *
D3  C           *IN05     IFEQ '1'
     C           *NAMVAR   DEFN           DALANC  4
     C                     IN   DALANC
     C                     MOVE DALANC    DALAN
F3  C                     END
     *
D3  C           *IN07     IFEQ '1'
     C           *NAMVAR   DEFN           DALANF  4
     C                     IN   DALANF
     C                     MOVE DALANF    DALAN
F3  C                     END
X2  C                     ELSE
D3  C           *IN02     IFEQ '1'
     C           *NAMVAR   DEFN           DANUIR  4
     C                     IN   DANUIR
     C                     MOVE DANUIR    DALAN
F3  C                     END
     *
     *
D3  C           *IN04     IFEQ '1'
     C           *NAMVAR   DEFN           DANUIN  4
     C                     IN   DANUIN
     C                     MOVE DANUIN    DALAN
F3  C                     END
F2  C                     END
     *
D2  C           PUS       IFEQ 2
    C           *INU8     ANDEQ'0'
    C*                    GOTO FINNUL
F2  C                     END
    C           LANIMP    CABEQ0         FINNUL
     *
     *  RECHERCHE DE LA DATE DU TRAITEMENT
     *  ==================================
     *
     C           KCALEN    CHAINCALENS               80
     C           KCAL07    CHAINCALENJL7             80
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
     *
     * SI JOUR = OV  FAIRE COMME SI  =  FIN DE S.(RECHERCHE DE LA SEM.
     * =========================================             SUIVANTE)
     C                     Z-ADD0         CPT     20
D2  C           *IN80     DOWEQ'0'
     *
D3  C           CALJOU    IFEQ 'SAMEDI  '
    C           CALJOU    OREQ 'DIMANCHE'
    C           CALJOU    OREQ 'FERIE   '
    C           CALJOU    OREQ 'OV      '
    C           OVU,PUS   OREQ 1
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
X3  C                     ELSE
     C                     ADD  1         CPT
     C           CPT       COMP LANIMP                   80
     C  N80                READ CALENJL7                 80
F3  C                     END
F2  C  N80                END
     *
     C                     Z-ADDCALAA     PANAA   20
     C                     Z-ADDCALMM     PANMM   20
     C                     Z-ADDCALJJ     PANJJ   20
     C                     MOVELCALSS     PANSA   40
     C                     MOVELCALSS     PANSS   20
     C                     MOVE PANAA     PANSA
F1  C                     END
     *
     *              ///////////////////////////
     *              /  DEBUT DU TRAITEMENT :  /
     *              ///////////////////////////
     *
     C           DEBUT     TAG
     C   U8                SETON                     18
     *
D1  C           *IN18     IFEQ '0'
D2  C           *INU1     IFEQ '0'
D3  C           PUS       IFEQ 0
     C           KPRLA9    SETLLPRLANCL9
     C           KPRLA2    READEPRLANCL9                 80
X3  C                     ELSE
     C           KPRLA2    CHAINPRLANCXG             80
F3  C                     END
    C           *IN80     CABEQ'1'       FIN
     *
X2  C                     ELSE
     C                     READ CDESL1                   80
    C           *IN80     CABEQ'1'       FIN
     C           *LIKE     DEFN WEQFAB    WWQFAB
     C                     MOVE *BLANKS   V102   60
D3  C           TAGBID    IFEQ 'U'
     C                     MOVELCON,14    V102
F3  C                     END
     C                     Z-ADD1         WWQFAB
     C           KPRLA1    CHAINPRLANCL0             81
D3  C           *IN81     IFEQ '0'
     C                     Z-ADDUSFAB     PUS
    C           PUS       CABEQ3         SUITE
X3  C                     ELSE
     C                     Z-ADD1         WEQFAB
     C           KCARCD    CHAINCARCDEL1             81
D4  C           WSEXT     IFNE *ZERO
     C                     MOVE 'E'       SUPOR
     C                     Z-ADD3         WUIMP
     C                     SETON                     52
     C                     Z-ADDWSEXT     PUS
X4  C                     ELSE
D5  C           WSINT     IFNE *ZERO
     C                     MOVE 'I'       SUPOR
     C                     Z-ADD5         WUIMP
     C                     SETON                     52
     C                     Z-ADDWSINT     PUS
F5  C                     END
F4  C                     END
    C           PUS       CABEQ3         SUITE
    C           PUS       CABEQ0         SUITE
F3  C                     END
F2  C                     END
     *
X1  C                     ELSE
     *
     C                     SETOF                     8052
     C           KPRLA2    CHAINPRLANCX4             80
    C           *IN80     CABEQ'1'       FIN            23
     C                     Z-ADDWEQFAB    WWQFAB
F1  C                     END
     *
D1  C           *IN80     DOWEQ'0'
     *
     C                     SETOF                     303142
     C                     SETOF                     4179
     C           KPREI1    CHAINPRODST3              81
D2  C           *IN81     IFEQ '0'
     C           KPRODO    CHAINPRODUL10             81
     C                     SETON                     79
     C           *LIKE     DEFN YOFOR     FORAFF
     C           *LIKE     DEFN TYPPRP    TYPAFF
     C           *LIKE     DEFN YOSF1     YOSAFF
     C           *LIKE     DEFN YNDH      YNDAFF
     C                     MOVE YOFOR     FORAFF
     C                     MOVE TYPPRP    TYPAFF
     C                     MOVE YOSF1     YOSAFF
     C                     MOVE YNDH      YNDAFF
F2  C                     END
     *  LA CDE NE DOIT PAS AVOIR ETE EDITEE
     *  ...................................
     C  N52      KCARCD    CHAINCARCDEL1             81
    C  N79      *IN81     CABEQ'1'       SUITE
D2  C           *INU1     IFEQ '1'
    C*          WDEPR2    CABNE' '       SUITE
    C           WARNT     CABEQ'RE'      SUITE
X2  C                     ELSE
     *
    C           WARNT     CABEQ'RE'      SUITE
     *
    C           MMFABD    CABNE*ZEROS    SUITE
D3  C           FORDOC    IFEQ *BLANK
    C           *IN18     ANDEQ'0'
    C           CODEL     CABEQ'  '      SUITE
    C           CODEL     CABEQ'PR'      SUITE
    C           CODEL     CABEQ'AT'      SUITE
    C           WSDEL     CABEQ*ZEROS    SUITE
F3  C                     END
F2  C                     END
     *
     C                     Z-ADDPRIORI    TRIORI  31
     C                     MOVE *BLANKS   OBS
     C           KCOFL3    CHAINCAROFL3              9099
D2  C           *IN90     DOWEQ'0'
     C                     Z-ADDSUPPOR    SU
D3  C           SU        IFEQ 0
     C                     Z-ADD1         SU
F3  C                     END
     C                     MOVE OBSERV    OBS,SU
     C           KCOFL3    READECAROFL3                9990
F2  C  N90                END
     C                     SETOF                     22
D2  C           OFETA     IFEQ 'EC'
     C                     SETON                     22
F2  C                     END
     C           KCOFL3    DELETCAROFL3              9099
D2  C           *IN90     DOWEQ'0'
     C           KCOFL3    DELETCAROFL3              9099
F2  C  N90                END
     *
     C           PUS       COMP 5                        05
     C           PUS       COMP 7                        07
     C  N05N07   PUS       COMP 3                    040203
     C                     MOVE *BLANKS   T007
     C                     Z-ADD0         T0072
     C                     Z-ADD0         T0073
     C                     Z-ADD0         T0074
     C                     MOVE T007      T008
     C                     MOVE T007      T009
     C                     MOVE T007      T010
     C                     MOVE *BLANKS   V122
     C                     MOVE *BLANKS   V123
     C                     MOVE *BLANKS   V124
     *
     C           KBESL1    CHAINBESOMAL1             81
    C           *IN81     CABEQ'1'       SUITE
D2  C           SBFE      IFEQ *ZEROS
     C           FORLBM    MULT 0,001     WORLBM  43
     C           FORHBM    MULT 0,001     WORHBM  43
     C           WORLBM    MULT WORHBM    SBFE
D3  C           SBFE      IFEQ *ZEROS
     C                     Z-ADDSBZ       SBFE
F3  C                     END
F2  C                     END
     *
     C                     Z-ADDWCONF     CBCONF
     C                     Z-ADDWEQFAB    CBSEQ
     C                     Z-ADDWOPRO     CBPRO
     *
     *  ---> TITRE IMPRESSION
     *  ---------------------
     *
     C                     MOVE *BLANKS   V001   13
     C                     Z-ADD0         USFAC
     C                     Z-ADD0         FAIME
     C                     Z-ADD0         FAIMI
     C                     MOVE *BLANKS   RETS1
     C                     MOVE *BLANKS   X020    4
     C                     SETOF                     79
     C           KHIVAL    CHAINPRODUI2              81
D2  C           WTE       IFNE 0
     C           KPRO10    CHAINPRODUL10             81
D3  C           *IN81     IFEQ '1'
    C           WOPRO     ANDGT8000
     C           KPREI1    CHAINPRODST3              81
D4  C           *IN81     IFEQ '0'
     C                     SETON                     79
     C                     MOVE FORAFF    YOFOR
     C                     MOVE INPLAA    ZB16
     C                     MOVE TYPAFF    TYPPRP
     C                     MOVE YOSAFF    YOSF1
     C                     MOVE YNDAFF    YNDH
     C                     MOVE USA       WSEXT
     C                     MOVE PAPA      TPAP,3
     C                     MOVE GRAA      TGRA,3
     C                     MOVE REFA      ADPA,3
     C                     MOVE GRELA     ADGR,3
     C                     Z-ADDIMPA      TIM,3
     C                     MOVE RIMA1     TRE,3
D5  C           LAIA      IFNE 0
     C                     Z-ADDLAIA      LAIZE
     C                     MOVE 'B'       COP,3
F5  C                     END
     C                     MOVE NATA      NAT,3
     C                     Z-ADDLA        FOL,3
     C                     Z-ADDHA        FOH,3
     C                     Z-ADDLA        FORLST
     C                     Z-ADDHA        FORHST
D5  C           MASSI     IFNE *BLANKS
     C                     MOVE LA        ZB84
     C           HA        DIV  2         ZB851   40
     C                     MOVE ZB851     ZB85
X5  C                     ELSE
D6  C           FMASAL    IFNE *ZEROS
     C                     Z-ADDFMASAL    FORLST
     C                     Z-ADDFMASAH    FORHST
     C                     MOVE LA        ZB84
     C                     MOVE HA        ZB85
X6  C                     ELSE
     C                     MOVEL' 0000'   ZB84
     C                     MOVEL' 0000'   ZB85
F6  C                     END
F5  C                     END
D5  C           CLIA      IFNE ' 00000'
     C                     MOVE CLIA      REFEX
F5  C                     END
D5  C*          CLIAR     IFNE ' 00000'
     C*                    MOVE CLIAR     REREP
D5  C           CLIA      IFNE ' 00000'
     C                     MOVE CLIA      REREP
F5  C                     END
D5  C           USGF1     IFNE 0
     C                     Z-ADDUSGF1     UFA1
F5  C                     END
D5  C           USGF2     IFNE 0
     C                     Z-ADDUSGF2     UFA1
F5  C                     END
D5  C           USMAS     IFNE 0
     C                     Z-ADDUSMAS     UFA1
F5  C                     END
F4  C                     END
    C                     GOTO SUIST3
F3  C                     END
    C           *IN81     CABEQ'1'       SUITE
     C           KPREI1    CHAINPRODST2              81
     C                     Z-ADDUFA1      UFA,1
     C                     Z-ADDUFA2      UFA,2
     C                     Z-ADDUFA3      UFA,3
     C                     Z-ADDUFA4      UFA,4
     C                     Z-ADDUFA5      UFA,5
     C                     Z-ADDUFA6      UFA,6
     C                     Z-ADDUFA7      UFA,7
     C                     Z-ADDUFA8      UFA,8
     C                     Z-ADDUFA9      UFA,9
     C                     MOVE RETS1     X020
     C           SUIST3    TAG
     C                     SETOF                     55
D3  C           1         DO   9         I
D4  C           UFA,I     IFNE 0
     C                     Z-ADDUFA,I     USFAC
     C                     SETON                     55
F4  C                     END
F3  C  N55                END
     C                     Z-ADD0         ZB841   40
     C                     Z-ADD0         ZB851
     C                     MOVE ' '       ZBX     1
D3  C           ZB84      IFNE '0000'
     C                     MOVE ZB84      ZB841
     C                     MOVE 'X'       ZBX
F3  C                     END
D3  C           ZB85      IFNE '0000'
     C                     MOVE ZB85      ZB851
F3  C                     END
X2  C                     ELSE
     C           KPREI1    CHAINPREIMPL              81
    C           *IN81     CABEQ'1'       SUITE
F2  C                     END
     *
D2  C           WTE       IFEQ 0
     C                     MOVE TIMPS     TITIMP  20
     C                     MOVELTREPS     TITIMP
     C                     Z-ADD3         SU      10
     *
X2  C                     ELSE
D3  C           SUPOR     IFEQ 'E'
D4  C           1         DO   3         I
     C           TIM,I     COMP 0                    50
    C           TIM,I     CABEQ5         SUITE
    C           TIM,I     CABEQ3         SUITE
F4  C  N50                END
     C                     MOVE TIM,I     TITIMP  20
     C                     MOVELTRE,I     TITIMP
     C                     Z-ADDI         SU      10
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
D4  C           4         DO   7         I
     C           TIM,I     COMP 0                    50
    C           TIM,I     CABEQ5         SUITE
    C           TIM,I     CABEQ3         SUITE
F4  C  N50                END
     C                     MOVE TIM,I     TITIMP  20
     C                     MOVELTRE,I     TITIMP
     C                     Z-ADDI         SU
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD1         I
     C           TITIMP    LOKUPTI,I                     50
D2  C           *IN50     IFEQ '1'
     C                     MOVELLIM,I     V001
F2  C                     END
D2  C           WDEPR2    IFNE *BLANKS
     C                     MOVELCON,19    V001
F2  C                     END
     *
     *  ---> DATE D'EDITION DU DOCUMENT
     *  -------------------------------
     *
     *       YEAR,MONTH,DAY
     *
     *  ---> USINE IMPRESSION ,USINE FACONNAGE
     *  --------------------------------------
     *
     C                     MOVE *BLANKS   V003   12
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USIN'    PXARGU
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE WSEXT     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V003
     C                     Z-ADDWSEXT     USIMP   10
F3  C                     END
F2  C                     END
     *
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE WSINT     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V003
     C                     Z-ADDWSINT     USIMP
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD0         WUSFAB
     *
D2  C           USDEST    IFEQ 5
    C           WOCLI     ANDEQ8928
X2  C                     ELSE
     C                     MOVE USDEST    USFAC
F2  C                     END
D2  C           USFAC     IFEQ 0
    C           STE       ANDNE0
     C                     Z-ADDUSIMP     USFAC   10
F2  C                     END
     C                     MOVE USFAC     PXVALE
     C           KPARAM    CHAINPARAME               90
D2  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0031   2
     C                     MOVE V0031     V003
F2  C                     END
     *
     *
     *  ---> NOM DU CLIENT OU "PRE-IMPRIME STOCKE"
     *  ------------------------------------------
     *
     C                     MOVE *BLANKS   V004   40
     C                     MOVE *BLANKS   X002   15
D2  C           WTE       IFEQ 0
     C                     MOVELCON,1     V004
     C                     MOVELCON,1     X002
X2  C                     ELSE
     C           KCLIL1    CHAINCLIENTS1             71
    C           *IN71     CABEQ'1'       SUITE
     C                     MOVE NOMCLI    V004
     C                     MOVELNOMCLI    X002
F2  C                     END
     *
     *  ---> NUMERO DU CLIENT
     *  ---------------------
     *
     C                     MOVE WOCLI     V005    40
     *
     *  ---> NUMERO DU PRODUIT
     *  ----------------------
     *
     C                     MOVE WOPRO     V006    40
     *
     *  ---> CONFIRMATION + SEQUENCE
     *  ----------------------------
     *
     C                     MOVELWCONF     V0071   50
     C                     MOVE WEQFAB    V0072   20
     *
     *  ---> DATE DERNIERE FABRICATION
     *  ------------------------------
     *
     C                     MOVE *ZEROS    V008
     C                     Z-ADDWOPRO     NPRO
     C                     SETOF                     82
     C           KHIS05    SETLLHISTOF15
     C           KHIS15    READEHISTOF15                 81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D3  C           *IN81     DOWEQ'0'
     C           KHIS15    READEHISTOF15                 81
D4  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDNEXOSEQ1
     C                     SETON                     8182
F4  C                     END
F3  C  N81                END
     C   82                READPHISTOF15                 81
     C                     Z-ADDAFAB      V0083
     C                     Z-ADDMFAB      V0082
     C                     Z-ADDJFAB      V0081
     *
X2  C                     ELSE
D3  C           STE       IFNE 0
     C                     Z-ADDANPRO     NPRO
     C           KHIS05    SETLLHISTOF15
     C           KHIS15    READEHISTOF15                 81
D4  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1
     C                     Z-ADDXOSEQ     XOSEQ1
D5  C           *IN81     DOWEQ'0'
     C           KHIS15    READEHISTOF15                 81
D6  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDNEXOSEQ1
     C                     SETON                     8182
F6  C                     END
F5  C  N81                END
     C   82                READPHISTOF15                 81
     C                     Z-ADDAFAB      V0083
     C                     Z-ADDMFAB      V0082
     C                     Z-ADDJFAB      V0081
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> DATE MISE A DISPOSITION
     *  ----------------------------
     *
     C                     MOVE *ZEROS    V009
     C           KPRLA8    CHAINPRLANCL8             81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDLANSS     YEARS   20
     C                     Z-ADDLANAA     YEAR    20
     C                     Z-ADDLANJOU    CALNOJ
     C           KCAL07    CHAINCALENJL7             81
     C                     Z-ADDCALAA     V0093
     C                     Z-ADDCALMM     V0092
     C                     Z-ADDCALJJ     V0091
F2  C                     END
     *
     *  ---> ANCIEN NUMERO DE PRODUIT
     *  -----------------------------
     *
     C                     MOVE *ZEROS    V010    40
D2  C           WTE       IFNE 0
     C  N79                MOVE ANPRO     V010
F2  C                     END
     *
     *  ---> CAUSE CHANGEMENT DE PRODUIT
     *  --------------------------------
     *
     C                     MOVE *BLANKS   V011   40
     C                     MOVEL'CAUSE '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V011
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
F2  C                     END
     *
     *  ---> DESIGNATION PRODUIT
     *  ------------------------
     *
     C                     MOVE *BLANKS   V012   40
     C                     MOVE *BLANKS   V013   40
     C                     MOVE *BLANKS   V014   40
     C                     MOVE *BLANKS   V015   40
     C                     MOVE *BLANKS   V016   40
     C                     MOVE *BLANKS   V017   40
     C                     MOVE *BLANKS   V018   40
     *
     * SI PRE-IMP
D2  C           WTE       IFEQ 0
     C                     MOVELDPRIMP    V012
     C                     MOVEL'DEFINI'  DEST
     C                     Z-ADD0         CPT
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     DOWEQ'0'
     C                     ADD  1         CPT
D4  C           CPT       IFEQ 1
     C                     MOVE OBSLIB    V013
F4  C                     END
D4  C           CPT       IFEQ 2
     C                     MOVE OBSLIB    V014
F4  C                     END
D4  C           CPT       IFEQ 3
     C                     MOVE OBSLIB    V015
F4  C                     END
D4  C           CPT       IFEQ 4
     C                     MOVE OBSLIB    V016
F4  C                     END
D4  C           CPT       IFEQ 5
     C                     MOVE OBSLIB    V017
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 82
F3  C  N82                END
     *
     *
     * SI PRODUIT
X2  C                     ELSE
     C                     MOVE BLOC1     V012
     C                     MOVE BLOC2     V013
     *
     * CONSTITUTUION DU BLOC3
D3  C           SUPB3     IFEQ ' '
    C           *IN79     ANDEQ'0'
     C                     MOVE ' BL3'    PXARGU
     C                     MOVE BT3       PXVALE
     C           KPARAM    CHAINPARAME               99
D4  C           *IN99     IFEQ '0'
     C                     MOVE PXLIBE    V014
D5  C           NBRFE     IFGT 0
     C                     MOVE ' 999'    PXVALE
     C           KPARAM    CHAINPARAME               98
D6  C           *IN98     IFEQ '0'
     C                     MOVELPXLIBE    V0141
     C                     MOVE NBRFE     V0142
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C                     MOVE BLOC4     V015
     C                     MOVE BLOC5     V016
     C                     MOVE BLOC6     V017
     C                     MOVE BLOC7     V018
F2  C                     END
     *
     *  ---> MATERIEL IMPRESSION, MATERIEL DECOUPAGE
     *  --------------------------------------------
     *
     C                     MOVE *BLANKS   V020   12
     C                     MOVE *BLANKS   W1032  12
     C                     MOVE *BLANKS   V021   12
     C           KPLAM2    SETLLPLAMAL1
     C           KPLAM1    READEPLAMAL1                  82
D2  C           *IN82     IFEQ '0'
     C                     Z-ADD1         I       30
     C                     Z-ADD1         J       30
D3  C           SUPOR     IFEQ 'E'
D4  C           TIM01     IFNE ' '
     C           ETAT01    LOKUPETA,I                    55
     C   55                MOVELLET,I     V020
     C   55                Z-ADDDDEF01    DV020   60
F4  C                     END
D4  C           TITIMP    IFNE 41
D5  C           TIM02     IFNE ' '
     C           ETAT02    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF02    DV020
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD1         J
D5  C           TIM02     IFNE ' '
     C           ETAT02    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     W1032
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
D4  C           TIM03     IFNE ' '
     C           ETAT03    LOKUPETA,I                    55
     C   55                MOVELLET,I     V020
     C   55                Z-ADDDDEF03    DV020
F4  C                     END
D4  C           TITIMP    IFNE 41
D5  C           TIM04     IFNE ' '
     C           ETAT04    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF04    DV020
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD1         J
D5  C           TIM04     IFNE ' '
     C           ETAT04    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     W1032
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           WTE       IFNE 0
D4  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     Z-ADD1         J
     C           ETAFOR    LOKUPETA,J                    55
     C   55                MOVELLET,J     V021
F4  C                     END
F3  C                     END
     *
X2  C                     ELSE
     *
     C                     MOVELLET,5     V020
D3  C           SUPOR     IFEQ 'E'
    C           REREP     ANDNE*BLANKS
     C                     MOVELLET,5     W1032
F3  C                     END
D3  C           SUPOR     IFEQ 'I'
    C           RIREP     ANDNE*BLANKS
    C           RIREP     ANDEQ'000000'
     C                     MOVELLET,5     W1032
F3  C                     END
D3  C           WTE       IFNE 0
D4  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     MOVELLET,5     V021
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> SUPPORT
     *  ------------
     *
D2  C           WTE       IFNE 0
     C                     MOVE *BLANKS   V022    9
D3  C           SUPOR     IFEQ 'E'
     C                     MOVELCON,2     V022
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
     C                     MOVELCON,3     V022
F3  C                     END
F2  C                     END
     *
     *  ---> CLICHE
     *  ------------
     *
D2  C           WTE       IFNE 0
     C                     MOVE *ZEROS    V023    6
D3  C           SUPOR     IFEQ 'E'
     C                     MOVE REFEX     V023
     C                     MOVELREREP     W103    6
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
     C                     MOVE REFIN     V023
     C                     MOVELRIREP     W103
F3  C                     END
X2  C                     ELSE
     C                     MOVE REFEXS    V023
     C                     MOVELACLEXS    W103
F2  C                     END
D2  C           W103      IFEQ '000000'
     C                     MOVE *BLANKS   W103
F2  C                     END
     *
     *  ---> NUMERO DE FORME
     *  --------------------
     *
     C                     MOVE *ZEROS    V024    50
D2  C           WTE       IFNE 0
     C                     MOVE YOFOR     V024
D3  C           ZB16      IFNE ' '
     C                     MOVE '-'       V0921   1
     C                     MOVE ZB16      V0922   1
F3  C                     END
F2  C                     END
     *
     *  ---> QUALITE
     *  ------------
     *
     C                     MOVE ' '       API     1
D2  C           TRIORI    IFEQ 62,0
     C                     MOVE APIECX    API
X2  C                     ELSE
     C                     MOVE APIICX    API
F2  C                     END
     C                     Z-ADD0         LAIZE
     C                     Z-ADD0         LMINI
     C                     MOVE ' '       HOUB
     C                     MOVE ADPA,WUIMPSOF     3
D2  C           SOF       IFEQ 'CXH'
    C           API       ANDNE'O'
     C           KCXHL3    CHAINRESCXHL3             81
X2  C                     ELSE
     C           KRESPA    CHAINRESPAPL5             81
     C   81      KRESP     CHAINRESPAPL5             81
F2  C                     END
D2  C           *IN81     IFEQ '0'
    C           TITPRI    OREQ 4
    C           HOUB      ANDNE'F'
D3  C           TITPRI    IFEQ 4
    C           HOUB      ANDNE'F'
     C                     MOVE 'B'       HOUB
     C                     MOVE TPAP,WUIMPPAPI
     C                     MOVE TGRA,WUIMPGRAMM
     C                     MOVE ADPA,WUIMPREFOUR
     C                     MOVE ADGR,WUIMPGRAREL
F3  C                     END
     C                     MOVE PAPI      V0251   3
     C                     MOVE GRAMM     V0252   30
     C                     MOVE REFOUR    V0261   6
     C                     MOVE GRAREL    V0262   30
     C                     Z-ADDKGBESO    X011    70
     C                     Z-ADDLAIZE     WLAIZ   41
X2  C                     ELSE
     C                     MOVE *BLANKS   V0251
     C                     MOVE *ZEROS    V0252
     C                     MOVE *BLANKS   V0261
     C                     MOVE *ZEROS    V0262
     C                     MOVE 'ERREUR'  V0261
F2  C                     END
     C                     MOVE *BLANKS   X012    6
     *
     *  ---> DEVELOPPE
     *  --------------
     *
     C                     MOVE *ZEROS    V027    40
     *
D2  C           WTE       IFNE 0
     C                     MOVE YNDH      V027
F2  C                     END
     *
     *  ---> NOMBRE DE POSES
     *  --------------------
     *
     C                     MOVE *ZEROS    V028    31
D2  C           WTE       IFNE 0
     C                     Z-ADDYOSF1     V028
F2  C                     END
     *
     *  ---> LAIZE OU FORMAT
     *  --------------------
     *
     C                     MOVE *ZEROS    V0291   40
     C                     MOVE 'X'       V0292   1
     C                     MOVE *ZEROS    V0293   40
     C                     MOVE *ZEROS    V0294   41
     *
D2  C           V0261     IFNE 'ERREUR'
D3  C           HOUB      IFEQ 'B'
    C           *IN81     ANDEQ'0'
D4  C           TITPRI    IFEQ 4
     C                     SETON                     30
     C                     Z-ADDFORLBM    V0291
     C                     Z-ADDFORHBM    V0293
X4  C                     ELSE
     C                     SETOF                     30
     C                     Z-ADDWLAIZ     V0294
F4  C                     END
F3  C                     END
     *
D3  C           HOUB      IFEQ 'F'
     C                     SETON                     30
     C                     Z-ADDHORL      V0291
     C                     Z-ADDHORH      V0293
F3  C                     END
F2  C                     END
     *
     *  ---> DEVELOPPE MINI
     *  -------------------
     *
     C                     MOVE *ZEROS    V030    40
D2  C           WTE       IFNE 0
    C           TITPRI    ANDEQ1
    C           WTE       ORNE 0
    C           TITPRI    ANDEQ2
D3  C           COP,SU    IFEQ 'R'
    C           COP,SU    OREQ 'V'
     C                     Z-ADDDEVMIN    V030
F3  C                     END
F2  C                     END
     *
     *  ---> LAIZE OU FORMAT MINI
     *  -------------------------
     *
D2  C           BMINI     IFEQ 0
    C           LAIZE     ANDNE0
     C                     Z-ADDLAIZE     BMINI
F2  C                     END
     C                     Z-ADDBMINI     LMU     41
     C                     Z-ADD1         RAP
     C                     MOVE *ZEROS    V0311   40
     C                     MOVE 'X'       V0312   1
     C                     MOVE *ZEROS    V0313   40
     C                     MOVE *ZEROS    V0314   41
     *
D2  C           V0261     IFNE 'ERREUR'
D3  C           WTE       IFNE 0
D4  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
     C                     SETOF                     31
     C                     Z-ADDLMINI     V0314
D5  C           STD,SU    IFNE BMINI
D6  C           BMINI     IFNE *ZEROS
D7  C           SU        IFNE 4
     C           STD,SU    DIV  BMINI     RAP     54H
X7  C                     ELSE
D8  C           YCOL      IFEQ 5
     C           FORHBM    SUB  5         LMUX    40
     C                     MOVE LMUX      LMU
F8  C                     END
     C           STD,SU    DIV  LMU       RAP       H
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           TITPRI    IFEQ 4
     C                     SETON                     31
     C                     Z-ADDFOL,SU    V0311
     C                     Z-ADDFOH,SU    V0313
     C           FOL,SU    MULT 0,001     WFOL    43
     C           FOH,SU    MULT 0,001     WFOH    43
    C*          WFOL      MULT WFOH      SBFE
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> OBSERVATION CONTROLE
     *  -------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     Z-ADD0         I
     *
     *
     C                     MOVE 'QUALIT'  EMET
    C*                    MOVE 'FICLAB'  DEST
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          *IN81     DOWEQ'0'
    C*          I         ANDLT4
    C*                    ADD  1         I
    C*                    MOVE OBSLIB    VAR,I
    C*                    MOVE DTCRE     VDT,I
    C*          NATOBS    IFEQ 'T'
    C* NU1                DELETOBSPROF1
    C*                    END
    C*          KOBSP2    READEOBSPROL1                 81
    C* N81                END
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ4         OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'PRODUI'  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ4         OBSCTL
     *
D2  C           WTE       IFNE 0
D3  C           SUPOR     IFEQ 'E'
     C                     MOVE 'QUAEXT  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D4  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
D5  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D6  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X6  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F6  C                     END
F5  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F4  C  N81                END
F3  C                     END
    C           I         CABEQ4         OBSCTL
     *
     *
D3  C           SUPOR     IFEQ 'I'
     C                     MOVE 'QUAINT  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D4  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
D5  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D6  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X6  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F6  C                     END
F5  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F4  C  N81                END
F3  C                     END
    C           I         CABEQ4         OBSCTL
     *
     C                     MOVE 'CONTROLE'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
D4  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D5  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X5  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F5  C                     END
F4  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F3  C  N81                END
F2  C                     END
     *
     C           OBSCTL    TAG
     C                     MOVEAVAR,1     VCTL
     C                     MOVEAVDT,1     VDTL
     *
     *  ---> OBSERVATION POUR INDICE DIFFICULTE
     C                     MOVE *BLANKS   V129    4
     C                     MOVE *BLANKS   V130    4
     C                     MOVE 'INDIMP  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D2  C           *IN81     IFEQ '0'
     C                     MOVELLIBOBI    INDI    2
D3  C           SUPOR     IFEQ 'E'
     C                     MOVELINDI      IND
F3  C                     END
D3  C           SUPOR     IFEQ 'I'
     C                     MOVE INDI      IND
F3  C                     END
     C                     MOVELIND       V129
F2  C                     END
     *
     C                     MOVE 'INDFAB  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D2  C           *IN81     IFEQ '0'
     C                     MOVELLIBOBI    IND     1
     C                     MOVELIND       V130
F2  C                     END
     *
     *  ---> OBSERVATION CONDUCTEUR
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     Z-ADD0         I
     *
     *
     C                     MOVE 'CONDUC'  EMET
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVEAVAR,1     VCON
     C                     MOVEAVDT,1     VDON
     *
     *  ---> OBSERVATION IMPRESSION
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     C                     MOVE *BLANKS   VEM
     C                     Z-ADD0         I
     *
     C           KRESLB    SETLLRESTPSLB                 99
D2  C           *IN99     IFEQ '1'
    C           PUS       ANDEQ2
     C                     ADD  1         I
     C                     MOVELCON,24    VAR,I
F2  C                     END
     *
     C                     MOVE 'PRODUI'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
    C           EMET      ANDNE'QUALIT'
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE EMET      VEM,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
D3  C           EMET      IFNE 'CONDUC'
    C           EMET      ANDNE'QUALIT'
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE EMET      VEM,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F4  C                     END
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C           KCAR12    CHAINCDEOBSL2             81
D2  C           *IN81     IFEQ '0'
    C           I         ANDLT12
    C           TYPOBS    ANDEQ'A'
     C                     ADD  1         I
     C                     MOVE OBSERV    VAR,I
F2  C                     END
     *
     C                     MOVEAVAR,1     VIMPL1
     C                     MOVEAVAR,7     VIMPL2
     C                     MOVEAVDT,1     VIMPD
     C                     MOVEAVEM,1     VIMPE
     *
     C                     MOVE *BLANKS   V059
     C                     MOVE *BLANKS   V058
     C                     MOVE 'CODBAR'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
D3  C           NATOBS    IFEQ 'P'
     C                     MOVELOBSLIB    V059
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C                     END
     *
     *
     *  ---> OBSERVATIONS ATTENTION
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     Z-ADD0         I
     *
     *
     C  N79      KCDESC    CHAINCDESLC               99
     C   79      KCDSC     CHAINCDESLC               99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'NCDE'    PXARGU
     C                     MOVE STOND     PXVALE    P
     C           KPARAM    CHAINPARAME               99
     C  N99                ADD  1         I
     C  N99                MOVELPXLIBE    VAR,I
     C  N99                MOVELPXABRG    V1241
F2  C                     END
     C                     MOVE WTE       V124S
     C                     MOVE WOCLI     V124C
     C                     MOVE WOPRO     V124P
     C                     MOVE WCONF     V124N
     C                     MOVE WEQFAB    V124Q
     *
     *  - GROUPAGE
D2  C           YARNT1    IFEQ 'M'
    C           YARNT3    ANDGT'0'
     C                     ADD  1         I
     C                     MOVELCON,4     VAR,I
F2  C                     END
     *
     *  - GARNITURE
D2  C           YARNT1    IFNE 'M'
    C           YARNT1    ANDNE' '
     C                     ADD  1         I
     C                     MOVELCON,5     YARNT2
     C                     MOVEL'-'       EGAL
     C                     MOVELWCONF     OFCONF
     C                     MOVELWEQFAB    OFSEQ
     C                     MOVELSUPOR     OFSUP
     C                     MOVELYARNT1    OFLETR
     C                     MOVELVARNT     VAR,I
F2  C                     END
     *
     *  - COMMANDE D'ESSAIS
D2  C           YARNT     IFEQ 'MD'
     C                     ADD  1         I
     C                     MOVELCON,6     VAR,I
F2  C                     END
     *
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - COMMANDE D'HOMOLOGATION
D2  C           YARNT     IFEQ 'MH'
     C                     ADD  1         I
     C                     MOVELCON,7     VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *          IMPRESSION EXT. INT.
D2  C           SUPOR     IFEQ 'E'
D3  C           TIM,4     IFEQ *ZEROS
    C           TIM,5     ANDEQ*ZEROS
    C           TIM,6     ANDEQ*ZEROS
    C           TIM,7     ANDEQ*ZEROS
    C           NIMPI1    ANDEQ*BLANKS
     C                     SETOF                     61
X3  C                     ELSE
     C                     SETON                     61
F3  C                     END
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
D3  C           TIM,1     IFEQ *ZEROS
    C           TIM,2     ANDEQ*ZEROS
    C           TIM,3     ANDEQ*ZEROS
    C           NIMPE1    ANDEQ*BLANKS
     C                     SETOF                     61
X3  C                     ELSE
     C                     SETON                     61
F3  C                     END
F2  C                     END
D2  C           *IN61     IFEQ '1'
     C                     ADD  1         I
     C                     MOVELCON,8     VAR,I
F2  C                     END
     *
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           SUPOR     IFEQ 'E'
     C                     MOVE 'IMPEXT'  DEST
F2  C                     END
D2  C           SUPOR     IFEQ 'I'
     C                     MOVE 'IMPINT'  DEST
F2  C                     END
     C                     MOVE 'ST    '  EMET
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELCON,9     VAR,I
D3  C           NATOBS    IFEQ 'T'
     C  NU1                DELETOBSPROF1
F3  C                     END
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'L'
     C                     ADD  1         I
     C                     MOVELCON,10    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'A'
     C                     ADD  1         I
     C                     MOVELCON,11    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'Z'
     C                     ADD  1         I
     C                     MOVELCON,23    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - NATURE D'ENCRE
D2  C           NAT,SU    IFNE ' '
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'ENCR'    PXARGU
     C                     MOVE NAT,SU    PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     ADD  1         I
     C                     MOVEAPXABRG    VAR,I
F3  C                     END
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - IMPRESSION POUR FACONNAGE DE NEUVILLE
D2  C           USDEST    IFEQ 4
    C           USIMP     ANDEQ2
     C                     ADD  1         I
     C                     MOVELCON,18    VAR,I
F2  C                     END
     *  - IMPRESSION POUR FACONNAGE DE CHABANAIS
D2  C           USDEST    IFEQ 5
    C           USIMP     ANDEQ2
     C                     ADD  1         I
     C                     MOVELCON,20    VAR,I
F2  C                     END
     *  - IMPRESSION POUR FACONNAGE DE FEGERSHEIM
D2  C           USDEST    IFEQ 7
    C           USIMP     ANDEQ2
     C                     ADD  1         I
     C                     MOVELCON,22    VAR,I
F2  C                     END
     *
     *  AJOUT NOTION DE 'PRODUIT ASSEMBLE MACULES A CONSERVER'
D2  C           USIMP     IFEQ 2
     C                     ADD  1         I
     C                     MOVELCON,25    VAR,I
F2  C                     END
     *
     *
     C           FINATT    TAG
     C                     MOVELVAR,1     V084   24
     C                     MOVELVAR,2     V085   24
     C                     MOVELVAR,3     V086   24
     C                     MOVELVAR,4     V087   24
     *
     *  ---> QTE DEMANDEE
     *  -----------------
     *
     C  N79                Z-ADDWTIMP     V088    70
     C   79                Z-ADDQTFAB     V088
     *
     *
     *  ---> QTE EN STOCK
     *  -----------------
     *
     C                     Z-ADD*ZEROS    V089    70
     C                     Z-ADD*ZEROS    J
     C           KPRO10    CHAINMVTIMPLF             81
D2  C           *IN81     DOWEQ'0'
D3  C           SUPOR     IFEQ 'E'
    C           SUIMP     ANDGT3
    C                     GOTO SUISTO
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
    C           SUIMP     ANDLT4
    C                     GOTO SUISTO
F3  C                     END
     *
D3  C           WTE       IFEQ 0
D4  C           UNITE     IFEQ 'B'
     C                     ADD  MLBON     V089
X4  C                     ELSE
     C           NBFE      SUB  FEUBOU    Z1      70
     C                     ADD  Z1        V089
F4  C                     END
     *
X3  C                     ELSE
     *
     C                     Z-ADD1         I
     C           PRECDE    LOKUPCDE                      55
D4  C           *IN55     IFEQ '0'
     C                     ADD  1         J
     C                     Z-ADDPRECDE    CDE,J
F4  C                     END
     *
     C                     ADD  PROFIN    V089
F3  C                     END
     C           SUISTO    TAG
     C           KPRO10    READEMVTIMPLF                 81
F2  C  N81                END
     *
     *
     *  ---> QTE EN RELIQUAT
     *  --------------------
     *
     C                     Z-ADD*ZEROS    V090    70
     C                     Z-ADD*ZEROS    I
D2  C           WTE       IFNE 0
    C           V089      ANDGT*ZEROS
    C           WOPRO     ANDLT8000
     *
     C                     Z-ADDV089      V090
D3  C           1         DO   J         I
     C                     Z-ADDCDE,I     PRECDE
     C           KCARC2    CHAINCARCDEL2             81
D4  C           *IN81     DOWEQ'0'
     *
     C           KPRL18    CHAINPRLANCL8             81
D5  C           *IN81     IFEQ '0'
D6  C           OFETA     IFEQ 'TR'
    C           OFETA     OREQ 'EC'
     C                     MOVE '*'       LANCFA
F6  C                     END
F5  C                     END
D5  C           LANCFA    IFEQ ' '
    C           NCONF     ANDNEWCONF
    C           LANCFA    OREQ ' '
    C           NCONF     ANDEQWCONF
    C           SEQFAB    ANDLTWEQFAB
     C                     SUB  QTFAC     V090    70
     C           V090      COMP 0                      82
     C   82                Z-ADD0         V090
F5  C                     END
     C           KCAR22    READECARCDEL2                 81
     C  N81      QTIMP     COMP *ZEROS               81
F4  C  N81                END
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD0         STOCK   90
     C           KPRO10    CHAINLIEUSTL3             99
D2  C           *IN99     DOWEQ'0'
     C                     SETON                     92
D3  C           LILIEU    IFEQ 6
    C           CODEXT    ANDNE'  '
     C                     Z-ADD1         C
     C           CODEXT    LOKUPCXT,C                    92
F3  C                     END
D3  C           LILIEU    IFNE 8
    C           *IN92     ANDEQ'1'
     C                     ADD  STOLIE    STOCK                           PROD17
F3  C                     END
     C           KPRO10    READELIEUSTL3                 99              *PROD17
F2  C        N99          END                                           *PROD17
     C                     ADD  V090      STOCK
     C                     SETOF                     50
     *
     C           KCARZ8    SETLLCARCDEZ8
     C           KCARCU    READECARCDEZ8                 81
D2  C           *IN81     DOWEQ'0'
D3  C           NCONF     IFNE WCONF
     C                     SETON                     8150
F3  C                     END
     C  N81      KCARCU    READECARCDEZ8                 81
F2  C  N81                END
     C           STOCK     COMP 0                      82
     C   82                Z-ADD0         STOCK
D2  C           WOCLI     IFEQ 2267
     C                     Z-ADD0         V090
     C                     Z-ADD0         STOCK
F2  C                     END
     *
     *  ---> QTE A LANCER
     *  -----------------
     *
     C                     Z-ADD*ZEROS    V091    70
     C                     Z-ADD*ZEROS    V0951   70
     C                     MOVE *BLANKS   V0952   2
     C                     Z-ADD*ZEROS    V0961   70
     C                     Z-ADD*ZEROS    RED
     C                     MOVE *BLANKS   V0962   2
     C                     Z-ADDV088      V091
D2  C           *IN50     IFEQ '1'
     C                     Z-ADD0         V090
F2  C                     END
D2  C           *IN50     IFEQ '0'
    C           WEQFAB    ANDEQ01
D3  C           V088      IFGT STOCK
     C           V088      SUB  STOCK     V091
     C                     Z-ADDSTOCK     V090
X3  C                     ELSE
     C                     Z-ADD0         V091
F3  C                     END
F2  C                     END
     C                     Z-ADD*ZEROS    I
     C                     SETOF                     9998
     C           *LIKE     DEFN ROUL      ROUL1
     C           *LIKE     DEFN SURGFA    SURGF1
     C           *LIKE     DEFN REDEC     REDEC1
     C           *LIKE     DEFN MOYDEC    MOYDE1
     C  N99                Z-ADD0         ROUL1
     C  N99                Z-ADD0         SURGF1
     *
     C                     Z-ADD99        R
     C           KPLA15    SETLLPLAIMPL5
     C           KPLAL5    READEPLAIMPL5                 81
D2  C           *IN81     IFEQ '0'
     C                     MOVE PR        WPR
     C           SSECT     COMP '4'                  9898
F2  C                     END
D2  C           *IN81     DOWEQ'0'
D3  C           SSECT     IFNE '3'
    C           SECT      ANDNE'2'
     C                     ADD  1         I
     C  N99                Z-ADDROUL      ROUL1
     C  N99                Z-ADDSURGFA    SURGF1
     C  N99                Z-ADDMOYDEC    MOYDE1
     C                     Z-ADDREDEC     RED,I
     C                     SETON                     99
F3  C                     END
     C           KPLAL5    READEPLAIMPL5                 81
     C  N81      PR        COMP WPR                  8181
F2  C  N81                END
D2  C           WEQFAB    IFNE 01
    C           PR        ANDEQ'R'
     C                     MOVE 'R'       WPR     1
X2  C                     ELSE
D3  C           SECT      IFNE '6'
    C           SSECT     ANDNE'6'
     C                     MOVE PR        WPR
F3  C                     END
F2  C                     END
     C                     Z-ADDROUL1     ROUL
     C                     Z-ADDSURGF1    SURGFA
     C                     Z-ADDMOYDE1    MOYDEC
     C                     XFOOTRED       REDEC1
     C                     SUB  RED,1     REDEC1
     C                     Z-ADDRED,1     REDEC
D2  C           *IN98     IFEQ '1'
     C           REDEC1    MULT 0,01      W1
     C           W1        MULT BMINI     REDEC1    H
     C           REDEC     MULT 0,01      W1
     C           W1        MULT BMINI     REDEC     H
X2  C                     ELSE
     C           REDEC1    MULT SBFE      REDEC1    H
     C           REDEC     MULT SBFE      REDEC     H
F2  C                     END
     *
     *
     *  ---> QTE A REALISER MINI ET MAXI
     *  --------------------------------
     *
D2  C           *INU1     IFEQ '0'
     C           KCDES1    CHAINCDESL1               82
F2  C                     END
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           WTOT      MULT 0,01      SURFF     H
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           WTOT      MULT 0,001     SURFF     H
F2  C                     END
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDWTOT      SURFF     H
F2  C                     END
     *
     C           SURFF     MULT SUVENT    SURFF
     *
D2  C           SURFF     IFEQ 0
     C                     Z-ADD1         SURFF
F2  C                     END
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           V091      MULT 0,01      W4     103
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           V091      MULT 0,001     W4
F2  C                     END
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDV091      W4
F2  C                     END
     *
     C           W4        MULT SUVENT    SUFNET 100H
     *
     *
     C           SUFNET    MULT DECFAZ    SUROUL 100H
D2  C           BTFAB     IFNE *ZEROS
     C           BTTOT     DIV  BTFAB     NBF     31H
X2  C                     ELSE
     C                     Z-ADD1         NBF
F2  C                     END
     C           BTTOT     SUB  BTPRE     QTR    100
D2  C           BTREN     IFNE *ZEROS
     C           QTR       DIV  BTREN     NBI     31H
X2  C                     ELSE
     C                     Z-ADD1         NBI
F2  C                     END
D2  C           BTPRE     IFNE *ZEROS
    C           BTREN     ANDNE*ZEROS
     C                     ADD  1         NBI
F2  C                     END
     C           NBF       DIV  NBI       NB      31H
     C           BUREG     MULT NB        SUREGF  60
     *
     C                     Z-ADDSUFNET    SUFTH  100
     C                     ADD  SUROUL    SUFTH
     *
D2  C           SUFNET    IFNE *ZEROS
     C                     ADD  SUREGF    SUFTH
F2  C                     END
     *
D2  C           SBFE      IFEQ *ZEROS
     C                     Z-ADD1         SF
X2  C                     ELSE
     C                     Z-ADDSBFE      SF
F2  C                     END
     *
     *
     C                     Z-ADD*ZERO     MIN
     C                     Z-ADD*ZERO     MAX
D2  C           SUFTH     IFNE *ZEROS
     C                     Z-ADDSUFTH     SURF
     C                     Z-ADDWCONF     WCONF1
     C                     Z-ADDWOPRO     WOPRO1
     C                     Z-ADDWOCLI     WOCLI1
     C                     CALL 'CDEC92£'
     C                     PARM           DSPARA
F2  C                     END
     C                     Z-ADDMIN       SFMIN   80
     C                     Z-ADDMAX       SFMAX   80
     C           MAX       ADD  MIN       SFAPRO 100
     C           SFAPRO    DIV  2         SFAPRO
    C*          *IN79     IFEQ '1'
    C*                    Z-ADDSUFTH     SFAPRO
    C*                    Z-ADDSUFTH     SFMIN
    C*                    Z-ADDSUFTH     SFMAX
    C*                    END
     *
D2  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
    C           TITPRI    OREQ 1
    C           TITREP    ANDEQ4
    C           TITPRI    OREQ 2
    C           TITREP    ANDEQ4
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 4
D4  C           LMU       IFNE *ZEROS
     C           LMU       MULT 0,01      WMINI   43
X4  C                     ELSE
     C           BMINI     MULT 0,01      WMINI
F4  C                     END
D4  C           WMINI     IFNE 0
     C           SFMIN     DIV  WMINI     V0951     H
     C           SFMAX     DIV  WMINI     V0961     H
F4  C                     END
     C                     MOVE 'ML'      V0952
     C                     MOVE 'ML'      V0962
F3  C                     END
F2  C                     END
     *
D2  C           TITREP    IFEQ 0
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
     *
D4  C           BMINI     IFEQ 0
D5  C           FOL,SUIMP IFEQ 0
D6  C           ONDL      IFEQ 0
     C                     MOVE DECL      BMINI
X6  C                     ELSE
     C                     MOVE ONDL      BMINI
F6  C                     END
X5  C                     ELSE
     C                     MOVE FOL,SUIMP BMINI
F5  C                     END
F4  C                     END
     *
D4  C           LMU       IFNE *ZEROS
     C           LMU       MULT 0,01      WMINI
X4  C                     ELSE
     C           BMINI     MULT 0,01      WMINI
F4  C                     END
     C           SFMIN     DIV  WMINI     V0951     H
     C           SFMAX     DIV  WMINI     V0961     H
     C                     MOVE 'ML'      V0952
     C                     MOVE 'ML'      V0962
D4  C           SUIMP     IFGT 3
    C           FAIME     ANDEQ14
    C           SUIMP     ORLT 4
    C           FAIMI     ANDEQ14
     C           V0951     MULT 1,2       V0951
     C           V0961     MULT 1,2       V0961
F4  C                     END
F3  C                     END
F2  C                     END
     *
D2  C           TITPRI    IFEQ 4
D3  C           TITREP    IFNE 1
    C           TITREP    ANDNE2
     C           SFMIN     DIV  SBFE      V0951     H
     C           SFMAX     DIV  SBFE      V0961     H
     C                     MOVE 'FE'      V0952
     C                     MOVE 'FE'      V0962
F3  C                     END
F2  C                     END
     *
     C                     Z-ADDSUFTH     WUFTH  100
     *
     *
     *  ---> QTE A APPROVISIONNER
     *  -------------------------
     *
     C                     Z-ADD*ZEROS    V0941   70
     C                     MOVE *BLANKS   V0942   2
D2  C           SUPOR     IFEQ 'E'
     C           SUFNET    MULT EXDEC     ROUEXT  70H
     C                     Z-ADDSFAPRO    SUFTH
D3  C           SFAPRO    IFNE *ZEROS
     C                     ADD  ROUEXT    SUFTH
     C                     ADD  RIMPE     SUFTH
F3  C                     END
F2  C                     END
     *
D2  C           SUPOR     IFEQ 'I'
     C           SUFNET    MULT INDEC     ROUINT  70H
     C                     Z-ADDSFAPRO    SUFTH
D3  C           SFAPRO    IFNE *ZEROS
     C                     ADD  ROUINT    SUFTH
     C                     ADD  RIMPI     SUFTH
F3  C                     END
F2  C                     END
     *
D2  C           RAP       IFNE 0
     C                     MULT RAP       SUFTH
F2  C                     END
     *
D2  C           SOF       IFEQ 'CXH'
     C           SUFTH     MULT GRAMM     W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
     C                     MOVE 'KG'      V0942
F2  C                     END
     *
     *
D2  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 4
     *
     C                     MOVE HOUB      FOUB
     C           KUSIL1    CHAINQUAUSI               81
D4  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
X4  C                     ELSE
D5  C           FOUB      IFEQ 'F'
     C                     MOVE 'B'       FOUB
     *
     C           KUSIL1    CHAINQUAUSI               81
D6  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
F6  C                     END
F5  C                     END
F4  C                     END
     C                     MOVE 'KG'      V0942
F3  C                     END
F2  C                     END
     *
D2  C           TITREP    IFEQ 0
    C           TITREP    OREQ 4
D3  C           TITPRI    IFEQ 1
    C           TITPRI    OREQ 2
     *
     C                     MOVE HOUB      FOUB
     C           KUSIL1    CHAINQUAUSI               81
D4  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
X4  C                     ELSE
D5  C           FOUB      IFEQ 'F'
     C                     MOVE 'B'       FOUB
     *
     C           KUSIL1    CHAINQUAUSI               81
D6  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1
     C           W1        DIV  1000      V0941     H
     C           V0941     DIV  0,97      V0941     H
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           SU        IFLT 4
    C           FAIMI     ANDEQ14
    C           SU        ORGT 3
    C           FAIME     ANDEQ14
     C           V0941     MULT 1,2       V0941
F4  C                     END
     C                     MOVE 'KG'      V0942
F3  C                     END
F2  C                     END
     *
D2  C           TITPRI    IFEQ 4
D3  C           TITREP    IFNE 1
    C           TITREP    ANDNE2
     C           SUFTH     DIV  SBFE      V0941     H
     C           V0941     DIV  0,99      V0941     H
     C                     MOVE 'FE'      V0942
F3  C                     END
F2  C                     END
     *
    C*          V0942     IFEQ 'KG'
    C*          WLAIZ     DIV  BMINI     W3      54H
    C*          V0941     MULT W3        V0941     H
    C*                    END
     *
D2  C           SU        IFEQ 4
     C           V0941     MULT TAL,4     V0941     H
F2  C                     END
     *
D2  C           PUS       IFEQ 5
D3  C           YOSF1     IFEQ 0
     C                     Z-ADD1         YOSF1
F3  C                     END
     C           WTIMP     DIV  YOSF1     W1        H
D3  C           YACON     IFGT 5
     C           W1        MULT 1,07      V0941     H
X3  C                     ELSE
     C           W1        MULT 1,05      V0941     H
F3  C                     END
D3  C           CENT2     IFNE 0
     C                     ADD  1         CENT1
     C                     Z-ADD0         CENT2
F3  C                     END
     C                     MOVE 'FE'      V0942
F2  C                     END
     *
     *
     *  ---> INFORMATIONS DES PASSAGES
     *  ------------------------------
     *
     C                     MOVE *BLANKS   V097   73
     C                     MOVE *BLANKS   S097P   1
     C                     MOVE *ZEROS    V0973
     C                     MOVE *ZEROS    V0974
     C                     MOVE *ZEROS    V0976
     C                     MOVE *ZEROS    V0977
     C                     MOVE *ZEROS    V0978
     C                     MOVE *ZEROS    V0979
     C                     MOVE *ZEROS    V097A
     C                     MOVE *ZEROS    V097B
     C                     MOVE *ZEROS    V097R
     C                     MOVE *ZEROS    V097I
     C                     MOVE V097      V098   73
     C                     MOVE V097      SUP,1
     C                     MOVE V097      SUP,2
     C                     MOVE V097      SUP,3
     C                     MOVE V097      SUP,4
     C                     MOVE V097      SUP,5
     C                     MOVE V097      SUP,6
     C                     MOVE V097      SUP,7
     C                     Z-ADD0         I
     C           *LIKE     DEFN REDEC     DEBREG
     C                     Z-ADD0         DEBREP
     C                     Z-ADD0         DEBREG
     C                     Z-ADD0         DEBROU  63
     C                     Z-ADD99        R
    C*                    MOVE ' '       WPR
     C                     SETOF                     2206
     *
     C           KPLA15    SETLLPLAIMPL5
     C           KPLAL5    READEPLAIMPL5                 81
     C                     MOVE ' '       PASA    1
     C                     Z-ADD0         RSAV    20
     *
D2  C           *IN81     DOWEQ'0'
D3  C           SECT      IFNE '6'
    C           PR        CABNEWPR       SUITPI
X3  C                     ELSE
D4  C           *IN06     IFEQ '0'
     C                     SETON                     06
X4  C                     ELSE
    C           PR        CABNEWPR       SUITPI
F4  C                     END
F3  C                     END
D3  C           SSECT     IFEQ '3'
D4  C           PRIORI    IFNE 62,0
    C           PRIORI    ANDNE31,0
    C                     GOTO SUITPI
X4  C                     ELSE
     C                     SETON                     41
     C                     MOVE '*'       PASA    1
F4  C                     END
F3  C                     END
    C           SECT      CABEQ'2'       SUITPI
D3  C           SSECT     IFEQ '5'
     C                     Z-ADDPAS       RANG    10
     C                     SETON                     42
    C                     GOTO SUITPI
F3  C                     END
     C                     ADD  1         I
     *
     C                     Z-ADDWTE       STEP
     C                     Z-ADDWOCLI     NOCLIP
     C                     Z-ADDWOPRO     NOPROP
     C                     Z-ADDPUS       USP
     C                     MOVE '00'      TMA
     C                     MOVE SSECT     WWECT   10
     *
D3  C           WWECT     IFEQ TITREP
D4  C           DEBREP    IFEQ 0
     C                     Z-ADDI         DEBREP  10
     C                     Z-ADDREDEC     DEBREG
     C           100       SUB  MOYDEC    W1
     C           W1        DIV  100       DEBROU
F4  C                     END
D4  C           SUPOR     IFEQ 'E'
     C                     MOVE '2'       INN
X4  C                     ELSE
     C                     MOVE '4'       INN
F4  C                     END
F3  C                     END
     *
D3  C           WWECT     IFEQ TITPRI
D4  C           SUPOR     IFEQ 'E'
     C                     MOVE '1'       INN
X4  C                     ELSE
     C                     MOVE '3'       INN
F4  C                     END
F3  C                     END
     *
D3  C           SSECT     IFEQ '1'
     C                     MOVELLIM,1     V0971
F3  C                     END
     *
D3  C           SSECT     IFEQ '2'
     C                     MOVELLIM,2     V0971
F3  C                     END
     *
D3  C           SSECT     IFEQ '3'
     C                     MOVELLIM,13    V0971
F3  C                     END
     *
D3  C           SSECT     IFEQ '4'
     C                     MOVELLIM,3     V0971
F3  C                     END
     *
D3  C           SSECT     IFEQ '6'
     C                     MOVELLIM,16    V0971
F3  C                     END
     *
D3  C           SSECT     IFEQ '7'
D4  C           VERNIS    IFEQ 'O'
     C                     MOVELLIM,14    V0971
F4  C                     END
D4  C           VERNIS    IFEQ 'P'
     C                     MOVELLIM,15    V0971
F4  C                     END
     C                     MOVE ' '       VERNIS
F3  C                     END
     *
D3  C           WTE       IFNE 0
D4  C           SUPOR     IFEQ 'E'
    C           WSEXT     ANDNEUSFAB
    C           *IN79     ANDNE'1'
     C                     CALL 'POOL02£'
     C                     PARM           DSPROG
     C                     MOVE TMA,PAS   NOMAC
F4  C                     END
D4  C           SUPOR     IFEQ 'I'
    C           WSINT     ANDNEUSFAB
    C           *IN79     ANDNE'1'
     C                     CALL 'POOL02£'
     C                     PARM           DSPROG
     C                     MOVE TMA,PAS   NOMAC
F4  C                     END
X3  C                     ELSE
D4  C           WSEXT     IFNE USINEP
    C           *IN79     ANDNE'1'
     C                     CALL 'POOL02£'
     C                     PARM           DSPROG
     C                     MOVE TMA,PAS   NOMAC
F4  C                     END
F3  C                     END
     C                     MOVE NOMAC     V0972
     *
     C                     Z-ADDPAS       V0973
     *
     C                     Z-ADDR         V097R
     *
     C                     Z-ADDCOULX     V0974
     *
     C                     MOVE VERNIS    V0975
     *
     C  N04N02             Z-ADDRETPS     V0977
     C  N04N02             Z-ADDROEFF     V0979
     C  N04N02             Z-ADDNETPS     V097B
     C                     Z-ADD0         W1
D3  C           SECT      IFNE '6'
D4  C           V0951     IFNE QTENET
     C           V0951     DIV  QTENET    W5      85
     C           TPSTOT    MULT W5        W1
     C  N04N02             Z-ADDW1        V0978
X4  C                     ELSE
     C  N04N02             Z-ADDTPSTOT    V0978
F4  C                     END
D4  C           V0978     IFNE *ZEROS
     C  N04N02   V0951     DIV  V0978     V097A     H
     C                     MOVE SECT      SECTD
     C                     MOVE SSECT     SSECTD
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'KCAD'    PXARGU
     C                     MOVE DSSSSM    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    PLAFON  50
     C  N04N02             MULT PXMONT    V097A
D6  C           V097A     IFGT PLAFON
     C  N04N02             Z-ADDPLAFON    V097A
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C  N04N02             Z-ADDTPSTOT    V0978
F3  C                     END
     *
     C  N02                Z-ADDREDEC     V0976
     *
     C                     MOVE WSECT     V097S
     *
D3  C           WSECT     IFEQ '14'
D4  C           UV1       IFEQ 'O'
D5  C           S097P     IFEQ ' '
     C                     MOVE 'R'       V097P
     C                     Z-ADD1         V097I
X5  C                     ELSE
D6  C           R         IFNE RSAV
     C                     MOVE 'P'       V097P
     C                     Z-ADD1         V097I
X6  C                     ELSE
     C                     MOVE S097P     V097P
     C           S097I     ADD  1         V097I
F6  C                     END
F5  C                     END
X4  C                     ELSE
D5  C           S097P     IFEQ ' '
     C                     MOVE 'P'       V097P
     C                     Z-ADD1         V097I
X5  C                     ELSE
D6  C           R         IFNE RSAV
     C                     MOVE 'R'       V097P
     C                     Z-ADD1         V097I
X6  C                     ELSE
     C                     MOVE S097P     V097P
     C           S097I     ADD  1         V097I
F6  C                     END
F5  C                     END
F4  C                     END
     C                     Z-ADDR         RSAV    20
     C                     MOVE V097P     S097P   1
     C                     MOVE V097I     S097I   10
F3  C                     END
     *
     *
     C                     MOVE V097      SUP,I
D3  C           *IN22     IFEQ '0'
     C                     MOVE SECT      CECT
     C                     MOVE SSECT     CSECT
     C                     MOVE NOMAC     COMAC
     C                     SETON                     22
F3  C                     END
     *
     C           SUITPI    TAG
     C           KPLAL5    READEPLAIMPL5                 81
     C                     MOVE V098      V097
F2  C  N81                END
     *
     C                     MOVE SUP,1     V097
     C                     MOVE SUP,2     V098
     C                     MOVE SUP,3     V099   73
     C                     MOVE SUP,4     V100   73
     C                     MOVE SUP,5     V101   73
     C                     MOVE SUP,6     V201   73
     C                     MOVE SUP,7     V202   73
     *
     *
     *  ---> CODES A BARRE
     *  ------------------
     *
     C                     MOVE *BLANKS   W104
     C                     MOVE *ZEROS    W1042
     C                     MOVE *BLANKS   BAR
     C                     Z-ADD0         I
     C           KBARL1    CHAINCODBARL2             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT8
     C                     ADD  1         I
     C                     MOVELREFPRO    W104
D3  C           POSCO     IFLT 9
     C                     Z-ADDPOSCO     W1041
X3  C                     ELSE
     C                     MOVE POSCO     W1042
F3  C                     END
     C                     MOVE W104      BAR,I
     C           KBARL1    READECODBARL2                 81
     C                     MOVE *BLANKS   W104
     C                     MOVE *ZEROS    W1042
F2  C  N81                END
     *
     *  ---> QTES EN UNITE DE VENTE
     *  ---------------------------
     *
     *
     C                     Z-ADDBTTOT     V112    80
     C                     Z-ADDBTPRE     V113    70
     C                     Z-ADDBTREN     V114    70
     *
     C           SUIT      TAG
     *
     *  ---> CADENCEMENT POUR BON DE COMMANDE
     *  -------------------------------------
     *
     *
     C                     MOVE *ZEROS    CAD
     C                     MOVE '  '      CAD,1
     C                     MOVE '  '      CAD,2
     C                     MOVE '  '      CAD,3
     C                     MOVE '  '      CAD,4
     C                     MOVE '  '      CAD,5
     C                     MOVE '  '      CAD,6
     C                     MOVE '  '      CAD,7
     C                     MOVE '  '      CAD,8
     C                     MOVE '  '      CAD,9
     C                     MOVE '  '      CAD,10
     C                     MOVE '  '      CAD,11
D2  C           *INU1     IFEQ '1'
     C                     Z-ADD0         I
     C           KCARCD    CHAINCARCDEL2             81
     C           KCAR12    READECARCDEL2                 81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT11                          ***MODIF NZS
D4  C           QTIMP     IFNE *ZEROS
    C           DTDEL     ANDNE*ZEROS
     C                     ADD  1         I
     C                     MOVE SEQFAB    V1151
     C                     Z-ADDQTIMP     V1152
     C                     Z-ADDDTDEL     V1153
     C                     MOVE CODEL     V1154
     C                     MOVE V115      CAD,I
F4  C                     END
     C           KCAR12    READECARCDEL2                 81
F3  C  N81                END
     C                     MOVE CAD,1     V115
     C                     MOVE CAD,2     V116
     C                     MOVE CAD,3     V117
     C                     MOVE CAD,4     V118
     C                     MOVE CAD,5     V119
     C                     MOVE CAD,6     V120
     C                     MOVE CAD,7     V121
F2  C                     END
     *
     *
     *  ---> PRELEVEMENT SED
     *  --------------------
     *
     C                     MOVE *BLANKS   V126    4
    C*                    Z-ADD1         I
    C*          V020      LOKUPLET,I                    55
    C*          *IN55     IFEQ '1'
     *
     *
    C*          I         IFEQ 1
    C*          TYPPRP    ANDNE' '
    C*                    MOVE ' 25 '    V126
    C*                    END
     *
    C*          I         IFEQ 1
    C*          TYPPRP    ANDEQ' '
    C*                    MOVE ' 15 '    V126
    C*                    END
     *
    C*          I         IFEQ 2
    C*                    MOVE '  5 '    V126
    C*                    END
     *
    C*          I         IFEQ 3
    C*                    Z-ADDDATFAB    DDEF
    C*          KCAL01    CHAINCALEND               85
    C*                    Z-ADDCALNOJ    CALNO1  30
    C*                    Z-ADDDV020     DDEF
    C*          KCAL01    CHAINCALEND               85
    C*                    Z-ADDCALNOJ    CALNO2  30
    C*          CALNO1    SUB  CALNO2    W1
    C*                    SETOF                     505152
    C*          W1        COMP 60                   505151
    C*  50      W1        COMP 180                    5252
     *
    C*          *IN51     IFEQ '1'
    C*                    MOVE '  5 '    V126
    C*                    END
    C*          *IN52     IFEQ '1'
    C*                    MOVE ' 10 '    V126
    C*                    END
     *
    C*                    END
     *
    C*                    END
     *
     C   U1      USFAC     COMP 7                        07
     C   U1N07   USFAC     COMP 3                    040203
    C*                    MOVE *BLANKS   V059
    C*                    MOVELCDEPRO    V059
     * REF ISO RECHERCHE DANS LA TABLE (TISO)
     * --------------------------------------
     C                     MOVE *BLANKS   V128   20
     *
D2  C           *INU1     IFEQ '1'
     C                     MOVEL'COMMAND 'PXVA
X2  C                     ELSE
     C                     MOVEL'BONIMP  'PXVA
F2  C                     END
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TISO'    PXARGU
     C                     MOVELISO       PXVALE
     C           KPARAM    CHAINPARAME               90
D2  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    V128
F2  C                     END
     *
     C   79                MOVE USIMP     USFAC
     C                     EXCPTBONIM
     *
D2  C           *INU1     IFEQ '0'
    C           TITPRI    ANDEQ4
    C           PUS       ANDNEUSFAB2
     C                     MOVE *BLANKS   CAR
     C                     MOVE T007      EMB
     C                     Z-ADD0         N       20
     C                     Z-ADD0         CPT
     *
     C                     Z-ADD9         EMBNO
     *
     C           KCAIL1    CHAINCAIPALL1             81
     *
     * //////////////  PALETTE
D3  C           *IN81     IFEQ '0'
    C           EMBNAT    ANDEQ'P'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     * CONSTITUTION DE LA PREMIERE LIGNE
     *
     C                     MOVELEMBNAT    DSNAT   2
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVELEMBNAT    DSCON   2
     C                     MOVE EMBCON    DSCON
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMCE'    PXARGU
     C                     MOVE DSCON     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         N
     C                     MOVEACAR       T0071
    C*          NBCAIP    IFNE *ZEROS
    C*                    Z-ADDNBCAIP    T0073
    C*                    ELSE
    C*          YOSF1     IFNE *ZEROS
    C*          NBDECP    DIV  YOSF1     T0073
    C*                    END
    C*                    END
     C                     Z-ADDNBDECP    T0072
D4  C           NBDECP    IFNE *ZEROS
     C           V0941     DIV  NBDECP    W1
     C                     MOVE W1        REST    40
D5  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F5  C                     END
     C                     Z-ADDW1        T0074
F4  C                     END
     C                     MOVEAT007      EMB,N
     *
     *
     * CONSTITUTION DE LA DEUXIEME LIGNE
     *
     C                     Z-ADDT0074     T0094
     C                     MOVE T008      T007
D4  C           PLANBR    IFNE *ZEROS
    C           DZPNBR    ORNE '0'
     C                     MOVELDZPNBR    WC3N    20
     C                     MOVE PLANBR    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELWC3N      WC3     2
     C                     MOVEAWC3       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPL'    PXARGU
     C                     MOVE PLATYP    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALON    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALAR    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         N
     C                     MOVEACAR       T0071
     C           T0094     MULT WC3N      T0074
     C                     MOVEAT007      EMB,N
F4  C                     END
     *
     *
     * CONSTITUTION DE LA TROISIEME LIGNE
     *
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVEA'FINITION'CAR,I
     C                     ADD  9         I
     *
D4  C           HABIL1    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI11    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVE HABI12    CAR,I
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL2    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI21    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI22    CAR,I
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL3    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI31    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI32    CAR,I
     C                     ADD  2         I
F4  C                     END
     *
D4  C           PROTEC    IFNE *BLANKS
     C                     MOVEA'PROTECTI'CAR,I
     C                     ADD  8         I
     C                     MOVEA'ON'      CAR,I
     C                     ADD  3         I
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPR'    PXARGU
     C                     MOVE PROTEC    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
F4  C                     END
     *
     C                     ADD  1         N
     C                     MOVEACAR       EMB,N
     *
     *
     * CONSTITUTION DE LA QUATRIEME LIGNE
     *
     C                     MOVEL'EMBIMP'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     ADD  1         N
     C                     MOVEAOBSLIB    EMB,N
D5  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F5  C                     END
F4  C                     END
     *
     C                     MOVE EMB,1     T007
     C                     MOVE EMB,2     T008
     C                     MOVE EMB,3     T009
     C                     MOVE EMB,4     T010
     * REF ISO RECHERCHE DANS LA TABLE (TISO)
     * --------------------------------------
     C                     MOVE *BLANKS   T043   20
     *
     C                     MOVEL'BONEMB  'PXVA
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TISO'    PXARGU
     C                     MOVELISO       PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    T043
F4  C                     END
     *
     C                     EXCPTBONEF
F3  C                     END
F2  C                     END
     *
D2  C           *INU1     IFEQ '0'
D3  C           *IN18     IFEQ '0'
     C                     MOVE WEQFAB    WWQFAB
     C                     MOVE SUPOR     WUPOR   1
     C           KPRLA1    CHAINPRLANCL0             99
D4  C           *IN99     IFEQ '0'
    C           SUPOR     ANDNEWUPOR
     C           KPRLA1    READEPRLANCL0                 99
    C           *IN99     CABEQ'1'       TSUI
F4  C                     END
     C                     MOVEL*YEAR     SSFABD
     C                     MOVE *YEAR     AAFABD
     C                     Z-ADDMONTH     MMFABD
     C                     Z-ADDDAY       JJFABD
     C                     EXCPTPRLAF0
X3  C                     ELSE
     C                     MOVEL*YEAR     SSFABD
     C                     MOVE *YEAR     AAFABD
     C                     Z-ADDMONTH     MMFABD
     C                     Z-ADDDAY       JJFABD
     C                     EXCPTPRLAF4
F3  C                     END
F2  C                     END
     *
     C           TSUI      TAG
     *
D2  C           TITPRI    IFEQ 1
    C           TITREP    ANDEQ4
    C           TITPRI    OREQ 2
    C           TITREP    ANDEQ4
     C                     Z-ADDV088      V091
F2  C                     END
    C           V091      CABEQ*ZEROS    SUITE
     *
     *
D2  C           *INU1     IFEQ '0'
     C                     MOVE *BLANKS   PARTIE  7
     C                     Z-ADD0         KGTOT
     *
D3  C           SOF       IFNE 'CXH'
     C           KRESPA    CHAINRESPAPL5             81
D4  C           *IN81     DOWEQ'0'
     C                     ADD  KGBESO    KGTOT  100
     C           KRESPA    READERESPAPL5                 81
D5  C           *IN81     IFEQ '0'
     C                     MOVE 'PARTIEL' PARTIE
F5  C                     END
F4  C  N81                END
F3  C                     END
     *
D3  C           SOF       IFEQ 'CXH'
    C           API       ANDNE'O'
     C           KCXHL3    CHAINRESCXHL3             81
X3  C                     ELSE
     C           KRESPA    CHAINRESPAPL5             81
D4  C           TITPRI    IFEQ 4
    C           HOUB      ANDNE'F'
    C           TITPRI    OREQ 4
    C           *IN81     ANDEQ'1'
     C                     SETOF                     81
     C                     MOVE 'B'       HOUB
     C                     MOVE TPAP,WUIMPPAPI
     C                     MOVE TGRA,WUIMPGRAMM
     C                     MOVE ADPA,WUIMPREFOUR
     C                     MOVE ADGR,WUIMPGRAREL
F4  C                     END
F3  C                     END
D3  C           *IN81     DOWEQ'0'
     C                     SETOF                     40
D4  C           PRIORI    IFNE 33,3
    C           PRIORI    OREQ 33,3
    C           CECT      ANDEQ'1'
    C           CSECT     ANDNE'5'
D5  C           TITREP    IFEQ 1
    C           TITREP    OREQ 2
    C           TITPRI    OREQ 1
    C           TITPRI    OREQ 2
    C           TITPRI    OREQ 4
    C           HOUB      ANDEQ'F'
    C*                    Z-ADDKGBESO    X011    70
    C*                    Z-ADDV0941     X011    70
     C           FEBESO    SUB  FEUSOR    X011    70
     *
     C                     Z-ADDLAIZE     X0104   41
     C                     Z-ADD*ZEROS    X0101   40
     C                     MOVE ' '       X0102   1
     C                     Z-ADD*ZEROS    X0103   40
     *
D6  C           TITPRI    IFEQ 4
    C           HOUB      ANDEQ'F'
     C                     SETON                     30
     C                     Z-ADDHORL      X0101
     C                     MOVE 'X'       X0102
     C                     Z-ADDHORH      X0103
     C                     Z-ADD0         X0104
    C*                    Z-ADDFEBESO    X011    70
    C*                    Z-ADDFEBESO    Y013
    C*                    Z-ADDV0941     X011    70
    C*                    Z-ADDV0941     Y013
     C           FEBESO    SUB  FEUSOR    X011    70
     C           FEBESO    SUB  FEUSOR    Y013
F6  C                     END
     *
     C                     MOVE PAPI      X0081   3
     C                     MOVE GRAMM     X0082   30
     C                     MOVE REFOUR    X0091   6
     C                     MOVE GRAREL    X0092   30
     *
     C           X0104     COMP *ZEROS                   32
     C                     SETON                     40
F5  C                     END
     *
D5  C           TITPRI    IFEQ 4
    C           HOUB      ANDEQ'B'
     C                     SETON                     304032
     C                     Z-ADDFORLBM    X0101
     C                     MOVE 'X'       X0102
     C                     Z-ADDFORHBM    X0103
     C                     Z-ADD0         X0104
     C                     Z-ADDV0941     X011    70
     C                     MOVE PAPI      X0081   3
     C                     MOVE GRAMM     X0082   30
     C                     MOVE REFOUR    X0091   6
     C                     MOVE GRAREL    X0092   30
     *
     C                     Z-ADDLAIZE     Y0114   41
     C                     Z-ADD*ZEROS    Y0111   40
     C                     MOVE ' '       Y0112   1
     C                     Z-ADD*ZEROS    Y0113   40
     *
     C                     Z-ADD*ZEROS    Y0124   41
     C                     Z-ADDFORLBM    Y0121   40
     C                     MOVE 'X'       Y0122   1
     C                     Z-ADDFORHBM    Y0123   40
     *
     C                     MOVE PAPI      Y0091   3
     C                     MOVE GRAMM     Y0092   30
     C                     MOVE REFOUR    Y0101   6
     C                     MOVE GRAREL    Y0102   30
D6  C           V0942     IFEQ 'KG'
     C           FORLBM    MULT 0,001     WORLBM  43
     C           FORHBM    MULT 0,001     WORHBM  43
D7  C           WORLBM    IFNE 0
     C           SUFTH     DIV  WORLBM    W1
     C           W1        MULT 0,975     W1
     C                     SUB  25        W1
     C           W1        DIV  WORHBM    Y008    70H
F7  C                     END
F6  C                     END
D6  C           V0942     IFEQ 'FE'
     C                     Z-ADDV0941     Y008
F6  C                     END
     C           Y0114     COMP *ZEROS                   33
     C           Y0124     COMP *ZEROS                   34
    C*                    Z-ADDKGTOT     Y013    70
D6  C           *IN98     IFEQ '0'
     C                     Z-ADDV0941     Y013    70
X6  C                     ELSE
     C                     Z-ADDV0951     W1
     C                     ADD  V0961     W1
     C           W1        DIV  2         Y013
F6  C                     END
F5  C                     END
     *
D5  C           TITREP    IFEQ 4
    C           TITPRI    ANDEQ1
     *
     C           SFAPRO    DIV  SBFE      V0941     H
     C                     MOVE 'FE'      V0942
     C                     Z-ADDLAIZE     Y0114   41
     C                     Z-ADD*ZEROS    Y0111   40
     C                     MOVE ' '       Y0112   1
     C                     Z-ADD*ZEROS    Y0113   40
     *
     C                     Z-ADD*ZEROS    Y0124   41
     C                     Z-ADDFORLBM    Y0121   40
     C                     MOVE 'X'       Y0122   1
     C                     Z-ADDFORHBM    Y0123   40
     *
     C                     MOVE PAPI      Y0091   3
     C                     MOVE GRAMM     Y0092   30
     C                     MOVE REFOUR    Y0101   6
     C                     MOVE GRAREL    Y0102   30
     C                     Z-ADDV0941     Y008
     C           Y0114     COMP *ZEROS                   33
     C           Y0124     COMP *ZEROS                   34
     C                     Z-ADDV0941     Y013    70
F5  C                     END
     *
D5  C           *IN42     IFEQ '1'
     C                     Z-ADDY013      Y008
     *
     C                     Z-ADD*ZEROS    Y0114   41
     C                     Z-ADDFORLBM    Y0111   40
     C                     MOVE 'X'       Y0112   1
     C                     Z-ADDFORHBM    Y0113   40
     *
     C                     Z-ADD*ZEROS    Y0124   41
     C                     Z-ADDZB841     Y0121   40
     C                     MOVE 'X'       Y0122   1
     C                     Z-ADDZB851     Y0123   40
     *
     *
     C                     MOVE PAPI      Y0091   3
     C                     MOVE GRAMM     Y0092   30
     C                     MOVE REFOUR    Y0101   6
     C                     MOVE GRAREL    Y0102   30
     C           Y0114     COMP *ZEROS                   33
     C           Y0124     COMP *ZEROS                   34
    C*                    SETON                     41
F5  C                     END
     *
     *
     C           KRESPA    READERESPAPL5                 81
     *
     *
     * N° DE PRODUIT SOFHUNIC  ET CDE SOFHUNIC
     * =======================================
     *
     C                     MOVE *BLANKS   X016   40
     C                     MOVE *BLANKS   X017   40
     C                     MOVE V0261     SOF     3
     C                     SETOF                     22
D5  C           SOF       IFEQ 'SOF'
    C           SOF       OREQ 'PEL'
     C                     MOVE WTE       HTE
     C                     MOVE WOCLI     HOCLI
     C                     MOVE WOPRO     HOPRO
     C                     MOVE WCONF     HCONF
     C                     MOVE WEQFAB    HEQFAB
     C           HLIREF    CHAINCARCDEZ2             83
D6  C           *IN83     IFEQ '0'
     C                     MOVELCON,12    X016
     C                     MOVELCON,13    X017
     C                     MOVE NOPRO     X0161   40
     C                     MOVE NCONF     X0171   50
     C                     MOVE SEQFAB    X0172   20
F6  C                     END
F5  C                     END
D5  C           SOF       IFEQ 'CXH'
     C                     MOVE *BLANKS   CAR
     C                     MOVELCON,17    CAR
     C                     MOVE FORCXH    CAR,15
     C                     MOVE STECXH    CAR,29
     C                     MOVE CLICXH    CAR,31
     C                     MOVE PROCXH    CAR,36
     C                     MOVEACAR,1     X016
F5  C                     END
     *
     *
D5  C           *IN40     IFEQ '1'
     C                     MOVE *BLANKS   X007   40
     C                     MOVELCDEPRO    X007
     C                     Z-ADDUSIMP     USINE
     C                     Z-ADDWCONF     NCONF
     C                     Z-ADDWEQFAB    SEQFAB
     C                     Z-ADDWOCLI     NOCLI
     C                     Z-ADDWOPRO     NOPRO
     C                     Z-ADDSUIMP     SUPPOR
     C                     MOVE *BLANKS   TITETE
     C                     MOVELV0971     TITETE
     C                     MOVE COMAC     TITETE
     C                     MOVELV022      LIBSUP
D6  C           ZB841     IFNE *ZEROS
    C           RANG      ANDNE9
    C           TITPRI    ANDEQ4
     C                     Z-ADDZB841     FORL
     C                     Z-ADDZB851     FORH
     C                     Z-ADDZB841     X0101
     C                     Z-ADDZB851     X0103
     C                     MOVEL'MASSICOT'PROVE   9
     C                     MOVE ' '       PROVE
     C                     SETON                     22
X6  C                     ELSE
     C                     Z-ADDX0101     FORL
     C                     Z-ADDX0103     FORH
     C                     SETOF                     22
F6  C                     END
     C                     Z-ADDX0104     LAIZE
D6  C           FORL      IFEQ 0
     C                     Z-ADDX011      KGPRE
     C                     MOVE 'B'       FOUB
X6  C                     ELSE
     C                     Z-ADDX011      FEPRE
     C                     MOVE 'F'       FOUB
F6  C                     END
     C                     MOVE X0081     PAPI
     C                     MOVE X0082     GRAMM
     C                     MOVE X0091     REFOUR
     C                     MOVE X0092     GRAREL
     C                     Z-ADD0         CIMP
     C                     MOVE *BLANKS   LIBIMP
     C                     MOVE *BLANKS   CCLI
     C                     MOVE REFOUR    SOF
D6  C           SOF       IFEQ 'CXH'
     C                     Z-ADDFORCXH    FORCX
     C                     Z-ADDSTECXH    STECX
     C                     Z-ADDCLICXH    CLICX
     C                     Z-ADDPROCXH    PROCX
X6  C                     ELSE
     C                     Z-ADD0         FORCX
     C                     Z-ADD0         STECX
     C                     Z-ADD0         CLICX
     C                     Z-ADD0         PROCX
F6  C                     END
D6  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X6  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F6  C                     END
     C                     Z-ADDTRIORI    PRIORI
     C  N22                WRITECAROFF1
     * REF ISO RECHERCHE DANS LA TABLE (TISO)
     * --------------------------------------
     C                     MOVE *BLANKS   X018   20
     C                     MOVE *BLANKS   Y024    4
     *
     C                     MOVEL'BSORTI  'PXVA
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TISO'    PXARGU
     C                     MOVELISO       PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    X018
F6  C                     END
     *
D6  C           PUS       IFNE 2
     C                     EXCPTBONSO
F6  C                     END
F5  C                     END
     *
     C                     MOVE *BLANKS   WPLAN  13
D5  C           *IN41     IFEQ '1'
     C                     MOVE *BLANKS   Y026   40
     C                     MOVELCDEPRO    Y026
     C                     MOVELV001      WIBIMP  6
     C                     MOVELWIBIMP    LIBIMP
     C                     Z-ADDTITPRI    CIMP
     C                     MOVE V023      CCLI
     C                     MOVE 'OUI '    Y024
D6  C           RANG      IFNE 9
D7  C           PASA      IFEQ ' '
     C                     MOVE 'NON '    Y024
     C                     Z-ADD0         CIMP
     C                     MOVE *BLANKS   LIBIMP
     C                     MOVE *BLANKS   CCLI
     C                     Z-ADDFORLBM    FORL
     C                     Z-ADDFORHBM    FORH
X7  C                     ELSE
     C                     Z-ADD*ZEROS    FORL
     C                     Z-ADD*ZEROS    FORH
     C                     Z-ADDY0114     LAIZE
     C                     MOVE 'B'       FOUB
     C                     MOVE 'OUI '    Y024
F7  C                     END
X6  C                     ELSE
     C                     Z-ADDZB841     FORL
     C                     Z-ADDZB851     FORH
F6  C                     END
     C                     Z-ADDUSIMP     USINE
     C                     Z-ADDWCONF     NCONF
     C                     Z-ADDWEQFAB    SEQFAB
     C                     Z-ADDWOCLI     NOCLI
     C                     Z-ADDWOPRO     NOPRO
     C                     Z-ADDSUIMP     SUPPOR
D6  C           PASA      IFEQ ' '
     C                     MOVE '1'       CECT
     C                     MOVE '5'       CSECT
D7  C           PUS       IFEQ 2
     C                     MOVE '03'      COMAC
F7  C                     END
D7  C           PUS       IFEQ 4
     C                     MOVE '01'      COMAC
F7  C                     END
     C                     MOVEL'MASSICOT'TITETE
X6  C                     ELSE
     C                     MOVE '1'       CECT
     C                     MOVE '3'       CSECT
     C                     MOVE '03'      COMAC
     C                     MOVEL'PASABAN 'TITETE
     C                     MOVE COMAC     TITETE
F6  C                     END
     C                     MOVELV022      LIBSUP
     C                     Z-ADDX0104     LAIZE
D6  C           PASA      IFEQ ' '
     C                     MOVE 'F'       FOUB
     C                     Z-ADDY013      FEPRE
     C                     Z-ADD0         KGPRE
X6  C                     ELSE
     C           SFAPRO    MULT GRAMOY    W1     155
     C           W1        DIV  1000      KGPRE     H
     C           KGPRE     DIV  0,97      KGPRE     H
     C                     Z-ADD0         FEPRE
D7  C           CIMP      IFEQ 1
     C                     MOVEL'HELIO '  LIBIMP
X7  C                     ELSE
     C                     MOVEL'FLEXO '  LIBIMP
F7  C                     END
     C                     MOVE 'B'       FOUB
F6  C                     END
     C                     MOVE X0081     PAPI
     C                     MOVE X0082     GRAMM
     C                     MOVE X0091     REFOUR
     C                     MOVE X0092     GRAREL
     C                     MOVE REFOUR    SOF
D6  C           SOF       IFEQ 'CXH'
     C                     Z-ADDFORCXH    FORCX
     C                     Z-ADDSTECXH    STECX
     C                     Z-ADDCLICXH    CLICX
     C                     Z-ADDPROCXH    PROCX
X6  C                     ELSE
     C                     Z-ADD0         FORCX
     C                     Z-ADD0         STECX
     C                     Z-ADD0         CLICX
     C                     Z-ADD0         PROCX
F6  C                     END
D6  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X6  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F6  C                     END
     C                     Z-ADDTRIORI    PRIORI
     C   90N90N22          WRITECAROFF1
     * REF ISO RECHERCHE DANS LA TABLE (TISO)
     * --------------------------------------
     C                     MOVE *BLANKS   Y027   20
     *
     C                     MOVEL'BONJAG  'PXVA
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TISO'    PXARGU
     C                     MOVELISO       PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    Y027
F6  C                     END
     *
     C   90N90             EXCPTBONJA
F5  C                     END
X4  C                     ELSE
     C           KRESPA    READERESPAPL5                 81
F4  C                     END
     *
F3  C  N81                END
     *
F2  C                     END
     *
     * DEUXIEME BON D'IMPRESSION SI TITPRI=1 ET TITREP=4
D2  C           TITPRI    IFEQ 1
    C           TITREP    ANDEQ4
    C           TITPRI    OREQ 2
    C           TITREP    ANDEQ4
     C                     SETON                     30
     C                     Z-ADDFORLBM    V0291
     C                     Z-ADDFORHBM    V0293
     C                     SETON                     31
     C                     Z-ADDFOL,SU    V0311
     C                     Z-ADDFOH,SU    V0313
     C                     Z-ADD*ZEROS    V0951
     C                     MOVE *BLANKS   V0952
     C                     Z-ADD*ZEROS    V0961
     C                     Z-ADD*ZEROS    RED
     C                     MOVE *BLANKS   V0962   2
     C                     MOVE *BLANKS   V097   73
     C                     MOVE *ZEROS    V0973
     C                     MOVE *ZEROS    V097R
     C                     MOVE *ZEROS    V0974
     C                     MOVE *ZEROS    V0976
     C                     MOVE *ZEROS    V0977
     C                     MOVE *ZEROS    V0978
     C                     MOVE *ZEROS    V0979
     C                     MOVE *ZEROS    V097A
     C                     MOVE *ZEROS    V097B
     C                     MOVE V097      V098
     C                     MOVE V097      V099
     C                     MOVE V097      V100
     C                     MOVE V097      V101
D3  C           DEBREP    IFEQ 2
     C                     MOVEASUP,2     V097
     C                     MOVEASUP,3     V098
     C                     MOVEASUP,4     V099
     C                     MOVEASUP,5     V100
     C                     MOVEASUP,6     V101
    C*                    MOVEASUP,7     ????
F3  C                     END
D3  C           DEBREP    IFEQ 3
     C                     MOVEASUP,3     V097
     C                     MOVEASUP,4     V098
     C                     MOVEASUP,5     V099
     C                     MOVEASUP,6     V100
     C                     MOVEASUP,7     V101
F3  C                     END
     C                     Z-ADD1         J
D3  C           SUPOR     IFEQ 'E'
D4  C           TIM02     IFNE ' '
     C           ETAT02    LOKUPETA,J                    55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF02    DV020
     C                     Z-ADDUS02      USISO
F4  C                     END
F3  C                     END
     *
D3  C           SUPOR     IFEQ 'I'
D4  C           TIM04     IFNE ' '
     C           ETAT04    LOKUPETA,J                    55
     C   55                MOVELLET,J     V020
     C   55                Z-ADDDDEF04    DV020
     C                     Z-ADDUS04      USISO
F4  C                     END
F3  C                     END
    C*                    MOVE *BLANKS   V059
    C*                    MOVELCDEPRO    V059
     * REF ISO RECHERCHE DANS LA TABLE (TISO)
     * --------------------------------------
     C                     MOVE *BLANKS   V128   20
     *
D3  C           *INU1     IFEQ '1'
     C                     MOVEL'COMMAND 'PXVA
X3  C                     ELSE
     C                     MOVEL'BONIMP  'PXVA
F3  C                     END
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TISO'    PXARGU
     C                     MOVELISO       PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    V128
F3  C                     END
     C                     Z-ADDUSISO     USIMP
     *
     C           KRESLD    CHAINRESTPSLD             90
     *
D3  C           *IN90     DOWEQ'0'
D4  C           SECT      IFEQ '1'
    C           SSECT     ANDEQ'3'
    C           SECT      OREQ '1'
    C           SSECT     ANDEQ'5'
     C                     Z-ADDQTENET    V0941
     C                     MOVE 'FE'      V0942
F4  C                     END
D4  C           SECT      IFEQ '1'
    C           SSECT     ANDEQ'4'
     C                     Z-ADDQTENET    V0951
     C                     MOVE 'FE'      V0952
     C                     SETON                     90
F4  C                     END
     C  N90      KRESLD    READERESTPSLD                 90
F3  C  N90                END
     *
     C                     EXCPTBONIM
     *
     C                     Z-ADDUSIMP     USINE
     C                     Z-ADDWCONF     NCONF
     C                     Z-ADDWEQFAB    SEQFAB
     C                     Z-ADDWOCLI     NOCLI
     C                     Z-ADDWOPRO     NOPRO
     C                     Z-ADDSUIMP     SUPPOR
     C                     MOVE *BLANKS   TITETE
     C                     MOVELV0971     TITETE
     C                     MOVELV0972     COMAC
     C                     MOVE '1'       CECT
     C                     MOVE '4'       CSECT
     C                     MOVE COMAC     TITETE
     C                     MOVELV022      LIBSUP
     C                     Z-ADDV0291     FORL
     C                     Z-ADDV0293     FORH
     C                     SETOF                     22
     C                     Z-ADD0         KGPRE
     C                     Z-ADDV0941     FEPRE
     C                     MOVE 'F'       FOUB
     C                     Z-ADDTITPRI    CIMP
     C                     MOVE *BLANKS   LIBIMP
D3  C           TITPRI    IFEQ 1
     C                     MOVEL'HELIO '  LIBIMP
     C                     Z-ADD4         CIMP
F3  C                     END
D3  C           TITPRI    IFEQ 2
     C                     MOVEL'FLEXO '  LIBIMP
     C                     Z-ADD4         CIMP
F3  C                     END
     C                     MOVE V023      CCLI
     C                     MOVE REFOUR    SOF
D3  C           SOF       IFEQ 'CXH'
     C                     Z-ADDFORCXH    FORCX
     C                     Z-ADDSTECXH    STECX
     C                     Z-ADDCLICXH    CLICX
     C                     Z-ADDPROCXH    PROCX
X3  C                     ELSE
     C                     Z-ADD0         FORCX
     C                     Z-ADD0         STECX
     C                     Z-ADD0         CLICX
     C                     Z-ADD0         PROCX
F3  C                     END
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     Z-ADDTRIORI    PRIORI
     C  N22                WRITECAROFF1
F2  C                     END
     *
     C           SUITE     TAG
D2  C           *IN18     IFEQ '0'
D3  C           *INU1     IFEQ '0'
D4  C           PUS       IFEQ 0
     C           KPRLA2    READEPRLANCL9                 80
X4  C                     ELSE
     C           KPRLA2    READEPRLANCXG                 80
F4  C                     END
X3  C                     ELSE
     C                     Z-ADD0         PUS
     C           KPRLA1    READEPRLANCL0                 81
D4  C           *IN81     IFEQ '0'
     C                     Z-ADDUSFAB     PUS
    C           PUS       CABEQ3         SUITE
X4  C                     ELSE
D5  C           *IN52     IFEQ '1'
    C           SUPOR     ANDEQ'E'
D6  C           WSINT     IFNE *ZERO
     C                     MOVE 'I'       SUPOR
     C                     Z-ADD5         WUIMP
     C                     SETOF                     81
     C                     Z-ADDWSINT     PUS
    C           PUS       CABEQ3         SUITE
F6  C                     END
F5  C                     END
F4  C                     END
D4  C           *IN81     IFEQ '1'
     C                     READ CDESL1                   80
     C                     MOVE *BLANKS   V102
D5  C           TAGBID    IFEQ 'U'
     C                     MOVELCON,14    V102
F5  C                     END
     C                     SETOF                     52
D5  C           *IN80     IFEQ '0'
     C           KPRLA1    CHAINPRLANCL0             81
D6  C           *IN81     IFEQ '0'
     C                     Z-ADDUSFAB     PUS
    C           PUS       CABEQ3         SUITE
X6  C                     ELSE
     C                     Z-ADD1         WEQFAB
     C           KCARCD    CHAINCARCDEL1             81
D7  C           WSEXT     IFNE *ZERO
     C                     MOVE 'E'       SUPOR
     C                     Z-ADD3         WUIMP
     C                     SETON                     52
     C                     Z-ADDWSEXT     PUS
X7  C                     ELSE
D8  C           WSINT     IFNE *ZERO
     C                     MOVE 'I'       SUPOR
     C                     Z-ADD5         WUIMP
     C                     SETON                     52
     C                     Z-ADDWSINT     PUS
F8  C                     END
F7  C                     END
    C           PUS       CABEQ3         SUITE
F6  C                     END
F5  C                     END
F4  C                     END
    C  N80      PUS       CABEQ0         SUITE
F3  C                     END
     *
X2  C                     ELSE
     *
     C           KPRLA2    READEPRLANCX4                 80
F2  C                     END
F1  C  N80                END
     C           FIN       TAG
D1  C           *INU8     IFEQ '0'
    C  NU1N23N18*IN18     CABEQ'0'       DEBUT          18
F1  C                     END
     C           FINNUL    TAG
     C                     SETON                     LR
     C           KHIVAL    DELETPRODUIF1             81
     *
     ***************************************************************
    C           SPCAR     BEGSR
     C                     Z-ADD75        I
D1  C           CAR,I     DOWEQ' '
     C                     SUB  1         I
     C           I         COMP 1                        82
F1  C  N82                END
    C                     ENDSR
     *
     ***************************************************************
     OPRLANC4 E                PRLAF4
     O                         SSFABD                                     PROD13
     O                         AAFABD                                     PROD13
     O                         MMFABD                                     PROD13
     O                         JJFABD                                     PROD13
     OPRLANCF E                PRLAF0
     O                         SSFABD                                     PROD13
     O                         AAFABD                                     PROD13
     O                         MMFABD                                     PROD13
     O                         JJFABD                                     PROD13
     OBONIMP  E                BONIM                                      PROD02
     O                         V001      13                               PROD02
     O                         V002      23                               PROD02
     O                         V003      35                               PROD02
     O                         V004      75                               PROD02
     O                         V005  4   79                               PROD02
     O                         V006  4   83                               PROD02
     O                         V0071 4   88                               PROD02
     O                         V0072     92                               PROD02
     O                         V008     100 '  /  / 0'                    PROD02
     O                         V009     108 '  /  / 0'                    PROD02
     O                         V010  4  112                               PROD02
     O                         V011     152                               PROD02
     O                         V012     192                               PROD02
     O                         V013     232                               PROD02
     O                         V014     272                               PROD02
     O                         V015     312                               PROD02
     O                         V016     352                               PROD02
     O                         V017     392                               PROD02
     O                         V018     432                               PROD02
     O                         V020     444                               PROD02
     O                         V021     456                               PROD02
     O                         V022     465                               PROD02
     O                         V023     471                               PROD02
     O                         V024  4  476                               PROD02
     O                         V0251    479                               PROD02
     O                         V0252 4  483                               PROD02
     O                         V0261    489                               PROD02
     O                         V0262 4  494                               PROD02
     O                         V027  4  498                               PROD02
     O                         V028  4  502                               PROD02
     O                N30      V0294 4  510                               PROD02
     O                 30      V0291 4  506                               PROD02
     O                 30      V0292    508                               PROD02
     O                 30      V0293 4  513                               PROD02
     O                         V030  4  517                               PROD02
     O                N31      V0314 4  525                               PROD02
     O                 31      V0311 4  521                               PROD02
     O                 31      V0312    523                               PROD02
     O                 31      V0313 4  528                               PROD02
     O                         V032     568                               PROD02
     O                         V033     608                               PROD02
     O                         V034     648                               PROD02
     O                         V035     688                               PROD02
     O                         V036     696 '  /  / 0'                    PROD02
     O                         V037     704 '  /  / 0'                    PROD02
     O                         V038     712 '  /  / 0'                    PROD02
     O                         V039     720 '  /  / 0'                    PROD02
     O                         V040     760                               PROD02
     O                         V041     800                               PROD02
     O                         V042     840                               PROD02
     O                         V043     880                               PROD02
     O                         V044     888 '  /  / 0'                    PROD02
     O                         V045     896 '  /  / 0'                    PROD02
     O                         V046     904 '  /  / 0'                    PROD02
     O                         V047     912 '  /  / 0'                    PROD02
     O                         V048     952                               PROD02
     O                         V049     992                               PROD02
     O                         V050    1032                               PROD02
     O                         V051    1072                               PROD02
     O                         V052    1112                               PROD02
     O                         V053    1152                               PROD02
     O                         V054    1192                               PROD02
     O                         V055    1232                               PROD02
     O                         V056    1272                               PROD02
     O                         V057    1312                               PROD02
     O                         V058    1352                               PROD02
     O                         V059    1392                               PROD02
     O                         V060    1398                               PROD02
     O                         V061    1404                               PROD02
     O                         V062    1410                               PROD02
     O                         V063    1416                               PROD02
     O                         V064    1422                               PROD02
     O                         V065    1428                               PROD02
     O                         V066    1434                               PROD02
     O                         V067    1440                               PROD02
     O                         V068    1446                               PROD02
     O                         V069    1452                               PROD02
     O                         V070    1458                               PROD02
     O                         V071    1464                               PROD02
     O                         V072    1472 '  /  / 0'                    PROD02
     O                         V073    1480 '  /  / 0'                    PROD02
     O                         V074    1488 '  /  / 0'                    PROD02
     O                         V075    1496 '  /  / 0'                    PROD02
     O                         V076    1504 '  /  / 0'                    PROD02
     O                         V077    1512 '  /  / 0'                    PROD02
     O                         V078    1520 '  /  / 0'                    PROD02
     O                         V079    1528 '  /  / 0'                    PROD02
     O                         V080    1536 '  /  / 0'                    PROD02
     O                         V081    1544 '  /  / 0'                    PROD02
     O                         V082    1552 '  /  / 0'                    PROD02
     O                         V083    1560 '  /  / 0'                    PROD02
     O                         V084    1584                               PROD02
     O                         V085    1608                               PROD02
     O                         V086    1632                               PROD02
     O                         V087    1656                               PROD02
     O                         V088  2 1665                               PROD02
     O                         V089  2 1674                               PROD02
     O                         V090  2 1683                               PROD02
     O                         V091  2 1692                               PROD02
     O                         V0921  B1693                               PROD02
     O                         V0922  B1694                               PROD02
     O                         V0941 2 1713                               PROD02
     O                         V0942   1716                               PROD02
     O                         V0951 2 1725                               PROD02
     O                         V0952   1728                               PROD02
     O                N04      V0961 2 1737                               PROD02
     O                N04      V0962   1740                               PROD02
     O                         V0971   1746                               PROD02
     O                         V097P   1747                               PROD02
     O                         V097I   1748                               PROD02
     O                         V0972   1751                               PROD02
     O                         V097S   1753                               PROD02
     O                         V0973 4 1755                               PROD02
     O                         V097R   1757                               PROD02
     O                         V0974 4 1760                               PROD02
     O                         V0975   1765                               PROD02
     O                         V0976 2 1775                               PROD02
     O                         V0977 4 1784                               PROD02
     O                         V0978 4 1793                               PROD02
     O                         V0979 4 1796                               PROD02
     O                         V097A 4 1804                               PROD02
     O                         V097B 4 1813                               PROD02
     O                         V0981   1819                               PROD02
     O                         V098P   1820                               PROD02
     O                         V098I   1821                               PROD02
     O                         V0982   1824                               PROD02
     O                         V098S   1826                               PROD02
     O                         V0983 4 1828                               PROD02
     O                         V098R   1830                               PROD02
     O                         V0984 4 1833                               PROD02
     O                         V0985   1838                               PROD02
     O                         V0986 2 1848                               PROD02
     O                         V0987 4 1857                               PROD02
     O                         V0988 4 1866                               PROD02
     O                         V0989 4 1869                               PROD02
     O                         V098A 4 1877                               PROD02
     O                         V098B 4 1886                               PROD02
     O                         V0991   1892                               PROD02
     O                         V099P   1893                               PROD02
     O                         V099I   1894                               PROD02
     O                         V0992   1897                               PROD02
     O                         V099S   1899                               PROD02
     O                         V0993 4 1901                               PROD02
     O                         V099R   1903                               PROD02
     O                         V0994 4 1906                               PROD02
     O                         V0995   1911                               PROD02
     O                         V0996 2 1921                               PROD02
     O                         V0997 4 1930                               PROD02
     O                         V0998 4 1939                               PROD02
     O                         V0999 4 1942                               PROD02
     O                         V099A 4 1950                               PROD02
     O                         V099B 4 1959                               PROD02
     O                         V1001   1965                               PROD02
     O                         V100P   1966                               PROD02
     O                         V100I   1967                               PROD02
     O                         V1002   1970                               PROD02
     O                         V100S   1972                               PROD02
     O                         V1003 4 1974                               PROD02
     O                         V100R   1976                               PROD02
     O                         V1004 4 1979                               PROD02
     O                         V1005   1984                               PROD02
     O                         V1006 2 1994                               PROD02
     O                         V1007 4 2003                               PROD02
     O                         V1008 4 2012                               PROD02
     O                         V1009 4 2015                               PROD02
     O                         V100A 4 2023                               PROD02
     O                         V100B 4 2032                               PROD02
     O                         V1011   2038                               PROD02
     O                         V101P   2039                               PROD02
     O                         V101I   2040                               PROD02
     O                         V1012   2043                               PROD02
     O                         V101S   2045                               PROD02
     O                         V1013 4 2047                               PROD02
     O                         V101R   2049                               PROD02
     O                         V1014 4 2052                               PROD02
     O                         V1015   2057                               PROD02
     O                         V1016 2 2067                               PROD02
     O                         V1017 4 2076                               PROD02
     O                         V1018 4 2085                               PROD02
     O                         V1019 4 2088                               PROD02
     O                         V101A 4 2096                               PROD02
     O                         V101B 4 2105                               PROD02
     O                         V102    2165                               PROD02
     O                         W103    2171                               PROD02
     O                         W1032   2183                               PROD02
     O                         V104    2281                               PROD02
     O                         V105    2337                               PROD02
     O                         V106    2393                               PROD02
     O                         V107    2449                               PROD02
     O                         V108    2505                               PROD02
     O                         V109    2561                               PROD02
     O                         V110    2617                               PROD02
     O                         V111    2673                               PROD02
     O                         V112  2 2683                               PROD02
     O                         V113  2 2692                               PROD02
     O                         V114  2 2701                               PROD02
     O                 U1      V1151 4 2703                               PROD02
     O                 U1      V1152 2 2716                               PROD02
     O                 U1      V1153   2726 '  .  .0'                     PROD02
     O                 U1      V1154   2732                               PROD02
     O                 U1      V1161 4 2734                               PROD02
     O                 U1      V1162 2 2747                               PROD02
     O                 U1      V1163   2757 '  .  .0'                     PROD02
     O                 U1      V1164   2763                               PROD02
     O                 U1      V1171 4 2765                               PROD02
     O                 U1      V1172 2 2778                               PROD02
     O                 U1      V1173   2788 '  .  .0'                     PROD02
     O                 U1      V1174   2794                               PROD02
     O                 U1      V1181 4 2796                               PROD02
     O                 U1      V1182 2 2809                               PROD02
     O                 U1      V1183   2819 '  .  .0'                     PROD02
     O                 U1      V1184   2825                               PROD02
     O                 U1      V1191 4 2827                               PROD02
     O                 U1      V1192 2 2840                               PROD02
     O                 U1      V1193   2850 '  .  .0'                     PROD02
     O                 U1      V1194   2856                               PROD02
     O                 U1      V1201 4 2858                               PROD02
     O                 U1      V1202 2 2871                               PROD02
     O                 U1      V1203   2881 '  .  .0'                     PROD02
     O                 U1      V1204   2887                               PROD02
     O                 U1      V1211 4 2889                               PROD02
     O                 U1      V1212 2 2902                               PROD02
     O                 U1      V1213   2912 '  .  .0'                     PROD02
     O                 U1      V1214   2918                               PROD02
     O                 U1      V122    2949                               PROD02
     O                 U1      V123    2980                               PROD02
     O                         V124    3011                               PROD02
     O                         ZB841 4 3015                               PROD02
     O                         ZBX     3017                               PROD02
     O                         ZB851 4 3022                               PROD02
     O                         USFAC   3043P                              PROD02
     O                         USIMP   3044P                              PROD02
     O                         V126    3048                               PROD02
     O                         V127    3063                               PROD02
     O                         V128    3083                               PROD02
     O                 04NU1   V129    3087
     O                 04NU1   V130    3091
     OBSORTI  E                BONSO                                      PROD02
     O                         V005  4    4                               PROD02
     O                         X002      19                               PROD02
     O                         V0071 4   24                               PROD02
     O                         V0072     26                               PROD02
     O                         V006  4   30                               PROD02
     O                         V012      70                               PROD02
    O*                        V013     110                               PROD02
     O                         X007     110                               PROD02
     O                         X0081    113                               PROD02
     O                         X0082 4  117                               PROD02
     O                         X0091    123                               PROD02
     O                         X0092 4  127                               PROD02
     O                 32      X0101 4  131                               PROD02
     O                 32      X0102    133                               PROD02
     O                 32      X0103 4  138                               PROD02
     O                N32      X0104 4  135                               PROD02
     O                         X011  2  147                               PROD02
     O                         PARTIE   154                               PROD02
     O                         V0971    160                               PROD02
     O                         V0972    163                               PROD02
     O                         X014  Y  171                               PROD02
     O                         USFAC    172P                              PROD02
     O                         USIMP    173P                              PROD02
     O                N22 42   ZB841 4  177                               PROD02
     O                N22 42   ZBX    B 179                               PROD02
     O                N22 42   ZB851 4  184                               PROD02
     O                 22 42   PROVE  B 184                               PROD02
     O                         X016   B 224                               PROD02
     O                         X0161 4B 218                               PROD02
     O                         X017   B 264                               PROD02
     O                         X0171 4B 252                               PROD02
     O                         X0172 4B 254                               PROD02
     O                         X018     284                               PROD02
     O                         X020     292                               PROD02
     OBONEMB  E                BONEF                                      PROD02
     O                         V005  4    4                               PROD02
     O                         V004      44                               PROD02
     O                         V006  4   48                               PROD02
     O                         V012      88                               PROD02
     O                         V013     128                               PROD02
     O                         V0071 4  133                               PROD02
     O                         V0072    137                               PROD02
     O                         T0071    212
     O                         T0072 4  217
     O                         T0073 4  221
     O                         T0074 4  227
     O                         T0081    302
     O                         T0082 4  307
     O                         T0083 4  311
     O                         T0084 4  317
     O                         T0091    392
     O                         T0092 4  397
     O                         T0093 4  401
     O                         T0094 4  407
     O                         T0101    482
     O                         T0102 4  487
     O                         T0103 4  491
     O                         T0104 4  497
     O                         USFAB   2745P                              PROD02
     O                         USIMP   2746P                              PROD02
     O                         T043    2766                               PROD02
     OBONJAG  E                BONJA                                      PROD02
     O                         V005  4    4                               PROD02
     O                         X002      19                               PROD02
     O                         V0071 4   24                               PROD02
     O                         V0072     26                               PROD02
     O                         V006  4   30                               PROD02
     O                         V012      70                               PROD02
     O                         V013     110                               PROD02
     O                         Y008  2B 119                               PROD02
     O                         Y0091    122                               PROD02
     O                         Y0092 4  126                               PROD02
     O                         Y0101    132                               PROD02
     O                         Y0102 4  136                               PROD02
     O                 33      Y0111 4  140                               PROD02
     O                 33      Y0112    142                               PROD02
     O                 33      Y0113 4  147                               PROD02
     O                N33      Y0114 4  144                               PROD02
     O                 34      Y0121 4  151                               PROD02
     O                 34      Y0122    153                               PROD02
     O                 34      Y0123 4  158                               PROD02
     O                N34      Y0124 4  155                               PROD02
     O                         Y013  2  167                               PROD02
     O                         PARTIE   174                               PROD02
     O                         USFAC    175P                              PROD02
     O                         USIMP    176P                              PROD02
     O                         V005  4  180                               PROD02
     O                         V004     220                               PROD02
     O                         V006  4  224                               PROD02
     O                         V012     264                               PROD02
     O                         V013     304                               PROD02
     O                         V0071 4  309                               PROD02
     O                         V0072    313                               PROD02
    O*                        Y0211    353                               PROD02
    O*                        Y0212 2  383                               PROD02
    O*                        Y0221    423                               PROD02
    O*                        Y0222 4  453                               PROD02
    O*                        Y0231    493                               PROD02
    O*                        Y0232 2  523                               PROD02
     O                         Y024   B 527                               PROD02
    O*                        Y025  4B 534                               PROD02
     O                         Y026   B 574                               PROD02
    O*                        Y0262 2B 604                               PROD02
     O                         Y027     624                               PROD02
     O                         V023     638                               PROD02
**  TABLE DES TYPES D'IMPRESSION
01HELIO
02FLEXO
04OFFSET
12HELIO-FLEXO
14HELIO-OFFSET
21FLEXO-HELIO
24FLEXO-OFFSET
44OFFSET-OFFSET
10HELIO
20FLEXO
40OFFSET
41OFFSET-HELIO
30COUPEU
67ST DOR
67ST PEL
16DORURE
**  TABLE DES CONSTANTES
PRE-IMPRIME STOCKE
EXTERIEUR
INTERIEUR
GROUPAGE
GARNITURE
COMMANDE D'ESSAIS
COMMANDE D'HOMOLOGATION
IMPRESSION EXT. INT.
SOUS-TRAITANCE
PRODUIT DE LUXE
AMALGAME
 N° PRODUIT SOFHUNIC :   8928
 COMMANDE SOFHUNIC   :
ATTENTION !!!    COMMANDE SANS VETO
IS/92/26
IS/IMP 94 N/012
CXH -->Forme: ..... Prod. :
IMPRESSION POUR NEUVILLE
 PREVISIONNELLE
IMPRESSION POUR CHABANAIS
ORIGINE DE LA CDE :
IMPRESSION POUR FEGERSHEIM
CONTACT ALIMENTAIRE
FORMAT MASSICOTÉ
MACULES A CONSERVER
**  TABLE DES ETAT MATERIEL
CCREATION
MMODIFICATION
RREFECTION
EEXISTANT
 EXISTANT
