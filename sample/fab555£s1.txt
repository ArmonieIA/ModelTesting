     H            D.J
    H*****************************************************************
    H*                                                               *
    H*             MODIFICATION SUIVI DE FABRICATION                 *
    H*                                                               *
    H*****************************************************************
      * TMAEDE LE 28/07/2016 : Vu dans DWASS des anomalies de quantités pour des
      *    certaines conf. Après recherches, la constatation est la suivante :
      *    qd le chef d'équipe fait une régul sur une opération, certains n°
      *    OP sont écrasés juste avant l'écriture dans HISTOFA2 ==> le HISTOFA2
      *    initial n'est pas modifié, et on créé un HISTOFA2 supplémentaire avec
      *    un n° d'op différent, se terminant par 1 (ex: 9592 passe à 9591);
      *    dans le prog, il y a un test spécifique pour l'atelier 82 : je le
      *      flague...   (avant chacun des 3 appels à PROD79£)
    H* TMAELE 25/01/2013                                             *
    H* MODIF SUITE ERREUR VUE DANS LOG :                             *
    H*  MAJ OU SUP FAB22L01 SANS READ OU CHAIN PREALABLE             *
    H*****************************************************************
     FFAB03L01IF  E           K        DISK
     FFAB03L02IF  E           K        DISK
     F            XFAB03                            KRENAMEYFAB03
     FFAB04L01IF  E           K        DISK
     FFAB05L03IF  E           K        DISK
    FFAB05L07UF  E           K        DISK
     F            XFAB05                            KRENAMEZFAB05
    FFAB06L10UF  E           K        DISK
     FFAB08L01IF  E           K        DISK
     FFAB10L09IF  E           K        DISK
     FFAB10L10IF  E           K        DISK
     F            XFAB10                            KRENAMEZFAB10
     FFAB10L23IF  E           K        DISK
     F            XFAB10                            KRENAMETFAB10
     FFAB11L09IF  E           K        DISK
     FFAB11L10IF  E           K        DISK
     F            XFAB11                            KRENAMEZFAB11
     FFAB13L01IF  E           K        DISK
    FFAB15L01UF  E           K        DISK
    FFAB16L01UF  E           K        DISK                      A
     FFAB16L05IF  E           K        DISK
    FFAB17L01UF  E           K        DISK                      A
     FFAB17L02IF  E           K        DISK
     FFAB17L04IF  E           K        DISK
     F            XFAB17                            KRENAMEYFAB17
    FFAB17L05UF  E           K        DISK
     F            XFAB17                            KRENAMEZFAB17
    FFAB17L12UF  E           K        DISK
     F            XFAB17                            KRENAMETFAB17
    FFAB18L01UF  E           K        DISK                      A
    FFAB19L01UF  E           K        DISK                      A
    FFAB21L01O   E           K        DISK                      A
    FFAB22L01UF  E           K        DISK                      A
     FCALENS  IF  E           K        DISK
     FCODBARL2IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FPRODAL8 IF  E           K        DISK
     FCLIENTS1IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
     FPRODST3 IF  E           K        DISK
     FMACHIN  IF  E           K        DISK
     FTRASPE  IF  E           K        DISK                               PROD02
     FPREACOP2IF  E           K        DISK
    FRESTPSLDUF  E           K        DISK
    FPRLANCXHUF  E           K        DISK
    FPREFOUL2UF  E           K        DISK
     FCDESLC  IF  E           K        DISK
     FFABGOFL3IF  E           K        DISK
     FFAB555D CF  E                    WORKSTN
     F                                        RCX   KSFILE F06
     F                                        RCY   KSFILE F11
     F                                        RCT   KSFILE F19
     F                                        RCU   KSFILE F08A
     E                    TCAD        4  2
     E                    XCAD        4  2
     E                    THAD        4  4 0
     E                    TTAD        4  1
     E                    TEAD        4  1 0
     E                    TLAD        4 12
     E                    TAD1        6  2               HISTOFA2:CODES AD
     E                    TAD2        6  4 2             HISTOFA2:TEMPS AD
     E                    TAD3        6  1               HISTOFA2:INCLUS AD
     E                    TAD4        6  1 0             HISTOFA2:EFFECTIFS AD
     E                    EBCAD       6  2               HISTOFA2:CODES AD
     E                    EBTAD       6  4 2             HISTOFA2:TEMPS AD
     E                    EBIAD       6  1               HISTOFA2:INCLUS AD
     E                    EBEAD       6  1 0             HISTOFA2:EFFECTIFS AD
     E                    PAG        50  2
     E                    AF1         9  2
     E                    AF2         9 30
     E                    AF3         9 30
     E                    ZO      1   9 10
     E                    TM      1   4 13
     E                    EQ      1   3 10                                PA010
     E                    LIFI    1   3 29                                PA010
     E                    LIBF    1   3 15                                PA010
     E                    LB      1   1 20                                PA010
     E                    TBU     5   5  1 0                              PA010
     E                    TEQ     1  15  8 0                              PA010
     IPREACOPF
     I              SECT                            XSECT
     I              SSECT                           XSSECT
     I              NOCLI                           XNOCLI
     I              MAC                             XMAC
     IZFAB05
     I              SECT                            XSECT
     I              SSECT                           XSSECT
     I              NOMAC                           XNOMAC
     IZFAB10
     I              FAUSIN                          XAUSIN
     I              FACONF                          XACONF
     I              FASEQ                           XASEQ
     I              FAISEQ                          XAISEQ
     I              STE                             XSTE
     I              NOCLI                           XNOCLI
     I              NOPRO                           XNOPRO
     I              FATENC                          XATENC
     I              FAOPNU                          XAOPNU
     I              SECT                            XSECT
     I              SSECT                           XSSECT
     I              NOMAC                           XNOMAC
     I              PPEQUI                          XPEQUI
     I              PPAA                            XPAA
     I              PPMM                            XPMM
     I              PPJJ                            XPJJ
     I              FAAENT                          XAAENT
     I              FAMENT                          XAMENT
     I              FAJENT                          XAJENT
     I              FAHENT                          XAHENT
     ITFAB10
     I              FAUSIN                          XAUSIN
     I              FACONF                          XACONF
     I              FASEQ                           XASEQ
     I              FAISEQ                          XAISEQ
     I              STE                             XSTE
     I              NOCLI                           XNOCLI
     I              NOPRO                           XNOPRO
     I              FATENC                          XATENC
     I              FAOPNU                          XAOPNU
     I              SECT                            XSECT
     I              SSECT                           XSSECT
     I              NOMAC                           XNOMAC
     I              PPEQUI                          XPEQUI
     I              PPAA                            XPAA
     I              PPMM                            XPMM
     I              PPJJ                            XPJJ
     I              FAAENT                          XAAENT
     I              FAMENT                          XAMENT
     I              FAJENT                          XAJENT
     I              FAHENT                          XAHENT
     IXFAB15
     I              USINE                           XUSINE
     IYFAB17
     I              FACONF                          XACONF
     I              FASEQ                           XASEQ
     I              FAISEQ                          XAISEQ
     I              NOPRO                           XNOPRO
     I              FAOPNU                          XAOPNU
     I              PPPAS                           XPPAS
     I              PPFAA                           XPFAA
     I              PPFMM                           XPFMM
     I              PPFJJ                           XPFJJ
     I              FAEVCO                          XAEVCO
     I              PPORD                           XPORD
     I              FAEVTY                          XAEVTY
     I              FANOMB                          XANOMB
     I              FA1701                          XA1701
     I              FA1702                          XA1702
     IZFAB17
     I              PPFAA                           XPFAA
     I              PPFMM                           XPFMM
     I              PPFJJ                           XPFJJ
     I              PPHDEB                          XPHDEB
     I              PPHFIN                          XPHFIN
     IPRODUIF1
     I              USINE                           XUSINE
     I              STE                             XSTE
     I              NCONF                           XCONF
     I              NOCLI                           XNOCLI
     I              AGENT                           XAGENT
     IRECAPTF1
     I              USINE                           XUSINE
     I              STE                             XSTE
     I              NCONF                           XCONF
     I              NOCLI                           XNOCLI
     I              AGENT                           XAGENT
     IPRODARF1
     I              USINE                           XUSINE
     I              STE                             XSTE
     I              NCONF                           XCONF
     I              NOCLI                           XNOCLI
     I              AGENT                           XAGENT
     IPRODSTF2
     I              MAIME1                          XAIME1
     I              MAIME2                          XAIME2
     I              MAIME3                          XAIME3
     I              MAIME4                          XAIME4
     I              MAIME5                          XAIME5
     I              MIMRE1                          XIMRE1
     I              MIMRE2                          XIMRE2
     I              MIMRE3                          XIMRE3
     I              MIMRE4                          XIMRE4
     I              MIMRE5                          XIMRE5
     I              RMIME1                          XMIME1
     I              RMIME2                          XMIME2
     I              RMIME3                          XMIME3
     I              RMIME4                          XMIME4
     I              RMIME5                          XMIME5
     I              RMIRE1                          XMIRE1
     I              RMIRE2                          XMIRE2
     I              RMIRE3                          XMIRE3
     I              RMIRE4                          XMIRE4
     I              RMIRE5                          XMIRE5
     I              MAGAU1                          XAGAU1
     I              MAGAU2                          XAGAU2
     IRESTPSF1
     I              STE                             ZSTE
     I              NCONF                           ZCONF
     I              NOCLI                           ZNOCLI
     I              SECT                            ZSECT
     I              SSECT                           ZSSECT
     I              ABRCLI                          ZBRCLI
     I              NOMAC                           ZNOMAC
     I              I                               ZI
     I              TPSTOT                          ZTPSTO
     ITRASPEF1
     I              NOMAC                           RRMAC
     IFABGOFF
     I              SECT                            GSECT
     I              SSECT                           GSSECT
     I              NOMAC                           GNOMAC
     I              PPEQUI                          GPPEQU
     *
     I           IDS
     I                                        1  140HEUR14
     I                                        1   60PPHHMO
     I                                        7   80PPJJMO
     I                                        9  100PPMMMO
     I                                       11  140PPAAMO
     I           IDS
     I                                        1   80DATLUE                CCS013
     I                                        1   20CALJJ                 CCS013
     I                                        3   40CALMM                 CCS013
     I                                        5   60CALSS                 CCS013
     I                                        7   80CALAA                 CCS013
     I           IDS
     I                                        1   80DATRR                 CCS013
     I                                        1   40RRAA                  CCS013
     I                                        5   60RRMM                  CCS013
     I                                        7   80RRJJ                  CCS013
     I           IDS
     I                                        1  170DH                    CCS013
     I                                        1   40FAAFA                 CCS013
     I                                        5   60FAMFA                 CCS013
     I                                        7   80FAJFA                 CCS013
     I                                        9  140FAHFA                 CCS013
     I                                       15  170FANOP                 CCS013
     I           IDS
     I                                        1   80DATE                  CCS013
     I                                        1   20ZAJFA                 CCS013
     I                                        3   40ZAMFA                 CCS013
     I                                        5   80ZAAFA                 CCS013
     I           IDS
     I                                        1   80DATEQ                 CCS013
     I                                        1   20PPJJ                  CCS013
     I                                        3   40PPMM                  CCS013
     I                                        5   80PPAA                  CCS013
     I           IDS
     I                                        1   80DATEQ2                CCS013
     I                                        1   40AAPP                  CCS013
     I                                        5   60MMPP                  CCS013
     I                                        7   80JJPP                  CCS013
     I           IDS
     I                                        1   80NDATEQ                CCS013
     I                                        1   20JJNN                  CCS013
     I                                        3   40MMNN                  CCS013
     I                                        5   80AANN                  CCS013
     I           IDS
     I                                        1   80DATEVE                CCS013
     I                                        1   20PPFJJ                 CCS013
     I                                        3   40PPFMM                 CCS013
     I                                        5   80PPFAA                 CCS013
     I           IDS
     I                                        1   80XATEVE                CCS013
     I                                        1   20XPFJJ                 CCS013
     I                                        3   40XPFMM                 CCS013
     I                                        5   80XPFAA                 CCS013
     I           IDS
     I                                        1   80DATLIV                CCS013
     I                                        1   20FAJLI                 CCS013
     I                                        3   40FAMLI                 CCS013
     I                                        5   80FAALI                 CCS013
     I           IDS
     I                                        1   80FADJA1                CCS013
     I                                        1   20FAJJA1                CCS013
     I                                        3   40FAMJA1                CCS013
     I                                        5   80FAAJA1                CCS013
     I           IDS
     I                                        1   80FADJA2                CCS013
     I                                        1   20FAJJA2                CCS013
     I                                        3   40FAMJA2                CCS013
     I                                        5   80FAAJA2                CCS013
     I           IDS
     I                                        1   80DTOPD                 CCS013
     I                                        1   20FAJCAD                CCS013
     I                                        3   40FAMCAD                CCS013
     I                                        5   80FAACAD                CCS013
     I           IDS
     I                                        1   80DTOPF                 CCS013
     I                                        1   20FAJTIF                CCS013
     I                                        3   40FAMTIF                CCS013
     I                                        5   80FAATIF                CCS013
     I           IDS
     I                                        1   80DATREC                CCS013
     I                                        1   20FAJRE                 CCS013
     I                                        3   40FAMRE                 CCS013
     I                                        5   80FAARE                 CCS013
     I           IDS
     I                                        1  18 CDE
     I                                        1   10USINE                 CCS013
     I                                        2   60FACONF                CCS013
     I                                        7   80FASEQ                 CCS013
     I                                        9   90FAISEQ                CCS013
     I                                       10  130NOPRO                 CCS013
     I                                       14  140STE                   CCS013
     I                                       15  180NOCLI                 CCS013
     I           IDS
     I                                        1   2 FAATEL
     I                                        1   1 SECT                  CCS013
     I                                        2   2 SSECT                 CCS013
     I           IDS
     I                                        1   5 P1
     I                                        1   10ZUSI                  CCS013
     I                                        2   5 ZRESS
     I                                        2   2 ZSECT                 CCS013
     I                                        3   3 ZSSECT                CCS013
     I                                        4   5 ZNOMAC                CCS013
     I           IDS
     I                                        1   8 TCAD
     I                                        1   2 CARD1                 CCS013
     I                                        3   4 CARD2                 CCS013
     I                                        5   6 CARD3                 CCS013
     I                                        7   8 CARD4                 CCS013
     I           IDS
     I                                        1  160THAD
     I                                        1   40HARD1                 CCS013
     I                                        5   80HARD2                 CCS013
     I                                        9  120HARD3                 CCS013
     I                                       13  160HARD4                 CCS013
     I           IDS
     I                                        1   4 TTAD
     I                                        1   1 TARD1                 CCS013
     I                                        2   2 TARD2                 CCS013
     I                                        3   3 TARD3                 CCS013
     I                                        4   4 TARD4                 CCS013
     I           IDS
     I                                        1   40TEAD
     I                                        1   10EARD1                 CCS013
     I                                        2   20EARD2                 CCS013
     I                                        3   30EARD3                 CCS013
     I                                        4   40EARD4                 CCS013
     I           IDS
     I                                        1  48 TLAD
     I                                        1  12 LARD1                 CCS013
     I                                       13  24 LARD2                 CCS013
     I                                       25  36 LARD3                 CCS013
     I                                       37  48 LARD4                 CCS013
     ILIBEL      IDS
     I                                        1  40 BLOC1
     I                                        1  19 LIB20
     I                                       41  80 BLOC2
     I                                       81 120 BLOC4
     IDSCOMM      DS
     I                                        1   10YYSTE
     I                                        2   50YYCLI
     I                                       16  190DSPRO
     I                                       22  22 ZONE95
     I                                       24  24 MODIFE
     I                                       40  41 DSGAR
     I                                       42  460DSCNF
     I                                       47  51 DSFOR
     I                                      100 100 Z100
     I                                      101 101 Z101
     I                                      102 102 Z102
     I                                      103 110 ZMDP
     I           IDS
     I                                        1  35 PARM4
     I                                        1   10YAUSIN
     I                                        2   2 YSECT
     I                                        3   3 YSSECT
     I                                        2   3 YAATEL
     I                                        4   5 YNOMAC
     I                                        6  100YACONF
     I                                       11  120YASEQ
     I                                       13  130YAISEQ
     I                                       14  140YSTE
     I                                       15  180YNOCLI
     I                                       19  220YNOPRO
     I                                       23  260YAOPNU
     I                                       27  280YPJJ
     I                                       29  300YPMM
     I                                       31  340YPAA
     I                                       27  340YATEQ
     I                                       35  350YPEQUI
     I            DS
     I                                        1  18 AF1
     I                                        1   2 TYP001
     I                                        3   4 TYP002
     I                                        5   6 TYP003
     I                                        7   8 TYP004
     I                                        9  10 TYP005
     I                                       11  12 TYP006
     I                                       13  14 TYP007
     I                                       15  16 TYP008
     I                                       17  18 TYP009
     I            DS
     I                                        1 270 AF2
     I                                        1  30 LIB001
     I                                       31  60 LIB002
     I                                       61  90 LIB003
     I                                       91 120 LIB004
     I                                      121 150 LIB005
     I                                      151 180 LIB006
     I                                      181 210 LIB007
     I                                      211 240 LIB008
     I                                      241 270 LIB009
     I           IDS
     I                                        1  35 PARM1
     I                                        1   10WWUSIN
     I                                        2   2 WWSECT
     I                                        3   3 WWSSEC
     I                                        4   5 WWMAC
     I                                        6  100WWCONF
     I                                       11  120WWSEQ
     I                                       13  130WWISEQ
     I                                       14  140WWSTE
     I                                       15  180WWCLI
     I                                       19  220WWPRO
     I                                       23  260WWOPNU
     I                                       27  340WWDTEQ
     I                                       35  350WWEQUI
     I           IDS
     I                                        1  18 PARM2
     I                                        1   10VAUSIN
     I                                        2   60VACONF
     I                                        7   80VASEQ
     I                                        9   90VAISEQ
     I                                       10  130VNOPRO
     I                                       14  170VAOPNU
     I                                       18  18 TAGOK
     I           IDS
     I                                        1  18 PARM3
     I                                        1   10TAUSIN
     I                                        2   60TACONF
     I                                        7   80TASEQ
     I                                        9   90TAISEQ
     I                                       10  130TNOPRO
     I                                       14  170TAOPNU
     I                                       18  18 T2207
     I           IDS
     I                                        1  23 PARM6
     I                                        1   10SAUSIN
     I                                        2   60SACONF
     I                                        7   80SASEQ
     I                                        9   90SAISEQ
     I                                       10  130SNOPRO
     I                                       14  170SAOPNU
     I                                       18  18 SPSECT
     I                                       19  19 SSSECT
     I                                       20  21 SNOMAC
     I                                       22  23 SETAOP
     I           IDS
     I                                        1  23 PAS6
     I                                        1   10WAUSIN
     I                                        2   60WACONF
     I                                        7   80WASEQ
     I                                        9   90WAISEQ
     I                                       10  130WNOPRO
     I                                       14  170WAOPNU
     I                                       18  18 WSECT
     I                                       19  19 WSSECT
     I                                       20  21 WNOMAC
     I                                       22  22 WETAT
     IENREG2     IDS
     I                                        1 186 ENR2
     I                                        1   10EBUSIN
     I                                        2   60EBCONF
     I                                        7   80EBSEQ
     I                                        9   90EBSTE
     I                                       10  130EBCLI
     I                                       14  170EBPRO
     I                                       18  18 EBSEC
     I                                       19  19 EBSSEC
     I                                       20  21 EBMAC
     I                                       22  290EBDAT1
     I                                       30  370EBDAT2
     I                                       38  410EBHEUR
     I                                       42  420EBEQU
     I                                       43  430EBPAS
     I                                       44  500EBCOND
     I                                       51  552EBTCAL
     I                                       56  602EBTROU
     I                                       61  652EBTDIV
     I                                       66  660EBEFFC
     I                                       67  670EBEFFR
     I                                       68  740EBQTOT
     I                                       75  810EBQBON
     I                                       82  880EBQRC
     I                                       89  950EBQRR
     I                                       96  97 EBCAD1
     I                                       98  99 EBCAD2
     I                                      100 101 EBCAD3
     I                                      102 103 EBCAD4
     I                                      104 105 EBCAD5
     I                                      106 107 EBCAD6
     I                                       96 107 EBCAD
     I                                      108 1112EBTAD1
     I                                      112 1152EBTAD2
     I                                      116 1192EBTAD3
     I                                      120 1232EBTAD4
     I                                      124 1272EBTAD5
     I                                      128 1312EBTAD6
     I                                      108 131 EBTAD
     I                                      132 1320EBEAD1
     I                                      133 1330EBEAD2
     I                                      134 1340EBEAD3
     I                                      135 1350EBEAD4
     I                                      136 1360EBEAD5
     I                                      137 1370EBEAD6
     I                                      132 137 EBEAD
     I                                      138 138 EBIAD1
     I                                      139 139 EBIAD2
     I                                      140 140 EBIAD3
     I                                      141 141 EBIAD4
     I                                      142 142 EBIAD5
     I                                      143 143 EBIAD6
     I                                      138 143 EBIAD
     I                                      144 145 EBETIQ
     I                                      146 1460EBCOUL
     I                                      147 147 EBTVER
     I                                      148 150 EBCELI
     I                                      151 1570EBQELI
     I                                      158 1620EBOPNU
     I                                      163 164 EBOPST
     I                                      165 165 EBSUP
     I                                      166 166 EBTAG
     I                                      167 168 EBTRSP
     I                                      169 1732EBPOS1
     I                                      174 1782EBPOS2
     I                                      179 1850EBQACO
     I                                      186 1860EBNCAL
     I           IDS
     I                                        1   40HENT                  CCS013
     I                                        1   20XXDEBH                CCS013
     I                                        3   40XXDEBM                CCS013
     I           IDS
     I                                        1   40FAOPNU
     I                                        1   20PRIOR1
     I                                        3   30RANG1
     I                                        4   40PASAGE
     I           IDS
     I                                        1  40 PARM5
     I                                        1   10UUUSIN
     I                                        2   60UUCONF
     I                                        7   80UUSEQ
     I                                        9   90UUISEQ
     I                                       10  130UUPRO
     I                                       14  170UUOPNU
     I                                       18  18 UUSECT
     I                                       19  19 UUSSEC
     I                                       20  21 UUMAC
     I                                       22  250UUAA
     I                                       26  270UUMM
     I                                       28  290UUJJ
     I                                       30  300UUEQUI
     I                                       31  340NNAA
     I                                       35  360NNMM
     I                                       37  380NNJJ
     I                                       39  390NNEQUI
     I                                       40  40 UUOK
     I           IDS
     I                                        1  17 PARM9
     I                                        1   10VVUSI                 CCS013
     I                                        2   60VVCONF                CCS013
     I                                        7   80VVSEQ                 CCS013
     I                                        9   90VVISEQ                CCS013
     I                                       10  130VVPRO                 CCS013
     I                                       14  15 VVETAT                CCS013
     I                                       16  170VVPRIO                CCS013
     I           IDS
     I                                        1  18 PARM13
     I                                        1   10XYUSI                 CCS013
     I                                        2   20XYSTE                 CCS013
     I                                        3   60XYCLI                 CCS013
     I                                        7  100XYPRO                 CCS013
     I                                       11  150XYCONF                CCS013
     I                                       16  170XYSEQ                 CCS013
     I                                       18  18 XYSOLD                CCS013
     I           IDS
     I                                        1  21 PARM14
     I                                        1   10ZZUSI
     I                                        2   2 ZZSECT
     I                                        3   3 ZZSSEC
     I                                        4   5 ZZMAC
     I                                        6  100ZZCONF
     I                                       11  120ZZSEQ                 CCS013
     I                                       13  130ZZISEQ                CCS013
     I                                       14  170ZZPRO                 CCS013
     I                                       18  210ZZOPNU                CCS013
     I           IDS
     I                                        1  39 PARM15
     I                                        1   70ZOTBO
     I                                        8  140ZOTELI
     I                                       15  192ZOTCAL
     I                                       20  242ZOTROU
     I                                       25  292ZOTARR
     I                                       30  342ZOTPAN                CCS013
     I                                       35  392ZOTADI                CCS013
     I           IDS
     I                                        1  31 PARM30
     I                                        1   10XJUSIN
     I                                        2   2 XJSECT
     I                                        3   3 XJSSEC
     I                                        4   5 XJNOMA
     I                                        6  100XJCONF
     I                                       11  120XJSEQ
     I                                       13  130XJISEQ
     I                                       14  170XJPRO
     I                                       18  210XJOPNU
     I                                       22  250XJPPAA
     I                                       26  270XJPPMM
     I                                       28  290XJPPJJ
     I                                       30  300XJEQUI
     I                                       31  310XJNBCA
     I           SDS
     I                                      254 263 WUSER
     *
     IDSPARA      DS                             47
     I I            0                         1   50NCF92
     I I            0                         6   90NOP92
     I I            0                        10  160SURF
     I I            0                        17  203SF
     I I            0                        21  270MINI
     I I            0                        28  340MAXI
     I                                       35  35 EXP
     I I            0                        36  420SURFF
     I I            0                        44  470NOC92
     *
     I            DS
     I                                        1  50 PPOBS
     I                                        1   2 PPOB2
     I                                        4  50 PPOB47
     IDSPARM      DS
     I                                        1   8 TBLNOM
     I                                        9  18 TBVAR
     I                                       19  200LG
     I I            ' '                      81  81 FICH
     *
     IPARMYZ      DS                             30
     I                                        1   10YZUSIN
     I                                        2   60YZCONF
     I                                        7   80YZSEQ                 CCS013
     I                                        9   90YZISEQ                CCS013
     I                                       10  130YZPRO                 CCS013
     I                                       14  14 YZSECT
     I                                       15  15 YZSSEC
     I                                       16  17 YZMAC
     I                                       18  210YZOPNU                CCS013
     I                                       22  230YZJJ                  CCS013
     I                                       24  250YZMM                  CCS013
     I                                       26  290YZAA                  CCS013
     I                                       30  300YZEQUI                CCS013
    C**
    C******  DEFINITION DES ZONES TRAVAIL
    C**
     C           *LIKE     DEFN RCX       SAVRCX
     C           *LIKE     DEFN DH        SAVDH
     C           *LIKE     DEFN RCX       DERRCX
     C           *LIKE     DEFN DATEQ     SAVDEQ
     C           *LIKE     DEFN PPEQUI    SAVEQ
     C           *LIKE     DEFN LIBEQU    SVLIEQ
     C           *LIKE     DEFN PPEQUI    SVEQUI
     C           *LIKE     DEFN FAEVTY    ZAEVTY
     C           *LIKE     DEFN PPORD     SAVORD
     C           *LIKE     DEFN PPORD     SVORD1
     C           *LIKE     DEFN PPORD     ORDRNM
     C           *LIKE     DEFN PPORD     ORDRN1
     C           *LIKE     DEFN PPORD     ORDRN2
     C           *LIKE     DEFN PPORD     ORDSAV
     C           *LIKE     DEFN RCY       SAVRCY
     C           *LIKE     DEFN RCY       SVRCY1
     C           *LIKE     DEFN RCY       DERRCY
     C           *LIKE     DEFN RCY       RCY2
     C           *LIKE     DEFN PPHFIN    TREF
     C           *LIKE     DEFN PPQFEU    TOTFEU
     C           *LIKE     DEFN RCT       SAVRCT
     C           *LIKE     DEFN PPOROB    SAVORB
     C           *LIKE     DEFN PPOBS     SAVOBS
     C           *LIKE     DEFN PPHDEB    SVHDEB
     C           *LIKE     DEFN PPHFIN    SVHFIN
     C           *LIKE     DEFN PPHFIN    SVHFI2
     C           *LIKE     DEFN DATEVE    SVDEVE
     C           *LIKE     DEFN DATEVE    SAVEVE
     C           *LIKE     DEFN PPHDEQ    HDEQ
     C           *LIKE     DEFN PPHFEQ    HFEQ
     C           *LIKE     DEFN PPHDEB    HDEB
     C           *LIKE     DEFN PPHFIN    HFIN
     C           *LIKE     DEFN PPHTIR    TOTTPS
     C           *LIKE     DEFN TOTHRE    SVTHRE
     C           *LIKE     DEFN DATLUE    DATMIN
     C           *LIKE     DEFN DATLUE    DATMAX
     C           *LIKE     DEFN FAOPST    SVOPST
     C           *LIKE     DEFN TOTBON    SVTBON
     C           *LIKE     DEFN TOTBON    TOTEQ
     C           *LIKE     DEFN TOTBON    TOTEQG
     C           *LIKE     DEFN TOTBON    TOTEQD
     C           *LIKE     DEFN TOTBON    TOTEQ2
     C           *LIKE     DEFN FAEVCO    EVCO
     C           *LIKE     DEFN PPHCAL    SVHCAL
     C           *LIKE     DEFN PPHTIR    SVHTIR
     C           *LIKE     DEFN PPHARR    SVHARR
     C           *LIKE     DEFN PPHPAN    SVHPAN
     C           *LIKE     DEFN FA1601    SV1601
     C           *LIKE     DEFN PPCARD    XPCARD
     C           *LIKE     DEFN PPQFMA    SVQFMA
     C           *LIKE     DEFN PPTFIN    SVTFIN
     C           *LIKE     DEFN PPHFRE    PHFRE1
     C           *LIKE     DEFN PPHFEQ    PHFEQ1
     C           *LIKE     DEFN FATRSP    SVTRSP
     C           *LIKE     DEFN PASAGE    SVPASG
     C           *LIKE     DEFN PPHDEQ    SVHDEQ
     C           *LIKE     DEFN PPHFEQ    SVHFEQ
     C           *LIKE     DEFN PPEFFC    SVEFFC
     C           *LIKE     DEFN PPEFFR    SVEFFR
     C           *LIKE     DEFN CMATR     SVMATR
     C           *LIKE     DEFN DATRR     DATJOU
     C           *LIKE     DEFN FAOPNU    YYOPNU
     C           *LIKE     DEFN FATENC    SVTENC
     C           *LIKE     DEFN NOMAC     MACH2
     C           *LIKE     DEFN FAUNIT    WWUNIT
    C**
    C******  DEFINITION DES CLES
    C**
     C           KEYUSI    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     C           KCLI01    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C           KIMP2     KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           KEYPRO    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           KEYAMA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           ORD
     C           KMAC02    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C           KTRASP    KLIST
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           MACH2
     C                     KFLD           FATRSP
     C           KPRFOU    KLIST
     C                     KFLD           XYUSI
     C                     KFLD           XYSTE
     C                     KFLD           XYCLI
     C                     KFLD           XYPRO
     C                     KFLD           XYCONF
     C                     KFLD           XYSEQ
     C           KCAL01    KLIST
     C                     KFLD           CALSS
     C                     KFLD           CALAA
     C                     KFLD           CALMM
     C                     KFLD           CALJJ
     C           KCAL02    KLIST
     C                     KFLD           CALSS
     C                     KFLD           CALAA
     C                     KFLD           CALMM
     C                     KFLD           CALJJ
     C           KFAB03    KLIST
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           FAEVCO
     C           KFAB3A    KLIST
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C           KFAB3B    KLIST
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           FAEVTY
     C                     KFLD           FAEVCO
     C           KFAB3C    KLIST
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           FAEVTY
     C           KFAB04    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           CMATR
     C           KFAB05    KLIST
     C                     KFLD           USINE
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C           KFAB5A    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C           KFAB5B    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAAFA
     C                     KFLD           FAMFA
     C                     KFLD           FAJFA
     C                     KFLD           FAHFA
     C           KFAB5C    KLIST
     C                     KFLD           USINE
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C           KFAB5D    KLIST
     C                     KFLD           USINE
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C           KFAB10    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           FACBPA
     C                     KFLD           NOBOU
     C           KFA10A    KLIST
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FATENC
     C                     KFLD           YYOPNU
     C                     KFLD           FACBPA
     C                     KFLD           NOBOU
     C           KFA10B    KLIST
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FATENC
     C           KFAB11    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     C                     KFLD           FOUB
     C                     KFLD           FACBPA
     C           KFAB13    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FAEFC
     C                     KFLD           FATENC
     C           KFA13A    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FAEFC
     C           KFAB15    KLIST
     C                     KFLD           USINE
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAISEQ
     C                     KFLD           FAOPNU
     C           KFAB16    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C           KFA16A    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C           KFA16B    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C           KFA16C    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C           KFAB17    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPFAA
     C                     KFLD           PPFMM
     C                     KFLD           PPFJJ
     C                     KFLD           PPORD
     C           KFA17A    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPORD
     C           KFA17B    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPFAA
     C                     KFLD           PPFMM
     C                     KFLD           PPFJJ
     C                     KFLD           PPHDEB
     C                     KFLD           PPHFIN
     C           KFA17C    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C           KFA17D    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPORD
     C           KFA17E    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C           KFA17F    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPFAA
     C                     KFLD           PPFMM
     C                     KFLD           PPFJJ
     C                     KFLD           PPHDEB
     C                     KFLD           PPORD
     C           KFAB18    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           XPCARD
     C           KFAB19    KLIST
     C                     KFLD           USINE
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           FAISEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAOPNU
     C                     KFLD           PPAA
     C                     KFLD           PPMM
     C                     KFLD           PPJJ
     C                     KFLD           PPEQUI
     C                     KFLD           PPOROB
     C           KPREOP    KLIST
     C                     KFLD           USINE
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
     C                     KFLD           NOPRO
     C                     KFLD           FAISEQ
     C                     KFLD           FAOPNU
     C           KRESLD    KLIST
     C                     KFLD           FACONF
     C                     KFLD           NOPRO
     C                     KFLD           FASEQ
     C                     KFLD           PRIORI
     C                     KFLD           RANG    20
     C                     KFLD           PASAGE
     C           KLAN01    KLIST
     C                     KFLD           FACONF
     C                     KFLD           NOPRO
     C                     KFLD           FASEQ
     C                     KFLD           PRIORI
     C           KCDESL    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           FACONF
     C                     KFLD           NOPRO
     *
     C           KFABGO    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           FACONF
     C                     KFLD           FASEQ
    C**                   KFLD           SECT
    C**                   KFLD           SSECT
    C**                   KFLD           NOMAC
    C**                   KFLD           PPEQUI
    C**
    C******  RECEPTION DES PARAMETRES
    C**
     C           *ENTRY    PLIST
     C           PAS1      PARM PAS1      PAS1   35
     C                     MOVE PAS1      PARM1
    C**
    C******  SI USINE = ROCHE,TOURU,NEUVI,CHABA ==> ZONES COMPTEURS
    C******         NON AFFICHABLES  INDICATEUR 30=ON
    C**
D1  C           WWUSIN    IFEQ 2
    C           WWUSIN    OREQ 3
    C           WWUSIN    OREQ 4
    C           WWUSIN    OREQ 5
     C                     MOVE *ON       *IN30
X1  C                     ELSE
     C                     MOVE *OFF      *IN30
F1  C                     ENDIF
    C**
     C                     EXSR GESFEN
    C**
     C                     Z-ADDWWUSIN    USINE
     C                     MOVE WWSECT    SECT
     C                     MOVE WWSSEC    SSECT
     C                     MOVE WWMAC     NOMAC
     C                     Z-ADDWWCONF    FACONF
     C                     Z-ADDWWSEQ     FASEQ
     C                     Z-ADDWWISEQ    FAISEQ
     C                     Z-ADDWWSTE     STE
     C                     Z-ADDWWCLI     NOCLI
     C                     Z-ADDWWPRO     NOPRO
     C                     Z-ADDWWOPNU    FAOPNU
    C**
    C******  LECTURE USINE
    C**
     C                     MOVE 'USDE'    PXARGU
     C                     MOVE USINE     PXVALE
     C                     MOVE *BLANKS   PXLIBE
     C                     MOVE *BLANKS   LIBUS1
     C           KEYUSI    CHAINPARAMEF1             99
D1  C           *IN99     IFEQ *OFF
     C                     MOVE PXLIBE    LIBUS1
X1  C                     ELSE
     C                     MOVEL'INCONNU' LIBUS1
F1  C                     ENDIF
    C**
    C******  SI FAOPNU = 0  ==> CREATION D'UNE ÉQUIPE AVEC CHOIX FAOPNU
    C**
D1  C           FAOPNU    IFEQ 0
    C**
     C                     MOVEA'1000'    *IN,55
     C                     WRITEF08B
     C                     Z-ADD0         RCU
     C                     SETOF                     55
    C**
     C           KFAB05    SETLLXFAB05
D2  C                     DO   *HIVAL
     C           KFAB5D    READEXFAB05                   58
D3  C           *IN58     IFEQ *ON
D4  C           RCU       IFGT 7
     C                     Z-ADD1         RCU
F4  C                     ENDIF
     C                     LEAVE
F3  C                     ENDIF
    C**
     C                     ADD  1         RCU
     C           KMAC02    CHAINMACHIN               99
D3  C           *IN99     IFEQ *ON
     C                     MOVE *BLANK    TITETE
     C                     MOVEL'INCONNU' TITETE
F3  C                     ENDIF
     C                     WRITEF08A
F2  C                     ENDDO
    C**
     C                     SETON                     57
     C           RCU       COMP 0                    56
    C**
     C           AF08A     TAG
     C                     EXFMTF08B
    C**
    C           *IN12     CABEQ'1'       FIN
    C**
     C           KFAB05    CHAINXFAB05               99
    C           *IN99     CABEQ*ON       AF08A
     C                     MOVE SECT      WWSECT
     C                     MOVE SSECT     WWSSEC
     C                     MOVE NOMAC     WWMAC
     C                     MOVE FAUNIT    WWUNIT
F1  C                     ENDIF
     **
     ******  TEST SI OP=2206 ET TANDEM CREATION EQUIPE IMPOSSIBLE
     **
    C**
    C******  RECUP DU CODE TANDEM DS PREACOP
    C**
     C           KPREOP    CHAINPREACOPF             99
D1  C           *IN99     IFEQ *ON
     C                     Z-ADD0         TANDEM
F1  C                     ENDIF
     **
D1  C           USINE     IFEQ 2
    C           TANDEM    ANDEQ1
    C           FAATEL    ANDEQ'22'
    C           NOMAC     ANDEQ'06'
    C                     GOTO AF08A
F1  C                     ENDIF
    C**
    C******  LECTURE MACHINE
    C**
     C           KMAC02    CHAINMACHIN               99
D1  C           *IN99     IFEQ *ON
     C                     MOVE *BLANK    TITETE
     C                     MOVEL'INCONNU' TITETE
F1  C                     ENDIF
    C**
    C******  LECTURE CLIENT
    C**
     C                     MOVE *BLANK    ABRCLI
D1  C           STE       IFNE 0
     C           KCLI01    CHAINCLIENTS1             99
D2  C           *IN99     IFEQ *ON
     C                     MOVEL'INCONNU' ABRCLI
F2  C                     ENDIF
     **
     ******  LECTURE PRE-IMPRIME STOCKE SI STE=0
     **
X1  C                     ELSE
     C                     CLEARLIBEL
     C           KIMP2     CHAINPREIMP2              99
D2  C           *IN99     IFEQ *ON
     C                     MOVEL'INCONNU' ABRCLI
X2  C                     ELSE
     C                     MOVEL'STOCKE'  ABRCLI
     C                     MOVELDPRIMP    BLOC1
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  LECTURE PRODUIT
    C**
D1  C           STE       IFNE 0
     C                     CLEARLIBEL
     C           KEYPRO    CHAINPRODAL8              99
D2  C           *IN99     IFEQ *ON
    C**
     C           KIMP2     CHAINPRODSTF2             99
D3  C           *IN99     IFEQ *ON
     C                     MOVE *BLANK    LIB20
     C                     MOVEL'INCONNU' LIB20
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  LECTURE ARTICLE PRODUIT SI AMALGAMME
    C**
     C                     MOVE *BLANKS   REFCO
     C                     MOVE *OFF      *IN56
D1  C           FAORDA    IFNE 0
     C                     MOVE FAORDA    ORD
     C           KEYAMA    CHAINCODBARF1             99
     C                     MOVE *ON       *IN56
X1  C                     ELSE
     C                     MOVE *OFF      *IN56
F1  C                     ENDIF
    C**
    C******  LECTURE ETAT OP ET LIBELLE
    C**
     C           KFAB05    CHAINXFAB05               99
     C           FAOPST    CHAINXFAB08               99
    C**
     C           XSFIC     TAG
     C                     SETOF                     90
     C                     MOVEA'100'     *IN,70
     C                     WRITEF07
     C                     Z-ADD0         RCX
     C                     Z-ADD0         SAVRCX
     C                     Z-ADD0         DERRCX
     C                     Z-ADD0         DATEQ
     C                     Z-ADD0         PPEQUI
     C                     Z-ADD0         SAVDEQ
     C                     Z-ADD0         SAVEQ
    C**
     C                     Z-ADD0         TOTCAL
     C                     Z-ADD0         TOTROU
     C                     Z-ADD0         TOTARR
     C                     Z-ADD0         TOTBON
     C                     Z-ADD0         TOTREB
    C**
     C                     SETOF                     70
     C           KFAB16    SETLLXFAB16
    C**
    C****** REMPLISSAGE DU SOUS-FICHIER
    C**
     C           XAB       TAG
     C           KFA16A    READEXFAB16              N  8590
D1  C           *IN90     IFEQ *ON
D2  C           RCX       IFGT 0
     C                     Z-ADD1         RCX
F2  C                     ENDIF
    C                     GOTO XUITE
F1  C                     ENDIF
     **
     C                     ADD  1         RCX
     C                     Z-ADDRCX       SAVRCX
     C                     Z-ADDRCX       DERRCX
     C                     Z-ADD0         CHOIX2
     C                     Z-ADDDATEQ     SAVDEQ
     C                     Z-ADDPPEQUI    SAVEQ
     C                     ADD  PPHCAL    TOTCAL
     C                     ADD  PPHTIR    TOTROU
     C                     ADD  PPHARR    TOTARR
     **
     C                     Z-ADDPPQFMA    SVQFMA
D1  C           FA1601    IFEQ 'T'
     C                     Z-ADDPPQFEU    PPQBON
D2  C           PPHTIR    IFNE 0
     C           PPQBON    DIV  PPHTIR    CADENC    H
X2  C                     ELSE
     C                     Z-ADD0         CADENC
F2  C                     ENDIF
     C           PPQFMA    ADD  PPGACA    PPQREB
     C                     ADD  PPQFEU    TOTBON
D2  C           TOTROU    IFNE 0
     C           TOTBON    DIV  TOTROU    TOTCAD    H
X2  C                     ELSE
     C                     Z-ADD0         TOTCAD
F2  C                     ENDIF
     C                     ADD  PPQFMA    TOTREB
     C                     ADD  PPGACA    TOTREB
X1  C                     ELSE
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     PPQBON
D2  C           PPHTIR    IFNE 0
     C           PPQBON    DIV  PPHTIR    CADENC    H
X2  C                     ELSE
     C                     Z-ADD0         CADENC
F2  C                     ENDIF
     C                     Z-ADDTOTEQ2    PPQREB
     C                     ADD  TOTEQ     TOTBON
D2  C           TOTROU    IFNE 0
     C           TOTBON    DIV  TOTROU    TOTCAD    H
X2  C                     ELSE
     C                     Z-ADD0         TOTCAD
F2  C                     ENDIF
     C                     ADD  TOTEQ2    TOTREB
D2  C           FAATEL    IFEQ '82'
    C           USINE     ANDNE3
    C           USINE     ANDNE5
    C           USINE     ANDNE2
    C           USINE     ANDNE4
    C           USINE     ANDNE7
    C           FAATEL    OREQ '83'
    C           USINE     ANDNE3
    C           USINE     ANDNE5
    C           USINE     ANDNE2
    C           USINE     ANDNE4
    C           USINE     ANDNE7
    C           FAATEL    OREQ '70'
    C           USINE     ANDNE3
    C           USINE     ANDNE5
    C           USINE     ANDNE2
    C           USINE     ANDNE4
    C           USINE     ANDNE7
     C                     Z-ADDPPQFEU    PPQBON
D3  C           PPHTIR    IFNE 0
     C           PPQBON    DIV  PPHTIR    CADENC    H
X3  C                     ELSE
     C                     Z-ADD0         CADENC
F3  C                     ENDIF
     C                     ADD  PPQFEU    TOTBON
D3  C           TOTROU    IFNE 0
     C           TOTBON    DIV  TOTROU    TOTCAD    H
X3  C                     ELSE
     C                     Z-ADD0         TOTCAD
F3  C                     ENDIF
     C           PPQFMA    ADD  PPGACA    PPQREB
     C                     ADD  PPQFMA    TOTREB
     C                     ADD  PPGACA    TOTREB
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  SI GACHE MEMORISÉE DANS FAB16P > A CELLE RECALCULÉE
    C******       AFFICHAGE DE CELLE DU FAB16P
    C**
D1  C           SVQFMA    IFGT PPQREB
     C                     Z-ADDSVQFMA    PPQREB
F1  C                     ENDIF
     **
     ****** EST-CE QUE LE TRAVAIL EST COMMENCE?
     **
D1  C           FA1601    IFNE 'T'
     C           KFAB16    CHAINXFAB17              N99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE 'E'       FA1601
F2  C                     ENDIF
F1  C                     ENDIF
     **
     ****** L'OP EST ELLE INTERROMPUE?
     **
D1  C           PPTFIN    IFEQ 'I'
    C           FA1603    OREQ 'I'
     C                     MOVE 'I'       STOP
X1  C                     ELSE
     C                     MOVE *BLANK    STOP
F1  C                     ENDIF
     **
     ****** LECTURE NOM CONDUCTEUR DS FAB04P
     **
     C                     MOVE *BLANK    NOMPRE
     C           KFAB04    CHAINXFAB04               99
D1  C           *IN99     IFEQ *ON
     C                     MOVEL'INCONNU' NOMPRE
F1  C                     ENDIF
     **
     ******  RECHERCHE SI REPIQUAGE
     ******  OFFSET : OP 6261(1ER PASSAGE) ET 6271 (2EME PASSAGE)
     ******  FLEXO  : OP 3151(1ER PASSAGE) ET 3161 (2EME PASSAGE)
     **
     C                     MOVE 'N'       TAGOK
D1  C           FAATEL    IFEQ '12'
    C           FAATEL    OREQ '14'
     C                     Z-ADDUSINE     WAUSIN
     C                     Z-ADDFACONF    WACONF
     C                     Z-ADDFASEQ     WASEQ
     C                     Z-ADDFAISEQ    WAISEQ
     C                     Z-ADDNOPRO     WNOPRO
     C                     Z-ADDFAOPNU    WAOPNU
     C                     MOVE 'N'       TAGOK
     C                     CALL 'FAB580£'              85
     C           PARM2     PARM PARM2     PARM2
     **
D2  C           TAGOK     IFEQ 'O'
     C                     Z-ADD2         PPPAS
F2  C                     ENDIF
     **
F1  C                     ENDIF
     **
     ******  SI ROCHECHOUART COMPLEXEUSE EN TANDEM => FORCER EN 2206
     ******  SAISIE SUR 1303 MAIS MAJ SORTIE PAPIER 2206
     ******  SI TANDEM : TAGOK='O'
     **
     C                     MOVE 'N'       T2207
D1  C           USINE     IFEQ 2
    C           FAATEL    ANDEQ'13'
    C           NOMAC     ANDEQ'03'
     C                     Z-ADDUSINE     VAUSIN
     C                     Z-ADDFACONF    VACONF
     C                     Z-ADDFASEQ     VASEQ
     C                     Z-ADDFAISEQ    VAISEQ
     C                     Z-ADDNOPRO     VNOPRO
     C                     Z-ADDFAOPNU    VAOPNU
     C                     MOVE 'N'       T2207
     C                     CALL 'FAB603£'              85
     C           PARM3     PARM PARM3     PARM3
     **
    C*****  SI TANDEM COMPLEXE FAOPNU CELUI DE LA 1303
D2  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PPPAS
F2  C                     ENDIF
    C**
F1  C                     ENDIF
    C**
    C******  SI DATE ET N° EQUIPE RENSEIGNES => POSITION SUR LA LIGNE
    C**
D1  C           DATEQ     IFEQ WWDTEQ
    C           PPEQUI    ANDEQWWEQUI
     C                     Z-ADD1         CHOIX2
F1  C                     ENDIF
    C**
     C                     WRITEF06
    C                     GOTO XAB
    C**
    C****** AFFICHAGE DU FORMAT DE CONTROLE F07
    C**
     C           XUITE     TAG
    C**
    C******  RECHERCHE NATURE DE COMMANDE CLIENT
    C**
     C                     MOVE *BLANK    NATCDE
     C                     MOVEL*BLANK    LNATCD
     C                     MOVE '0'       *IN22
     C           KCDESL    CHAINCDESLC               99
D1  C           *IN99     IFEQ '0'
     C                     MOVE 'NCDE'    PXARGU
     C                     MOVE STOND     PXVALE    P
     C           KEYUSI    CHAINPARAME               99
D2  C           *IN99     IFEQ '0'
     C                     MOVE PXVALE    NATCDE
     C                     MOVELPXLIBE    LNATCD
F2  C                     ENDIF
X1  C                     ELSE
     C                     MOVE '1'       *IN22
F1  C                     ENDIF
    C**
    C******  RECHERCHE LIBELLE ET CODE DE GESTION DE L'OF
    C**
     C                     MOVE *BLANKS   LCODGO
     C                     MOVE *BLANKS   CODGOF
     C           KFABGO    CHAINFABGOFL3             99
D1  C           *IN99     IFEQ '0'
     C                     MOVE 'CGES'    PXARGU
     C                     MOVE CODGOF    PXVALE    P
     C                     MOVE *BLANKS   PXLIBE
     C           KEYUSI    CHAINPARAMEF1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVELPXLIBE    LCODGO
F2  C                     ENDIF
F1  C                     ENDIF
     *
     C                     MOVE '0'       *IN21
D1  C           CODGOF    IFNE 'D'
     C                     MOVE '1'       *IN21
F1  C                     ENDIF
     *
    C**
    C******  RECHERCHE MINI MAXI
    C**
     C                     EXSR MINMAX
     C                     WRITEF05
     C                     SETON                     72
     C           RCX       COMP 0                    71
    C**
D1  C           RCX       IFEQ 0
    C           WWOPNU    ANDEQ0
     C                     EXSR CREEQ
    C           *IN12     CABEQ'1'       FIN
     C                     MOVE *OFF      *IN35
     C                     MOVE *OFF      *IN39
     C                     MOVE *OFF      *IN38
     C                     MOVE *BLANK    LIBFIN
     C                     EXSR OPERA
    C**
     C           KFAB16    CHAINXFAB22               99
D2  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
     C                     EXFMTF07
    C**
D1  C           *IN12     IFEQ *ON
     C                     MOVE *ON       *IN03
     C                     EXSR GESFEN
    C                     GOTO FIN
F1  C                     ENDIF
    C**
    C****** F1=ECRAN AIDE
    C**
D1  C           *IN01     IFEQ *ON
     C                     EXFMTF09
    C                     GOTO XUITE
F1  C                     ENDIF
    C**
    C****** F6=CREATION NOUVELLE EQUIPE => TEST STATUS OP SI POSSIBLE
    C******    SI EQUIPE PRECEDENTE NON TERMINEE => NLLE EQUIPE IMPOSSIBLE
    C**
D1  C           *IN06     IFEQ *ON
     **
     C                     EXSR CREEQ
    C           *IN12     CABEQ*ON       XUITE
     C                     MOVE *OFF      *IN35
     C                     MOVE *OFF      *IN39
     C                     MOVE *OFF      *IN38
     C                     MOVE *BLANK    LIBFIN
     C                     EXSR OPERA
    C**
     C           KFAB16    CHAINXFAB22               99
D2  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C****** LECTURE DU SOUS-FICHIER F06
    C**
     C           XEXT      TAG
     C                     READCF06                    8981
    C           *IN89     CABEQ*ON       XUITE
    C           *IN81     CABEQ*ON       XSFIC
    C**
     C                     MOVE *OFF      *IN36
     C                     MOVE *OFF      *IN95
    C**
    C******  OPTION 1=SAISIE DES EVENEMENTS SUR UNE OP
    C**
D1  C           CHOIX2    IFEQ 1
     C                     Z-ADD0         CHOIX2
     C                     UPDATF06
    C**
    C******  MAJ DU FICHIER FAB22P : EQUIPE EN COURS DE MODIFICATION
    C**
     C           KFAB16    CHAINXFAB22               9985
    C**
    C******  TEST SI ENREGISTREMENT VERROUILLE
    C**
D2  C           *IN85     IFEQ *ON
     C                     CALL 'FAB609£'
    C                     GOTO XUITE
F2  C                     ENDIF
    C**
     C                     MOVE 'T'       FA2201
     C                     MOVE 'T'       FA2202
     C                     MOVE ' '       FA2203
     C                     TIME           HEUR14 140
D2  C           *IN99     IFEQ *ON
     C                     WRITEXFAB22
X2  C                     ELSE
     C                     SETON                     44
    C                     GOTO XEXT
     C                     UNLCKFAB22L01
F2  C                     ENDIF
    C**
     C           KFAB16    CHAINXFAB16              N99
D2  C           FA1601    IFEQ 'T'
     C                     MOVE LIBF,2    LIBFIN
     C                     MOVE *OFF      *IN39
     **
X2  C                     ELSE
     **
     C                     MOVE *BLANKS   LIBFIN
     C                     MOVE *OFF      *IN39
F2  C                     ENDIF
     **
D2  C           PPHFRE    IFGT 0
     C                     MOVE *ON       *IN38
     C                     MOVE LIBF,2    LIBFIN
X2  C                     ELSE
     C                     MOVE *OFF      *IN38
F2  C                     ENDIF
     C                     EXSR OPERA
    C**
D2  C           *IN12     IFEQ *ON
     C           KFAB16    CHAINXFAB22               99
D3  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C******  OPTION 2=MODIFICATIONS DONNEES EQUIPE
    C**
D1  C           CHOIX2    IFEQ 2
     C           KFAB15    CHAINXFAB15              N99
     C           KFAB04    CHAINXFAB04               99
    C**
     C           AF98      TAG
     C                     EXFMTF98
    C**
    C******  F4=RECHERCHE CONDUCTEUR OU CODE TRAVAIL SPECIAL
    C******     EN FONCTION DU POSITIONNEMENT DANS LA LIGNE
    C**
D2  C           *IN04     IFEQ *ON
     C                     Z-ADDUSINE     ZUSI
     C                     MOVE SECT      ZSECT
     C                     MOVE SSECT     ZSSECT
     C                     MOVE NOMAC     ZNOMAC
     C                     MOVE '10'      LIGNE
     C                     MOVE *BLANKS   PAS5
     C                     MOVE *BLANKS   PAS2
     C                     MOVE P1        PAS3
     C                     CALL 'FEN502£'              85
     C           PAS5      PARM PAS5      PAS5
     C           INDIC     PARM INDIC     INDIC
     C           LIGNE     PARM LIGNE     LIGNE
     C           PAS2      PARM PAS2      PAS2
     C           PAS3      PARM PAS3      PAS3
    C**
     C                     MOVE PAS5      CMATR
     C                     MOVE PAS2      NOMPRE
    C**
     C                     WRITEF98
    C                     GOTO AF98
F2  C                     ENDIF
    C**
D2  C           *IN12     IFEQ *OFF
    C**
D3  C           FATRSP    IFNE *BLANKS
     C                     MOVE NOMAC     MACH2
    C**   CAS PARTICULIER DE L'ONDULEUSE 3/8
D4  C           USINE     IFEQ 3
    C           FAATEL    ANDEQ'21'
    C           NOMAC     ANDEQ'38'
     C                     MOVE '03'      MACH2
F4  C                     ENDIF
     C           KTRASP    CHAINTRASPEF1             41
    C           *IN41     CABEQ*ON       AF98
F3  C                     ENDIF
    C**
     C           KFAB04    CHAINXFAB04               42
    C           *IN42     CABEQ*ON       AF98
    C**
     C                     MOVE PPHDEQ    SVHDEQ
     C                     MOVE PPHFEQ    SVHFEQ
     C                     Z-ADDPPEFFC    SVEFFC
     C                     Z-ADDPPEFFR    SVEFFR
     C                     Z-ADDCMATR     SVMATR
     C           KFAB16    CHAINXFAB16               9985
    C**
    C******  TEST SI ENREGISTREMENT VERROUILLE
    C**
D3  C           *IN85     IFEQ *ON
     C                     CALL 'FAB609£'
    C                     GOTO XSFIC
F3  C                     ENDIF
    C**
D3  C           *IN99     IFEQ *OFF
     C                     MOVE SVHDEQ    PPHDEQ
     C                     MOVE SVHFEQ    PPHFEQ
     C                     Z-ADDSVEFFC    PPEFFC
     C                     Z-ADDSVEFFR    PPEFFR
     C                     Z-ADDSVMATR    CMATR
     C                     EXCPTMAJ16B
F3  C                     ENDIF
    C**
     C                     MOVE FATRSP    SVTRSP
     C           KFAB15    CHAINXFAB15               99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE SVTRSP    FATRSP
     C                     EXCPTMAJ15
F3  C                     ENDIF
    C******  DEBRANCHEMENT VERS LA MODIF ==> AVEC OBLIGATION
    C******       DE VALIDER LES MODIFS EN VALIDANT LE BILAN
    C**
    C** SI 95=ON OBLIGATION DE VALIDER PAR F10
     C                     MOVE *ON       *IN95
    C******  MAJ DU FICHIER FAB22P : EQUIPE EN COURS DE MODIFICATION
    C**
     C           KFAB16    CHAINXFAB22               99
     C                     MOVE 'T'       FA2201
     C                     MOVE 'T'       FA2202
     C                     MOVE ' '       FA2203
     C                     TIME           HEUR14 140
D3  C           *IN99     IFEQ *ON
     C                     WRITEXFAB22
X3  C                     ELSE
     C                     UPDATXFAB22
F3  C                     ENDIF
    C**
     C           KFAB16    CHAINXFAB16              N99
D3  C           FA1601    IFEQ 'T'
     C                     MOVE LIBF,2    LIBFIN
     C                     MOVE *OFF      *IN39
     **
X3  C                     ELSE
     **
     C                     MOVE *BLANKS   LIBFIN
     C                     MOVE *OFF      *IN39
F3  C                     ENDIF
     **
D3  C           PPHFRE    IFGT 0
     C                     MOVE *ON       *IN38
     C                     MOVE LIBF,2    LIBFIN
X3  C                     ELSE
     C                     MOVE *OFF      *IN38
F3  C                     ENDIF
     C                     EXSR OPERA
    C**
D3  C           *IN12     IFEQ *ON
     C           KFAB16    CHAINXFAB22               99
D4  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F4  C                     ENDIF
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C******  OPTION 4=SUPPRESSION EQUIPE SLT SI NON COMMENCEE
    C**
D1  C           CHOIX2    IFEQ 4
    C**  TEST SUPPRIME , SUPPRESSION POSSIBLE MEME SI TERMIME
    C******     FA1601    CABNE*BLANK    XUITE      4343
    C**  TEST S'IL Y A ENCORE DES EVENEMENTS
     C                     Z-ADD0         PPFAA
     C                     Z-ADD0         PPFMM
     C                     Z-ADD0         PPFJJ
     C                     Z-ADD0         PPORD
     C           KFAB16    CHAINXFAB17               99
    C**  TEST SI RIEN N'A ÉTÉ FAIT AUX MATIERES
     C                     Z-ADD0         FACBPA
     C                     Z-ADD0         NOBOU
     C   99      KFAB16    CHAINXFAB10               99
     C   99      KFAB16    CHAINZFAB10               99
     C                     MOVE *BLANKS   PAPI
     C                     Z-ADD0         GRAMM
     C                     MOVE *BLANKS   REFOUR
     C                     Z-ADD0         GRAREL
     C                     MOVE *BLANKS   FOUB
     C                     Z-ADD0         FACBPA
     C                     Z-ADD0         BOUCH2
     C   99      KFAB16    CHAINXFAB11               99
     C   99      KFAB16    CHAINZFAB11               99
    C**
D2  C           *IN99     IFEQ *OFF
     C                     SETON                     43
    C                     GOTO XUITE
F2  C                     ENDIF
    C**
     C           RELE16    TAG
     C           KFAB16    CHAINXFAB16               9985
    C**
    C******  TEST SI ENREGISTREMENT VERROUILLE
    C**
D2  C           *IN85     IFEQ *ON
     C                     CALL 'FAB609£'
    C                     GOTO RELE16
F2  C                     ENDIF
    C**
D2  C           *IN99     IFEQ *OFF
     C                     DELETXFAB16
F2  C                     ENDIF
    C**
     C                     EXSR MAJSUP
    C**
     C           KFAB16    CHAINXFAB22               99
D2  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C******  OPTION 7=CHANGEMENT DATE OU NUMERO D'EQUIPE
    C**
D1  C           CHOIX2    IFEQ 7
    C**
     C                     Z-ADDDATEQ     NDATEQ
     C                     Z-ADDPPEQUI    NNEQUI
    C**
     C           AF97      TAG
     C                     EXFMTF97
    C**
    C           *IN12     CABEQ*ON       XSFIC
    C**
    C******  TEST SI L'UNE DES 2 ZONES A ÉTÉ MODIFIÉE
    C**
D2  C           DATEQ     IFEQ NDATEQ
    C           PPEQUI    ANDEQNNEQUI
     C                     SETON                     42
    C                     GOTO AF97
F2  C                     ENDIF
    C**
     C                     Z-ADDJJNN      CALJJ
     C                     Z-ADDMMNN      CALMM
     C                     MOVELAANN      CALSS
     C                     MOVE AANN      CALAA
     C           KCAL01    CHAINCALENDF1             40
    C           *IN40     CABEQ*ON       AF97
    C**
    C           NNEQUI    CABLE0         AF97         4141
    C           NNEQUI    CABGT3         AF97       41
    C**
     C                     Z-ADDUSINE     UUUSIN
     C                     Z-ADDFACONF    UUCONF
     C                     Z-ADDFASEQ     UUSEQ
     C                     Z-ADDFAISEQ    UUISEQ
     C                     Z-ADDNOPRO     UUPRO
     C                     Z-ADDFAOPNU    UUOPNU
     C                     MOVE SECT      UUSECT
     C                     MOVE SSECT     UUSSEC
     C                     MOVE NOMAC     UUMAC
     C                     Z-ADDPPAA      UUAA
     C                     Z-ADDPPMM      UUMM
     C                     Z-ADDPPJJ      UUJJ
     C                     Z-ADDAANN      NNAA
     C                     Z-ADDMMNN      NNMM
     C                     Z-ADDJJNN      NNJJ
     C                     MOVE PPEQUI    UUEQUI
     C                     MOVE ' '       UUOK
     C                     CALL 'FAB613£'              85
     C           PARM5     PARM PARM5     PARM5
     **
    C           UUOK      CABEQ'N'       AF97           42
    C**
    C******  SUPPRESSION DANS HISTOFA2
    C**
     C                     EXSR MAJSU2
    C**
    C******  DEBRANCHEMENT VERS LA MODIF ==> AVEC OBLIGATION
    C******       DE VALIDER LES MODIFS EN VALIDANT LE BILAN
    C**
    C** SI 95=ON OBLIGATION DE VALIDER PAR F10
     C                     MOVE *ON       *IN95
    C******  MAJ DU FICHIER FAB22P : EQUIPE EN COURS DE MODIFICATION
    C**
     C                     Z-ADDAANN      PPAA
     C                     Z-ADDMMNN      PPMM
     C                     Z-ADDJJNN      PPJJ
     C                     MOVE NNEQUI    PPEQUI
     C           KFAB16    CHAINXFAB22               99
     C                     MOVE 'T'       FA2201
     C                     MOVE 'T'       FA2202
     C                     MOVE ' '       FA2203
     C                     TIME           HEUR14 140
D2  C           *IN99     IFEQ *ON
     C                     WRITEXFAB22
X2  C                     ELSE
     C                     UPDATXFAB22
F2  C                     ENDIF
    C**
     C           KFAB16    CHAINXFAB16              N99
D2  C           FA1601    IFEQ 'T'
     C                     MOVE LIBF,2    LIBFIN
     C                     MOVE *OFF      *IN39
     **
X2  C                     ELSE
     **
     C                     MOVE *BLANKS   LIBFIN
     C                     MOVE *OFF      *IN39
F2  C                     ENDIF
     **
D2  C           PPHFRE    IFGT 0
     C                     MOVE *ON       *IN38
     C                     MOVE LIBF,2    LIBFIN
X2  C                     ELSE
     C                     MOVE *OFF      *IN38
F2  C                     ENDIF
     C                     EXSR OPERA
    C**
D2  C           *IN12     IFEQ *ON
     C           KFAB16    CHAINXFAB22               99
D3  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C******  OPTION 9=MODIF DES STATUS DU TRAVAIL : EVENEMENTS/MATIERE
    C**
D1  C           CHOIX2    IFEQ 9
     C                     Z-ADD0         CHOIX2
     C                     UPDATF06
     C           KFAB16    CHAINXFAB16               9985
    C******  TEST SI ENREGISTREMENT VERROUILLE
D2  C           *IN85     IFEQ *ON
     C                     CALL 'FAB609£'
    C                     GOTO XSFIC
F2  C                     ENDIF
     C                     MOVE FA1601    SV1601
     C                     EXFMTF13
     **
D2  C           *IN12     IFEQ *ON
     C                     UNLCKFAB16L01
    C                     GOTO XSFIC
F2  C                     ENDIF
     **
     C                     EXCPTMAJ16
     **
D2  C           SV1601    IFEQ 'T'
    C           FA1601    ANDEQ' '
     C           KFAB5C    CHAINZFAB05               99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      FAOPST
     C                     MOVE ' '       FA0501
     C                     UPDATZFAB05
     C                     EXSR COMPLX
F3  C                     ENDIF
F2  C                     ENDIF
    C**
    C******  MAJ RESTPS => SOBESO = ' ' OP EN COURS
    C**
     C                     Z-ADDPASAGE    SVPASG
D2  C           FAOPST    IFEQ 'EC'
     C                     Z-ADDPRIOR1    PRIORI
     C           10        SUB  RANG1     RANG
    C*****  SI TANDEM COMPLEXE TOUJOURS 1ER PASSAGE
D3  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PASAGE
F3  C                     ENDIF
     C           KRESLD    CHAINRESTPSLD             99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       SOBESO
     C                     EXCPTRESTF1
F3  C                     ENDIF
F2  C                     ENDIF
     C                     Z-ADDSVPASG    PASAGE
     **
     ******  MAJ PRLANC => OFETA = 'EC' OP EN COURS
     **
D2  C           FAOPST    IFEQ 'EC'
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      OFETA
     C                     EXCPTMAJLAN
F3  C                     ENDIF
F2  C                     ENDIF
     **
    C                     GOTO XSFIC
F1  C                     ENDIF
    C**
    C                     GOTO XEXT
    C**
     C           FIN       TAG
     C                     MOVE '1'       *INLR
    C*****************************************************************
    C*                                                               *
    C*       SR : AJOUT D'UNE NOUVELLE EQUIPE SUR L'OP               *
    C*                                                               *
    C*****************************************************************
    C           CREEQ     BEGSR
    C**
     C                     MOVE TM,1      MODE
     C                     MOVE *OFF      *IN48
    C**
    C******  RECUP DE L'UNITE DE QTE DE L'OP DS PREACOP
    C**
     C                     MOVE FAOPNU    TYPOP   10
D1  C           TYPOP     IFGT 5
    C           TYPOP     ANDLT9
     C                     MOVE '1'       FAOPNU
F1  C                     ENDIF
    C**
     C           KPREOP    CHAINPREACOPF             99
D1  C           *IN99     IFEQ *OFF
     C                     MOVE OPUNQT    PPUNIT
X1  C                     ELSE
D2  C           SECT      IFEQ '6'
    C           SSECT     ANDEQ'7'
     C                     MOVE WWUNIT    PPUNIT
X2  C                     ELSE
     C                     MOVE *BLANK    PPUNIT
F2  C                     END
     C                     Z-ADD0         TANDEM
    C******  MAJ PPUNIT SI NON TROUVE DANS PREACOP : TOURY-CHABA-ROCHE
    C******  ==>  TRES IMPORTANT POUR L'ENTREE EN STOCK PRODUITS FINIS
D2  C           USINE     IFEQ 3
    C           USINE     OREQ 5
    C           USINE     OREQ 2
    C           USINE     OREQ 4
    C           USINE     OREQ 7
    C*
D3  C           FAATEL    IFGE '70'
    C           PPUNIT    ANDEQ'  '
     C                     MOVE 'PF'      PPUNIT
F3  C                     ENDIF
    C*
F2  C                     ENDIF
F1  C                     ENDIF
     C                     MOVE TYPOP     FAOPNU
    C**
    C******  RECUP : COULEUR, TYPE VERNIS, SECPAP, SUPOR
    C******            ET EFFECTIFS DANS FAB15P
    C**
     C           KFAB15    CHAINXFAB15              N99
D1  C           *IN99     IFEQ *OFF
     C                     Z-ADDCOULX     PPNCCA
     C                     MOVE VERNIS    PPVERN
D2  C           PPEFFC    IFEQ 0
    C           PPEFFR    ANDEQ0
     C                     Z-ADDOPEFCA    PPEFFC
     C                     Z-ADDOPEFRO    PPEFFR
F2  C                     ENDIF
    C**
    C*****   EN FONCTION DE LA ZONE FACON (DU PRODUI2)
    C*****        MAJ ZONE FATRSP=DE ; FE ; RL
    C**
D2  C           USINE     IFEQ 3
    C           FAATEL    ANDEQ'21'
    C           FATRSP    ANDEQ'  '
    C**
D3  C           NOMAC     IFEQ '04'
    C           NOMAC     OREQ '38'
    C**
D4  C                     SELEC
     C           FACON     WHEQ 4
     C                     MOVE 'DE'      FATRSP
     C           FACON     WHEQ 5
    C           FACON     OREQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
     C                     MOVE 'FE'      FATRSP
     C           FACON     WHEQ 1
    C           FACON     OREQ 2
    C           FACON     OREQ 9
     C                     MOVE 'RL'      FATRSP
     C                     OTHER
     C                     MOVE *BLANKS   FATRSP
F4  C                     ENDSL
F3  C                     ENDIF
F2  C                     ENDIF
    C**
X1  C                     ELSE
    C**
    C*****   EN FONCTION DE LA ZONE FACON (DU PRODUI2)
    C*****        MAJ ZONE FATRSP=DE ; FE ; RL
    C**
D2  C           USINE     IFEQ 3
    C           FAATEL    ANDEQ'21'
    C**
D3  C           NOMAC     IFEQ '04'
    C           NOMAC     OREQ '38'
    C**
D4  C                     SELEC
     C           FACON     WHEQ 4
     C                     MOVE 'DE'      FATRSP
     C           FACON     WHEQ 5
    C           FACON     OREQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
     C                     MOVE 'FE'      FATRSP
     C           FACON     WHEQ 1
    C           FACON     OREQ 2
    C           FACON     OREQ 9
     C                     MOVE 'RL'      FATRSP
     C                     OTHER
     C                     MOVE *BLANKS   FATRSP
F4  C                     ENDSL
    C**
F3  C                     ENDIF
F2  C                     ENDIF
    C**
    C**************       MOVE *BLANK    PPUNIT
     C                     MOVE *BLANKS   SECPAP
     C                     MOVE *BLANKS   SUPOR
     C                     MOVE *BLANKS   PPVERN
     C                     Z-ADD0         PPNCCA
     C                     Z-ADD0         PPEFFC
     C                     Z-ADD0         PPEFFR
F1  C                     ENDIF
    C**
     C                     MOVE *BLANK    NOMPRE
D1  C           CMATR     IFNE 0
     C           KFAB04    CHAINXFAB04               99
D2  C           *IN99     IFEQ *ON
     C                     MOVEL'INCONNU' NOMPRE
F2  C                     ENDIF
F1  C                     ENDIF
     **
     C                     Z-ADD0         PPHCAL
     C                     Z-ADD0         PPHTIR
     C                     Z-ADD0         PPHARR
     C                     Z-ADD0         PPHADI
     C                     Z-ADD0         PPHFRE
     C                     MOVE ' '       PPTFIN
     C                     Z-ADD0         PPQFEU
     C                     Z-ADD0         PPQFMA
     C                     Z-ADD0         PPGACA
     C                     Z-ADD0         PPQELI
     C                     MOVE *BLANK    PPDECH
     C                     MOVE *BLANK    PPOR
     C                     MOVE *BLANK    PPGAUF
     C                     MOVE *BLANK    FA1601
     C                     MOVE *BLANK    FA1602
     C                     MOVE *BLANK    FA1603
    C**
     C           CRET2     TAG
     C                     EXFMTF08
    C**
D1  C           *IN12     IFEQ *ON
    C                     GOTO CREF
F1  C                     ENDIF
    C**
     C                     Z-ADDFAOPNU    WWOPNU
    C**
    C******  F4=RECHERCHE CONDUCTEUR OU CODE TRAVAIL SPECIAL
    C******     EN FONCTION DU POSITIONNEMENT DANS LA LIGNE
    C**
D1  C           *IN04     IFEQ *ON
     C                     Z-ADDUSINE     ZUSI
     C                     MOVE SECT      ZSECT
     C                     MOVE SSECT     ZSSECT
     C                     MOVE NOMAC     ZNOMAC
     C                     MOVE '10'      LIGNE
     C                     MOVE *BLANKS   POS10  10
     C                     MOVEL'CMATR'   POS10
D2  C           POS2      IFEQ POS10
     C                     MOVE *BLANKS   PAS5
     C                     MOVE *BLANKS   PAS2
     C                     MOVE P1        PAS3
     C                     CALL 'FEN502£'              85
     C           PAS5      PARM PAS5      PAS5
     C           INDIC     PARM INDIC     INDIC
     C           LIGNE     PARM LIGNE     LIGNE
     C           PAS2      PARM PAS2      PAS2
     C           PAS3      PARM PAS3      PAS3
    C**
     C                     MOVE PAS5      CMATR
     C                     MOVE PAS2      NOMPRE
     **
     ******  MISE EN PLACE DES HORAIRES EQUIPES STANDARDS
     **
D3  C           PPEQUI    IFGT 0
    C           PPEQUI    ANDLE3
     C                     Z-ADD1         UU      10
     C           USINE     LOKUPTBU,UU                   99
    C           *IN99     CABEQ*OFF      CRET2
     C                     Z-ADDUU        ZZ      20
     C                     SUB  1         ZZ
     C                     MULT 3         ZZ
     C                     ADD  PPEQUI    ZZ
     C                     MOVELTEQ,ZZ    PPHDEQ
     C                     MOVE TEQ,ZZ    PPHFEQ
F3  C                     ENDIF
    C**
X2  C                     ELSE
    C**
     C                     MOVE *BLANKS   PASCOD
     C                     MOVE P1        PASRES
     C                     CALL 'FEN505£'              85
     C           PASRES    PARM PASRES    PASRES  4
     C           PASCOD    PARM PASCOD    PASCOD  2
     C           INDI1     PARM INDI1     INDI1   1
     C           LIGNE     PARM LIGNE     LIGNE   2
     C           NATRAV    PARM NATRAV    NATRAV 30
D3  C           PASCOD    IFNE *BLANKS
     C                     MOVE PASCOD    FATRSP
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO CRET2
F1  C                     ENDIF
    C**
    C******  CONTROLE SAISIES
    C**
     C           CRET3A    TAG
     C                     EXSR CONTRO
    C**
    C           *IN39     CABEQ*ON       CRET2
    C**
    C******  DEMANDE DE CONFIRMATION EN CAS DE SAISIE DU COMPTEUR
    C******  USINE 7 (FEG) SEULEMENT
    C**
D1  C           USINE     IFEQ 7
D2  C           *IN48     IFEQ *OFF
    C           PPCTR1    CABNE0         CRET2      4848
X2  C                     ELSE
     C                     MOVE *OFF      *IN48
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER FAB16P
    C**
     C                     MOVE FAOPNU    PPPAS
D1  C           PPPAS     IFGT 5
     C                     SUB  5         PPPAS
F1  C                     ENDIF
    C****       FAATEL    IFEQ '82'
    C****       PPPAS     ANDGT1
    C****                 Z-ADD1         PPPAS
    C****                 ENDIF
     **
     ******  RECHERCHE SI REPIQUAGE
     ******  OFFSET : OP 6261(1ER PASSAGE) ET 6271 (2EME PASSAGE)
     ******  FLEXO  : OP 3151(1ER PASSAGE) ET 3161 (2EME PASSAGE)
     **
     C                     MOVE 'N'       TAGOK
D1  C           FAATEL    IFEQ '12'
    C           FAATEL    OREQ '14'
     C                     Z-ADDUSINE     VAUSIN
     C                     Z-ADDFACONF    VACONF
     C                     Z-ADDFASEQ     VASEQ
     C                     Z-ADDFAISEQ    VAISEQ
     C                     Z-ADDNOPRO     VNOPRO
     C                     Z-ADDFAOPNU    VAOPNU
     C                     MOVE 'N'       TAGOK
     C                     CALL 'FAB580£'              85
     C           PARM2     PARM PARM2     PARM2
     **
D2  C           TAGOK     IFEQ 'O'
     C                     Z-ADD2         PPPAS
F2  C                     ENDIF
     **
F1  C                     ENDIF
     **
     ******  SI ROCHECHOUART COMPLEXEUSE EN TANDEM => FORCER EN 2206
     ******  SAISIE SUR 1303 MAIS MAJ SORTIE PAPIER 2206
     ******  SI TANDEM : TAGOK='O'
     **
     C                     MOVE 'N'       T2207
D1  C           USINE     IFEQ 2
    C           FAATEL    ANDEQ'13'
    C           NOMAC     ANDEQ'03'
     C                     Z-ADDUSINE     TAUSIN
     C                     Z-ADDFACONF    TACONF
     C                     Z-ADDFASEQ     TASEQ
     C                     Z-ADDFAISEQ    TAISEQ
     C                     Z-ADDNOPRO     TNOPRO
     C                     Z-ADDFAOPNU    TAOPNU
     C                     MOVE 'N'       T2207
     C                     CALL 'FAB603£'              85
     C           PARM3     PARM PARM3     PARM3
     **
    C*****  SI TANDEM COMPLEXE FAOPNU CELUI DE LA 1303
D2  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PPPAS
F2  C                     ENDIF
    C**
F1  C                     ENDIF
    C**
     C                     Z-ADDPPCTR1    PPCTR2
     C                     WRITEXFAB16
    C**
    C******  MAJ FICHIER FAB05P ==> STATUS OPERATION 'EN COURS'
    C**
     C           KFAB5C    CHAINZFAB05               99
D1  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      FAOPST
     C                     MOVE ' '       FA0501
     C           FAOPST    CHAINXFAB08               99
     C                     UPDATZFAB05
     C                     EXSR COMPLX
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER PDFINI SI PRODUIT FABRIQUE = PRODUIT FINI
    C******  'S' SI OP TERMINEE ET 'P' SINON DS ZONE PASO
    C**
D1  C           USINE     IFEQ 3
    C           USINE     OREQ 4
    C           USINE     OREQ 5
    C           USINE     OREQ 2
    C           USINE     OREQ 7
D2  C           SVTENC    IFEQ 9
     C                     Z-ADDUSINE     XYUSI
     C                     Z-ADDSTE       XYSTE
     C                     Z-ADDNOCLI     XYCLI
     C                     Z-ADDNOPRO     XYPRO
     C                     Z-ADDFACONF    XYCONF
     C                     Z-ADDFASEQ     XYSEQ
D3  C           FAOPST    IFEQ 'TR'
     C                     MOVE 'S'       XYSOLD
X3  C                     ELSE
     C                     MOVE 'P'       XYSOLD
F3  C                     ENDIF
     C                     CALL 'FAB636£'
     C           PARM13    PARM PARM13    PARM13
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ PRLANC => OFETA = 'EC' OP EN COURS
    C**
D1  C           FAOPST    IFEQ 'EC'
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      OFETA
     C                     EXCPTMAJLAN
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ FAB15P => TRAVAIL SPÉCIAL
    C**
     C                     MOVE FATRSP    SVTRSP
     C           KFAB15    CHAINXFAB15               99
D1  C           *IN99     IFEQ *OFF
     C                     MOVE SVTRSP    FATRSP
     C                     EXCPTMAJ15
F1  C                     ENDIF
    C**
    C******  MAJ DU FICHIER FAB22P : EQUIPE EN COURS DE MODIFICATION
    C**
     C           KFAB16    CHAINXFAB22               99
     C                     MOVE ' '       FA2201
     C                     MOVE ' '       FA2202
     C                     MOVE ' '       FA2203
D1  C           *IN99     IFEQ *ON
     C                     TIME           HEUR14 140
     C                     WRITEXFAB22
X1  C                     ELSE
     C                     UPDATXFAB22
F1  C                     ENDIF
    C**
    C           CREF      ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : CONTROLE DONNEES EQUIPE                            *
    C*                                                               *
    C*****************************************************************
    C           CONTRO    BEGSR
    C**
    C******  INITIALISATION INDICATEUR ERREUR
    C**
     C                     MOVE *ON       *IN39
    C**
D1  C           PPEQUI    IFEQ 0
    C           PPEQUI    ORGT 3
     C                     MOVE *ON       *IN40
    C                     GOTO CONTF
F1  C                     ENDIF
    C**
     C           KFAB04    CHAINXFAB04               42
    C           *IN42     CABEQ*ON       CONTF
    C**
    C*****  TEST VALIDITE DE LA DATE SAISIE
    C**
     C                     Z-ADDPPJJ      CALJJ
     C                     Z-ADDPPMM      CALMM
     C                     MOVELPPAA      CALSS
     C                     MOVE PPAA      CALAA
     C           KCAL01    CHAINCALENDF1             43
    C           *IN43     CABEQ*ON       CONTF
    C**
    C*****  TEST SI DATE SAISIE < DATE DU JOUR
    C**
     C                     Z-ADD*YEAR     RRAA
     C                     Z-ADD*MONTH    RRMM
     C                     Z-ADD*DAY      RRJJ
     C                     Z-ADDDATRR     DATJOU
    C**
     C                     Z-ADDPPAA      RRAA
     C                     Z-ADDPPMM      RRMM
     C                     Z-ADDPPJJ      RRJJ
    C           DATRR     CABGTDATJOU    CONTF      43
    C**
    C           PPHDEQ    CABEQ0         CONTF        4444
    C           PPHFEQ    CABEQ0         CONTF        4545
    C**
D1  C           PPHDEQ    IFNE 0
     C                     MOVE PPHDEQ    MN      20
     C                     MOVELPPHDEQ    HR      20
    C           HR        CABGT24        CONTF      44
    C           MN        CABGT59        CONTF      44
    C           PPHDEQ    CABLT100       CONTF        44
F1  C                     ENDIF
    C**
D1  C           PPHFEQ    IFNE 0
     C                     MOVE PPHFEQ    MN
     C                     MOVELPPHFEQ    HR
    C           HR        CABGT24        CONTF      45
    C           MN        CABGT59        CONTF      45
    C           PPHFEQ    CABLT100       CONTF        45
F1  C                     ENDIF
    C**
D1  C           PPEQUI    IFEQ 3
    C           PPHFEQ    CABGTPPHDEQ    CONTF      44
F1  C                     ENDIF
    C**
D1  C           PPEQUI    IFEQ 1
    C           PPEQUI    OREQ 2
    C           PPHFEQ    CABLTPPHDEQ    CONTF        45
F1  C                     ENDIF
    C**
    C******  TEST SI UN EFFECTIF A ÉTÉ SAISI
    C**
D1  C           PPEFFC    IFEQ 0
    C           PPEFFR    ANDEQ0
     C                     SETON                     47
    C                     GOTO CONTF
F1  C                     ENDIF
    C**
    C******  TEST SI MEME EQUIPE DEJA EXISTANTE SUR CETTE OP
    C**
     C           KFAB16    CHAINXFA16C               99
    C           *IN99     CABEQ*OFF      CONTF          41
    C**
    C******  TEST SI LE CODE SPECIAL EST EXISTANT
    C**
D1  C           FATRSP    IFNE *BLANKS
     C                     MOVE NOMAC     MACH2
    C**   CAS PARTICULIER DE L'ONDULEUSE 3/8
D2  C           USINE     IFEQ 3
    C           FAATEL    ANDEQ'21'
    C           NOMAC     ANDEQ'38'
     C                     MOVE '03'      MACH2
F2  C                     ENDIF
     C           KTRASP    CHAINTRASPEF1             49
    C           *IN49     CABEQ*ON       CONTF
F1  C                     ENDIF
    C**
    C******  AUCUNE ERREUR DETECTEE
    C**
     C                     MOVE *OFF      *IN39
    C**
    C           CONTF     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : GESTION DES OPERATIONS FABRICATION                 *
    C*                                                               *
    C*****************************************************************
    C           OPERA     BEGSR
     C                     MOVE *OFF      *IN98
    C**
    C******  RECHERCHE DES EVENEMENTS DEJA EXECUTEES SUR CETTE EQUIPE
    C**
     C                     Z-ADDPPEQUI    P       10
     C                     MOVE EQ,P      LIBEQU
    C**
     C           OSFIC     TAG
     C                     MOVEA'100'     *IN,65
     C                     WRITEF12
     C                     Z-ADD0         RCY
     C                     Z-ADD0         DERRCY
     C                     Z-ADD0         SAVRCY
    C**
    C******  RENUMEROTATION DES LIGNES
    C**
     C                     EXSR RENUM
    C**
     C                     Z-ADD0         PPORD
     C                     Z-ADD0         SAVORD
     C                     Z-ADD0         DATEVE
     C                     Z-ADD0         SAVEVE
     C                     Z-ADD0         TOTHRE
     C                     Z-ADD0         TMN4
    C**
     C                     SETOF                     65
     C           KFAB17    SETLLXFAB17
    C**
    C****** REMPLISSAGE DU SOUS-FICHIER F11
    C**
     C           OAB       TAG
     C           KFAB16    READEXFAB17                 9368
D1  C           *IN68     IFEQ *ON
     **
     ****** SI EQUIPE TERMINEE OU COMMENCEE => POSITION EN DEBUT SSFIC
     **
D2  C           RCY       IFGT 0
     C                     Z-ADD1         RCY
F2  C                     ENDIF
     **
     ******  TEST SI OBSERVATIONS SAISIES
     **
     C                     MOVE *OFF      *IN48
    C*          KFAB16    CHAINXFAB19              N48
     **
    C                     GOTO OUITE
F1  C                     ENDIF
    C**
    C           *IN93     CABEQ*ON       OAB
     C           KFAB03    CHAINXFAB03               99
    C**
D1  C           PPHFIN    IFNE 0
     C                     EXSR TEMPS
F1  C                     ENDIF
    C**
     C                     ADD  1         RCY
     C                     Z-ADDRCY       SAVRCY
     C                     Z-ADDRCY       DERRCY
     C                     Z-ADDPPORD     SAVORD
     C                     WRITEF11
    C                     GOTO OAB
    C**
    C****** AFFICHAGE DU FORMAT DE CONTROLE F12
    C**
     C           OUITE     TAG
    C**
    C******  RECALCUL QTES PRODUITES : TOTAL ET FAB
    C**
     C                     Z-ADD0         TOTENC
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     TOTENC
     **
     C                     Z-ADDUSINE     ZZUSI
     C                     Z-ADDNOPRO     ZZPRO
     C                     Z-ADDFACONF    ZZCONF
     C                     Z-ADDFASEQ     ZZSEQ
     C                     Z-ADDFAISEQ    ZZISEQ
     C                     Z-ADDFAOPNU    ZZOPNU
     C                     MOVE SECT      ZZSECT
     C                     MOVE SSECT     ZZSSEC
     C                     MOVE NOMAC     ZZMAC
     C                     CALL 'FAB541£'
     C           PARM14    PARM PARM14    PARM14
     C           PARM15    PARM PARM15    PARM15
     C                     Z-ADDZOTBO     TOTBON
    C**
D1  C           FAATEL    IFEQ '82'
    C           FAATEL    OREQ '83'
    C           FAATEL    OREQ '70'
D2  C           USINE     IFEQ 7
D3  C           FA1601    IFEQ 'T'
     C                     Z-ADDPPQFEU    TOTENC
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  RECHERCHE NATURE DE COMMANDE CLIENT
    C**
     C                     MOVE *BLANK    NATCDE
     C                     MOVEL*BLANK    LNATCD
     C                     MOVE '0'       *IN22
     C           KCDESL    CHAINCDESLC               99
D1  C           *IN99     IFEQ '0'
     C                     MOVE 'NCDE'    PXARGU
     C                     MOVE STOND     PXVALE    P
     C           KEYUSI    CHAINPARAME               99
D2  C           *IN99     IFEQ '0'
     C                     MOVE PXVALE    NATCDE
     C                     MOVELPXLIBE    LNATCD
F2  C                     ENDIF
X1  C                     ELSE
     C                     MOVE '1'       *IN22
F1  C                     ENDIF
    C**
    C******  RECHERCHE LIBELLE ET CODE DE GESTION DE L'OF
    C**
     C                     MOVE *BLANKS   LCODGO
     C                     MOVE *BLANKS   CODGOF
     C           KFABGO    CHAINFABGOFL3             99
D1  C           *IN99     IFEQ '0'
     C                     MOVE 'CGES'    PXARGU
     C                     MOVE CODGOF    PXVALE    P
     C                     MOVE *BLANKS   PXLIBE
     C           KEYUSI    CHAINPARAMEF1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVELPXLIBE    LCODGO
F2  C                     ENDIF
F1  C                     ENDIF
     *
     C                     MOVE '0'       *IN21
D1  C           CODGOF    IFNE 'D'
     C                     MOVE '1'       *IN21
F1  C                     ENDIF
     *
    C**
    C******  RECHERCHE MINI MAXI
    C**
     C                     EXSR MINMAX
    C**
     C           OUIT2     TAG
     C                     WRITEF10
     C                     SETON                     67
     C           RCY       COMP 0                    66
     C                     EXFMTF12
    C**
     C                     MOVE *OFF      *IN36
    C**
    C******  F12 : ABANDON SAISIE ==> RETOUR AFFICHAGE EQUIPES
    C**
D1  C           *IN12     IFEQ *ON
    C** SI AU MOINS 1 OPERATION ; SI 95 EST ON : MODIF FAITE
    C**      ET SI LE TRAVAIL ETAIT TERMINÉ
    C**                   OU
    C** SI AU MOINS 1 OPERATION ; SI 95 EST ON : MODIF FAITE
    C**      ET SI LE TRAVAIL N'EST PAS DU JOUR
    C** ALORS  ==>  OBLIGATION DE VALIDER LES MODIFS PAR F10
D2  C           RCY       IFNE 0
D3  C           *IN95     IFEQ *ON
    C           FA1601    ANDEQ'T'
    C           *IN95     OREQ *ON
    C           DATEQ     ANDNE*DATE
    C**
    C                     GOTO OUITE
     C                     SETON                     36
F3  C                     ENDIF
    C**
X2  C                     ELSE
    C** PLUS AUCUNE OPERATION
     C           KFAB16    CHAINXFAB22               99
D3  C           *IN99     IFEQ *OFF
     C                     EXCPTDEL22
F3  C                     ENDIF
F2  C                     ENDIF
    C**
     C                     Z-ADD0         PPORD
    C                     GOTO OINF
F1  C                     ENDIF
    C**
    C******  F1 : MODULE GESTION DES ENCOURS/MATIERES
    C**
D1  C           *IN01     IFEQ *ON
    C**
     C           KFAB16    CHAINXFAB22               99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       FA2201
     C                     MOVE ' '       FA2202
     C                     EXCPTMAJ22
F2  C                     ENDIF
     C                     Z-ADDUSINE     YAUSIN
     C                     MOVE SECT      YSECT
     C                     MOVE SSECT     YSSECT
     C                     MOVE NOMAC     YNOMAC
     C                     Z-ADDFACONF    YACONF
     C                     Z-ADDFASEQ     YASEQ
     C                     Z-ADDFAISEQ    YAISEQ
     C                     Z-ADDSTE       YSTE
     C                     Z-ADDNOCLI     YNOCLI
     C                     Z-ADDNOPRO     YNOPRO
     C                     Z-ADDFAOPNU    YAOPNU
     C                     Z-ADDDATEQ     YATEQ
     C                     Z-ADDPPEQUI    YPEQUI
     **
     C                     MOVE PARM4     PAS4   35
     C                     CALL 'FAB556£'
     C           PAS4      PARM PAS4      PAS4
    C** SI 95=ON OBLIGATION DE VALIDER LES MODIFS PAR F10
     C                     MOVE *ON       *IN95
    C**
    C                     GOTO OUITE
F1  C                     ENDIF
    C**
    C******  F6 : CREATION NOUVEL EVENEMENT ET MAJ TEMPS DEBUT
    C**
D1  C           *IN06     IFEQ *ON
D2  C           DERRCY    IFNE 0
     C           DERRCY    CHAINF11                  99
    C           PPHFIN    CABEQ0         OUITE          41
    C**
    C******  TREF = HEURE FIN OPERATION N-1 ==> HEURE DEBUT OPER N
     ******  SI REPRISE APRES INTERRUPTION => RECHERCHE HEURE FIN OP PREC
     **
D3  C           PPTFIN    IFEQ 'I'
     C                     EXSR RECTIM
X3  C                     ELSE
     C                     Z-ADDPPHFIN    TREF
F3  C                     ENDIF
     **
     ******  NOUVELLE OP => RECHERCHE HEURE FIN OP PRECEDENTE
     **
X2  C                     ELSE
     C                     EXSR RECTIM
F2  C                     ENDIF
    C**
     C                     EXSR CREOP
    C           *IN12     CABEQ*ON       OUITE
    C** SI 95=ON OBLIGATION DE VALIDER LES MODIFS PAR F10
     C                     MOVE *ON       *IN95
    C**
     C           KFAB16    CHAINXFAB22               99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       FA2201
     C                     EXCPTMAJ22
F2  C                     ENDIF
    C**
    C                     GOTO OSFIC
F1  C                     ENDIF
    C**
    C******  F7 : SAISIE OBSERVATIONS
    C**
D1  C           *IN07     IFEQ *ON
    C*          *IN48     CABEQ*ON       OUITE
     C                     EXSR WINOB
    C                     GOTO OUITE
F1  C                     ENDIF
    C**
    C******  F10 : FIN DE TRAVAIL SUR UNE OP : SAISIE BILAN
    C**
D1  C           *IN10     IFEQ *ON
    C           DERRCY    CABEQ0         OUITE          43
    C**
    C******  VALIDATION DES MODIFS HORAIRES EVENTUELLES
    C**
     C                     READCF11                    8981
D2  C           *IN81     DOWEQ'0'
D3  C           *IN89     IFNE *ON
     C                     EXSR MODHOR
F3  C                     END
     C                     READCF11                    8981
F2  C  N81                END
     **
     ******  TEST SI LE DERNIER EVENEMENT A UNE HEURE DE FIN
     **
     C           DERRCY    CHAINF11                  99
    C           PPHFIN    CABEQ0         OUITE          42
     **
     ******  TEST SI LES MATIERES ONT ETE CLOTUREES?
     **
     C           KFAB16    CHAINXFAB16              N99
     C           KFAB16    CHAINXFAB22              N99
    C           FA1602    CABNE'T'       OUITE      3737
    C           FA2202    CABNE'T'       OUITE      3737
     **
     C                     EXSR TESHOR
    C           *IN40     CABEQ*ON       OUITE
     C                     EXSR FINEQU
    C           *IN12     CABEQ*ON       OUIT2
    C                     GOTO OINF
F1  C                     ENDIF
    C**
    C******  ROLLUP : PAGE AVANT : REMPLISSAGE DU SOUS-FICHIER
    C**
D1  C           *IN26     IFEQ *ON
D2  C           *IN68     IFEQ *OFF
     C                     Z-ADDSAVORD    PPORD
     C                     Z-ADDSAVEVE    DATEVE
     C                     Z-ADDSAVRCY    RCY
     C           KFAB17    SETGTXFAB17
    C                     GOTO OAB
F2  C                     ENDIF
     C                     Z-ADDSAVRCY    RCY
    C                     GOTO OUITE
F1  C                     ENDIF
    C**
    C****** LECTURE DU SOUS-FICHIER
    C**
     C           OEXT      TAG
     C                     READCF11                    8981
    C           *IN89     CABEQ*ON       OUITE
    C           *IN81     CABEQ*ON       OSFIC
    C**
    C****** MODIFICATION HORAIRES EVENEMENT SI OP NON TERMINEE
    C**
     C                     EXSR MODHOR
    C           *IN44     CABEQ*ON       OUITE
    C           *IN45     CABEQ*ON       OUITE
    C           *IN47     CABEQ*ON       OUITE
    C** SI 95=ON OBLIGATION DE VALIDER LES MODIFS PAR F10
     C                     MOVE *ON       *IN95
    C**
     C           KFAB16    CHAINXFAB22               99
D1  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       FA2201
     C                     EXCPTMAJ22
F1  C                     ENDIF
    C**
    C**
    C                     GOTO OEXT
    C**
    C           OINF      ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : CREATION D'UN NOUVEL EVENEMENT                     *
    C*                                                               *
    C*****************************************************************
    C           CREOP     BEGSR
    C           *IN98     CABEQ*ON       CRET20
     C                     SETON                     98
     C                     Z-ADDSAVORD    SVORD1
     C                     Z-ADDSAVRCY    SVRCY1
     C                     Z-ADDSAVORD    PPORD
     C                     Z-ADDSAVRCY    RCY
    C**
     C           KFAB17    SETGTXFAB17
D1  C                     DO   *HIVAL
    C**
     C           CRET1     TAG
     C           KFAB16    READEXFAB17              N  9368
    C           *IN68     CABEQ*ON       CRET20
    C           *IN93     CABEQ*ON       CRET1
     C                     ADD  1         RCY
     C                     Z-ADDRCY       DERRCY
     C                     Z-ADDRCY       SAVRCY
     C                     MOVE PPORD     SAVORD
     C                     WRITEF11
F1  C                     ENDDO
    C**
    C******  RECHERCHE EVENEMENT DS FENETRE : SS-PROG WIN01
    C**
     C           CRET20    TAG
     C                     MOVE *BLANKS   FAEVLI
     C                     MOVE *BLANK    ZAEVTY
     C                     EXSR WIN
    C**
D1  C           *IN12     IFEQ *ON
     C                     MOVE SVORD1    PPORD
D2  C           SVRCY1    IFEQ 0
     C                     Z-ADDSAVRCY    RCY
X2  C                     ELSE
     C                     Z-ADDSVRCY1    RCY
F2  C                     ENDIF
    C                     GOTO CREF2
F1  C                     ENDIF
    C**
     C           KFAB03    CHAINXFAB03               99
    C           *IN99     CABEQ*ON       CRET20
    C**
    C******  HEURE DEBUT=HEURE REELLE
    C**
     C                     TIME           HEURE   60
     C                     MOVELHEURE     PPHDEB
    C**
    C******  CALCUL DU N° ORDRE EVENEMENT SUR CETTE EQUIPE
    C**
D1  C           TREF      IFNE 0
     C                     Z-ADDTREF      PPHDEB
F1  C                     ENDIF
D1  C           PPHDEB    IFEQ 2400
     C                     Z-ADD0         PPHDEB
F1  C                     ENDIF
     C                     Z-ADDPPHDEB    PPHFIN
    C**
    C******  SI EQUIPE NUIT => DATE FAB=DATE JOUR SI 0<HEURE<500
    C******            SINON   DATE FAB=DATE DE L'EQUIPE
    C**
D1  C           DATEVE    IFEQ 0
     C                     Z-ADDDATEQ     DATEVE
F1  C                     ENDIF
    C**
D1  C           PPEQUI    IFEQ 3
    C           PPHDEB    ANDGT500
     C                     Z-ADDDATEQ     DATEVE
F1  C                     ENDIF
    C**
    C******  CALCUL DU N° ORDRE EVENEMENT SUR CETTE EQUIPE
    C**
     C                     Z-ADD99        PPORD
     C           KFA17A    SETGTXFA17A
     C           KFAB16    REDPEXFA17A                   99
D1  C           *IN99     IFEQ *ON
     C                     Z-ADD1         PPORD
X1  C                     ELSE
     C                     ADD  1         PPORD
    C           PPORD     CABEQ0         CREF2
F1  C                     ENDIF
    C**
     C                     WRITEXFAB17
    C**
    C******  AJOUT NLLE OPERATION DS SS-FICHIER F11
    C**
     C                     Z-ADDSAVRCY    RCY
     C                     ADD  1         RCY
     C                     Z-ADDRCY       SAVRCY
     C                     Z-ADDRCY       DERRCY
     C                     WRITEF11
     C                     Z-ADDPPORD     SAVORD
    C**
    C           CREF2     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MODIFICATION DES HORAIRES D'UN EVENEMENT           *
    C*                                                               *
    C*****************************************************************
    C           MODHOR    BEGSR
    C**
    C******  SUPPRESSION ==> HEURE DEBUT=HEURE FIN=0
    C**
D1  C           PPHDEB    IFEQ 0
    C           PPHFIN    ANDEQ0
     C           KFA17D    CHAINZFAB17               99
D2  C           *IN99     IFEQ *OFF
     C                     DELETZFAB17
F2  C                     ENDIF
    C*** SI EVENEMENT N° 1 SUPPRIMÉ RENUMÉROTATION EN 1
    C***   L'ÉVENEMENT SUIVANT
D2  C           PPORD     IFEQ 1
     C           KFA17E    READEZFAB17                   99
D3  C           *IN99     IFEQ *OFF
     C                     Z-ADD1         PPORD
     C                     UPDATZFAB17
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO MODHOF
F1  C                     ENDIF
    C**
    C******  MODIFICATION => TEST HEURE DEBUT ET FIN
    C**
     C                     MOVE PPHDEB    MN      20
     C                     MOVELPPHDEB    HR      20
    C           HR        CABGT24        MODHOF     44
    C           MN        CABGT59        MODHOF     44
    C**
     C                     MOVE PPHFIN    MN
     C                     MOVELPPHFIN    HR
    C           HR        CABGT24        MODHOF     45
    C           MN        CABGT59        MODHOF     45
    C**
     C                     Z-ADDPPJJ      CALJJ
     C                     Z-ADDPPMM      CALMM
     C                     MOVELPPAA      CALSS
     C                     MOVE PPAA      CALAA
     C           KCAL01    CHAINCALENDF1             47
    C           *IN47     CABEQ*ON       MODHOF
    C**
D1  C           DATEVE    IFNE DATEQ
    C**  LECTURE DU JOUR SUIVANT
     C                     READ CALENDF1                 47
    C           *IN47     CABEQ*ON       MODHOF
    C           DATEVE    CABNEDATLUE    MODHOF     4747
F1  C                     ENDIF
    C**
    C******  CONTROLE VRAISEMBLANCE HORAIRES / EQUIPE
    C**
     C                     Z-ADDPPHDEQ    HDEQ
     C                     Z-ADDPPHFEQ    HFEQ
     C                     Z-ADDPPHDEB    HDEB
     C                     Z-ADDPPHFIN    HFIN
D1  C           PPHFEQ    IFLT PPHDEQ
     C           PPHFEQ    ADD  2400      HFEQ
F1  C                     ENDIF
    C**
D1  C           PPHFIN    IFNE 0
     C                     Z-ADDPPHDEB    HDEB
     C                     Z-ADDPPHFIN    HFIN
D2  C           PPHFIN    IFLT PPHDEB
     C           PPHFIN    ADD  2400      HFIN
F2  C                     ENDIF
F1  C                     ENDIF
    C** SI DATE EVENEMENT = DATE DU LENDEMAIN DE LA DATE DE L'EQUIPE
D1  C           DATEVE    IFNE DATEQ
     C           PPHDEB    ADD  2400      HDEB
     C           PPHFIN    ADD  2400      HFIN
F1  C                     ENDIF
    C**
D1  C           PPHFIN    IFNE 0
    C           HFIN      CABLTHDEB      MODHOF       45
F1  C                     ENDIF
D1  C           HDEB      IFLT HDEQ
    C           PPEQUI    ANDEQ3
     C           HDEB      ADD  2400      HDEB
F1  C                     ENDIF
    C           HDEB      CABLTHDEQ      MODHOF       44
    C           HDEB      CABGTHFEQ      MODHOF     44
    C           HFIN      CABGTHFEQ      MODHOF     45
D1  C           PPHFIN    IFNE 0
    C           PPEQUI    ANDNE3
    C           HFIN      CABLTHDEQ      MODHOF       45
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER FAB17P
    C**
     C           KFA17D    CHAINZFAB17               99
D1  C           *IN99     IFEQ *OFF
     C                     Z-ADDPPHDEB    XPHDEB
     C                     Z-ADDPPHFIN    XPHFIN
     C                     Z-ADDDATEVE    XATEVE
     C                     UPDATZFAB17
F1  C                     ENDIF
    C**
    C           MODHOF    ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : TEST CONTINUITE EN TEMPS DES EVENEMENTS            *
    C*                                                               *
    C*****************************************************************
    C           TESHOR    BEGSR
    C**
    C******  SI TRAVAIL REPRIS APRES INTERRUPTION => TEST NON EFFECTUE
    C**
    C           PPTFIN    CABEQ'I'       TESHOF
    C           FA1603    CABEQ'I'       TESHOF
    C**
     C                     MOVE *OFF      *IN40
     C                     MOVE *OFF      *IN96
     C                     Z-ADD0         DATEVE
     C                     Z-ADD0         PPORD
    C**
     C           KFAB17    SETLLXFAB17
     C           TESHO1    TAG
     C           KFAB16    READEXFAB17              N    99
    C**
    C           *IN99     CABEQ*ON       TESHOF
    C**
    C******  1ERE LECTURE
    C**
D1  C           *IN96     IFEQ *OFF
     C                     MOVE *ON       *IN96
     C                     Z-ADDPPHFIN    SVHFIN
    C                     GOTO TESHO1
F1  C                     ENDIF
    C**
D1  C           PPHDEB    IFEQ SVHFIN
     C                     Z-ADDPPHFIN    SVHFIN
    C                     GOTO TESHO1
F1  C                     ENDIF
    C**
    C******  ERREUR DE DISCONTINUITE => *IN40 ON
    C**
     C                     MOVE *ON       *IN40
    C**
     C           TESHOF    TAG
     C                     MOVE *OFF      *IN96
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*     SR : CALCUL DIFFERENCE DE TEMPS EN MINUTES                *
    C*                                                               *
    C*****************************************************************
    C           TEMPS     BEGSR
     C                     MOVE PPHDEB    MN
     C                     MOVELPPHDEB    HR
     C           HR        MULT 60        TMN1    40
     C                     ADD  MN        TMN1
     C                     MOVE PPHFIN    MN
     C                     MOVELPPHFIN    HR
     C           HR        MULT 60        TMN2    40
     C                     ADD  MN        TMN2
D1  C           PPHDEB    IFGT PPHFIN
     C                     ADD  1440      TMN2
F1  C                     ENDIF
    C**
    C******  CALCUL DIFFERENCE EN MINUTES : FIN-DEBUT
    C**
     C           TMN2      SUB  TMN1      TMN3    40
     C                     ADD  TMN3      TMN4    40
    C**
    C******  TRANSFORMATION TOTAL MINUTE EN HEURE:MINUTE
    C**
     C           TMN4      DIV  60        HR
     C                     MVR            MN
     C                     MOVELHR        TOTHRE
     C                     MOVE MN        TOTHRE
    C**
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : RECHERCHE HEURE DE FIN DU TRAVAIL PRECEDENT        *
    C*                                                               *
    C*****************************************************************
    C           RECTIM    BEGSR
D1  C           DERRCY    IFEQ 0
     C                     TIME           HEURE
     C                     MOVELHEURE     TREF
    C                     GOTO FRECT
F1  C                     ENDIF
    C**
     C                     Z-ADD9999      PPHFIN
     C                     Z-ADD9999      PPHDEB
     C                     Z-ADD99999999  DATEVE
     C                     Z-ADD0         TREF
     C           KFA17B    SETGTYFAB17
     C           LEC17B    TAG
     C           KFA17C    REDPEYFAB17                   99
D1  C           *IN99     IFEQ *OFF
     C                     Z-ADDPPHFIN    TREF
X1  C                     ELSE
     C                     Z-ADDPPHDEQ    TREF
F1  C                     ENDIF
    C           FRECT     ENDSR
    C*****************************************************************
    C*                                                               *
    C*  SR : AFFICHAGE FENETRE CHOIX OPERATION FABRICATION/MACHINE   *
    C*                                                               *
    C*****************************************************************
    C           WIN       BEGSR
     C                     MOVE *BLANK    FAEVCO
     C           RAZ       TAG
     C                     MOVE *BLANK    AF1
     C                     MOVE *BLANK    AF2
     C                     MOVE *BLANK    AF3
     C                     MOVE *BLANK    PAG
     C                     Z-ADD0         I
     C                     MOVE *OFF      *IN88
     C                     Z-ADD1         SEIT
    C**
    C******  LECTURE DU FICHIER FAB03P
    C**
     C                     MOVE *BLANK    FAEVLI
     C                     MOVE *BLANK    FAEVCO
    C**
     C           RELEC     TAG
     C                     Z-ADD0         I       20
     C                     MOVE *BLANK    AF1
     C                     MOVE *BLANK    AF2
     C                     MOVE *BLANK    AF3
    C**
D1  C           ZAEVTY    IFEQ *BLANK
     C           KFAB03    SETLLXFAB03
X1  C                     ELSE
     C                     MOVE ZAEVTY    FAEVTY
     C           KFAB3B    SETLLYFAB03
F1  C                     ENDIF
    C**
D1  C                     DO   9         I
     C           LEC       TAG
D2  C           ZAEVTY    IFEQ *BLANK
     C           KFAB3A    READEXFAB03                   88
X2  C                     ELSE
     C           KFAB3C    READEYFAB03                   88
F2  C                     ENDIF
    C**
D2  C           *IN88     IFEQ *ON
     C                     LEAVE
F2  C                     ENDIF
    C**
    C****** SI EVENEMENT HORODATE => OMISSION DES ARRETS DIVERS
    C****** +  OMISSION DES N°ORDRE 999 => EVENEMENTS PLUS UTILISES
    C**
D2  C           ZAEVTY    IFEQ *BLANK
    C           FAEVTY    CABEQ'D'       LEC
    C           FAEVNO    CABEQ999       LEC
F2  C                     ENDIF
    C**
D2  C           I         IFEQ 1
     C                     Z-ADDSEIT      Q       20
     C                     MOVE FAEVCO    PAG,Q
F2  C                     ENDIF
     C                     MOVE FAEVCO    AF1,I
     C                     MOVE FAEVLI    AF2,I
     C                     MOVE FAEVLI    AF3,I
F1  C                     ENDDO
    C**
    C******  AFFICHAGE D'UNE PAGE
    C**
     C           AFF       TAG
     C                     EXFMTF22
D1  C           *IN12     IFEQ *ON
     C                     MOVE *BLANK    FAEVCO
     C                     MOVE *BLANK    FAEVLI
    C                     GOTO WINF
F1  C                     ENDIF
    C**
    C******  ENTREE : CHOIX DU CODE EVENEMENT
    C**
D1  C           *IN25     IFEQ *OFF
    C           *IN26     ANDEQ*OFF
     C                     Z-ADD1         Z       20
     C           POS2      LOKUPZO,Z                     99
    C           *IN99     CABEQ*OFF      AFF
    C           AF1,Z     CABEQ*BLANK    AFF
     C                     MOVE AF1,Z     FAEVCO
     C                     MOVE AF3,Z     FAEVLI
    C                     GOTO WINF
F1  C                     ENDIF
    C**
    C******  PAGE AVANT
    C**
D1  C           *IN26     IFEQ *ON
     C                     ADD  1         SEIT
D2  C           ZAEVTY    IFEQ *BLANK
     C           KFAB03    SETGTXFAB03
X2  C                     ELSE
     C           KFAB3B    SETGTYFAB03
F2  C                     ENDIF
    C**
D2  C           ZAEVTY    IFEQ *BLANK
     C           KFAB3A    READEXFAB03                   88
X2  C                     ELSE
     C           KFAB3C    READEYFAB03                   88
F2  C                     ENDIF
D2  C           *IN88     IFEQ *ON
     C                     SUB  1         SEIT
    C                     GOTO AFF
F2  C                     ENDIF
    C                     GOTO RELEC
F1  C                     ENDIF
    C**
    C******  PAGE ARRIERE
    C**
D1  C           *IN25     IFEQ *ON
     C                     SUB  1         SEIT
D2  C           SEIT      IFLT 1
     C                     ADD  1         SEIT
    C                     GOTO AFF
F2  C                     ENDIF
     C                     Z-ADDSEIT      Q
     C                     MOVE PAG,Q     FAEVCO
    C                     GOTO RELEC
F1  C                     ENDIF
    C**
    C******  RETOUR A L'AFFICHAGE
    C**
    C                     GOTO AFF
    C           WINF      ENDSR
    C*****************************************************************
    C*                                                               *
    C*     SR : FIN EQUIPE : SAISIE DU BILAN OPERATION               *
    C*                                                               *
    C*****************************************************************
    C           FINEQU    BEGSR
     C                     MOVE *OFF      *IN39
     C                     MOVE *OFF      *IN33
     C                     Z-ADD0         TPSTOT
     C                     MOVE *BLANK    TCAD
     C                     MOVE *BLANK    XCAD
     C                     Z-ADD0         THAD
     C                     MOVE *BLANK    TTAD
     C                     Z-ADD0         TEAD
     C                     MOVE *BLANK    TLAD
    C**
     C                     MOVE *BLANK    TAD1
     C                     Z-ADD0         TAD2
     C                     MOVE *BLANK    TAD3
     C                     Z-ADD0         TAD4
     C                     Z-ADDTOTHRE    SVTHRE
    C**
     C           KFAB16    CHAINXFAB16               9985
    C**
    C******  TEST SI ENREGISTREMENT VERROUILLE
    C**
D1  C           *IN85     IFEQ *ON
     C                     CALL 'FAB609£'
     C                     MOVE *ON       *IN12
    C                     GOTO FINF
F1  C                     ENDIF
    C**
     C                     MOVE PPTFIN    SVTFIN
     C                     Z-ADDPPQFMA    SVQFMA
    C**
    C******  LECTURE EVENEMENTS FABRICATION EXECUTES PAR CETTE EQUIPE
    C**
     C                     Z-ADD0         MNCAL
     C                     Z-ADD0         MNTIR
     C                     Z-ADD0         MNARR
     C                     Z-ADD0         MNPAN
     C                     Z-ADD0         MNARD
     **
     ******  RECUPERATION HEURE FIN EQUIPE DS DERNIERE OPERATION
     **
     C           DERRCY    CHAINF11                  99
     C                     Z-ADDPPHFIN    SVHFI2
    C**
D1  C           1         DO   DERRCY    RCY2
     C           RCY2      CHAINF11                  99
     C           KFAB03    CHAINXFAB03               99
     C                     EXSR TEMPS
D2  C           FAEVTY    IFEQ 'C'
     C                     ADD  TMN3      MNCAL   40
F2  C                     ENDIF
D2  C           FAEVTY    IFEQ 'R'
     C                     ADD  TMN3      MNTIR   40
F2  C                     ENDIF
D2  C           FAEVTY    IFEQ 'A'
     C                     ADD  TMN3      MNARR   40
     C                     EXSR ARDIV1
F2  C                     ENDIF
D2  C           FAEVTY    IFEQ 'P'
     C                     ADD  TMN3      MNPAN   40
     C                     EXSR ARDIV1
F2  C                     ENDIF
F1  C                     ENDDO
    C**
    C******  CALCUL TEMPS EN HEURES/CENTIEMES ET TEMPS TOTAL OP
    C**
D1  C           MNCAL     IFNE 0
     C           MNCAL     DIV  60        PPHCAL    H
X1  C                     ELSE
     C                     Z-ADD0         PPHCAL
F1  C                     ENDIF
    C**
D1  C           MNTIR     IFNE 0
     C           MNTIR     DIV  60        PPHTIR    H
X1  C                     ELSE
     C                     Z-ADD0         PPHTIR
F1  C                     ENDIF
    C**
D1  C           MNARR     IFNE 0
     C           MNARR     DIV  60        PPHARR    H
X1  C                     ELSE
     C                     Z-ADD0         PPHARR
F1  C                     ENDIF
    C**
D1  C           MNPAN     IFNE 0
     C           MNPAN     DIV  60        PPHPAN    H
X1  C                     ELSE
     C                     Z-ADD0         PPHPAN
F1  C                     ENDIF
    C**
    C******  SAUVEGARDE DES CUMULS TEMPS => SERT SI ARRETS DIVERS
    C**
     C                     Z-ADDPPHCAL    SVHCAL
     C                     Z-ADDPPHTIR    SVHTIR
     C                     Z-ADDPPHARR    SVHARR
     C                     Z-ADDPPHPAN    SVHPAN
    C**
     C           PPHCAL    ADD  PPHTIR    TPSTOT
     C                     ADD  PPHARR    TPSTOT
     C                     ADD  PPHPAN    TPSTOT
    C**
    C******  AFFICHAGE FORMAT F16 : VALIDATION PAR F20 OU F21
    C**
    C**
    C******  CALCUL QTE FABRIQUEE D'APRES LES PALETTES PRODUITES
    C**
D1  C           FAATEL    IFNE '82'
    C           FAATEL    ANDNE'83'
    C           FAATEL    ANDNE'70'
    C           USINE     OREQ 3
    C           USINE     OREQ 5
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     PPQFEU
     C                     Z-ADDTOTEQ2    PPQFMA
F1  C                     ENDIF
    C*---------------------------------------------------------------*
    C* CAS ROCHECHOUART : SI DATE > DATE DEMARRAGE PF => CALFAB      *
    C*                    SI DATE < DATE DEMARRAGE PF => QTE SAISIE  *
    C*---------------------------------------------------------------*
D1  C           USINE     IFEQ 2
D2  C           FAATEL    IFEQ '82'
    C           FAATEL    OREQ '83'
    C           FAATEL    OREQ '70'
     C                     Z-ADDPPAA      AAPP
     C                     Z-ADDPPMM      MMPP
     C                     Z-ADDPPJJ      JJPP
D3  C           DATEQ2    IFGE 20060410
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     PPQFEU
     C                     Z-ADDTOTEQ2    PPQFMA
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C*---------------------------------------------------------------*
    C* CAS NEUVILLE     : SI DATE > DATE DEMARRAGE PF => CALFAB      *
    C*                    SI DATE < DATE DEMARRAGE PF => QTE SAISIE  *
    C*---------------------------------------------------------------*
D1  C           USINE     IFEQ 4
D2  C           FAATEL    IFEQ '82'
    C           FAATEL    OREQ '83'
    C           FAATEL    OREQ '70'
     C                     Z-ADDPPAA      AAPP
     C                     Z-ADDPPMM      MMPP
     C                     Z-ADDPPJJ      JJPP
D3  C           DATEQ2    IFGE 20070609
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     PPQFEU
     C                     Z-ADDTOTEQ2    PPQFMA
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C*---------------------------------------------------------------*
    C* CAS FEGERSHEIM   : SI DATE > DATE DEMARRAGE PF => CALFAB      *
    C*                    SI DATE < DATE DEMARRAGE PF => QTE SAISIE  *
    C*---------------------------------------------------------------*
D1  C           USINE     IFEQ 7
D2  C           FAATEL    IFEQ '82'
    C           FAATEL    OREQ '83'
    C           FAATEL    OREQ '70'
     C                     Z-ADDPPAA      AAPP
     C                     Z-ADDPPMM      MMPP
     C                     Z-ADDPPJJ      JJPP
D3  C           DATEQ2    IFGE 20080319
     C                     EXSR CALFAB
     C                     Z-ADDTOTEQ     PPQFEU
     C                     Z-ADDTOTEQ2    PPQFMA
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  SI GACHE MEMORISÉE DANS FAB16P > A CELLE RECALCULÉE
    C******       AFFICHAGE DE CELLE DU FAB16P
    C**
D1  C           SVQFMA    IFGT PPQFMA
     C                     Z-ADDSVQFMA    PPQFMA
F1  C                     ENDIF
     **
     C                     Z-ADD0         A
     C                     MOVE *BLANK    XPCARD
     C           KFAB18    SETLLXFAB18
     C           LEC18A    TAG
     C           KFAB16    READEXFAB18                   99
D1  C           *IN99     IFEQ *OFF
     **
     C                     ADD  1         A
     C                     MOVE PPCARD    TCAD,A
     C                     Z-ADDPPHARD    THAD,A
     C                     Z-ADDPPEARD    TEAD,A
     C                     MOVE PPTARD    TTAD,A
     C                     MOVE PPCARD    FAEVCO
     C           KFAB03    CHAINXFAB03               99
     C                     MOVE FAEVL2    TLAD,A
    C                     GOTO LEC18A
F1  C                     ENDIF
    C**
    C****** SAUVEGARDE DES CODES ARRETS DIVERS
    C**
     C                     MOVE TCAD      XCAD
    C**
     C           FIN1      TAG
     C                     EXSR ARDIV3
     C                     EXFMTF16
    C**
    C****** F5=AFFICHAGE DU SUIVI OF
    C**
D1  C           *IN05     IFEQ *ON
     C                     MOVE CDE       PASCDE 18
     C                     CALL 'FAB610£'
     C           PASCDE    PARM PASCDE    PASCDE
    C                     GOTO FIN1
F1  C                     ENDIF
    C**
    C****** F12=ABANDON ET DEBLOCAGE FAB16P
    C**
D1  C           *IN12     IFEQ *ON
     C                     Z-ADDSVTHRE    TOTHRE
     C                     UNLCKFAB16L01
     C           DERRCY    CHAINF11                  99
     C                     Z-ADDSVHFI2    PPHFIN
     C                     UPDATF11
    C                     GOTO FINF
     C                     Z-ADDSVTHRE    TOTHRE
F1  C                     ENDIF
    C**
    C****** F4=RECHERCHE CODE ARRET DIVERS => TYPE 'D'
    C****** OU        DU CODE DECHET ELIMINES AVANT OP
    C**
D1  C           *IN04     IFEQ *ON
     C                     MOVE *BLANKS   POS10
     C                     MOVEL'PPDECH'  POS10
D2  C           POS2      IFNE POS10
     C                     MOVE 'D'       ZAEVTY
     C                     EXSR WIN
     C                     Z-ADD1         A
     C           '  '      LOKUPTCAD,A                   99
D3  C           *IN99     IFEQ *ON
     C                     MOVE FAEVCO    TCAD,A
F3  C                     ENDIF
    C**
X2  C                     ELSE
    C**
     C                     MOVE *BLANKS   PASCO2
     C                     MOVE '10'      LIGNE
     C                     MOVE *BLANKS   PXLIBE
     C                     CALL 'FEN504£'              85
     C           PASCO2    PARM PASCO2    PASCO2  3
     C           INDI2     PARM INDI2     INDI2   1
     C           LIGNE     PARM LIGNE     LIGNE
     C           PXLIBE    PARM PXLIBE    PXLIBE
F2  C                     ENDIF
D2  C           PASCO2    IFNE *BLANKS
     C                     MOVE PASCO2    PPDECH
F2  C                     ENDIF
    C                     GOTO FIN1
F1  C                     ENDIF
    C**
    C****** IN39 ON => VALIDATION BILAN
    C**
    C           *IN39     CABEQ*ON       OKBILA
    C**
     C                     Z-ADDSVHCAL    PPHCAL
     C                     Z-ADDSVHTIR    PPHTIR
     C                     Z-ADDSVHARR    PPHARR
     C                     Z-ADDSVHPAN    PPHPAN
    C**
    C******  CONTROLE NBRE GROUPES CALES SI IMPRESSION (12 ET 14)
    C**
D1  C           FAATEL    IFEQ '12'
    C           FAATEL    OREQ '14'
    C           PPNCCA    CABGT6         FIN1       40
D2  C           USINE     IFNE 3
    C*          PPNCCA    CABEQ0         FIN1           40
D3  C           PPNCCA    IFEQ 0
    C           PPVERN    ANDEQ' '
     C                     SETON                     40
    C                     GOTO FIN1
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  CONTROLE QTE PRODUITE=0 ET PALETTES CREES ==> ANOMALIE
    C**
D1  C           TOTEQ     IFNE 0
    C           PPQFEU    CABEQ0         FIN1           41
F1  C                     ENDIF
    C**
    C******  CONTROLE QTE FEUILLES : OBLIGATOIRE PPHTIR <> 0
    C******  TEST SUPPRIME A CAUDE DE NEUVILLE : LE 18.02.2004 (JLH)
    C**
    C                     GOTO SQUEEZ
     C           PPQFEU    ADD  PPQFMA    TOTFEU
D1  C           PPHTIR    IFGT 0
D2  C           TOTEQ     IFNE 0
    C           TOTFEU    CABEQ0         FIN1           41
F2  C                     ENDIF
X1  C                     ELSE
    C           TOTFEU    CABNE0         FIN1       4141
F1  C                     ENDIF
    C**
     C           SQUEEZ    TAG
    C**
D1  C           PPUNIT    IFNE 'FE'
    C           PPUNIT    ANDNE'DE'
    C           PPUNIT    ANDNE'KG'
    C           PPUNIT    ANDNE'UN'
    C           PPUNIT    ANDNE'ML'
    C           PPUNIT    ANDNE'M2'
     C                     MOVE *ON       *IN52
    C                     GOTO FIN1
F1  C                     ENDIF
    C**
    C******  CONTROLE QTE ELIMINEE AVANT SECTION
    C**
D1  C           PPDECH    IFNE *BLANK
     C                     MOVE 'MALF'    PXARGU
     C                     MOVE PPDECH    PXVALE
     C                     MOVE *BLANKS   PXLIBE
     C           KEYUSI    CHAINPARAMEF1             45
    C           *IN45     CABEQ*ON       FIN1
    C           PPQELI    CABEQ0         FIN1           44
F1  C                     ENDIF
    C**
    C******  CONTROLE CODE DECHET ELIMINE AVANT SECTION
    C**
D1  C           PPQELI    IFGT 0
    C           PPDECH    CABEQ*BLANK    FIN1           45
F1  C                     ENDIF
    C**
    C******  CONTROLE TYPE VERNIS
    C**
D1  C           PPVERN    IFNE *BLANK
D2  C           PPVERN    IFNE 'F'
    C           PPVERN    ANDNE'U'
    C           PPVERN    ANDNE'K'
    C           PPVERN    ANDNE'B'
    C           PPVERN    ANDNE'G'
    C           PPVERN    ANDNE'A'
    C           PPVERN    ANDNE'E'
    C           PPVERN    ANDNE'Q'
    C           PPVERN    ANDNE'S'
    C           PPVERN    ANDNE'X'
D3  C           USINE     IFNE 3
     C                     MOVE *ON       *IN43
    C                     GOTO FIN1
X3  C                     ELSE
D4  C           PPVERN    IFGE 'A'
    C           PPVERN    ANDLE'Z'
X4  C                     ELSE
     C                     MOVE *ON       *IN43
    C                     GOTO FIN1
F4  C                     ENDIF
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
D1  C           FAATEL    IFEQ '12'
    C           FAATEL    OREQ '14'
D2  C           PPNCCA    IFEQ 0
    C           PPVERN    ANDEQ' '
     C                     MOVE *ON       *IN43
    C                     GOTO FIN1
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  CONTROLE OR/ALU/CUIVRE
    C**
D1  C           PPOR      IFNE *BLANK
D2  C           PPOR      IFNE 'O'
    C           PPOR      ANDNE'A'
    C           PPOR      ANDNE'C'
     C                     MOVE *ON       *IN46
    C                     GOTO FIN1
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  CONTROLE SAISIE HEURE DE FIN D'ÉQUIPE
    C**
D1  C           PPHFRE    IFNE 0
    C           PPHFRE    CABGT2400      FIN1       34
    C           PPHFRE    CABLE0         FIN1         3434
F1  C                     ENDIF
    C**
    C******  CONTROLE DONNEES ARRET DIVERS
    C**
     C                     Z-ADD0         MNARD   40
     C                     Z-ADD0         PPHADI
     C                     Z-ADD0         A       10
     C                     Z-ADD0         B       10
     **
D1  C                     DO   4         A
D2  C           TCAD,A    IFNE *BLANK
     C                     MOVE TCAD,A    FAEVCO
     C           KFAB03    CHAINXFAB03               47
    C           *IN47     CABEQ*ON       FIN1
    C           FAEVTY    CABNE'D'       FIN1       4747
     **
     ******  TEST SI CODE ARRET DIVERS SAISI PLUSIEURS FOIS => ERREUR
     **
     C                     Z-ADD0         B
D3  C                     DO   4         B
D4  C           FAEVCO    IFEQ TCAD,B
    C           A         ANDNEB
     C                     MOVE *ON       *IN55
    C                     GOTO FIN1
F4  C                     ENDIF
F3  C                     ENDDO
     **
     C                     MOVE FAEVL2    TLAD,A
     **
    C           THAD,A    CABEQ0         FIN1           56
     C                     MOVELTHAD,A    HR
     C                     MOVE THAD,A    MN
    C           HR        CABGT24        FIN1       56
    C           MN        CABGT59        FIN1       56
     **
    C           TTAD,A    CABEQ*BLANK    FIN1           50
D3  C           TTAD,A    IFNE 'C'
    C           TTAD,A    ANDNE'R'
    C           TTAD,A    ANDNE'A'
    C           TTAD,A    ANDNE'P'
     C                     MOVE *ON       *IN50
    C                     GOTO FIN1
F3  C                     ENDIF
     **
    C           TEAD,A    CABEQ0         FIN1           49
     **
     C           HR        MULT 60        TMN1
     C                     ADD  MN        TMN1
     C                     ADD  TMN1      MNARD
    C**
X2  C                     ELSE
     C                     Z-ADD0         THAD,A
     C                     MOVE *BLANK    TTAD,A
     C                     Z-ADD0         TEAD,A
     C                     MOVE *BLANK    TLAD,A
F2  C                     ENDIF
    C**
     C                     EXSR ARDIV2
    C           *IN53     CABEQ*ON       FIN1
F1  C                     ENDDO
    C**
    C******  CALCUL TOTAL TEMPS ARRET DIVERS
    C**
D1  C           MNARD     IFNE 0
     C           MNARD     DIV  60        PPHADI    H
X1  C                     ELSE
     C                     Z-ADD0         PPHADI
F1  C                     ENDIF
     C           PPHCAL    ADD  PPHTIR    TOTTPS
     C                     ADD  PPHARR    TOTTPS
     C                     ADD  PPHPAN    TOTTPS
    C           PPHADI    CABGTTOTTPS    FIN1       51
    C**
    C******  TEST SI CUMUL TEMPS < 0 DU FAIT DES ARRETS DIVERS
    C**
    C           PPHCAL    CABLT0         FIN1         54
    C           PPHTIR    CABLT0         FIN1         54
    C           PPHARR    CABLT0         FIN1         54
    C           PPHPAN    CABLT0         FIN1         54
    C**
    C******  IMPOSSIBLE DE CHANGER L'ETAT DE L'OP
    C******  SI OF TERMINE ET SOLDÉ DANS PREACTOR
    C**
     C                     MOVE *OFF      *IN33
D1  C           SVTFIN    IFNE PPTFIN
    C           SVTFIN    ANDNE' '
     C           KFAB5D    CHAINXFAB6B              N99
D2  C           *IN99     IFEQ *OFF
D3  C           FA0601    IFNE ' '
     C                     MOVE SVTFIN    PPTFIN
     C                     MOVE *ON       *IN33
    C                     GOTO FIN1
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  TEST ETAT OP : E=OP NON FINIE  I=INTERROMPUE  T=TERMINEE
    C**
D1  C           PPTFIN    IFNE 'E'
    C           PPTFIN    ANDNE'I'
    C           PPTFIN    ANDNE'T'
     C                     MOVE *ON       *IN59
    C                     GOTO FIN1
F1  C                     ENDIF
    C**
    C******   TEST SI OPERATEUR A SAISI OP TERMINEE
    C******   QUE L'OP PRECEDENTE SOIT TERMINEE
    C******   SAUF POUR LA CLICHERIE QUI EST INDEPENDANTE
    C******         REFUSÉE SINON
    C******   SI L'ETAT = 'ZZ' ==> PAS D'OP PRECEDENTE
    C**
D1  C           PPTFIN    IFEQ 'T'
    C           FAATEL    ANDNE'18'
     C                     Z-ADDUSINE     SAUSIN
     C                     Z-ADDWWCONF    SACONF
     C                     Z-ADDWWSEQ     SASEQ
     C                     Z-ADDWWISEQ    SAISEQ
     C                     Z-ADDWWPRO     SNOPRO
     C                     Z-ADDWWOPNU    SAOPNU
     C                     MOVE WWSECT    SPSECT
     C                     MOVE WWSSEC    SSSECT
     C                     MOVE WWMAC     SNOMAC
     C                     MOVE *BLANKS   SETAOP
     C                     CALL 'FAB618£'              85
     C           PARM6     PARM PARM6     PARM6
D2  C           SETAOP    IFNE 'ZZ'
    C           SETAOP    CABNE'TR'      FIN1       2929
F2  C                     ENDIF
F1  C                     ENDIF
    C**
     C                     MOVE LIFI,2    LIBFI1
D1  C           PPTFIN    IFEQ 'I'
     C                     MOVE LIFI,3    LIBFI1
F1  C                     ENDIF
    C**
    C******  TEST SI TOUS LES ENCOURS ONT ETE CONSOMMÉS
    C******  LORSQUE L'OPERATION EST DITE TERMINÉE
    C**
D1  C           PPTFIN    IFEQ 'T'
     C                     Z-ADD0         FATENC
     C                     MOVE 'C'       FAEFC
     C           KFAB13    SETLLXFAB13
     C           LEC13P    TAG
     C           KFA13A    READEXFAB13                   99
D2  C           *IN99     IFEQ *OFF
     C                     Z-ADD0         YYOPNU
     C                     Z-ADD0         FACBPA
     C                     Z-ADD0         NOBOU
     C           KFA10A    SETLLTFAB10
     C           LEC10A    TAG
     C           KFA10B    READETFAB10                   99
D3  C           *IN99     IFEQ *OFF
    C           FAOPNU    CABEQXAOPNU    LEC10A
     C                     EXFMTF95
    C                     GOTO SAUTR1
F3  C                     ENDIF
    C                     GOTO LEC13P
F2  C                     ENDIF
F1  C                     ENDIF
    C**
     C           SAUTR1    TAG
    C**
    C******  DOUBLE VALIDATION : *IN39 ON
    C**
D1  C           *IN39     IFEQ *OFF
     C                     MOVE *ON       *IN39
    C                     GOTO FIN1
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER FAB16P : EQUIPE TERMINEE
    C**
     C           OKBILA    TAG
     C                     EXSR SPBIL
     C                     EXFMTF16B
     C                     MOVE 'T'       FA1601
    C**
     C                     UPDATXFAB16
    C**
    C******  SUPPRESSION ENREGISTREMENT DANS FAB22P
    C******  CELA SIGNIFIE QE LES MODIFICATIONS DE L'ÉQUIPE
    C******  ONT ÉTÉ VALIDÉES
    C**
     C           KFAB16    CHAINXFAB22               99
     C                     MOVE 'T'       FA2201
    C**
D1  C           *IN99     IFEQ *OFF                       TMAELE 25/01/13
D2  C           FA2201    IFEQ 'T'
    C           FA2202    ANDEQ'T'
     C                     EXCPTDEL22
X2  C                     ELSE
     C                     EXCPTMAJ22
F2  C                     ENDIF
F1  C                     ENDIF                           TMAELE 25/01/13
    C**
    C******  MAJ FICHIER FAB18P : DETAIL TEMPS DIVERS
    C**
    C**
    C******  SUPPRESSION DES CODES ARRETS DANS FAB18P
    C******  AVANT DE LES RECREER SI SAISIS
    C**
     C                     Z-ADD0         A
D1  C                     DO   4         A
D2  C           XCAD,A    IFNE *BLANK
     C                     MOVE XCAD,A    XPCARD
     C           KFAB18    CHAINXFAB18               99
D3  C           *IN99     IFEQ *OFF
     C                     DELETXFAB18
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDDO
    C**
D1  C           PPHADI    IFGT 0
     C                     Z-ADD0         A
D2  C                     DO   4         A
D3  C           TCAD,A    IFNE *BLANK
     C                     MOVE TCAD,A    XPCARD
     C           KFAB18    CHAINXFAB18               99
     C                     MOVE TCAD,A    PPCARD
     C                     Z-ADDTHAD,A    PPHARD
     C                     MOVE TTAD,A    PPTARD
     C                     Z-ADDTEAD,A    PPEARD
D4  C           *IN99     IFEQ *ON
     C                     WRITEXFAB18
X4  C                     ELSE
     C                     UPDATXFAB18
F4  C                     ENDIF
F3  C                     ENDIF
F2  C                     ENDDO
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER FAB05P : RECHERCHE DE L'ETAT DE L'OP
    C******         ==> CELUI DE LA DERNIERE EQUIPE
    C**
     C                     Z-ADDWWUSIN    WAUSIN
     C                     Z-ADDWWCONF    WACONF
     C                     Z-ADDWWSEQ     WASEQ
     C                     Z-ADDWWISEQ    WAISEQ
     C                     Z-ADDWWPRO     WNOPRO
     C                     Z-ADDWWOPNU    WAOPNU
     C                     MOVE WWSECT    WSECT
     C                     MOVE WWSSEC    WSSECT
     C                     MOVE WWMAC     WNOMAC
     C                     MOVE *BLANKS   WETAT
     C                     CALL 'FAB581£'              85
     C           PAS6      PARM PAS6      PAS6
    C**
    C******   SI AUCUNE EQUIPE TROUVEE ==> CELUI DE L'EQUIPE CREEE
    C**
D1  C           WETAT     IFNE *BLANKS
     C                     MOVE WETAT     SVTFIN
X1  C                     ELSE
     C                     MOVE PPTFIN    SVTFIN
F1  C                     ENDIF
     **
D1  C           SVTFIN    IFEQ 'T'
    C           SVTFIN    OREQ 'E'
    C           SVTFIN    OREQ 'I'
     C           KFAB5C    CHAINZFAB05               99
D2  C           *IN99     IFEQ *OFF
D3  C           SVTFIN    IFEQ 'T'
     C                     MOVE 'TR'      FAOPST
D4  C           USINE     IFEQ 3
    C           SECT      ANDEQ'2'
    C           SSECT     ANDEQ'1'
    C           NOMAC     ANDEQ'10'
     C                     MOVE 'S'       FA0501
F4  C                     ENDIF
F3  C                     ENDIF
D3  C           SVTFIN    IFEQ 'E'
     C                     MOVE 'EC'      FAOPST
     C                     MOVE ' '       FA0501
F3  C                     ENDIF
D3  C           SVTFIN    IFEQ 'I'
     C                     MOVE 'IN'      FAOPST
     C                     MOVE ' '       FA0501
F3  C                     ENDIF
     C                     UPDATZFAB05
     C                     EXSR COMPLX
F2  C                     ENDIF
     **
     ******  DEPOINTAGE OF DS FAB06P=>ENVOI A PREACTOR SI 'EC' OU 'IN'
     **
D2  C           FAOPST    IFEQ 'EC'
    C           FAOPST    OREQ 'IN'
     C           KFAB5D    CHAINXFAB6B               99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE *BLANK    FA0601
     C                     UPDATXFAB6B
F3  C                     ENDIF
F2  C                     ENDIF
     **
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER PDFINI SI PRODUIT FABRIQUE = PRODUIT FINI
    C******  'S' SI OP TERMINEE ET 'P' SINON DS ZONE PASO
    C**
D1  C           USINE     IFEQ 3
    C           USINE     OREQ 4
    C           USINE     OREQ 5
    C           USINE     OREQ 2
    C           USINE     OREQ 7
D2  C           SVTENC    IFEQ 9
     C                     Z-ADDUSINE     XYUSI
     C                     Z-ADDSTE       XYSTE
     C                     Z-ADDNOCLI     XYCLI
     C                     Z-ADDNOPRO     XYPRO
     C                     Z-ADDFACONF    XYCONF
     C                     Z-ADDFASEQ     XYSEQ
D3  C           FAOPST    IFEQ 'TR'
     C                     MOVE 'S'       XYSOLD
X3  C                     ELSE
     C                     MOVE 'P'       XYSOLD
F3  C                     ENDIF
     C                     CALL 'FAB636£'
     C           PARM13    PARM PARM13    PARM13
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER PREFOU SI PRODUIT FABRIQUE = PRODUIT FINI
    C******  'S' SI OP TERMINEE ET 'P' SINON DS ZONE PASO
    C**
    C******  ATTENTION SI RIEN DE FABRIQUÉ LA MAJ NE SE FAIT PAS
    C******         CAR SVTENC EST DIFFERENT DE 9
    C**
D1  C           USINE     IFEQ 4
    C           TS1       ANDEQ'F'
    C           NOCLI     ANDEQ8928
    C           SVTENC    ANDEQ9
     C                     Z-ADDUSINE     XYUSI
     C                     Z-ADDSTE       XYSTE
     C                     Z-ADDNOCLI     XYCLI
     C                     Z-ADDNOPRO     XYPRO
     C                     Z-ADDFACONF    XYCONF
     C                     Z-ADDFASEQ     XYSEQ
     C           KPRFOU    CHAINPREFOUF1             99
D2  C           *IN99     IFEQ *OFF
D3  C           FAOPST    IFEQ 'TR'
     C                     MOVE '*'       SOBESO
X3  C                     ELSE
     C                     MOVE ' '       SOBESO
F3  C                     ENDIF
     C                     EXCPTMAJFOU
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ PRLANC => OFETA = 'TR' OF SUR PRIORI TERMINE
    C******  ET  SOLDE DES RESEVATIONS DE PAPIERS
    C**
D1  C           FAOPST    IFEQ 'TR'
     C                     EXSR LANC
     C                     EXSR MAJRES
F1  C                     ENDIF
    C**
    C******  MAJ PRLANC => OFETA = 'EC' OP EN COURS
    C**
D1  C           FAOPST    IFEQ 'EC'
    C           FAOPST    OREQ 'IN'
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      OFETA
     C                     EXCPTMAJLAN
F2  C                     ENDIF
F1  C                     ENDIF
     **
     ******  SI ROCHECHOUART COMPLEXEUSE EN TANDEM => FORCER EN 2206
     ******  SAISIE SUR 1303 MAIS MAJ SORTIE PAPIER 2206
     ******  SI TANDEM : T2207='O'
     **
     C                     MOVE 'N'       T2207
D1  C           USINE     IFEQ 2
    C           FAATEL    ANDEQ'13'
    C           NOMAC     ANDEQ'03'
     C                     Z-ADDUSINE     TAUSIN
     C                     Z-ADDFACONF    TACONF
     C                     Z-ADDFASEQ     TASEQ
     C                     Z-ADDFAISEQ    TAISEQ
     C                     Z-ADDNOPRO     TNOPRO
     C                     Z-ADDFAOPNU    TAOPNU
     C                     MOVE 'N'       T2207
     C                     CALL 'FAB603£'              85
     C           PARM3     PARM PARM3     PARM3
     **
F1  C                     ENDIF
    C**
    C******  MAJ DE HISTOFA2
    C**
     C                     CLEARENREG2
    C**
    C******  RECUP DE SECPAP DS FAB15P
    C**
     C                     MOVE *BLANK    SECPAP
     **
     C           KFAB15    CHAINXFAB15              N99
D1  C           *IN99     IFEQ *ON
     C                     MOVE *BLANKS   SECPAP
     C                     MOVE *BLANKS   SUPOR
F1  C                     ENDIF
     **
D1  C           SECPAP    IFNE 'I'
     C                     MOVE SECPAP    EBSUP
X1  C                     ELSE
     C                     MOVE SUPOR     EBSUP
F1  C                     ENDIF
    C**
     C                     Z-ADDUSINE     EBUSIN
     C                     Z-ADDFACONF    EBCONF
     C                     Z-ADDFASEQ     EBSEQ
    C**
    C*****  SI TANDEM COMPLEXE REMONTEE EN 2207
    C**
D1  C           T2207     IFEQ 'O'
     C                     MOVE '2'       EBSEC
     C                     MOVE '2'       EBSSEC
     C                     MOVE '07'      EBMAC
X1  C                     ELSE
     C                     MOVE SECT      EBSEC
     C                     MOVE SSECT     EBSSEC
     C                     MOVE NOMAC     EBMAC
F1  C                     ENDIF
    C**
    C*****    POUR CHABANAIS SI MACHINE = 5402
    C*****    FANJFA=1 ==>  CHANGEMENT DE LA MACHINE EN 4102
    C*****    FANJFA>1 ==>  CHANGEMENT DE LA MACHINE EN 5102
    C*****    FANJFA :  ZONE PROVENANT DU FAB05P
    C*****    SI MACHINE = 5488 ==> CHANGEMENT DE LA MACHINE EN 4101
    C*****    LES AUTRES "54" SONT DES "51"
    C**
D1  C           USINE     IFEQ 5
    C           FAATEL    ANDEQ'54'
    C*
D2  C                     SELEC
    C* MACHINE = 5402
     C           NOMAC     WHEQ '02'
    C*
D3  C           FANJFA    IFEQ 1
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
X3  C                     ELSE
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
F3  C                     ENDIF
    C* MACHINE = 5488
     C           NOMAC     WHEQ '88'
    C*
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '01'      EBMAC
    C* AUTRES MACHINES
     C                     OTHER
    C*
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
F2  C                     ENDSL
    C*
F1  C                     ENDIF
    C**
    C******  MACHINE=6799 => RECHERCHE DS PREACOP DE LA MACHINE A
    C******  A REMONTER DANS PROD79£.
    C******  !! SI 6799 AJOUTEE A LA GAMME DS SUIVI => NE PAS REMONTER
    C**
D1  C           FAATEL    IFEQ '67'
    C           NOMAC     ANDEQ'99'
    C           FA0503    CABEQ'M'       FINF
     C           KPREOP    CHAINPREACOPF             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE XSECT     EBSEC
     C                     MOVE XSSECT    EBSSEC
     C                     MOVE XMAC      EBMAC
F2  C                     ENDIF
F1  C                     ENDIF
    C**
     C                     Z-ADDSTE       EBSTE
     C                     Z-ADDNOCLI     EBCLI
     C                     Z-ADDNOPRO     EBPRO
     C                     Z-ADDPPEQUI    EBEQU
     C                     Z-ADDPPPAS     EBPAS
     C                     Z-ADDDATEQ     EBDAT1
     C                     Z-ADD*DATE     EBDAT2
    C**
    C******  HEURE DE FIN OP : EQUIPE NUIT+DATE DU LENDEMAIN => +24H
    C**
     C                     Z-ADDSVHFI2    EBHEUR
D1  C           PPEQUI    IFEQ 3
    C           SVHFI2    ANDLT700
     C                     ADD  2400      EBHEUR
F1  C                     ENDIF
    C**
     C                     Z-ADDCMATR     EBCOND
     C                     Z-ADDPPHCAL    EBTCAL
     C                     Z-ADDPPHTIR    EBTROU
     C           PPHARR    ADD  PPHPAN    EBTDIV
     C                     ADD  PPHADI    EBTDIV
    C**  PAS D'EFFECTIF CALAGE SI HEURES CALAGE=0
D1  C           EBTCAL    IFEQ 0
     C                     Z-ADD0         EBEFFC
X1  C                     ELSE
     C                     Z-ADDPPEFFC    EBEFFC
F1  C                     ENDIF
    C**  PAS D'EFFECTIF TIRAGE SI HEURES TIRAGE=0
D1  C           EBTROU    IFEQ 0
    C           EBTDIV    ANDEQ0
     C                     Z-ADD0         EBEFFR
X1  C                     ELSE
     C                     Z-ADDPPEFFR    EBEFFR
F1  C                     ENDIF
    C**
     C           PPQFEU    ADD  PPGACA    EBQTOT
     C                     Z-ADDPPQFEU    EBQBON
     C                     Z-ADDPPGACA    EBQRC
     C                     Z-ADDPPQFMA    EBQRR
    C**
     C                     MOVE PPDECH    EBCELI
     C                     Z-ADDPPQELI    EBQELI
    C**
    C*****   CONVERSION DES QTES BOITES EN FEUILLES SI DECORTICAGE
    C*****    OU SI PRODUITS FINIS AVANT DECORTICAGE A TOURY
    C**
D1  C           POSF1     IFEQ 0
D2  C           USINE     IFEQ 3
    C           FAATEL    ANDEQ'21'
    C**   UVENT=3 ==> 100 ML  : QTE À DIVISER PAR POSLAI
    C           UVENT     ANDEQ3
    C**   CALCUL DE POSLAI
     C                     Z-ADD0         POSLAI
     C           LMINI     MULT 10        LMINIM  50
     C           FACON     COMP 5                    99  99
     C   99      FACON     COMP 8                      9999
     C   99      LMINIM    DIV  ONDL      POSLAI  20
     C  N99      LMINIM    DIV  DECL      POSLAI
     C                     Z-ADDPOSLAI    POSF1
X2  C                     ELSE
     C                     Z-ADD1         POSF1
F2  C                     ENDIF
F1  C                     ENDIF
    C**
D1  C           FAATEL    IFEQ '70'
    C           NOMAC     ANDNE'10'
    C           NOMAC     ANDNE'03'
    C           FAATEL    ORGT '12'
    C           FAATEL    ANDLT'70'
    C           USINE     ANDEQ3
    C**
D2  C           PPUNIT    IFEQ 'PF'
    C           PPUNIT    OREQ 'DE'
    C           PPUNIT    OREQ 'ML'
    C           PPUNIT    OREQ 'KG'
     C           EBQTOT    DIV  POSF1     EBQTOT    H
     C           EBQBON    DIV  POSF1     EBQBON    H
     C           EBQTOT    SUB  EBQBON    EBQRC
     C           EBQRR     DIV  POSF1     EBQRR     H
     C           EBQELI    DIV  POSF1     EBQELI    H
F2  C                     ENDIF
F1  C                     ENDIF
    C**
     C                     MOVE *BLANK    EBETIQ
     C                     Z-ADD0         EBCBPA
     C                     Z-ADD0         EBTENC
     C                     Z-ADDPPNCCA    EBCOUL
     C                     MOVE PPVERN    EBTVER
    C**
    C******  MAJ N° OP => SI OP RAJOUTEE DS SUIVI (TYPE 6) => ENVOYER
    C******               SUR OP D'ORIGINE
    C**
     C                     Z-ADDFAOPNU    EBOPNU
     **
     C                     MOVE FAOPNU    TYPOP   10
D1  C           TYPOP     IFGE 6
     C                     SUB  5         TYPOP
     C                     MOVE TYPOP     EBOPNU
F1  C                     ENDIF
D1  C*          FAATEL    IFEQ '82'
    C*          EBOPNU    ANDGT1
     C*                    MOVE '1'       EBOPNU
F1  C*                    ENDIF
    C*****  SI TANDEM COMPLEXE FAOPNU CELUI DE LA 1303
D1  C           T2207     IFEQ 'O'
     C                     MOVE TAOPNU    EBOPNU
F1  C                     ENDIF
    C**
     C                     MOVE FAOPST    EBOPST
D1  C           EBOPST    IFEQ *BLANK
     C                     MOVE 'EC'      EBOPST
F1  C                     ENDIF
     C                     MOVE 'Z'       EBTAG
    C**
     C                     MOVE TAD1      EBCAD
     C                     Z-ADDTAD2      EBTAD
     C                     MOVE TAD3      EBIAD
     C                     Z-ADDTAD4      EBEAD
     C                     MOVE FATRSP    EBTRSP
    C**
    C*****   GESTION DES A COTES : ONDULEUSE 10 DE TOURY
    C**
     C                     Z-ADD0         EBPOS1
     C                     Z-ADD0         EBPOS2
     C                     Z-ADD0         EBQACO
D1  C           USINE     IFEQ 3
    C           POSF2     ANDGT0
    C           FAATEL    ANDGE'21'
    C           FAATEL    ANDLT'70'
D2  C           TOTEQG    IFGT 0
     C                     Z-ADDPOSF1     EBPOS1
F2  C                     ENDIF
D2  C           TOTEQD    IFGT 0
     C                     Z-ADDPOSF2     EBPOS2
     C                     Z-ADDTOTEQD    EBQACO
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C*****   SI OPERATION = MONTAGE CLICHERIE  (UTILISÉE À TOURY)
    C*****    PAS DE MAJ DE HISTOFA2
    C**
    C           FAATEL    CABEQ'18'      FINF
    C**
    C*****   SI LA ZONE OPLIB (DU PRECAOP) = FINITION
    C*****        PAS DE MAJ DE HISTOFA2 ==> CONDITIONNEMENT
    C**
D1  C           USINE     IFEQ 4
    C           OPLIB     CABEQLB,1      FINF
F1  C                     ENDIF
    C**
    C*****   SI OP FACONNAGE SE TERMINANT PAR 9 (OP TRANSFERT USINE)
    C*****        PAS DE MAJ DE HISTOFA2
    C**
D1  C           FAOPNU    IFGT 9000
     C                     MOVE FAOPNU    TYPOP2  10
D2  C           FAATEL    IFEQ '70'
    C           NOMAC     ANDEQ'05'
X2  C                     ELSE
    C           TYPOP2    CABEQ9         FINF
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C*****  TEST SI DECOMPTAGE D'UN CALAGE SUR CETTE FAB
    C**
     C                     Z-ADDUSINE     XJUSIN
     C                     MOVE SECT      XJSECT
     C                     MOVE SSECT     XJSSEC
     C                     MOVE NOMAC     XJNOMA
     C                     Z-ADDFACONF    XJCONF
     C                     Z-ADDFASEQ     XJSEQ
     C                     Z-ADDFAISEQ    XJISEQ
     C                     Z-ADDNOPRO     XJPRO
     C                     Z-ADDFAOPNU    XJOPNU
     C                     Z-ADDPPAA      XJPPAA
     C                     Z-ADDPPMM      XJPPMM
     C                     Z-ADDPPJJ      XJPPJJ
     C                     Z-ADDPPEQUI    XJEQUI
     C                     Z-ADD0         XJNBCA
     C                     CALL 'FAB664£'
     C           PARM30    PARM PARM30    PARM30
     C                     Z-ADDXJNBCA    EBNCAL
    C**
    C*****   GESTION DES A COTES : TOURY
    C*****   DOUBLE MAJ DE HISTOFA2 APRÉS ONDULEUSE
    C**
D1  C           USINE     IFEQ 3
    C           POSF2     ANDGT0
    C           FAATEL    ANDGT'21'
    C           FAATEL    ANDLT'70'
D2  C           TOTEQG    IFGE 0
     C                     Z-ADDTOTEQG    EBQTOT
     C                     Z-ADDTOTEQG    EBQBON
     C                     Z-ADDPOSF1     EBPOS1
     C                     Z-ADD0         EBPOS2
     C                     Z-ADD0         EBQACO
    C*
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C*
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F2  C                     ENDIF
    C**
D2  C           TOTEQD    IFGT 0
     C                     Z-ADDTOTEQD    EBQTOT
     C                     Z-ADDTOTEQD    EBQBON
     C                     Z-ADD0         EBQRC
     C                     Z-ADD0         EBQRR
     C                     Z-ADD0         EBPOS1
     C                     Z-ADDPOSF2     EBPOS2
     C                     Z-ADDTOTEQD    EBQACO
     C                     Z-ADD0         EBTCAL
     C                     Z-ADD0         EBTROU
     C                     Z-ADD0         EBTDIV
     C                     MOVE *BLANK    EBCELI
     C                     Z-ADD0         EBQELI
     C                     MOVE *BLANK    EBCAD
     C                     Z-ADD0         EBTAD
     C                     MOVE *BLANK    EBIAD
     C                     Z-ADD0         EBEAD
     C                     Z-ADD0         EBNCAL
    C*
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C*
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F2  C                     ENDIF
    C******
X1  C                     ELSE
    C******  TOUS LES AUTRES CAS
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C**
    C******  MAJ FAB21P => HISTORIQUE MVTS TRANSMIS A HISTOFA2
    C**
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F1  C                     ENDIF
    C**
    C           FINF      ENDSR
    C*****************************************************************
    C*                                                               *
    C*  SR : AFFICHAGE FENETRE SAISIE OBSERVATIONS                   *
    C*                                                               *
    C*****************************************************************
    C           WINOB     BEGSR
    C**
    C****** TRAVAIL TERMINE => VISU SLT ET *IN49 ON
    C**
D1  C           FA1601    IFEQ 'T'
    C*                    MOVE *ON       *IN49
X1  C                     ELSE
     C                     MOVE *OFF      *IN49
F1  C                     ENDIF
    C**
     C                     Z-ADD0         PPOROB
     C                     MOVE *BLANK    PPOBS
     C                     MOVEA'1000'    *IN,55
     C                     WRITEF20
     C                     Z-ADD0         RCT
     C                     Z-ADD0         SAVRCT
     C                     Z-ADD0         SAVORB
     C                     SETOF                     55
    C**
    C****** REMPLISSAGE DU SOUS-FICHIER
    C**
     C           QAB       TAG
D1  C                     DO   7
     C                     ADD  1         PPOROB
    C**
    C****** NBRE MAXI OBSERVATIONS = 16 (99+1=00 DS UNE ZONE DE 2)
    C**
D2  C           PPOROB    IFEQ 17
     C                     MOVE *ON       *IN58
     C                     LEAVE
F2  C                     ENDIF
    C**
     C           KFAB19    CHAINXFAB19              N99
D2  C           *IN99     IFEQ *ON
     C                     MOVE *BLANK    PPOBS
F2  C                     ENDIF
    C**
     C                     ADD  1         RCT
     C                     Z-ADDRCT       SAVRCT
     C                     Z-ADDPPOROB    SAVORB
     C                     WRITEF19
F1  C                     ENDDO
    C**
    C****** AFFICHAGE DU FORMAT DE CONTROLE F20
    C**
     C           QUITE     TAG
     C                     SETON                     57
     C           RCT       COMP 0                    56
     C                     EXFMTF20
D1  C           *IN12     IFEQ *ON
     C                     Z-ADD0         PPOROB
    C                     GOTO QINF
F1  C                     ENDIF
    C**
D1  C           *IN04     IFEQ *ON
     C                     CLEARDSPARM
     C                     MOVEL'OBSA'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
    C                     GOTO QUITE
F1  C                     ENDIF
    C**
D1  C           *IN26     IFEQ *ON
D2  C           *IN58     IFEQ *OFF
     C                     Z-ADDSAVORB    PPOROB
     C                     Z-ADDSAVRCT    RCT
    C                     GOTO QAB
F2  C                     ENDIF
     C                     Z-ADDSAVRCT    RCT
    C                     GOTO QUITE
F1  C                     ENDIF
    C**
    C           *IN49     CABEQ*ON       QINF
    C**
    C****** LECTURE DU SOUS-FICHIER
    C**
D1  C                     DO   17        KK      20
     C           KK        CHAINF19                  81
D2  C           PPOB2     IFNE *BLANKS
     C                     MOVE 'OBSA'    PXARGU
     C                     MOVE PPOB2     PXVALE    P
     C           KEYUSI    CHAINPARAMEF1             69
    C           *IN69     CABEQ'1'       QUITE
F2  C                     END
    C**
D2  C           PPOBS     IFEQ *BLANK
     C           KFAB19    CHAINXFAB19               99
D3  C           *IN99     IFEQ *OFF
     C                     DELETXFAB19
F3  C                     ENDIF
X2  C                     ELSE
     C                     MOVE PPOBS     SAVOBS
     C           KFAB19    CHAINXFAB19               99
D3  C           *IN99     IFEQ *OFF
     C                     MOVE SAVOBS    PPOBS
     C                     UPDATXFAB19
X3  C                     ELSE
     C                     WRITEXFAB19
F3  C                     ENDIF
F2  C                     ENDIF
    C**
F1  C                     END
    C**
    C           QINF      ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : CALCUL QTE FABRIQUEE SUR UN TRAVAIL EN COURS       *
    C*                                                               *
    C*****************************************************************
    C           CALFAB    BEGSR
    C**
     C                     Z-ADD0         TOTEQ
     C                     Z-ADD0         TOTEQG
     C                     Z-ADD0         TOTEQD
     C                     Z-ADD0         TOTEQ2
     C                     Z-ADD0         SVTENC
    C**
D1  C           FAATEL    IFNE '13'
    C           FAATEL    ANDNE'15'
    C           FAATEL    ANDNE'22'
    C**
     C                     Z-ADD0         FACBPA
     C                     Z-ADD0         NOBOU
     C           KFAB10    SETLLXFAB10
    C**
     C           LEC10     TAG
     C           KFAB16    READEXFAB10                   99
D2  C           *IN99     IFEQ *OFF
    C           NOBOU     CABNE0         LEC10
     C                     ADD  FAQTFE    TOTEQ
     C                     ADD  FAQTGA    TOTEQ2
D3  C           FA1001    IFEQ 'G'
     C                     ADD  FAQTFE    TOTEQG
F3  C                     ENDIF
D3  C           FA1001    IFEQ 'P'
     C                     ADD  FAQTFE    TOTEQD
F3  C                     ENDIF
     C                     Z-ADDFATENC    SVTENC
    C                     GOTO LEC10
F2  C                     ENDIF
    C**
X1  C                     ELSE
    C**
    C******  CALCUL DE LA QUANTITÉ PAPIER PRODUITE
    C**
     C                     MOVE *BLANKS   PAPI
     C                     Z-ADD0         GRAMM
     C                     MOVE *BLANKS   REFOUR
     C                     Z-ADD0         GRAREL
     C                     MOVE *BLANKS   FOUB
     C                     Z-ADD0         FACBPA
     C           KFAB11    SETLLZFAB11
     **
     C           LEC11     TAG
     C           KFAB16    READEZFAB11                   99
D2  C           *IN99     IFEQ *OFF
     C                     ADD  NBFE      TOTEQ
     C                     SUB  FAQRES    TOTEQ
    C                     GOTO LEC11
F2  C                     ENDIF
    C**
F1  C                     ENDIF
    C**
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C* SR : REMPLISSAGE DES TABLES ARRETS DIVERS POUR MAJ HISTOFA2   *
    C*      EVENEMENTS HORODATES <=> FAEVCO = 'A' OU 'P'             *
    C*                                                               *
    C*****************************************************************
    C           ARDIV1    BEGSR
     C           TMN3      DIV  60        HCT     42H
    C           HCT       CABEQ0         ARDIF1
    C**
    C******  RECHERCHE DU 1ER POSTE DE LIBRE DS TABLEAU
    C**
     C                     Z-ADD1         Y       10
     C           FAEVCO    LOKUPTAD1,Y                   99
D1  C           *IN99     IFEQ *ON
     C                     ADD  HCT       TAD2,Y
X1  C                     ELSE
     C           '  '      LOKUPTAD1,Y                   99
     **
     ******  SI TABLEAU PLEIN <=> + 6 POSTES => IMPOSSIBLE
     **
    C           *IN99     CABEQ*OFF      ARDIF1         53
     **
     C                     ADD  HCT       TAD2,Y
     C                     MOVE FAEVCO    TAD1,Y
    C**
    C******  SI CODE="NU" : NON UTILISE ==> EFFECTIF=0
    C**
D2  C           TAD1,Y    IFEQ 'NU'
     C                     Z-ADD0         TAD4,Y
X2  C                     ELSE
     C                     Z-ADDPPEFFR    TAD4,Y
F2  C                     ENDIF
     C                     MOVE *BLANK    TAD3,Y
F1  C                     ENDIF
    C**
    C           ARDIF1    ENDSR
    C*****************************************************************
    C*                                                               *
    C* SR : REMPLISSAGE DES TABLES ARRETS DIVERS POUR MAJ HISTOFA2   *
    C*      EVENEMENTS NON HORODATES <=> FAEVCO = 'D'                *
    C*                                                               *
    C*****************************************************************
    C           ARDIV2    BEGSR
    C           THAD,A    CABEQ0         ARDIF2
    C**
     C                     MOVE THAD,A    MN
     C                     MOVELTHAD,A    HR
     C           HR        MULT 60        TMN1
     C                     ADD  MN        TMN1
     C           TMN1      DIV  60        HCT       H
    C**
    C******  DEDUCTION TEMPS ARRET DIVERS DES AUTRES TOTAUX
    C**
D1  C           TTAD,A    IFEQ 'C'
     C                     SUB  HCT       PPHCAL
F1  C                     ENDIF
D1  C           TTAD,A    IFEQ 'R'
     C                     SUB  HCT       PPHTIR
F1  C                     ENDIF
D1  C           TTAD,A    IFEQ 'A'
     C                     SUB  HCT       PPHARR
F1  C                     ENDIF
D1  C           TTAD,A    IFEQ 'P'
     C                     SUB  HCT       PPHPAN
F1  C                     ENDIF
    C**
    C******  RECHERCHE DU 1ER POSTE DE LIBRE DS TABLEAU
    C**
     C                     Z-ADD1         Y
     C                     MOVE TCAD,A    EVCO
     C           EVCO      LOKUPTAD1,Y                   99
D1  C           *IN99     IFEQ *ON
     C                     ADD  HCT       TAD2,Y
X1  C                     ELSE
     C           '  '      LOKUPTAD1,Y                   99
     **
     ******  SI TABLEAU PLEIN <=> + 6 POSTES => IMPOSSIBLE
     **
    C           *IN99     CABEQ*OFF      ARDIF2         53
     **
     C                     ADD  HCT       TAD2,Y
     C                     MOVE TCAD,A    TAD1,Y
     C                     Z-ADDTEAD,A    TAD4,Y
     C                     MOVE TTAD,A    TAD3,Y
F1  C                     ENDIF
    C**
    C           ARDIF2    ENDSR
    C*****************************************************************
    C*                                                               *
    C* SR:REMISE A ZERO CUMULS TEMPS ARRETS DIVERS SI ERREUR TROUVEE *
    C*                                                               *
    C*****************************************************************
    C           ARDIV3    BEGSR
    C           *IN39     CABEQ*ON       ARDIF3
    C**
     C                     Z-ADD0         B
    C**
D1  C                     DO   6         B
     **
D2  C           TAD1,B    IFNE *BLANK
     C                     MOVE TAD1,B    FAEVCO
     C           KFAB03    CHAINXFAB03               99
     **
D3  C           *IN99     IFEQ *OFF
    C           FAEVTY    ANDEQ'D'
     C                     Z-ADD0         TAD2,B
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDDO
    C**
    C           ARDIF3    ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MAJ FICHIER PRLANC POUR OF (PRIORI) TERMINE        *
    C*                                                               *
    C*****************************************************************
    C           LANC      BEGSR
    C**
     C                     Z-ADDUSINE     VVUSI
     C                     Z-ADDFACONF    VVCONF
     C                     Z-ADDFASEQ     VVSEQ
     C                     Z-ADDFAISEQ    VVISEQ
     C                     Z-ADDNOPRO     VVPRO
     C                     Z-ADDPRIOR1    VVPRIO
     C                     MOVE *BLANK    VVETAT
     C                     CALL 'FAB518£A'
     C           PARM9     PARM PARM9     PARM9
    C**  VVETAT ='TR' => TOUTES LES OP SONT TERMINÉES
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D1  C           *IN99     IFEQ *OFF
D2  C           VVETAT    IFEQ 'TR'
     C                     MOVE 'TR'      OFETA
X2  C                     ELSE
     C                     MOVE 'EC'      OFETA
F2  C                     ENDIF
     C                     EXCPTMAJLAN
F1  C                     ENDIF
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MAJ FICHIER PRLANC POUR OF (PRIORI) NON COMMENCE   *
    C*                                                               *
    C*****************************************************************
    C           LANC1     BEGSR
    C**
     C                     Z-ADDUSINE     VVUSI
     C                     Z-ADDFACONF    VVCONF
     C                     Z-ADDFASEQ     VVSEQ
     C                     Z-ADDFAISEQ    VVISEQ
     C                     Z-ADDNOPRO     VVPRO
     C                     Z-ADDPRIOR1    VVPRIO
     C                     MOVE *BLANK    VVETAT
     C                     CALL 'FAB518£B'
     C           PARM9     PARM PARM9     PARM9
D1  C           VVETAT    IFEQ 'LC'
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE 'LC'      OFETA
     C                     EXCPTMAJLAN
F2  C                     ENDIF
F1  C                     ENDIF
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : SOLDE DES RESERVATIONS DE PAPIERS,D'IMPRIMÉS       *
    C*                  ET DE COMMANDES DE PRÉ-IMPRIMÉS              *
    C*                                                               *
    C*****************************************************************
    C           MAJRES    BEGSR
    C**  ATELIER 18:CLICHERIE ET > 54 PAS DE MAJ
    C           FAATEL    CABEQ'18'      FINRES
    C           FAATEL    CABGT'54'      FINRES
    C**  OP  S.E.D. NON TRAITÉE
    C           FACONF    CABGE99000     FINRES
    C**  MAJ UNIQUEMENT POUR LES USINES DE
    C**  ROCHECHOUART-TOURY-CHABANAIS
    C           USINE     CABEQ4         FINRES
    C           USINE     CABEQ7         FINRES
    C**  RECHERCHE SI ETAT ='TR'
     C                     MOVE *BLANK    VVETAT
     C                     CALL 'FAB518£D'
     C           PARM9     PARM PARM9     PARM9
    C           VVETAT    CABNE'TR'      FINRES
    C**  SOLDE DES RESERVATIONS DE PAPIERS      (RESPAP/RESCXH)
     C                     Z-ADDUSINE     WWUSIN
     C                     MOVE SECT      WWSECT
     C                     MOVE SSECT     WWSSEC
     C                     MOVE NOMAC     WWMAC
     C                     Z-ADDFACONF    WWCONF
     C                     Z-ADDFASEQ     WWSEQ
     C                     Z-ADDFAISEQ    WWISEQ
     C                     Z-ADDSTE       WWSTE
     C                     Z-ADDNOCLI     WWCLI
     C                     Z-ADDNOPRO     WWPRO
     C                     Z-ADDFAOPNU    WWOPNU
     C                     CALL 'FAB640£'
     C           PARM1     PARM PARM1     PARM1
    C**  SOLDE DES RESERVATIONS DE PRÉ-IMPRIMÉS (RESIMP)
     C                     CALL 'FAB640£A'
     C           PARM1     PARM PARM1     PARM1
    C**  SOLDE DES COMMANDES DE PRÉ-IMPRIMÉS    (PREVIM)
    C**  UNIQUEMENT POUR L'ATELIER FLEXO = 12
D1  C           FAATEL    IFEQ '12'
     C                     CALL 'FAB640£B'
     C           PARM1     PARM PARM1     PARM1
F1  C                     ENDIF
    C           FINRES    ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : INITIALISATION DES FENETRES EXTERNES               *
    C*                                                               *
    C*****************************************************************
    C           GESFEN    BEGSR
D1  C           *IN03     IFEQ *ON
     C                     MOVE '2'       INDIC
     C                     MOVE '2'       INDI1
     C                     MOVE '2'       INDI2
X1  C                     ELSE
     C                     MOVE *BLANK    INDIC
     C                     MOVE *BLANK    INDI1
     C                     MOVE *BLANK    INDI2
F1  C                     ENDIF
    C**         FENETRE DES MATRICULES
     C                     CALL 'FEN502£'              85
     C           PAS5      PARM PAS5      PAS5    7
     C           INDIC     PARM INDIC     INDIC   1
     C           LIGNE     PARM LIGNE     LIGNE   2
     C           PAS2      PARM PAS2      PAS2   40
     C           PAS3      PARM PAS3      PAS3    5
    C**         FENETRE DES CODES TRAVAIL SPECIAL
     C                     CALL 'FEN505£'              85
     C           PASRES    PARM PASRES    PASRES  4
     C           PASCOD    PARM PASCOD    PASCOD  2
     C           INDI1     PARM INDI1     INDI1   1
     C           LIGNE     PARM LIGNE     LIGNE
     C           NATRAV    PARM NATRAV    NATRAV
    C**         FENETRE DES CODES DECHETS ELIMINES AVANT OP
     C                     CALL 'FEN504£'              85
     C           PASCO2    PARM PASCO2    PASCO2  3
     C           INDI2     PARM INDI2     INDI2   1
     C           LIGNE     PARM LIGNE     LIGNE
     C           PXLIBE    PARM PXLIBE    PXLIBE
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MAJ ETAT OP 2206 EQUIVALENT AU 1303 SI TANDEM 2207 *
    C*                                                               *
    C*****************************************************************
    C           COMPLX    BEGSR
     **
     ******  SI ROCHECHOUART COMPLEXEUSE EN TANDEM => FORCER EN 2206
     ******  SAISIE SUR 1303 MAIS MAJ SORTIE PAPIER 2206
     ******  SI TANDEM : T2207='O'
     **
     C                     MOVE 'N'       T2207
D1  C           USINE     IFEQ 2
    C           FAATEL    ANDEQ'13'
    C           NOMAC     ANDEQ'03'
     C                     Z-ADDUSINE     TAUSIN
     C                     Z-ADDFACONF    TACONF
     C                     Z-ADDFASEQ     TASEQ
     C                     Z-ADDFAISEQ    TAISEQ
     C                     Z-ADDNOPRO     TNOPRO
     C                     Z-ADDFAOPNU    TAOPNU
     C                     MOVE 'N'       T2207
     C                     CALL 'FAB604£'              85
     C           PARM3     PARM PARM3     PARM3
     **
F1  C                     ENDIF
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MAJ FICHIERS EN CAS DE SUPPRESSION D'EQUIPE        *
    C*                                                               *
    C*****************************************************************
    C           MAJSUP    BEGSR
     **
     ******  SUPPRESSION DES CODES ARRETS DIVERS
     **
     C                     MOVE *BLANK    XPCARD
     C           KFAB18    SETLLXFAB18
     C           LEC18B    TAG
     C           KFAB16    READEXFAB18                   99
D1  C           *IN99     IFEQ *OFF
     C                     DELETXFAB18
    C                     GOTO LEC18B
F1  C                     ENDIF
     **
     ******  SUPPRESSION DES OBSERVATIONS SI SAISIES
     **
     C                     Z-ADD0         PPOROB
     C           KFAB19    SETLLXFAB19
     C           LEC19B    TAG
     C           KFAB16    READEXFAB19                   99
D1  C           *IN99     IFEQ *OFF
     C                     DELETXFAB19
    C                     GOTO LEC19B
F1  C                     ENDIF
     **
     ******  RECALCUL DU FAOPST
     **
     C                     Z-ADDUSINE     WAUSIN
     C                     Z-ADDFACONF    WACONF
     C                     Z-ADDFASEQ     WASEQ
     C                     Z-ADDFAISEQ    WAISEQ
     C                     Z-ADDNOPRO     WNOPRO
     C                     Z-ADDFAOPNU    WAOPNU
     C                     MOVE SECT      WSECT
     C                     MOVE SSECT     WSSECT
     C                     MOVE NOMAC     WNOMAC
     C                     MOVE *BLANKS   WETAT
     C                     CALL 'FAB581£'              85
     C           PAS6      PARM PAS6      PAS6
     **
     C           KFAB5C    CHAINZFAB05               99
D1  C           *IN99     IFEQ *OFF
D2  C           WETAT     IFEQ 'T'
     C                     MOVE 'TR'      FAOPST
D3  C           USINE     IFEQ 3
    C           SECT      ANDEQ'2'
    C           SSECT     ANDEQ'1'
    C           NOMAC     ANDEQ'10'
     C                     MOVE 'S'       FA0501
F3  C                     ENDIF
F2  C                     ENDIF
D2  C           WETAT     IFEQ 'E'
     C                     MOVE 'EC'      FAOPST
     C                     MOVE ' '       FA0501
F2  C                     ENDIF
D2  C           WETAT     IFEQ 'I'
     C                     MOVE 'IN'      FAOPST
     C                     MOVE ' '       FA0501
F2  C                     ENDIF
D2  C           WETAT     IFEQ ' '
     C                     MOVE 'DI'      FAOPST
     C                     MOVE ' '       FA0501
F2  C                     ENDIF
     C                     UPDATZFAB05
     C                     EXSR COMPLX
F1  C                     ENDIF
     **
     ******  DEPOINTAGE OF DS FAB06P=>ENVOI A PREACTOR SI 'EC' OU 'IN'
     **
D1  C           FAOPST    IFEQ 'EC'
    C           FAOPST    OREQ 'IN'
     C           KFAB5D    CHAINXFAB6B               99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE *BLANK    FA0601
     C                     UPDATXFAB6B
F2  C                     ENDIF
F1  C                     ENDIF
     **
    C**
    C******  MAJ FICHIER PDFINI SI PRODUIT FABRIQUE = PRODUIT FINI
    C******  'S' SI OP TERMINEE ET 'P' SINON DS ZONE PASO
    C**
D1  C           USINE     IFEQ 3
    C           USINE     OREQ 4
    C           USINE     OREQ 5
    C           USINE     OREQ 2
    C           USINE     OREQ 7
D2  C           SVTENC    IFEQ 9
     C                     Z-ADDUSINE     XYUSI
     C                     Z-ADDSTE       XYSTE
     C                     Z-ADDNOCLI     XYCLI
     C                     Z-ADDNOPRO     XYPRO
     C                     Z-ADDFACONF    XYCONF
     C                     Z-ADDFASEQ     XYSEQ
D3  C           FAOPST    IFEQ 'TR'
     C                     MOVE 'S'       XYSOLD
X3  C                     ELSE
     C                     MOVE 'P'       XYSOLD
F3  C                     ENDIF
     C                     CALL 'FAB636£'
     C           PARM13    PARM PARM13    PARM13
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ FICHIER PREFOU SI PRODUIT FABRIQUE = PRODUIT FINI
    C******  'S' SI OP TERMINEE ET 'P' SINON DS ZONE PASO
    C**
D1  C           USINE     IFEQ 4
    C           TS1       ANDEQ'F'
    C           NOCLI     ANDEQ8928
    C           SVTENC    ANDEQ9
     C                     Z-ADDUSINE     XYUSI
     C                     Z-ADDSTE       XYSTE
     C                     Z-ADDNOCLI     XYCLI
     C                     Z-ADDNOPRO     XYPRO
     C                     Z-ADDFACONF    XYCONF
     C                     Z-ADDFASEQ     XYSEQ
     C           KPRFOU    CHAINPREFOUF1             99
D2  C           *IN99     IFEQ *OFF
D3  C           FAOPST    IFEQ 'TR'
     C                     MOVE '*'       SOBESO
X3  C                     ELSE
     C                     MOVE ' '       SOBESO
F3  C                     ENDIF
     C                     EXCPTMAJFOU
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ RESTPS => SOBESO = '*' OP TERMINEE
    C**
     C                     Z-ADDPASAGE    SVPASG
D1  C           FAOPST    IFEQ 'TR'
     C                     Z-ADDPRIOR1    PRIORI
     C           10        SUB  RANG1     RANG
    C*****  SI TANDEM COMPLEXE TOUJOURS 1ERE PASSAGE
D2  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PASAGE
F2  C                     ENDIF
     C           KRESLD    CHAINRESTPSLD             99
    C**
D2  C           *IN99     IFEQ *OFF
     C                     MOVE '*'       SOBESO
     C                     EXCPTRESTF1
F2  C                     ENDIF
F1  C                     ENDIF
     C                     Z-ADDSVPASG    PASAGE
    C**
    C******  MAJ PRLANC => OFETA = 'TR' OF SUR PRIORI TERMINE
    C**
D1  C           FAOPST    IFEQ 'TR'
     C                     EXSR LANC
F1  C                     ENDIF
    C**
    C******  MAJ RESTPS => SOBESO = ' ' OP EN COURS
    C**
     C                     Z-ADDPASAGE    SVPASG
D1  C           FAOPST    IFEQ 'EC'
    C           FAOPST    OREQ 'IN'
     C                     Z-ADDPRIOR1    PRIORI
     C           10        SUB  RANG1     RANG
    C*****  SI TANDEM COMPLEXE TOUJOURS 1ERE PASSAGE
D2  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PASAGE
F2  C                     ENDIF
     C           KRESLD    CHAINRESTPSLD             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       SOBESO
     C                     EXCPTRESTF1
F2  C                     ENDIF
F1  C                     ENDIF
     C                     Z-ADDSVPASG    PASAGE
    C**
    C******  MAJ PRLANC => OFETA = 'EC' OP EN COURS
    C**
D1  C           FAOPST    IFEQ 'EC'
    C           FAOPST    OREQ 'IN'
     C                     Z-ADDPRIOR1    PRIORI
     C           KLAN01    CHAINPRLANCFZ             99
D2  C           *IN99     IFEQ *OFF
     C                     MOVE 'EC'      OFETA
     C                     EXCPTMAJLAN
F2  C                     ENDIF
F1  C                     ENDIF
    C**
    C******  MAJ RESTPS => SOBESO = ' ' OP NON COMMENCEE
    C**
     C                     Z-ADDPASAGE    SVPASG
D1  C           FAOPST    IFEQ 'DI'
    C           FAOPST    OREQ '  '
     C                     Z-ADDPRIOR1    PRIORI
     C           10        SUB  RANG1     RANG
    C*****  SI TANDEM COMPLEXE TOUJOURS 1ERE PASSAGE
D2  C           T2207     IFEQ 'O'
     C                     Z-ADD1         PASAGE
F2  C                     ENDIF
     C           KRESLD    CHAINRESTPSLD             99
    C**
D2  C           *IN99     IFEQ *OFF
     C                     MOVE ' '       SOBESO
     C                     EXCPTRESTF1
F2  C                     ENDIF
F1  C                     ENDIF
     C                     Z-ADDSVPASG    PASAGE
    C**
    C******  MAJ PRLANC => OFETA = 'TR' OF SUR PRIORI TERMINE
    C**
D1  C           FAOPST    IFEQ 'DI'
    C           FAOPST    OREQ '  '
     C                     EXSR LANC1
F1  C                     ENDIF
    C**
    C******  MAJ DE HISTOFA2
    C**
     C                     CLEARENREG2
    C**
    C******  RECUP DE SECPAP DS FAB15P
    C**
     C                     MOVE *BLANK    SECPAP
     **
     C           KFAB15    CHAINXFAB15              N99
D1  C           *IN99     IFEQ *ON
     C                     MOVE *BLANKS   SECPAP
     C                     MOVE *BLANKS   SUPOR
F1  C                     ENDIF
     **
D1  C           SECPAP    IFNE 'I'
     C                     MOVE SECPAP    EBSUP
X1  C                     ELSE
     C                     MOVE SUPOR     EBSUP
F1  C                     ENDIF
    C**
     C                     Z-ADDUSINE     EBUSIN
     C                     Z-ADDFACONF    EBCONF
     C                     Z-ADDFASEQ     EBSEQ
    C**
    C*****  SI TANDEM COMPLEXE REMONTEE EN 2207
    C**
D1  C           T2207     IFEQ 'O'
     C                     MOVE '2'       EBSEC
     C                     MOVE '2'       EBSSEC
     C                     MOVE '07'      EBMAC
X1  C                     ELSE
     C                     MOVE SECT      EBSEC
     C                     MOVE SSECT     EBSSEC
     C                     MOVE NOMAC     EBMAC
F1  C                     ENDIF
    C**
    C*****    POUR CHABANAIS SI MACHINE = 5402
    C*****    FANJFA=1 ==>  CHANGEMENT DE LA MACHINE EN 4102
    C*****    FANJFA>1 ==>  CHANGEMENT DE LA MACHINE EN 5102
    C*****    FANJFA :  ZONE PROVENANT DU FAB05P
    C*****    SI MACHINE = 5488 ==> CHANGEMENT DE LA MACHINE EN 4101
    C*****    LES AUTRES "54" SONT DES "51"
    C**
D1  C           USINE     IFEQ 5
    C           FAATEL    ANDEQ'54'
    C*
D2  C                     SELEC
    C* MACHINE = 5402
     C           NOMAC     WHEQ '02'
    C*
D3  C           FANJFA    IFEQ 1
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
X3  C                     ELSE
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
F3  C                     ENDIF
    C* MACHINE = 5488
     C           NOMAC     WHEQ '88'
    C*
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '01'      EBMAC
    C* AUTRES MACHINES
     C                     OTHER
    C*
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
    C*
F2  C                     ENDSL
    C*
F1  C                     ENDIF
    C**
     C                     Z-ADDSTE       EBSTE
     C                     Z-ADDNOCLI     EBCLI
     C                     Z-ADDNOPRO     EBPRO
     C                     Z-ADDPPEQUI    EBEQU
     C                     Z-ADDPPPAS     EBPAS
     C                     Z-ADDDATEQ     EBDAT1
     C                     Z-ADD*DATE     EBDAT2
    C**
    C******  HEURE DE FIN OP : EQUIPE NUIT+DATE DU LENDEMAIN => +24H
    C**
    C**                   Z-ADDSVHFI2    EBHEUR
    C**         PPEQUI    IFEQ 3
    C**         SVHFI2    ANDLT700
    C**                   ADD  2400      EBHEUR
    C**                   ENDIF
     C                     TIME           EBHEU6  60
     C                     MOVELEBHEU6    EBHEUR
    C**
     C                     Z-ADDCMATR     EBCOND
     C                     Z-ADD0         EBTCAL
     C                     Z-ADD0         EBTROU
     C                     Z-ADD0         EBTDIV
     C                     Z-ADD0         EBEFFC
     C                     Z-ADD0         EBEFFR
    C**
     C                     Z-ADD0         EBQTOT
     C                     Z-ADD0         EBQBON
     C                     Z-ADD0         EBQRC
     C                     Z-ADD0         EBQRR
     C                     Z-ADD0         EBNCAL
    C**
     C                     MOVE *BLANKS   EBCELI
     C                     Z-ADD0         EBQELI
     C                     MOVE *BLANK    EBETIQ
     C                     Z-ADD0         EBCBPA
     C                     Z-ADD0         EBTENC
     C                     Z-ADDPPNCCA    EBCOUL
     C                     MOVE PPVERN    EBTVER
    C**
    C******  MAJ N° OP => SI OP RAJOUTEE DS SUIVI (TYPE 6) => ENVOYER
    C******               SUR OP D'ORIGINE
    C**
     C                     Z-ADDFAOPNU    EBOPNU
     **
     C                     MOVE FAOPNU    TYPOP   10
D1  C           TYPOP     IFGE 6
     C                     SUB  5         TYPOP
     C                     MOVE TYPOP     EBOPNU
F1  C                     ENDIF
D1  C*          FAATEL    IFEQ '82'
    C*          EBOPNU    ANDGT1
     C*                    MOVE '1'       EBOPNU
F1  C*                    ENDIF
    C*****  SI TANDEM COMPLEXE FAOPNU CELUI DE LA 1303
D1  C           T2207     IFEQ 'O'
     C                     MOVE TAOPNU    EBOPNU
F1  C                     ENDIF
    C**
     C                     MOVE '  '      EBOPST
     C                     MOVE 'Z'       EBTAG
     C                     MOVE *BLANKS   EBTRSP
    C**
    C**                   MOVE TAD1      EBCAD
    C**                   Z-ADDTAD2      EBTAD
    C**                   MOVE TAD3      EBIAD
    C**                   Z-ADDTAD4      EBEAD
     C                     MOVE *BLANK    EBCAD
     C                     Z-ADD0         EBTAD
     C                     MOVE *BLANK    EBIAD
     C                     Z-ADD0         EBEAD
    C**
    C*****   SI LA ZONE OPLIB (DU PRECAOP) = FINITION
    C*****        PAS DE MAJ DE HISTOFA2 ==> CONDITIONNEMENT
    C**
D1  C           USINE     IFEQ 4
    C           OPLIB     CABEQLB,1      FINF2
F1  C                     ENDIF
    C**
    C*****   GESTION DES A COTES : TOURY
    C*****   DOUBLE MAJ DE HISTOFA2 APRÉS ONDULEUSE
    C**
D1  C           USINE     IFEQ 3
    C           POSF2     ANDGT0
    C           FAATEL    ANDGT'21'
    C           FAATEL    ANDLT'70'
D2  C           TOTEQG    IFGT 0
     C                     Z-ADDTOTEQG    EBQTOT
     C                     Z-ADDTOTEQG    EBQBON
     C                     Z-ADDPOSF1     EBPOS1
     C                     Z-ADD0         EBPOS2
     C                     Z-ADD0         EBQACO
    C*
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C*
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F2  C                     ENDIF
    C**
D2  C           TOTEQD    IFGT 0
     C                     Z-ADDTOTEQD    EBQTOT
     C                     Z-ADDTOTEQD    EBQBON
     C                     Z-ADD0         EBQRC
     C                     Z-ADD0         EBQRR
     C                     Z-ADD0         EBPOS1
     C                     Z-ADDPOSF2     EBPOS2
     C                     Z-ADDTOTEQD    EBQACO
     C                     Z-ADD0         EBTCAL
     C                     Z-ADD0         EBTROU
     C                     Z-ADD0         EBTDIV
     C                     MOVE *BLANK    EBCELI
     C                     Z-ADD0         EBQELI
     C                     MOVE *BLANK    EBCAD
     C                     Z-ADD0         EBTAD
     C                     MOVE *BLANK    EBIAD
     C                     Z-ADD0         EBEAD
    C*
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C*
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F2  C                     ENDIF
    C******
X1  C                     ELSE
    C******  TOUS LES AUTRES CAS
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C**
     C           FINF2     TAG
    C**
    C******  MAJ FAB21P => HISTORIQUE MVTS TRANSMIS A HISTOFA2
    C**
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
F1  C                     ENDIF
    C**
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*       SR : MAJ HISTOFA2 EN CAS DE CHANGEMENT DE DATE          *
    C*               SUPPRESSION DU MVT                              *
    C*                                                               *
    C*****************************************************************
    C           MAJSU2    BEGSR
     C                     EXSR COMPLX
    C**
    C******  MAJ DE HISTOFA2
    C**
     C                     CLEARENREG2
    C**
    C******  RECUP DE SECPAP DS FAB15P
    C**
     C                     MOVE *BLANK    SECPAP
     **
     C           KFAB15    CHAINXFAB15              N99
D1  C           *IN99     IFEQ *ON
     C                     MOVE *BLANKS   SECPAP
     C                     MOVE *BLANKS   SUPOR
F1  C                     ENDIF
     **
D1  C           SECPAP    IFNE 'I'
     C                     MOVE SECPAP    EBSUP
X1  C                     ELSE
     C                     MOVE SUPOR     EBSUP
F1  C                     ENDIF
    C**
     C                     Z-ADDUSINE     EBUSIN
     C                     Z-ADDFACONF    EBCONF
     C                     Z-ADDFASEQ     EBSEQ
    C**
    C*****  SI TANDEM COMPLEXE REMONTEE EN 2207
    C**
D1  C           T2207     IFEQ 'O'
     C                     MOVE '2'       EBSEC
     C                     MOVE '2'       EBSSEC
     C                     MOVE '07'      EBMAC
X1  C                     ELSE
     C                     MOVE SECT      EBSEC
     C                     MOVE SSECT     EBSSEC
     C                     MOVE NOMAC     EBMAC
F1  C                     ENDIF
    C**
    C*****    POUR CHABANAIS SI MACHINE = 5402
    C*****    FANJFA=1 ==>  CHANGEMENT DE LA MACHINE EN 4102
    C*****    FANJFA>1 ==>  CHANGEMENT DE LA MACHINE EN 5102
    C*****    FANJFA :  ZONE PROVENANT DU FAB05P
    C*****    SI MACHINE = 5488 ==> CHANGEMENT DE LA MACHINE EN 4101
    C*****    LES AUTRES "54" SONT DES "51"
    C**
D1  C           USINE     IFEQ 5
    C           FAATEL    ANDEQ'54'
    C*
D2  C                     SELEC
    C* MACHINE = 5402
     C           NOMAC     WHEQ '02'
    C*
     C           KFAB5C    CHAINZFAB05              N99
    C*
D3  C           FANJFA    IFEQ 1
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
X3  C                     ELSE
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '02'      EBMAC
F3  C                     ENDIF
    C* MACHINE = 5488
     C           NOMAC     WHEQ '88'
    C*
     C                     MOVE '4'       EBSEC
     C                     MOVE '1'       EBSSEC
     C                     MOVE '01'      EBMAC
    C* AUTRES MACHINES
     C                     OTHER
    C*
     C                     MOVE '5'       EBSEC
     C                     MOVE '1'       EBSSEC
    C*
F2  C                     ENDSL
    C*
F1  C                     ENDIF
    C**
     C                     Z-ADDSTE       EBSTE
     C                     Z-ADDNOCLI     EBCLI
     C                     Z-ADDNOPRO     EBPRO
     C                     Z-ADDPPEQUI    EBEQU
     C                     Z-ADDPPPAS     EBPAS
     C                     Z-ADDDATEQ     EBDAT1
     C                     Z-ADD*DATE     EBDAT2
    C**
    C******  HEURE DE FIN OP : EQUIPE NUIT+DATE DU LENDEMAIN => +24H
    C**
     C                     Z-ADDSVHFI2    EBHEUR
D1  C           PPEQUI    IFEQ 3
    C           SVHFI2    ANDLT700
     C                     ADD  2400      EBHEUR
F1  C                     ENDIF
    C**
     C                     Z-ADDCMATR     EBCOND
     C                     Z-ADD0         EBTCAL
     C                     Z-ADD0         EBTROU
     C                     Z-ADD0         EBTDIV
     C                     Z-ADD0         EBEFFC
     C                     Z-ADD0         EBEFFR
    C**
     C                     Z-ADD0         EBQTOT
     C                     Z-ADD0         EBQBON
     C                     Z-ADD0         EBQRC
     C                     Z-ADD0         EBQRR
     C                     Z-ADD0         EBNCAL
    C**
     C                     MOVE *BLANKS   EBCELI
     C                     Z-ADD0         EBQELI
     C                     MOVE *BLANK    EBETIQ
     C                     Z-ADD0         EBCBPA
     C                     Z-ADD0         EBTENC
     C                     Z-ADDPPNCCA    EBCOUL
     C                     MOVE PPVERN    EBTVER
    C**
    C******  MAJ N° OP => SI OP RAJOUTEE DS SUIVI (TYPE 6) => ENVOYER
    C******               SUR OP D'ORIGINE
    C**
     C                     Z-ADDFAOPNU    EBOPNU
     **
     C                     MOVE FAOPNU    TYPOP   10
D1  C           TYPOP     IFGE 6
     C                     SUB  5         TYPOP
     C                     MOVE TYPOP     EBOPNU
F1  C                     ENDIF
D1  C*          FAATEL    IFEQ '82'
    C*          EBOPNU    ANDGT1
     C*                    MOVE '1'       EBOPNU
F1  C*                    ENDIF
    C*****  SI TANDEM COMPLEXE FAOPNU CELUI DE LA 1303
D1  C           T2207     IFEQ 'O'
     C                     MOVE TAOPNU    EBOPNU
F1  C                     ENDIF
    C**
     C                     MOVE '  '      EBOPST
     C                     MOVE 'Z'       EBTAG
    C**
     C                     MOVE TAD1      EBCAD
     C                     Z-ADDTAD2      EBTAD
     C                     MOVE TAD3      EBIAD
     C                     Z-ADDTAD4      EBEAD
     C                     MOVE *BLANKS   EBTRSP
    C**
    C*****   SI LA ZONE OPLIB (DU PRECAOP) = FINITION
    C*****        PAS DE MAJ DE HISTOFA2 ==> CONDITIONNEMENT
    C**
D1  C           USINE     IFEQ 4
    C           OPLIB     CABEQLB,1      FINF3
F1  C                     ENDIF
    C**
     C                     CALL 'PROD79£'
     C           ENR2      PARM ENR2      ENR2
    C**
     C           FINF3     TAG
    C**
    C******  MAJ FAB21P => HISTORIQUE MVTS TRANSMIS A HISTOFA2
    C**
     C                     Z-ADDFAISEQ    EBISEQ
     C                     MOVE 'M'       EBMODI
     C                     WRITEXFAB21
    C**
    C                     ENDSR
    C*****************************************************************
    C*                                                               *
    C*  RENUMEROTATION EN FONCTION DE L'HEURE DANS FAB17P            *
    C*                                                               *
    C*****************************************************************
    C           RENUM     BEGSR
    C**
    C*****  TEST SI LA RENUMEROTATION EST POSSIBLE
    C*****      MOINS DE 50 EVENEMENTS
    C**
    C           SAVORD    CABGE50        FRNM
    C**
     C                     Z-ADD0         DATEVE
     C                     Z-ADD0         ORDRNM
     C                     Z-ADD0         ORDRN1
     C                     Z-ADD0         PPORD
     C           KFAB17    SETLLXFAB17
    C**
    C****** RENUMEROTATION ENREGISTREMENTS DANS
    C****** L'ORDRE DECROISSANT EN PARTANT DE 100
    C**
     C           RNM1      TAG
     C           KFAB16    READEXFAB17                   99
    C           *IN99     CABEQ*ON       RNM2
D1  C           PPORD     IFGE 50
     C                     UNLCKFAB17L01
    C                     GOTO RNM1
F1  C                     ENDIF
     C                     Z-ADDPPORD     ORDRNM
D1  C           ORDRN1    IFEQ 0
     C                     Z-ADD99        ORDRN1
X1  C                     ELSE
     C           ORDRN1    SUB  1         ORDRN1
F1  C                     ENDIF
     C                     Z-ADDORDRN1    PPORD
     C                     EXCPTMAJ17A
     C                     Z-ADDORDRNM    PPORD
    C                     GOTO RNM1
    C**
     C           RNM2      TAG
    C**
     C                     Z-ADD0         ORDRN2
     C                     Z-ADD0         DATEVE
     C                     Z-ADD0         SAVEVE
     C                     Z-ADD0         PPHDEB
     C                     Z-ADD0         PPORD
     C           KFA17F    SETLLTFAB17
    C**
    C****** RENUMEROTATION ENREGISTREMENTS DANS
    C******  L'ORDRE : HEURE DE DEBUT
    C**
     C           RNM3      TAG
     C           KFAB16    READETFAB17                   99
    C           *IN99     CABEQ*ON       FRNM
D1  C           PPORD     IFLE 50
     C                     UNLCKFAB17L12
    C                     GOTO RNM3
F1  C                     ENDIF
     C                     ADD  1         ORDRN2
     C                     Z-ADDORDRN2    PPORD
     C                     EXCPTMAJ17B
    C                     GOTO RNM3
    C           FRNM      ENDSR
    C*****************************************************************
     * MINI/MAXI  ==> CDEC92C
    C           MINMAX    BEGSR
     C                     Z-ADD0         MINI
     C                     Z-ADD0         MAXI
     C                     Z-ADDNOPRO     NOP92
     C                     Z-ADDNOCLI     NOC92
     C                     Z-ADDFACONF    NCF92
     C                     Z-ADDFAQTE     SURF
     C                     Z-ADDFAQTE     SURFF
     C                     Z-ADD1,000     SF
     C                     MOVE '*'       EXP
     C                     CALL 'CDEC92C'
     C                     PARM           DSPARA
    C                     ENDSR
    C*****************************************************************
     * BILAN OP --> F16B
    C           SPBIL     BEGSR
     C                     Z-ADD*ZEROS    TCALF
     C                     Z-ADD*ZEROS    FATXTM
     C                     Z-ADD*ZEROS    FACAD
     C                     SETOF                     69
    C*
D1  C           USINE     IFEQ 3
    C           SECT      ANDEQ'1'
    C           SSECT     ANDEQ'2'
     C                     SETON                     69
     C                     Z-ADDPPNCCA    NBC     20
D2  C           PPVERN    IFEQ 'E'
     C                     ADD  2         NBC
X2  C                     ELSE
D3  C           PPVERN    IFNE *BLANK
     C                     ADD  1         NBC
F3  C                     END
F2  C                     END
     C           PPHCAL    DIV  NBC       TCALF
F1  C                     END
    C*
D1  C           PPHTIR    IFNE 0
     C           PPQFEU    DIV  PPHTIR    FACAD
D2  C           SECT      IFEQ '2'
    C           SECT      OREQ '3'
D3  C           LMINI     IFNE *ZEROS
    C           ONDL      ANDNE*ZEROS
     C                     MOVE LMINI     LMMM    40
     C           LMMM      DIV  ONDL      FENL    20
D4  C           FENL      IFNE *ZEROS
     C           FACAD     DIV  FENL      FACAD
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           PPHCAL    ADD  PPHTIR    PPTTT   62
     C           PPHADI    ADD  PPHARR    PPAAA   62
     C                     ADD  PPHPAN    PPAAA
     C                     Z-ADDUSINE     YZUSIN
     C                     MOVE SECT      YZSECT
     C                     MOVE SSECT     YZSSEC
     C                     MOVE NOMAC     YZMAC
     C                     Z-ADDFACONF    YZCONF
     C                     Z-ADDFASEQ     YZSEQ
     C                     Z-ADDFAISEQ    YZISEQ
     C                     Z-ADDNOPRO     YZPRO
     C                     Z-ADDFAOPNU    YZOPNU
     C                     Z-ADDPPJJ      YZJJ
     C                     Z-ADDPPMM      YZMM
     C                     Z-ADDPPAA      YZAA
     C                     Z-ADDPPEQUI    YZEQUI
     C                     MOVE *ZEROS    PARMYY  5
     C                     CALL 'FAB696£A'
     C                     PARM           PARMYZ
     C                     PARM           PARMYY
     C                     MOVE PARMYY    ARPLA   52
     C           PPAAA     SUB  ARPLA     PPAAA
     C                     ADD  PPAAA     PPTTT
D1  C           PPTTT     IFNE 0
     C           PPAAA     DIV  PPTTT     XXTXTM  54
     C           XXTXTM    MULT 100       FATXTM
F1  C                     END
    C*
    C                     ENDSR
    C*===============================================================*
    C*                                                               *
    C*                     SORTIES FICHIERS                          *
    C*                                                               *
    C*===============================================================*
     OXFAB15  E                MAJ15
     O                         FATRSP
     OXFAB16  E                MAJ16
     O                         FA1601
     O                         FA1602
     OXFAB16  E                MAJ16B
     O                         PPHDEQ
     O                         PPHFEQ
     O                         PPEFFC
     O                         PPEFFR
     O                         CMATR
     OXFAB17  E                MAJ17A
     O                         PPORD
     OTFAB17  E                MAJ17B
     O                         PPORD
     OXFAB22  E                MAJ22
     O                         FA2201
     O                         FA2202
     OXFAB22  EDEL             DEL22
     ORESTPSF1E                RESTF1
     O                         SOBESO                                     PROD13
     OPRLANCFZE                MAJLAN
     O                         OFETA
     OPREFOUF1E                MAJFOU
     O                         SOBESO
**
LIB001
LIB002
LIB003
LIB004
LIB005
LIB006
LIB007
LIB008
LIB009
**
CREATION
MODIFICATION
INTERROGATION
SUPPRESSION
**
  MATIN
APRES-MIDI
  NUIT
**
OP.  TERMINEE => CONFIRMER
EQUIPE TERMINEE => CONFIRMER
OP. INTERROMPUE => CONFIRMER
**
TRAVAIL TERMINE
EQUIPE TERMINEE
TRAV.INTERROMPU
**
FINITION
**
23457
**
05001300
13002100
21000500
05001300
13002100
21000500
04301230
12302030
20300430
05001300
13002100
21000500
05001300
13002100
21000500
