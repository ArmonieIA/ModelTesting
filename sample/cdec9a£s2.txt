     ***************************************************************
     *                                                             *
     *          PGM: CDEC9A£  REALISE PAR REMI COURTAINE           *
     *                                                             *
     *            FICHE COMMANDE                                   *
     *            --------------                                   *
     ***************************************************************
     *            INDICATEURS UTILISES DANS LE PROGRAMME           *
     *                                                             *
     *  TOUTES LES ZONES D'EDITION SONT NOMMEES VXXX EN MARGE      *
     *                                                             *
     ***************************************************************
     ***************************************************************
     **  HISTORIQUE                                                *
     **                                                            *
     **  AUTEUR !    DATE    ! OBJET DE LA MODIFICATION            *
     ** --------!------------!------------------------------------ *
     **  TMAGPI ! 07-04-2011 ! DEMANDE UTILISATEUR: CALL 1469717   *
     **  TMAFBU ! 04-02-2016 ! INTEGRATION MACHINE OEILLET         *
     **         !            ! *IN36='1'= MACHINE OEILLET PRESSION *
     **NOUZIERES! 06-06-2017 ! COMPATIBILITÉ ECHANGEUR 2110 VS 2114*
     ***************************************************************
     FCARCDEL1IF  E           K        DISK
     FCDESL1  IF  E           K        DISK
     FCARCDEZ8IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEU
     FCLIENTS1IF  E           K        DISK
     FCLILIVL1IF  E           K        DISK
    FPRODUI2 UF  E           K        DISK                      A
     FPRODST2 IF  E           K        DISK
     FPRODST3 IF  E           K        DISK
     F            PRODSTF2                          KRENAMEPRODS3F
     FPRODS3L1IF  E           K        DISK
     FPRODUL10IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUIF
     FPRODUL22IF  E           K        DISK
     FPREIMPL IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FPLANIFL1IF  E           K        DISK
     FPLANIFL3IF  E           K        DISK
     F            PLANIFF1                          KRENAMEPLANIFF
     FHISTOF16IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FBESOMAL1IF  E           K        DISK
     FPLAMAL1 IF  E           K        DISK
     FRESPAPL5IF  E           K        DISK
     FRESCXHL1IF  E           K        DISK
     FRESIMPL2IF  E           K        DISK
     FOBSPROL1IF  E           K        DISK
     FOBSPROL3IF  E           K        DISK
     F            OBSPROF1                          KRENAMEOBSPROF3
     FCDEQUAL1IF  E           K        DISK
     FFORDECL1IF  E           K        DISK
     FCAIPALL1IF  E           K        DISK
     FCDEOBSL2IF  E           K        DISK
     FPLAIMP7 IF  E           K        DISK
     FSTACOML8IF  E           K        DISK
     *
     FLIEUST03IF  E           K        DISK                               PROD17
     FDJAFACL2IF  E           K        DISK
     FGAMMREL1IF  E           K        DISK
     FCOMPREL1IF  E           K        DISK
     FCODBARL2IF  E           K        DISK
     FPRODST6 IF  E           K        DISK
    FFICCDE  O   F    4093            DISK
     *
     *****************************************************************
     *     TABLES INTERNES
     *****************************************************************
     E                    TI      1   7  1 0 LIM     9
     E                    CON     1  29 40
     E                    ETA     1   8  1   LET    40
     E                    TYP     1   7  1 0 LYP    10
     E                    TIM         7  1 0 TRE     1 0
     E                    COP         7  1   TS      1
     E                    STD         7  4 1
     E                    FOH         7  4 0 FOL     4 0
     E                    VAR        20 40   VDT     6
     E                    VEM        20  6
     E                    CIA        10  7
     E                    SUP         5 62
     E                    QUA         5 16
     E                    LF          5 22
     E                    TAL         7  3 2
     E                    CAR        75  1
     E                    WAR        40  1
     E                    MAA         6 40   MAQ     6 0
     E                    DIT        51 80
     E                    GAM        50 35
     E                    DEL         5 37
     E                    TSX         9  7 0A
     E                    TB          9  2 0
     E                    CXT       100  2               CODES EXTER.
     E                    QTC        20  7 0 NBP     2 0
     E                    BL0        40  1                BLOC 0
     E                    BLT        40  1                BLOC 3
     E                    BLQ        40  1                BLOC 4
     E                    CO          8  1 0             COULEUR
     E                    DCO         8  1 0             COULEUR DIX
     E                    RC          8  1 0             REPRISE COUL
     E                    TV          8  1               TYPE VERNIS
     E                    RV          8  1               VERNIS REPRISE
     E                    OR          8  2               OR CUIVRE ALU
     E                    CV          8  2 1             COUV. VERNIS
     E                    WI      1   7  1 0 WIM     6
     *****************************************************************
     *
     *
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     *
     *  ZONES DE PROIMP2 RENOMMEES  COMMENCENT PAR WW
     IPRODSTF2
     I              NOPRO                           NOPRO3
     I              BLOC1                           BLOC13
     I              BLOC2                           BLOC23
     I              BLOC4                           BLO4AA
     I              SS                              WW11
     I              SUPOR                           SUPOR3
     IPRODS3F
     I              SS                              WW11
     I              SUPOR                           SUPOR3
     I              BLOC4                           BLO4AA
     *
     *  ZONES DE PREIMP2 RENOMMEES  COMMENCENT PAR WW
     IPREIMPF1
     I              FORLST                          WWLST
     I              FORHST                          WWHST
     *  ZONES DE PRODUI2 RENOMMEES  COMMENCENT PAR Y
     IPRODUIF1
     I              ANDEV                           YNDEV
     I              ETUDE                           YTUDE
     I              SEQDE                           YEQDE
     I              PDUNI                           YDUNI
     I              PDSRE                           YDSRE
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              GFRA                            YFRA
     I              NOFOR                           YOFOR
     I              ONDL                            YNDL
     I              ONDH                            YNDH
     I              DECL                            YECL
     I              DECH                            YECH
     I              POSF1                           YOSF1
     I              POSF2                           YOSF2
     I              ACOTE                           YCOTE
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              CCOL                            YCOL
     I              ONDUL                           YNDUL
     I              LMINI                           YMINI
     I              TDECO                           YDECO
     I              TS1                             TS,1
     I              TS2                             TS,2
     I              TS3                             TS,3
     I              TS4                             TS,4
     I              TS5                             TS,5
     I              TS6                             TS,6
     I              TS7                             TS,7
     I              QTEM1                           PROSOE
     I              QTEM2                           PROSOI
     I              TYPOR                           YYPOR
     IPRODUIF
     I              ANDEV                           YNDEV
     I              ETUDE                           YTUDE
     I              SEQDE                           YEQDE
     I              PDUNI                           YDUNI
     I              PDSRE                           YDSRE
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              GFRA                            YFRA
     I              NOFOR                           YOFOR
     I              ONDL                            YNDL
     I              ONDH                            YNDH
     I              DECL                            YECL
     I              DECH                            YECH
     I              POSF1                           YOSF1
     I              POSF2                           YOSF2
     I              ACOTE                           YCOTE
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              CCOL                            YCOL
     I              ONDUL                           YNDUL
     I              LMINI                           YMINI
     I              TDECO                           YDECO
     I              TS1                             TS,1
     I              TS2                             TS,2
     I              TS3                             TS,3
     I              TS4                             TS,4
     I              TS5                             TS,5
     I              TS6                             TS,6
     I              TS7                             TS,7
     I              QTEM1                           PROSOE
     I              QTEM2                           PROSOI
     I              LAIZB                           YAIZB
     I              LCOUP                           YCOUP
     I              TYPOR                           YYPOR
     *  ZONES DE CDES   RENOMMEES  COMMENCENT PAR W
     ICDESF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              CDEPRE                          WW4
     I              AGENT                           WW1
     I              USINE                           WSINE
     I              QTOT                            WTOT
     I              QTFAB                           WTFAB
     I              QTPRE                           WTPRE
     I              QTREN                           WTREN
     I              NBLIV                           WBLIV
     I              FRLIV                           WRLIV
     I              PRIUNS                          WRIUNS
     I              UVENT                           WVENT
     I              MICLI                           WICLI
     I              MACLI                           WACLI
     I              PROTO                           WPROTO
     I              TAGBID                          WAGBID
     ISTACOMF1
     I              AGENT                           WW1
     I              NCONF                           WWC
     I              NOPRO                           WWP
     I              GARNT                           WWG
     I              STE                             WWE
     I              NOCLI                           WWNO
     I              QTOT                            WWQ
     I              USINE                           WWU
     I              GROUPE                          WWGR
     ICARCDEU
     I              AGENT                           WW1
     I              CDEPRE                          WWEPRE
     I              SSDDEL                          WWSS
     I              ADEDEL                          WWA
     I              SDEDEL                          WWS
     I              JDEDEL                          WWJ
     I              QTDEXP                          WWEXP
     *  ZONES DE CARCDE RENOMMEES  COMMENCENT PAR W
     ICARCDEF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              USEXT                           WSEXT
     I              USINT                           WSINT
     I              USINE                           WSINE
     I              AGENT                           WGENT
     I              CDEPRE                          WDEPR2
     I              GARNT                           WARNT
     I              ANDEL                           WNDEL
     I              RGFAC                           WGFAC
     I              RGLIV                           WGLIV
     I              QTFAC                           WTFAC
     I              QTIMP                           WTIMP
     *  ZONES DE HISTOFA2 RENOMMEES  COMMENCENT PAR X
     IHISTOFA
     I              NCONF                           XCONF
     I              NOSEQ                           XOSEQ
     I              TS                              XTS
     I              EMBA1                           XMBA1
     I              EMBA2                           XMBA2
     I              RHODO                           XHODO
     *  ZONES DE BESOMAT  RENOMMEES  COMMENCENT PAR B
     IBESOMATF
     I              LMINI                           BMINI
     I              UVENT                           BVENT
     I              QTFAB                           BTFAB
     I              QTTOT                           BTTOT
     I              QTPRE                           BTPRE
     I              QTREN                           BTREN
     I              TALO1                           TAL,1
     I              TALO2                           TAL,2
     I              TALO3                           TAL,3
     I              TALO4                           TAL,4
     I              TALO5                           TAL,5
     I              TALO6                           TAL,6
     I              TALO7                           TAL,7
     I              STD1                            STD,1
     I              STD2                            STD,2
     I              STD3                            STD,3
     I              STD4                            STD,4
     I              STD5                            STD,5
     I              STD6                            STD,6
     I              STD7                            STD,7
     I              ERSTD                           BRSTD
     *  ZONES DE RESPAP RENOMMEES  COMMENCENT PAR H
     IRESPAPF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     *  ZONES DE RESCXH RENOMMEES  COMMENCENT PAR H
     IRESCXHF1
     I              FORL                            HORL
     I              FORH                            HORH
     I              FOUB                            HOUB
     *  ZONES DE PLAIMP7  RENOMMEES
     IPLAIMPF1
     I              I                               PAS
     *  ZONES DE PLANIFL1 RENOMMEES
     IPLANIFF1
     I              I                               PAS
     I              SUREG                           WUREG
     *  ZONES DE COMPRE   RENOMMEES
     ICOMPREF1
     I              GARNT                           CARNT
     *  ZONES DE GAMMRE   RENOMMEES
     IGAMMREF1
     I              I                               PAS
     *  ZONES DE PLANIFL3 RENOMMEES
     IPLANIFF
     I              I                               PAS
     I              SUREG                           WUREG
     *  ZONES DE PLAMA    RENOMMEES
     IPLAMAF1
     I              USFAC                           XUSFAC
     *  ZONES DE CDEQUA   RENOMMEES
     ICDEQUAF1
     I              USINE                           USQUA
     *  ZONES DE CODBAR   RENOMMEES
     ICODBARF1
     I              SUIMP                           NO
     * Renomage zones PRODST6
     IPRODST6F
     I              STE                             ZTE
     I              USINE                           ZSINE
     *
     I            DS
     I                                        1  25 GENCOD
     I                                        1   5 PDBAR
     *****************************************************************
     *     RUPTURES   ET  DS
     *****************************************************************
     *
     IDSPARA      DS
     I                                        1   50WCONF1
     I                                        6   90WOPRO1
     I                                       10  160SURF
     I                                       17  203SF
     I                                       21  270MIN
     I                                       28  340MAX
     I                                       35  35 DS1
     I                                       36  420SURFF
     I                                       43  43 PROT
     I                                       44  470WOCLI1
     *
     IBT3         DS
     I                                        1   1 BLANC
     I                                        2   20YACON
     I                                        3   40COAS1
     *
     I            DS
     I                                        1   40DALAN
     I                                        1   20LANIMP
     I                                        3   40LANFAC
     *
     I            DS
     I                                        1   60V002
     I                                        1   20DAY
     I                                        3   40MONTH
     I                                        5   60YEAR
     *
     I            DS
     I                                        1  14 V003
     I                                        1   2 V0031
     I                                        4   5 V0032
     I                                        4   7 V003X
     I                                       13  14 V0033
     *
     I            DS
     I                                        1   60X014
     I                                        1   20DAYX
     I                                        3   40MONTHX
     I                                        5   60YEAR1X
     *
     I            DS
     I                                        1   60DATFAB
     I                                        1   20AFAB
     I                                        3   40MFAB
     I                                        5   60JFAB
     *
     I            DS
     I                                        1   60DTMAJ
     I                                        1   20JMAJ
     I                                        3   40MMAJ
     I                                        5   60AMAJ
     *
     I            DS
     I                                        1   60DTCRE
     I                                        1   20JCRE
     I                                        3   40MCRE
     I                                        5   60ACRE
     *
     I            DS
     I                                        1   60V008
     I                                        1   20V0081
     I                                        3   40V0082
     I                                        5   60V0083
     *
     I            DS
     I                                        1  40 V014
     I                                       25  40 V0141
     I                                       28  280V0142
     *
     I            DS
     I                                        1 240 VCTL1
     I                                      241 280 VCTL2
     I                                        1  40 V023
     I                                       41  80 V024
     I                                       81 120 V025
     I                                      121 160 V026
     I                                      161 200 V027
     I                                      201 240 V028
     I                                      241 280 V029
     *
     I            DS
     I                                        1  49 VDTL
     I                                        1   7 V030
     I                                        8  14 V031
     I                                       15  21 V032
     I                                       22  28 V033
     I                                       29  35 V034
     I                                       36  42 V035
     I                                       43  49 V036
     *
     *
     I            DS
     I                                        1  20 B041
     I I            'Rg'                      1   2 B0411
     I                                        4   4 B0412
     I                                        6   7 B0413
     I                                        9  12 B0414
     I I            'nb'                     14  15 B0415
     I                                       17  18 B0416
     *
     I            DS
     I                                        1  31 V041
     I                                        1  10 V0411
     I                                       11  22 V0412
     I                                       23  27 V0413
     I                                       28  28 V0414
     I                                       29  29 V0415
     I                                       30  310V0416
     *
     I            DS
     I                                        1  31 V042
     I                                        1  10 V0421
     I                                       11  22 V0422
     I                                       23  27 V0423
     I                                       28  28 V0424
     I                                       29  29 V0425
     I                                       30  310V0426
     *
     I            DS
     I                                        1  31 V043
     I                                        1  10 V0431
     I                                       11  22 V0432
     I                                       23  27 V0433
     I                                       28  28 V0434
     I                                       29  29 V0435
     I                                       30  310V0436
     *
     I            DS
     I                                        1  31 V044
     I                                        1  10 V0441
     I                                       11  22 V0442
     I                                       23  27 V0443
     I                                       28  28 V0444
     I                                       29  29 V0445
     I                                       30  310V0446
     *
     I            DS
     I                                        1  13 VARNT
     I                                        1   9 YARNT2
     I                                       12  13 YARNT
     I                                       12  12 YARNT1
     I                                       13  13 YARNT3
     *
     I            DS
     I                                        1  57 V099
     I                                        1   72V0991
     I                                       18  252V0992
     I                                       37  380V0993
     I                                       48  540V0994
     *
     I            DS
     I                                        1  16 QU63
     I                                        1  15 QU631
     I                                       16  16 QU632
     *
     I            DS
     I                                        1  62 W063
     I                                        1   3 V0631
     I                                        4   6 V0632
     I                                        7   90V0633
     I                                       10  15 V0634
     I                                       16  180V0635
     I                                        4  18 Q063
     I                                       19  40 LF63
     I                                       19  220V0636
     I                                       23  23 V0637
     I                                       24  270V0638
     I                                       28  311V0639
     I                                       32  40 V063A
     I                                       41  46 V063B
     I                                       47  530V063C
     I                                       54  600V063D
     I                                       61  610V063IN
     I                                       62  62 V063CX
     *
     I            DS
     I                                        1  62 W064
     I                                        1   3 V0641
     I                                        4   6 V0642
     I                                        7   90V0643
     I                                       10  15 V0644
     I                                       16  180V0645
     I                                       19  220V0646
     I                                       23  23 V0647
     I                                       24  270V0648
     I                                       28  311V0649
     I                                       32  40 V064A
     I                                       41  46 V064B
     I                                       47  530V064C
     I                                       54  600V064D
     I                                       61  610V064IN
     I                                       62  62 V064CX
     *
     I            DS
     I                                        1  62 W065
     I                                        1   3 V0651
     I                                        4   6 V0652
     I                                        7   90V0653
     I                                       10  15 V0654
     I                                       16  180V0655
     I                                       19  220V0656
     I                                       23  23 V0657
     I                                       24  270V0658
     I                                       28  311V0659
     I                                       32  40 V065A
     I                                       41  46 V065B
     I                                       47  530V065C
     I                                       54  600V065D
     I                                       61  610V065IN
     I                                       62  62 V065CX
     *
     I            DS
     I                                        1  62 W066
     I                                        1   3 V0661
     I                                        4   6 V0662
     I                                        7   90V0663
     I                                       10  15 V0664
     I                                       16  180V0665
     I                                       19  220V0666
     I                                       23  23 V0667
     I                                       24  270V0668
     I                                       28  311V0669
     I                                       32  40 V066A
     I                                       41  46 V066B
     I                                       47  530V066C
     I                                       54  600V066D
     I                                       61  610V066IN
     I                                       62  62 V066CX
     *
     I            DS
     I                                        1  62 W067
     I                                        1   3 V0671
     I                                        4   6 V0672
     I                                        7   90V0673
     I                                       10  15 V0674
     I                                       16  180V0675
     I                                       19  220V0676
     I                                       23  23 V0677
     I                                       24  270V0678
     I                                       28  311V0679
     I                                       32  40 V067A
     I                                       41  46 V067B
     I                                       47  530V067C
     I                                       54  600V067D
     I                                       61  610V067IN
     I                                       62  62 V067CX
     *
     I            DS
     I                                        1   50DTDEL
     I                                        1   20WNDEL
     I                                        3   40SEDEL
     I                                        5   50JSDEL
     *
     I            DS
     I                                        1   50DDEDEL
     I                                        1   20ADEDEL
     I                                        3   40SDEDEL
     I                                        5   50JDEDEL
     *
     I            DS
     I                                        1   2 HABIL1
     I                                        1   1 HABI11
     I                                        2   2 HABI12
     *
     I            DS
     I                                        1   2 HABIL2
     I                                        1   1 HABI21
     I                                        2   2 HABI22
     *
     I            DS
     I                                        1   2 HABIL3
     I                                        1   1 HABI31
     I                                        2   2 HABI32
     *
     I            DS
     I                                        1  14 V072
     I                                        1   40V0721
     I                                        5   5 V0722
     I                                        6   90V0723
     I                                       10  10 V0724
     I                                       11  140V0725
     *
     I            DS
     I                                        1  80 V100
     I                                        1  75 V1001
     I                                       76  800V1002
     I                                       76  800V111
     *
     I            DS
     I                                        1  80 V101
     I                                        1  75 V1011
     I                                       76  800V1012
     I                                       76  800V112
     *
     I            DS
     I                                        1  80 V102
     I                                        1  75 V1021
     I                                       76  800V1022
     I                                       76  800V113
     *
     I            DS
     I                                        1  80 V103
     I                                        1  75 V1031
     I                                       76  800V1032
     I                                       76  800V114
     *
     I            DS
     I                                        1  80 V104
     I                                        1  75 V1041
     I                                       76  800V1042
     I                                       76  800V115
     *
     I            DS
     I                                        1  80 V105
     I                                        1  75 V1051
     I                                       76  800V1052
     I                                       76  800V116
     *
     I            DS
     I                                        1  80 V106
     I                                        1  75 V1061
     I                                       76  800V1062
     I                                       76  800V117
     *
     I            DS
     I                                        1  80 V107
     I                                        1  75 V1071
     I                                       76  800V1072
     I                                       76  800V118
     *
     I            DS
     I                                        1  80 V108
     I                                        1  75 V1081
     I                                       76  800V1082
     I                                       76  800V119
     *
     I            DS
     I                                        1  80 V109
     I                                        1  75 V1091
     I                                       76  800V1092
     I                                       76  800V120
     *
     I            DS
     I                                        1  80 V110
     I                                        1  75 V1101
     I                                       76  800V1102
     I                                       76  800V121
     *
     I            DS
     I                                        1  35 V122
     I                                        1   2 V1221
     I                                        3   4 V1222
     I                                        5  12 V1223
     I                                       13  140V1224
     I                                       15  16 V1225
     I                                       17  180V1226
     I                                       19  222V1227
     I                                       23  272V1228
     I                                       28  330V1229
     I                                       34  35 V122M
     *
     I            DS
     I                                        1  35 V123
     I                                        1   2 V1231
     I                                        3   4 V1232
     I                                        5  12 V1233
     I                                       13  140V1234
     I                                       15  16 V1235
     I                                       17  180V1236
     I                                       19  222V1237
     I                                       23  272V1238
     I                                       28  330V1239
     I                                       34  35 V123M
     *
     I            DS
     I                                        1  35 V124
     I                                        1   2 V1241
     I                                        3   4 V1242
     I                                        5  12 V1243
     I                                       13  140V1244
     I                                       15  16 V1245
     I                                       17  180V1246
     I                                       19  222V1247
     I                                       23  272V1248
     I                                       28  330V1249
     I                                       34  35 V124M
     *
     I            DS
     I                                        1  35 V125
     I                                        1   2 V1251
     I                                        3   4 V1252
     I                                        5  12 V1253
     I                                       13  140V1254
     I                                       15  16 V1255
     I                                       17  180V1256
     I                                       19  222V1257
     I                                       23  272V1258
     I                                       28  330V1259
     I                                       34  35 V125M
     *
     I            DS
     I                                        1  35 V126
     I                                        1   2 V1261
     I                                        3   4 V1262
     I                                        5  12 V1263
     I                                       13  140V1264
     I                                       15  16 V1265
     I                                       17  180V1266
     I                                       19  222V1267
     I                                       23  272V1268
     I                                       28  330V1269
     I                                       34  35 V126M
     *
     I            DS
     I                                        1  35 V127
     I                                        1   2 V1271
     I                                        3   4 V1272
     I                                        5  12 V1273
     I                                       13  140V1274
     I                                       15  16 V1275
     I                                       17  180V1276
     I                                       19  222V1277
     I                                       23  272V1278
     I                                       28  330V1279
     I                                       34  35 V127M
     *
     I            DS
     I                                        1  35 V128
     I                                        1   2 V1281
     I                                        3   4 V1282
     I                                        5  12 V1283
     I                                       13  140V1284
     I                                       15  16 V1285
     I                                       17  180V1286
     I                                       19  222V1287
     I                                       23  272V1288
     I                                       28  330V1289
     I                                       34  35 V128M
     *
     I            DS
     I                                        1  35 V129
     I                                        1   2 V1291
     I                                        3   4 V1292
     I                                        5  12 V1293
     I                                       13  140V1294
     I                                       15  16 V1295
     I                                       17  180V1296
     I                                       19  222V1297
     I                                       23  272V1298
     I                                       28  330V1299
     I                                       34  35 V129M
     *
     I            DS
     I                                        1  35 V130
     I                                        1   2 V1301
     I                                        3   4 V1302
     I                                        5  12 V1303
     I                                       13  140V1304
     I                                       15  16 V1305
     I                                       17  180V1306
     I                                       19  222V1307
     I                                       23  272V1308
     I                                       28  330V1309
     I                                       34  35 V130M
     *
     I            DS
     I                                        1  35 V131
     I                                        1   2 V1311
     I                                        3   4 V1312
     I                                        5  12 V1313
     I                                       13  140V1314
     I                                       15  16 V1315
     I                                       17  180V1316
     I                                       19  222V1317
     I                                       23  272V1318
     I                                       28  330V1319
     I                                       34  35 V131M
     *
     I            DS
     I                                        1  37 V132
     I                                        1   20V1321
     I                                        3   90V1322
     I                                       10  160V1323
     I                                       17  230V1324
     I                                       24  280V1325
     I                                       29  330V1326
     I                                       34  35 V1327
     I                                       36  370V1328
     *
     I            DS
     I                                        1  37 V133
     I                                        1   20V1331
     I                                        3   90V1332
     I                                       10  160V1333
     I                                       17  230V1334
     I                                       24  280V1335
     I                                       29  330V1336
     I                                       34  35 V1337
     I                                       36  370V1338
     *
     I            DS
     I                                        1  37 V134
     I                                        1   20V1341
     I                                        3   90V1342
     I                                       10  160V1343
     I                                       17  230V1344
     I                                       24  280V1345
     I                                       29  330V1346
     I                                       34  35 V1347
     I                                       36  370V1348
     *
     I            DS
     I                                        1  37 V135
     I                                        1   20V1351
     I                                        3   90V1352
     I                                       10  160V1353
     I                                       17  230V1354
     I                                       24  280V1355
     I                                       29  330V1356
     I                                       34  35 V1357
     I                                       36  370V1358
     *
     I            DS
     I                                        1  37 V136
     I                                        1   20V1361
     I                                        3   90V1362
     I                                       10  160V1363
     I                                       17  230V1364
     I                                       24  280V1365
     I                                       29  330V1366
     I                                       34  35 V1367
     I                                       36  370V1368
     *
     I            DS
     I                                        1   3 ZB3
     I                                        1   1 ZBX1
     I                                        2   2 ZBX2
     I                                        3   3 ZBX3
     *
     I            DS
     I                                        1   5 ZB83
     I                                        1   1 ZB831
     I                                        2   2 ZB832
     *
     I            DS
     I                                        1  16 V139
     I                                        1   4 PROSF
     I                                        7  10 PROSE
     I                                       13  16 PROSI
     *
     I            DS
     I                                        1   50CODPOS
     I                                        1   20DEPLIV
     I                                        3   50CPLIV
     *
     I            DS
     I I            0                         1   10YNDUL
     I I            0                         2   20YCOL
     I I            '  '                      3   4 CNDD
     I                                        3   3 CNDD1
     I                                        4   4 CNDD2
     I                                        1   4 SIDD
     *
     I            DS
     I                                        1   7 DEMAN
     I                                        1   6 RIREP
     *
     I            DS
     I                                        1  40 CQU
     I                                        1  10 LIBCON
     I                                       13  22 LIBQUA
     I                                       25  34 LIBUTC
     *
     I            DS
     I                                        1  53 IMPERA
     I                                        1  25 IMPER1
     I                                       26  26 IMPER2
     I                                       27  52 IMPER3
     *
     I            DS
     I                                        1   6 RGG
     I I            ' '                       1   1 RA
     I                                        2   2 RGCSF1
     I I            '-'                       3   3 RB
     I                                        4   4 RGCSF2
     I I            '-'                       5   5 RCC
     I                                        6   6 RGCSF3
     *
     I            DS
     I I            0                         1   8 CO
     I                                        1   10COUL1
     I                                        2   20COUL2
     I                                        3   30COUL3
     I                                        4   40COUL4
     I                                        5   50COUL5
     I                                        6   60COUL6
     I                                        7   70COUL7
     I                                        8   80COULS
     *
     I            DS
     I I            0                         1  16 CV
     I                                        1   21CVER1
     I                                        3   41CVER2
     I                                        5   61CVER3
     I                                        7   81CVER4
     I                                        9  101CVER5
     I                                       11  121CVER6
     I                                       13  141CVER7
     I                                       15  161CVERS
     *
     I            DS
     I I            0                         1   8 RC
     I                                        1   10RCOU1
     I                                        2   20RCOU2
     I                                        3   30RCOU3
     I                                        4   40RCOU4
     I                                        5   50RCOU5
     I                                        6   60RCOU6
     I                                        7   70RCOU7
     I                                        8   80RCOU8
     *
     I            DS
     I                                        1   8 TV
     I                                        1   1 TVER1
     I                                        2   2 TVER2
     I                                        3   3 TVER3
     I                                        4   4 TVER4
     I                                        5   5 TVER5
     I                                        6   6 TVER6
     I                                        7   7 TVER7
     I                                        8   8 TVERS
     *
     I            DS
     I                                        1   8 RV
    I*                                       1   1 RVER1                 TMAGPI
     I                                        2   2 RVER2
     I                                        3   3 RVER3
     I                                        4   4 RVER4
     I                                        5   5 RVER5
     I                                        6   6 RVER6
    I*                                       7   7 RVER7                 TMAGPI
     I                                        8   8 RVER8
     *
     I            DS
     I I            0                         1   8 DCO
     I                                        1   10COULD1
     I                                        2   20COULD2
     I                                        3   30COULD3
     I                                        4   40COULD4
     I                                        5   50COULD5
     I                                        6   60COULD6
     I                                        7   70COULD7
     I                                        8   80COULDS
     *
     I            DS
     I                                        1  16 OR
     I                                        1   2 ORCU1
     I                                        3   4 ORCU2
     I                                        5   6 ORCU3
     I                                        7   8 ORCU4
     I                                        9  10 ORCU5
     I                                       11  12 ORCU6
     I                                       13  14 ORCU7X
     I                                       15  16 ORCUS
     *
     *
     I            DS
     I                                        1   1 DZPNBR
     I                                        2   2 DZPNB2
     I                                        1   2 SUPHA2
     *
     IDSONDU      DS
     I                                        1   10WTE
     I                                        2   20YSINE
     I                                        3   70WCONF
     I                                        8   90WEQFAB
     I                                       10  130WOCLI
     I                                       14  170WOPRO
     I                                       18  19 PRMAC
     *
     IPARM0A      DS
     I                                        1   10PUSINE
     I                                        2   2 PSECT
     I                                        3   3 PSSECT
     I                                        4   5 PNOMAC
     I                                        6   90PNOCLI
     I                                       10  130PNOPRO
     I                                       14  14 PEXIST
     I                                       15  15 PONDRT
     I                                       16  16 PCODST
     I                                       17  17 PCMPEC
     *
     *****************************************************************
     *     CLES D'ACCES AUX FICHIERS
     *****************************************************************
     *
     * cle pour le fichier parametre .
     C           KPARAM    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *
     *  CLE D'ACCES FICHIER MVTIMP
     *
     C           KMVTLF    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KMVTPR    KLIST
     C                     KFLD           STEE    10
     C                     KFLD           WIMP1
     C                     KFLD           WIMP2
     *
     * cle pour le fichier CARCDE .
     C           KCARCD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     C           KCARCU    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     * cle pour le fichier CAIPALL1
     C           KSTAL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           SSS
     C                     KFLD           AAA
     C                     KFLD           MMM
     *
     * cle pour le fichier CAIPALL1
     C           KCAIL1    KLIST
     C                     KFLD           PUS     10
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER CLIENTS
     C           KCLIL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     *
     *  CLE D'ACCES FICHIER CLIENTS  LIVRAISON
     C           KLIVL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WGLIV
     *
     *  CLE D'ACCES FICHIER HISTOF16
     C           KHIS06    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO   40
     C                     KFLD           WECT    1
     C                     KFLD           WSECT   1
     *
     C           KHIS16    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           ANPRO
     C                     KFLD           WECT
     C                     KFLD           WSECT
     *
     *  CLE D'ACCES FICHIER CDESL1
     C           KCDES1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     C           KCDES2    KLIST
     C                     KFLD           WCONF
     C                     KFLD           PRODOR
     *
     *  CLE D'ACCES FICHIER LIEUST03
     C           KLIE03    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WORD    10
     *
     *  CLE D'ACCES FICHIER PRODUI2
     C           KPRO10    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KPRST2    KLIST
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KPRO11    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     *
     C           KPRO22    KLIST
     C                     KFLD           PAPI3
     C                     KFLD           GRAM3
     C                     KFLD           ADPAP3
     C                     KFLD           ADGRA3
     C                     KFLD           FORLST
     C                     KFLD           FORHST
     *
     C           KHIVAL    KLIST
     C                     KFLD           CLIVAL
     C                     KFLD           PROVAL
     *
     *  CLE D'ACCES FICHIER OBSPROL
     C           KOBSP1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     *
     C           KOBSP2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     C                     KFLD           EMET
     *
     C           KOBSP3    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           EMET
     *
     *  CLE D'ACCES FICHIER PREIMPL
     C           KPREI1    KLIST
     C                     KFLD           WIMP1   40
     C                     KFLD           WIMP2   40
     *
     C           KPREI2    KLIST
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER PLAMA
     C           KPLAM1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     *
     C           KPLAM2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER RESIMPL2
     C           KRESI2    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           WOPRO
     C                     KFLD           SUPPOR
     *
     *  CLE D'ACCES FICHIER RESCXHL1
     C           KRESC1    KLIST
     C                     KFLD           WUS
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     *
     *  CLE D'ACCES FICHIER RESPAPL5
     C           KRESP5    KLIST
     C                     KFLD           WUS     10
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     *
     C           KRES15    KLIST
     C                     KFLD           WUS     10
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     *
     C           KRES25    KLIST
     C                     KFLD           WUS     10
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PECPAP
     C                     KFLD           SUPOR
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     *
     *  CLE D'ACCES FICHIER BESOMAT
     C           KBESL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER PLANIFL1
     *
     C           KPLAL2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           FECT    1
     C                     KFLD           FSECT   1
     *
     *  CLE D'ACCES FICHIER CDEQUA
     C           KQUAL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     ***************************************************************
     *   DEBUT DU PROGRAMME                                        *
     ***************************************************************
     *
     C                     MOVE 'USFO'    PXARGU
     C           PXARGU    SETLLPARAME
D1  C                     DO   *HIVAL    I
     C           PXARGU    READEPARAME                   50
D2  C           *IN50     IFEQ '0'
     C                     MOVE PXVALE    TSX,I
     C                     Z-ADDPXMONT    TB,I
F2  C                     END
F1  C  N50                END
     *
     C                     Z-ADD0         I
     C                     MOVE 'CEXT'    PXARGU
     C           PXARGU    CHAINPARAME               50
D1  C           *IN50     DOWEQ'0'
D2  C           PXMONT    IFEQ 0
     C                     ADD  1         I
     C                     MOVE PXVALE    CXT,I
F2  C                     END
     C           PXARGU    READEPARAME                   50
F1  C  N50                END
     *
     *
     C                     Z-ADD0         DEPLIV
     C                     Z-ADD0         YACON
     C                     Z-ADD0         COAS1
     C                     Z-ADD0         SURF
     C                     Z-ADD0         SF
     C                     Z-ADD0         MAX
     C                     Z-ADD0         MIN
     C                     Z-ADD0         DTMAJ
     C                     Z-ADD0         DTCRE
     C                     Z-ADD0         WCONF1
     C                     Z-ADD0         WOPRO1
     C                     MOVE *BLANKS   V0181
     C                     MOVE *BLANKS   V138   15
     C                     MOVE ' '       FORHB   1
     C                     MOVE 'F'       PECPAP  1
     C                     Z-ADDUYEAR     YEAR
     C                     Z-ADDUMONTH    MONTH
     C                     Z-ADDUDAY      DAY
     C                     Z-ADDUYEAR     YEAR1X
     C                     Z-ADDUMONTH    MONTHX
     C                     Z-ADDUDAY      DAYX
     C                     Z-ADD9         STEVAL  10
     C                     Z-ADD9999      CLIVAL  40
     C                     Z-ADD9999      PROVAL  40
     C                     Z-ADD9999      NOCLI
     C                     Z-ADD9999      NOPRO
     C                     Z-ADD20        SSS     20
     C                     Z-ADD99        AAA     20
     C                     Z-ADD99        MMM     20
     C           KHIVAL    CHAINPRODUI2              81
     C   81                WRITEPRODUIF1
     *
     *              ///////////////////////////
     *              /  DEBUT DU TRAITEMENT :  /
     *              ///////////////////////////
     *
     C                     READ CDESL1                   80
     C           *LIKE     DEFN WEQFAB    WWQFAB
     C                     Z-ADDWSINE     PUS
     *
     * COMMANDE SANS VETO
     C                     MOVE *BLANKS   V084   40
     *
D1  C           *IN80     DOWEQ'0'
     C                     MOVE *BLANKS   V0181  40
     C                     MOVEL*BLANKS   V41AFF 40
     C                     MOVE '  '      PP      2
     C                     Z-ADD0         AFFIC1  40
     C                     Z-ADD0         AFFIC2  40
     C                     Z-ADD0         UFFIC1  10
     C                     Z-ADD0         UFFIC2  10
     C                     Z-ADD0         USEXT1  10
     C                     Z-ADD0         USEXT2  10
     C                     SETOF                     2579
     * TMAGPI SD1469717
     C                     MOVE *BLANK    WW402   3
     C                     MOVE *BLANK    WW401  36
     *
D2  C           WAGBID    IFEQ 'U'
    C           *INU1     ANDEQ'0'
     C                     MOVELCON,20    V084
F2  C                     END
     *
     C                     SETOF                     3031
     C                     Z-ADD1         WEQFAB
     C                     Z-ADD0         WWTFAC
     C           KCARCD    CHAINCARCDEL1             81
D2  C           *IN81     IFEQ '1'
     C                     MOVELCON,21    V0181
     C                     MOVE 'CARCDE  'V0181  40
F2  C                     END
D2  C           WARNT     IFEQ 'RE'
     C           KPRO10    CHAINPRODUL10             81
D3  C           *IN81     IFEQ '0'
    C           YARNT     ANDEQ'PP'
     C                     MOVE 'PP'      PP
     C                     SETON                     25
X3  C                     ELSE
    C                     GOTO SUITE
F3  C                     END
F2  C                     END
D2  C           WTFAC     IFEQ *ZEROS
D3  C           WTFAC     DOWEQ*ZEROS
     C           KCDES1    READECARCDEL1                 81
F3  C  N81                END
     C           *LIKE     DEFN WTFAC     WWTFAC
     C                     Z-ADDWTFAC     WWTFAC
     C                     Z-ADDWEQFAB    WWQFAB
     C                     Z-ADD1         WEQFAB
     C           KCARCD    CHAINCARCDEL1             81
     C                     Z-ADDWWTFAC    WTFAC
F2  C                     END
     *
     C           AFFDEB    TAG
     *
     *
     C           KBESL1    CHAINBESOMAL1             81
D2  C           *IN81     IFEQ '1'
    C           YARNT     ANDNE'PP'
     C                     MOVELCON,21    V0181
     C                     MOVE 'BESOMAT 'V0181
F2  C                     END
D2  C           SBFE      IFEQ *ZEROS
D3  C           FORLBM    IFNE *ZEROS
    C           FORHBM    ANDNE*ZEROS
    C           SBFE      ANDEQ*ZEROS
     C           FORLBM    MULT 0,001     WORLBM  43
     C           FORHBM    MULT 0,001     WORHBM  43
     C           WORLBM    MULT WORHBM    SBFE
F3  C                     END
D3  C           SBFE      IFEQ *ZEROS
     C                     Z-ADDSBZ       SBFE
F3  C                     END
F2  C                     END
D2  C           WOPRO     IFGT 8000
    C           *IN79     ANDEQ'1'
     C                     Z-ADDBTFAB     WTFAC
     C                     Z-ADDBTREN     WTIMP
D3  C           BTPRE     IFNE 0
     C                     Z-ADDBTPRE     WTIMP
F3  C                     END
     C                     Z-ADDUSEXT1    WSEXT
     C                     Z-ADDUSEXT1    WSINE
D3  C           UFFIC1    IFNE 0
     C                     Z-ADDUFFIC1    WSINE
F3  C                     END
     C                     Z-ADD0         WSINT
F2  C                     END
     *  ---> TITRE GROUPE
     *  -----------------
     *
     C                     SETOF                     40
     C                     MOVELGROUPE    V019    4
     C           KHIVAL    CHAINPRODUI2              81
     *
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           WOPRO     IFGT 8000
    C           *IN79     ANDEQ'1'
     C           KPRST2    CHAINPRODST3              81
     C                     Z-ADDIMPA      TIM,3
     C                     MOVE RIMA1     TRE,3
     C                     Z-ADDCOUA      CO,3
     C                     MOVE TVEA      TV,3
     C                     Z-ADDCVEA      CV,3
     C                     MOVE ORA       OR,3
     C                     MOVE RIMA1     TRE,3
     C                     Z-ADDCOUAR     RC,3
     C                     MOVE TVEAR     RV,3
     C                     MOVE TSA       TS,3
D4  C           LAIA      IFNE 0
     C                     Z-ADDLAIA      LAIZE
     C                     MOVE 'B'       COP,3
F4  C                     END
     C                     Z-ADDLA        FOL,3
     C                     Z-ADDHA        FOH,3
     C                     Z-ADDLA        FORLST
     C                     Z-ADDHA        FORHST
D4  C           MASSI     IFNE *BLANKS
     C                     MOVE LA        ZB84
     C           HA        DIV  2         ZB851   40
     C                     MOVE ZB851     ZB85
X4  C                     ELSE
D5  C           FMASAL    IFNE *ZEROS
     C                     Z-ADDFMASAL    FORLST
     C                     Z-ADDFMASAH    FORHST
     C                     MOVE LA        ZB84
     C                     MOVE HA        ZB85
X5  C                     ELSE
     C                     MOVEL' 0000'   ZB84
     C                     MOVEL' 0000'   ZB85
F5  C                     END
F4  C                     END
     C                     MOVE INPLAA    ZB16
     C                     MOVE TYPAFF    TYPPRP
     C                     MOVE BLO4AA    BLOC4
     C                     MOVE CLIA      REFEX
     C                     MOVE CLIAR     REREP
     C                     MOVE GAUF1     YFRA
     C                     MOVE NOGF1     REFGAU
D4  C           MASSI     IFNE ' '
     C                     DIV  2         BTPRE
     C                     DIV  2         BTREN
     C                     DIV  2         WTIMP
F4  C                     END
X3  C                     ELSE
     C           KPRO10    CHAINPRODUL10             81
     * TMAGPI SD1469717
D4  C           *IN81     IFEQ '0'
    C           USINE     ANDEQ3
    C           WOPRO     ANDLT8000
     * RECHERCHE SI ONDULE SUR 2110 (RVER7) OU SUR 2114 (CMPECH)
     C                     MOVE '  '      PRMAC
     C                     Z-ADDUSINE     YSINE
     C                     CALL 'ONDUL3£'
     C                     PARM           DSONDU
D5  C           PRMAC     IFEQ '14'
     C                     Z-ADD3         PUSINE
     C                     MOVE '2'       PSECT
     C                     MOVE '1'       PSSECT
     C                     MOVE '14'      PNOMAC
     C                     Z-ADDWOPRO     PNOPRO
     C                     Z-ADDWOCLI     PNOCLI
     C                     CALL 'FTOND0A£'
     C                     PARM           PARM0A
D6  C           PEXIST    IFEQ 'O'
    C           PCMPEC    ANDEQ'O'
     C                     MOVE 'OUI'     WW402
X6  C                     ELSE
     C                     MOVE 'NON'     WW402
F6  C                     END
X5  C                     ELSE
D6  C           RVER7     IFEQ 'O'
     C                     MOVE 'OUI'     WW402
X6  C                     ELSE
     C                     MOVE 'NON'     WW402
F6  C                     END
F5  C                     END
     C                     MOVELCON,29    WW401
     C                     MOVE WW402     WW401
F4  C                     END
     *
     C  N81      KPRST2    CHAINPRODST2              81
D4  C           *IN81     IFEQ '1'
     C                     MOVELCON,21    V0181
     C                     MOVE 'PRODST2 'V0181
F4  C                     END
D4  C           NATMAI    IFNE ' '
     C           *LIKE     DEFN TYPPRP    TYPAFF
     C                     MOVE TYPPRP    TYPAFF
     C           KPRST2    CHAINPRODS3L1             81
D5  C           *IN81     IFEQ '0'
     C                     MOVE NOPRO3    AFFIC1
     C                     MOVE USA       USEXT1
D6  C           USGF1     IFNE 0
     C                     Z-ADDUSGF1     UFFIC1
F6  C                     END
D6  C           USGF2     IFNE 0
     C                     Z-ADDUSGF2     UFFIC1
F6  C                     END
D6  C           USMAS     IFNE 0
     C                     Z-ADDUSMAS     UFFIC1
F6  C                     END
F5  C                     END
     C           KPRST2    READEPRODS3L1                 81
D5  C           *IN81     IFEQ '0'
     C                     MOVE NOPRO3    AFFIC2
     C                     MOVE USA       USEXT2
D6  C           USGF1     IFNE 0
     C                     Z-ADDUSGF1     UFFIC2
F6  C                     END
D6  C           USGF2     IFNE 0
     C                     Z-ADDUSGF2     UFFIC2
F6  C                     END
D6  C           USMAS     IFNE 0
     C                     Z-ADDUSMAS     UFFIC2
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     *  RECHERCHE PRODUIT UTILISANT UN COMPLEXE
D3  C           YNDUL     IFEQ 0
    C           YACON     ANDNE1
    C           WOCLI     ANDEQ8928
D4  C           YCOL      IFEQ 4
    C           YCOL      OREQ 7
     C           KPRO22    CHAINPRODUL22             83
D5  C           *IN83     IFEQ '0'
     C                     SETON                     40
     C                     Z-ADDNOFOR     FORCPL  50
     C                     Z-ADDPOSF1     POSCPL  20
F5  C                     END
F4  C                     END
F3  C                     END
     C                     Z-ADD0         ZB841
     C                     Z-ADD0         ZB851
D3  C           ZB84      IFNE *BLANKS
     C                     MOVE ZB84      ZB841   40
F3  C                     END
D3  C           ZB85      IFNE *BLANKS
     C                     MOVE ZB85      ZB851   40
F3  C                     END
X2  C                     ELSE
     C           KPREI2    CHAINPREIMPL              81
D3  C           *IN81     IFEQ '1'
     C                     MOVELCON,21    V0181
     C                     MOVE 'PREIMPL 'V0181
F3  C                     END
F2  C                     END
     *
     *
     *  ---> DATE D'EDITION DU DOCUMENT
     *  -------------------------------
     *
     *       YEAR,MONTH,DAY
     *
     *  ---> USINE IMPRESSION ,USINE FACONNAGE
     *  --------------------------------------
     *
     C                     MOVE *BLANKS   V003
     C                     MOVE '____'    V003X
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USIN'    PXARGU
     C                     MOVE WSEXT     PXVALE
     C           KPARAM    CHAINPARAME               90
D2  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0031
X2  C                     ELSE
     C                     MOVEL'__'      V0031
F2  C                     END
     *
     C                     MOVE WSINT     PXVALE
     C           KPARAM    CHAINPARAME               90
D2  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0032
X2  C                     ELSE
     C                     MOVEL'__'      V0032
F2  C                     END
     *
     C                     MOVE WSINE     PXVALE
     C           KPARAM    CHAINPARAME               90
D2  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V0033
X2  C                     ELSE
     C                     MOVEL'__'      V0033
F2  C                     END
     *
     C                     Z-ADDWSINE     USFAC   10
     *
     *  ---> TITRE
     *  -----------------
     *
     C                     MOVE *BLANKS   V001   17
D2  C           IMPSTO    IFNE *BLANKS
     C                     MOVELCON,1     V001
F2  C                     END
     *
D2  C           PRESER    IFNE *BLANKS
     C                     MOVELCON,11    V001
F2  C                     END
     *
D2  C           WDEPR2    IFNE *BLANKS
     C                     MOVELCON,12    V001
F2  C                     END
     *
     *  ---> NOM DU CLIENT
     *  ------------------
     *
     C                     MOVE *BLANKS   V004   40
D2  C           IMPSTO    IFEQ *BLANKS
     C           KCLIL1    CHAINCLIENTS1             71
D3  C           *IN71     IFEQ '1'
     C                     MOVELCON,21    V0181
     C                     MOVE 'CLIENTS 'V0181
F3  C                     END
     C                     MOVE NOMCLI    V004
X2  C                     ELSE
     C                     MOVELCON,1     V004
F2  C                     END
     *
     *  ---> NUMERO DU CLIENT
     *  ---------------------
     *
     C                     MOVE WOCLI     V005    40
     *
     *  ---> NUMERO DU PRODUIT
     *  ----------------------
     *
     C                     MOVE WOPRO     V006    40
     C                     MOVE YARNT     YARN    2
D2  C           YARNT     IFEQ 'PP'
     C                     MOVE 'RE'      YARN    2
F2  C                     END
     *
     *  ---> CONFIRMATION + SEQUENCE
     *  ----------------------------
     *
     C                     MOVELWCONF     V0071   50
     C                     MOVE WEQFAB    V0072   20
     *
     *  ---> DATE DERNIERE FABRICATION
     *  ------------------------------
     *
     C                     MOVE *ZEROS    V008
D2  C           IMPSTO    IFEQ *BLANK
    C           *IN79     ANDEQ'0'
D3  C           YCOL      IFEQ 1
    C           YCOL      OREQ 5
    C           YCOL      OREQ 6
     C                     MOVE '3'       WECT
     C                     MOVE '1'       WSECT
X3  C                     ELSE
D4  C           YNDUL     IFEQ 0
D5  C           YACON     IFEQ 0
    C           YACON     OREQ 1
     C                     MOVE '2'       WECT
     C                     MOVE '1'       WSECT
F5  C                     END
D5  C           YCOL      IFEQ 0
     C                     MOVE '5'       WECT
     C                     MOVE '1'       WSECT
F5  C                     END
X4  C                     ELSE
     C                     MOVE '2'       WECT
     C                     MOVE '1'       WSECT
F4  C                     END
F3  C                     END
D3  C           PP        IFEQ 'PP'
     C                     MOVE '8'       WECT
     C                     MOVE '2'       WSECT
F3  C                     END
     *
     C                     SETOF                     82
     C           KHIS06    CHAINHISTOF16             81
D3  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D4  C           *IN81     DOWEQ'0'
     C           KHIS06    READEHISTOF16                 81
D5  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDLTXOSEQ1
     C                     SETON                     8182
F5  C                     END
F4  C  N81                END
     C   82                READPHISTOF16                 81
     C                     Z-ADDAFAB      V0083
     C                     Z-ADDMFAB      V0082
     C                     Z-ADDJFAB      V0081
X3  C                     ELSE
     C           KHIS16    CHAINHISTOF16             81
D4  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D5  C           *IN81     DOWEQ'0'
     C           KHIS16    READEHISTOF16                 81
D6  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDLTXOSEQ1
     C                     SETON                     8182
F6  C                     END
F5  C  N81                END
     C   82                READPHISTOF16                 81
     C                     Z-ADDAFAB      V0083
     C                     Z-ADDMFAB      V0082
     C                     Z-ADDJFAB      V0081
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *
     *  ---> ANCIEN NUMERO DE PRODUIT
     *  -----------------------------
     *
     C                     MOVE *ZEROS    V009    40
     C                     MOVE *BLANKS   V010   40
D2  C           IMPSTO    IFEQ ' '
     C                     MOVE ANPRO     V009
     *
     *  ---> CAUSE CHANGEMENT DE PRODUIT
     *  --------------------------------
     *
     C                     MOVEL'CAUSE '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V010
F3  C                     END
F2  C                     END
     *
     *  ---> CODE PRODUIT CLIENT
     *  ------------------------
     *
     C                     MOVE *BLANKS   V011   20
D2  C           IMPSTO    IFEQ ' '
     C                     MOVE INDPCL    V011
F2  C                     END
     *
     *  ---> DESIGNATION PRODUIT
     *  ------------------------
     *
     C                     MOVE *BLANKS   V012   40
     C                     MOVE *BLANKS   V013   40
     C                     MOVE *BLANKS   V014   40
     C                     MOVE *BLANKS   V015   40
     C                     MOVE *BLANKS   V016   40
     C                     MOVE *BLANKS   V017   40
     C                     MOVE *BLANKS   V018   40
     *
D2  C           IMPSTO    IFNE ' '
     C                     MOVELDPRIMP    V012
     C                     MOVEL'DEFINI'  DEST
     C                     Z-ADD0         CPT
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     DOWEQ'0'
     C                     ADD  1         CPT
D4  C           CPT       IFEQ 1
     C                     MOVE OBSLIB    V013
F4  C                     END
D4  C           CPT       IFEQ 2
     C                     MOVE OBSLIB    V014
F4  C                     END
D4  C           CPT       IFEQ 3
     C                     MOVE OBSLIB    V015
F4  C                     END
D4  C           CPT       IFEQ 4
     C                     MOVE OBSLIB    V016
F4  C                     END
D4  C           CPT       IFEQ 5
     C                     MOVE OBSLIB    V017
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 82
F3  C  N82                END
     *
     *
     * SI PRODUIT
X2  C                     ELSE
     C                     MOVE BLOC1     V012
     C                     MOVE BLOC2     V013
     *
     * CONSTITUTUION DU BLOC3
D3  C           SUPB3     IFEQ ' '
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE ' BL3'    PXARGU
     C                     MOVE BT3       PXVALE
     C           KPARAM    CHAINPARAME               99
D4  C           *IN99     IFEQ '0'
     C                     MOVE PXLIBE    V014
D5  C           NBRFE     IFGT 0
     C                     MOVE ' 999'    PXVALE
     C           KPARAM    CHAINPARAME               98
D6  C           *IN98     IFEQ '0'
     C                     MOVELPXLIBE    V0141
     C                     MOVE NBRFE     V0142
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C                     MOVE BLOC4     V015
     C                     MOVE BLOC5     V016
     C                     MOVE BLOC6     V017
     C                     MOVE BLOC7     V018
F2  C                     END
     *
     * COMPOSANTS DU PRESENTOIR
     C                     MOVE *BLANKS   V085   40
     C                     MOVE *BLANKS   V086   40
     C                     MOVE *BLANKS   V087   40
     C                     MOVE *BLANKS   V088   40
     C                     MOVE *BLANKS   V037
     C                     MOVE *BLANKS   V038
     C                     MOVE *BLANKS   V039
     C                     MOVE *BLANKS   V040
     *
D2  C           YARNT     IFEQ 'PP'
     C                     Z-ADD0         E       20
     C                     MOVELCON,28    V037
     C           KPRST2    CHAINCOMPREL1             90
D3  C           *IN90     DOWEQ'0'
     C                     RESETB041
     C                     ADD  1         E
     C                     MOVE E         B0412
     C                     MOVE CARNT     B0413
     C                     MOVE NOPGAR    B0414
     C                     MOVE NBREEL    B0416
D4  C           E         IFEQ 1
     C                     MOVELB041      V038
F4  C                     END
D4  C           E         IFEQ 2
     C                     MOVELB041      V039
F4  C                     END
D4  C           E         IFEQ 3
     C                     MOVELB041      V040
F4  C                     END
D4  C           E         IFEQ 4
     C                     MOVE B041      V038
F4  C                     END
D4  C           E         IFEQ 5
     C                     MOVE B041      V039
F4  C                     END
D4  C           E         IFEQ 6
     C                     MOVE B041      V040
F4  C                     END
     C           KPRST2    READECOMPREL1                 90
F3  C  N90                END
F2  C                     END
     *
     *  ---> OBSERVATIONS PLANNING
     *  --------------------------
     *
     C                     MOVE *BLANKS   V020   40
     C                     MOVE *BLANKS   V021   40
     C                     MOVE *BLANKS   V022   40
     C                     Z-ADD*ZEROS    T       10
     *
     C                     MOVEL'PLANNI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V020
     C   22                MOVE OBSLIB    V021
     C   23                MOVE OBSLIB    V022
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVEL'COLORE'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V020
     C   22                MOVE OBSLIB    V021
     C   23                MOVE OBSLIB    V022
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVEL'COLORI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V020
     C   22                MOVE OBSLIB    V021
     C   23                MOVE OBSLIB    V022
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *
     *  ---> OBSERVATIONS COMMERCIALES
     *  ------------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *BLANKS   VCTL1
     C                     MOVE *BLANKS   VCTL2
     C                     MOVE *BLANKS   VDTL
     C                     MOVE *BLANKS   CIA
     C                     Z-ADD0         I       30
     *
     *
     C           KQUAL1    CHAINCDEOBSL2             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSERV    VAR,I
D3  C           TYPOBS    IFEQ 'I'
     C                     MOVE 'INTERNE' CIA,I
F3  C                     END
     *
D3  C           TYPOBS    IFEQ 'C'
     C                     MOVE 'CLIENT ' CIA,I
F3  C                     END
     *
D3  C           TYPOBS    IFEQ 'M'
     C                     MOVE 'MARCHE ' CIA,I
F3  C                     END
     *
     C           KQUAL1    READECDEOBSL2                 81
F2  C  N81                END
D2  C           I         IFLT 7
     C                     ADD  1         I
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'NCDE'    PXARGU
     C                     MOVE STOND     PXVALE
     C           KPARAM    CHAINPARAME               99
     C  N99                MOVELPXLIBE    VAR,I
F2  C                     END
     *
     C                     MOVEAVAR,1     VCTL1
     C                     MOVEAVAR,7     VCTL2
     C                     MOVEACIA,1     VDTL
     *
     *  ---> OBSERVATIONS ALERTE
     *  ------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     Z-ADD0         I
     *
     *  - PREMIERE COMMANDE
     C           KSTAL1    SETGTSTACOML8
     C           KCARCU    READESTACOML8                 81
D2  C           *IN81     IFEQ '0'
D3  C           WWC       IFEQ WCONF
     C           KCARCU    READESTACOML8                 81
D4  C           *IN81     IFEQ '1'
     C                     ADD  1         I
     C                     MOVELCON,18    VAR,I
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     ADD  1         I
     C                     MOVELCON,18    VAR,I
F2  C                     END
     *
    C           IMPSTO    CABNE*BLANKS   SUITAL
     *  - GROUPAGE
D2  C           YARNT1    IFEQ 'M'
    C           YARNT3    ANDGT'0'
     C                     ADD  1         I
     C                     MOVELCON,4     VAR,I
F2  C                     END
     *
     *  - GARNITURE
D2  C           YARNT1    IFNE 'M'
    C           YARNT1    ANDNE' '
    C           YARNT     ANDNE'PP'
     C                     ADD  1         I
     C                     MOVELCON,5     YARNT2
     C                     MOVELVARNT     VAR,I
F2  C                     END
     *
     *  - COMMANDE D'ESSAIS
D2  C           YARNT     IFEQ 'MD'
     C                     ADD  1         I
     C                     MOVELCON,6     VAR,I
F2  C                     END
     *
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - COMMANDE D'HOMOLOGATION
D2  C           YARNT     IFEQ 'MH'
     C                     ADD  1         I
     C                     MOVELCON,7     VAR,I
F2  C                     END
     *
     *  - COMMANDE PRESENTOIR
D2  C           YARNT     IFEQ 'PP'
     C                     ADD  1         I
     C                     MOVELCON,27    VAR,I
F2  C                     END
     *
     *
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'L'
     C                     ADD  1         I
     C                     MOVELCON,10    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'A'
     C                     ADD  1         I
     C                     MOVELCON,16    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'Z'
     C                     ADD  1         I
     C                     MOVELCON,23    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TSOND     IFEQ 'SC'
     C                     ADD  1         I
     C                     MOVELCON,22    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *          IMPRESSION EXT. INT.
D2  C           TIM,4     IFEQ *ZEROS
    C           TIM,5     ANDEQ*ZEROS
    C           TIM,6     ANDEQ*ZEROS
    C           TIM,7     ANDEQ*ZEROS
    C           NIMPI1    ANDEQ*BLANKS
     C                     SETOF                     61
X2  C                     ELSE
     C                     SETON                     61
F2  C                     END
D2  C           TIM,1     IFEQ *ZEROS
    C           TIM,2     ANDEQ*ZEROS
    C           TIM,3     ANDEQ*ZEROS
    C           NIMPE1    ANDEQ*BLANKS
     C                     SETOF                     62
X2  C                     ELSE
     C                     SETON                     62
F2  C                     END
D2  C           *IN61     IFEQ '1'
    C           *IN62     ANDEQ'1'
     C                     ADD  1         I
     C                     MOVELCON,8     VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     C           SUITAL    TAG
     *
     * SOUS-TRAITANCE
D2  C           EMBA1     IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE EMBA1     PXVALE
D3  C           EMBA1     IFEQ 'N'
     C                     MOVE EMBA1     V046    4
F3  C                     END
     C                     MOVE 'TDST'    PXARGU
     C           KPARAM    CHAINPARAME               99
D3  C           *IN99     IFEQ '0'
    C           PXMONT    ANDGE10
    C           PXMONT    ANDLT20
     C                     ADD  1         I
     C                     MOVELPXLIBE    VAR,I
F3  C                     END
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           EMBA2     IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE EMBA2     PXVALE
D3  C           EMBA2     IFEQ 'N'
     C                     MOVE EMBA2     V046
F3  C                     END
     C                     MOVE 'TDST'    PXARGU
     C           KPARAM    CHAINPARAME               99
D3  C           *IN99     IFEQ '0'
    C           PXMONT    ANDGE10
    C           PXMONT    ANDLT20
     C                     ADD  1         I
     C                     MOVELPXLIBE    VAR,I
F3  C                     END
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           CAIS1     IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE CAIS1     PXVALE
D3  C           CAIS1     IFEQ 'N'
     C                     MOVE CAIS1     V046
F3  C                     END
     C                     MOVE 'TDST'    PXARGU
     C           KPARAM    CHAINPARAME               99
D3  C           *IN99     IFEQ '0'
    C           PXMONT    ANDGE10
    C           PXMONT    ANDLT20
     C                     ADD  1         I
     C                     MOVELPXLIBE    VAR,I
F3  C                     END
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     C                     MOVE 'ST    '  EMET
     *
     C           KOBSP3    CHAINOBSPROL3             81
D2  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELCON,9     VAR,I
F2  C                     END
     *
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           BRSTD     IFEQ '*'
     C                     ADD  1         I
     C                     MOVELCON,13    VAR,I
F2  C                     END
     C           I         COMP 4                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     * CONCEPTION,QUALITE,UTILISATION
     C                     MOVE *BLANKS   CQU
D2  C           PUS       IFEQ 3
     C                     MOVE GRAP1     PXVALE    P
     C                     MOVE 'TUTC'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBUTC
F3  C                     END
     C                     MOVE COUP1     PXVALE    P
     C                     MOVE 'TCON'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBCON
F3  C                     END
     C                     MOVE NATE1     PXVALE    P
     C                     MOVE 'TQUA'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D3  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBQUA
F3  C                     END
     C                     ADD  1         I
     C                     MOVELCQU       VAR,I
F2  C                     END
     *
     C           FINATT    TAG
     C                     MOVELVAR,1     V037   40
     C                     MOVELVAR,2     V038   40
     C                     MOVELVAR,3     V039   40
     C                     MOVELVAR,4     V040   40
     *
     *
     *  ---> MATERIEL IMPRESSION, MATERIEL DECOUPAGE
     *  --------------------------------------------
     *
     C                     SETOF                     9495
     C                     Z-ADD0         T
     C                     MOVE *BLANKS   VAR
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
     C                     MOVELV041      VAR,1
     C                     MOVELV041      VAR,2
     C                     MOVELV041      VAR,3
     C                     MOVELV041      VAR,4
     *
     C   U1      KPLAM2    CHAINPLAMAL1              82
     C  NU1      KPLAM1    CHAINPLAMAL1              82
     *
     C   U1N82   NCONF     COMP 0                        83
     C   U1N82N83WCONF     COMP NCONF                8282
     *
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           1         DO   7         I
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
D4  C           TIM,I     IFNE 0
D5  C           I         IFLT 4
     C                     Z-ADD1         J
     C           TIM,I     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C   55                MOVE 'E'       V0411
     C                     MOVE REFEX     V0413
     C   U1N82   REFEX     COMP *BLANKS                  35
D6  C           WSEXT     IFEQ 3
    C           REFEX     ANDEQ'   508'
    C           REREP     ANDNE'      '
     C                     MOVE REREP     V0413
     C                     MOVE '+'       V0414
     C                     MOVE '1'       *IN94
F6  C                     END
D6  C           WSEXT     IFEQ 3
    C           REFEX     ANDNE'      '
    C           REREP     ANDEQ'   508'
     C                     MOVE '+'       V0414
     C                     MOVE '1'       *IN94
F6  C                     END
     C                     Z-ADD1         J       30
D6  C           *IN82     IFEQ '0'
     C           ETAT01    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
D7  C           *IN94     IFEQ '1'
     C                     Z-ADD1         V       30
     C           ETAT02    LOKUPETA,V                    55
D8  C           V         IFLT J
     C   55                MOVELLET,V     V0412
F8  C                     END
F7  C                     END
X6  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F6  C                     END
     *
X5  C                     ELSE
     *
     C                     Z-ADD1         J
     C           TIM,I     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C   55                MOVE 'I'       V0411
     C                     MOVE REFIN     V0413
     C   U1N82   REFIN     COMP *BLANKS                  35
D6  C           WSINT     IFEQ 3
    C           REFIN     ANDEQ'   508'
    C           RIREP     ANDNE'      '
     C                     MOVE RIREP     V0413
     C                     MOVE '+'       V0414
     C                     MOVE '1'       *IN95
F6  C                     END
D6  C           WSINT     IFEQ 3
    C           REFIN     ANDNE'      '
    C           RIREP     ANDEQ'   508'
     C                     MOVE '+'       V0414
     C                     MOVE '1'       *IN95
F6  C                     END
D6  C           *IN82     IFEQ '0'
     C                     Z-ADD1         J
     C           ETAT03    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
D7  C           *IN95     IFEQ '1'
     C                     Z-ADD1         V       30
     C           ETAT04    LOKUPETA,V                    55
D8  C           V         IFLT J
     C   55                MOVELLET,V     V0412
F8  C                     END
F7  C                     END
X6  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F6  C                     END
F5  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F4  C                     END
F3  C                     END
     *
D3  C           1         DO   7         I
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
D4  C           TRE,I     IFNE 0
D5  C           I         IFLT 4
D6  C           *IN94     IFEQ '0'
     C                     Z-ADD1         J
     C           TRE,I     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C   55                MOVE 'E'       V0411
     C                     MOVE REREP     V0413
     C   U1N82   REREP     COMP *BLANKS                  35
     C                     Z-ADD1         J       30
D7  C           *IN82     IFEQ '0'
     C           ETAT02    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X7  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F7  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F6  C                     END
     *
X5  C                     ELSE
D6  C           *IN95     IFEQ '0'
     C                     Z-ADD1         J
     C           TRE,I     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C   55                MOVE 'I'       V0411
     C                     MOVE RIREP     V0413
     C   U1N82   RIREP     COMP *BLANKS                  35
     C                     Z-ADD1         J
D7  C           *IN82     IFEQ '0'
     C           ETAT04    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X7  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F7  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     *
D3  C           YFRA      IFNE *BLANKS
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
     C                     MOVE LYP,7     V0411
     C   U1N82   REFGAU    COMP *ZEROS                   82
     C                     MOVE REFGAU    V0413
D4  C           *IN82     IFEQ '0'
     C                     Z-ADD1         J
     C           ETAGAU    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X4  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F4  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F3  C                     END
     *
     *
D3  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
     C   40                Z-ADDFORCPL    YOFOR
     C           YOFOR     CHAINFORDECL1             81
D4  C           *IN81     IFEQ '0'
     C                     Z-ADDPOSFO     V0416
    C*                    MOVE TDECO     YDECO            SD 1315037
F4  C                     END
D4  C           ZB16      IFNE ' '
     C                     MOVE ZB16      V0415
     C                     MOVE '-'       V0414
F4  C                     END
     C                     MOVE LYP,6     V0411
     C                     MOVE YOFOR     V0413
     C   U1N82   YOFOR     COMP *ZEROS                   82
D4  C           *IN82     IFEQ '0'
     C                     Z-ADD1         J
     C           ETAFOR    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X4  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F4  C                     END
     C                     ADD  1         T
D4  C           NATMAI    IFNE ' '
     C                     MOVELV041      V41AFF
F4  C                     END
     C                     MOVELV041      VAR,T
F3  C                     END
     *
X2  C                     ELSE
     *
D3  C           TIMPS     IFNE 0
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
     C                     Z-ADD1         J
     C           TIMPS     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C                     MOVE REFEXS    V0413
     C   U1N82   REFEXS    COMP *BLANKS                  82
     C                     Z-ADD1         J       30
D4  C           *IN82     IFEQ '0'
     C           ETAT01    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X4  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F4  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F3  C                     END
     *
D3  C           TREPS     IFNE 0
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
     C                     Z-ADD1         J
     C           TREPS     LOKUPTYP,J                    55
     C   55                MOVE LYP,J     V0411
     C                     MOVE REFEXS    V0413
     C   U1N82   REFEXS    COMP *BLANKS                  82
     C                     Z-ADD1         J       30
D4  C           *IN82     IFEQ '0'
     C           ETAT01    LOKUPETA,J                    55
     C   55                MOVELLET,J     V0412
X4  C                     ELSE
     C   U1                MOVELLET,6     V0412
     C  NU1                MOVELLET,5     V0412
F4  C                     END
     C                     ADD  1         T
     C                     MOVELV041      VAR,T
F3  C                     END
F2  C                     END
     *
     C                     MOVEAVAR,1     V041
D2  C           WDEPR2    IFNE *BLANKS
D3  C           V0412     IFEQ LET,5
     C                     MOVE *BLANKS   V0412
     C                     MOVE '? ? ? ?' V0412
F3  C                     END
F2  C                     END
     *
     C                     MOVEAVAR,2     V042
D2  C           WDEPR2    IFNE *BLANKS
D3  C           V0422     IFEQ LET,5
     C                     MOVE *BLANKS   V0422
     C                     MOVE '? ? ? ?' V0422
F3  C                     END
F2  C                     END
     *
     C                     MOVEAVAR,3     V043
D2  C           WDEPR2    IFNE *BLANKS
D3  C           V0432     IFEQ LET,5
     C                     MOVE *BLANKS   V0432
     C                     MOVE '? ? ? ?' V0432
F3  C                     END
F2  C                     END
     *
     C                     MOVEAVAR,4     V044
D2  C           WDEPR2    IFNE *BLANKS
D3  C           V0442     IFEQ LET,5
     C                     MOVE *BLANKS   V0442
     C                     MOVE '? ? ? ?' V0442
F3  C                     END
F2  C                     END
     *
D2  C           *IN79     IFEQ '1'
     C                     MOVELV041      V41AFF
     C                     MOVELV41AFF    V044
     C                     MOVE ZB16      V0445
     C                     MOVELV044      V41AFF
     C                     MOVELV41AFF    V044
     C                     MOVE *BLANKS   V041
     C                     MOVE *BLANKS   V0413
     C                     MOVE *ZEROS    V0416
F2  C                     END
     *
     *  ---> N° DEVIS
     *  -------------
     *
     C                     Z-ADD0         V0451   20
     C                     Z-ADD0         V0452   40
     C                     Z-ADD0         V0453   40
D2  C           IMPSTO    IFEQ *BLANKS
     C                     Z-ADDYNDEV     V0451
     C                     Z-ADDYTUDE     V0452
     C                     Z-ADDYEQDE     V0453
F2  C                     END
     *
     *  ---> PRODUIT SOFHUNIC
     *  ---------------------
     *
     C                     MOVE *BLANKS   PROSE
     C                     MOVE *BLANKS   PROSI
     C                     MOVE *BLANKS   PROSF
     *  - PRODUITS SOFHUNIC
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           PROSOE    IFNE *ZEROS
    C           PROSOI    ORNE *ZEROS
    C           PROSOF    ORNE *ZEROS
     C                     ADD  1         I
D4  C           PROSOE    IFNE *ZEROS
     C                     MOVE PROSOE    PROSE
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPROSE     WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     PROSE
F4  C                     END
D4  C           PROSOI    IFNE *ZEROS
     C                     MOVE PROSOI    PROSI
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPROSI     WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     PROSI
F4  C                     END
D4  C           PROSOF    IFNE *ZEROS
     C                     MOVE PROSOF    PROSF
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPROSF     WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     PROSF
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> POIDS A L'UNITE
     *  --------------------
     *
D2  C           YARNT     IFEQ 'PP'
     C                     Z-ADDYDSRE     V047    51
X2  C                     ELSE
     C                     Z-ADDYDUNI     V047
F2  C                     END
     *
     *  ---> DECOUPE
     *  ------------
     *
     C                     Z-ADD0         V0481   40
     C                     MOVE ' '       V0482   1
     C                     Z-ADD0         V0483   40
D2  C           YECL      IFNE *ZEROS
     C                     Z-ADDYECL      V0481
     C                     MOVE 'x'       V0482
     C                     Z-ADDYECH      V0483
F2  C                     END
     *
     *  ---> FEUILLE/POSES
     *  ------------------
     *
     C                     Z-ADD0         V0491   40
     C                     MOVE ' '       V0492   1
     C                     MOVE ' '       V0495   1
     C                     Z-ADD0         V0493   40
     C                     Z-ADD0         V0494   30
D2  C           YNDL      IFNE *ZEROS
     C                     Z-ADDYNDL      V0491
     C                     MOVE 'x'       V0492
     C                     MOVE '/'       V0495
     C                     Z-ADDYNDH      V0493
     C                     Z-ADDYOSF1     V0494
D3  C           YNDUL     IFEQ 0
D4  C           YCOL      IFEQ 4
    C           YCOL      OREQ 7
D5  C           YACON     IFEQ 6
    C           YACON     OREQ 8
     C                     SUB  15        V0491
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> ACOTE
     *  ----------
     *
     C                     Z-ADD0         V0501   40
     C                     MOVE ' '       V0502   1
     C                     Z-ADD0         V0503   40
     C                     Z-ADD0         V0504   20
D2  C           YCOTE     IFNE *ZEROS
     C                     Z-ADDYCOTE     V0501
     C                     MOVE 'x'       V0502
     C                     Z-ADDYNDH      V0503
     C                     Z-ADDYOSF2     V0504
F2  C                     END
     *
     *  ---> DEVELOPPE MINI
     *  -------------------
     *
     C                     Z-ADD*ZEROS    V051    40
     C                     Z-ADD1         J
     C           1         LOKUPTIM,J                    99
     C  N99                Z-ADD1         J
     C  N99      2         LOKUPTIM,J                    99
D2  C           WTE       IFNE 0
    C           *IN99     ANDEQ'1'
D3  C           COP,J     IFEQ 'R'
    C           COP,J     OREQ 'V'
     C                     Z-ADDDEVMIN    V051
F3  C                     END
F2  C                     END
     *
     *  ---> OK BM FAC
     *  --------------
     *
     C                     MOVE *BLANKS   V052    4
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           YACON     IFNE 0
    C           ZBX1      ANDEQ'*'
     C                     MOVE 'OUI '    V052
X3  C                     ELSE
     C                     MOVE 'NON '    V052
F3  C                     END
F2  C                     END
     *
     *  ---> OK BM EXT
     *  --------------
     *
     C                     MOVE *BLANKS   V053    4
D2  C           TIM,2     IFEQ 1
    C           TIM,3     OREQ 1
    C           TIM,2     OREQ 2
    C           TIM,3     OREQ 2
    C           TIM,2     OREQ 4
    C           TIM,3     OREQ 4
D3  C           ZBX2      IFEQ '*'
     C                     MOVE 'OUI '    V053
X3  C                     ELSE
     C                     MOVE 'NON '    V053
F3  C                     END
F2  C                     END
     *
     *  ---> OK BM INT
     *  --------------
     *
     C                     MOVE *BLANKS   V054    4
D2  C           TIM,4     IFEQ 1
    C           TIM,5     OREQ 1
    C           TIM,6     OREQ 1
    C           TIM,4     OREQ 2
    C           TIM,5     OREQ 2
    C           TIM,6     OREQ 2
    C           TIM,4     OREQ 4
    C           TIM,5     OREQ 4
    C           TIM,6     OREQ 4
D3  C           ZBX3      IFEQ '*'
     C                     MOVE 'OUI '    V054
X3  C                     ELSE
     C                     MOVE 'NON '    V054
F3  C                     END
F2  C                     END
     *
     *  ---> SURFACE UNITE
     *  ------------------
     *
     C                     MOVE *BLANKS   V0552
     C                     MOVE *BLANKS   V0553
     C                     Z-ADDSUVENT    V0551   84H
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'UVEN'    PXARGU
     C                     MOVE BVENT     PXVALE
     C           KPARAM    CHAINPARAME               99
D2  C           *IN99     IFEQ '0'
     C                     MOVEL'/'       V0552   1
     C                     MOVELPXLIBE    V0553   6
F2  C                     END
     *
     *
     *  ---> QTE TOTALE
     *  ---------------
     *
     C                     Z-ADDWTOT      V056    90
D2  C           *IN79     IFEQ '1'
     C                     MOVE BTTOT     V056
F2  C                     END
     *
     *  ---> QTE PAR FAB
     *  ----------------
     *
     C                     Z-ADDWTFAB     V057    70
D2  C           *IN79     IFEQ '1'
     C                     MOVE BTFAB     V057
F2  C                     END
     *
     *  ---> QTE PREMIERE
     *  -----------------
     *
     C                     Z-ADDWTPRE     V058    70
D2  C           *IN79     IFEQ '1'
     C                     MOVE BTPRE     V058
F2  C                     END
     *
     *  ---> QTE RENOU
     *  --------------
     *
     C                     Z-ADDWTREN     V059    70
D2  C           *IN79     IFEQ '1'
     C                     MOVE BTREN     V059
F2  C                     END
     *
     *  ---> EXPED
     *  ----------
     *
     C                     Z-ADDWBLIV     V060    20
     *
     *  ---> SEM/STO
     *  ------------
     *
     C                     Z-ADDWRLIV     V061    20
     *
     *  ---> PRIX UNITAIRE
     *  ------------------
     *
     C                     Z-ADDWRIUNS    V062    72
     *
     *  ---> INFORMATIONS SUPPORTS
     *  --------------------------
     *
     C                     MOVE *BLANKS   SUP
     C                     MOVE *BLANKS   QUA
     C                     MOVE *BLANKS   W063
     C                     MOVE *ZEROS    V0741   40
     C                     MOVE *BLANKS   V0742   1
     C                     MOVE *ZEROS    V0743   40
     C                     MOVE *ZEROS    V1401   40
     C                     MOVE *BLANKS   V1402   1
     C                     MOVE *ZEROS    V1403   40
     C                     MOVE *ZEROS    V0633
     C                     MOVE *ZEROS    V0635
     C                     MOVE *ZEROS    V0636
     C                     MOVE *ZEROS    V0638
     C                     MOVE *BLANKS   V063B
     C                     MOVE *ZEROS    V063C
     C                     MOVE *ZEROS    V063D
     C                     MOVE *ZEROS    V063IN
     C                     MOVE *BLANKS   V063CX
     C                     MOVE W063      W064
     C                     MOVE W063      SUP,1
     C                     MOVE W063      SUP,2
     C                     MOVE W063      SUP,3
     C                     MOVE W063      SUP,4
     C                     MOVE W063      SUP,5
     C                     Z-ADD0         I
     *
     C           KQUAL1    CHAINCDEQUAL1             81
D2  C           *IN81     DOWEQ'0'
     C                     MOVE REFOUR    SOF     3
     C                     MOVE ' '       API     1
D3  C           SOF       IFEQ 'CXH'
D4  C           SUPPOR    IFLE 3
     C                     MOVE APIECX    API
X4  C                     ELSE
     C                     MOVE APIICX    API
F4  C                     END
F3  C                     END
     C                     ADD  1         I
     C                     Z-ADD*ZEROS    V063IN
     C                     MOVE W064      W063
     C                     SETOF                     8384
     C                     Z-ADD0         KGBESO
     C                     Z-ADD0         FEBESO
     *
     *
D3  C           YCOL      IFEQ 9
    C           IMPSTO    ANDEQ*BLANKS
    C           YCOL      OREQ 6
    C           IMPSTO    ANDEQ*BLANKS
D4  C           SUPPOR    IFEQ 2
D5  C           RTPOND    IFEQ ' '
     C                     MOVEL'EXT'     V0631
X5  C                     ELSE
     C                     MOVEL'TAB'     V0631
F5  C                     END
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 3
     C                     MOVE CVEI3     CNDD
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE CNDD1     PXVALE
     C           KPARAM    CHAINPARAME               73
D5  C           *IN73     IFEQ '0'
     C                     MOVELPXABRG    V0631
F5  C                     END
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 4
     C                     MOVEL'MED'     V0631
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 5
     C                     MOVE CVEI3     CNDD
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE CNDD2     PXVALE
     C           KPARAM    CHAINPARAME               73
D5  C           *IN73     IFEQ '0'
     C                     MOVELPXABRG    V0631
F5  C                     END
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 6
     C                     MOVEL'INT'     V0631
F4  C                     END
     *
X3  C                     ELSE
     *
D4  C           SUPPOR    IFEQ 3
     C                     MOVEL'EXT'     V0631
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 4
     C                     MOVEL'CAN'     V0631
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 5
     C                     MOVEL'INT'     V0631
F4  C                     END
F3  C                     END
     *
D3  C           API       IFEQ 'N'
     C                     MOVE 'I'       V063CX
F3  C                     END
     *
D3  C           TIMP      IFNE 0
    C           TIMP      ANDNE3
    C           TIMP      ANDNE5
    C           API       ANDNE'O'
D4  C           V0741     IFEQ *ZEROS
D5  C           IMPSTO    IFEQ *BLANKS
     C                     Z-ADDFOL,SUPPORV0741
     C                     Z-ADDFOH,SUPPORV0743
     C                     MOVE 'x'       V0742
X5  C                     ELSE
     C                     Z-ADDFORLS     V0741
     C                     Z-ADDFORHS     V0743
     C                     MOVE 'x'       V0742
F5  C                     END
F4  C                     END
D4  C           SUPPOR    IFLT 4
     C                     MOVE 'E'       SUPOR
     C                     Z-ADDWSEXT     WUS
     C                     MOVE REFEX     V063B
D5  C           REFEX     IFEQ '   508'
    C           REREP     ANDNE'      '
     C                     MOVE REREP     V063B
F5  C                     END
X4  C                     ELSE
     C                     MOVE 'I'       SUPOR
     C                     Z-ADDWSINT     WUS
     C                     MOVE REFIN     V063B
D5  C           REFIN     IFEQ '   508'
    C           RIREP     ANDNE'      '
     C                     MOVE RIREP     V063B
F5  C                     END
F4  C                     END
     C                     MOVE 'I'       PECPAP
D4  C           FOH,SUPPORIFNE *ZEROS
    C           COP,SUPPORANDEQ'B'
    C           FOH,SUPPORORNE *ZEROS
    C           ZB841     ANDNE*ZEROS
     C                     MOVE 'C'       PECPAP
     C                     MOVE ' '       SUPOR
F4  C                     END
     *
D4  C           SOF       IFEQ 'CXH'
     C           KRESC1    CHAINRESCXHL1             83
X4  C                     ELSE
     C           KRESP5    CHAINRESPAPL5             83
D5  C           *IN83     IFEQ '1'
    C           PECPAP    ANDEQ'C'
    C           COP,SUPPORANDEQ'B'
    C           WUS       ANDNE2
     C                     Z-ADD2         WUS
     C           KRESP5    CHAINRESPAPL5             83
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
D4  C           SIPREI    IFEQ *BLANKS
     C                     Z-ADDUSQUA     WUS
     C                     MOVE 'F'       PECPAP
     C                     MOVE ' '       SUPOR
D5  C           WWTFAC    IFNE *ZEROS
     C                     Z-ADDWWQFAB    WEQFAB
F5  C                     END
D5  C           SOF       IFEQ 'CXH'
     C           KRESC1    CHAINRESCXHL1             83
X5  C                     ELSE
     *
D6  C           FOH,SUPPORIFNE *ZEROS
    C           COP,SUPPORANDEQ'B'
    C           FOH,SUPPORORNE *ZEROS
    C           ZB841     ANDNE*ZEROS
     C                     MOVE 'C'       PECPAP
F6  C                     END
     *
     C           KRES25    SETLLRESPAPL5
     C           TAGR1     TAG
     C           KRES15    READERESPAPL5                 83
     C                     Z-ADD1         WEQFAB
D6  C           *IN83     IFEQ '0'
     C           STD,SUPPORCOMP LAIZE                    89
    C           *IN89     CABEQ'0'       TAGR1
F6  C                     END
F5  C                     END
D5  C           SUPPOR    IFEQ 3
    C           V0741     ANDEQ*ZEROS
     C                     Z-ADDFOL,SUPPORV0741
     C                     Z-ADDFOH,SUPPORV0743
     C                     MOVE 'x'       V0742
F5  C                     END
X4  C                     ELSE
D5  C           SUPPOR    IFLT 4
     C                     MOVE NIMPE1    WIMP1
     C                     MOVE NIMPE2    WIMP2
     C           KPREI1    CHAINPREIMPL              83
     C                     MOVE PAPIS     PAPI
     C                     MOVE GRAMS     GRAMM
     C                     MOVE ADPAPS    REFOUR
     C                     MOVE ADGRAS    GRAREL
D6  C           TIMPS     IFEQ 4
D7  C           V0741     IFEQ *ZEROS
     C                     Z-ADDFORLS     V0741
     C                     Z-ADDFORHS     V0743
     C                     MOVE 'x'       V0742
F7  C                     END
     C                     Z-ADDFORLS     HORL
     C                     Z-ADDFORHS     HORH
     C                     MOVE 'F'       HOUB
X6  C                     ELSE
     C                     MOVELLMINIS    LAIZE
     C                     MOVE 'B'       HOUB    1
F6  C                     END
     C           KRESI2    CHAINRESIMPL2             84
X5  C                     ELSE
     C                     MOVE NIMPI1    WIMP1
     C                     MOVE NIMPI2    WIMP2
     C           KPREI1    CHAINPREIMPL              83
     C                     MOVE PAPIS     PAPI
     C                     MOVE GRAMS     GRAMM
     C                     MOVE ADPAPS    REFOUR
     C                     MOVE ADGRAS    GRAREL
D6  C           TIMPS     IFEQ 4
D7  C           V0741     IFEQ *ZEROS
     C                     Z-ADDFORLS     V0741
     C                     Z-ADDFORHS     V0743
     C                     MOVE 'x'       V0742
F7  C                     END
     C                     Z-ADDFORLS     HORL
     C                     Z-ADDFORHS     HORH
     C                     MOVE 'F'       HOUB
X6  C                     ELSE
     C                     MOVELLMINIS    LAIZE
     C                     MOVE 'B'       HOUB    1
F6  C                     END
     C           KRESI2    CHAINRESIMPL2             84
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           *IN83     IFEQ '0'
D4  C           HOUB      IFEQ 'B'
D5  C           TIMP      IFEQ 4
     C                     Z-ADDFORLBM    V0636
     C                     MOVE 'x'       V0637
     C                     Z-ADDFORHBM    V0638
     C                     Z-ADDLAIZE     V0639
     C                     Z-ADD1         V063IN
X5  C                     ELSE
     C                     Z-ADDLAIZE     V0639
     C                     Z-ADD1         V063IN
F5  C                     END
X4  C                     ELSE
     C                     Z-ADDHORL      V0636
     C                     MOVE 'x'       V0637
     C                     Z-ADDHORH      V0638
F4  C                     END
X3  C                     ELSE
D4  C           STD,SUPPORIFNE *ZERO
     C                     Z-ADDSTD,SUPPORV0639
     C                     Z-ADD1         V063IN
X4  C                     ELSE
     C                     Z-ADDFORLBM    V0636
     C                     MOVE 'x'       V0637
     C                     Z-ADDFORHBM    V0638
F4  C                     END
F3  C                     END
D3  C           V0636     IFNE *ZEROS
    C           ZB841     ANDNE*ZEROS
     C                     Z-ADDZB841     V0636
     C                     Z-ADDZB851     V0638
F3  C                     END
     *
     C                     MOVE PAPI      V0632
     C                     MOVE GRAMM     V0633
     C                     MOVELREFOUR    V0634
     C                     MOVE GRAREL    V0635
     C                     MOVE WUS       QU632
     C                     MOVE Q063      QU631
     *
     *  TYPE IMPRESSION
     *  ---------------
     *
D3  C           SIPREI    IFEQ *BLANKS
D4  C           TIMP      IFNE 0
D5  C           TIMP      IFEQ 3
    C           WUS       ANDEQ2
     C                     MOVELLIM,6     V063A
X5  C                     ELSE
     C                     Z-ADD1         J
     C           TIMP      LOKUPTI,J                     50
D6  C           *IN50     IFEQ '1'
     C                     MOVELLIM,J     V063A
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     MOVELLIM,1     V063A
     C                     MOVELWIMP1     V063A
     C                     MOVE WIMP2     V063A
F3  C                     END
     *
     *  NUMERO CLICHE
     *  -------------
     *
D3  C           IMPSTO    IFEQ *BLANKS
D4  C           TIMP      IFNE 3
    C*          TIMP      ANDNE5
D5  C           TIMP      IFEQ 0
D6  C           SIPREI    IFNE *BLANKS
     C                     MOVE REFEXS    V063B
D7  C           REFEXS    IFEQ '   508'
    C           ACLEXS    ANDNE'      '
     C                     MOVE ACLEXS    V063B
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SUPPOR    IFLT 4
     C                     MOVE REFEX     V063B
D7  C           REFEX     IFEQ '   508'
    C           REREP     ANDNE'      '
     C                     MOVE REREP     V063B
F7  C                     END
X6  C                     ELSE
     C                     MOVE REFIN     V063B
D7  C           REFIN     IFEQ '   508'
    C           RIREP     ANDNE'      '
     C                     MOVE RIREP     V063B
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     MOVE REFEXS    V063B
D4  C           REFEXS    IFEQ '   508'
    C           ACLEXS    ANDNE'      '
     C                     MOVE ACLEXS    V063B
F4  C                     END
F3  C                     END
     *
     *  QTE A APPROVISIONNER PAR SUPPORT
     *  --------------------------------
     C                     Z-ADD1         J
     C           QU63      LOKUPQUA,J                    50
     C   50      LF63      COMP LF,J                     50
D3  C           *IN50     IFEQ '0'
    C           *IN83     ANDEQ'0'
     C                     Z-ADDKGBESO    V063C
     C                     Z-ADDFEBESO    V063D
F3  C                     END
     *
D3  C           I         IFEQ 0
     C                     Z-ADD1         I
F3  C                     END
     C                     MOVE W063      SUP,I
D3  C           SIPREI    IFEQ ' '
D4  C           TIMP      IFEQ 0
    C           TIMP      OREQ 3
    C           TIMP      ORNE 0
    C           SOF       ANDEQ'CXH'
     C                     MOVE QU63      QUA,I
D5  C           TIMP      IFEQ 3
     C                     MOVE *BLANKS   V063A
F5  C                     END
     C                     MOVE LF63      LF,I
F4  C                     END
F3  C                     END
     *
     C           KQUAL1    READECDEQUAL1                 81
F2  C  N81                END
     *
     C                     MOVELSUP,1     W063
     C           V063IN    COMP 1                        30
     C                     MOVELSUP,2     W064
     C           V064IN    COMP 1                        31
     C                     MOVELSUP,3     W065
     C           V065IN    COMP 1                        32
     C                     MOVELSUP,4     W066
     C           V066IN    COMP 1                        33
     C                     MOVELSUP,5     W067
     C           V067IN    COMP 1                        34
     *
     *  /////     LIVRAISON     /////
     *  -----------------------------
     *
D2  C           IMPSTO    IFEQ *BLANKS
     *  ---> DEPARTEMENT
     *  ----------------
     C           KLIVL1    CHAINCLILIVL1             82
     *
D3  C           *IN82     IFEQ '0'
     C                     MOVEL*BLANKS   V028
     C                     MOVE VILLIV    V028
     C                     MOVELCODPOS    V028
     C                     MOVEL*BLANKS   V029
     C                     MOVELPAYLIV    V029
F3  C                     END
     *
     C                     MOVE *BLANKS   V068    5
D3  C           *IN79     IFEQ '0'
D4  C           LIMULS    IFNE *BLANKS
     C                     MOVE 'MULTI'   V068
X4  C                     ELSE
D5  C           DEPLIV    IFNE *ZEROS
     C                     MOVELDEPLIV    V068
F5  C                     END
F4  C                     END
F3  C                     END
     *
     *  ---> PORT
     *  ---------
     *
     C                     MOVE *BLANKS   V069   10
D3  C           *IN79     IFEQ '0'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TPOR'    PXARGU
     C                     MOVE TYPOR     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V069
F4  C                     END
F3  C                     END
     *
     *  ---> TYPE DE VEHICULE
     *  ---------------------
     *
     C                     MOVELTYVEHI    V070    4
     *
     *
     *  ---> QTE
     *  --------
     *
     C                     Z-ADDWAGON     V071    70
     *
     *  ---> GABARIT
     *  ------------
     *
     C                     Z-ADDLGVEHI    V0721
     C                     Z-ADDLAVEHI    V0723
     C                     Z-ADDHAVEHI    V0725
     C                     MOVE ' '       V0722
     C                     MOVE ' '       V0724
D3  C           LGVEHI    IFNE *ZEROS
     C                     MOVE 'X'       V0722
     C                     MOVE 'X'       V0724
F3  C                     END
     *
X2  C                     ELSE
     C                     MOVE *BLANKS   V068
     C                     MOVE *BLANKS   V069
     C                     MOVE *BLANKS   V070
     C                     MOVE *ZEROS    V071
     C                     MOVE *BLANKS   V072
     C                     Z-ADD0         V0721
     C                     Z-ADD0         V0723
     C                     Z-ADD0         V0725
     C                     Z-ADD0         V071
F2  C                     END
     *
     *
     *  ---> LAIZE MINI PRODUIT / STOCKE
     *  --------------------------------
     *
     C                     MOVE *ZEROS    V0731   41
     C                     MOVE *ZEROS    V0732   41
D2  C           IMPSTO    IFEQ *BLANKS
     C                     MOVE YMINI     V0731
D3  C           NIMPE1    IFNE *BLANKS
    C           NIMPI1    ORNE *BLANKS
     C                     MOVE LMINIS    V0732
F3  C                     END
X2  C                     ELSE
     C                     MOVE LMINIS    V0731
F2  C                     END
     *
     *  ---> FORMAT MINI
     *  ----------------
     *
D2  C           V0741     IFEQ *ZEROS
     C                     MOVE *BLANKS   V0742
F2  C                     END
     *          VOIR  SUPPORTS
     *
     *  ---> FORMAT STD
     *  ---------------
     *
D2  C           FORLST    IFNE *ZEROS
     C                     Z-ADDFORLST    V1401
     C                     Z-ADDFORHST    V1403
     C                     MOVE 'x'       V1402
X2  C                     ELSE
     C                     MOVE *BLANKS   V1402
F2  C                     END
     *
     *  ---> FORMAT MINI
     *  ----------------
     *
     C                     MOVE *BLANKS   V137   25
     C                     SETOF                     97
D2  C           WSINE     IFNE 3
D3  C           PASFST    IFEQ '*'
     C                     MOVELCON,14    V137
F3  C                     END
X2  C                     ELSE
D3  C           WTE       IFNE 0
     C                     SETON                     97
     C                     MOVELCON,26    V137
F3  C                     END
F2  C                     END
     *
     *  ---> RELIQUAT P.F
     *  -----------------
     *
     C                     Z-ADD*ZEROS    V075    70
     C                     MOVE *BLANKS   W075
     C                     MOVE *BLANKS   W076
     C                     MOVE *BLANKS   W077
     C                     Z-ADD0         STOCK   90
     C                     Z-ADD0         STOCTL
D2  C           IMPSTO    IFEQ *BLANKS
     C           KLIE03    CHAINLIEUST03             99
D3  C           *IN99     DOWEQ'0'
     C                     SETON                     92
D4  C           LILIEU    IFEQ 6
    C           CODEXT    ANDNE'  '
     C                     Z-ADD1         C       30
     C           CODEXT    LOKUPCXT,C                    92
F4  C                     END
D4  C           LILIEU    IFNE 8
    C           LILIEU    ANDNE1
    C           *IN92     ANDEQ'1'
     C                     ADD  STOLIE    STOCK                           PROD17
F4  C                     END
D4  C           LILIEU    IFEQ 1
     C                     ADD  STOLIE    STOCTL  80                      PROD17
F4  C                     END
     C           KLIE03    READELIEUST03                 99              *PROD17
F3  C        N99          END                                           *PROD17
     C           KPRO10    CHAINDJAFACL2             99
D3  C           *IN99     DOWEQ'0'
     C                     SUB  QTSTOC    STOCK
     C           KPRO10    READEDJAFACL2                 99
F3  C                     END
D3  C           STOCK     IFLT 0
     C                     Z-ADD0         STOCK
F3  C                     END
F2  C                     END
     C                     SETOF                     50
     *
     *  ---> RELIQUAT IMPRESSION EXTERIEUR
     *  ---> RELIQUAT IMPRESSION INTERIEUR
     *  ----------------------------------
     *
     C                     Z-ADD0         V0761   60
     C                     Z-ADD0         V0771   60
     C                     MOVE *BLANKS   V0762   2
     C                     MOVE *BLANKS   V0772   2
     C                     SETOF                     49
     *
     C           KMVTLF    CHAINMVTIMPLF             82
D2  C           *IN82     DOWEQ'0'
D3  C           IMPSTO    IFNE *BLANKS
D4  C           SUIMP     IFLT 4
D5  C           TIMP      IFEQ 4
     C                     ADD  NBFE      V0761
     C                     MOVE 'FE'      V0762
X5  C                     ELSE
     C                     ADD  MLBON     V0761
     C                     MOVE 'ML'      V0762
F5  C                     END
X4  C                     ELSE
D5  C           TIMP      IFEQ 4
     C                     ADD  NBFE      V0771
     C                     MOVE 'FE'      V0772
X5  C                     ELSE
     C                     ADD  MLBON     V0771
     C                     MOVE 'ML'      V0772
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           SUIMP     IFLT 4
     C                     ADD  PROFIN    V0761
X4  C                     ELSE
     C                     ADD  PROFIN    V0771
F4  C                     END
F3  C                     END
     C           KMVTLF    READEMVTIMPLF                 82
F2  C  N82                END
     *
     C           KSTAL1    SETLLCARCDEZ8
     C           KPRO10    READECARCDEZ8                 81
D2  C           *IN81     DOWEQ'0'
D3  C           NCONF     IFNE WCONF
    C           WWEPRE    ANDEQ*BLANKS
     C                     SETON                     8150
F3  C                     END
     C  N81      KPRO10    READECARCDEZ8                 81
F2  C  N81                END
     *
D2  C           *IN50     IFEQ '0'
     C                     Z-ADDSTOCK     V075
X2  C                     ELSE
D3  C           USFAC     IFEQ 4
D4  C           STOCTL    IFNE *ZEROS
     C                     MOVE 'STO CTL' W075    7
F4  C                     END
F3  C                     END
D3  C           USFAC     IFNE 3
D4  C           STOCK     IFNE *ZEROS
     C                     MOVE '???????' W075    7
F4  C                     END
D4  C           V0761     IFNE *ZEROS
     C                     MOVE '???????' W076    7
     C                     Z-ADD0         V0761
F4  C                     END
D4  C           V0771     IFNE *ZEROS
     C                     MOVE '???????' W077    7
     C                     Z-ADD0         V0771
F4  C                     END
X3  C                     ELSE
     C                     MOVE '???????' W075    7
F3  C                     END
     C                     SETON                     49
     C                     MOVE *BLANKS   V0762
     C                     MOVE *BLANKS   V0772
F2  C                     END
     *
     *
     * MATIERES ANNEXES
     * ----------------
     C                     Z-ADD0         SURFF
     C                     MOVE *BLANKS   MAA
     C                     MOVE *ZEROS    MAQ
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     Z-ADD0         N       10
     C                     SETOF                     55
     *
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           COSESA    IFNE *BLANKS
    C           COTAPE    ORNE *BLANKS
     C                     MOVE *BLANKS   W112   40
     C                     Z-ADD0         W1131   20
     C                     Z-ADD0         W1132   70
     *
D4  C           YNDUL     IFEQ 0
    C           CCOL      ANDEQ0
    C           NBTAPE    ANDNE0
    C           WTIMP     ANDNE0
     C                     SETON                     55
F4  C                     END
     *
D4  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           WTOT      MULT 0,01      SURFF     H
F4  C                     END
     *
D4  C           BVENT     IFEQ 1
     C           WTOT      MULT 0,001     SURFF     H
F4  C                     END
     *
D4  C           BVENT     IFEQ 5
     C                     Z-ADDWTOT      SURFF     H
F4  C                     END
     *
     C           SURFF     MULT SUVENT    SURFF
     *
D4  C           SURFF     IFEQ 0
     C                     Z-ADD1         SURFF
F4  C                     END
     *
D4  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C   55      WTIMP     MULT 0,01      W4     103
     C  N55      WTFAC     MULT 0,01      W4     103
F4  C                     END
     *
D4  C           BVENT     IFEQ 1
     C   55      WTIMP     MULT 0,001     W4
     C  N55      WTFAC     MULT 0,001     W4
F4  C                     END
     *
D4  C           BVENT     IFEQ 5
     C   55                Z-ADDWTIMP     W4
     C  N55                Z-ADDWTFAC     W4
F4  C                     END
     *
     C           W4        MULT SUVENT    SUFNET 100H
     *
     C                     Z-ADD0         ROUDEC
     C                     Z-ADD0         WUREG
     C                     Z-ADD0         SUFTH
     C           KCDES1    CHAINPLANIFL3             82
D4  C           *IN82     IFEQ '0'
     *
     C           SUFNET    MULT ROUDEC    SUROUL 100H
     *
     C                     Z-ADDSUROUL    SUFTH  100
     C                     ADD  WUREG     SUFTH
     *
D5  C           SBFE      IFEQ *ZEROS
     C                     Z-ADD1         SF
X5  C                     ELSE
     C                     Z-ADDSBFE      SF
F5  C                     END
F4  C                     END
     *
     *
     *
     C                     Z-ADD*ZERO     MIN
     C                     Z-ADD*ZERO     MAX
D4  C           SUFTH     IFNE *ZEROS
     C                     Z-ADDSUFTH     SURF
     C                     Z-ADDWCONF     WCONF1
     C                     Z-ADDWOCLI     WOCLI1
     C                     Z-ADDWOPRO     WOPRO1
     C                     CALL 'CDEC92£'
     C                     PARM           DSPARA
F4  C                     END
     *
     C                     MOVE BMINI     BMINM2  43
D4  C           BMINM2    IFEQ *ZEROS
D5  C           FOL,3     IFEQ 0
D6  C           YNDL      IFEQ 0
     C                     MOVE YECL      BMINM2
X6  C                     ELSE
     C                     MOVE YNDL      BMINM2
F6  C                     END
X5  C                     ELSE
     C                     MOVE FOL,3     BMINM2
F5  C                     END
F4  C                     END
     C           MAX       DIV  BMINM2    W1132     H
     *
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
D4  C           COSESA    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'SESA'    PXARGU
     C                     MOVE COSESA    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
D6  C           CLSESA    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CLSE'    PXARGU
     C                     MOVE CLSESA    PXVALE
     C           KPARAM    CHAINPARAME               90
D7  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
F7  C                     END
F6  C                     END
     C                     MOVEACAR,1     W112
F5  C                     END
     *
D5  C           NBSESA    IFNE *ZEROS
     C                     Z-ADDNBSESA    W1131
F5  C                     END
F4  C                     END
     *
D4  C           COTAPE    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TAPE'    PXARGU
     C                     MOVE COTAPE    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
D6  C           CLTAPE    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CLTA'    PXARGU
     C                     MOVE CLTAPE    PXVALE
     C           KPARAM    CHAINPARAME               90
D7  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
F7  C                     END
F6  C                     END
     C                     MOVEACAR,1     W112
F5  C                     END
D5  C           NBTAPE    IFNE *ZEROS
     C                     Z-ADDNBTAPE    W1131
F5  C                     END
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WC1
     C                     MOVELW1131     WC1
     C                     MOVE *BLANKS   WAR
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  2         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVELW1132     WC4     7
     C                     MOVE *BLANKS   WAR
     C                     MOVEAWC4       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,J     CAR,I
     *
     C                     ADD  1         N
     C                     MOVEACAR,1     WAR
     C                     MOVEA'ML'      WAR,39
     C                     MOVEAWAR,1     MAA,N
     C           W1131     MULT W1132     MAQ,N
     *
F3  C                     END
     *
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     *  ---> TYPE FENETRE
     *  -----------------
D3  C           COFEN     IFEQ 21
    C           COFEN     OREQ 22
    C           COFEN     OREQ 20
     C                     ADD  1         N
     C                     Z-ADD0         TRADUC  50
     C                     MOVE *BLANKS   PXVALE
D4  C           COFEN     IFEQ 21
     C                     MOVEL'RHOD'    PXARGU
D5  C           RHODO     IFEQ -1
     C                     MOVE 'A'       PXVALE    P
X5  C                     ELSE
D6  C           RHODO     IFEQ -2
     C                     MOVE 'B'       PXVALE
X6  C                     ELSE
D7  C           RHODO     IFEQ -3
     C                     MOVE 'C'       PXVALE
X7  C                     ELSE
D8  C           RHODO     IFEQ -4
     C                     MOVE 'D'       PXVALE
X8  C                     ELSE
D9  C           RHODO     IFEQ -5
     C                     MOVE 'E'       PXVALE
X9  C                     ELSE
     C                     MOVE RHODO     PXVALE
F9  C                     END
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
D4  C           COFEN     IFEQ 22
     C                     MOVEL' BIB'    PXARGU
     C                     MOVE RHODO     PXVALE
F4  C                     END
D4  C           COFEN     IFEQ 20
     C                     MOVEL'LANG'    PXARGU
     C                     MOVE RHODO     PXVALE
F4  C                     END
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     Z-ADDPXMONT    TRADUC
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     *
     *  ---> LAIZE BOBINEAU
     C                     MOVELYAIZB     WC1
     C                     MOVE *BLANKS   WAR
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     *
     *  ---> NOMBRE DE FENETRES
D4  C           NBRFE     IFNE 0
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVEL*BLANKS   WC1
     C                     MOVELNBRFE     WC1
     C                     MOVE *BLANKS   WAR
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
D4  C           COFEN     IFNE 20
     C                     MOVEA'KG'      CAR,39
X4  C                     ELSE
     C                     MOVEA'LG'      CAR,39
F4  C                     END
     C                     MOVEACAR,1     WAR
     C                     MOVEAWAR,1     MAA,N
     *
     C                     MOVE '8'       FECT
     C                     MOVE '1'       FSECT
     *
     C           KPLAL2    CHAINPLANIFL1             82
D4  C           *IN82     IFEQ '0'
     C           WTFAC     MULT ROUDEC    Q      155
     C           WTFAC     MULT MOYDEC    Y      155
     C           Y         MULT 0,01      Y
D5  C           SBZ       IFNE *ZEROS
     C           WUREG     DIV  SBZ       X      155
F5  C                     END
     C           Q         ADD  Y         W1     155
     C                     ADD  X         W1
     C                     ADD  REDEC     W1
D5  C           COFEN     IFNE 20
     C           YAIZB     MULT YCOUP     Q
     C           Q         MULT 0,000001  Q
     C           W1        MULT Q         W1
     C           W1        MULT TRADUC    W1
     C           W1        MULT 0,0011    MAQ,N     H
D6  C           NBRFE     IFNE 0
     C           MAQ,N     MULT NBRFE     MAQ,N
F6  C                     END
X5  C                     ELSE
     C                     Z-ADDW1        MAQ,N
F5  C                     END
F4  C                     END
F3  C                     END
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     *  ---> ETIQUETTES
     *  -----------------
D3  C           ETIQ1     IFNE *BLANKS
    C           ETIQ2     ORNE *BLANKS
     C                     ADD  1         N
     *
     C                     MOVEL'ETIQUE'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D4  C           *IN81     IFEQ '0'
     C                     MOVELOBSLIB    MAA,N
F4  C                     END
     *
     C                     MOVE '8'       FECT
     C                     MOVE '2'       FSECT
     *
     C           KPLAL2    CHAINPLANIFL1             82
D4  C           *IN82     IFEQ '0'
     C           WTFAC     MULT ROUDEC    Q
     C           WTFAC     MULT MOYDEC    Y
     C                     MULT 0,01      Y
D5  C           SBZ       IFNE *ZEROS
     C           WUREG     DIV  SBZ       X
F5  C                     END
     C           Q         ADD  Y         W1
     C                     ADD  X         W1
     C           W1        ADD  REDEC     MAQ,N
F4  C                     END
     *
     C           KPLAL2    READEPLANIFL1                 82
D4  C           *IN82     IFEQ '0'
     C                     ADD  1         N
     C                     MOVELOBSLIB    MAA,N
     C           WTFAC     MULT ROUDEC    Q
     C           WTFAC     MULT MOYDEC    Y
     C                     MULT 0,01      Y
D5  C           SBZ       IFNE *ZEROS
     C           WUREG     DIV  SBZ       X
F5  C                     END
     C           Q         ADD  Y         W1
     C                     ADD  X         W1
     C           W1        ADD  REDEC     MAQ,N
F4  C                     END
F3  C                     END
     *
     *
     *  ---> POIGNEES RINALDO
     *  ---------------------
D3  C           RINAL     IFNE *BLANKS
     C                     ADD  1         N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'RINA'    PXARGU
     C                     MOVE RINAL     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
D5  C           CLRINA    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CLRI'    PXARGU
     C                     MOVE CLRINA    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
F6  C                     END
F5  C                     END
     C                     MOVEACAR,1     MAA,N
F4  C                     END
     *
     *
     C                     MOVEL'ETIQUE'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D4  C           *IN81     IFEQ '0'
     C                     ADD  1         N
     C                     MOVELOBSLIB    MAA,N
F4  C                     END
     *
D4  C           ETIQ1     IFEQ *BLANKS
    C           ETIQ2     OREQ *BLANKS
     C                     MOVE '8'       FECT
     C                     MOVE '2'       FSECT
     *
     C           KPLAL2    CHAINPLANIFL1             82
D5  C           *IN82     IFEQ '0'
     C           WTFAC     MULT ROUDEC    Q
     C           WTFAC     MULT MOYDEC    Y
     C                     MULT 0,01      Y
D6  C           SBZ       IFNE *ZEROS
     C           WUREG     DIV  SBZ       X
F6  C                     END
     C           Q         ADD  Y         W1
     C                     ADD  X         W1
     C           W1        ADD  REDEC     MAQ,N
F5  C                     END
X4  C                     ELSE
     C           N         SUB  1         I
     C                     MOVE MAQ,I     MAQ,N
F4  C                     END
F3  C                     END
     *
     *  ---> POIGNEES PLASTIQUES
     *  ------------------------
D3  C           COLA2     IFNE *BLANKS
    C           COAS2     ANDEQ31
    C           COLA2     ORNE *BLANKS
    C           COAS2     ANDEQ33
     C                     Z-ADD0         WMAQ    60
     C                     ADD  1         N
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   CAR
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'PLAS'    PXARGU
     C                     MOVE COLA2     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
D5  C           CLPOIG    IFNE *BLANKS
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CLPO'    PXARGU
     C                     MOVE CLPOIG    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVEAPXLIBE    CAR,I
F6  C                     END
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     C                     MOVEA'L:'      CAR,I
     C                     ADD  2         I
     C                     MOVEL*BLANKS   WC5     4
     C                     MOVELLPAT2     WC5
     C                     MOVE *BLANKS   WAR
     C                     MOVEAWC5       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     MOVEA'ML'      CAR,39
F4  C                     END
     C                     MOVEACAR,1     MAA,N
     *
     C                     MOVE '8'       FECT
     C                     MOVE '3'       FSECT
     C           KPLAL2    CHAINPLANIFL1             82
D4  C           *IN82     IFEQ '0'
     C           WTFAC     MULT ROUDEC    Q
     C           WTFAC     MULT MOYDEC    Y
     C                     MULT 0,01      Y
D5  C           SBZ       IFNE *ZEROS
     C           WUREG     DIV  SBZ       X
F5  C                     END
     C           Q         ADD  Y         W1
     C                     ADD  X         W1
     C           W1        ADD  REDEC     W1
     C                     Z-ADDW1        WMAQ    60
     C           LPAT2     MULT W1        W1
     C           W1        MULT 0,001     MAQ,N
F4  C                     END
     C                     ADD  1         N
     C                     MOVELCON,17    MAA,N
     C           WMAQ      MULT 2         MAQ,N
F3  C                     END
F2  C                     END
     *
     C                     MOVE MAA,1     V078   40
     C                     MOVE MAA,2     V079   40
     C                     MOVE MAA,3     V080   40
     C                     MOVE MAA,4     V081   40
     C                     MOVE MAA,5     V082   40
     C                     MOVE MAA,6     V083   40
     C                     MOVE MAQ,1     V089    60
     C                     MOVE MAQ,2     V090    60
     C                     MOVE MAQ,3     V091    60
     C                     MOVE MAQ,4     V092    60
     C                     MOVE MAQ,5     V093    60
     C                     MOVE MAQ,6     V094    60
     *
     *
     *  ---> CONDITIONNEMENT
     *  --------------------
     *
     C                     MOVE *BLANKS   V100
     C                     MOVE *ZEROS    V1002
     C                     MOVE V100      V101
     C                     MOVE V100      V102
     C                     MOVE V100      V103
     C                     MOVE V100      V104
     C                     MOVE V100      V105
     C                     MOVE V100      V106
     C                     MOVE V100      V107
     C                     MOVE V100      V108
     C                     MOVE V100      V109
     C                     MOVE V100      V110
     C                     MOVE *BLANKS   CAR
     C                     MOVE V100      DIT
     C                     Z-ADD0         P       30
     C                     Z-ADD0         CPT     10
     C                     Z-ADD0         WQTE
     *
     * Ce traitement ne concerne que les cas de Bobinettes de TOURY:
     * ces dernières sont fabriquées en Kg, Ml, M2, et il faut traduir
     * cette quantité en nombre d'unité car le conditionnement est
     * ainsi renseigné. (Nbre de bobinettes /caisse ou palette).
     *
D2  C           YACON     IFEQ 1
    C           YACON     OREQ 2
     *
     *
     * Expression aux Milles, on conserva la quantité :
D3  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C                     Z-ADDWTFAC     WQTE
F3  C                     END
     *
     * Expression en M2
     * WQTE = WTFAC/(DECL/1000)/DECH (arrondi + 1)
D3  C           UVENT     IFEQ 2
D4  C           YECH      IFNE 0
     C           WTFAC     DIV  YECL      WRESUL 168
     C           WRESUL    MULT 1000      WRESUL
     C           WRESUL    DIV  YECH      WRESUL
     C                     Z-ADDWRESUL    WQTE    70
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     * Expression en Ml
     * WQTE = WTFAC/DECH (arrondi + 1)
D3  C           UVENT     IFEQ 3
D4  C           YECH      IFNE 0
     C           WTFAC     DIV  YECH      WRESUL
     C                     Z-ADDWRESUL    WQTE
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     * Expression en Kg
     * Recherche du poids du papier et calcul.
D3  C           UVENT     IFEQ 4
D4  C           YECH      IFNE *ZEROS
D5  C           NIMPE1    IFNE *BLANKS
     C                     MOVE NIMPE1    WIMP1
     C                     MOVE NIMPE2    WIMP2
     C           KPREI1    CHAINPREIMPL              83
     C  N83                Z-ADDGRAMS     GRAM3
F5  C                     END
     C                     MOVELYECL      DECLM   43
     C           DECLM     MULT YECH      SURBOB  73
     C           SURBOB    MULT GRAM3     PDG3    50
     C           SURBOB    MULT GRAM4     PDG4    50
     * Application des Coef d'allongement suite ondulation
    C*          YNDUL     IFEQ 1
    C*          PDG4      MULT 1,32      PDG4      H
    C*                    END
    C*          YNDUL     IFEQ 2
    C*          PDG4      MULT 1,45      PDG4      H
    C*                    END
    C*          YNDUL     IFEQ 3
    C*          PDG4      MULT 1,50      PDG4      H
    C*                    END
D5  C           YCOL      IFNE 8
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE YNDUL     PXVALE
     C           KPARAM    CHAINPARAME               73
     C  N73      PDG4      MULT PXMONT    PDG4      H
F5  C                     ENDIF
     C           PDG4      ADD  PDG3      PDTOT   50
     C           PDTOT     DIV  1000      BOBPDS  31H
X4  C                     ELSE
     C                     Z-ADD*ZEROS    BOBPDS
F4  C                     END
     * Calcul du nombre de bobines :
D4  C           BOBPDS    IFNE 0
     C           WTFAC     DIV  BOBPDS    WRESUL
     C                     Z-ADDWRESUL    WQTE
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     *
F2  C                     END
     *
     *
     C                     Z-ADD0         POSES
     C                     Z-ADD0         QTC
     C                     Z-ADD0         NBP
     C                     Z-ADD0         C
     C           KMVTLF    CHAINCODBARL2             81
D2  C           *IN81     IFEQ '0'
    C           WTFAC     ANDNE0
    C           PDBAR     ANDEQ'00000'
D3  C           *IN81     DOWEQ'0'
     C                     Z-ADDPOSCO     NBP,NO
     C           KMVTLF    READECODBARL2                 81
F3  C  N81                END
     C                     XFOOTNBP       POSES   20
D3  C           POSES     IFGT 1
     C           WTFAC     DIV  POSES     WT      70
D4  C           1         DO   NO        C
     C           WT        MULT NBP,C     QTC,C
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *
     C           KCAIL1    CHAINCAIPALL1             81
     *
D2  C           *IN81     IFEQ '1'
    C           EMBNAT    OREQ 'S'
     C                     MOVELCON,15    V1001
     C                     MOVEAV100      DIT,1
     C                     SETON                     81
F2  C                     END
     *
D2  C           *IN81     DOWEQ'0'
     C                     ADD  1         CPT
     C           CPT       COMP 1                        51
     C           CPT       COMP 2                        52
     C           CPT       COMP 3                        53
     *
     * //////////////  PAQUET
D3  C           EMBNAT    IFEQ 'Q'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVELEMBNAT    DSNAT
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           EMBLA     IFNE *ZEROS
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  6         I
F4  C                     END
     C                     MOVEA'NBR = '  CAR,64
     *
     C                     Z-ADD70        I
     C                     MOVE *BLANKS   WAR
     C                     MOVELNBRUNI    WBRUNI  5
     C                     MOVEAWBRUNI    WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         P
D4  C           NBRUNI    IFNE *ZEROS
D5  C           POSES     IFEQ 0
     C           WTFAC     DIV  NBRUNI    V1002     H
X5  C                     ELSE
     C           QTC,EMBNO DIV  NBRUNI    V1002     H
F5  C                     END
F4  C                     END
     C                     MOVEACAR       V1001
     C                     MOVEAV100      DIT,P
     *
     C                     ADD  1         P
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     MOVEAOBSLIB    DIT,P
F4  C                     END
F3  C                     END
     *
     * //////////   CAISSE
D3  C           EMBNAT    IFEQ 'C'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVELEMBNAT    DSNAT
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           EMBCON    IFEQ 'H'
     C                     MOVEA'N°'      CAR,I
     C                     ADD  2         I
     C                     MOVEAEMBQUA    CAR,I
     C                     ADD  4         I
     *
X4  C                     ELSE
     C                     MOVELEMBNAT    DSCON
     C                     MOVE EMBCON    DSCON
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMCE'    PXARGU
     C                     MOVE DSCON     PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
F4  C                     END
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMQU'    PXARGU
     C                     MOVE EMBQUA    PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  4         I
     *
     C                     MOVEAPILCA1    CAR,I
     C                     ADD  7         I
     *
     C                     MOVEAPILCA2    CAR,I
     C                     ADD  10        I
     C                     MOVEA'NBR = '  CAR,64
     *
     C                     Z-ADD70        I
     C                     MOVE *BLANKS   WAR
     C                     MOVELNBRUNI    WBRUNI  5
     C                     MOVEAWBRUNI    WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         P
D4  C           NBRUNI    IFNE *ZEROS
     *  WQTE EST LE CALCUL PRECEDENT DU NOMBRE DE BOBINES
D5  C           WQTE      IFNE *ZEROS
     C           WQTE      DIV  NBRUNI    W1
X5  C                     ELSE
D6  C           POSES     IFEQ 0
     C           WTFAC     DIV  NBRUNI    W1        H
X6  C                     ELSE
     C           QTC,EMBNO DIV  NBRUNI    W1        H
F6  C                     END
F5  C                     END
F4  C                     END
     C                     MOVE W1        REST    55
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        V1002
     C                     MOVEACAR       V1001
     C                     MOVEAV100      DIT,P
     *
     C                     ADD  1         P
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     MOVEAOBSLIB    DIT,P
F4  C                     END
F3  C                     END
     *
     * //////////////  PALETTE
D3  C           EMBNAT    IFEQ 'P'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     * CONSTITUTION DE LA PREMIERE LIGNE
     *
     C                     MOVELEMBNAT    DSNAT   2
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVELEMBNAT    DSCON   2
     C                     MOVE EMBCON    DSCON
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMCE'    PXARGU
     C                     MOVE DSCON     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           PALTRA    IFEQ '*'
     C                     MOVEA'Traitées'CAR,I
     C                     ADD  9         I
F4  C                     END
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  8         I
     *
     C                     MOVEA'DEC= '   CAR,50
     C                     Z-ADD56        I
     C                     MOVE *BLANKS   WAR
D4  C           NBDECP    IFNE *ZEROS
     C                     MOVE NBDECP    WBDECP  5
     C                     MOVEAWBDECP    WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     MOVEA'NBR= '   CAR,65
     C                     Z-ADD70        I
     C                     MOVE *BLANKS   WAR
D4  C           NBCAIP    IFNE *ZEROS
     C                     MOVE NBCAIP    WBCAIP  3
     C                     MOVEAWBCAIP    WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     ADD  1         P
     C                     MOVEACAR       V1001
D4  C           NBDECP    IFNE *ZEROS
D5  C           YACON     IFEQ 1
    C           YACON     OREQ 2
D6  C           WQTE      IFNE 0
     C           WQTE      DIV  NBDECP    W1        H
X6  C                     ELSE
     C                     Z-ADD0         W1        H
F6  C                     END
X5  C                     ELSE
D6  C           POSES     IFEQ 0
     C           WTFAC     DIV  NBDECP    W1        H
X6  C                     ELSE
     C           QTC,EMBNO DIV  NBDECP    W1        H
F6  C                     END
F5  C                     END
F4  C                     END
     C                     MOVE W1        REST
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        V1002
     C                     MOVEAV100      DIT,P
     *
     *
     * CONSTITUTION DE LA DEUXIEME LIGNE
     *
D4  C           PLANBR    IFNE *ZEROS
    C           DZPNBR    ORNE '0'
     C                     MOVELDZPNBR    WC3N    20
     C                     MOVE PLANBR    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELWC3N      WC3     2
     C                     MOVEAWC3       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPL'    PXARGU
     C                     MOVE PLATYP    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALON    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALAR    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C           V1002     MULT WC3N      V1002
     *
     C                     ADD  1         P
     C                     MOVEACAR       V1001
     C                     MOVEAV100      DIT,P
F4  C                     END
     *
     *
D4  C           PLANB2    IFNE *ZEROS
    C           DZPNB2    ORNE *ZEROS
     C                     MOVELDZPNB2    WC3N
     C                     MOVE PLANB2    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELWC3N      WC3     2
     C                     MOVEAWC3       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPL'    PXARGU
     C                     MOVE PLATY2    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALO2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALA2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C           W1        MULT WC3N      V1002
     *
     C                     ADD  1         P
     C                     MOVEACAR       V1001
     C                     MOVEAV100      DIT,P
F4  C                     END
     *
     * CONSTITUTION DE LA TROISIEME LIGNE
     *
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
    C*                    MOVEA'FINITION'CAR,I
    C*                    ADD  9         I
     *
D4  C           HABIL1    IFNE *BLANKS
D5  C           HABI11    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL1    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI11    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVE HABI12    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL2    IFNE *BLANKS
D5  C           HABI21    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL2    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI21    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI22    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL3    IFNE *BLANKS
D5  C           HABI31    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL3    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI31    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI32    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           PROTEC    IFNE *BLANKS
    C           I         ANDLT64
     C                     MOVEA'PROTECTI'CAR,I
     C                     ADD  8         I
     C                     MOVEA'ON'      CAR,I
     C                     ADD  3         I
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPR'    PXARGU
     C                     MOVE PROTEC    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
F4  C                     END
     *
     C                     ADD  1         P
     C                     MOVEACAR,1     DIT,P
     *
     * CONSTITUTION DE LA QUATRIEME LIGNE BIS
D4  C           PLALIB    IFNE *BLANKS
     C                     ADD  1         P
     C                     MOVEAPLALIB    DIT,P
F4  C                     END
     *
     * CONSTITUTION DE LA QUATRIEME LIGNE
     *
     C                     ADD  1         P
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     MOVEAOBSLIB    DIT,P
F4  C                     END
F3  C                     END
     C           KCAIL1    READECAIPALL1                 81
     C  N81      EMBNO     COMP 9                        81
F2  C  N81                END
     *
D2  C           CPT       IFEQ 1
    C           P         ANDLE11
     C                     MOVEL'EMBAL2'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         P
     C                     MOVEAOBSLIB    DIT,P
F3  C                     END
F2  C                     END
     *
D2  C           CPT       IFLT 3
    C           P         ANDLE11
     C                     MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         P
     C                     MOVEAOBSLIB    DIT,P
F3  C                     END
F2  C                     END
     *
D2  C           P         IFLT 11
     C                     ADD  1         P
     C                     MOVE *BLANKS   IMPERA
D3  C           RGRA1     IFEQ 'O'
     C                     MOVELCON,24    IMPER1
D4  C           RUV1      IFEQ 'O'
     C                     MOVE '|'       IMPER2
     C                     MOVELCON,25    IMPER3
F4  C                     END
X3  C                     ELSE
D4  C           RUV1      IFEQ 'O'
     C                     MOVELCON,25    IMPER1
F4  C                     END
F3  C                     END
     C                     MOVEAIMPERA    DIT,P
F2  C                     END
     *
D2  C           P         IFLT 11
     C                     MOVEL'EMBETI'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         P
     C                     MOVEAOBSLIB    DIT,P
F3  C                     END
F2  C                     END
D2  C           P         IFLT 11
    C           USFAB     ANDEQ3
     C                     MOVEL'EMBSEC'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         P
     C                     MOVEAOBSLIB    DIT,P
F3  C                     END
F2  C                     END
     *
     C                     MOVE DIT,1     V100
     C                     MOVE DIT,2     V101
     C                     MOVE DIT,3     V102
     C                     MOVE DIT,4     V103
     C                     MOVE DIT,5     V104
     C                     MOVE DIT,6     V105
     C                     MOVE DIT,7     V106
     C                     MOVE DIT,8     V107
     C                     MOVE DIT,9     V108
     C                     MOVE DIT,10    V109
     *
D2  C           USFAB     IFEQ 3
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'EXPED '  DEST
     C           KOBSP2    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     MOVELOBSLIB    V110
F3  C                     END
X2  C                     ELSE
     C                     MOVE DIT,11    V110
F2  C                     END
     *
     *     /////     CADENCEMENT     /////
     *-----------------------------------------
     *
     C                     MOVE *ZEROS    V132
     C                     MOVE *BLANKS   V1327
     C                     MOVE V132      V133
     C                     MOVE V132      DEL
     C                     Z-ADD0         I
D2  C           WWTFAC    IFNE *ZEROS
     C                     Z-ADD0         WTFAC
F2  C                     END
     *
     C                     MOVE WOPRO     WWPRO   40
D2  C           WOPRO     IFGT 8000
    C           *IN79     ANDEQ'1'
     C           KCDES2    CHAINCARCDEL1             82
X2  C                     ELSE
     C           KCDES1    CHAINCARCDEL1             82
F2  C                     END
D2  C           *IN82     DOWEQ'0'
     C                     ADD  1         I
     C                     Z-ADDWEQFAB    V1321
     C                     Z-ADDWTIMP     V1322
     C                     Z-ADDWTFAC     V1323
     C                     Z-ADDQTDEXP    V1324
     C                     Z-ADDDDEDEL    V1325
D3  C           WW4       IFEQ 'P'
    C           CODEL     OREQ 'PR'
     C                     Z-ADDDTDEL     V1325
F3  C                     END
     C                     Z-ADD0         V1326
     C                     MOVE CODEL     V1327
     C                     Z-ADDWGLIV     V1328
     C                     MOVE V132      DEL,I
D3  C           WOPRO     IFGT 8000
    C           *IN79     ANDEQ'1'
     C           KCDES2    READECARCDEL1                 82
X3  C                     ELSE
     C           KCDES1    READECARCDEL1                 82
F3  C                     END
     C  N82      I         COMP 5                        82
F2  C  N82                END
     C                     MOVE WWPRO     WOPRO
     C                     MOVE DEL,1     V132
     C                     MOVE DEL,2     V133
     C                     MOVE DEL,3     V134
     C                     MOVE DEL,4     V135
     C                     MOVE DEL,5     V136
     *
     *     /////     GAMME OPERATOIRE     /////
     *----------------------------------------------
     *
     C                     MOVE *BLANKS   V122
     C                     MOVE *BLANKS   V095    7
     C                     MOVE *ZEROS    V1224
     C                     MOVE *BLANKS   V1225
     C                     MOVE *ZEROS    V1226
     C                     MOVE *ZEROS    V1227
     C                     MOVE *ZEROS    V1228
     C                     MOVE *ZEROS    V1229
     C                     MOVE V122      V123
     C                     MOVE V122      GAM
     C                     Z-ADD0         I
     C                     Z-ADD0         US1     10
     C                     Z-ADD0         US2     10
     C                     Z-ADD0         US3     10
     C                     Z-ADD0         US4     10
     C                     Z-ADD0         US5     10
     *
     *     /////     IMPRESSION     /////
     *     ------------------------------
     C           KCDES1    CHAINPLAIMP7              82
     C  N82                MOVE PR        WPR     1
D2  C           *IN82     DOWEQ'0'
     C                     MOVE V123      V122
    C           PR        CABNEWPR       SUITEI
     C                     ADD  1         I
     *
     * USINE
     * -----
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USIN'    PXARGU
     C                     MOVE USFAB     PXVALE
     C           KPARAM    CHAINPARAME               90
D3  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V1221
F3  C                     END
D3  C           US1       IFEQ 0
     C                     MOVE USFAB     US1
F3  C                     END
D3  C           USFAB     IFNE US1
    C           US2       ANDEQ0
     C                     MOVE USFAB     US2
F3  C                     END
D3  C           USFAB     IFNE US1
    C           USFAB     ANDNEUS2
    C           US3       ANDEQ0
     C                     MOVE USFAB     US3
F3  C                     END
     *
     * SECTION
     * -------
     C                     MOVELSECT      V1222
     C                     MOVE SSECT     V1222
     C                     MOVE SSECT     SS      10
     *
     * TYPE
     * ----
D3  C           SSECT     IFNE '3'
    C           SSECT     ANDNE'5'
    C           SSECT     ANDNE'6'
    C           SECT      ANDNE'2'
    C           SECT      ANDNE'6'
D4  C           COULX     IFEQ 0
     C                     MOVEL'VERNIS  'V1223
     C                     MOVE VERNIS    V1223
X4  C                     ELSE
     C                     MOVEL'  COUL  'V1223
     C                     MOVELCOULX     V1223
D5  C           VERNIS    IFNE *BLANKS
     C                     MOVE '+ '      V1223
     C                     MOVE VERNIS    V1223
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
     *
D4  C           SSECT     IFEQ '3'
     C                     MOVE 'PASABAN' V1223
F4  C                     END
D4  C           SSECT     IFEQ '5'
     C                     MOVE 'MASSICOT'V1223
F4  C                     END
D4  C           SSECT     IFEQ '6'
     C                     MOVE 'DORURE  'V1223
F4  C                     END
D4  C           SECT      IFEQ '2'
D5  C           NOMAC     IFEQ '06'
     C                     MOVE 'COMPLEXE'V1223
F5  C                     END
D5  C           NOMAC     IFEQ '07'
     C                     MOVE 'CPLX-COU'V1223
F5  C                     END
D5  C           NOMAC     IFEQ '08'
     C                     MOVE 'CPLX-PEL'V1223
F5  C                     END
D5  C           NOMAC     IFEQ '09'
     C                     MOVE 'BOB-REF 'V1223
F5  C                     END
F4  C                     END
D4  C           SECT      IFEQ '6'
    C           SSECT     ANDEQ'7'
D5  C           VERNIS    IFEQ 'O'
     C                     MOVE 'S/T DOR.'V1223
F5  C                     END
D5  C           VERNIS    IFEQ 'P'
     C                     MOVE 'S/T PEL.'V1223
F5  C                     END
F4  C                     END
F3  C                     END
     *
     * MACHINES
     * --------
     C                     MOVE NOMAC     V1224
     *    +  MACHINE DE REMPLACEMENT    V1225
     *
D3  C           SSECT     IFNE '3'
    C           SSECT     ANDNE'5'
    C           SSECT     ANDNE'6'
     *
D4  C           PAS       IFEQ 1
D5  C           SUIMP     IFLE 3
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIME1    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRE1    V1225
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIMI1    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRI1    V1225
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           PAS       IFEQ 2
D5  C           SUIMP     IFLE 3
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIME2    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRE2    V1225
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIMI2    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRI2    V1225
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           PAS       IFEQ 3
D5  C           SUIMP     IFLE 3
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIME3    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRE3    V1225
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIMI3    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRI3    V1225
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           PAS       IFEQ 4
D5  C           SUIMP     IFLE 3
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIME4    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRE4    V1225
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIMI4    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRI4    V1225
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           PAS       IFEQ 5
D5  C           SUIMP     IFLE 3
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIME5    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRE5    V1225
F7  C                     END
F6  C                     END
X5  C                     ELSE
D6  C           SS        IFEQ TIM,SUIMP
     C                     MOVE RMIMI5    V1225
X6  C                     ELSE
D7  C           SS        IFEQ TRE,SUIMP
     C                     MOVE RMIRI5    V1225
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
     *  SOUS-TRAITABLE SAUF SUR PASABAN
D3  C           SSECT     IFNE '3'
D4  C           ZB831     IFEQ 'O'
    C           SUIMP     ANDLE3
     C                     MOVE 'ST'      V1225
F4  C                     END
     *
D4  C           ZB832     IFEQ 'O'
    C           SUIMP     ANDGT3
     C                     MOVE 'ST'      V1225
F4  C                     END
F3  C                     END
     *
     * REGLAGE
     * -------
     C                     Z-ADDRETPS     V1227
     C                     ADD  NETPS     V1227
     *
     * ROULAGE
     * -------
    C*          QTPREV    IFNE V058
    C*          V058      ANDNE0
    C*          V058      DIV  QTPREV    W5      85
    C*          TPSTOT    MULT W5        V1228
    C*                    ELSE
    C*          QTPREV    IFNE V059
    C*          V058      ANDEQ0
    C*          V059      ANDNE0
    C*          V059      DIV  QTPREV    W5
    C*          TPSTOT    MULT W5        V1228
    C*                    ELSE
    C*                    Z-ADDTPSTOT    V1228
    C*                    END
    C*                    END
D3  C           QTPREV    IFNE V1322
    C           V1322     ANDNE0
    C           SECT      ANDNE'6'
     C           V1322     DIV  QTPREV    W5      85
     C           TPSTOT    MULT W5        V1228
X3  C                     ELSE
     C                     Z-ADDTPSTOT    V1228
F3  C                     END
     *
     * TOTAL  MODIFIE EN CADENCE LE 30/09/96
     * -----
D3  C           USFAB     IFEQ 3
    C           SECT      ANDEQ'1'
    C           SSECT     ANDEQ'2'
     C                     Z-ADDQTENET    V1229
     C                     MOVE 'ml'      V122M
X3  C                     ELSE
D4  C           USFAB     IFNE 3
     C                     Z-ADDMOYCAD    V1229
F4  C                     END
F3  C                     END
     *
D3  C           V1225     IFEQ '00'
     C                     MOVE '  '      V1225
F3  C                     END
     C                     MOVEAV122      GAM,I
     *
     C           SUITEI    TAG
     C  N82      KCDES1    READEPLAIMP7                  82
F2  C  N82                END
     *
     *
     *     /////     FACONNAGE     /////
     *     -----------------------------
     C                     SETOF                     28
     C                     Z-ADD0         CPDDHN  10
D2  C           IMPSTO    IFEQ *BLANKS
D3  C           PP        IFEQ 'PP'
     C           KCARCU    CHAINGAMMREL1             82
X3  C                     ELSE
     C           KCDES1    CHAINPLANIFL3             82
F3  C                     END
D3  C           *IN82     DOWEQ'0'
     C                     MOVE V123      V122
D4  C           SECT      IFEQ '2'
    C           SSECT     ANDEQ'1'
    C           YCOL      ANDEQ9
D5  C           CPDDHN    IFEQ 0
     C                     Z-ADD1         CPDDHN
X5  C                     ELSE
    C                     GOTO SUIGAM
F5  C                     END
F4  C                     END
     C                     ADD  1         I
     *
     * USINE
     * -----
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USIN'    PXARGU
     C                     MOVE USFAB     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V1221
F4  C                     END
D4  C           US1       IFEQ 0
     C                     MOVE USFAB     US1
F4  C                     END
D4  C           USFAB     IFNE US1
    C           US2       ANDEQ0
     C                     MOVE USFAB     US2
F4  C                     END
D4  C           USFAB     IFNE US1
    C           USFAB     ANDNEUS2
    C           US3       ANDEQ0
     C                     MOVE USFAB     US3
F4  C                     END
D4  C           USFAB     IFNE US1
    C           USFAB     ANDNEUS2
    C           USFAB     ANDNEUS3
    C           US4       ANDEQ0
     C                     MOVE USFAB     US4
F4  C                     END
D4  C           USFAB     IFNE US1
    C           USFAB     ANDNEUS2
    C           USFAB     ANDNEUS3
    C           USFAB     ANDNEUS4
    C           US5       ANDEQ0
     C                     MOVE USFAB     US5
F4  C                     END
     *
     * SECTION
     * -------
     C                     MOVELSECT      V1222
     C                     MOVE SSECT     V1222
     *
     * TYPE
     * ----
     C                     SETOF                     36    Oeillet
D4  C           SECT      IFEQ '2'
    C           SSECT     ANDNE'2'
    C           SECT      OREQ '3'
D5  C           CVEI3     IFNE *ZEROS
     C                     MOVE CVEI3     CNDD
X5  C                     ELSE
     C                     MOVE *BLANKS   CNDD
F5  C                     END
     C                     MOVE *BLANKS   V1223
     C                     MOVE 'TOND'    PXARGU
     C                     MOVELSIDD      PXVALE    P
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVELPXABRG    V1223
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '1'
D5  C           SSECT     IFEQ '3'
     C                     MOVEL'COUPEUSE'V1223
F5  C                     END
D5  C           SSECT     IFEQ '5'
     C                     MOVE 'MASSICOT'V1223
F5  C                     END
D5  C           SSECT     IFEQ '6'
     C                     MOVE 'DORORE  'V1223
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '2'
    C           SSECT     ANDEQ'2'
D5  C           NOMAC     IFEQ '06'
     C                     MOVEL'COMPLEXE'V1223
F5  C                     END
D5  C           NOMAC     IFEQ '07'
     C                     MOVEL'CPLX-COU'V1223
F5  C                     END
D5  C           NOMAC     IFEQ '09'
     C                     MOVEL'BOB-REF 'V1223
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '4'
D5  C           USFAB     IFEQ 2
    C           SSECT     ANDEQ'1'
    C           USFAB     OREQ 3
    C           SSECT     ANDEQ'1'
     C                     MOVEL'?????   'V1223
D6  C           NOMAC     IFEQ '01'
     C                     MOVEL'GENCO   'V1223
F6  C                     END
D6  C           NOMAC     IFEQ '02'
     C                     MOVEL'AFFICHEU'V1223
F6  C                     END
D6  C           NOMAC     IFEQ '03'
     C                     MOVELUSFAB     V095
     C                     MOVEL'P-PRINT 'V1223
F6  C                     END
D6  C           NOMAC     IFEQ '99'
     C                     MOVEL'RET.PILE'V1223
F6  C                     END
F5  C                     END
D5  C           USFAB     IFEQ 2
    C           SSECT     ANDEQ'4'
     C                     MOVEL'OFF. FAÇ'V1223
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '5'
D5  C           USFAB     IFEQ 2
    C           GAUF      ANDNE'  '
     C                     MOVEL'GAUFRA  'V1223
X5  C                     ELSE
D6  C           NOMAC     IFEQ '99'
    C           NOMAC     OREQ '98'
     C                     MOVEL*BLANKS   V1223
     C                     MOVEL'EASY PRE'V1223
X6  C                     ELSE
     C                     MOVEL*BLANKS   V1223
     C                     MOVELYDECO     V1223
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '7'
     C                     MOVEL'DECORTIC'V1223
F4  C                     END
     *
D4  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'0'
     C                     MOVEL*BLANKS   V1223
     C                     MOVEL'PEINTURE'V1223
F4  C                     END
     *
D4  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'1'
     C                     MOVEL*BLANKS   V1223
     C                     MOVELCOFEN     V1223
F4  C                     END
     *
D4  C           PP        IFEQ 'PP'
     C                     MOVEL'?????   'V1223
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
     C                     MOVEL*BLANKS   V1223
     C                     MOVELRGGARE    V1223
     C                     MOVE RGG       V1223
F5  C                     END
X4  C                     ELSE
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
    C           *IN28     ANDEQ'1'
     C                     MOVEL*BLANKS   V1223
     C                     MOVELCOAS2     V1223
F5  C                     END
     *
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
    C           *IN28     ANDEQ'0'
     C                     MOVEL*BLANKS   V1223
     C                     MOVELCOAS1     V1223
F5  C                     END
     *
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'3'
     C                     MOVEL*BLANKS   V1223
     C                     MOVELCOAS2     V1223
D6  C           USFAB     IFEQ 2
    C           NOMAC     ANDEQ'01'
    C           USFAB     OREQ 2
    C           NOMAC     ANDEQ'02'
     * Recherche machine Oeillet et Pression
     C           KPRST2    SETLLPRODST6                  99
D7  C           *IN99     IFEQ '1'
D8  C           NOMAC     IFEQ '01'
     C                     SETON                     36    Oeillet
     C                     MOVEL*BLANKS   V1223
     C                     MOVEL'OEILLETS'V1223
F8  C                     END
D8  C           NOMAC     IFEQ '02'
     C                     SETON                     36    Pression
     C                     MOVEL*BLANKS   V1223
     C                     MOVEL'PRESSION'V1223
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
     *
     * MACHINES
     * --------
     C                     SETOF                     59
     C                     MOVE NOMAC     V1224
     C                     MOVE '  '      V1225
     C                     MOVE '  '      V1226
     *
D4  C           SECT      IFEQ '2'
    C           SSECT     ANDNE'2'
     C                     MOVE MAOND2    V1225
     C                     MOVE MAOND3    V1226
F4  C                     END
     *
D4  C           SECT      IFEQ '3'
     C                     MOVE MACOL2    V1225
     C                     MOVE MACOL3    V1226
F4  C                     END
     *
D4  C           SECT      IFEQ '5'
    C           GAUF      ANDNE'  '
    C           USFAB     ANDEQ2
     C                     MOVE MRGAU2    V1225
F4  C                     END
     *
D4  C           SECT      IFEQ '5'
    C           GAUF      ANDEQ'  '
    C           NOMAC     ANDNE'99'
    C           NOMAC     ANDNE'98'
     C           YOFOR     CHAINFORDECL1             81
D5  C           *IN81     IFEQ '0'
D6  C           USFAB     IFEQ 2
     C                     MOVE PRES2R    V1225
     C                     MOVE PRES3R    V1226
F6  C                     END
D6  C           USFAB     IFEQ 3
     C                     MOVE PRES2T    V1225
     C                     MOVE PRES3T    V1226
F6  C                     END
D6  C           USFAB     IFEQ 4
     C                     MOVE PRES2N    V1225
     C                     MOVE PRES3N    V1226
F6  C                     END
D6  C           USFAB     IFEQ 5
     C                     MOVE PRES2C    V1225
     C                     MOVE PRES3C    V1226
F6  C                     END
D6  C           USFAB     IFEQ 7
     C                     MOVE PRES2F    V1225
     C                     MOVE PRES3F    V1226
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '6'
     C                     MOVE MAAUT2    V1225
     C                     MOVE MAAUT3    V1226
F4  C                     END
     *
D4  C           PP        IFNE 'PP'
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
    C           *IN28     ANDEQ'1'
     C                     MOVE MAAS22    V1225
     C                     MOVE MAAS23    V1226
F5  C                     END
     *
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
    C           *IN28     ANDEQ'0'
    C           NOMAC     ANDNE'48'
     C                     MOVE MAAS12    V1225
     C                     MOVE MAAS13    V1226
     C                     SETON                     28
F5  C                     END
     *
D5  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'3'
     * Ce n'est pas la machine Oeillet ou pression
D6  C           *IN36     IFEQ '0'
     C                     MOVE MAAS22    V1225
     C                     MOVE MAAS23    V1226
F6  C                     END
F5  C                     END
F4  C                     END
     *
     * REGLAGE
     * -------
     C                     Z-ADDRETPS     V1227
D4  C           PP        IFNE 'PP'
     C                     ADD  NETPS     V1227
F4  C                     END
     *
     * ROULAGE
     * -------
     C                     MOVE 'EQUI'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVELUSFAB     ZZ3     3
     C                     MOVE WSECT     ZZ3
     C                     MOVE ZZ3       PXVALE
     C           KPARAM    CHAINPARAME               99
D4  C           *IN99     IFEQ '0'
     C           TPSTOT    DIV  PXMONT    TPSTOT
F4  C                     END
     *
D4  C           PP        IFNE 'PP'
     C           TPSTOT    MULT V1323     W1
D5  C           QTFAB     IFNE *ZEROS
     C           W1        DIV  QTFAB     V1228     H
F5  C                     END
X4  C                     ELSE
     * DIVISION PAR ZÉRO
D5  C           MOYCAD    IFEQ 0
     C                     Z-ADD1         MOYCAD
F5  C                     END
     *
     C           QTFAC     DIV  MOYCAD    V1228     H
F4  C                     END
     *
     * TOTAL REMPLACE PAR CADENCE
     * -----
     *
     * POUR TOURY ONDULATION=ML
     * -----
D4  C           USFAB     IFEQ 3
    C           SECT      ANDEQ'2'
    C           USFAB     OREQ 3
    C           SECT      ANDEQ'1'
    C           SSECT     ANDEQ'2'
     C                     Z-ADDQTENET    V1229
     C                     MOVE 'ml'      V122M
X4  C                     ELSE
D5  C           USFAB     IFNE 3
     C                     Z-ADDMOYCAD    V1229
F5  C                     END
F4  C                     END
     *
D4  C           V1225     IFEQ '00'
     C                     MOVE '  '      V1225
F4  C                     END
     C                     MOVEAV122      GAM,I
     *
     C           SUIGAM    TAG
     *
D4  C           PP        IFEQ 'PP'
D5  C           RGGARE    IFNE 'X'
     C           KCARCU    READEGAMMREL1                 82
X5  C                     ELSE
     C                     SETON                     82
F5  C                     END
X4  C                     ELSE
     C           KCDES1    READEPLANIFL3                 82
F4  C                     END
F3  C  N82                END
F2  C                     END
     *
     C                     MOVE GAM,1     V122
     C                     MOVE GAM,2     V123
     C                     MOVE GAM,3     V124
     C                     MOVE GAM,4     V125
     C                     MOVE GAM,5     V126
     C                     MOVE GAM,6     V127
     C                     MOVE GAM,7     V128
     C                     MOVE GAM,8     V129
     C                     MOVE GAM,9     V130
     C                     MOVE GAM,10    V131
     *
     * TOLERANCE SUR QUANTITES
     *------------------------
     *
     C                     Z-ADD0         W2     100
     C                     MOVE *BLANKS   V1411
     C                     Z-ADD0         V1412
     C                     Z-ADD0         V1413
     C                     MOVE ' '       MOINS   1
     C                     MOVE ' '       PLUS    1
     C                     MOVELWPROTO    WROTO   1
D2  C           WACLI     IFEQ 0
    C           WICLI     ANDEQ0
    C           WROTO     ANDNE'T'
D3  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           WTOT      MULT 0,01      SURFF     H
F3  C                     END
     *
D3  C           BVENT     IFEQ 1
     C           WTOT      MULT 0,001     SURFF     H
F3  C                     END
     *
D3  C           BVENT     IFEQ 5
     C                     Z-ADDWTOT      SURFF     H
F3  C                     END
     *
     C           SURFF     MULT SUVENT    SURFF
     *
     C                     Z-ADD1         I
     C           SURFF     LOKUPTSX,I                10
     C                     Z-ADDTB,I      V1412   31H
     C                     Z-ADDTB,I      V1413   31H
D3  C           WROTO     IFEQ 'P'
     C                     MOVEL'PROMO  :'V1411
     C                     Z-ADD0         V1412
     C                     MOVE '+'       PLUS
X3  C                     ELSE
     C                     MOVEL'USFO   :'V1411   8
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
F3  C                     END
     *
X2  C                     ELSE
D3  C           WROTO     IFEQ 'T'
     C                     MOVEL'ZERO.'   V1411
F3  C                     END
D3  C           WROTO     IFEQ 'P'
     C                     MOVEL'PROMO  :'V1411
     C                     Z-ADDWICLI     V1412
     C                     Z-ADDWACLI     V1413
     C                     MOVE '+'       PLUS
F3  C                     END
D3  C           WROTO     IFEQ ' '
     C                     MOVE 'CLIENT :'V1411
     C                     Z-ADDWICLI     V1412
     C                     Z-ADDWACLI     V1413
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
F3  C                     END
F2  C                     END
     *
D2  C           V0181     IFNE *BLANKS
     C                     MOVE V0181     V040             ALERTE
F2  C                     END
     *
D2  C           US1       IFEQ 0
     C                     MOVE WSINE     US1
F2  C                     END
     *
     * TMAGPI SD1469717
     *                    CAS USINE = 3 ET PRODUIT < 8000, ALERTE V040
D2  C           WW402     IFNE *BLANK
     C                     MOVEL*BLANK    V040
     C                     MOVELWW401     V040
F2  C                     END
     *
D2  C           US1       IFNE 0
     C                     MOVE US1       USFAC
     C                     EXCPTFICCD
F2  C                     END
D2  C           US2       IFNE 0
     C                     MOVE US2       USFAC
     C                     EXCPTFICCD
F2  C                     END
D2  C           US3       IFNE 0
     C                     MOVE US3       USFAC
     C                     EXCPTFICCD
F2  C                     END
D2  C           US4       IFNE 0
     C                     MOVE US4       USFAC
     C                     EXCPTFICCD
F2  C                     END
D2  C           US5       IFNE 0
     C                     MOVE US5       USFAC
     C                     EXCPTFICCD
F2  C                     END
     *
     C           SUITE     TAG
     *
     C                     MOVE ' '       NATMAI
D2  C           AFFIC1    IFNE 0
     C                     MOVE AFFIC1    WOPRO
     C                     Z-ADD0         AFFIC1
     C                     SETON                     79
     C                     Z-ADD1         WEQFAB
    C                     GOTO AFFDEB
F2  C                     END
     *
D2  C           AFFIC2    IFNE 0
     C                     MOVE AFFIC2    WOPRO
     C                     Z-ADD0         AFFIC2
     C                     SETON                     79
    C                     GOTO AFFDEB
F2  C                     END
     *
     C                     READ CDESL1                   80
     C                     Z-ADDWSINE     PUS
F1  C  N80                END
     C           FIN       TAG
     C                     SETON                     LR
     C           KHIVAL    DELETPRODUIF1             81
     *
     ***************************************************************
    C           SPCAR     BEGSR
     C                     Z-ADD75        I
D1  C           CAR,I     DOWEQ' '
     C                     SUB  1         I
     C           I         COMP 1                        82
F1  C  N82                END
    C                     ENDSR
     *
     ***************************************************************
    C           SBLOC4    BEGSR
     C                     Z-ADD0         I
     C                     MOVE *BLANK    BLOC4
     *
D1  C                     DO   7         I
D2  C           TIM,I     IFNE 0
     C                     MOVE *BLANK    BL0
     C                     MOVE *BLANK    BLQ
     *
     * CONSTITUTION D'UN BLOC4
     *            TYPE D'IMPRESSION
     *
     C                     Z-ADD1         J
     C           TIM,I     LOKUPWI,J                     99
D3  C           *IN99     IFEQ '1'
     C                     MOVEAWIM,J     BLIM    6                      *LAN020
     C                     MOVEABLIM      BL0,1                          *LAN020
F3  C                     END
D3  C           CO,I      IFGT 0                                        *LAN020
D4  C           TIM,I     IFNE 0
     C                     MOVE CO,I      BL0,8                          *LAN020
     C                     MOVE TS,I      BL0,14                         *LAN020
     C                     MOVEA'COUL.'   BL0,9                          *LAN020
D5  C           DCO,I     IFGE 1
     C                     MOVE DCO,I     BL0,7
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           TS,I      IFEQ 'V'                                      *LAN020
     C                     MOVE 'U'       BL0,14                         *LAN020
     C                     MOVE TS,I      BL0,15                         *LAN020
F3  C                     END
     *            TYPE DE VERNIS                                        *LAN020
D3  C           TV,I      IFNE ' '
     C                     MOVEA'+V.'     BL0,16                         *LAN020
     C                     MOVE TV,I      BL0,19                         *LAN020
     C                     MOVEA'.'       BL0,20
D4  C           TV,I      IFEQ 'D'
     C                     MOVEA'FU'      BL0,19
F4  C                     END
D4  C           TV,I      IFNE 'T'
    C           TV,I      ANDNE'R'
D5  C           CV,I      IFGE 1
     C                     MOVEA'T'       BL0,21
X5  C                     ELSE
     C                     MOVEA'R'       BL0,21
F5  C                     END
F4  C                     END
F3  C                     END
     *                                                                  *LAN020
     *            OR,ALU,CUIVRE                                         *LAN020
     *                                                                  *LAN020
D3  C           OR,I      IFEQ 'O'                                      *LAN020
     C                     MOVE '+'       BL0,22                         *LAN020
     C                     MOVEA'OR'      BL0,23                         *LAN020
X3  C                     ELSE
D4  C           OR,I      IFEQ 'A'                                      *LAN020
     C                     MOVE '+'       BL0,22                         *LAN020
     C                     MOVEA'AL'      BL0,23                         *LAN020
X4  C                     ELSE
D5  C           OR,I      IFEQ 'C'
     C                     MOVE '+'       BL0,22
     C                     MOVEA'CU'      BL0,23
F5  C                     END
F4  C                     END
F3  C                     END
     *            TYPO
     *
     C                     Z-ADD1         J
D3  C           RC,I      IFNE 0
     C           TRE,I     LOKUPWI,J                     99
D4  C           *IN99     IFEQ '1'
     C                     MOVEAWIM,J     BLIM
     C                     MOVEABLIM      BL0,26
F4  C                     END
     C                     MOVE RC,I      BL0,31
     C                     MOVEA'COUL.'   BL0,32
F3  C                     END
     *
D3  C           RV,I      IFNE ' '
D4  C           RV,I      IFNE '0'
     *            VERNIS REPRISE
     C                     MOVEA'+V.'     BL0,37
     C                     MOVE RV,I      BL0,40
F4  C                     END
F3  C                     END
    C                     GOTO SUIBL4
F2  C                     END
F1  C                     END
     *
     C           SUIBL4    TAG
     C                     MOVEABL0       BLOC4
     C                     MOVE *BLANK    BL0
    C                     ENDSR
     *
     ***************************************************************
     *
     OFICCDE  E                FICCD                                      PROD02
     O                         V001      17                               PROD02
     O                         V002      25 '  /  / 0'                    PROD02
     O                         V003      41                               PROD02
     O                         V004      81                               PROD02
     O                         V005  4   85                               PROD02
     O                         V006  4   89                               PROD02
     O                         YARN      92                               PROD02
     O                         V0071 4   99                               PROD02
     O                         V0072 4  102                               PROD02
     O                         V008     110 '  /  / 0'                    PROD02
     O                         V009  4  114                               PROD02
     O                         V010     154                               PROD02
     O                         V011     174                               PROD02
     O                         V012     214                               PROD02
     O                         V013     254                               PROD02
     O                         V014     294                               PROD02
     O                         V015     334                               PROD02
     O                         V016     374                               PROD02
     O                         V017     414                               PROD02
     O                         V018     454                               PROD02
     O                         V019     458                               PROD02
     O                         V020     498                               PROD02
     O                         V021     538                               PROD02
     O                         V022     578                               PROD02
     O                         V023     618                               PROD02
     O                         V024     658                               PROD02
     O                         V025     698                               PROD02
     O                         V026     738                               PROD02
     O                         V027     778                               PROD02
     O                         V028     818                               PROD02
     O                         V029     858                               PROD02
     O                         V030     865                               PROD02
     O                         V031     872                               PROD02
     O                         V032     879                               PROD02
     O                         V033     886                               PROD02
     O                         V034     893                               PROD02
     O                         V035     900                               PROD02
     O                         V036     907                               PROD02
     O                         V037     947                               PROD02
     O                         V038     987                               PROD02
     O                         V039    1027                               PROD02
     O                         V040   B1067                               PROD02
     O                         V0411   1077                               PROD02
     O                         V0416 4 1080                               PROD02
     O                         V0412   1094                               PROD02
     O                         V0413   1106                               PROD02
     O                         V0414   1107                               PROD02
     O                         V0415   1108                               PROD02
     O                         V0421   1118                               PROD02
     O                         V0426 4 1121                               PROD02
     O                         V0422   1135                               PROD02
     O                         V0423   1147                               PROD02
     O                         V0424   1148                               PROD02
     O                         V0425   1149                               PROD02
     O                         V0431   1159                               PROD02
     O                         V0436 4 1162                               PROD02
     O                         V0432   1176                               PROD02
     O                         V0433   1188                               PROD02
     O                         V0434   1189                               PROD02
     O                         V0435   1190                               PROD02
     O                         V0441   1200                               PROD02
     O                         V0446 4 1203                               PROD02
     O                         V0442   1217                               PROD02
     O                         V0443   1229                               PROD02
     O                         V0444   1230                               PROD02
     O                         V0445   1231                               PROD02
     O                         V0451 4 1233                               PROD02
     O                         V0452 4 1238                               PROD02
     O                         V0453 4 1243                               PROD02
     O                         V046   B1247                               PROD02
     O                         V047  2 1255                               PROD02
     O                         V0481 4 1259                               PROD02
     O                         V0482   1260                               PROD02
     O                         V0483 4 1264                               PROD02
     O                         V0491 4 1268                               PROD02
     O                         V0492   1269                               PROD02
     O                         V0493 4 1273                               PROD02
     O                         V0495   1275                               PROD02
     O                         V0494 4 1278                               PROD02
     O                         V0501 4 1283                               PROD02
     O                         V0502   1284                               PROD02
     O                         V0503 4 1288                               PROD02
     O                         V0504 4 1292                               PROD02
     O                         V051  4 1298                               PROD02
     O                         V052    1302                               PROD02
     O                         V053    1306                               PROD02
     O                         V054    1310                               PROD02
     O                         V0551 2 1320                               PROD02
     O                         V0552   1321                               PROD02
     O                         V0553   1328                               PROD02
     O                         V056  4 1337                               PROD02
     O                         V057  2 1346                               PROD02
     O                         V058  2 1355                               PROD02
     O                         V059  2 1364                               PROD02
     O                         V060  4 1366                               PROD02
     O                         V061  4 1370                               PROD02
     O                         V062  2 1381                               PROD02
     O                         V0631   1384                               PROD02
     O                         V0632   1390                               PROD02
     O                         V0633 4 1394                               PROD02
     O                         V0634   1401                               PROD02
     O                         V0635 4 1405                               PROD02
     O                         V063CX  1407                               PROD02
     O                N30      V0636 4 1412                               PROD02
     O                N30      V0637   1414                               PROD02
     O                N30      V0638 4 1419                               PROD02
     O                 30      V0639 4 1417                               PROD02
     O                         V063A   1430                               PROD02
     O                         V063B   1437                               PROD02
     O                         V063C 2 1449                               PROD02
     O                N30      V063D 2 1461                               PROD02
     O                 30      V0636 4 1456                               PROD02
     O                 30      V0637   1457                               PROD02
     O                 30      V0638 4 1461                               PROD02
     O                         V0641   1464                               PROD02
     O                         V0642   1470                               PROD02
     O                         V0643 4 1474                               PROD02
     O                         V0644   1481                               PROD02
     O                         V0645 4 1485                               PROD02
     O                         V064CX  1487                               PROD02
     O                N31      V0646 4 1492                               PROD02
     O                N31      V0647   1494                               PROD02
     O                N31      V0648 4 1499                               PROD02
     O                 31      V0649 4 1497                               PROD02
     O                         V064A   1510                               PROD02
     O                         V064B   1517                               PROD02
     O                         V064C 2 1529                               PROD02
     O                N31      V064D 2 1541                               PROD02
     O                 31      V0646 4 1536                               PROD02
     O                 31      V0647   1537                               PROD02
     O                 31      V0648 4 1541                               PROD02
     O                         V0651   1544                               PROD02
     O                         V0652   1550                               PROD02
     O                         V0653 4 1554                               PROD02
     O                         V0654   1561                               PROD02
     O                         V0655 4 1565                               PROD02
     O                         V065CX  1567                               PROD02
     O                N32      V0656 4 1572                               PROD02
     O                N32      V0657   1574                               PROD02
     O                N32      V0658 4 1579                               PROD02
     O                 32      V0659 4 1577                               PROD02
     O                         V065A   1590                               PROD02
     O                         V065B   1597                               PROD02
     O                         V065C 2 1609                               PROD02
     O                N32      V065D 2 1621                               PROD02
     O                 32      V0656 4 1616                               PROD02
     O                 32      V0657   1617                               PROD02
     O                 32      V0658 4 1621                               PROD02
     O                         V0661   1624                               PROD02
     O                         V0662   1630                               PROD02
     O                         V0663 4 1634                               PROD02
     O                         V0664   1641                               PROD02
     O                         V0665 4 1645                               PROD02
     O                         V066CX  1647                               PROD02
     O                N33      V0666 4 1652                               PROD02
     O                N33      V0667   1654                               PROD02
     O                N33      V0668 4 1659                               PROD02
     O                 33      V0669 4 1657                               PROD02
     O                         V066A   1670                               PROD02
     O                         V066B   1677                               PROD02
     O                         V066C 2 1689                               PROD02
     O                N33      V066D 2 1701                               PROD02
     O                 33      V0666 4 1696                               PROD02
     O                 33      V0667   1697                               PROD02
     O                 33      V0668 4 1701                               PROD02
     O                         V0671   1704                               PROD02
     O                         V0672   1710                               PROD02
     O                         V0673 4 1714                               PROD02
     O                         V0674   1721                               PROD02
     O                         V0675 4 1725                               PROD02
     O                         V067CX  1727                               PROD02
     O                N34      V0676 4 1732                               PROD02
     O                N34      V0677   1734                               PROD02
     O                N34      V0678 4 1739                               PROD02
     O                 34      V0679 4 1737                               PROD02
     O                         V067A   1750                               PROD02
     O                         V067B   1757                               PROD02
     O                         V067C 2 1769                               PROD02
     O                N34      V067D 2 1781                               PROD02
     O                 34      V0676 4 1776                               PROD02
     O                 34      V0677   1777                               PROD02
     O                 34      V0678 4 1781                               PROD02
     O                         V068    1786                               PROD02
     O                         V069    1796                               PROD02
     O                         V070    1800                               PROD02
     O                         V071  2 1809                               PROD02
     O                         V0721 4 1813
     O                         V0722   1814
     O                         V0723 4 1818
     O                         V0724   1819
     O                         V0725 4 1823
     O                         V0731 4 1828
     O                         V0732 4 1835
     O                         V0741 4 1839
     O                         V0742  B1841
     O                         V0743 4 1846
     O                N49      V075  2 1855
     O                 49      W075    1855
     O                N49      V0761 2 1862
     O                 49      W076    1862
     O                         V0762   1866
     O                N49      V0771 2 1873
     O                 49      W077    1873
     O                         V0772   1877
     O                         V078    1917
     O                         V079    1957
     O                         V080    1997
     O                         V081    2037
     O                         V082    2077
     O                         V083    2117
     O                         V084    2157                               PROD02
     O                         V085    2197                               PROD02
     O                         V086    2237                               PROD02
     O                         V087    2277                               PROD02
     O                         V088    2317                               PROD02
     O                         V089  2 2324                               PROD02
     O                         V090  2 2331                               PROD02
     O                         V091  2 2338                               PROD02
     O                         V092  2 2345                               PROD02
     O                         V093  2 2352                               PROD02
     O                         V094  2 2359                               PROD02
     O                         V095    2366                               PROD02
    O*                        V096  2 2373                               PROD02
    O*                        V097  2 2380                               PROD02
    O*                        V098  2 2387                               PROD02
    O*                        V099    2394                               PROD02
     O                         V1001   2469                               PROD02
     O                         V1011   2544                               PROD02
     O                         V1021   2619                               PROD02
     O                         V1031   2694                               PROD02
     O                         V1041   2769                               PROD02
     O                         V1051   2844                               PROD02
     O                         V1061   2919                               PROD02
     O                         V1071   2994                               PROD02
     O                         V1081   3069                               PROD02
     O                         V1091   3144                               PROD02
     O                         V1101   3219                               PROD02
     O                         V111  4 3224                               PROD02
     O                         V112  4 3229                               PROD02
     O                         V113  4 3234                               PROD02
     O                         V114  4 3239                               PROD02
     O                         V115  4 3244                               PROD02
     O                         V116  4 3249                               PROD02
     O                         V117  4 3254                               PROD02
     O                         V118  4 3259                               PROD02
     O                         V119  4 3264                               PROD02
     O                         V120  4 3269                               PROD02
     O                         V121  4 3274                               PROD02
     O                         V1221   3276                               PROD02
     O                         V1222   3279                               PROD02
     O                         V1223   3288                               PROD02
     O                         V1224 4 3291                               PROD02
     O                         V1225   3294                               PROD02
     O                         V1226 4 3297                               PROD02
     O                         V1227 4 3304                               PROD02
     O                         V1228 4 3311                               PROD02
     O                         V122M   3313                               PROD02
     O                         V1229 4 3318                               PROD02
     O                         V1231   3320                               PROD02
     O                         V1232   3323                               PROD02
     O                         V1233   3332                               PROD02
     O                         V1234 4 3335                               PROD02
     O                         V1235   3338                               PROD02
     O                         V1236 4 3341                               PROD02
     O                         V1237 4 3348                               PROD02
     O                         V1238 4 3355                               PROD02
     O                         V123M   3357                               PROD02
     O                         V1239 4 3362                               PROD02
     O                         V1241   3364                               PROD02
     O                         V1242   3367                               PROD02
     O                         V1243   3376                               PROD02
     O                         V1244 4 3379                               PROD02
     O                         V1245   3382                               PROD02
     O                         V1246 4 3385                               PROD02
     O                         V1247 4 3392                               PROD02
     O                         V1248 4 3399                               PROD02
     O                         V124M   3401                               PROD02
     O                         V1249 4 3406                               PROD02
     O                         V1251   3408                               PROD02
     O                         V1252   3411                               PROD02
     O                         V1253   3420                               PROD02
     O                         V1254 4 3423                               PROD02
     O                         V1255   3426                               PROD02
     O                         V1256 4 3429                               PROD02
     O                         V1257 4 3436                               PROD02
     O                         V1258 4 3443                               PROD02
     O                         V125M   3445                               PROD02
     O                         V1259 4 3450                               PROD02
     O                         V1261   3452                               PROD02
     O                         V1262   3455                               PROD02
     O                         V1263   3464                               PROD02
     O                         V1264 4 3467                               PROD02
     O                         V1265   3470                               PROD02
     O                         V1266 4 3473                               PROD02
     O                         V1267 4 3480                               PROD02
     O                         V1268 4 3487                               PROD02
     O                         V126M   3489                               PROD02
     O                         V1269 4 3494                               PROD02
     O                         V1271   3496                               PROD02
     O                         V1272   3499                               PROD02
     O                         V1273   3508                               PROD02
     O                         V1274 4 3511                               PROD02
     O                         V1275   3514                               PROD02
     O                         V1276 4 3517                               PROD02
     O                         V1277 4 3524                               PROD02
     O                         V1278 4 3531                               PROD02
     O                         V127M   3533                               PROD02
     O                         V1279 4 3538                               PROD02
     O                         V1281   3540                               PROD02
     O                         V1282   3543                               PROD02
     O                         V1283   3552                               PROD02
     O                         V1284 4 3555                               PROD02
     O                         V1285   3558                               PROD02
     O                         V1286 4 3561                               PROD02
     O                         V1287 4 3568                               PROD02
     O                         V1288 4 3575                               PROD02
     O                         V128M   3577                               PROD02
     O                         V1289 4 3582                               PROD02
     O                         V1291   3584                               PROD02
     O                         V1292   3587                               PROD02
     O                         V1293   3596                               PROD02
     O                         V1294 4 3599                               PROD02
     O                         V1295   3602                               PROD02
     O                         V1296 4 3605                               PROD02
     O                         V1297 4 3612                               PROD02
     O                         V1298 4 3619                               PROD02
     O                         V129M   3621                               PROD02
     O                         V1299 4 3626                               PROD02
     O                         V1301   3628                               PROD02
     O                         V1302   3631                               PROD02
     O                         V1303   3640                               PROD02
     O                         V1304 4 3643                               PROD02
     O                         V1305   3646                               PROD02
     O                         V1306 4 3649                               PROD02
     O                         V1307 4 3656                               PROD02
     O                         V1308 4 3663                               PROD02
     O                         V130M   3665                               PROD02
     O                         V1309 4 3670                               PROD02
     O                         V1311   3672                               PROD02
     O                         V1312   3675                               PROD02
     O                         V1313   3684                               PROD02
     O                         V1314 4 3687                               PROD02
     O                         V1315   3690                               PROD02
     O                         V1316 4 3693                               PROD02
     O                         V1317 4 3700                               PROD02
     O                         V1318 4 3707                               PROD02
     O                         V130M   3709                               PROD02
     O                         V1319 4 3714                               PROD02
     O                         V1321 4 3716                               PROD02
     O                         V1322 2 3726                               PROD02
     O                         V1323 2 3736                               PROD02
     O                         V1324 2 3746                               PROD02
     O                         V1325   3754 '  .  .0'                     PROD02
     O                         V1326   3762 '  .  .0'                     PROD02
     O                         V1327   3765                               PROD02
     O                         V1328 4 3768                               PROD02
     O                         V1331 4 3770                               PROD02
     O                         V1332 2 3780                               PROD02
     O                         V1333 2 3790                               PROD02
     O                         V1334 2 3800                               PROD02
     O                         V1335   3808 '  .  .0'                     PROD02
     O                         V1336   3816 '  .  .0'                     PROD02
     O                         V1337   3819                               PROD02
     O                         V1338 4 3822                               PROD02
     O                         V1341 4 3824                               PROD02
     O                         V1342 2 3834                               PROD02
     O                         V1343 2 3844                               PROD02
     O                         V1344 2 3854                               PROD02
     O                         V1345   3862 '  .  .0'                     PROD02
     O                         V1346   3870 '  .  .0'                     PROD02
     O                         V1347   3873                               PROD02
     O                         V1348 4 3876                               PROD02
     O                         V1351 4 3878                               PROD02
     O                         V1352 2 3888                               PROD02
     O                         V1353 2 3898                               PROD02
     O                         V1354 2 3908                               PROD02
     O                         V1355   3916 '  .  .0'                     PROD02
     O                         V1356   3924 '  .  .0'                     PROD02
     O                         V1357   3927                               PROD02
     O                         V1358 4 3930                               PROD02
     O                         V1361 4 3932                               PROD02
     O                         V1362 2 3942                               PROD02
     O                         V1363 2 3952                               PROD02
     O                         V1364 2 3962                               PROD02
     O                         V1365   3970 '  .  .0'                     PROD02
     O                         V1366   3978 '  .  .0'                     PROD02
     O                         V1367   3981                               PROD02
     O                         V1368 4 3984                               PROD02
     O                         V137    4009                               PROD02
     O                 97      LUTIL 4 4006                               PROD02
     O                         USFAC   4010P                              PROD02
     O                         WOCLI   4013P                              PROD02
     O                         WOPRO   4016P                              PROD02
     O                         WCONF   4019P                              PROD02
     O                         V138    4034                               PROD02
     O                         WSEXT   4035P                              PROD02
     O                         WSINT   4036P                              PROD02
     O                         V139    4052                               PROD02
     O                         V1401 4 4056
     O                         V1402   4058
     O                         V1403 4 4063
     O                         V1411   4071
     O                         MOINS   4073
     O                         V1412 3 4078
     O                                 4079 '%'
     O                         PLUS    4083
     O                         V1413 3 4087
     O                                 4088 '%'
**  TABLE DES LIBELLES IMPRESSION
0    -
1  HELIO
2  FLEXO
3 POST-P
4 OFFSET
5 POST-P
6  GENCO
**  TABLE DES CONSTANTES
PRE-IMPRIME STOCKE
EXTERIEUR
INTERIEUR
GROUPAGE
GARNITURE
COMMANDE D'ESSAIS
COMMANDE D'HOMOLOGATION
IMPRESSION EXT. INT.
SOUS-TRAITANCE
PRODUIT DE LUXE
PRE-SERIE
PREVISIONNELLE
RECHERCHE DE LAIZE INFRUCTUEUSE
SANS RECHERCHE FORMAT STD
SANS EMBALLAGE
AMALGAME
2 RIVETS 4/10/10 PAR DECOUPE
PREMIERE COMMANDE
PRODUIT SOFHUNIC   :      :      :
ATTENTION !!!    COMMANDE SANS VETO
ATTENTION !!! ERREUR FICHIER
. ATTENTION :  SCARSET
CONTACT ALIMENTAIRE
QTÉ IMPÉRATIVE  CAISSES
QTÉ IMPÉRATIVE  PALETTES
LAIZE UTILISÉE ..
PRÉSENTOIR
<---------- Produit Composant --------->
Accès Echangeur Palette TOURY ->
**  TABLE DES ETATS MATERIEL
CCREATION
MMODIFICATION
RREFECTION
EEXISTANT
 EXISTANT
 SANS DOSSIER
NENTRETIEN
TTRANSFERT
**  TABLE DES TYPES DE MATERIEL
1CYLINDRES
2CLICHES
3CLICHES
4PLAQUES
5POST PRINT
6FORME/PLAN
7GAUFRAGE
**  TABLE DES LIBELLES IMPRESSION
0    -
1HELIO
2FLEXO
3TYPO
4OFFSET
5POST-P
6GENCO
