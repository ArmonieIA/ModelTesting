    F*****************************************************************
    F*
    F* CORGNET JEAN PAUL                         LE 16 2 87
    F*
    F* MISE A JOUR DES COMMANDES DU JOUR
    F*
    F*****************************************************************
     FCDEC02D CF  E                    WORKSTN
     F                                        R1    KSFILE F3
     F                                        R2    KSFILE F8
     F                                        R4    KSFILE F22
     F                                        R5    KSFILE F27
     F                                        LIG   KSFILE F50
     F                                        RECNO KSFILE F3WS
     FCDESL3  IF  E           K        DISK
     FCDESL4  IF  E           K        DISK
     F            CDESF1                            KRENAMEF1F1F1F1
    FCDESL1  UF  E           K        DISK
     F            CDESF1                            KRENAMEF2F2F2F2
     FPRODUI2 IF  E           K        DISK
     FRECAPT  IF  E           K        DISK
     FCLIACHL1IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FCLISTAL1IF  E           K        DISK
    FCDEOBSL2UF  E           K        DISK                      A
     F            CDEOBSF1                          KRENAMECDEOBSFF
     FCLIFACL3IF  E           K        DISK
    FCDEMATL1UF  E           K        DISK
     F            CDEMATF1                          KRENAMECDEDDDDD
    FCDEMAT  O   E           K        DISK                      A
    FCDEXPOL1UF  E           K        DISK                      A
    FCARCDEL2UF  E           K        DISK                      A
     FCALENAL2IF  E           K        DISK
     FCLILIVL1IF  E           K        DISK
     FCLIFACL1IF  E           K        DISK
     FCLIENTS1IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
     FCALENAL0IF  E           K        DISK
     F            CALENDF1                          KRENAMECALENDDD
     FCLIOBIL2IF  E           K        DISK
     F            CLIOBIF1                          KRENAMEZOBI
     FBESOMAL5IF  E           K        DISK
     FCOMPREL1IF  E           K        DISK
     FCOMPREL2IF  E           K        DISK
     F            COMPREF1                          KRENAMECOMPREF2
    FCDESUS  O   E                    DISK
    FPRODUL0 UF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUIF2
     FMNUUTIL1IF  E           K        DISK
     FDEVISEL1IF  E           K        DISK
     FCAISSEL1IF  E           K        DISK
     FPALETTL1IF  E           K        DISK
     FPRODS3L1IF  E           K        DISK
     E                    TO         11  2
     E                    TIM         7  1 0
     E                    TRE         7  1 0
     E                    COU         7  1
     E                    TBF        99  2 0
     E                    TBIM       99  8 0
     E                    TBFA       99  8 0
     E                    TBEX       99  8 0
     E                    TBPX       99  2 0
     E                    TBPR       99  9 2
     E                    TBPE       99  9 2
     E                    TBPU       99  9 2
     E                    TBCM       99  3
     E                    TBCD       99  7
     E                    TBSS       99  2 0
     E                    TBAD       99  2 0
     E                    TBSD       99  2 0
     E                    TBJD       99  1 0
     E                    TBBO       99  6 0
     E                    TBAF       99  2 0
     E                    TBAL       99  2 0
     E                    TSE        99  4
     E                    TBDS       99209
     E                    RDV         5  1
     E                    TER     1   3 11
     E                    TCON    1   7 10
     E                    PI      1   1 40
     E                    TI1     1  10 32
     E                    TZO        10 15 2
     IZOBI
     I              SEQACH                          SQSQ11
     I              RGFAC                           RGRG11
     I              RGLIV                           RGRG22
     ICLILIVF1
     I              RECEP1                          RDV,1
     I              RECEP2                          RDV,2
     I              RECEP3                          RDV,3
     I              RECEP4                          RDV,4
     I              RECEP5                          RDV,5
     ICDEDDDDD
     I              USINE                           UUUUU1
     IRECAPTF1
     I              AGENT                           GANGEN
     I              NCONF                           CONCON
     IPRODUIF1
     I              AGENT                           GENGEN
     I              NCONF                           CONCON
     I              QTFAB                           QQ1
     I              QTPRE                           QQ2
     I              QTREN                           QQ3
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP1                           COU,1
     I              COUP2                           COU,2
     I              COUP3                           COU,3
     I              COUP4                           COU,4
     I              COUP5                           COU,5
     I              COUP6                           COU,6
     I              COUP7                           COU,7
     I              NBLIV                           WNBLIV
     IPRODSTF2
     I              NOPRO                           WWPR
     I              BLOC1                           WWBL1
     I              BLOC2                           WWBL2
     I              APRES                           WWAPR
     IPRODUIF2
     I              AGENT                           GENGEN
     I              NCONF                           CONCON
     ICLISTAF1
     I              SEQSTA                          SEQTA
     I              INDUS                           INDU
     I              AGENT                           AGEN
     I              TAUCOM                          TAUCO
     I              GROUPE                          GROU
     ICOMPREF1
     I              STE                             STEGAR
     I              NOCLI                           NOCLIG
     I              NOPRO                           NOPROZ
     I              GARNT                           GARGAR
     ICOMPREF2
     I              STE                             STEGAR
     I              NOCLI                           NOCLIG
     I              NOPRO                           LEPROD
     I              GARNT                           GARGAR
     IDEVISEF1
     I              CODMON                          CODM
     I            DS
     I                                        1   20SS1DEL
     I                                        3   40AN1DEL
     I                                        5   60SE1DEL
     I                                        7   70JO1DEL
     I                                        1   70TE1DEL
     I            DS
     I                                        1   20SSEDEL
     I                                        3   40ANEDEL
     I                                        5   60SEMDEL
     I                                        7   70JOUDEL
     I                                        1   70TESDEL
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 EXTERIEUR
    I******************************************************
     I            DS
     I                                        1  22 DSEXT
     I                                        1   10STMEX1
     I                                        2   4 FACME1
     I                                        5  100MONMAX
     I                                       11  11 TTA
     I                                       12  152FRINCX
     I                                       16  160MATSTX
     I                                       17  200MATCLX
     I                                       21  220MATFAX
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 INTERIEUR
    I******************************************************
     I            DS
     I                                        1  22 DSINT
     I                                        1   10STMINX
     I                                        2   4 FACMIN
     I                                        5  100MONMAI
     I                                       11  11 TTB
     I                                       12  152FRINCI
     I                                       16  160MATSTI
     I                                       17  200MATCIN
     I                                       21  220MATFAI
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 DORURE
    I***************************************************
     I            DS
     I                                        1  22 DSDOR
     I                                        1   10STMGOX
     I                                        2   4 FACMDO
     I                                        5  100MONMAD
     I                                       11  11 TTE
     I                                       12  152FRINCD
     I                                       16  160MATSTD
     I                                       17  200MATCLD
     I                                       21  220MATFAD
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 GAUFRAGE
    I*****************************************************
     I            DS
     I                                        1  22 DSGAU
     I                                        1   10STMGAX
     I                                        2   4 FACMGA
     I                                        5  100MONMAG
     I                                       11  11 TTC
     I                                       12  152FRINCG
     I                                       16  160MATSTG
     I                                       17  200MATCLG
     I                                       21  220MATFAG
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 DECOUPAGE
    I******************************************************
     I            DS
     I                                        1  22 DSDEC
     I                                        1   10STMDEX
     I                                        2   4 FACMDE
     I                                        5  100MONMDE
     I                                       11  11 TTD
     I                                       12  152FRINDE
     I                                       16  160MATSDE
     I                                       17  200MATCLE
     I                                       21  220MATFAE
    I** DS POUR SAISIE STATUT MATERIEL FORMAT F14 GENERALE POUR TESTS
    I****************************************************************
     I            DS
     I                                        1  22 DSGEN
     I                                        1   10STMGEN
     I                                        2   4 FACGEN
     I                                        5  100MONGEN
     I                                       11  11 TTG
     I                                       12  152FRIGEN
     I                                       16  160MATGE1
     I                                       17  200MATGE2
     I                                       21  220MATGE3
     I            DS
     I                                        5   60SEQFAB
     I                                        7   80SEQIMP
     I                                        9  100SSDEL
     I                                       11  120ANDEL
     I                                        9  120SADEL
     I                                       13  140SEDEL
     I                                       15  150JSDEL
     I                                       16  17 CODEL
     I                                       18  240QTIMP
     I                                       25  310QTFAC
     I                                       32  380QTDEXP
     I                                       39  430NBRBOB
     I                                       50  582PRIXUN
     I                                       59  600PX
     I                                        1  60 DSCAD1
     ITSET        DS                              4
     I                                        1   20TSEFAB
     I                                        3   40TSERAN
     I            DS
     I                                        1 256 DSCOMM
     I                                        1   10STE
     I                                        2   50NOCLI
     I                                        6   70AGENT
     I                                        8   90INDUS
     I                                       10  110RGFAC
     I                                       12  130RGLIV
     I                                       14  150SEQACH
     I                                       16  190NOPOUT
     I                                       22  22 ZONE95
     I                                       25  290NOFOR
     I            DS
     I                                        1 209 DSREF
     I                                        1   40NOPRO
     I                                        5   90NCONF
     I                                       10  110SQIMP
     I                                       13  140SQFAB
     I                                       15  150STEZ
     I                                       16  190NOCLIZ
     I                                       20  34 ABRCLI
     I                                       35  36 GARNT
     I                                       37  370UVENT
     I                                       38  39 GROUPE
     I                                       40  400SEQSTA
     I                                       41  420AGENTZ
     I                                       43  430USEXT
     I                                       44  440USINT
     I I            0                        45  450USINE
     I                                       46  65 CLIREF
     I                                       66  670COMCLJ
     I                                       68  690COMCLM
     I                                       70  710COMCLA
     I                                       72  91 CLIPRO
     I                                       92  930MMDEL
     I                                       94  950JJDEL
     I                                       96  980NOJOUR
     I                                       99 1000DEPLIV
     I                                      101 1020PEXPA
     I                                      103 1040PEXPS
     I                                      105 1050PEXPJ
     I                                      106 1070EDIMPM
     I                                      108 1090EDIMPJ
     I                                      110 1110EDFABM
     I                                      112 1130EDFABJ
     I                                      114 1150EDEXPM
     I                                      116 1170EDEXPJ
     I                                      118 1240TOTEXP
     I                                      125 1260EXPEDJ
     I                                      127 1280EXPEDM
     I                                      129 1300EXPEDA
     I                                      131 131 SOLDE
     I                                      132 1330ANDEV
     I                                      134 1370ETUDE
     I                                      138 1410SEQDE
     I                                      142 1460NOFORZ
     I                                      147 147 MOPOR
     I                                      148 148 TAGFA
     I                                      149 149 LANCIM
     I                                      150 150 LANCFA
     I                                      151 151 CDEPRE
     I                                      152 152 PRESER
     I                                      153 153 IMPSTO
     I                                      154 1550CONFJ
     I                                      156 1570CONFM
     I                                      158 1590CONFA
     I                                      160 1600TYPOR
     I                                      161 161 SANFAC
     I                                      162 1702PRIETR
     I                                      171 171 IMPD
     I                                      172 172 FABD
     I                                      173 173 EXPD
     I                                      174 1750ADEDEL
     I                                      176 1770SDEDEL
     I                                      178 1780JDEDEL
     I                                      179 1800COMCLS
     I                                      183 1840EXPEDS
     I                                      185 1860CONFS
     I                                      187 1880SSDDEL
     I                                      189 1986COURSL
     I                                      199 201 CODMON
     I                                      202 2082PUNIT
     I            DS
     I                                        1 256 DATA
     I                                        1   20IND
     I                                        3   40AG
     I                                        5  19 LIBIND
     I                                       20  34 LIBAG
     I                                       35  49 PAYAC
     I                                       50  57 CODOB
     I                                       58  59 REG
     I            DS
     I                                        1   20CALSS
     I                                        3   40CALAA
     I                                        5   60CALMM
     I                                        7   80CALJJ
     I                                        1   80DATCAL
     I            DS
     I I            0                         1   20SYEA
     I                                        3   40UYEA
     I                                        5   60UMONT
     I                                        7   80UDAI
     I I            0                         1   80DATSYS
     I                                        1   40SUYEA
     I            DS
     I                                        1   40UYEM6
     I                                        5   60UMOM6
     I                                        7   80UDAM6
     I I            0                         1   80DATM6
     I            DS
     I                                        1   20CONFFS
     I                                        3   40CONFFA
     I                                        5   60CONFFM
     I                                        7   80CONFFJ
     I                                        1   80DATCON
     I            DS
     I                                        1   20COMATS
     I                                        3   40COMATA
     I                                        5   60COMATM
     I                                        7   80COMATJ
     I                                        1   80DATMAT
     I            DS
     I                                        1 200 CSUCDE
     I                                        1  50 CANN1
     I                                       51 100 CANN2
     I                                      101 150 CANN3
     I                                      151 200 CANN4
     I            DS
     I                                        1  40 LIB12
     I                                        1  34 LIB12A
     I                                       36  400LIB12B
     I           SDS
     I                                      244 253 LIBUS
     I                                      254 263 USRNAM
     IDSPARM      DS
     I                                        1   1 USAISI
     *
     IDTPARM      DS                            164
     I                                        1 150 TZO
     I                                      151 153 DORIG
     I                                      154 156 DDEST
     I                                      157 1635CRS
     I                                      164 164 COEFF
     IDSDEV       DS                             81
     I                                        1   8 TBLNOM
     I                                        9  18 TBVAR
     I                                       19  200LG
     I                                       21  30 CODE
     I                                       31  80 LIBEL
     I                                       81  81 FICH
     * DS Pour récupération des infos écran
     IàINFDS      DS
     I                                    B 370 3710£CURSO
     *
     C           *LIKE     DEFN INCLU     WINCLU
     C                     Z-ADD0         WINCLU
     C                     SETON                     99
     C                     MOVE *YEAR     SUYEA
     C                     MOVE UYEAR     UYEA
     C                     MOVE UMONTH    UMONT
     C                     MOVE UDAY      UDAI
     C                     MOVE *YEAR     UYEM6
     C                     MOVE UMONTH    UMOM6
     C                     MOVE UDAY      UDAM6
     C                     ADD  6         UMOM6
D1  C           UMOM6     IFGT 12
     C                     SUB  12        UMOM6
     C                     ADD  1         UYEM6
F1  C                     END
     C/EJECT
    C** CLES D ACCES AUX FICHIERS
    C****************************
     C           CLECAL    KLIST
     C                     KFLD           ANDEL
     C                     KFLD           SEDEL
     C                     KFLD           JSDEL
     C           CLEFIC    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEQUEN  20
     C           CLECD1    KLIST
     C                     KFLD           NCONF
     C                     KFLD           NOPRO
     C           CLAPRO    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C           CLEPR3    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           PRODOR  40
     C           CLUPRO    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO1
     C           CLEIMP    KLIST
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
     C           CLEOB2    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           CODOBI
     C           CLEACH    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEACH
     C                     Z-ADD1         SEACH   20
     C           CLPARA    KLIST
     C                     KFLD           ARGU    4
     C                     KFLD           VALE    8
     C           CLESTA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C           CLEST1    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEQSTA
     C           CLETES    KLIST
     C                     KFLD           MATGE1
     C                     KFLD           MATGE2
     C                     KFLD           MATGE3
     C           CLECA1    KLIST
     C                     KFLD           COMCLA
     C                     KFLD           COMCLM
     C                     KFLD           COMCLJ
     C           CLECA2    KLIST
     C                     KFLD           COMATA
     C                     KFLD           COMATM
     C                     KFLD           COMATJ
     C           CLEBES    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NCONF
     C                     KFLD           NOPRO
     C           CLEPLA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
    C** CAIPALL1
    C***********
     C           CLEEMB    KLIST
     C                     KFLD           USINE
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           EMBNO
    **
     C           *ENTRY    PLIST
     C                     PARM           DSPARM
     * CDECAU = Dataarea autorisation à retourner dans les commandes
     C           *NAMVAR   DEFN           CDECAU  1
    **
     C           USRNAM    CHAINMNUUTIL1             01
    C           *IN01     CABEQ'1'       FIN
    **
    ** SI USAISI ='*' (passe en parametre)
    **
    C** 1ER FORMAT DEMANDE DE LA COMMANDE OU AFFICHAGE
    C*****************************************************
     C           FORM01    TAG
    C*          ---------------
     C                     SETOF                     019495
     C                     SETOF                     967009
     C                     EXFMTF1
     *
    C           *INKC     CABEQ'1'       FIN
    C** TRAITEMENT DES COMMANDES EN COURS
    C************************************
     C                     IN   CDECAU
     C           CDECAU    COMP 'N'                      37
    C           *IN37     CABEQ'1'       FORM01           CDES EN COUR
     *
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       FORM01
     C                     SETOF                     40  42
D1  C           USINE     IFEQ *ZEROS
    C           GROUPE    ANDEQ*BLANKS
    C           NCONF     ANDEQ*ZEROS
    C           NOPRO     ANDEQ*ZEROS
     C                     SETON                     30
    C                     GOTO FORM01
F1  C                     END
     C           PRAFFI    TAG
    C*          ---------------
D1  C           USINE     IFNE 0
     C                     Z-ADDUSINE     SVUS    10
     C                     MOVE *BLANKS   SVGR
     C                     MOVE *BLANKS   LIBUSI
     C                     MOVE 'USDE'    ARGU
     C                     MOVE USINE     VALE      P
     C           CLPARA    CHAINPARAME               43
    C           *IN43     CABEQ'1'       FORM01
    C           PXMONT    CABEQ999       FORM01         43
     C                     MOVELPXLIBE    LIBUSI
F1  C                     END
D1  C           USINE     IFNE *ZEROS
    C           GROUPE    ANDEQ*BLANKS
     C                     SETON                     40
     C           USINE     SETLLCDESL3
F1  C                     END
D1  C           USINE     IFEQ *ZEROS
    C           GROUPE    ANDNE*BLANKS
     C                     MOVE 'GRPS'    ARGU
     C                     MOVE GROUPE    VALE      P
     C                     MOVE GROUPE    SVGR    2
     C                     Z-ADD*ZERO     SVUS    10
     C           CLPARA    CHAINPARAME               59
    C           *IN59     CABEQ'1'       FORM01
     C                     SETON                     42
     C           GROUPE    SETLLCDESL4
F1  C                     END
     C                     MOVE '0'       IN41
D1  C           *IN40     IFEQ '0'
    C           *IN42     ANDEQ'0'
     C                     MOVE '1'       IN41    1
    C                     GOTO SUITE1
F1  C                     END
     C                     Z-ADD0         I       40
D1  C                     DO   *HIVAL    R1      40
     C   40      USINE     READECDESL3                   80
     C   42      GROUPE    READECDESL4                   80
D2  C           *IN80     IFEQ '1'
D3  C           I         IFEQ 0
    C                     GOTO FORM01
X3  C                     ELSE
    C                     GOTO AFFI
F3  C                     END
F2  C                     END
     C                     ADD  1         I
     C           CLEACH    CHAINCLIACHL1             38
     C        N38          MOVE ABRACH    ABRCLI
     C         38          MOVE *BLANKS   ABRCLI
D2  C           IMPSTO    IFNE ' '
     C                     MOVELPI,1      ABRCLI
F2  C                     END
     C           CLECD1    CHAINCDEMATL1             38
D2  C           *IN38     DOWEQ'0'
D3  C           CODMAT    IFEQ 'FO'
    C           CODMAT    OREQ 'IE'
    C           CODMAT    OREQ 'II'
D4  C           STATUM    IFEQ 1
     C                     MOVE 'C'       CREATI
F4  C                     END
F3  C                     END
     C           CLECD1    READECDEMATL1                 38
F2  C  N38                END
     C                     WRITEF3
     C                     MOVE ' '       CREATI
F1  C                     END
     C           AFFI      TAG
    C**         ****      ***
     C                     SETON                     1011
     C                     WRITEF4
     C   40                MOVE *BLANKS   GROUPE
     C                     EXFMTF2
     C                     SETOF                     1011
    C           *INKC     CABEQ'1'       FIN
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ
    C                     GOTO FORM01
F1  C                     END
D1  C                     DO   *HIVAL    R1
     C                     READCF3                       80
    C   80                GOTO AFFI
    C           CHOIX     CABEQ' '       BAS
    C                     GOTO SUITE1
     C           BAS       TAG
    C**         ***       ***
F1  C                     END
    C                     GOTO AFFI
     C           SUITE1    TAG
    C**         ******    ***
     C                     Z-ADD*ZEROS    STMEX1
     C                     Z-ADD*ZEROS    STMINX
     C                     Z-ADD*ZEROS    STMGOX
     C                     Z-ADD*ZEROS    STMGAX
     C                     Z-ADD*ZEROS    STMDEX
     C                     Z-ADD*ZEROS    MONMAX
     C                     Z-ADD*ZEROS    MONMAI
     C                     Z-ADD*ZEROS    MONMAD
     C                     Z-ADD*ZEROS    MONMAG
     C                     Z-ADD*ZEROS    MONMDE
     C                     Z-ADD*ZEROS    FRINCX
     C                     Z-ADD*ZEROS    FRINCI
     C                     Z-ADD*ZEROS    FRINCD
     C                     Z-ADD*ZEROS    FRINCG
     C                     Z-ADD*ZEROS    FRINDE
     C                     Z-ADD*ZEROS    MATSTX
     C                     Z-ADD*ZEROS    MATSTI
     C                     Z-ADD*ZEROS    MATSTD
     C                     Z-ADD*ZEROS    MATSTG
     C                     Z-ADD*ZEROS    MATSDE
     C                     Z-ADD*ZEROS    MATCLX
     C                     Z-ADD*ZEROS    MATCIN
     C                     Z-ADD*ZEROS    MATCLD
     C                     Z-ADD*ZEROS    MATCLG
     C                     Z-ADD*ZEROS    MATCLE
     C                     Z-ADD*ZEROS    MATFAX
     C                     Z-ADD*ZEROS    MATFAI
     C                     Z-ADD*ZEROS    MATFAD
     C                     Z-ADD*ZEROS    MATFAG
     C                     Z-ADD*ZEROS    MATFAE
     C                     Z-ADD*ZEROS    COMATJ
     C                     Z-ADD*ZEROS    COMATM
     C                     Z-ADD*ZEROS    COMATA
     C                     Z-ADD*ZEROS    COMATS
     C                     Z-ADD*ZEROS    USEXT
     C                     Z-ADD*ZEROS    USINT
     C                     Z-ADD*ZEROS    INT
     C                     Z-ADD*ZEROS    EXT
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
    C*
     C           CLECD1    CHAINCDESL1               31
    C  N31      TAGREL    CABEQ'*'       FORM01         31
    C         31          GOTO FORM01
     C                     Z-ADDNCONF     CONF    50
     C                     Z-ADDNOPRO     PROD    40
     C           SANFAC    COMP '*'                      96
     C                     MOVE '0'       *IN90
D1  C           PXS       IFEQ 0
    C           USAISI    ANDEQ*BLANK
     C                     MOVE '1'       *IN90
F1  C                     END
     C                     Z-ADDCONF      NCONF
     C                     Z-ADDPROD      NOPRO
     C           CLECD1    CHAINCDESL1               38
D1  C           QTPRE     IFEQ 0
    C           QTREN     ANDEQ0
     C                     SETON                     78
F1  C                     END
     * RECHERCHE SI GARNITURE (RE)
     * ---------------------------
     C           CLAPRO    SETLLCOMPREL1                 95
     C           IMPSTO    COMP 'P'                      94
     C   94
     COR 95                SETON                     01
     C   95                MOVE *BLANKS   NOMCLI
     C   95      CLAPRO    CHAINRECAPT               38
     C   95                MOVE 'RE'      GARNT
     C           CDEPRE    COMP 'P'                      82
    C** RECUP LIBELLE DE L'AGENT
    C***************************
D1  C           *IN94     IFEQ '0'
     C                     MOVE 'TVRP'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE AGENT     VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBAG
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINE     VALE      P
     C                     MOVELPXLIBE    LIBUSI
     C           CLAPRO    CHAINPRODUI2              38
     C                     MOVE *IN17     IN17    1
D2  C           *IN38     IFEQ '0'
     C           CLAPRO    CHAINCOMPREL2             17
     C        N17          MOVE GARGAR    GARNT
F2  C                     END
     C                     MOVE IN17      *IN17
     C                     MOVE USINE     ZIZI    10
     C                     MOVE ANPRO     DERPRO
     C  N38                MOVE NOFOR     FORTUN  50
     C                     Z-ADDANDEV     DEVAN   20
     C                     Z-ADDETUDE     UDETE   40
X1  C                     ELSE
     C                     MOVE *BLANKS   NOMCLI
     C                     MOVE PI,1      NOMCLI
     C                     MOVE *BLANKS   GROUPE
     C                     MOVE *BLANKS   AGENT
     C                     MOVE *BLANKS   LIBAG
F1  C                     END
    C** DECODAGE UNITE DE VENTE
    C**************************
     C                     MOVE *BLANKS   VENTE
     C                     MOVE *BLANKS   FACTE
D1  C           *IN94     IFEQ '1'
     C                     MOVE *BLANKS   BLOC2
     C                     MOVE *BLANKS   BLOC1
     C           CLAPRO    CHAINPREIMP2              38
     C                     MOVELDPRIMP    BLOC1
     C                     MOVE TIMPS     EXT
     C                     MOVE UVENTP    UVENT
F1  C                     END
    C** AUX 1000
    C***********
D1  C           UVENT     IFEQ 1
     C                     MOVE 1000      VENTE
F1  C                     END
    C** 100 M2
    C*********
D1  C           UVENT     IFEQ 2
     C                     MOVE 100       VENTE
     C                     MOVE 'M2'      FACTE
F1  C                     END
    C** 100 ML
    C*********
D1  C           UVENT     IFEQ 3
     C                     MOVE 100       VENTE
     C                     MOVE 'ML'      FACTE
F1  C                     END
    C** 100 KG
    C*********
D1  C           UVENT     IFEQ 4
     C                     MOVE 100       VENTE
     C                     MOVE 'KG'      FACTE
F1  C                     END
    C** A L UNITE
    C************
D1  C           UVENT     IFEQ 5
     C                     MOVE 1         VENTE
F1  C                     END
    C** RECUP STATUT MATERIEL
    C************************
     C                     Z-ADD0         STME
     C                     Z-ADD0         STMI
     C           CLECD1    SETLLCDEMATL1
D1  C                     DO   *HIVAL
     C           CLECD1    READECDEMATL1                 38
    C         38          GOTO APRES
D2  C           CODMAT    IFEQ 'IE'
     C                     MOVE STATUM    STME    10
F2  C                     END
D2  C           CODMAT    IFEQ 'II'
     C                     MOVE STATUM    STMI    10
F2  C                     END
F1  C                     END
     C           APRES     TAG
    C**         ******    ***
D1  C           *IN94     IFEQ '0'
     C           CLEACH    CHAINCLIACHL1             38
     C        N38          MOVE NOMACH    NOMCLI
F1  C                     END
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
    C           UVENT     ANDEQ4
     C                     Z-ADDDECH      FLD005  73
X1  C                     ELSE
    C                     GOTO FOR144
F1  C                     END
    C** TRADUCTION DU POIDS DE LA BOBINETTE
    C**************************************
D1  C           DECH      IFNE *ZEROS
     C                     MOVELDECL      DECLM   43
    C** SURFACE BOBINE
    C*****************
     C           DECLM     MULT DECH      SURBOB  73
    C** POIDS SUPPORT 3
    C******************
D2  C           NIMPE1    IFEQ *BLANKS
    C           NIMPE2    ANDEQ*BLANKS
     C           SURBOB    MULT GRAM3     PDG3    50
X2  C                     ELSE
     C                     MOVE NIMPE1    ETUDE
     C                     MOVE NIMPE2    SEQDE
     C           CLEIMP    CHAINPREIMP2              38
     C                     MOVE TIMPS     EXT
     C                     MOVE GRAMS     GRAM3
     C           SURBOB    MULT GRAM3     PDG3    50
F2  C                     END
    C** POIDS SUPPORT 4
    C******************
     C           SURBOB    MULT GRAM4     PDG4    50
    C** POIDS SUPPORT 4 SI ONDUL = 1
    C*******************************
    C*          ONDUL     IFEQ 1
    C*          PDG4      MULT 1,32      PDG4
    C*                    END
    C** POIDS SUPPORT 4 SI ONDUL = 2
    C*******************************
    C*          ONDUL     IFEQ 2
    C*          PDG4      MULT 1,45      PDG4
    C*                    END
    C** POIDS SUPPORT 4 SI ONDUL = 3
    C*******************************
    C*          ONDUL     IFEQ 3
    C*          PDG4      MULT 1,50      PDG4
    C*                    END
    C** POIDS TOTAL DE LA BOBINETTE
    C******************************
D2  C           CCOL      IFNE 8
    C           CCOL      ANDNE3
     C                     MOVE 'ONDU'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE ONDUL     VALE
     C           CLPARA    CHAINPARAME               38
     C  N38      PDG4      MULT PXMONT    PDG4
     C           PDG3      ADD  PDG4      PDTOT   60
     C           PDTOT     MULT 0,001     BOBPDS
F2  C                     ENDIF
F1  C                     END
     C           FOR144    TAG
    C** AFFICHAGE FORMAT C
    C*********************
     C           FORM02    TAG
    C**         ******    ***
     C  N94                EXSR MATERI
     C           FORM2B    TAG
     C                     SETOF                     34
     C   94
     COR 95
     COR 96                SETON                     34
     C           CODTA     COMP 1                    8585
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      71
     *
     C                     EXFMTF5
     *
     C                     MOVE REF71     *IN71
    C           *INKC     CABEQ'1'       FIN
    C** TRAITEMENT DES COMMANDES EN COURS
    C************************************
     C                     IN   CDECAU
     C           CDECAU    COMP 'N'                      37
    C           *IN37     CABEQ'1'       FORM02           CDES EN COUR
     *
D1  C           *IN22     IFEQ '1'
    C           IN41      CABEQ'1'       FORM01
     C                     Z-ADDSVUS      USINE
     C                     MOVE SVGR      GROUPE
     C                     EXSR RAZ2
    C                     GOTO PRAFFI
F1  C                     END
D1  C           USAISI    IFEQ '*'
    C           OPTION    CABEQ4         FORM02         30
    C           OPTION    CABEQ5         FORM02         30
F1  C                     END
     C           CDEPRE    COMP 'P'                      82
D1  C           *IN94     IFEQ '1'
    C           OPTION    CABEQ1         FORM02         30
    C           OPTION    CABEQ3         FORM02         30
    C           OPTION    CABEQ4         FORM02         30
    C           OPTION    CABEQ5         FORM02         30
    C           OPTION    CABEQ7         FORM02         30
    C           OPTION    CABEQ8         FORM02         30
    C           OPTION    CABEQ10        FORM02         30
    C           OPTION    CABEQ13        FORM02         30
F1  C                     END
D1  C           *IN95     IFEQ '1'
    C           OPTION    CABEQ7         FORM02         30
    C           OPTION    CABEQ13        FORM02         30
F1  C                     END
D1  C           *IN96     IFEQ '1'
    C           OPTION    CABEQ4         FORM02         30
    C           OPTION    CABEQ5         FORM02         30
    C           OPTION    CABEQ13        FORM02         30
F1  C                     END
    C         85OPTION    CABEQ8         FORM02         30
    C** IDENTIFICATION DE LA COMMANDE
    C********************************
    C           OPTION    CASEQ1         SPGR01
    C                     END
    C** CONDITIONS GENERALES COMMANDE
    C********************************
    C           OPTION    CASEQ2         SPGR02
    C                     END
    C** CONDITIONS PARTICUL. COMMANDE
    C********************************
    C           OPTION    CASEQ3         SPGR2A
    C                     END
    C** ADRESSE ACCUSE RECEPTION
    C***************************
    C           OPTION    CASEQ4         SPGR03
    C                     END
    C** CONDITIONS DE PAIEMENT
    C*************************
    C           OPTION    CASEQ5         SPGR04
    C                     END
    C** OBSERVATION
    C**************
    C           OPTION    CASEQ6         SPGR05
    C                     END
    C** DOSSIER MATERIEL
    C*******************
    C           OPTION    CASEQ7         SPGR06
    C                     END
    C** EXPORT TRANSITAIRE
    C*********************
    C           OPTION    CASEQ8         SPGR07
    C                     END
    C** CADENCEMENT
    C**************
    C           OPTION    CASEQ9         SPGR08
    C                     END
    C** REFERENCES COMPLEMENTAIRES
    C*****************************
    C           OPTION    CASEQ10        SPGR09
    C                     END
    C** ANNULATION DE LA COMMANDE
    C****************************
D1  C           OPTION    IFEQ 11
D2  C           *IN96     IFEQ '1'
     C                     SETON                     88
    C                     GOTO FORM2B
F2  C                     END
     C           CLECD1    CHAINCDESL1               38
D2  C           TAGBID    IFEQ '*'
     C                     WRITEWSUP1
     C                     EXFMTWSUP2
X2  C                     ELSE
     C                     WRITEWANN1
     C                     EXFMTWANN2
F2  C                     END
D2  C           *IN22     IFEQ '1'
D3  C           TAGBID    IFEQ '*'
     C                     Z-ADDUDAY      SUSPJ
     C                     Z-ADDUMONTH    SUSPM
     C                     Z-ADDUYEAR     SUSPA
     C                     MOVEL*YEAR     SUSPS
     C                     MOVE 'A'       TAGORI
     C                     MOVE INICRE    INISV   3
     C                     MOVE INITIA    INICRE
     C                     WRITECDESUSF1
     C                     MOVE INISV     INICRE
F3  C                     END
     C                     EXSR SPGR11
     C                     EXSR RAZ2
    C                     GOTO PRAFFI
X2  C                     ELSE
    C                     GOTO FORM2B
F2  C                     END
F1  C                     END
    C** MISE EN SUSPEN COMMANDE
    C**************************
D1  C           OPTION    IFEQ 12
D2  C           *IN96     IFEQ '1'
     C                     SETON                     92
    C                     GOTO FORM2B
F2  C                     END
     C           CLECD1    CHAINCDESL1               38
D2  C           TAGBID    IFNE '*'
     C                     SETON                     91
    C                     GOTO FORM2B
F2  C                     END
     C                     WRITEWSUP1
     C                     EXFMTWSUP2
D2  C           *IN22     IFEQ '1'
     C                     Z-ADDUDAY      SUSPJ
     C                     Z-ADDUMONTH    SUSPM
     C                     Z-ADDUYEAR     SUSPA
     C                     MOVEL*YEAR     SUSPS
     C                     MOVE 'S'       TAGORI
     C                     MOVE INICRE    INISV   3
     C                     MOVE INITIA    INICRE
     C                     WRITECDESUSF1
     C                     MOVE INISV     INICRE
     C           NCONF     SETLLCDESL1
D3  C                     DO   *HIVAL
     C           NCONF     READECDESL1                   38
D4  C           *IN38     IFEQ '1'
     C                     EXSR RAZ2
    C                     GOTO PRAFFI
F4  C                     END
     C                     MOVE *BLANKS   TAGBID
     C                     MOVE LIBUS     POSTE
     C                     UPDATF2F2F2F2
F3  C                     END
X2  C                     ELSE
    C                     GOTO FORM2B
F2  C                     END
F1  C                     END
    C**
    C** TRANSFERT SUR UN AUTRE PRODUIT
    C********************************
D1  C           OPTION    IFEQ 13
    C           *IN94     ANDEQ'1'
    C           OPTION    OREQ 13
    C           *IN95     ANDEQ'1'
    C           OPTION    OREQ 13
    C           *IN96     ANDEQ'1'
     C                     SETON                     34
    C                     GOTO FORM02
F1  C                     END
D1  C           OPTION    IFEQ 13
     C                     EXSR SPGR13
F1  C                     END
    C                     GOTO FORM02
     C/EJECT
     C           FIN       TAG
    C**         ***       ***
     C                     MOVE '1'       *INLR
     C/EJECT
    C** RAZ DES ZONES
    C****************
    C           RAZ       BEGSR
     C                     SETON                     12
     C                     WRITEF2
     C                     WRITEF7
     C                     WRITEF23
     C                     WRITEF26
     C                     SETOF                     12
     C                     SETOF                     646566
     C                     SETOF                     67
     C                     MOVE *BLANKS   STMI
     C                     MOVE *BLANKS   STME
     C                     MOVE *BLANKS   EXT
     C                     MOVE *BLANKS   INT
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
     C                     MOVE *BLANKS   USINE
     C                     MOVE *BLANKS   GROUPE
     C                     MOVE *BLANKS   NCONF
     C                     MOVE *BLANKS   NOPRO
     C                     MOVE *BLANKS   LIBUSI
     C                     MOVE *BLANKS   FACME1
     C                     MOVE *BLANKS   FACMIN
     C                     MOVE *BLANKS   FACMGA
     C                     MOVE *BLANKS   FACMDO
     C                     MOVE *BLANKS   FACMDE
     C                     Z-ADD*ZEROS    STMEX1
     C                     Z-ADD*ZEROS    STMINX
     C                     Z-ADD*ZEROS    STMGOX
     C                     Z-ADD*ZEROS    STMGAX
     C                     Z-ADD*ZEROS    STMDEX
     C                     Z-ADD*ZEROS    MONMAX
     C                     Z-ADD*ZEROS    MONMAI
     C                     Z-ADD*ZEROS    MONMAD
     C                     Z-ADD*ZEROS    MONMAG
     C                     Z-ADD*ZEROS    MONMDE
     C                     Z-ADD*ZEROS    FRINCX
     C                     Z-ADD*ZEROS    FRINCI
     C                     Z-ADD*ZEROS    FRINCD
     C                     Z-ADD*ZEROS    FRINCG
     C                     Z-ADD*ZEROS    FRINDE
     C                     Z-ADD*ZEROS    MATSTX
     C                     Z-ADD*ZEROS    MATSTI
     C                     Z-ADD*ZEROS    MATSTD
     C                     Z-ADD*ZEROS    MATSTG
     C                     Z-ADD*ZEROS    MATSDE
     C                     Z-ADD*ZEROS    MATCLX
     C                     Z-ADD*ZEROS    MATCIN
     C                     Z-ADD*ZEROS    MATCLD
     C                     Z-ADD*ZEROS    MATCLG
     C                     Z-ADD*ZEROS    MATCLE
     C                     Z-ADD*ZEROS    MATFAX
     C                     Z-ADD*ZEROS    MATFAI
     C                     Z-ADD*ZEROS    MATFAD
     C                     Z-ADD*ZEROS    MATFAG
     C                     Z-ADD*ZEROS    MATFAE
     C                     Z-ADD*ZEROS    COMATJ
     C                     Z-ADD*ZEROS    COMATM
     C                     Z-ADD*ZEROS    COMATA
     C                     Z-ADD*ZEROS    COMATS
     C                     MOVE *BLANKS   ABRCLI
     C                     MOVE *BLANKS   NOMCLI
     C                     MOVE *BLANKS   BLOC1
     C                     MOVE *BLANKS   BLOC2
    C                     ENDSR
    C           RAZ2      BEGSR
     C                     SETON                     12
     C                     WRITEF2
     C                     WRITEF7
     C                     WRITEF23
     C                     WRITEF26
     C                     SETOF                     12
    C                     ENDSR
     C/EJECT
    C           SPGR01    BEGSR
     C                     SETON                     12
     C                     WRITEF7
     C                     SETOF                     12
     C           CLECD1    CHAINCDESL1               38
     C           CLESTA    SETLLCLISTAL1
     C                     MOVE CDEPRE    PREPRE  1
     C                     MOVE PRESER    SERSER  1
D1  C                     DO   *HIVAL    R2      40
     C           CLESTA    READECLISTAL1                 80
    C   80                GOTO FORM03
     C                     MOVE 'TSEC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE INDU      VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBEIN
     C                     MOVE 'TVRP'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE AGEN      VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBAGE
     C                     WRITEF8
F1  C                     END
     C           FORM03    TAG
    C**         ******    ***
     C                     WRITEF9
     C           CLEST1    CHAINCLISTAL1             38
     C                     MOVE INDU      INDUS
     C                     MOVE TAUCO     TAUCOM
     C                     MOVE 'TSEC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE INDUS     VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBIND
     C                     MOVE 'TVRP'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE AGENT     VALE
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXLIBE    LIBAG
     C           F6A       TAG
D1  C           R2        IFGT 2
     C                     SETON                     1011
     C                     WRITEF7
     C                     SETOF                     1011
F1  C                     END
     C                     EXFMTF6
     C                     MOVE CONFS     CONFFS
     C                     MOVE CONFA     CONFFA
     C                     MOVE CONFM     CONFFM
     C                     MOVE CONFJ     CONFFJ
     C                     MOVE GROUPE    GROUP   2
     C                     MOVE CLIPRO    CLIRE  20
     C                     MOVE PRESER    SERPRE  1
     C                     MOVE CDEPRE    PRECDE  1
     C                     MOVE CLIFOU    FOUFOU
    C*
D1  C           CDEPRE    IFEQ 'P'
    C           PRESER    ANDEQ'P'
     C                     SETON                     02
    C                     GOTO F6A
F1  C                     END
    C*
D1  C           CDEPRE    IFEQ 'P'
    C           GARNT     ANDEQ'MH'
     C                     SETON                     20
    C                     GOTO F6A
F1  C                     END
    C*
     C           CDEPRE    COMP 'P'                      82
D1  C           R2        IFGT 2
D2  C           *IN03     IFEQ '1'
D3  C                     DO   *HIVAL    R2
     C                     READCF8                       80
     C         80          SETON                     12
     C         80          WRITEF7
     C         80          SETOF                     12
    C         80          GOTO FORM02
D4  C           CHOIX     IFEQ 'X'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE CONFFS    CONFS
     C                     MOVE CONFFA    CONFA
     C                     MOVE CONFFM    CONFM
     C                     MOVE CONFFJ    CONFJ
     C                     MOVE GROUP     GROUPE
     C                     MOVE INDU      INDUS
     C                     MOVE CLIRE     CLIPRO
     C                     MOVE SERPRE    PRESER
     C                     MOVE PRECDE    CDEPRE
     C                     MOVE SEQTA     SEQSTA
     C                     MOVE AGEN      AGENT
     C                     MOVE TAUCO     TAUCOM
     C                     MOVE LIBUS     POSTE
     C                     MOVE *BLANKS   TAGBID
     C                     MOVE FOUFOU    CLIFOU
     C                     UPDATF2F2F2F2
     C           CLECD1    SETLLCARCDEL2
D5  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
     C   80                SETON                     12
     C   80                WRITEF7
     C   80                SETOF                     12
     C   80                MOVE 'TSEC'    ARGU
     C   80                MOVE *BLANKS   VALE
     C   80                MOVE INDUS     VALE
     C   80      CLPARA    CHAINPARAME               38
     C   80                MOVELPXLIBE    LIBIND
     C   80                MOVE 'TVRP'    ARGU
     C   80                MOVE *BLANKS   VALE
     C   80                MOVE AGENT     VALE
     C   80      CLPARA    CHAINPARAME               38
     C   80                MOVELPXLIBE    LIBAG
    C   80                GOTO PLUPAR
     C                     MOVE SEQTA     SEQSTA
     C                     MOVE AGEN      AGENT
     C                     MOVE TAUCO     TAUCOM
     C                     MOVE CONFFS    CONFS
     C                     MOVE CONFFA    CONFA
     C                     MOVE CONFFM    CONFM
     C                     MOVE CONFFJ    CONFJ
     C                     MOVE GROUP     GROUPE
     C                     MOVE CLIRE     CLIPRO
     C                     MOVE SERPRE    PRESER
     C                     MOVE PRECDE    CDEPRE
     C                     UPDATCARCDEF1
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
     C           CLECAC    KLIST
     C                     KFLD           CONFA
     C                     KFLD           CONFM
     C                     KFLD           CONFJ
D1  C           DATCON    IFNE *ZEROS
     C           CLECAC    CHAINCALENAL0             38
    C   38                GOTO F6A
    C           DATCON    CABGTDATSYS    F6A        38
F1  C                     END
     C                     MOVE 'GRPS'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE GROUPE    VALE
     C           CLPARA    CHAINPARAME               17
    C           *IN17     CABEQ'1'       F6A
    C           CLIPRO    CABEQ*BLANKS   F6A            18
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE CONFFS    CONFS
     C                     MOVE CONFFA    CONFA
     C                     MOVE CONFFM    CONFM
     C                     MOVE CONFFJ    CONFJ
     C                     MOVE GROUP     GROUPE
     C                     MOVE CLIRE     CLIPRO
     C                     MOVE SERPRE    PRESER
     C                     MOVE PRECDE    CDEPRE
     C                     MOVE LIBUS     POSTE
     C                     MOVE FOUFOU    CLIFOU
D1  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F1  C                     END
     C                     UPDATF2F2F2F2
     C           CLECD1    SETLLCARCDEL2
D1  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
     C   80                SETON                     12
     C   80                WRITEF7
     C   80                SETOF                     12
     C   80                MOVE 'TSEC'    ARGU
     C   80                MOVE *BLANKS   VALE
     C   80                MOVE INDUS     VALE
     C   80      CLPARA    CHAINPARAME               38
     C   80                MOVELPXLIBE    LIBIND
     C   80                MOVE 'TVRP'    ARGU
     C   80                MOVE *BLANKS   VALE
     C   80                MOVE AGENT     VALE
     C   80      CLPARA    CHAINPARAME               38
     C   80                MOVELPXLIBE    LIBAG
    C   80                GOTO PLUPAR
     C                     MOVE CONFFS    CONFS
     C                     MOVE CONFFA    CONFA
     C                     MOVE CONFFM    CONFM
     C                     MOVE CONFFJ    CONFJ
     C                     MOVE GROUP     GROUPE
     C                     MOVE CLIRE     CLIPRO
     C                     MOVE SERPRE    PRESER
     C                     MOVE PRECDE    CDEPRE
     C                     UPDATCARCDEF1
F1  C                     END
     C           PLUPAR    TAG
D1  C           CDEPRE    IFNE PREPRE
    C           CDEPRE    ANDEQ' '
     C                     EXSR SPGR08
F1  C                     END
D1  C           CDEPRE    IFNE PREPRE
    C           CDEPRE    ANDEQ'P'
     C           CLECD1    SETLLCARCDEL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 38
    C   38                GOTO DDDD
D3  C           CODEL     IFNE *BLANKS
     C                     MOVE 'PR'      CODEL
     C                     UPDATCARCDEF1
F3  C                     END
F2  C                     END
     C           DDDD      TAG
    C**         ****
F1  C                     END
     C                     MOVE '0'       SSSSSS  1
D1  C           PRESER    IFNE 'P'
    C           PRESER    ANDNESERSER
     C                     MOVE '1'       SSSSSS
     C                     EXSR SPGR02
     C           CLECD1    CHAINCDESL1               38
F1  C                     END
D1  C           PRESER    IFNE SERSER
    C           PRESER    ANDEQ'P'
     C           CLECD1    SETLLCARCDEL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 38
    C   38                GOTO EEEE
     C                     Z-ADD*ZEROS    PUNIT
     C                     Z-ADD*ZEROS    PX
     C                     UPDATCARCDEF1
F2  C                     END
     C           EEEE      TAG
    C**         ****      ***
F1  C                     END
    C                     ENDSR
     C/EJECT
    C           SPGR02    BEGSR
     C                     SETOF                     7884
     C           CLECD1    CHAINCDESL1               38
     C                     Z-ADDQTOT      QTOT1   80
     C                     Z-ADDQTFAB     QTFAB1  80
     C                     Z-ADDQTPRE     QTPRE1  80
     C                     Z-ADDQTREN     QTREN1  80
     C                     Z-ADDTOTBOB    TOTBO1  80
     C                     Z-ADDNBLIV     NBLIV1  20
     C                     Z-ADDFRLIV     FRLIV1  20
     C                     Z-ADDPXS       SXP     20
     C                     Z-ADDPRIUNS    PRIPI1  92
     C                     MOVE LIBUS     POSTE
     C                     UPDATF2F2F2F2
D1  C           NBLIV     IFEQ 1
     C                     Z-ADD*ZEROS    NBLIV
F1  C                     END
D1  C           QTFAB     IFNE *ZEROS
     C           QTOT      DIV  QTFAB     NBFAB
X1  C                     ELSE
     C                     Z-ADD*ZEROS    NBFAB
F1  C                     END
D1  C           QTPRE     IFNE *ZEROS
     C                     Z-ADD1         NBIMP
     C           QTOT      SUB  QTPRE     QTRESI  80
D2  C           QTREN     IFNE *ZEROS
     C           QTRESI    DIV  QTREN     NBIRE
X2  C                     ELSE
     C                     Z-ADD*ZEROS    NBIRE
F2  C                     END
X1  C                     ELSE
     C                     Z-ADD*ZEROS    NBIMP
D2  C           QTREN     IFNE *ZEROS
     C           QTOT      DIV  QTREN     NBIRE
X2  C                     ELSE
     C                     Z-ADD*ZEROS    NBIRE
F2  C                     END
F1  C                     END
D1  C           QTPRE     IFEQ 0
    C           QTREN     ANDEQ0
     C                     SETON                     78
F1  C                     END
D1  C           FACON     IFNE 2
     C                     SETON                     84
F1  C                     END
    C**         ******    ***
D1  C           PXS       IFEQ 0
    C           USAISI    ANDEQ*BLANK
     C           CLESTA    CHAINCLIENTS1             38
     C                     MOVE *BLANKS   CODMO1
     C                     MOVE *BLANKS   CODMO2
     C                     MOVE *BLANKS   CODMON
     C                     Z-ADD*ZEROS    PRIXU
     C                     Z-ADD*ZEROS    FRAISL
     C           MON05     TAG
    C**         ******    ***
D2  C           CODTA     IFNE 1
    C           EDICOU    ANDEQ'D'
     C                     MOVE 'E'       EDICOU
F2  C                     END
     C                     MOVEL*BLANKS   LIBMO2
D2  C           CODTA     IFNE 1
     C                     MOVELTI1,2     LIBMO1
     C                     MOVE 'EUR'     CODMO1
     C                     MOVE 'EUR'     CODMO2
     C                     MOVE 'EUR'     CODMON
X2  C                     ELSE
D3  C           EDICOU    IFEQ 'D'
     C                     MOVE '   '     CODMO1
     C                     MOVE '   '     CODMO2
     C                     MOVE '   '     CODMON
     C                     MOVELTI1,4     LIBMO1
     C                     MOVELTI1,6     LIBMO2
F3  C                     END
D3  C           EDICOU    IFEQ 'E'
    C           EDICOU    OREQ ' '
     C                     MOVE 'EUR'     CODMO1
     C                     MOVE 'EUR'     CODMO2
     C                     MOVE 'EUR'     CODMON
     C                     MOVELTI1,2     LIBMO1
     C                     MOVELTI1,7     LIBMO2
F3  C                     END
F2  C                     END
    C**         ******    ***
X1  C                     ELSE
     C                     MOVE CODMON    CODMO1
     C                     MOVE CODMON    CODMO2
     C                     MOVELTI1,1     LIBMO2
D2  C           CODMON    IFEQ 'EUR'
     C                     MOVELTI1,2     LIBMO1
     C                     Z-ADDPRIUNS    PRIXU
     C                     Z-ADDPLANC     FRAISL
X2  C                     ELSE
     C                     Z-ADDPRIMET    PRIXU
     C                     Z-ADDPLANET    FRAISL
     C                     MOVELTI1,4     LIBMO1
F2  C                     END
F1  C                     END
     C                     MOVE STOND     NATCDE
     C                     MOVE 'NCDE'    ARGU
     C                     MOVE NATCDE    VALE      P
     C           CLPARA    CHAINPARAME               38
     C  N38                MOVELPXLIBE    LIBNCD    P
     C           FORM05    TAG
    C**         ******    ***
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      71
     C           LIBMO2    COMP ' '                      70
     *
     C                     EXFMTF10
     *
     * REMISE A BLANC DES INDICATEURS D'ERREURS
     * ----------------------------------------
     C                     MOVE '0'       *IN14
     C                     MOVE '0'       *IN19
     C                     MOVE '0'       *IN30
     C                     MOVE '0'       *IN31
     C                     MOVE '0'       *IN32
     C                     MOVE '0'       *IN55
     C                     MOVE '0'       *IN69
     C                     MOVE '0'       *IN95
     C                     MOVE '0'       *IN24
     C                     MOVE '0'       *IN25
     C                     MOVE REF71     *IN71
D1  C           *IN22     IFEQ '1'
D2  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C** RECHERCHE NATURE COMMANDE
D1  C           *IN04     IFEQ '1'
     C                     CLEARDSDEV
     C                     MOVEL'NCDE'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSDEV
D2  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      NATCDE
     C                     MOVELLIBEL     LIBNCD
F2  C                     END
    C                     GOTO FORM05
F1  C                     END
    C**CHANGEMENT MONNAIE
    C********************
D1  C           *IN06     IFEQ '1'
D2  C           CODTA     IFNE 1
     C                     MOVE 'E'       EDICOU
X2  C                     ELSE
D3  C           EDICOU    IFEQ *BLANK
    C           EDICOU    OREQ 'E'
     C                     MOVE 'D'       EDICOU
X3  C                     ELSE
     C                     MOVE 'E'       EDICOU
F3  C                     END
F2  C                     END
    C                     GOTO MON05
F1  C                     END
    C**CHOIX DEVISES
    C***************
D1  C           CODMON    IFEQ *BLANK
    C           EDICOU    ANDEQ'D'
     *          -----     ---
     C                     MOVEA*IN       IN     99
     C           AFF3W     TAG
     *          -----     ---
     C                     MOVE '1'       *IN93
     C                     WRITEF3WC
     C                     MOVEA'00'      *IN,93
     C                     MOVE *BLANK    CHW3
     C                     Z-ADD0         RECNO   30
     C           *LOVAL    SETLLDEVISEL1
     C                     READ DEVISEL1                 99
D2  C           *IN99     DOWEQ'0'
D3  C           CODM      IFNE TCM
     C                     MOVELCODM      TCM
     C                     MOVELNOMDEV    TLM
     C                     ADD  1         RECNO
     C                     MOVE '1'       *IN94
     C                     WRITEF3WS
F3  C                     END
     C                     READ DEVISEL1                 99
F2  C                     END
     C                     EXFMTF3WC
D2  C           *IN06     IFEQ '1'
     C                     MOVE 'E'       EDICOU
     C                     MOVEAIN        *IN
    C                     GOTO MON05
F2  C                     END
     C           LW3       TAG
     *
     C                     READCF3WS                     99
     C   99                MOVEAIN        *IN
    C   99                GOTO MON05
D2  C           CHW3      IFNE *BLANK
     C                     MOVE TCM       CODMON
     C                     MOVE TCM       CODMO1
     C                     MOVE TCM       CODMO2
     C                     MOVE 'D'       EDICOU
     C                     MOVEAIN        *IN
    C                     GOTO FORM05
X2  C                     ELSE
    C                     GOTO LW3
F2  C                     END
F1  C                     END
     * SI PRE-IMPRIME STOCKE REPERCUTER LA QTOT DANS TOUTES
     * LES QTES RENSEIGNEES    (QTFAB-QTREN)
     * ----------------------------------------------------
D1  C           *IN94     IFEQ '1'
D2  C           QTFAB     IFNE *ZEROS
     C                     Z-ADDQTOT      QTFAB
F2  C                     END
D2  C           QTREN     IFNE *ZEROS
     C                     Z-ADDQTOT      QTREN
F2  C                     END
F1  C                     END
     *
D1  C           *IN95     IFEQ '0'
D2  C           TOTBOB    IFNE 0
    C           BOBPDS    ANDNE0
     C           QTOT      MULT 0,95      TOTMIN  70H
     C           QTOT      MULT 1,05      TOTMAX  70H
     C           TOTBOB    MULT BOBPDS    TOTMOY  80H
     C           TOTMOY    COMP TOTMIN                 69
     C   69                SETON                     95
    C   69                GOTO FORM05
     C           TOTMOY    COMP TOTMAX               69
    C   69                GOTO FORM05
    C   69                GOTO FORM05
F2  C                     END
F1  C                     END
     C           TOTBOB    COMP 0                        09
    C** COMPARAISON ENTRE LIVRAISONS CALCULEES ET SAISIES
    C****************************************************
     C           NBIMP     ADD  NBIRE     NBIT    20
D1  C           NBLIV     IFEQ 0
    C           FRLIV     ANDNE0
    C           NBLIV     ORNE 0
    C           FRLIV     ANDEQ0
     C                     SETON                     25
    C                     GOTO FORM05
F1  C                     END
D1  C           NBLIV     IFNE *ZEROS
     C           NBLIV     COMP NBFAB                  24
    C         24          GOTO FORM05
F1  C                     END
D1  C           NBFAB     IFNE *ZEROS
     C           NBFAB     COMP NBIT                   26
    C         26          GOTO FORM05
F1  C                     END
    C** QUANTITE IMPERATIVE SUR PALETTE
    C************************************
     C                     MOVE ' '       QTEIP   1
D1  C           RUV1      IFEQ 'O'
     C                     Z-ADD1         EMBNO
     C           CLEEMB    CHAINCAISSEL1             99
    C   99                GOTO FINEMB
    C           EMBNAT    CABEQ'Q'       FINEMB
    C           HCAIS     CABEQ*ZEROS    FINEMB
D2  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D3  C           UVENT     IFEQ 3
     C                     MULT DECH      NBDECP
     C                     MULT DECH      NBRUNI
F3  C                     END
F2  C                     END
     C           EMBHT     DIV  10        HCAIS   31
     C           CLEEMB    CHAINPALETTL1             99
    C   99                GOTO FINEMB
    C           NBDECP    CABEQ*ZEROS    FINEMB
     C           EMBHT     SUB  15        HPAL    41
     C           HPAL      DIV  HCAIS     NBRC    20
     C           NBCAIP    DIV  NBRC      NBRCC   20
     C           NBRC      DIV  2         NBRCP   20
     C                     MVR            RESTEX  20
D2  C           RESTEX    IFNE *ZEROS
     C                     ADD  1         NBRCP
F2  C                     END
     C           NBRCP     MULT NBRCC     IMPCP   60
     C           IMPCP     MULT NBRUNI    IMPPP
     C                     MOVE '*'       QTEIP   1
    C*
     C           QTOT      DIV  NBDECP    NBRPAL  30
     C                     MVR            RESTEZ  92
     C                     Z-ADDNBRPAL    NPMINI  30
    C*
D2  C           RESTEZ    IFNE *ZEROS
    C           OKQTE     ANDEQ*BLANKS
     C           QTOT      COMP NBDECP               19
     C           NPMINI    MULT NBDECP    QTMINI
     C           NPMINI    ADD  1         NPMAXI
     C           NPMAXI    MULT NBDECP    QTMAXI
     C           DF10W     TAG
     C                     MOVE *BLANK    C1F21
     C                     MOVE *BLANK    C2F21
     C                     MOVE *BLANK    C3F21
     C                     EXFMTF10W
    C*
D3  C           *IN23     IFEQ '1'
     C                     MOVE '1'       OKQTE   1
    C                     GOTO FORM05
F3  C                     END
    C*
D3  C           *IN19     IFEQ '1'
D4  C           C1F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DF10W
F4  C                     END
D4  C           C1F21     IFNE *BLANKS
     C                     Z-ADDQTMINI    QTOT
F4  C                     END
D4  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTOT
F4  C                     END
X3  C                     ELSE
D4  C           C2F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C2F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DF10W
F4  C                     END
D4  C           C2F21     IFNE *BLANKS
     C                     Z-ADDIMPPP     QTOT
     C                     MOVE '2'       OKQTE   1
F4  C                     END
D4  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTOT
F4  C                     END
F3  C                     END
    C                     GOTO FORM05
F2  C                     END
    C*
D2  C           OKQTE     IFEQ '2'
     C                     Z-ADD1         NBRPAL
F2  C                     END
D2  C           OKQTE     IFNE '1'
D3  C           NBLIV     IFGT NBRPAL
    C           NBFAC     ORGT NBRPAL
    C           NBIT      ORGT NBRPAL
     C                     SETON                     43
    C                     GOTO FORM05
F3  C                     END
F2  C                     END
F1  C                     END
     **         *         ***
     C           FINEMB    TAG
    C*
     C           QTOT      DIV  NBFAB     QTFAB
D1  C           NBIT      IFNE *ZEROS
     C           QTOT      DIV  NBIT      QTIMP
D2  C           NBIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTPRE
F2  C                     END
D2  C           NBIRE     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTREN
F2  C                     END
F1  C                     END
    C****************************************************
D1  C           *IN94     IFEQ '0'
    C           *IN96     ANDEQ'0'
    C           USAISI    ANDEQ*BLANK
    C           PRIXU     CABEQ0         FORM05         30
D2  C           CODMO1    IFEQ 'EUR'
    C           PRIXU     ANDGT99999
     C                     SETON                     30
    C                     GOTO FORM05
F2  C                     END
    C           PXS       CABEQ0         FORM05         31
F1  C                     END
    C           TYPOR     CABEQ0         FORM05         32
D1  C           TYPOR     IFNE 3
    C           PORAFA    ANDNE' '
     C                     SETON                     55
    C                     GOTO FORM05
F1  C                     END
    C** NATURE COMMANDE
    C****************************
     C                     MOVE 'NCDE'    ARGU
     C                     MOVE NATCDE    VALE      P
     C           CLPARA    CHAINPARAME               27
    C           *IN27     CABEQ'1'       FORM05
     C  N27                MOVELPXLIBE    LIBNCD    P
    C*
     C                     Z-ADDPRIXU     PRIPRI  92
     C                     Z-ADDPXS       PXSPXS  20
     C                     Z-ADDFRAISL    PLANCA  80
     C                     Z-ADDTYPOR     PORC    10
D1  C           QTOT      IFNE QTOT1
    C           QTFAB     ORNE QTFAB1
    C           QTPRE     ORNE QTPRE1
    C           QTREN     ORNE QTREN1
    C           TOTBOB    ORNE TOTBO1
    C           NBLIV     ORNE NBLIV1
    C           PRIXU     ORNE PRIPI1
    C           PXS       ORNE SXP
     C                     SETON                     13
     C                     MOVE '1'       ARTIGO  1
     C                     Z-ADDQTOT      QTOT1   80
     C                     Z-ADDQTFAB     QTFAB1  80
     C                     Z-ADDQTPRE     QTPRE1  80
     C                     Z-ADDQTREN     QTREN1  80
     C                     Z-ADDTOTBOB    TOTBO1  80
     C                     Z-ADDNBLIV     NBLIV1  20
     C                     Z-ADDFRLIV     FRLIV1  20
     C                     EXSR SPGR08
     C                     Z-ADDQTOT1     QTOT
     C                     Z-ADDQTFAB1    QTFAB
     C                     Z-ADDQTPRE1    QTPRE
     C                     Z-ADDQTREN1    QTREN
     C                     Z-ADDTOTBO1    TOTBOB
     C                     Z-ADDNBLIV1    NBLIV
     C                     Z-ADDFRLIV1    FRLIV
     C                     Z-ADDPORC      TYPOR
     C                     MOVE '0'       ARTIGO  1
     C                     SETOF                     13
F1  C                     END
     C                     Z-ADDQTOT      QTOT1   80
     C                     Z-ADDQTFAB     QTFAB1  80
     C                     Z-ADDQTPRE     QTPRE1  80
     C                     Z-ADDQTREN     QTREN1  80
     C                     Z-ADDTOTBOB    TOTBO1  80
     C                     Z-ADDNBLIV     NBLIV1  20
     C                     Z-ADDFRLIV     FRLIV1  20
     C                     MOVE PORAFA    PARAFA  1
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE PARAFA    PORAFA
     C                     Z-ADDQTOT1     QTOT
     C                     Z-ADDQTFAB1    QTFAB
     C                     Z-ADDQTPRE1    QTPRE
     C                     Z-ADDQTREN1    QTREN
     C                     Z-ADDTOTBO1    TOTBOB
     C                     Z-ADDNBLIV1    NBLIV
     C                     Z-ADDFRLIV1    FRLIV
     C                     Z-ADDPORC      TYPOR
D1  C           TYPOR     IFNE 3
     C                     MOVE *BLANKS   PORAFA
F1  C                     END
     C   90                MOVE CODMO1    CODMON
D1  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDPRIPRI    PRIUNS
     C                     Z-ADDPLANCA    PLANC
X1  C                     ELSE
     C                     Z-ADDPRIPRI    PRIMET
     C                     Z-ADDPLANCA    PLANET
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDPRIMET    TZO,1
     C                     Z-ADDPLANCA    TZO,2
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     PRIUNS
     C                     Z-ADDTZO,2     PLANC
     C                     EXSR SPCOUR
F1  C                     END
     C                     Z-ADDPXSPXS    PXS
     C                     MOVE LIBUS     POSTE
D1  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F1  C                     END
     C                     MOVE NATCDE    STOND
    C*
     C                     UPDATF2F2F2F2
    C*
     C           CLECD1    SETLLCARCDEL2
D1  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FINSO1
     C                     MOVE PORC      TYPOR
     C   90                MOVE CODMO1    CODMON
     C                     UPDATCARCDEF1
F1  C                     END
     C           FINSO1    TAG
    C*
D1  C           *IN90     IFEQ '1'
     C           CLECD1    SETLLCDEMATL1
D2  C                     DO   *HIVAL
     C           CLECD1    READECDEMATL1                 80
    C   80                GOTO FINSO2
     C   90                MOVE CODMO1    CODMON
     C                     UPDATCDEDDDDD
F2  C                     END
F1  C                     END
     C           FINSO2    TAG
    C**         ******    ***
     C                     EXSR RAZ2
    C                     ENDSR
     C/EJECT
    C           SPGR2A    BEGSR
     C           CLECD1    CHAINCDESL1               38
     C                     UPDATF2F2F2F2
    C*
     C                     SETOF                     7273
     C                     MOVE 'N'       FORCDE
D1  C           ZB11      IFEQ '*'                        RESERVATION
     C                     SETON                     73    PAPIER ?
     C                     MOVE 'O'       RPAP
F1  C                     END
D1  C           STFAC     IFEQ '*'
     C                     MOVE 'N'       RPAP
F1  C                     END
    C*
     C           CLEBES    SETLLBESOMAL5                 72 ERREUR LAIZ
    C*
     C                     MOVE *BLANKS   PROTO1
     C                     MOVE *BLANKS   PROTO2
     C                     MOVE *BLANKS   PROT
     C                     MOVELPROTO     TRU     1
D1  C           TRU       IFEQ 'P'
     C                     MOVE 'X'       PROTO2
F1  C                     END
D1  C           TRU       IFEQ 'T'
     C                     MOVE 'X'       PROTO1
F1  C                     END
     C                     MOVE *BLANKS   CODOBI
     C                     MOVE 'TOLERE  'CODOBI
     C           CLEOB2    SETLLCLIOBIL2
D1  C                     DO   2         OB      10
     C           CLEOB2    READECLIOBIL2                 38
    C         38          GOTO MATANT
D2  C           OB        IFEQ 1
     C                     MOVELLIBOBI    LIBOB1
     C                     Z-ADDRGRG11    RGFAC1
     C                     Z-ADDRGRG22    RGLIV1
F2  C                     END
D2  C           OB        IFEQ 2
     C                     MOVELLIBOBI    LIBOB2
     C                     Z-ADDRGRG11    RGFAC2
     C                     Z-ADDRGRG22    RGLIV2
F2  C                     END
F1  C                     END
     C           MATANT    TAG
    C**         ******    ***
     C           FORM5A    TAG
    C**         ******    ***
     C                     EXFMTF11
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
    C** VALIDATION TOLERENCE CLIENT
    C******************************
D1  C           PROTO1    IFNE *BLANKS
    C           PROTO2    ANDNE*BLANKS
     C                     SETON                     26
    C                     GOTO FORM5A
F1  C                     END
D1  C           MICLI     IFNE *ZEROS
    C           MACLI     ORNE *ZEROS
D2  C           PROTO1    IFNE *BLANKS
    C           PROTO2    ORNE *BLANKS
     C                     SETON                     26
    C                     GOTO FORM5A
F2  C                     END
F1  C                     END
D1  C           MICLI     IFNE *ZEROS
    C           MICLI     ANDLT1,00
     C                     SETON                     26
    C                     GOTO FORM5A
F1  C                     END
D1  C           MACLI     IFNE *ZEROS
    C           MACLI     ANDLT1,00
     C                     SETON                     26
    C                     GOTO FORM5A
F1  C                     END
    C**
D1  C           PROTO1    IFEQ *BLANKS
    C           PROTO2    ANDEQ*BLANKS
    C                     GOTO TESSU9
F1  C                     END
    C**
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D2  C           TIM,3     IFNE *ZEROS
     C                     MOVE '4'       PROT    2
F2  C                     END
D2  C           TIM,3     IFEQ *ZEROS
    C           TIM,4     ANDNE*ZEROS
     C                     MOVE '4'       PROT
F2  C                     END
D2  C           TIM,3     IFEQ *ZEROS
    C           TIM,4     ANDEQ*ZEROS
     C                     MOVE '3'       PROT
F2  C                     END
    C                     GOTO TESSU1
F1  C                     END
D1  C           ONDUL     IFEQ *ZEROS
    C           ONDUL     OREQ 7
    C           CCOL      OREQ 8
D2  C           TIM,3     IFEQ *ZEROS
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,3     IFNE *ZEROS
    C           TIM,3     ANDNE3
    C           TIM,3     ANDNE5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
X2  C                     ELSE
    C                     GOTO TESSU2
F2  C                     END
X1  C                     ELSE
D2  C           CCOL      IFEQ 9
    C                     GOTO TESSU3
X2  C                     ELSE
    C                     GOTO TESSU4
F2  C                     END
F1  C                     END
     C           TESSU3    TAG
    C**         ******    ***
D1  C           TIM,2     IFNE *ZEROS
    C           TIM,2     ANDNE3
    C           TIM,2     ANDNE5
    C                     GOTO TESSU1
F1  C                     END
D1  C           TIM,2     IFEQ 3
    C           TIM,2     OREQ 5
    C           TIM,2     OREQ *ZEROS
D2  C           TIM,6     IFEQ *ZEROS
    C           TIM,2     ANDEQ0
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFEQ *ZEROS
    C           TIM,2     ANDEQ3
    C           TIM,6     OREQ *ZEROS
    C           TIM,2     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFEQ 3
    C           TIM,6     OREQ 5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,6     IFNE *ZEROS
    C           TIM,6     ANDNE3
    C           TIM,6     ANDNE5
    C                     GOTO TESSU2
F2  C                     END
F1  C                     END
     C           TESSU4    TAG
    C**         ******    ***
D1  C           TIM,3     IFNE *ZEROS
    C           TIM,3     ANDNE3
    C           TIM,3     ANDNE5
    C                     GOTO TESSU2
F1  C                     END
D1  C           TIM,3     IFEQ *ZEROS
    C           TIM,3     OREQ 3
    C           TIM,3     OREQ 5
D2  C           TIM,5     IFEQ 0
    C           TIM,3     ANDEQ0
     C                     MOVE '3'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,5     IFEQ *ZEROS
    C           TIM,3     ANDEQ3
    C           TIM,5     OREQ *ZEROS
    C           TIM,3     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
D2  C           TIM,5     IFNE *ZEROS
    C           TIM,3     ANDNE3
    C           TIM,3     ANDNE5
    C                     GOTO TESSU2
F2  C                     END
D2  C           TIM,5     IFNE *ZEROS
    C           TIM,3     ANDEQ3
    C           TIM,5     ORNE *ZEROS
    C           TIM,3     ANDEQ5
     C                     MOVE '2'       PROT
    C                     GOTO TESSU1
F2  C                     END
F1  C                     END
     C           TESSU2    TAG
    C**         ******    ***
D1  C           FACON     IFEQ 8
     C                     MOVE '1'       PROT
    C                     GOTO TESSU1
X1  C                     ELSE
     C                     MOVE '2'       PROT
F1  C                     END
     C           TESSU1    TAG
D1  C           PROTO2    IFEQ *BLANKS
     C                     MOVEL'T'       PROT
X1  C                     ELSE
     C                     MOVEL'P'       PROT
F1  C                     END
     C           TESSU9    TAG
    C**         ******    ***
     C                     MOVE MICLI     MICLI1  42
     C                     MOVE MACLI     MACLI1  42
     C                     MOVE XAPPS     APPSX   1
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE APPSX     XAPPS
     C                     MOVE PROT      PROTO
     C                     MOVE MICLI1    MICLI
     C                     MOVE MACLI1    MACLI
     C                     MOVE LIBUS     POSTE
D1  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F1  C                     END
D1  C           FORCDE    IFEQ 'O'
     C                     MOVE '*'       STIMP
F1  C                     END
D1  C           RPAP      IFEQ 'N'
     C                     MOVE '*'       STFAC
X1  C                     ELSE
     C                     MOVE *BLANK    STFAC
F1  C                     END
     C                     UPDATF2F2F2F2
     C                     SETOF                     7273
    C                     ENDSR
     C/EJECT
    C           SPGR03    BEGSR
     C           CLECD1    CHAINCDESL1               38
     C                     Z-ADDSEQACH    SEACH
     C           CLEACH    CHAINCLIACHL1             38
     C           FORM06    TAG
    C**         ******    ***
     C                     EXFMTF12
D1  C           *IN05     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     SETOF                     54
     C                     CALL 'CLIE08£'
     C                     PARM           DSCOMM
    C           ZONE95    CABEQ'0'       FORM01
     C                     MOVE SEQACH    SEACH
     C           CLEACH    CHAINCLIACHL1             38
     C                     SETON                     54
    C                     GOTO FORM06
F1  C                     END
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
D1  C           *IN54     IFEQ '1'
     C                     SETOF                     54
     C                     MOVE SEACH     SEQACH
     C                     MOVE LIBUS     POSTE
D2  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F2  C                     END
     C                     UPDATF2F2F2F2
    C                     GOTO FIACHE
F1  C                     END
    C           FIACHE    ENDSR
     C/EJECT
    C           SPGR04    BEGSR
     C           CLESTA    CHAINCLIENTS1             38
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE COREGL    VALE
     C           CLPARA    CHAINPARAME               59
     C                     MOVELPXLIBE    LIBREG
D1  C           FDM       IFEQ 'F'
     C                     MOVE 'FDM'     LIBFDM
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBFDM
F1  C                     END
     C                     MOVE *BLANKS   LIAGES
D1  C           ESCPT     IFNE 0
     C                     MOVEL'ESCOMPTE'LIAGES
     C                     Z-ADDESCPT     ESCPTB
F1  C                     END
D1  C           AGIOS     IFNE 0
     C                     MOVEL'AGIOS   'LIAGES
     C                     Z-ADDAGIOS     ESCPTB
F1  C                     END
     C                     MOVE *BLANKS   LIBTAX
D1  C           CODTA     IFEQ 0
     C                     MOVEL'TVA 20,6'LIBTAX
F1  C                     END
D1  C           CODTA     IFEQ 1
     C                     MOVEL'EXPORT  'LIBTAX
F1  C                     END
D1  C           CODTA     IFEQ 2
     C                     MOVEL'EN SUSP.'LIBTAX
F1  C                     END
     C                     MOVE 'NON'     FACFRA
     C                     MOVE 'NON'     FACBOR
D1  C           FACFR     IFEQ '1'
     C                     MOVE 'OUI'     FACFRA
F1  C                     END
D1  C           EXPFA     IFEQ '1'
     C                     MOVE 'OUI'     FACBOR
F1  C                     END
     C                     MOVE *BLANKS   LIREGM
     C                     MOVE *BLANKS   LBFDM1
     C                     MOVE *BLANKS   LBTAXE
     C           CLECD1    CHAINCDESL1               38
D1  C           CREGS     IFNE *BLANKS
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE CREGS     VALE
     C           CLPARA    CHAINPARAME               59
     C                     MOVELPXLIBE    LIREGM
D2  C           FDMS      IFEQ 'F'
     C                     MOVE 'FDM'     LBFDM1
X2  C                     ELSE
     C                     MOVE *BLANKS   LBFDM1
F2  C                     END
F1  C                     END
     C                     MOVE *BLANKS   LBTAXE
D1  C           CODTA     IFEQ 0
     C                     MOVEL'TVA 20,6'LBTAXE
F1  C                     END
D1  C           CODTA     IFEQ 1
     C                     MOVEL'EXPORT  'LBTAXE
F1  C                     END
D1  C           CODTA     IFEQ 2
     C                     MOVEL'EN SUSP.'LBTAXE
F1  C                     END
     C                     MOVE 'NON'     FACFR1
     C                     MOVE 'NON'     FACBO1
D1  C           FACFRS    IFEQ '1'
     C                     MOVE 'OUI'     FACFR1
F1  C                     END
D1  C           EXPFAS    IFEQ '1'
     C                     MOVE 'OUI'     FACBO1
F1  C                     END
     C                     MOVE CLIFOU    FOUFOU
     C           FORM07    TAG
    C**         ******    ***
     C                     EXFMTF13
    C** SELECTION DU CODE REGLEMENT
    C******************************
D1  C           *IN05     IFEQ '1'
     C                     MOVE *BLANKS   DATA
     C                     Z-ADD*ZEROS    IND
     C                     Z-ADD*ZEROS    AG
     C                     MOVE *BLANKS   CODOB
     C                     MOVE *HIVAL    REG
     C                     CALL 'RECHER£'
     C                     PARM           DATA
D2  C           REG       IFNE *BLANKS
     C                     MOVE REG       CREGS
F2  C                     END
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE CREGS     VALE
     C           CLPARA    CHAINPARAME               59
     C                     MOVELPXLIBE    LIREGM
    C                     GOTO FORM07
F1  C                     END
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
D1  C           CREGS     IFNE *BLANKS
     C                     MOVE 'MRGC'    ARGU
     C                     MOVE *BLANKS   VALE
     C                     MOVE CREGS     VALE
     C           CLPARA    CHAINPARAME               64
    C   64                GOTO FORM07
F1  C                     END
     * NE PAS RENSEIGNE SI ECHEANCE A ZERO
     * -----------------------------------
     C                     MOVE '0'       *IN32
     C                     MOVE '0'       *IN20
D1  C           CECHES    IFEQ *ZERO
    C           LBFDM1    ANDNE*BLANKS
     C                     MOVE '1'       *IN32
    C                     GOTO FORM07
F1  C                     END
     *
D1  C           LBFDM1    IFNE *BLANKS
    C           LBFDM1    ANDNE'FDM'
     C                     MOVE '1'       *IN20
    C                     GOTO FORM07
F1  C                     END
D1  C           CODTA     IFEQ 1
     C                     EXSR SPGR07
F1  C                     END
D1  C           CODTA     IFNE 1
     C           CLECD1    SETLLCDEXPOL1
D2  C                     DO   *HIVAL
     C           CLECD1    READECDEXPOL1                 80
    C   80                GOTO FEXPO
     C                     MOVE *BLANKS   NOMTRA
     C                     MOVE *BLANKS   RAITRA
     C                     MOVE *BLANKS   RUETRA
     C                     MOVE *BLANKS   VILTRA
     C                     MOVE *BLANKS   DEPTRA
     C                     MOVE *BLANKS   CPTRA
     C                     MOVE *BLANKS   BDTRA
     C                     MOVE *BLANKS   CPAYTR
     C                     MOVE *BLANKS   PAYTRA
     C                     MOVE *BLANKS   CONDEX
     C                     MOVE *BLANKS   NBFAC
     C                     MOVE *BLANKS   CODMON
     C                     MOVE *BLANKS   PRIMET
     C                     MOVE *BLANKS   PLANET
     C                     MOVE *BLANKS   EXPO1
     C                     MOVE *BLANKS   EXPO2
     C                     DELETCDEXPOF1
F2  C                     END
F1  C                     END
     C           FEXPO     TAG
D1  C           CREGS     IFEQ '04'
    C           CECHES    ANDEQ0
    C           CREGS     OREQ '05'
    C           CECHES    ANDEQ0
    C           CREGS     OREQ '09'
    C           CECHES    ANDEQ0
    C           CREGS     OREQ '14'
    C           CECHES    ANDEQ0
     C                     MOVE '1'       *IN60
    C                     GOTO FORM07
F1  C                     END
D1  C           CREGS     IFEQ '16'
    C           CECHES    ANDNE0
     C                     MOVE '1'       *IN61
    C                     GOTO FORM07
F1  C                     END
D1  C           ESCOMS    IFNE 0
    C           AGIOSS    ANDNE0
     C                     MOVE '1'       *IN62
    C                     GOTO FORM07
F1  C                     END
D1  C           CREGS     IFEQ *BLANKS
    C           CECHES    ANDNE*ZEROS
     C                     SETON                     64
    C                     GOTO FORM07
F1  C                     END
D1  C           CREGS     IFEQ *BLANKS
    C           AGIOSS    ANDNE*ZEROS
     C                     SETON                     64
    C                     GOTO FORM07
F1  C                     END
D1  C           CREGS     IFEQ *BLANKS
    C           ESCOMS    ANDNE*ZEROS
     C                     SETON                     64
    C                     GOTO FORM07
F1  C                     END
D1  C           CREGS     IFEQ *BLANKS
    C           VALSUS    ANDNE*ZEROS
     C                     SETON                     64
    C                     GOTO FORM07
F1  C                     END
D1  C           LBFDM1    IFEQ 'FDM'
     C                     MOVE 'F'       FDMS
X1  C                     ELSE
     C                     MOVE ' '       FDMS
F1  C                     END
    C** REMPLACEMENT DES ZONES SI SAISIES
    C************************************
D1  C           FACBO1    IFEQ 'OUI'
     C                     MOVE '1'       EXPFAS
X1  C                     ELSE
     C                     MOVE '0'       EXPFAS
F1  C                     END
D1  C           FACFR1    IFEQ 'OUI'
     C                     MOVE '1'       FACFRS
X1  C                     ELSE
     C                     MOVE '0'       FACFRS
F1  C                     END
     C                     MOVE FOUFOU    CLIFOU
     C                     MOVE LIBUS     POSTE
D1  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F1  C                     END
     C                     UPDATF2F2F2F2
    C                     ENDSR
     C/EJECT
    C           SPGR05    BEGSR
     C                     MOVE *BLANKS   LIB01
     C                     MOVE *BLANKS   LIB02
     C                     MOVE *BLANKS   LIB03
     C                     MOVE *BLANKS   LIB04
     C                     MOVE *BLANKS   LIB05
     C                     MOVE *BLANKS   LIB06
     C                     MOVE *BLANKS   LIB07
     C                     MOVE *BLANKS   LIB08
     C                     MOVE *BLANKS   LIB09
     C                     MOVE *BLANKS   LIB10
     C                     MOVE *BLANKS   LIB11
     C                     MOVE *BLANKS   LIB12
     C                     MOVE *BLANKS   LIB13
     C                     Z-ADD*ZEROS    LIB12B
     C           CLECD1    SETLLCDEOBSL2
D1  C                     DO   *HIVAL
     C           CLECD1    READECDEOBSL2                 38
    C         38          GOTO AFFI14
D2  C           SEQOBS    IFEQ 1
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB01
F2  C                     END
D2  C           SEQOBS    IFEQ 2
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB02
F2  C                     END
D2  C           SEQOBS    IFEQ 3
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB03
F2  C                     END
D2  C           SEQOBS    IFEQ 4
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB04
F2  C                     END
D2  C           SEQOBS    IFEQ 5
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB05
F2  C                     END
D2  C           SEQOBS    IFEQ 6
    C           TYPOBS    ANDEQ'C'
     C                     MOVE OBSERV    LIB06
F2  C                     END
D2  C           TYPOBS    IFEQ 'M'
     C                     MOVE OBSERV    LIB07
F2  C                     END
D2  C           SEQOBS    IFEQ 1
    C           TYPOBS    ANDEQ'I'
     C                     MOVE OBSERV    LIB08
F2  C                     END
D2  C           SEQOBS    IFEQ 2
    C           TYPOBS    ANDEQ'I'
     C                     MOVE OBSERV    LIB09
F2  C                     END
D2  C           SEQOBS    IFEQ 3
    C           TYPOBS    ANDEQ'I'
     C                     MOVE OBSERV    LIB10
F2  C                     END
D2  C           SEQOBS    IFEQ 4
    C           TYPOBS    ANDEQ'I'
     C                     MOVE OBSERV    LIB11
F2  C                     END
D2  C           TYPOBS    IFEQ 'A'
     C                     MOVE OBSERV    LIB12
F2  C                     END
D2  C           SEQOBS    IFEQ 1
    C           TYPOBS    ANDEQ'F'
     C                     MOVE OBSERV    LIB13
F2  C                     END
F1  C                     END
     C           AFFI14    TAG
     C                     EXFMTF14
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
    C********  RECHERCHE OBSERVATION DU CLIENT *******************
D1  C           *IN20     IFEQ '1'
    C*
     C                     MOVEA*IN       IN     99
     C                     SETON                     93
     C                     SETOF                     92
     C                     WRITEF51
     C                     SETOF                     9293
    C*
     C                     MOVE *BLANKS   CODOBI
     C                     Z-ADD*ZEROS    EDAFF
     C                     MOVEL'CLIENT'  PROCLI
     C           CLESTA    SETLLCLIOBIL2
     C                     SETOF                       9194
     C                     Z-ADD*ZEROS    LIG     40
     C           ST021     TAG
    C*          ---------------
D2  C                     DO   13
     C                     SETOF                     50
     C           CLESTA    READECLIOBIL2                 50
D3  C           *IN,50    IFEQ '1'
     C                     SETON                     94
    C                     GOTO ST022
F3  C                     END
     C                     ADD  1         LIG
     C                     SETON                     91
     C                     MOVE *BLANKS   SELO
     C                     WRITEF50
F2  C                     END
     C           ST022     TAG
    C*          ---------------
     C                     Z-ADDLIG       RG
     C                     SETON                     92
     C                     WRITEF52
     C                     EXFMTF51
    C   03N50             GOTO ST021
    C*
D2  C   91                DO   *HIVAL
     C                     READCF50                      50
    C   50                GOTO ST023
D3  C           SELO      IFEQ 1
     C                     MOVELLIBOBI    LIB01
F3  C                     END
D3  C           SELO      IFEQ 2
     C                     MOVELLIBOBI    LIB02
F3  C                     END
D3  C           SELO      IFEQ 3
     C                     MOVELLIBOBI    LIB03
F3  C                     END
D3  C           SELO      IFEQ 4
     C                     MOVELLIBOBI    LIB04
F3  C                     END
D3  C           SELO      IFEQ 5
     C                     MOVELLIBOBI    LIB05
F3  C                     END
D3  C           SELO      IFEQ 6
     C                     MOVELLIBOBI    LIB06
F3  C                     END
D3  C           SELO      IFEQ 7
     C                     MOVELLIBOBI    LIB07
F3  C                     END
F2  C                     END
    C*
     C           ST023     TAG
     C                     MOVEAIN        *IN
    C                     GOTO AFFI14
    C*
F1  C                     END
    C*********************************************
D1  C           *IN10     IFEQ '1'
     C           CLECD1    SETLLCDEOBSL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECDEOBSL2                 38
    C         38          GOTO ECROBS
     C                     DELETCDEOBSFF
F2  C                     END
     C           ECROBS    TAG
D2  C           LIB01     IFNE *BLANKS
     C                     MOVE LIB01     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 1         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB02     IFNE *BLANKS
     C                     MOVE LIB02     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 2         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB03     IFNE *BLANKS
     C                     MOVE LIB03     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 3         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB04     IFNE *BLANKS
     C                     MOVE LIB04     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 4         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB05     IFNE *BLANKS
     C                     MOVE LIB05     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 5         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB06     IFNE *BLANKS
     C                     MOVE LIB06     OBSERV
     C                     MOVE 'C'       TYPOBS
     C                     MOVE 6         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB07     IFNE *BLANKS
     C                     MOVE LIB07     OBSERV
     C                     MOVE *BLANKS   CODOBS
     C                     MOVE 'M'       TYPOBS
     C                     MOVE 7         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB08     IFNE *BLANKS
     C                     MOVE LIB08     OBSERV
     C                     MOVE 'I'       TYPOBS
     C                     MOVE 1         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB09     IFNE *BLANKS
     C                     MOVE LIB09     OBSERV
     C                     MOVE 'I'       TYPOBS
     C                     MOVE 2         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB10     IFNE *BLANKS
     C                     MOVE LIB10     OBSERV
     C                     MOVE 'I'       TYPOBS
     C                     MOVE 3         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB11     IFNE *BLANKS
     C                     MOVE LIB11     OBSERV
     C                     MOVE 'I'       TYPOBS
     C                     MOVE 4         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB12B    IFNE *ZEROS
     C                     MOVE LIB12     OBSERV
     C                     MOVE 'A'       TYPOBS
     C                     MOVE 8         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
D2  C           LIB13     IFNE *BLANKS
     C                     MOVE LIB13     OBSERV
     C                     MOVE 'F'       TYPOBS
     C                     MOVE 1         SEQOBS
     C                     WRITECDEOBSFF
F2  C                     END
     C           CLECD1    CHAINCDESL1               38
D2  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F2  C                     END
     C                     UPDATF2F2F2F2
    C                     GOTO FINOB
F1  C                     END
    C                     GOTO AFFI14
    C           FINOB     ENDSR
     C/EJECT
    C           SPGR06    BEGSR
D1  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
    C                     GOTO FORM19
X1  C                     ELSE
    C** POUR CODE DIFFERENTS MAIS AVEC IMPRESSION AFFICHAGE
    C******************************************************
     C                     XFOOTTIM       TIMZON  20
     C                     XFOOTTRE       TIMZOR  20
     C                     ADD  TIMZOR    TIMZON
    C           TIMZON    CABNE0         FORM19
F1  C                     END
     C           FORM19    TAG
    C**         ******    ***
    C** RECHERCHE DE L IMPRESSION PRINCIPALE
    C***************************************
D1  C           TIM,3     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,3     EXT     10
     C                     MOVE COU,3     COUPEX  1
    C                     GOTO IMPRES
F1  C                     END
D1  C           TIM,2     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,2     EXT     10
     C                     MOVE COU,3     COUPEX
    C                     GOTO IMPRES
F1  C                     END
D1  C           TIM,1     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,1     EXT     10
     C                     MOVE COU,1     COUPEX
F1  C                     END
     C           IMPRES    TAG
    C**         ******    ***
D1  C           TIM,4     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,4     INT     10
     C                     MOVE COU,4     COUPIN  1
    C                     GOTO IMPRE1
F1  C                     END
D1  C           TIM,5     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,5     INT     10
     C                     MOVE COU,5     COUPIN
    C                     GOTO IMPRE1
F1  C                     END
D1  C           TIM,6     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,6     INT     10
     C                     MOVE COU,6     COUPIN
    C                     GOTO IMPRE1
F1  C                     END
D1  C           TIM,7     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,7     INT     10
     C                     MOVE COU,7     COUPIN
F1  C                     END
     C           IMPRE1    TAG
    C**         ******    ***
     C           CLAPRO    CHAINPRODUI2              38
     C                     MOVE *IN17     IN17
D1  C           *IN38     IFEQ '0'
     C           CLAPRO    CHAINCOMPREL2             17
     C        N17          MOVE GARGAR    GARNT
F1  C                     END
     C                     MOVE IN17      *IN17
D1  C           *IN38     IFEQ '1'
     C           CLAPRO    CHAINRECAPT               38
     C        N38          MOVE 'RE'      GARNT
F1  C                     END
    C**         ******    ***
D1  C           REFDOR    IFNE *BLANKS
     C                     SETON                     66
F1  C                     END
D1  C           GFRA      IFNE *BLANKS
     C                     SETON                     67
     C                     MOVE 'RT'      USGAUF  2
X1  C                     ELSE
     C                     MOVE '  '      USGAUF
F1  C                     END
D1  C           USINE     IFNE *ZEROS
     C                     SETON                     68
F1  C                     END
D1  C           FACON     IFNE 7
    C           FACON     ANDNE6
    C           FACON     ANDNE8
     C                     SETOF                     68
F1  C                     END
    C** RECHERCHE DE L IMPRESSION REPRISE
    C************************************
D1  C           TRE,1     IFNE 0
     C                     MOVE TRE,1     EXT     10
     C                     SETON                     64
F1  C                     END
D1  C           TRE,2     IFNE 0
     C                     MOVE TRE,2     EXT     10
     C                     SETON                     64
F1  C                     END
D1  C           TRE,3     IFNE 0
     C                     MOVE TRE,3     EXT     10
     C                     SETON                     64
F1  C                     END
D1  C           TRE,4     IFNE 0
     C                     SETON                     65
     C                     MOVE TRE,4     INT     10
F1  C                     END
D1  C           TRE,5     IFNE 0
     C                     MOVE TRE,5     INT     10
     C                     SETON                     65
F1  C                     END
D1  C           TRE,6     IFNE 0
     C                     MOVE TRE,6     INT     10
     C                     SETON                     65
F1  C                     END
D1  C           TRE,7     IFNE 0
     C                     MOVE TRE,7     INT     10
     C                     SETON                     65
F1  C                     END
    C** SI AFFICHES
    C**********************************
     C                     Z-ADDNOPRO     PRODOR
     C           CLEPR3    SETLLPRODS3L1
     C           STPR3     TAG
     C           CLEPR3    READEPRODS3L1                 86
D1  C           *IN86     IFEQ '0'
D2  C           GAUF1     IFNE *BLANKS
     C                     SETON                     67
     C                     MOVE 'RT'      USGAUF
F2  C                     END
D2  C           SUPOR     IFEQ 'E'
D3  C           IMPA      IFNE *ZEROS
     C                     SETON                     64
     C                     Z-ADDIMPA      EXT
     C                     Z-ADDUSA       USEXT
F3  C                     END
X2  C                     ELSE
D3  C           IMPA      IFNE *ZEROS
     C                     SETON                     65
     C                     Z-ADDIMPA      INT
     C                     Z-ADDUSA       USINT
F3  C                     END
F2  C                     END
    C                     GOTO STPR3
F1  C                     END
    C** AFFICHAGE DES USINES
    C***********************
D1  C           USEXT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USEXT     VALE      P
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXABRG    USIMEX  2
F1  C                     END
D1  C           USINT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINT     VALE      P
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXABRG    USIMIN  2
F1  C                     END
    C** TEST SI EXISTANCE D ENREGISTREMENTS DANS CDEMATL1
    C****************************************************
     C           CLECD1    CHAINCDEMATL1             81
D1  C           *IN81     IFEQ '0'
     C           CLECD1    SETLLCDEMATL1
D2  C                     DO   *HIVAL
     C           CLECD1    READECDEMATL1                 80
    C   80                GOTO SUISI1
    C** EXTERIEUR
    C************
D3  C           CODMAT    IFEQ 'IE'
     C                     MOVE STATUM    STMEX1
D4  C           STATUM    IFEQ 0
     C                     MOVE 3         STMEX1
F4  C                     END
D4  C           CODFAM    IFEQ '2'
     C                     MOVE 'NON'     FACME1
F4  C                     END
D4  C           CODFAM    IFEQ '1'
     C                     MOVE 'OUI'     FACME1
F4  C                     END
D4  C           CODMON    IFNE 'EUR'
     C                     Z-ADDMATETR    MONMAX
X4  C                     ELSE
     C                     Z-ADDMONMAT    MONMAX
F4  C                     END
     C                     MOVE FRINCS    FRINCX
     C                     MOVE MATSTE    MATSTX
     C                     MOVE MATCLI    MATCLX
     C                     MOVE MATFAC    MATFAX
F3  C                     END
    C** INTERIEUR
    C************
D3  C           CODMAT    IFEQ 'II'
     C                     MOVE STATUM    STMINX
D4  C           STATUM    IFEQ 0
     C                     MOVE 3         STMINX
F4  C                     END
D4  C           CODFAM    IFEQ '1'
     C                     MOVE 'OUI'     FACMIN
F4  C                     END
D4  C           CODFAM    IFEQ '2'
     C                     MOVE 'NON'     FACMIN
F4  C                     END
D4  C           CODMON    IFNE 'EUR'
     C                     Z-ADDMATETR    MONMAI
X4  C                     ELSE
     C                     Z-ADDMONMAT    MONMAI
F4  C                     END
     C                     MOVE FRINCS    FRINCI
     C                     MOVE MATSTE    MATSTI
     C                     MOVE MATCLI    MATCIN
     C                     MOVE MATFAC    MATFAI
F3  C                     END
    C** GAUFRAGE
    C***********
D3  C           CODMAT    IFEQ 'GA'
     C                     MOVE STATUM    STMGAX
D4  C           STATUM    IFEQ 0
     C                     MOVE 3         STMGAX
F4  C                     END
D4  C           CODFAM    IFEQ '1'
     C                     MOVE 'OUI'     FACMGA
F4  C                     END
D4  C           CODFAM    IFEQ '2'
     C                     MOVE 'NON'     FACMGA
F4  C                     END
D4  C           CODMON    IFNE 'EUR'
     C                     Z-ADDMATETR    MONMAG
X4  C                     ELSE
     C                     Z-ADDMONMAT    MONMAG
F4  C                     END
     C                     MOVE FRINCS    FRINCG
     C                     MOVE MATSTE    MATSTG
     C                     MOVE MATCLI    MATCLG
     C                     MOVE MATFAC    MATFAG
F3  C                     END
    C** DORURE
    C*********
D3  C           CODMAT    IFEQ 'DO'
     C                     MOVE STATUM    STMGOX
D4  C           STATUM    IFEQ 0
     C                     MOVE 3         STMGOX
F4  C                     END
D4  C           CODFAM    IFEQ '1'
     C                     MOVE 'OUI'     FACMDO
F4  C                     END
D4  C           CODFAM    IFEQ '2'
     C                     MOVE 'NON'     FACMDO
F4  C                     END
D4  C           CODMON    IFNE 'EUR'
     C                     Z-ADDMATETR    MONMAD
X4  C                     ELSE
     C                     Z-ADDMONMAT    MONMAD
F4  C                     END
     C                     MOVE FRINCS    FRINCD
     C                     MOVE MATSTE    MATSTD
     C                     MOVE MATCLI    MATCLD
     C                     MOVE MATFAC    MATFAD
F3  C                     END
    C** DECOUPAGE
    C************
D3  C           CODMAT    IFEQ 'FO'
     C                     MOVE STATUM    STMDEX
D4  C           STATUM    IFEQ 0
     C                     MOVE 3         STMDEX
F4  C                     END
D4  C           CODFAM    IFEQ '1'
     C                     MOVE 'OUI'     FACMDE
F4  C                     END
D4  C           CODFAM    IFEQ '2'
     C                     MOVE 'NON'     FACMDE
F4  C                     END
D4  C           CODMON    IFNE 'EUR'
     C                     Z-ADDMATETR    MONMDE
X4  C                     ELSE
     C                     Z-ADDMONMAT    MONMDE
F4  C                     END
     C                     MOVE FRINCS    FRINDE
     C                     MOVE MATSTE    MATSDE
     C                     MOVE MATCLI    MATCLE
     C                     MOVE MATFAC    MATFAE
F3  C                     END
F2  C                     END
F1  C                     END
     C           SUISI1    TAG
    C**         ******    ***
    C** FORMATAGE DE F19
    C*******************
D1  C           STMEX1    IFEQ 0
     C                     MOVE 3         STMEX1
F1  C                     END
D1  C           STMINX    IFEQ 0
     C                     MOVE 3         STMINX
F1  C                     END
D1  C           STMGAX    IFEQ 0
     C                     MOVE 3         STMGAX
F1  C                     END
D1  C           STMGOX    IFEQ 0
     C                     MOVE 3         STMGOX
F1  C                     END
D1  C           STMDEX    IFEQ 0
     C                     MOVE 3         STMDEX
F1  C                     END
     C  N64N65N66
    CANN67N68             GOTO FENDSR
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      71
     C                     EXFMTF19
     C                     MOVE REF71     *IN71
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
    C** TEST SI STATUT MATERIEL SAISI
    C********************************
    C* EXTERIEUR
    C***********
D1  C           *IN64     IFEQ '1'
     C                     MOVE '1'       TTA
     C                     MOVE DSEXT     DSGEN
     C                     EXSR TESGEN
    C   14                GOTO SUISI1
    C   25                GOTO SUISI1
    C   35                GOTO SUISI1
    C   40                GOTO SUISI1
    C   45                GOTO SUISI1
    C   55                GOTO SUISI1
    C   24                GOTO SUISI1
    C   50                GOTO SUISI1
F1  C                     END
    C* INTERIEUR
    C***********
D1  C           *IN65     IFEQ '1'
     C                     MOVE '2'       TTB
     C                     MOVE DSINT     DSGEN
     C                     EXSR TESGEN
    C   15                GOTO SUISI1
    C   26                GOTO SUISI1
    C   36                GOTO SUISI1
    C   41                GOTO SUISI1
    C   46                GOTO SUISI1
    C   56                GOTO SUISI1
    C   51                GOTO SUISI1
    C   74                GOTO SUISI1
F1  C                     END
D1  C           *IN66     IFEQ '1'
     C                     MOVE DSDOR     DSGEN
     C                     MOVE '5'       TTE
     C                     EXSR TESGEN
    C   17                GOTO SUISI1
    C   76                GOTO SUISI1
    C   27                GOTO SUISI1
    C   37                GOTO SUISI1
    C   42                GOTO SUISI1
    C   47                GOTO SUISI1
    C   57                GOTO SUISI1
    C   52                GOTO SUISI1
F1  C                     END
    C* GAUFRAGE
    C**********
D1  C           *IN67     IFEQ '1'
     C                     MOVE DSGAU     DSGEN
     C                     MOVE '3'       TTC
     C                     EXSR TESGEN
    C   18                GOTO SUISI1
    C   28                GOTO SUISI1
    C   38                GOTO SUISI1
    C   43                GOTO SUISI1
    C   48                GOTO SUISI1
    C   58                GOTO SUISI1
    C   53                GOTO SUISI1
    C   83                GOTO SUISI1
F1  C                     END
    C* DECOUPAGE
    C***********
D1  C           *IN68     IFEQ '1'
     C                     MOVE '4'       TTD
     C                     MOVE DSDEC     DSGEN
     C                     EXSR TESGEN
    C   23                GOTO SUISI1
    C   29                GOTO SUISI1
    C   39                GOTO SUISI1
    C   44                GOTO SUISI1
    C   49                GOTO SUISI1
    C   59                GOTO SUISI1
    C   54                GOTO SUISI1
    C   31                GOTO SUISI1
F1  C                     END
     *
     * CONTRÔLE DES % DE FRAIS INCLUS PAR RAPPORT AU TOTAL PRODUIT
     *
     C                     Z-ADDFRINCX    WINCLU
     C                     ADD  FRINCI    WINCLU
     C                     ADD  FRINCD    WINCLU
     C                     ADD  FRINCG    WINCLU
     C                     ADD  FRINDE    WINCLU
D1  C           INCLU     IFNE 0
    C           WINCLU    ANDNEINCLU
     C                     MOVE '1'       *IN79
    C                     GOTO SUISI1
F1  C                     END
     *
D1  C           CLIMAT    IFEQ *BLANKS
    C           DATMAT    ANDNE*ZEROS
     C                     SETON                     86
    C                     GOTO SUISI1
F1  C                     END
D1  C           DATMAT    IFNE *ZEROS
     C           CLECA2    CHAINCALENAL0             87
    C         87          GOTO SUISI1
     C                     Z-ADDCALSS     COMATS
    C           DATMAT    CABGTDATSYS    SUISI1     87
     C                     MOVE CLIMAT    CLIMA1 20
     C                     MOVE COMATJ    COMAJ   20
     C                     MOVE COMATM    COMAM   20
     C                     MOVE COMATA    COMAA   20
     C                     MOVE COMATS    COMAS   20
F1  C                     END
     C           CLECD1    SETLLCDEMATL1
D1  C                     DO   *HIVAL
     C           CLECD1    READECDEMATL1                 80
    C   80                GOTO SUASU1
     C                     DELETCDEDDDDD
F1  C                     END
     C           SUASU1    TAG
    C**         ******    ***
     C                     MOVE CLIMA1    CLIMAT
     C                     MOVE COMAJ     COMATJ
     C                     MOVE COMAM     COMATM
     C                     MOVE COMAA     COMATA
     C                     MOVE COMAS     COMATS
    C** EXTERIEURE
    C*************
D1  C           STMEX1    IFEQ 1
    C           STMEX1    OREQ 2
    C           STMEX1    OREQ 4
    C           STMEX1    OREQ 3
    C           FRINCX    ANDNE0
     C                     MOVE STMEX1    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACME1    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
D2  C           FACME1    IFEQ 'NON'
     C                     MOVE '2'       CODFAM
F2  C                     END
     C                     MOVE 'IE'      CODMAT
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDMONMAX    MONMAT
X2  C                     ELSE
     C                     Z-ADDMONMAX    MATETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMATETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
F2  C                     END
     C                     MOVE FRINCX    FRINCS
     C                     MOVE MATSTX    MATSTE
     C                     MOVE MATCLX    MATCLI
     C                     MOVE MATFAX    MATFAC
     C                     WRITECDEMATF1
F1  C                     END
    C** INTERIEUR
    C************
D1  C           STMINX    IFEQ 1
    C           STMINX    OREQ 2
    C           STMINX    OREQ 4
    C           STMINX    OREQ 3
    C           FRINCI    ANDNE0
     C                     MOVE STMINX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMIN    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
D2  C           FACMIN    IFEQ 'NON'
     C                     MOVE '2'       CODFAM
F2  C                     END
     C                     MOVE 'II'      CODMAT
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDMONMAI    MONMAT
X2  C                     ELSE
     C                     Z-ADDMONMAI    MATETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMATETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
F2  C                     END
     C                     MOVE FRINCI    FRINCS
     C                     MOVE MATSTI    MATSTE
     C                     MOVE MATCIN    MATCLI
     C                     MOVE MATFAI    MATFAC
     C                     WRITECDEMATF1
F1  C                     END
    C** GAUFFRAGE
    C************
D1  C           STMGOX    IFEQ 1
    C           STMGOX    OREQ 2
    C           STMGOX    OREQ 4
    C           STMGOX    OREQ 3
    C           FRINCD    ANDNE0
     C                     MOVE STMGOX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMDO    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
D2  C           FACMDO    IFEQ 'NON'
     C                     MOVE '2'       CODFAM
F2  C                     END
     C                     MOVE 'DO'      CODMAT
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDMONMAD    MONMAT
X2  C                     ELSE
     C                     Z-ADDMONMAD    MATETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMATETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
F2  C                     END
     C                     MOVE FRINCD    FRINCS
     C                     MOVE MATSTD    MATSTE
     C                     MOVE MATCLD    MATCLI
     C                     MOVE MATFAD    MATFAC
     C                     WRITECDEMATF1
F1  C                     END
    C** DORURE
    C*********
D1  C           STMGAX    IFEQ 1
    C           STMGAX    OREQ 2
    C           STMGAX    OREQ 4
    C           STMGAX    OREQ 3
    C           FRINCG    ANDNE0
     C                     MOVE STMGAX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMGA    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
D2  C           FACMGA    IFEQ 'NON'
     C                     MOVE '2'       CODFAM
F2  C                     END
     C                     MOVE 'GA'      CODMAT
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDMONMAG    MONMAT
X2  C                     ELSE
     C                     Z-ADDMONMAG    MATETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMATETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
F2  C                     END
     C                     MOVE FRINCG    FRINCS
     C                     MOVE MATSTG    MATSTE
     C                     MOVE MATCLG    MATCLI
     C                     MOVE MATFAG    MATFAC
     C                     WRITECDEMATF1
F1  C                     END
    C** DECOUPAGE
    C************
D1  C           STMDEX    IFEQ 1
    C           STMDEX    OREQ 2
    C           STMDEX    OREQ 4
    C           STMDEX    OREQ 3
    C           FRINDE    ANDNE0
     C                     MOVE STMDEX    STATUM
     C                     MOVE *BLANKS   CODFAM
D2  C           FACMDE    IFEQ 'OUI'
     C                     MOVE '1'       CODFAM
F2  C                     END
D2  C           FACMDE    IFEQ 'NON'
     C                     MOVE '2'       CODFAM
F2  C                     END
     C                     MOVE 'FO'      CODMAT
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDMONMDE    MONMAT
X2  C                     ELSE
     C                     Z-ADDMONMDE    MATETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDMATETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     MONMAT
     C                     EXSR SPCOUR
F2  C                     END
     C                     MOVE FRINDE    FRINCS
     C                     MOVE MATSDE    MATSTE
     C                     MOVE MATCLE    MATCLI
     C                     MOVE MATFAE    MATFAC
     C                     WRITECDEMATF1
F1  C                     END
     * MISE A JOUR AU BESOIN DU % DES FRAIS INCLUS DANS LE PRODUIT :
     *
D1  C           INCLU     IFEQ 0
    C           WINCLU    ANDNE0
     C           TAGERR    TAG
     C           CLEPLA    CHAINPRODUL0              2381
D2  C           *IN81     IFEQ '1'
     C                     EXFMTFERR
    C                     GOTO TAGERR
F2  C                     END
     C                     Z-ADDWINCLU    INCLU
     C                     EXCPTMAJPRO
F1  C                     END
    C           FENDSR    ENDSR
     C/EJECT
    C*****************************************************
    C** SOUS PROGRAMME DE TEST DE SAISIE MATERIEL F14    *
    C*****************************************************
    C           TESGEN    BEGSR
     C                     SETOF                     3839
    C** STATUT MATERIEL SAISI ?
    C**************************
D1  C           STMGEN    IFEQ 0
D2  C           TTG       IFEQ TTA
     C   64                SETON                     35
    C   35                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     36
    C   36                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     38
    C   38                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     39
    C   39                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTE
     C   66                SETON                     37
    C   37                GOTO FINTES
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT SAISIE ?
    C******************************
D1  C           STMGEN    IFEQ 1
    C           STMGEN    OREQ 2
D2  C           FACGEN    IFEQ *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     40
    C   40                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     41
    C   41                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     42
    C   42                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     43
    C   43                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     44
    C   44                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT = NON ET MONTANT SAISI
    C********************************************
D1  C           FACGEN    IFEQ 'NON'
    C           MONGEN    ANDNE*ZEROS
D2  C           TTG       IFEQ TTA
     C   64                SETON                     45
    C   45                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     46
    C   46                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTE
     C   66                SETON                     47
    C   47                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     48
    C   48                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     49
    C   49                GOTO FINTES
F2  C                     END
F1  C                     END
    C** SI FACT AUTRE CLIENT VERIF DE SON EXISTANCE
    C**********************************************
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFNE 0
     C           CLETES    CHAINCLIFACL3             38
D4  C           *IN38     IFEQ '1'
    C* CLIENT OU SEQUENCE INCONNU
    C****************************
D5  C           TTG       IFEQ TTA
     C         64          SETON                     55
    C         55          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTB
     C         65          SETON                     56
    C         56          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTE
     C         66          SETON                     57
    C         57          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTC
     C         67          SETON                     58
    C         58          GOTO FINTES
F5  C                     END
D5  C           TTG       IFEQ TTD
     C         68          SETON                     59
    C         59          GOTO FINTES
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C* SAISIE INCOMPLETE
    C*******************
D1  C           MATGE1    IFEQ 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFEQ 0
D2  C           MATGE2    IFEQ 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFEQ 0
D3  C           MATGE3    IFNE 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           MATGE1    IFNE 0
D2  C           MATGE2    IFNE 0
D3  C           MATGE3    IFEQ 0
D4  C           TTG       IFEQ TTA
     C         64          SETON                     25
    C         25          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTB
     C         65          SETON                     26
    C         26          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTC
     C         67          SETON                     28
    C         28          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTE
     C         66          SETON                     27
    C         27          GOTO FINTES
F4  C                     END
D4  C           TTG       IFEQ TTD
     C         68          SETON                     29
    C         29          GOTO FINTES
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C** TEST SI STATUT = 3
    C*********************
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           FACGEN    IFNE *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MONGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE1    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE2    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 3
    C           STMGEN    OREQ 0
D2  C           MATGE3    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     50
    C   50                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     51
    C   51                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     52
    C   52                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     53
    C   53                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     54
    C   54                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C** TEST SI STATUT = 4
    C*********************
D1  C           STMGEN    IFEQ 4
D2  C           FACGEN    IFNE *BLANKS
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MONGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE1    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE2    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           MATGE3    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           STMGEN    IFEQ 4
D2  C           FRIGEN    IFNE 0
D3  C           TTG       IFEQ TTA
     C   64                SETON                     14
    C   14                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTB
     C   65                SETON                     15
    C   15                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTE
     C   66                SETON                     17
    C   17                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTC
     C   67                SETON                     18
    C   18                GOTO FINTES
F3  C                     END
D3  C           TTG       IFEQ TTD
     C   68                SETON                     23
    C   23                GOTO FINTES
F3  C                     END
F2  C                     END
F1  C                     END
    C** FACTURATION CLIENT = NON ET AUTRE CLIENT SAISI
    C*************************************************
D1  C           FACGEN    IFEQ 'NON'
    C           MATGE1    ANDNE*ZEROS
    C           FACGEN    OREQ 'NON'
    C           MATGE1    ANDNE*ZEROS
    C           FACGEN    OREQ 'NON'
    C           MATGE1    ANDNE*ZEROS
D2  C           TTG       IFEQ TTA
     C   64                SETON                     24
    C   24                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTB
     C   65                SETON                     74
    C   74                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTE
     C   66                SETON                     76
    C   76                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTC
     C   67                SETON                     83
    C   83                GOTO FINTES
F2  C                     END
D2  C           TTG       IFEQ TTD
     C   68                SETON                     31
    C   31                GOTO FINTES
F2  C                     END
F1  C                     END
    C           FINTES    ENDSR
     C/EJECT
    C           SPGR07    BEGSR
     C           CLECD1    CHAINCDEXPOL1             38
     C  N38                MOVE DPFRON    DEPART
D1  C  N38      CONDEX    IFEQ TCON,1
     C                     MOVE 'X'       FOB
F1  C                     END
D1  C  N38      CONDEX    IFEQ TCON,5
     C                     MOVE 'X'       DPUSIN
F1  C                     END
D1  C  N38      CONDEX    IFEQ TCON,2
     C                     MOVE 'X'       CAFCIF
F1  C                     END
D1  C  N38      CONDEX    IFEQ TCON,6
     C                     MOVE 'X'       FRDEST
F1  C                     END
D1  C  N38      CONDEX    IFEQ TCON,3
     C                     MOVE 'X'       CETF
F1  C                     END
D1  C        N38CONDEX    IFEQ TCON,7
     C                     MOVE 'X'       FRFRON
F1  C                     END
D1  C        N38CONDEX    IFEQ TCON,4
     C                     MOVE 'X'       FAS
F1  C                     END
     C           FORM12    TAG
    C**         ******    ***
     C                     EXFMTF20
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
     C                     Z-ADD0         SCHON   10
D1  C           FOB       IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           DPUSIN    IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           CAFCIF    IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           FRDEST    IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           CETF      IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           FRFRON    IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
D1  C           FAS       IFNE ' '
     C                     ADD  1         SCHON
F1  C                     END
    C           SCHON     CABGT1         FORM12     24
D1  C           FRFRON    IFNE ' '
    C           DEPART    CABEQ0         FORM12         25
F1  C                     END
D1  C           FRFRON    IFEQ ' '
    C           DEPART    CABNE0         FORM12     2626
F1  C                     END
D1  C           FOB       IFEQ 'X'
     C                     MOVE TCON,1    CONDEX
F1  C                     END
D1  C           CAFCIF    IFEQ 'X'
     C                     MOVE TCON,2    CONDEX
F1  C                     END
D1  C           CETF      IFEQ 'X'
     C                     MOVE TCON,3    CONDEX
F1  C                     END
D1  C           FAS       IFEQ 'X'
     C                     MOVE TCON,4    CONDEX
F1  C                     END
D1  C           DPUSIN    IFEQ 'X'
     C                     MOVE TCON,5    CONDEX
F1  C                     END
D1  C           FRDEST    IFEQ 'X'
     C                     MOVE TCON,6    CONDEX
F1  C                     END
D1  C           FRFRON    IFEQ 'X'
     C                     MOVE TCON,7    CONDEX
F1  C                     END
D1  C           FRFRON    IFNE *BLANKS
     C                     MOVE DEPART    DPFRON
X1  C                     ELSE
     C                     Z-ADD*ZEROS    DPFRON
F1  C                     END
     C        N38          UPDATCDEXPOF1
     C                     MOVE NOMTRA    TRAVES 40
     C                     MOVE CONDEX    EXCOND 10
D1  C           *IN38     IFEQ '1'
    C           TRAVES    ANDNE*BLANKS
    C           *IN38     OREQ '1'
    C           EXCOND    ANDNE*BLANKS
     C                     WRITECDEXPOF1
F1  C                     END
     C           CLECD1    CHAINCDEXPOL1             38
D1  C           *IN38     IFEQ '0'
    C           TRAVES    ANDEQ*BLANKS
    C           EXCOND    ANDEQ*BLANKS
     C                     DELETCDEXPOF1
F1  C                     END
     C                     MOVE *BLANKS   NOMTRA
     C                     MOVE *BLANKS   RAITRA
     C                     MOVE *BLANKS   RUETRA
     C                     MOVE *BLANKS   VILTRA
     C                     MOVE *BLANKS   DEPTRA
     C                     MOVE *BLANKS   CPTRA
     C                     MOVE *BLANKS   BDTRA
     C                     MOVE *BLANKS   CPAYTR
     C                     MOVE *BLANKS   PAYTRA
     C                     MOVE *BLANKS   CONDEX
     C                     MOVE *BLANKS   NBFAC
     C                     MOVE *BLANKS   EXPO1
     C                     MOVE *BLANKS   EXPO2
    C                     ENDSR
     C/EJECT
    C           SPGR08    BEGSR
    C*          ---------------
     C                     MOVE ' '       QTEIP   1
D1  C           RUV1      IFEQ 'O'
     C                     Z-ADD1         EMBNO
     C           CLEEMB    CHAINCAISSEL1             99
    C   99                GOTO FINEMX
    C           EMBNAT    CABEQ'Q'       FINEMX
     C           EMBHT     DIV  10        HCAIS   31
     C           CLEEMB    CHAINPALETTL1             99
    C   99                GOTO FINEMX
    C           NBDECP    CABEQ*ZEROS    FINEMX
     C           EMBHT     SUB  15        HPAL    41
     C           HPAL      DIV  HCAIS     NBRC    20
     C           NBCAIP    DIV  NBRC      NBRCC   20
     C           NBRC      DIV  2         NBRCP   20
     C                     MVR            RESTEX  20
D2  C           RESTEX    IFNE *ZEROS
     C                     ADD  1         NBRCP
F2  C                     END
     C           NBRCP     MULT NBRCC     IMPCP   60
     C           IMPCP     MULT NBRUNI    IMPPP
     C                     MOVE '*'       QTEIP   1
     C           FINEMX    TAG
F1  C                     END
    C*
     C                     MOVE '0'       INDIC   1
D1  C           OPTION    IFNE 2
D2  C           ARTIGO    IFNE '1'
     C           CLECD1    CHAINCDESL1               38
     C                     UPDATF2F2F2F2
F2  C                     END
F1  C                     END
     C                     SETON                     12
     C                     WRITEF23
     C                     SETOF                     12
     C                     MOVE *HIVAL    TSE
     C                     Z-ADD*ZEROS    TBF
     C                     Z-ADD*ZEROS    TBIM
     C                     Z-ADD*ZEROS    TBFA
     C                     Z-ADD*ZEROS    TBEX
     C                     Z-ADD*ZEROS    TBPX
     C                     Z-ADD*ZEROS    TBPR
     C                     Z-ADD*ZEROS    TBPE
     C                     Z-ADD*ZEROS    TBPU
     C                     MOVE *BLANKS   TBCM
     C                     MOVE *BLANKS   TBCD
     C                     Z-ADD*ZEROS    TBSS
     C                     Z-ADD*ZEROS    TBAD
     C                     Z-ADD*ZEROS    TBSD
     C                     Z-ADD*ZEROS    TBJD
     C                     Z-ADD*ZEROS    TBBO
     C                     Z-ADD*ZEROS    TBAF
     C                     Z-ADD*ZEROS    TBAL
     C                     MOVE *BLANKS   TBDS
     C           CLECD1    SETLLCARCDEL2
D1  C                     DO   *HIVAL    R4      40
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FORM13
     C                     Z-ADD1         I
D2  C           ARTIGO    IFEQ '1'
    C           *IN90     ANDEQ'1'
     C                     MOVE CODMO1    CODMON
F2  C                     END
     C           *HIVAL    LOKUPTSE,I                    38
     C                     MOVE SEQFAB    TSEFAB
     C                     MOVE I         TSERAN
     C                     MOVE TSET      TSE,I
     C                     MOVE SEQFAB    TBF,I
     C                     MOVE SSDEL     TBSS,I
     C                     MOVE ANDEL     TBAD,I
     C                     MOVE SEDEL     TBSD,I
     C                     MOVE JSDEL     TBJD,I
     C                     MOVE CODEL     TBCD,I
     * SI PRE IMPRIME STOCKE
     * MOVE DE QTOT DANS QTIMP-QTFAC-QTDEXP
     * ------------------------------------
D2  C           *IN94     IFEQ '1'
D3  C           QTIMP     IFNE *ZEROS
     C                     Z-ADDQTOT      QTIMP
F3  C                     END
D3  C           QTFAC     IFNE *ZEROS
     C                     Z-ADDQTOT      QTFAC
F3  C                     END
D3  C           QTDEXP    IFNE *ZEROS
     C                     Z-ADDQTOT      QTDEXP
F3  C                     END
F2  C                     END
D2  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDPUNIT     PRIXUN
X2  C                     ELSE
     C                     Z-ADDPRIETR    PRIXUN
F2  C                     END
     C                     MOVE QTIMP     TBIM,I
     C                     MOVE QTFAC     TBFA,I
     C                     MOVE QTDEXP    TBEX,I
     C                     MOVE NBRBOB    TBBO,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     MOVE PRIXUN    TBPR,I
     C                     MOVE PRIETR    TBPE,I
     C                     MOVE PUNIT     TBPU,I
     C                     MOVE PX        TBPX,I
     C                     MOVE SEQFAB    SQFAB
     C                     MOVE STE       STEZ
     C                     MOVE NOCLI     NOCLIZ
     C                     MOVE AGENT     AGENTZ
     C                     MOVE NOFOR     NOFORZ
     C                     MOVE SEQIMP    SQIMP
     C                     MOVE DSREF     TBDS,I
     C                     MOVE CODMON    TBCM,I
     C                     WRITEF22
F1  C                     END
     C           CHASOU    TAG
    C**         ******    ***
     C                     SORTATSE
     C                     Z-ADD0         R4
     C                     Z-ADD0         I
     C           BOUCLI    TAG
    C**         ******    ***
     C                     Z-ADD*ZEROS    SEQFAB
     C                     Z-ADD*ZEROS    QTFAC
     C                     Z-ADD*ZEROS    QTDEXP
     C                     Z-ADD*ZEROS    SEQIMP
     C                     Z-ADD*ZEROS    QTIMP
     C                     ADD  1         I
    C           I         CABGT99        FORM13
    C           TSE,I     CABEQ*HIVAL    FORM13
     C                     MOVE TSE,I     TSET
     C                     Z-ADDTSERAN    K       20
     C                     Z-ADDTBF,K     SEQFAB
     C                     Z-ADDTBFA,K    QTFAC
     C                     Z-ADDTBEX,K    QTDEXP
     C                     Z-ADDTBIM,K    QTIMP
     C                     Z-ADDTBSS,K    SSDEL
     C                     Z-ADDTBAD,K    ANDEL
     C                     Z-ADDTBSD,K    SEDEL
     C                     Z-ADDTBJD,K    JSDEL
     C                     Z-ADDTBBO,K    NBRBOB
     C                     Z-ADDTBPR,K    PRIXUN
     C                     Z-ADDTBPE,K    PRIETR
     C                     Z-ADDTBPU,K    PUNIT
     C                     Z-ADDTBPX,K    PX
     C                     MOVE TBCM,K    CODMON
     C                     MOVE TBCD,K    CODEL
     C                     MOVE TBAF,K    RGFAC
     C                     MOVE TBAL,K    RGLIV
     C                     MOVE TBDS,K    DSREF
     C                     MOVE STEZ      STE
     C                     MOVE NOCLIZ    NOCLI
     C                     MOVE AGENTZ    AGENT
     C                     MOVE NOFORZ    NOFOR
     C                     ADD  1         R4
     C                     WRITEF22
    C                     GOTO BOUCLI
     C           FORM13    TAG
    C**         ******    ***
D1  C           R4        IFGT 0
     C                     SETON                     10
F1  C                     END
     C                     SETON                     11
     C                     WRITEF25
     C                     WRITEF21
D1  C           R4        IFEQ 0
     C                     MOVE STE       STEZ
     C                     MOVE NOCLI     NOCLIZ
     C                     MOVE AGENT     AGENTZ
     C                     MOVE NOFOR     NOFORZ
    C                     GOTO FORM24
F1  C                     END
D1  C           *IN71     IFEQ '1'
    C           *IN61     OREQ '1'
    C           *IN62     OREQ '1'
    C           *IN63     OREQ '1'
    C           *IN73     OREQ '1'
    C           *IN75     OREQ '1'
    C           *IN26     OREQ '1'
     C                     WRITEF23
F1  C                     END
     C  N26
     CANN61N62N63
     CANN71N73N75          EXFMTF23
     C   71                EXFMTF35A
     C   73                EXFMTF35B
     C   75                EXFMTF35C
     C   63                EXFMTF35D
     C   62                EXFMTF35E
     C   61                EXFMTF35F
     C   26                EXFMTF35G
     C                     SETOF                     1011
D1  C           *IN71     IFEQ '1'
     C                     SETOF                     71
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN73     IFEQ '1'
     C                     SETOF                     73
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN75     IFEQ '1'
     C                     SETOF                     75
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN61     IFEQ '1'
     C                     SETOF                     61
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN62     IFEQ '1'
     C                     SETOF                     62
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN63     IFEQ '1'
     C                     SETOF                     63
    C                     GOTO FORM13
F1  C                     END
D1  C           *IN26     IFEQ '1'
     C                     SETOF                     26
    C                     GOTO FORM13
F1  C                     END
     C                     SETOF                     1011
    C** VALIDATION DES CADENCEMENTS
    C******************************
D1  C           *IN21     IFEQ '1'
     C  N13      CLECD1    CHAINCDESL1               20
     C                     XFOOTTBIM      TBIMX   80
     C                     XFOOTTBFA      TBFAX   80
     C                     XFOOTTBEX      TBEXX   80
     C                     XFOOTTBBO      TBEBOB  80
     C                     XFOOTTBPR      TBEPUB  92
    C* PAS DE MONNAIE
    C*****************************
D2  C           *IN90     IFEQ '1'
    C           SANFAC    ANDEQ' '
    C           TBEPUB    CABEQ*ZEROS    FORM13         26
F2  C                     END
    C**
D2  C           TBIMX     IFNE 0
D3  C           TBIMX     IFNE QTOT
    C           *IN95     ANDEQ'0'
     C                     MOVE TER,1     LIBER
     C                     SETON                     71
    C                     GOTO FORM13
F3  C                     END
F2  C                     END
    C** TOTAL FABRICATION DIFFERENT QUANTITE TOTALE
    C**********************************************
D2  C           TBFAX     IFNE QTOT
     C                     MOVE TER,2     LIBER
     C                     SETON                     71
    C                     GOTO FORM13
F2  C                     END
    C** TOTAL  LIVRAISON  DIFFERENT QUANTITE TOTALE
    C**********************************************
D2  C           TBEXX     IFNE QTOT
     C                     MOVE TER,3     LIBER
     C                     SETON                     71
    C                     GOTO FORM13
F2  C                     END
    C** TOTAL  BOBINES    DIFFERENT QUANTITE TOTALE
    C**********************************************
     C           TOTBOB    MULT 0,95      TOTMIB  70H
     C           TOTBOB    MULT 1,05      TOTMAB  70H
D2  C           TBEBOB    IFLT TOTMIB
    C           TBEBOB    ORGT TOTMAB
     C                     SETON                     63
    C                     GOTO FORM13
F2  C                     END
    C** CONTROLE LIGNE PAR LIGNE
    C***************************
     C                     Z-ADD0         TBIMX
     C                     Z-ADD0         TBFAX
     C                     Z-ADD0         TBEXX
     C                     Z-ADD0         TBEBOB
     C                     Z-ADD0         R4XX
     C           1         CHAINF22                  38
     C                     Z-ADDSSDEL     SSEDEL
     C                     Z-ADDANDEL     ANEDEL
     C                     Z-ADDSEDEL     SEMDEL
     C                     Z-ADDJSDEL     JOUDEL
D2  C           JSDEL     IFEQ 0
     C                     Z-ADD5         JOUDEL
F2  C                     END
D2  C                     DO   *HIVAL    R4
     C           R4        CHAINF22                  38
D3  C           *IN38     IFEQ '0'
    C           QTDEXP    ANDNE*ZEROS
     C                     ADD  1         R4XX    20
F3  C                     END
D3  C           *IN38     IFEQ '1'
D4  C           NBLIV     IFNE 0
    C           R4XX      CABNENBLIV     FORM13     6262
F4  C                     END
D4  C           NBLIV     IFEQ 0
     C           QTOT      DIV  QTFAB     LIVLIV  30
    C           R4XX      CABNELIVLIV    FORM13     6262
F4  C                     END
F3  C                     END
    C   38                GOTO JOEL1
     C                     ADD  QTIMP     TBIMX
     C                     ADD  QTFAC     TBFAX
     C                     ADD  QTDEXP    TBEXX
     C                     Z-ADDSSDEL     SS1DEL
     C                     Z-ADDANDEL     AN1DEL
     C                     Z-ADDSEDEL     SE1DEL
     C                     Z-ADDJSDEL     JO1DEL
D3  C           TE1DEL    IFNE 0
D4  C           JSDEL     IFEQ 0
     C                     Z-ADD5         JO1DEL
F4  C                     END
F3  C                     END
D3  C           TE1DEL    IFNE 0
D4  C           TE1DEL    IFLT TESDEL
     C                     SETON                     61
    C                     GOTO FORM13
F4  C                     END
F3  C                     END
D3  C           TESDEL    IFEQ 0
D4  C           TE1DEL    IFGT TESDEL
     C                     SETON                     61
    C                     GOTO FORM13
F4  C                     END
F3  C                     END
     C                     MOVE TE1DEL    TESDEL
D3  C           *IN95     IFEQ '0'
D4  C           TBIMX     IFNE 0
    C           TBFAX     CABGTTBIMX     FORM13     73
F4  C                     END
F3  C                     END
    C           TBEXX     CABGTTBFAX     FORM13     75
F2  C                     END
     C           JOEL1     TAG
     C           CLECD1    SETLLCARCDEL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 38
    C         38          GOTO JOEL
     C                     DELETCARCDEF1
F2  C                     END
     C           JOEL      TAG
     C                     MOVE '0'       INDIC
     C           1         CHAINF22                  38
     C                     Z-ADDRGLIV     LIVRGE  20
     C                     Z-ADD*ZEROS    NOIMP   20
D2  C                     DO   *HIVAL    R4
     C           R4        CHAINF22                  38
     C   38                SETON                     12
     C   38                WRITEF23
     C   38                SETOF                     12
     C   38                EXSR MAJLIV
     C                     MOVE '0'       *IN18
D3  C           *IN38     IFEQ '1'
     C           CLECD1    CHAINCDESL1               39
D4  C           GARNT     IFNE 'RE'
     C                     MOVE *IN17     IN17
     C  N94      CLAPRO    CHAINPRODUI2              39
     C  N94      CLAPRO    CHAINCOMPREL2             17
     C  N94N17             MOVE GARGAR    GARNT
     C                     MOVE IN17      *IN17
F4  C                     END
D4  C           *IN94     IFNE '1'
    C           *IN18     ANDNE'1'
    C           SANFAC    ANDNE'*'
    C           PORKG     ANDEQ0
    C           INDIC     ANDEQ'1'
     C                     MOVE '*'       LIMULS
     C                     EXCPTMAJ01
F4  C                     END
D4  C           *IN94     IFNE '1'
    C           *IN18     ANDNE'1'
    C           SANFAC    ANDNE'*'
    C           PORKG     ANDEQ0
    C           INDIC     ANDEQ'0'
     C                     MOVE ' '       LIMULS
     C                     EXCPTMAJ01
F4  C                     END
F3  C                     END
     C                     MOVE '0'       *IN18
    C   38                GOTO FINSR3
D3  C           RGLIV     IFNE LIVRGE
     C                     MOVE '1'       INDIC
F3  C                     END
     C                     Z-ADD0         MMDEL
     C                     Z-ADD0         JJDEL
     C                     Z-ADD0         NOJOUR
D3  C           SEDEL     IFNE *ZEROS
     C                     Z-ADDJSDEL     SJS     20
D4  C           JSDEL     IFEQ 0
     C                     Z-ADD5         JSDEL
F4  C                     END
     C           CLECAL    CHAINCALENAL2             39
     C        N39          MOVE CALMM     MMDEL
     C        N39          MOVE CALJJ     JJDEL
     C        N39          MOVE CALNOJ    NOJOUR
     C        N39          Z-ADDCALSS     SSDEL
     C        N39          Z-ADDSJS       JSDEL
F3  C                     END
D3  C           CODEL     IFEQ 'PR'
     C                     Z-ADD0         JDEDEL
     C                     Z-ADD0         ADEDEL
     C                     Z-ADD0         SDEDEL
     C                     Z-ADD0         SSDDEL
X3  C                     ELSE
     C                     Z-ADDJSDEL     JDEDEL
     C                     Z-ADDANDEL     ADEDEL
     C                     Z-ADDSSDEL     SSDDEL
     C                     Z-ADDSEDEL     SDEDEL
F3  C                     END
D3  C           QTIMP     IFNE *ZEROS
     C                     ADD  1         NOIMP
     C                     Z-ADDNOIMP     SEQIMP
X3  C                     ELSE
     C                     Z-ADD*ZEROS    SEQIMP
F3  C                     END
     C                     Z-ADD*ZEROS    SEQIMP
     C                     WRITECARCDEF1
F2  C                     END
     C                     EXSR MAJLIV
     C           CLECD1    CHAINCDESL1               38
D2  C           TAGBID    IFNE ' '
     C                     MOVE '*'       TAGMAJ
F2  C                     END
     C                     UPDATF2F2F2F2
     C                     EXSR RAZ
    C                     GOTO FINSR3
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
D2  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
D1  C                     DO   *HIVAL    R4
     C                     READCF22                    3938
    C   39                GOTO FORM13
D2  C           *IN38     IFEQ '1'
     C                     SETON                     12
     C                     WRITEF23
     C                     SETOF                     12
    C                     GOTO CHASOU
F2  C                     END
D2  C           CHOIX     IFEQ 'A'
     C                     MOVE STE       STEZ
     C                     MOVE NOCLI     NOCLIZ
     C                     MOVE AGENT     AGENTZ
     C                     MOVE NOFOR     NOFORZ
     C                     MOVE TSE,R4    TSET
    C                     GOTO FORM24
F2  C                     END
D2  C           CHOIX     IFEQ 'M'
     C                     SETON                     81
     C           FOR23A    TAG
    C**         ******    ***
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      71
     C                     EXFMTF24
     C                     MOVE REF71     *IN71
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D3  C           *IN05     IFEQ '1'
D4  C           RGFAC     IFNE 0
     C                     MOVE RGFAC     FABIUS  20
F4  C                     END
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D4  C           RGFAC     IFEQ 0
     C                     MOVE FABIUS    RGFAC
F4  C                     END
F3  C                     END
    C** CHANGEMENT D'ADRESSE LIVRAISON
    C*********************************
D3  C           *IN08     IFEQ '1'
D4  C           RGLIV     IFNE 0
     C                     MOVE RGLIV     LIBIUS  20
F4  C                     END
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
D4  C           RGLIV     IFEQ 0
     C                     MOVE LIBIUS    RGLIV
F4  C                     END
F3  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D3  C           *IN22     IFEQ '1'
D4  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F4  C                     END
    C                     GOTO FORM02
F3  C                     END
    C** TEST VALIDITE SEQUENCE
    C*************************
     C                     MOVE TSE,R4    TSET
D3  C           SEQFAB    IFNE TSEFAB
     C           SEQFAB    LOKUPTBF                      89
    C   89                GOTO FOR23A
F3  C                     END
    C** TEST VALIDITE DU DELAI
    C*************************
D3  C           SEDEL     IFNE 0
    C           JSDEL     ANDNE0
     C           CLECAL    CHAINCALENAL2             79
    C   79                GOTO FOR23A
     C                     Z-ADDCALSS     SSDEL
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           JSDEL     ANDEQ0
     C                     Z-ADD5         JSDEL
     C           CLECAL    CHAINCALENAL2             79
     C                     Z-ADD0         JSDEL
    C   79                GOTO FOR23A
     C                     Z-ADDCALSS     SSDEL
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           DATCAL    CABLEDATSYS    FOR23A       7979
D4  C           *IN48     IFEQ '0'
    C           DATCAL    ANDGTDATM6
     C                     SETON                     4748
    C                     GOTO FOR23A
F4  C                     END
    C           CALJOU    CABEQ'FERIE   'FOR23A         79
F3  C                     END
     C                     SETOF                     48
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDNE0
     C                     SETON                     79
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           CODEL     ANDEQ*BLANKS
     C                     SETON                     35
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           CDEPRE    ANDEQ'P'
    C           CODEL     ANDNE'PR'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
    C*          SEDEL     IFNE 0
    C*          CDEPRE    ANDNE'P'
    C*          PRESER    ANDEQ'P'
    C*          CODEL     ANDNE'CO'
    C*                    SETON                     43
    C*                    GOTO FOR23A
    C*                    END
D3  C           SEDEL     IFNE 0
    C           CDEPRE    ANDNE'P'
    C*          PRESER    ANDNE'P'
    C           *IN94     ANDNE'1'
    C           CODEL     ANDEQ'CO'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           CDEPRE    ANDNE'P'
    C*          PRESER    ANDNE'P'
    C           *IN94     ANDNE'1'
    C           QTDEXP    ANDEQ0
    C           CODEL     ANDEQ'DE'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFNE 0
    C           *IN94     ANDEQ'1'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDNE*BLANKS
     C                     SETON                     52
    C                     GOTO FOR23A
F3  C                     END
D3  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDEQ*BLANKS
     C                     Z-ADD0         SSDEL
F3  C                     END
D3  C           QTDEXP    IFEQ 0
    C           QTIMP     ANDEQ0
     C                     SETON                     25
    C                     GOTO FOR23A
F3  C                     END
    C** TEST SI GROUPAGE FAB
    C************************
     C           QTFAC     MULT 0,95      TOTMIN  70H
     C           QTFAC     MULT 1,05      TOTMAX  70H
D3  C           NBRBOB    IFNE 0
    C           BOBPDS    ANDNE0
     C           NBRBOB    MULT BOBPDS    TOTMOY  80H
     C           TOTMOY    COMP TOTMIN                 40
    C   40                GOTO FOR23A
     C           TOTMOY    COMP TOTMAX               40
    C   40                GOTO FOR23A
F3  C                     END
D3  C           JSDEL     IFNE 0
     C                     Z-ADDJSDEL     RL      10
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL1             38
    C           RDV,RL    CABEQ'*'       FOR23A         50
D4  C     N46   RDV,RL    IFEQ 'R'
     C                     SETON                     4546
    C                     GOTO FOR23A
F4  C                     END
F3  C                     END
     C                     SETOF                     46
    C** QUANTITES IMPERATIVES
    C**************************
D3  C           QTEIP     IFEQ '*'
     C                     SETOF                     97
D4  C           QTIMP     IFNE *ZEROS
     C                     Z-ADDQTIMP     QTIP    80
     C                     MOVELTI1,8     LIBQTI
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTIMP
F5  C                     END
F4  C                     END
D4  C           QTFAC     IFNE *ZEROS
     C                     Z-ADDQTFAC     QTIP
     C                     MOVELTI1,9     LIBQTI
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTFAC
F5  C                     END
F4  C                     END
D4  C           QTDEXP    IFNE *ZEROS
     C                     Z-ADDQTDEXP    QTIP
     C                     MOVELTI1,10    LIBQTI
     C                     SETON                     97
     C                     EXSR TRTQIP
D5  C           OKQTIP    IFEQ ' '
     C                     Z-ADDQTIP      QTDEXP
F5  C                     END
F4  C                     END
F3  C                     END
    C** VALIDITE ADRESSE FACTURATION
    C*******************************
D3  C           *IN94     IFNE '1'
     C                     MOVE RGFAC     SEQUEN
D4  C           RGFAC     IFNE 99
     C           CLEFIC    CHAINCLIFACL1             22
    C   22                GOTO FOR23A
     * NE PAS PRENDRE LES ANNULEES
    C           TAGANU    CABEQ'*'       FOR23A         22
F4  C                     END
F3  C                     END
    C** VALIDITE ADRESSE LIVRAISON
    C*****************************
D3  C           *IN94     IFNE '1'
     C                     MOVE RGLIV     SEQUEN
D4  C           RGLIV     IFNE 99
     C           CLEFIC    CHAINCLILIVL1             23
    C   23                GOTO FOR23A
     * NE PAS PRENDRE LES ANNULEES
    C           TAGANU    CABEQ'*'       FOR23A         23
F4  C                     END
F3  C                     END
    C** PRIX ET PX SI USINE
    C*****************************
D3  C           *IN90     IFEQ '1'
    C           SANFAC    ANDEQ' '
    C           CODMON    CABEQ*BLANKS   FOR23A         26
    C           PRIXUN    CABEQ*ZEROS    FOR23A         24
    C           PX        CABEQ*ZEROS    FOR23A         36
F3  C                     END
    C**
     C                     MOVE DSCAD1    DSCAD2 60
     C                     Z-ADDRGFAC     RFACE   20
     C                     Z-ADDRGLIV     RLIVE   20
     C                     Z-ADDSEQFAB    RFABE   20
     C           R4        CHAINF22                  38
     C                     Z-ADDRFACE     RGFAC
     C                     Z-ADDRLIVE     RGLIV
     C                     MOVE DSCAD2    DSCAD1
     C                     MOVE TSE,R4    TSET
     C                     Z-ADDRFABE     SEQFAB
     C                     Z-ADDRFABE     TSEFAB
     C                     MOVE TSERAN    I
     C                     MOVE SEQFAB    TBF,I
     C                     MOVE SSDEL     TBSS,I
     C                     MOVE ANDEL     TBAD,I
     C                     MOVE SEDEL     TBSD,I
     C                     MOVE JSDEL     TBJD,I
     C                     MOVE CODEL     TBCD,I
     C                     MOVE QTIMP     TBIM,I
     C                     MOVE QTFAC     TBFA,I
     C                     MOVE QTDEXP    TBEX,I
     C                     MOVE NBRBOB    TBBO,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     Z-ADDPRIXUN    TBPR,I
D3  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDTBPR,I    PUNIT
X3  C                     ELSE
     C                     Z-ADDTBPR,I    PRIETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDPRIETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     PUNIT
     C                     EXSR SPCOUR
F3  C                     END
     C                     Z-ADDPUNIT     TBPU,I
     C                     Z-ADDPRIETR    TBPE,I
     C                     MOVE PX        TBPX,I
     C                     MOVE TSET      TSE,R4
     C                     MOVE DSREF     TBDS,I
     C                     MOVE CODMON    TBCM,I
     C                     UPDATF22
     C                     SETON                     12
     C                     WRITEF23
     C                     SETOF                     1281
    C                     GOTO CHASOU
F2  C                     END
D2  C           CHOIX     IFEQ 'S'
     C                     MOVE TSE,R4    TSET
     C                     MOVE TSERAN    K
     C                     MOVE *BLANKS   TBF,K
     C                     MOVE *BLANKS   TBFA,K
     C                     MOVE *BLANKS   TBEX,K
     C                     MOVE *BLANKS   TBIM,K
     C                     MOVE *BLANKS   TBSS,K
     C                     MOVE *BLANKS   TBAD,K
     C                     MOVE *BLANKS   TBSD,K
     C                     MOVE *BLANKS   TBJD,K
     C                     MOVE *BLANKS   TBCD,K
     C                     MOVE *BLANKS   TBBO,K
     C                     MOVE *BLANKS   TBAF,K
     C                     MOVE *BLANKS   TBAL,K
     C                     MOVE *BLANKS   TBPR,K
     C                     MOVE *BLANKS   TBPE,K
     C                     MOVE *BLANKS   TBPU,K
     C                     MOVE *BLANKS   TBCM,K
     C                     MOVE *BLANKS   TBPX,K
     C                     MOVE *BLANKS   TBDS,K
     C                     MOVE *HIVAL    TSE,R4
F2  C                     END
F1  C                     END
     C           FORM24    TAG
    C**         ******    ***
     C                     MOVE *BLANKS   CODEL
     C                     Z-ADD*ZEROS    ANDEL
     C                     Z-ADD*ZEROS    SSDEL
     C                     Z-ADD*ZEROS    MMDEL
     C                     Z-ADD*ZEROS    JJDEL
     C                     Z-ADD*ZEROS    NOJOUR
     C                     Z-ADD*ZEROS    COMCLS
     C                     Z-ADD*ZEROS    COMCLA
     C                     Z-ADD*ZEROS    COMCLM
     C                     Z-ADD*ZEROS    COMCLJ
     C                     Z-ADD*ZEROS    SEDEL
     C                     Z-ADD*ZEROS    JSDEL
     C                     Z-ADD*ZEROS    QTIMP
     C                     Z-ADD*ZEROS    QTFAC
     C                     Z-ADD*ZEROS    QTDEXP
     C                     Z-ADD*ZEROS    NBRBOB
     C                     Z-ADD*ZEROS    RGFAC
     C                     Z-ADD*ZEROS    RGLIV
     C                     Z-ADD*ZEROS    PX
D1  C           R4        IFNE 0
     C                     Z-ADDTBPU,R4   PUNIT
     C                     Z-ADDTBPE,R4   PRIETR
     C                     Z-ADDTBPR,R4   PRIXUN
     C                     Z-ADDTBPX,R4   PX
     C                     MOVE TBCM,R4   CODMON
     C                     MOVE TBAF,R4   RGFAC
     C                     MOVE TBAL,R4   RGLIV
F1  C                     END
     C           FOR24A    TAG
    C**         ******    ***
     C                     MOVE *IN71     REF71   1
     C           USAISI    COMP '*'                      71
     C                     EXFMTF24
     C                     MOVE REF71     *IN71
    C** CHANGEMENT D'ADRESSE FACTURATION
    C***********************************
D1  C           *IN05     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE04£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F1  C                     END
    C** CHANGEMENT D'ADRESSE LIVRAISON
    C*********************************
D1  C           *IN08     IFEQ '1'
     C                     MOVE '1'       ZONE95
     C                     CALL 'CLIE05£'
     C                     PARM           DSCOMM
     C                     MOVE '0'       ZONE95
F1  C                     END
    C** ANNULATION DE LA SAISIE
    C**************************
D1  C           *IN22     IFEQ '1'
D2  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
D1  C           R4        IFNE 0
     C                     MOVE TSE,R4    TSET
F1  C                     END
D1  C                     DO   99        ZZ      20
    C           TSE,ZZ    CABEQ*HIVAL    ECRISM
F1  C                     END
     C           ECRISM    TAG
    C**         ******    ***
    C** TEST VALIDITE SEQUENCE
    C*************************
     C           SEQFAB    LOKUPTBF                      89
    C   89                GOTO FOR24A
    C** TEST VALIDITE DU DELAI
    C*************************
D1  C           SEDEL     IFNE 0
    C           JSDEL     ANDNE0
     C           CLECAL    CHAINCALENAL2             79
    C   79                GOTO FOR24A
     C                     Z-ADDCALSS     SSDEL
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           JSDEL     ANDEQ0
     C                     Z-ADD5         JSDEL
     C           CLECAL    CHAINCALENAL2             79
     C                     Z-ADD0         JSDEL
    C   79                GOTO FOR24A
     C                     Z-ADDCALSS     SSDEL
F1  C                     END
D1  C           SEDEL     IFEQ 0
    C           JSDEL     ANDNE0
     C                     SETON                     79
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           DATCAL    CABLEDATSYS    FOR24A       7979
D2  C           *IN48     IFEQ '0'
    C           DATCAL    ANDGTDATM6
     C                     SETON                     4748
    C                     GOTO FOR24A
F2  C                     END
    C           CALJOU    CABEQ'FERIE   'FOR24A         79
F1  C                     END
     C                     SETOF                     48
D1  C           SEDEL     IFNE 0
    C           CODEL     ANDEQ*BLANKS
     C                     SETON                     35
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           CDEPRE    ANDEQ'P'
    C           CODEL     ANDNE'PR'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           CDEPRE    ANDNE'P'
    C           PRESER    ANDEQ'P'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           CDEPRE    ANDNE'P'
    C           PRESER    ANDNE'P'
    C           *IN94     ANDNE'1'
    C           CODEL     ANDEQ'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFNE 0
    C           *IN94     ANDEQ'1'
    C           CODEL     ANDNE'CO'
     C                     SETON                     43
    C                     GOTO FOR24A
F1  C                     END
D1  C           SEDEL     IFEQ 0
    C           JSDEL     ANDEQ0
    C           CODEL     ANDNE*BLANKS
     C                     SETON                     52
    C                     GOTO FOR24A
F1  C                     END
    C** TEST SI GROUPAGE FAB
    C************************
    C           QTDEXP    CABEQ0         FOR24A         25
     C           QTFAC     MULT 0,95      TOTMIN  70H
     C           QTFAC     MULT 1,05      TOTMAX  70H
D1  C           NBRBOB    IFNE 0
    C           BOBPDS    ANDNE0
     C           NBRBOB    MULT BOBPDS    TOTMOY  80H
     C           TOTMOY    COMP TOTMIN                 40
    C   40                GOTO FOR24A
     C           TOTMOY    COMP TOTMAX               40
    C   40                GOTO FOR24A
F1  C                     END
D1  C           JSDEL     IFNE 0
     C                     Z-ADDJSDEL     RL      10
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL1             38
    C           RDV,RL    CABEQ'*'       FOR24A         50
D2  C     N46   RDV,RL    IFEQ 'R'
     C                     SETON                     4546
    C                     GOTO FOR24A
F2  C                     END
F1  C                     END
     C                     SETOF                     46
    C           QTDEXP    CABEQ0         FOR24A         20
     C                     Z-ADD1         K
    C** VALIDITE ADRESSE FACTURATION
    C*******************************
D1  C           *IN94     IFNE '1'
     C                     MOVE RGFAC     SEQUEN
D2  C           RGFAC     IFNE 99
     C           CLEFIC    CHAINCLIFACL1             22
    C   22                GOTO FOR24A
F2  C                     END
F1  C                     END
    C** VALIDITE ADRESSE LIVRAISON
    C*****************************
D1  C           *IN94     IFNE '1'
     C                     MOVE RGLIV     SEQUEN
D2  C           RGFAC     IFNE 99
     C           CLEFIC    CHAINCLILIVL1             23
    C   23                GOTO FOR24A
F2  C                     END
     C                     Z-ADD1         I
     C           *HIVAL    LOKUPTSE,I                    38
     C                     MOVE SEQFAB    TSEFAB
     C                     MOVE I         TSERAN
     C                     MOVE TSET      TSE,I
D2  C           SEQFAB    IFNE *ZEROS
     C                     MOVE SEQFAB    TBF,I
F2  C                     END
F1  C                     END
    C** PRIX ET PX SI USINE
    C*****************************
D1  C           *IN90     IFEQ '1'
    C           CODMON    CABEQ*BLANKS   FOR23A         25
    C           PRIXUN    CABEQ*ZEROS    FOR23A         24
    C           PX        CABEQ*ZEROS    FOR23A         36
F1  C                     END
    C**
     C                     MOVE SSDEL     TBSS,I
     C                     MOVE ANDEL     TBAD,I
     C                     MOVE SEDEL     TBSD,I
     C                     MOVE JSDEL     TBJD,I
     C                     MOVE CODEL     TBCD,I
     C                     MOVE QTIMP     TBIM,I
     C                     MOVE QTFAC     TBFA,I
     C                     MOVE QTDEXP    TBEX,I
     C                     MOVE NBRBOB    TBBO,I
     C                     MOVE RGFAC     TBAF,I
     C                     MOVE RGLIV     TBAL,I
     C                     Z-ADDPRIXUN    TBPR,I
D1  C           CODMON    IFEQ 'EUR'
     C                     Z-ADDTBPR,I    PUNIT
X1  C                     ELSE
     C                     Z-ADDTBPR,I    PRIETR
     C                     Z-ADD*ZEROS    TZO
     C                     Z-ADDPRIETR    TZO,1
     C                     MOVE CODMON    DORIG
     C                     MOVE 'EUR'     DDEST
     C                     CALL 'EUROCON£'
     C                     PARM           DTPARM
     C                     Z-ADDTZO,1     PUNIT
     C                     EXSR SPCOUR
     C                     Z-ADDPRIETR    TBPE,I
     C                     Z-ADDPUNIT     TBPU,I
F1  C                     END
     C                     MOVE CODMON    TBCM,I
     C                     MOVE PX        TBPX,I
     C                     MOVE DSREF     TBDS,I
     C                     SETON                     12
     C                     WRITEF23
     C                     SETOF                     12
    C                     GOTO CHASOU
D1  C           *IN22     IFEQ '1'
D2  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
    C**         ******    ***
D1  C                     DO   *HIVAL    R5      40
     C           R5        CHAINF22                  38
    C         38          GOTO TOUBA
     C                     WRITEF27
F1  C                     END
     C           TOUBA     TAG
    C**         *****     ***
     C                     SETON                     1011
     C                     WRITEF28
     C                     WRITEF29
     C                     EXFMTF26
     C                     SETOF                     1011
D1  C           *IN12     IFEQ '1'
     C           CLECD1    SETLLCARCDEL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FINSR1
     C                     DELETCARCDEF1
F2  C                     END
     C           FINSR1    TAG
    C**         ******    ***
D2  C                     DO   *HIVAL    R4
     C           R4        CHAINF22                  38
    C         38          GOTO FINSR2
     C           R4        CHAINF27                  38
D3  C           CODEL     IFEQ 'PR'
     C                     Z-ADD0         JDEDEL
     C                     Z-ADD0         ADEDEL
     C                     Z-ADD0         SDEDEL
     C                     Z-ADD0         SSDDEL
X3  C                     ELSE
     C                     Z-ADDJSDEL     JDEDEL
     C                     Z-ADDANDEL     ADEDEL
     C                     Z-ADDSEDEL     SDEDEL
     C                     Z-ADDSSDEL     SSDDEL
F3  C                     END
     C                     Z-ADD0         SEQIMP
     C                     WRITECARCDEF1
F2  C                     END
     C           FINSR2    TAG
    C**         ******    ***
     C                     EXSR RAZ2
    C                     GOTO FORM02
F1  C                     END
D1  C           *IN22     IFEQ '1'
D2  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F2  C                     END
    C                     GOTO FORM02
F1  C                     END
D1  C                     DO   *HIVAL    R5
     C                     READCF27                      80
    C   80                GOTO TOUBA
D2  C           CHOIX     IFEQ 'X'
    C           CHOIX     OREQ '1'
     C           FORM20    TAG
    C**         ******    ***
     C                     EXFMTF30
D3  C           *IN22     IFEQ '1'
D4  C           SSSSSS    IFEQ '1'
     C           CLECD1    CHAINCDESL1               38
     C                     MOVE 'P'       SSSSSS
     C                     MOVE 'P'       PRESER
     C                     UPDATF2F2F2F2
F4  C                     END
    C                     GOTO FORM02
F3  C                     END
     C                     MOVE COMCLS    DOMCLS  20
     C                     MOVE COMCLA    DOMCLA  20
     C                     MOVE COMCLM    DOMCLM  20
     C                     MOVE COMCLJ    DOMCLJ  20
D3  C           DOMCLM    IFNE *ZEROS
     C           CLECA1    CHAINCALENAL0             22
    C         22          GOTO FORM20
     C                     Z-ADDCALSS     DOMCLS
F3  C                     END
     C                     MOVE CLIREF    CDEREF 20
     C           R5        CHAINF27                  38
     C                     MOVE CDEREF    CLIREF
     C                     MOVE DOMCLS    COMCLS
     C                     MOVE DOMCLA    COMCLA
     C                     MOVE DOMCLM    COMCLM
     C                     MOVE DOMCLJ    COMCLJ
     C                     UPDATF27
F2  C                     END
F1  C                     END
    C                     GOTO TOUBA
    C           FINSR3    ENDSR
     C/EJECT
    C           SPGR09    BEGSR
     C           CLECD1    SETLLCARCDEL2
D1  C                     DO   *HIVAL    R5      40
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FORM33
     C                     WRITEF27
F1  C                     END
     C           FORM33    TAG
    C**         ******    ***
     C                     SETON                     1011
     C                     WRITEF28
     C                     WRITEF29
     C                     EXFMTF26
     C                     SETOF                     1011
D1  C           *IN12     IFEQ '1'
     C           CLECD1    SETLLCARCDEL2
D2  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FINS11
     C                     DELETCARCDEF1
F2  C                     END
     C           FINS11    TAG
    C**         ******    ***
D2  C                     DO   *HIVAL    R4
     C           R4        CHAINF27                  38
    C         38          GOTO FINS22
     C                     Z-ADD0         SEQIMP
     C                     WRITECARCDEF1
F2  C                     END
     C           FINS22    TAG
    C**         ******    ***
     C                     EXSR RAZ2
    C                     GOTO FORM02
F1  C                     END
D1  C           *IN22     IFEQ '1'
     C                     EXSR RAZ2
    C                     GOTO FORM02
F1  C                     END
D1  C           R5        IFNE *ZEROS
D2  C                     DO   *HIVAL    R5
     C                     READCF27                      80
    C   80                GOTO FORM33
D3  C           CHOIX     IFEQ 'X'
    C           CHOIX     OREQ '1'
     C           FORM34    TAG
    C**         ******    ***
     C                     EXFMTF30
D4  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F4  C                     END
     C                     MOVE COMCLS    DOMCLS
     C                     MOVE COMCLA    DOMCLA
     C                     MOVE COMCLM    DOMCLM
     C                     MOVE COMCLJ    DOMCLJ
D4  C           DOMCLM    IFNE *ZEROS
     C           CLECA1    CHAINCALENAL0             22
    C         22          GOTO FORM34
     C                     Z-ADDCALSS     DOMCLS
F4  C                     END
     C                     MOVE CLIREF    CDEREF 20
     C           R5        CHAINF27                  38
     C                     MOVE CDEREF    CLIREF
     C                     MOVE DOMCLS    COMCLS
     C                     MOVE DOMCLA    COMCLA
     C                     MOVE DOMCLM    COMCLM
     C                     MOVE DOMCLJ    COMCLJ
     C                     UPDATF27
F3  C                     END
F2  C                     END
F1  C                     END
    C                     GOTO FORM33
    C                     ENDSR
     C/EJECT
    C           SPGR11    BEGSR
     C           NCONF     SETLLCDESL1
     C           NCONF     SETLLCARCDEL2
     C           NCONF     SETLLCDEXPOL1
     C           NCONF     SETLLCDEOBSL2
     C           NCONF     SETLLCDEMATL1
D1  C                     DO   *HIVAL
     C           NCONF     READECDESL1                   38
    C         38          GOTO DELET1
     C                     DELETF2F2F2F2
F1  C                     END
     C           DELET1    TAG
D1  C                     DO   *HIVAL
     C           NCONF     READECARCDEL2                 38
    C         38          GOTO DELET2
     C                     DELETCARCDEF1
F1  C                     END
     C           DELET2    TAG
D1  C                     DO   *HIVAL
     C           NCONF     READECDEXPOL1                 38
    C         38          GOTO DELET3
     C                     DELETCDEXPOF1
F1  C                     END
     C           DELET3    TAG
D1  C                     DO   *HIVAL
     C           NCONF     READECDEMATL1                 38
    C         38          GOTO DELET4
     C                     DELETCDEDDDDD
F1  C                     END
     C           DELET4    TAG
D1  C                     DO   *HIVAL
     C           NCONF     READECDEOBSL2                 38
    C         38          GOTO DELET5
     C                     DELETCDEOBSFF
F1  C                     END
     C           DELET5    TAG
    C                     ENDSR
     C/SPACE 3
    C           SPGR13    BEGSR
    C*          ***************
     C           FOR13A    TAG
     C                     EXFMTF31
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
     C           CLUPRO    CHAINPRODUI2              38
     C                     MOVE *IN17     IN17
     C        N38CLUPRO    CHAINCOMPREL2             17
     C     N38N17          MOVE GARGAR    GARNT
     C                     MOVE IN17      *IN17
     C  N38      ANNUL     COMP '*'                      38
    C   38                GOTO FOR13A
D1  C           *IN94     IFEQ '1'
    C           *IN95     OREQ '1'
    C           *IN96     OREQ '1'
     C                     SETON                     63
    C                     GOTO FOR13A
F1  C                     END
     C                     MOVELINDPCL    CLIPRO
     C           FOR13B    TAG
     C                     EXFMTF32
D1  C           *IN22     IFEQ '1'
    C                     GOTO FORM02
F1  C                     END
     C                     MOVE USINE     USIN1   10
     C                     MOVE USEXT     USINE2  10
     C                     MOVE USINT     USINE3  10
     C                     MOVE ANDEV     ANDEV1  20
     C                     MOVE ETUDE     ETUDE1  40
     C                     MOVE SEQDE     SEQDE1  40
     C                     MOVE NOFOR     NOFOR1  50
     C                     MOVE MOPOR     MOPOR1  4
     C                     MOVE UVENT     UVENT1  10
     C                     MOVE COAS1     COAS11  2
     C                     MOVELCLIPRO    CLIPR1 20
     C                     MOVE ONDUL     ONDUL1  1
     C                     MOVE FACON     FACON1  1
D1  C           COUP2     IFEQ 'O'
    C           COUP3     OREQ 'O'
     C                     Z-ADD*ZEROS    USINE2
F1  C                     END
D1  C           COUP6     IFEQ 'O'
    C           COUP5     OREQ 'O'
     C                     Z-ADD*ZEROS    USINE3
F1  C                     END
     C           CLECD1    CHAINCDESL1               18
D1  C           *IN05     IFEQ '1'
D2  C           CLIPR1    IFEQ *BLANKS
     C                     SETON                     19
    C                     GOTO FOR13A
F2  C                     END
D2  C           UVENT     IFEQ UVENT1
    C           NOFOR     ANDEQFORTUN
    C           DEVAN     ANDEQANDEV
    C           UDETE     ANDEQETUDE
     C           NCONF     SETLLCDESL1
     C           NCONF     SETLLCARCDEL2
     C           NCONF     SETLLCDEXPOL1
     C           NCONF     SETLLCDEOBSL2
     C           NCONF     SETLLCDEMATL1
D3  C                     DO   *HIVAL
     C           NCONF     READECDESL1                   38
    C         38          GOTO DALET1
     C                     MOVE USIN1     USINE
     C                     MOVE USINE2    USEXT
     C                     MOVE USINE3    USINT
     C                     MOVE ANDEV1    ANDEV
     C                     MOVE ETUDE1    ETUDE
     C                     MOVE SEQDE1    SEQDE
     C                     MOVE NOFOR1    NOFOR
     C                     MOVE MOPOR1    MOPOR
     C                     MOVE LIBUS     POSTE
     C                     MOVE NOPRO1    NOPRO
     C                     MOVE ' '       TAGBID
     C                     MOVE ' '       TAGMAJ
     C                     MOVELCLIPR1    CLIPRO
     C                     UPDATF2F2F2F2
F3  C                     END
     C           DALET1    TAG
D3  C                     DO   *HIVAL
     C           NCONF     READECARCDEL2                 38
    C         38          GOTO DALET2
     C                     MOVE USIN1     USINE
     C                     MOVE USINE2    USEXT
     C                     MOVE USINE3    USINT
     C                     MOVE ANDEV1    ANDEV
     C                     MOVE ETUDE1    ETUDE
     C                     MOVE SEQDE1    SEQDE
     C                     MOVE NOFOR1    NOFOR
     C                     MOVE MOPOR1    MOPOR
     C                     MOVE NOPRO1    NOPRO
     C                     MOVELCLIPR1    CLIPRO
     C                     UPDATCARCDEF1
F3  C                     END
     C           DALET2    TAG
D3  C                     DO   *HIVAL
     C           NCONF     READECDEXPOL1                 38
    C         38          GOTO DALET3
     C                     MOVE USIN1     USINE
     C                     MOVE USINE2    USEXT
     C                     MOVE USINE3    USINT
     C                     MOVE ANDEV1    ANDEV
     C                     MOVE ETUDE1    ETUDE
     C                     MOVE SEQDE1    SEQDE
     C                     MOVE NOFOR1    NOFOR
     C                     MOVE MOPOR1    MOPOR
     C                     MOVE NOPRO1    NOPRO
     C                     UPDATCDEXPOF1
F3  C                     END
     C           DALET3    TAG
D3  C                     DO   *HIVAL
     C           NCONF     READECDEMATL1                 38
    C         38          GOTO DALET4
     C                     MOVE USIN1     USINE
     C                     MOVE USINE2    USEXT
     C                     MOVE USINE3    USINT
     C                     MOVE ANDEV1    ANDEV
     C                     MOVE ETUDE1    ETUDE
     C                     MOVE SEQDE1    SEQDE
     C                     MOVE NOFOR1    NOFOR
     C                     MOVE MOPOR1    MOPOR
     C                     MOVE NOPRO1    NOPRO
     C                     UPDATCDEDDDDD
F3  C                     END
     C           DALET4    TAG
D3  C                     DO   *HIVAL
     C           NCONF     READECDEOBSL2                 38
    C         38          GOTO DALET5
     C                     MOVE USIN1     USINE
     C                     MOVE USINE2    USEXT
     C                     MOVE USINE3    USINT
     C                     MOVE ANDEV1    ANDEV
     C                     MOVE ETUDE1    ETUDE
     C                     MOVE SEQDE1    SEQDE
     C                     MOVE NOFOR1    NOFOR
     C                     MOVE MOPOR1    MOPOR
     C                     MOVE NOPRO1    NOPRO
     C                     UPDATCDEOBSFF
F3  C                     END
X2  C                     ELSE
     C                     SETON                     19
    C                     GOTO FOR13A
F2  C                     END
F1  C                     END
    C                     GOTO FOR13B
     C           DALET5    TAG
    C                     ENDSR
     C/EJECT
    C           MATERI    BEGSR
     C                     SETOF                     2474
    C** POUR CODE DIFFERENTS MAIS AVEC IMPRESSION AFFICHAGE
    C******************************************************
     C                     XFOOTTIM       TIMZON  20
    C** RECHERCHE DE L IMPRESSION PRINCIPALE
    C***************************************
D1  C           TIM,3     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,3     EXT     10
     C                     MOVE COU,3     COUPEX  1
    C                     GOTO IMPREZ
F1  C                     END
D1  C           TIM,2     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,2     EXT     10
     C                     MOVE COU,3     COUPEX  1
    C                     GOTO IMPREZ
F1  C                     END
D1  C           TIM,1     IFNE 0
     C                     SETON                     64
     C                     MOVE TIM,1     EXT     10
     C                     MOVE COU,1     COUPEX
F1  C                     END
     C           IMPREZ    TAG
    C**         ******    ***
D1  C           TIM,4     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,4     INT     10
     C                     MOVE COU,4     COUPIN  1
    C                     GOTO IMPREQ
F1  C                     END
D1  C           TIM,5     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,5     INT     10
     C                     MOVE COU,5     COUPIN
    C                     GOTO IMPREQ
F1  C                     END
D1  C           TIM,6     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,6     INT     10
     C                     MOVE COU,6     COUPIN
    C                     GOTO IMPREQ
F1  C                     END
D1  C           TIM,7     IFNE 0
     C                     SETON                     65
     C                     MOVE TIM,7     INT     10
     C                     MOVE COU,7     COUPIN
F1  C                     END
     C           IMPREQ    TAG
    C**         ******    ***
    C** AFFICHAGE DES USINES
    C***********************
     C           CLAPRO    CHAINPRODUI2              38
     C                     MOVE *IN17     IN17
     C        N38CLAPRO    CHAINCOMPREL2             17
     C     N38N17          MOVE GARGAR    GARNT
     C                     MOVE IN17      *IN17
D1  C           *IN38     IFEQ '1'
     C           CLAPRO    CHAINRECAPT               38
     C        N38          MOVE 'RE'      GARNT
F1  C                     END
D1  C           USEXT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USEXT     VALE      P
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXABRG    USIMEX
F1  C                     END
D1  C           USINT     IFNE *ZEROS
     C                     MOVE 'USIN'    ARGU
     C                     MOVE USINT     VALE      P
     C           CLPARA    CHAINPARAME               38
     C                     MOVELPXABRG    USIMIN
F1  C                     END
D1  C           GFRA      IFNE *BLANKS
     C                     SETON                     67
     C                     MOVE 'RT'      USGAUF  2
X1  C                     ELSE
     C                     MOVE '  '      USGAUF
F1  C                     END
D1  C           USINE     IFNE *ZEROS
     C                     SETON                     68
F1  C                     END
D1  C           FACON     IFNE 7
    C           FACON     ANDNE6
    C           FACON     ANDNE8
     C                     SETOF                     68
F1  C                     END
     C   64
     COR 65
     COR 66
     COR 67
     COR 68                SETON                     70
    C           FORM91    ENDSR
     C/EJECT
    C           MAJLIV    BEGSR
     C           CLECD1    SETLLCARCDEL2
D1  C                     DO   *HIVAL
     C           CLECD1    READECARCDEL2                 80
    C   80                GOTO FINTIN
     C                     Z-ADDRGLIV     SEQUEN
     C           CLEFIC    CHAINCLILIVL1             23
     C                     UPDATCARCDEF1
F1  C                     END
    C           FINTIN    ENDSR
     *
     * CALCUL COURS
     * ----------------
    C           SPCOUR    BEGSR
     C                     Z-ADDCRS       COURS
D1  C           COEFF     IFEQ '1'
     C                     DIV  10        COURS
F1  C                     END
D1  C           COEFF     IFEQ '2'
     C                     DIV  100       COURS
F1  C                     END
D1  C           COEFF     IFEQ '3'
     C                     DIV  1000      COURS
F1  C                     END
D1  C           COEFF     IFEQ 'D'
     C                     MULT 10        COURS
F1  C                     END
D1  C           COEFF     IFEQ 'C'
     C                     MULT 100       COURS
F1  C                     END
D1  C           COEFF     IFEQ 'M'
     C                     MULT 1000      COURS
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : QUANTITE IMPERATIVE PAR PALETTE          *
     *--------------------------------------------------------*
    C           TRTQIP    BEGSR
     *          ---------------
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D2  C           UVENT     IFEQ 3
     C                     MULT DECH      NBDECP
     C                     MULT DECH      NBRUNI
F2  C                     END
F1  C                     END
     C                     MOVE ' '       OKQTIP
     C           QTIP      DIV  NBDECP    NBRPAL  30
     C                     MVR            RESTEZ
     C                     Z-ADDNBRPAL    NPMINI  30
     C                     Z-ADDNBRPAL    NPMINP  30
    C*
D1  C           RESTEZ    IFNE *ZEROS
    C           OKQTIP    ANDEQ*BLANKS
     C           QTIP      COMP NBDECP               19
     C           NPMINI    MULT NBDECP    QTMINI
     C           QTMINI    ADD  IMPPP     QTMINP
     C           NPMINI    ADD  1         NPMAXI
     C           NPMAXI    MULT NBDECP    QTMAXI
     C           DQIPW     TAG
     C                     MOVE *BLANK    C1F21
     C                     MOVE *BLANK    C2F21
     C                     MOVE *BLANK    C3F21
     C                     EXFMTF24W
    C*
D2  C           *IN23     IFEQ '1'
     C                     MOVE '1'       OKQTIP  1
    C                     GOTO FQIP
F2  C                     END
    C*
D2  C           *IN19     IFEQ '1'
D3  C           C1F21     IFNE *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     ORNE *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDEQ*BLANKS
    C           C1F21     ORNE *BLANKS
    C           C2F21     ANDEQ*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C2F21     ANDNE*BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C1F21     OREQ *BLANKS
    C           C2F21     ANDEQ*BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DQIPW
F3  C                     END
D3  C           C1F21     IFNE *BLANKS
     C                     Z-ADDQTMINI    QTIP
F3  C                     END
D3  C           C2F21     IFNE *BLANKS
     C                     Z-ADDQTMINP    QTIP
F3  C                     END
D3  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTIP
F3  C                     END
X2  C                     ELSE
D3  C           C2F21     IFNE *BLANKS
    C           C3F21     ANDNE*BLANKS
    C           C2F21     OREQ *BLANKS
    C           C3F21     ANDEQ*BLANKS
     C                     SETON                     74
    C                     GOTO DQIPW
F3  C                     END
D3  C           C2F21     IFNE *BLANKS
     C                     Z-ADDIMPPP     QTIP
F3  C                     END
D3  C           C3F21     IFNE *BLANKS
     C                     Z-ADDQTMAXI    QTIP
F3  C                     END
F2  C                     END
    C*
F1  C                     END
    C*
    C           FQIP      ENDSR
      /EJECT
     *--------------------------------------------------------*
     * S/PROGRAMME : TOUCHE CDE 4                             *
     *--------------------------------------------------------*
    C           TRTAID    BEGSR
     *          ---------------
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
     *
    C           ZONZON    CASEQ'GROUPE'  AID3
    C           ZONZON    CASEQ'USINE '  AID18
    C                     CAS            AID0
    C                     END
    C                     ENDSR
    C           AID0      BEGSR
     *          ---------------
     C                     WRITEWMINI
     C                     EXFMTWERR
    C                     ENDSR
      /SPACE 2
    C           AID3      BEGSR
     *          ---------------
     C                     CLEARDSDEV
     C                     MOVEL'GRPS'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSDEV
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      GROUPE
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID18     BEGSR
     *          ---------------
     C                     CLEARDSDEV
     C                     MOVEL'USDE'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSDEV
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      USINE
F1  C                     END
    C                     ENDSR
     OF2F2F2F2E                MAJ01
     O                         LIMULS
     OPRODUIF2E                MAJPRO
     O                         INCLU
**
IMPRESSION
FABRICATION
LIVRAISON
**
F.O.B
CAF OU CIF
C ET F
F.A.S
DEP USINE
FRANC DEST
FRANC FRON
**
PRE-IMPRIME STOCKE
**

==>  PRIX EN EUROS  <==

==> PRIX EN DEVISES <==

  (F6= prix en euros)
 (F6= prix en devises)
d'impression :
de façonnage :
d'expédition :
