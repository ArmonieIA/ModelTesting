     *************************************************
     ** TRAITEMENT GENERAL POUR LE CALCUL DES DEVIS **
     *************************************************
     *
     *****************************************************************
     *    module A  : formatage f.tarif2 --> zones pour calcul .
     *                   "      f.matpre --> marge maxi sur papier .
     *      "    B  : majoration matieres pour les dechets roulage .
     *      "    C  : valorisation support a support si il est utilise
     *      "    D  :       "      des encres et, des colles au 100m2.
     *      "    E  : calcul de la surface a l'unite de vente .
     *      "    F  : calcul des surfaces diverses .
     *      "    G  : calcul du transport .
     *      "    H  : valorisation des emballages au 100m2 .
     *      "    I  : faconnage plus valorisation .      |  1 SEUL MODULE
     *      "    J  : pre-impression plus valorisation . |  =============
     *      "    K  : matieres assemblage .
     *      "    N  : calcul total des matieres .
     *      "    T  : totalisation de la valorisation
     *      "    P  : PRICING
     *    ------------------------------------------------------------
     *                              <-------module-------------->
     * debut du programme --------> -A- - - - - - - - - - - - - -
     *
     * lecture d'un enreg.--------> - -E-C-D-H-F-G-I-J-B-K-N-T- -
     *
     * meme enregistrement ------->
     * si plusieur quantite ------> - - -C- - -F-G-I-J-B-K-N-T- -
     *
     *    ------------------------------------------------------------
     *
     *  A0  Devis
     *  A6  Fiche tecbnique
     *  I0  Devis pré-imprimé stocké               ---> A0
     *  I6  Fiche technique pré-imprimé stocké     ---> A6
     *  A1  Simulation BE
     *  AC     "       autre que BE
     *  A3     "       Panel PVS
     *  B3     "         "   PRU
     *  C3     "       Enquêtes
     *  D3     "       Panel Sofhunic PVS          ---> A3
     *  E3     "         "      "     PRU          ---> B3
     *  A4  Réactualistion pré-imprimé
     *  A2  Passage commande calcul PVS
     *  OB     "        "       "   PRU - passage bidon
     *  OR     "        "       "   PRU -    "    réél
     *  CX     "        "       "   PRU -    "     "    pour compléxe
     *  SU  Suivi de Production                 1° GAUFRAGE AVANT
     *  SP  Simulation PRU                      OND/CCOL
     *  CI  Simulation PRU EN CDI POUR DEVANA  =  SP
     *  AB  Objectif de production
     *  PR  Création et maj Produit
     *
     *    ------------------------------------------------------------
     *  TAG POUR OPÉRATION FACONNAGE
     *        FACO1    --> 2° ASSEMBLAGE
     *        FACO2    --> 1° ASSEMBLAGE
     *        FACO3    --> FENETRE
     *        FACO4    --> DECORTICAGE
     *        FACO5    --> DECOUPAGE
     *        FACO6    --> D
     *        FACO7    --> ONDULATION
     *        FACO8    --> POST PRINT 1° PASSAGE - AFFICHAGE
     *        FACO9    --> CONTRE COLLAGE
     *        FACO10   --> 1° GAUFRAGE AVANT OND/CCOL
     *        FACO11   --> COMPLEXAGE
     *        FACO12   -->    "
     *        FACO13   --> MASSICOT
     *        FACO14   --> COUPEUSE
     *        FACO15   --> POST PRINT 2° PASSAGE
     *        FACO16   --> 1° GAUFRAGE APRES OND/CCOL
     *        FACO17   --> 2° GAUFRAGE AVANT OND/CCOL
     *        FACO18   --> 2° GAUFRAGE APRES OND/CCOL
     *        FACO19   --> REACTEUR
     *        FACO20   --> RETOURNEMENT PILE
     *        FACO21   --> CONDITIONNEMENT FEUILLE D'ONDULÉ
     *        FACO22   --> FICELEUSE
     *        FACO23   --> CANNELURES CROISSÉE (OND/CC + CC)
     *        FACO24   --> COUPE AFFICHE EN DEUX
     *        FACO25   --> PELLICULEUSE APRES IMPRESSION OU SANS IMP.
     *        FACO26   --> DORURE
     *        FACO27   --> PEINTURE SUR TRANCHE
     *        FACO28   --> POSE OEILLET
     *
     *****************************************************************
     * TMAFBU LE 24/09/14 : CHANGEMENT USINE = 2 SECT = 5 SSECT = 1
     * MAC = 14 PAR MAC = 17 DANS LE CAS COMMERCIAL (FACO5)
     * TMAFBU LE 20/11/14 : PANEL SOCIETE ET PANEL SOF 'A3' A METTRE
     * AU TARIF COMMERCIAL 'C'
     * TMAFBU LE 03/06/15 : ARIANE EN CAISSE
     * PENALISER DE 20% LA CADENCE DE DECORTICAGE : ROUTINE KOARI
     * TMAFBU LE 14/12/15 : INTEGRATION MACHINE OEILLET
     * NOUZIERES 26/02/16 : AJOUT NOUVEAU CODE ADHESIF : D
     * TMAFBU    25/07/16 : GARDER TPSTOT SI POND CAD 99999 ONDULATION
     *****************************************************************
    FDEVCALL4UF  E           K        DISK
     FDEVCALL2IF  E           K        DISK
    FPREIMPL UF  E           K        DISK                      A
     FPARAME  IF  E           K        DISK
     FMATPREL1IF  E           K        DISK
     FQUAUSI  IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
     F            PREIMPF1                          KRENAMEPREIMPF2
     FTARIF2  IF  E           K        DISK
     FCADDEC  IF  E           K        DISK
     FCOUHOR  IF  E           K        DISK
     FPONDCM  IF  E           K        DISK
     FCASPAR  IF  E           K        DISK
     FMAXDEC  IF  E           K        DISK
     FXTBASE01IF  E           K        DISK
     FOFPAS   IF  E           K        DISK                           UC
     FCLISTAL1IF  E           K        DISK
     FCXHLIGL2IF  E           K        DISK
     FCXHENTL1IF  E           K        DISK
     FPOIGNEL1IF  E           K        DISK
     FFTYPOPL1IF  E           K        DISK
     FFCODINL1IF  E           K        DISK
     FTAUFSC  IF  E           K        DISK
     FACCVALL1IF  E           K        DISK
    FPLANIF7 O   E                    DISK
    FPLAIMP7 O   E                    DISK
    FBESOMAT O   E                    DISK
    FBESOFA  O   E                    DISK
    FBESOIM  O   E                    DISK
    FSDEVIS  O   E                    DISK
    FDEVRES  O   E                    DISK
     FERRDEVISO   F     198     OA     PRINTER
    FOBJCAS  O   E                    DISK
     * tableaux pour traitement des supports .
     E                    PAPI        7  3               QUAL.PAPIER
     E                    GRAM        7  3 0             GRAM.PAPIER
     E                    ADPA        7  6               REFERENCE F.
     E                    ADGR        7  3 0             GRAMMAGE REEL
     E                    APP         7  1               COUP/FORMAT BOB.
     E                    RASP        7  3 2
     E                    RA1         5  3 2
     E                    RA2         5  3 2
     * tableau des couts directs par support .
     E                    TACO        7  6 2
     * tableau des valeurs ventes au 100m2 par support .
     E                    TAVA        7  6 2
     * tableau des valeurs ventes a l'unite de vente par support .
     E                    TALU        7  7 2
     E                    TSTO        7  7 2
     * tableau des qualites et grammages papier .
     E                    QUAL        7 18
     * tableau des coefficients d'allongement par support .
     E                    TALO        7  3 2
     * tableau des erreurs programme .
     E                    ERR1      100  2 0                 INDEX
     E                    ERR2      100 20                   REF.
     E                    ERR     1  64 70
     E                    ERR3       32140
     * tableaux pour traitement faconnage/pre-impression .
     E                    RO         14  4 2
     E                    ROU        14  7 2
     E                    RMA        14  5 0
     E                    REG        14  6 0
     E                    TSS        14  2 0
     E                    PRD        14  3 2
     E                    PRG        14  3 2
     E                    PRO        14  3 2
     E                    PEF        14  1 0
     E                    PDE        14  3 1
     E                    RET        14  4 2
     E                    ROC        14  5 0
     * tableaux pour traitement OFFSET
     E                    MAJO    1  29 16
     E                    COLO       10  1
     E                    VERA       10  1
     E                    TMA        10  2 0
     E                    OVR     1  13 40               OVRDBF/MEMBRES
     E                    LIB     1   4 20               LIBELLE DIVERS
     E                    LMA       200  1               LIBELLE MATIERE
     E                    COCXE       3  1 0
     E                    DFX        12  2
     E                    DSF        12  5 0
     * tableaux pour traitement des vernis
     E                    V1          2  1
     E                    V2          2  1
     E                    V3          2  1
     E                    TV1         2  1
     E                    TV2         2  1
     E                    TV3         2  1
     E                    PVR         2  1
     E                    MOR         4  1
     E                    OFX         9  2
     E                    OSF         9  5 0
     IOFPASF
     I              QTES                            KINDUS
     ICLISTAF1
     I              TAUX                            STTAUX
     I              GROUPE                          STGROU
     ITARIF2F1
     I              FORSTO                          FORSTT
     IDEVCALF
     I              GROUPA                          AMALS
     I              TIMPEX                          IMPEXT
     I              TIMPIN                          IMPINT
     I              PAP1                            PAPI,2
     I              PAP2                            PAPI,3
     I              PAP3                            PAPI,4
     I              PAP4                            PAPI,5
     I              PAP5                            PAPI,6
     I              GRA1                            GRAM,2
     I              GRA2                            GRAM,3
     I              GRA3                            GRAM,4
     I              GRA4                            GRAM,5
     I              GRA5                            GRAM,6
     I              ADPA1                           ADPA,2
     I              ADPA2                           ADPA,3
     I              ADPA3                           ADPA,4
     I              ADPA4                           ADPA,5
     I              ADPA5                           ADPA,6
     I              ADGR1                           ADGR,2
     I              ADGR2                           ADGR,3
     I              ADGR3                           ADGR,4
     I              ADGR4                           ADGR,5
     I              ADGR5                           ADGR,6
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRDI1                           PRD,1
     I              PRDI2                           PRD,2
     I              PRDI3                           PRD,3
     I              PRDI4                           PRD,4
     I              PRDI5                           PRD,5
     I              PRDI6                           PRD,6
     I              PRDI7                           PRD,7
     I              PRDI8                           PRD,8
     I              PRDI9                           PRD,9
     I              PRDI10                          PRD,10
     I              PRDI11                          PRD,11
     I              PRDI12                          PRD,12
     I              PRDI13                          PRD,13
     I              PRDI14                          PRD,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     I              PROU1                           PRO,1
     I              PROU2                           PRO,2
     I              PROU3                           PRO,3
     I              PROU4                           PRO,4
     I              PROU5                           PRO,5
     I              PROU6                           PRO,6
     I              PROU7                           PRO,7
     I              PROU8                           PRO,8
     I              PROU9                           PRO,9
     I              PROU10                          PRO,10
     I              PROU11                          PRO,11
     I              PROU12                          PRO,12
     I              PROU13                          PRO,13
     I              PROU14                          PRO,14
     I              PEFF1                           PEF,1
     I              PEFF2                           PEF,2
     I              PEFF3                           PEF,3
     I              PEFF4                           PEF,4
     I              PEFF5                           PEF,5
     I              PEFF6                           PEF,6
     I              PEFF7                           PEF,7
     I              PEFF8                           PEF,8
     I              PEFF9                           PEF,9
     I              PEFF10                          PEF,10
     I              PEFF11                          PEF,11
     I              PEFF12                          PEF,12
     I              PEFF13                          PEF,13
     I              PEFF14                          PEF,14
     I              PDEC1                           PDE,1
     I              PDEC2                           PDE,2
     I              PDEC3                           PDE,3
     I              PDEC4                           PDE,4
     I              PDEC5                           PDE,5
     I              PDEC6                           PDE,6
     I              PDEC7                           PDE,7
     I              PDEC8                           PDE,8
     I              PDEC9                           PDE,9
     I              PDEC10                          PDE,10
     I              PDEC11                          PDE,11
     I              PDEC12                          PDE,12
     I              PDEC13                          PDE,13
     I              PDEC14                          PDE,14
     I              ROCA1                           ROC,1
     I              ROCA2                           ROC,2
     I              ROCA3                           ROC,3
     I              ROCA4                           ROC,4
     I              ROCA5                           ROC,5
     I              ROCA6                           ROC,6
     I              ROCA7                           ROC,7
     I              ROCA8                           ROC,8
     I              ROCA9                           ROC,9
     I              ROCA10                          ROC,10
     I              ROCA11                          ROC,11
     I              ROCA12                          ROC,12
     I              ROCA13                          ROC,13
     I              ROCA14                          ROC,14
     I              RETP1                           RET,1
     I              RETP2                           RET,2
     I              RETP3                           RET,3
     I              RETP4                           RET,4
     I              RETP5                           RET,5
     I              RETP6                           RET,6
     I              RETP7                           RET,7
     I              RETP8                           RET,8
     I              RETP9                           RET,9
     I              RETP10                          RET,10
     I              RETP11                          RET,11
     I              RETP12                          RET,12
     I              RETP13                          RET,13
     I              RETP14                          RET,14
     I              RASP11                          RA1,1
     I              RASP12                          RA1,2
     I              RASP13                          RA1,3
     I              RASP14                          RA1,4
     I              RASP15                          RA1,5
     I              RASP21                          RA2,1
     I              RASP22                          RA2,2
     I              RASP23                          RA2,3
     I              RASP24                          RA2,4
     I              RASP25                          RA2,5
     I              TAVA1                           TAVA,2
     I              TAVA2                           TAVA,3
     I              TAVA3                           TAVA,4
     I              TAVA4                           TAVA,5
     I              TAVA5                           TAVA,6
     I              DFPXF1                          DFX,1
     I              DFPXF2                          DFX,2
     I              DFPXF3                          DFX,3
     I              DFPXF4                          DFX,4
     I              DFPXF5                          DFX,5
     I              DFPXF6                          DFX,6
     I              DFPXF7                          DFX,7
     I              DFPXF8                          DFX,8
     I              DFPXF9                          DFX,9
     I              DFPXFA                          DFX,10
     I              DFPXFB                          DFX,11
     I              DFPXFC                          DFX,12
     I              DSFF1                           DSF,1
     I              DSFF2                           DSF,2
     I              DSFF3                           DSF,3
     I              DSFF4                           DSF,4
     I              DSFF5                           DSF,5
     I              DSFF6                           DSF,6
     I              DSFF7                           DSF,7
     I              DSFF8                           DSF,8
     I              DSFF9                           DSF,9
     I              DSFFA                           DSF,10
     I              DSFFB                           DSF,11
     I              DSFFC                           DSF,12
     I              ICEE3                           PTDIF
     I              IAEE3                           PTENC
     I              ODF1EP                          OFX,1
     I              ODF2EP                          OFX,2
     I              ODF3EP                          OFX,3
     I              ODF1ER                          OFX,4
     I              ODF2ER                          OFX,5
     I              ODF3ER                          OFX,6
     I              ODF1IP                          OFX,7
     I              ODF2IP                          OFX,8
     I              ODF3IP                          OFX,9
     I              ODS1EP                          OSF,1
     I              ODS2EP                          OSF,2
     I              ODS3EP                          OSF,3
     I              ODS1ER                          OSF,4
     I              ODS2ER                          OSF,5
     I              ODS3ER                          OSF,6
     I              ODS1IP                          OSF,7
     I              ODS2IP                          OSF,8
     I              ODS3IP                          OSF,9
     IDEVCAL2
     I              ANDEV                           XNDEV
     I              ETUDE                           XTUDE
     I              SEQDE                           XEQDE
     IPREIMPF1
     I              UVENTP                          UVENT
     I              USINEP                          USINE
     I              QTTOTP                          QTTOT
     I              QTFABP                          QTFAB
     I              QTPREP                          QTPRE
     I              QTRENP                          QTREN
     I              PAPIS                           PAPI,3
     I              GRAMS                           GRAM,3
     I              ADPAPS                          ADPA,3
     I              ADGRAS                          ADGR,3
     I              FORLS                           FORL
     I              FORHS                           FORH
     I              TIMPS                           IMPEXT
     I              TSS                             TSEXT
     I              ENCRS                           ENCEX
     I              GRAPS                           DDEEX
     I              TVERS                           TVEEX
     I              CVERS                           CVEEX
     I              ENSPS                           ESPEX
     I              APLAS                           DAPEX
     I              ORCUS                           OREX
     I              UVS                             UVEXT
     I              RUVS                            UVEXTR
     I              OFPA1S                          GP1EX
     I              OFPA2S                          GP2EX
     I              TREPS                           RIMPEX
     I              RETSS                           TSEXTR
     I              RCOUS                           COUEXR
     I              RENCS                           ENCEXR
     I              RGRAS                           DDEEXR
     I              RVERS                           TVEEXR
     I              RCVES                           CVEEXR
     I              RASPES                          RASP,3
     I              ESPES                           FLUEX
     I              CESPES                          CFLUEX
     I              RESPES                          FLUEXR
     I              RCESPS                          CFLEXR
     I              RAPLAS                          DAPEXR
     I              ROFP1S                          GP1EXR
     I              MIMRS5                          GRPEX
     I              RMIRS5                          GRPEXR
     IPREIMPF2
     I              ETUDE                           WW2
     I              SEQDE                           WW3
     I              TSS                             WW4
     ICXHLIGF1
     I              PAPI                            PAPCX
     ICXHENTF1
     I              PAPI                            PAPCX
     IQUAUSIF1
     I              PAPI                            WW5
     I              USINE                           WW6
     IMATPREF1
     I              PAPI                            WW5
     I              GRAMM                           WW7
     I              MARGE                           MMARGE
     I              FOUB                            WW9
     ICADDECF1
     I              USINE                           WW6
     ICOUHORF
     I              USINE                           WW6
     IPONDCMF1
     I              USINE                           WW6
    I*
     I/COPY QRPGSRC,XVERDS
     I/COPY QRPGSRC,XPOODS
     I/COPY QRPGSRC,XPTEDS
     I/COPY QRPGSRC,XPTPDS
     IREFDS       DS
     * information concernant les incompatibilites au cours
     * du traitement d'un devis, simulation, ou d'une commande .
     I                                        1   20ANDEV
     I                                        4   70ETUDE
     I                                        9  120SEQDE
     I I            0                        14  170NOCLI
     I I            0                        19  220WNOPRO
     I                                       24  43 MSGMSG
     I/SPACE 2
     * definition des data structures du fichier "CADDEC" .
     *                     section helio
     IDSHELI      DS                             10
     I                                        1   1 HELPR
     I                                        2   2 HELABC
     I                                        3   30HELCOU
     I                                        4   4 HELTS
     I                                        5   5 HELVER
     *                     section flexo
     IDSFLEX      DS                             10
     I                                        1   1 FLEPR
     I                                        2   2 FLEABC
     I                                        3   30FLECOU
     I                                        4   4 FLEVER
     I                                        5   5 FLETS
     *                     section jagenberg
     IDSJAGE      DS                             10
     I                                        1   30JAGGRA
     I                                        4   70JAGDEV
     I                                        8  100JAGLAI
     *                     section bobineuse
     IDSBOBI      DS                             10
     I                                        1   30BOBIGR
     I                                        4   40BOBIPO
     I                                        5   70BOBILA
     *                     section offset
     IDSOFFS      DS                             10
     I                                        1   1 OFFPR
     I                                        2   2 OFFABC
     I                                        3   30OFFCOU
     I                                        4   4 OFFVER
     *                     section ondulation
     IDSOND       DS                             10
     I                                        1   10ONDCOL
     I                                        2   20ONDOND
     I                                        3   30ONDFAC
     I                                        4   4 ONDCOU
     I                                        5   70ONDGRA
     *                     section contre collage
     IDSCCOL      DS                             10
     I                                        1   10COLCOL
     I                                        2   20COLON
     I                                        3   3 COLCOU
     *                     section complexage
     IDSCOMP      DS                             10
     I                                        1   10COMCOL
     I                                        2   2 COMIMP
     I                                        3   4 COMCLL
     I                                        5   5 COMCOU
     I                                        6   80COMGR
     *                     section typo
     IDSTYPO      DS                             10
     I                                        1   1 TYPABC
     I                                        2   20TYPCOU
     I                                        3   40TYPEN
     *                     section autoplatines
     IDSAUTO      DS                             10
     I                                        1   10SPOND
     I                                        2   20SPCC
     I                                        3   3 SPDEC
     I                                        4   60SPPOSE
     I                                        7   8 SPGA
     *                     section jurines
     IDSJURI      DS                             10
     I                                        1   10JUOND
     I                                        2   20JUCC
     I                                        3   3 JUDEC
     I                                        4   60JUPOSE
     *                     section decoupage annexes
     IDSDECA      DS                             10
     I                                        1   10DECOND
     I                                        2   20DECCC
     I                                        3   60DECUNI
     *                     section contrôle/tri
     IDSCTRI      DS                             10
     I                                        1   1 CTRTYP
     I                                        2   50CTRUNI
     *                     section decorticage
     IDSDCOR      DS                             10
     I                                        1   1 DCORTI
     I                                        2   20DCOOND
     I                                        3   30DCOCC
     I                                        4   60DCOPOS
     *                     section fenetres
     IDSFEN       DS                             10
     I                                        1   40FENPAS
     I                                        5   80FENGAI
     *                     section plieuses
     IDSPLIE      DS                             10
     I                                        1   20ASSCOD
     I                                        3   30ASSOND
     I                                        4   40ASSCC
     I                                        5   5 ASSDIF
     I                                        6   6 ASSJUM
     I                                        7  100ASSPAS
     *                     section poignees
     IDSPOIG      DS                             10
     I                                        1   20ERTCOD
     *                     section easy press
     IDSEASY      DS                             10
     I                                        1   1 KEASY
     *                     section DORURE    es
     IDSDOR       DS                             10
     I                                        1   1 DORNAT
     I                                        2   2 DORDIF
     I                                        3   50DORPOS
     *                     Section Oeillet
     IDSOEI       DS                             10
     I                                        1   3 OEICAD
     I                                        4   50OEINBO
     I                                        6   6 OEIMOD
     I                                        7   80OEINBA
     I/SPACE 2
     * information pour les erreurs d'exceptions .
     I           SDS
     I                                     *STATUS  ERREUR
     I                                       21  28 SGAP
    I*
     I            DS
     I                                        1   3 COCXE
     I                                        1   10COUE1
     I                                        2   20COUE2
     I                                        3   30COUE3
    I*
     I            DS
     I                                        1  18 QUL
     I                                        1   3 PAPIK
     I                                        5   70GRAMK
     I                                        9  14 ADPAK
     I                                       16  180ADGRK
     I            DS
     I                                        1  18 QULS
     I                                        1   3 PAPIS
     I                                        5   70GRAMS
     I                                        9  14 ADPAPS
     I                                       16  180ADGRAS
     I            DS
     I                                        1  40 TAG401
     I                                        1   20MAIME1
     I                                        3   40MAIME2
     I                                        5   60MAIME3
     I                                        7   80MAIME4
     I                                        9  100MAIME5
     I                                       11  120MAIMI1
     I                                       13  140MAIMI2
     I                                       15  160MAIMI3
     I                                       17  180MAIMI4
     I                                       19  200MAIMI5
     I                                       21  220MAOND1
     I                                       23  240MACOL1
     I                                       25  25 USSPE
     I                                       26  26 USSPI
     I                                       29  30 MADEC1
     I                                       31  320MAAUT1
     I                                       33  340MAFEN1
     I                                       35  360MAAS11
     I                                       37  380MAAS21
     I                                       40  40 CFORM
     I            DS
     I                                        1  40 TAG402
     I                                        1   1 SECTS
     I                                        2   2 SSECTS
     I                                        1   2 ZZSS
     I                                        3   4 NOMACS
     I                                        5   50NOPASS
     I                                        6   60SUIMPS
     I                                        7   7 PROBJ
     I                                        8  140QTENES
     I                                       15  160MAGAU1
     I                                       17  180DECA1
     I                                       19  190CDEOBJ
     I                                       21  220MAIRE1
     I                                       23  240MAIRE2
     I                                       25  260MAIRE3
     I                                       27  280MAIRE4
     I                                       29  300MAIRE5
     I                                       31  320MAIRI1
     I                                       33  340MAIRI2
     I                                       35  360MAIRI3
     I                                       37  380MAIRI4
     I                                       39  400MAIRI5
     I            DS
     I                                        1  40 TAG403
     I                                        1   10USOND
     I                                        2   20USCOL
     I                                        3   30USDEC
     I                                        4   40USAUT
     I                                        5   50USFEN
     I                                        6   60USAS1
     I                                        7   70USAS2
     I                                        8  120NCONF
     I                                       13  160NOPRO
     I                                       17  200DISTA
     I                                       25  280FORLST
     I                                       29  320FORHST
     I                                       33  330USGAU
     I                                       34  350MAGAU2
     I                                       36  36 MASSI
     I                                       37  370USMAS
     I                                       38  390MAMAS
     I                                       40  40 EI
     I            DS
     I                                        1  40 TAG404
     I                                        1   20AGRAF
     I                                        3   3 COLV1
     I                                        4   4 COLV2
     I                                        5   5 MTPS1
     I                                        6   6 MTPS2
     I                                        7   7 PATS1
     I                                        8   8 PATS2
     I                                        9   9 RELC1
     I                                       10  10 RELC2
     I                                       11  11 ZB13
     I                                       12  12 ZB14
     I                                       13  13 ZB15
     I                                       15  15 XAPPS
     I                                       16  17 CONDI
     I                                       18  18 REPCO
     I                                       19  20 TSOND
     I                                       21  210NBRFE
     I                                       22  270CADEC
     I                                       28  310FMASL
     I                                       32  350FMASD
     I                                       36  40 POSGAF
     I            DS
     I                                        1   2 TYPPOI
     I                                        1   1 TYPP
     I                                        2   2 POIGNE
     I            DS
     I                                        1   2 TYPFEN
     I                                        2   2 RHODO
     I            DS
     I                                        1   3 TDECO
     I                                        1   1 MACDEC
     I                                        2   2 TYPDEC
     I                                        3   3 DECORT
     I            DS
     I                                        1   6 CLII1
     I                                        1   1 FIOND
     I                                        2   3 GFRA2
     I                                        4   5 TYPPCH
     I I            '0'                       6   6 NBPCHA
    I*
     I            DS
     I                                        1  16 QUAPP1
     I                                        1   3 PAFIL1
     I                                       16  16 INVPP1
     I            DS
     I                                        1  16 QUAPP2
     I                                        1   3 PAFIL2
     I                                       16  16 INVPP2
     I            DS
     I I            0                         1   21ENCI3
     I                                        1   10DECPP1
     I                                        2   20DECPP2
     I            DS
     I                                        1  16 QUAPPM
     I                                        1   3 PAFILM
     I                                        4   60GRFILM
     I                                        7  12 REFILM
     I                                       13  150GFFILM
     IDEV030      DS                            221
     I                                        1   2 DSBL
     I                                        3   40ANDEVZ
     I                                        5   80ETUDEZ
     I                                        9  120SEQDEZ
     I                                       13  130CCO030
     I                                       14  140OND030
     I                                       15  150FACON
     I                                       16  170COAS1
     I                                       18  190COAS2
     I                                       20  210SIDD
     I                                       22  282TOTEMB
     I                                       29  342EMBDIV
     I                                       35  402CAISSE
     I                                       41  462PALET
     I                                       47  522BANROL
     I                                       53  582CERCLA
     I                                       59  642HOUSSE
     I                                       65  702EMBFOR
     I                                       71  95 LIBEM1
     I                                       71  71 PQFL1
     I                                       73  73 PQFL2
     I                                       96 135 LIBEM2
     I                                      107 111 PQFL3
     I                                      136 160 LIBEM3
     I                                      161 200 LIBEM4
     I                                      201 201 ERRE
     I                                      202 202 EMBZ1
     I                                      203 203 EMBZ2
     I                                      204 204 EMBZ3
     I I            0                       205 2072KEMB
     I                                      208 208 RLXPLV
     I I            0                       209 2110HPAL30
    I* EMBZ1 = P  ---> PALETTE
    I* EMBZ2 = P  ---> PAQUETS
    I* EMBZ3 = O  ---> DIRECT SUR PALETTES
     IDEV040      DS                            200
     I                                        1   2 DSGP40
     I                                        3   30STE40
     I                                        4   70CLI40
     I                                        8  120NCON40
     I                                       13  160PRO40
     IDEV112      DS                             67
     I                                        1   10USINE
     I                                        2   30LIEU
     I                                        4   60CPAYFO
     I                                        7   8 RPAYS
     I                                        9   90OND112
     I                                       10  100CCO112
     I                                       11  120COA112
     I                                       13  130FAC112
     I                                       14  212SURFUV
     I                                       22  261PDUN
     I                                       27  290HPA112
     I                                       30  360WAGON
     I                                       37  380LGPLAT
     I                                       39  450QTLIV
     I                                       46  482PORKG
     I                                       49  572PORTLI
     I                                       58  632PORTUV
     I                                       64  64 ERR112
     I                                       65  650UVENT
     I                                       66  670DDH112
     IDEV026      DS                             35
     I I            'D'                       1   1 ODP
     I I            'I'                       2   2 IM
     I                                        3   4 XZ1
     I                                        5   8 XZ2
     I                                        9  12 XZ3
     I                                       13  14 PELAFF
     I                                       15  15 AFFIC
     I I            0                        16  190LA1
     I I            0                        20  230HA1
     I I            0                        24  270LA2
     I I            0                        28  310HA2
     I I            0                        32  320WIA1
     I I            0                        33  330WIAR1
     I I            0                        34  340WIA2
     I I            0                        35  350WIAR2
     IDEV074      DS                             13
     I                                        1   2 PDSGP
     I                                        3   40PANDEV
     I                                        5   80PETUDE
     I                                        9  120PSEQDE
     I                                       13  13 PTYPE
     IPOOL02      DS                             51
     I                                        1   10STEP
     I                                        2   50NOCLIP
     I                                        6   90NOPROP
     I                                       10  100USP
     I                                       11  11 SECTP
     I                                       12  12 SSECTP
     I                                       13  13 INN
     I                                       21  220NOMAC1
     I                                       23  240NOMAC2
     I                                       25  260NOMAC3
     I                                       41  420ANDEVP
     I                                       43  460ETUDEP
     I                                       47  500SEQDEP
     I                                       51  51 DEVISP
     I            DS
     I                                        1   2 SS
     I                                        1   1 SECT
     I                                        2   2 SSECT
     I            DS
     I I            0                         1   21CVEI3
     I                                        1   10DD1
     I                                        2   20DD2
     I            DS
     I                                        1  10 TPOSTE
     I                                        8   8 TPO8
     I                                        9   9 TPO9
     I                                       10  10 TPO10
     I            DS
     I                                        1   4 LGBAX
     I                                        5   5 PSBA
     I                                        6   6 PELLI
     I                                        7   7 AFFI
     I                                        1  10 CALLIB
     I            DS
     I                                        1   10COUI1
     I                                        2   31ENCI1
     I                                        1   30PTNBR
     *  MATERM USINE OFFSET EXT + INT + NB COULEUR EXT REPIQUAGE
     I            DS
     I                                        1   50MATERM
     I                                        1   10USIMAC
     I I            0                         2   30NOTUSE
     I                                        4   50ONBCER
     C/EJECT
     C           *ENTRY    PLIST
     C                     PARM           DSGP    2
     C/SPACE 1
     C           CLEPAR    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
    C*-------------------
     C           KTBA01    KLIST
     C                     KFLD           TBLNOM
     C                     KFLD           TBVARG
     C                     KFLD           TBNSEG
    C*-------------------
     C           CLE1      KLIST
     C                     KFLD           XNDEV   20
     C                     KFLD           XTUDE   40
     C                     KFLD           XEQDE   40
    C*-------------------
     C           CLE2      KLIST
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
    C*-------------------
     C           CLEQUA    KLIST
     C                     KFLD           USPAP
     C                     KFLD           PAPI,S
     C                     KFLD           GRAM,S
     C                     KFLD           ADPA,S
     C                     KFLD           ADGR,S
     C                     KFLD           FOUB
    C*-------------------
     C           CLEQUX    KLIST
     C                     KFLD           USCXH   10
     C                     KFLD           QUACXH
     C                     KFLD           GRACXH
     C                     KFLD           ADPCXH
     C                     KFLD           ADGCXH
     C                     KFLD           FBCXH   1
    C*-------------------
     C           CLEPRE    KLIST
     C                     KFLD           PAPI,S
     C                     KFLD           GRAM,S
     C                     KFLD           ADPA,S
     C                     KFLD           ADGR,S
    C*-------------------
     C           CLEPRX    KLIST
     C                     KFLD           QUACXH
     C                     KFLD           GRACXH
     C                     KFLD           ADPCXH
     C                     KFLD           ADGCXH
    C*-------------------
     C           CLEPRF    KLIST
     C                     KFLD           PAFILM
     C                     KFLD           GRFILM
     C                     KFLD           REFILM
     C                     KFLD           GFFILM
    C*-------------------
     C           CPREIM    KLIST
     C                     KFLD           NOI1    40
     C                     KFLD           NOI2    40
    C*-------------------
     C           CLEDEC    KLIST
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           CLEREC
    C*-------------------
     C           CLEDE1    KLIST
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
    C*-------------------
     C           CLEHOR    KLIST
     C                     KFLD           TYPE
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
    C*-------------------
     C           CLEPCM    KLIST
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           DECMAC
    C*-------------------
     C           CLEPAS    KLIST
     C                     KFLD           ENC
     C                     KFLD           VER
     C                     KFLD           COU
     C                     KFLD           KINDUS
    C*-------------------
     C           CLEPAX    KLIST
     C                     KFLD           ENC
     C                     KFLD           VER
     C                     KFLD           COU
    C*-------------------
     C           CLECAS    KLIST
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C           CLECA2    KLIST
     C                     KFLD           USFAB
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     C                     KFLD           TRAPAR
    C*-------------------
     C           CLEPRK    KLIST
     C                     KFLD           PAPIK
     C                     KFLD           GRAMK
     C                     KFLD           ADPAK
     C                     KFLD           ADGRK
    C*-------------------
     C           CLESTA    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
    C*-------------------
     C           CLEEYE    KLIST
     C                     KFLD           ACCCAT
     C                     KFLD           ACCCOD
    C*-------------------
     C/SPACE 1
     C                     Z-ADD*ZEROS    KEMB
     C                     Z-ADD*ZERO     FACON
     C                     Z-ADD*ZERO     CCOL
     C                     Z-ADD*ZERO     ONDUL
     C                     Z-ADD*ZEROS    COAS1
     C                     Z-ADD*ZEROS    COAS2
     C                     Z-ADDUDATE     DATDE
     C                     OPEN OFPAS
     C/SPACE 1
     *  -WC-  EGAL  AC  MAIS APPEL SANS SAISIE      *
     * -------------------------------------------- *
D1  C           DSGP      IFEQ 'WC'
     C                     MOVE 'AC'      DSGP
     C                     MOVE '*'       OFF2    1
F1  C                     END
     C/SPACE 1
     C                     SETOF                     U1U2U3
     C                     SETOF                     U4U5U6
     C                     SETOF                     U7U8
    C* CDE = 1 = TARIFIACTION COMMERCIALE
    C* SIM = 1 = DEVIS OU SIMUL SUR OFFRES
     C                     Z-ADD0         CDE     10
     C                     Z-ADD0         SIM     10
     ** OBJECTIF PRODUCTION
D1  C           DSGP      IFEQ 'AA'                            *
     C                     Z-ADD1         CDE
     C                     MOVE DSGP      DSGPS   2
     C                     MOVE 'AB'      DSGP
F1  C                     END                                  *
     ** CALCUL DEVIS **
D1  C           DSGP      IFEQ 'A0'                            *
     C                     SETON                     U1U7       * * *
     C                     Z-ADD1         CDE
     C                     Z-ADD1         SIM
F1  C                     END                                  *
     ** CALCUL DEVIS SIMULATION **
D1  C           DSGP      IFEQ 'A1'                            *
    C           DSGP      OREQ 'AC'                            *
     C                     SETON                     U1U8     * * *
     C                     Z-ADD1         CDE
F1  C                     END                                  *
     ** CALCUL DEVIS COMMANDES **
D1  C           DSGP      IFEQ 'A2'                            *
     C                     SETON                     U2       * * *
     C                     Z-ADD1         CDE
F1  C                     END                                  *
     ** CALCUL DEVIS SIMULATION SUR TARIF **
D1  C           DSGP      IFEQ 'A3'                            *
     C                     SETON                     U3       * * *
     C                     Z-ADD1         CDE
F1  C                     END                                  *
     ** CALCUL DEVIS SIMULATION SUR TARIF - PRU  **
D1  C           DSGP      IFEQ 'B3'                            *
     C                     SETON                     U3       * * *
F1  C                     END                                  *
     ** CALCUL DEVIS SIMULATION SUR ENQUETE **
D1  C           DSGP      IFEQ 'C3'                            *
     C                     SETON                     U3       * * *
     C                     Z-ADD1         CDE
F1  C                     END                                  *
     ** CALCUL DEVIS REACTUALISATION PRE-IMPREIME **
D1  C           DSGP      IFEQ 'A4'                            *
     C                     SETON                     U5       * * *
     C                     Z-ADD1         CDE
F1  C                     END                                  *
     ** CALCUL DEVIS PRIX DE REVIENT **
D1  C           DSGP      IFEQ 'A5'                            *
     C                     SETON                     U2       * * *
F1  C                     END                                  *
     ** SUIVI DE PRODUCTION          **
D1  C           DSGP      IFEQ 'SU'                            *
     C                     SETON                     U4       * * *
F1  C                     END                                  *
     ** CALCUL SIMULATION F - PRU  **
D1  C           DSGP      IFEQ 'SP'                            *
     C                     SETON                     U3       * * *
F1  C                     END                                  *
D1  C           DSGP      IFEQ 'CI'                            *
     C                     SETON                     U3       * * *
     C                     MOVE DSGP      DSGPS
     C                     MOVE 'SP'      DSGP
F1  C                     END                                  *
     ** ORDONNANCEMENT               **
D1  C           DSGP      IFEQ 'OR'                            *
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'PR'
     C                     SETON                     U2       * * *
F1  C                     END                                  *
     ** FICHE TECHNIQUE PLUS EDITION BIDON DES DEVIS POUR SERVICE STA.
D1  C           DSGP      IFEQ 'A6'                       DEVIS
     C                     SETON                     U6U7
     C                     Z-ADD1         CDE
     C                     Z-ADD1         SIM
F1  C                     END
     C/SPACE 2
     * -------------------------------------------- *
     * -CODE---SWITCH-----DESIGNATION-------------- *
     *  -A0-  U1 + U7 = CALCUL DEVIS .              *
     *  -A1-  U1 + U8 = CALCUL DEVIS SIMULATION BE  *
     *  -AC-  U1 + U8 = CALCUL DEVIS SIMUL. AUTRE BE*
     *  -A2-  U2      = PASSAGE COMMANDE .          *
     *  -A3-  U3      = SIMULATION TARIF .          *
     *  -A5-  U2      = PRIX DE REVIENT .           *
     *  -A4-  U5      = REACTUALISATION 'PREIMP2'   *
     *  -A6-  U6 + U7 = F.TECHNIQUE + EDT DEVIS .   *
     *  -OR-  U2      = ORDONNANCEMENT.             *
     *  -OB-  U2      = ORDONNANCEMENT. BIDON       *
     *  -SU-  U4      = SUIVI DE PRODUCTION.        *
     *  -PR-  U2      = CREATION PRODUIT            *
     * -------------------------------------------- *
     *  -WC-  EGAL  AC  MAIS APPEL SANS SAISIE      *
     * -------------------------------------------- *
     C                     Z-ADD0         CTR     50
    C*
     C           DEPART    TAG
D1  C           DSGP      IFEQ 'A4'
     C           PH1       TAG
     C                     READ PREIMPL                  80
    C   80                GOTO FINAL
    C           NOCLIS    CABNE0         PH1               NE PAS TRAITER
     C                     Z-ADD*ZEROS    ANDEV
     C                     MOVELCOULDS    COUEX
     C                     MOVE COULS     COUEX
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   APP,3
D2  C           COUPS     IFEQ 'R'
    C           COUPS     OREQ 'C'
     C                     MOVE COUPS     COUPEX
X2  C                     ELSE
     C                     MOVE COUPS     APP,3
F2  C                     END
     C                     Z-ADDQTTOT     QTTOT1
D2  C           QTFAB     IFNE *ZEROS
     C           QTTOT1    DIV  QTFAB     NBFAC1
F2  C                     END
     C                     Z-ADD1         NBLIV1
     C                     Z-ADD1         FRLIV1
     C                     Z-ADD0         NBIMP1
     C                     Z-ADD0         NBIRE1
D2  C           QTPRE     IFNE *ZEROS
     C                     Z-ADD1         NBIMP1
F2  C                     END
D2  C           QTREN     IFNE *ZEROS
     C           QTTOT1    SUB  QTPRE     QTREST
     C           QTREST    DIV  QTREN     NBIRE1
F2  C                     END
     C                     Z-ADD*ZEROS    QTTOT
     C                     Z-ADD*ZEROS    FMASL
     C                     Z-ADD*ZEROS    FMASD
     C                     Z-ADD3         SUPEXT
     C                     Z-ADDSEQDE     SSEQDE  40
     C                     Z-ADD1         LRAPS
     C                     Z-ADD1         TSS,1
     C                     Z-ADDPREXTS    PRD,1
     C                     Z-ADDKDIFS     PRO,1
     C                     Z-ADDEFEXTS    PEF,1
     C                     Z-ADDDECEXS    PDE,1
D2  C           RIMPEX    IFNE *ZEROS
     C                     Z-ADD2         TSS,2
     C                     Z-ADDPRREXS    PRD,2
     C                     Z-ADDRDIFS     PRO,2
     C                     Z-ADDEFREXS    PEF,2
     C                     Z-ADDDECRES    PDE,2
F2  C                     END
X1  C                     ELSE
     C                     READ DEVCALL4                 80
    C   80                GOTO FINAL
    C*
     C                     Z-ADD*ZEROS    NOAFF
     C                     MOVELLIBPR2    LIBP28  8
D2  C           LIBP28    IFEQ '** AFFIC'
     C                     MOVE LIBPR2    NOAFF   10
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'A1'                            *
    C           DSGP      OREQ 'AC'                            *
D3  C           TRAVA     IFEQ 'SO'
     C                     Z-ADD1         SIM
F3  C                     END
F2  C                     END                                  *
     C                     Z-ADDSEQDE     SSEQDE  40
     C                     MOVE *BLANK    RINAL   1
D2  C           TYPP      IFEQ 'R'
     C                     MOVE POIGNE    RINAL
F2  C                     END
     *
     C                     Z-ADDPDUNI     PDUN    51
D2  C           GARNT     IFNE *BLANKS
     C                     MOVELGARNT     GARNW   1
D3  C           GARNW     IFEQ 'A'
     C                     Z-ADDPDSGAR    PDUN
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD0         USAFF   10
     C                     Z-ADD0         USPP    10
     C                     Z-ADD0         USPT    10
     C                     Z-ADD0         USOEI   10
     C                     MOVE *BLANK    ETIQ1
     C                     MOVE *BLANK    ETIQ2
     C                     MOVE *BLANK    GENCO1  1
     C                     MOVE *BLANK    GENCO2  1
     * AFFICHAGE
D2  C           AFFI      IFNE *BLANK
     C                     Z-ADD2         USAFF
D3  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'A2'
     C                     MOVE 'P'       ODP
     C                     MOVE STE       XZ1       P
     C                     MOVE NOCLI     XZ2
     C                     MOVE SEQDE     XZ3
X3  C                     ELSE
     C                     MOVE ANDEV     XZ1
     C                     MOVE ETUDE     XZ2
     C                     MOVE SEQDE     XZ3
F3  C                     END
D3  C           OFF2      IFEQ '*'                        AP. SANS SAISIE
     C                     MOVE 'O'       ODP
F3  C                     END
     C                     CALL 'DEV026£'
     C                     PARM           DEV026
D3  C           AFFIC     IFEQ '1'
     C                     MOVE '*'       GENCO1
     C                     MOVE LA1       CLIE3
     C                     MOVE HA1       CLII3
F3  C                     END
D3  C           AFFIC     IFEQ '2'
     C                     MOVE '*'       GENCO1
     C                     MOVE LA2       CLIE3
     C                     MOVE HA2       CLII3
F3  C                     END
D3  C           AFFIC     IFEQ '3'
    C           AFFIC     OREQ '4'
     C                     MOVE '*'       GENCO1
     C                     MOVE '*'       GENCO2
     C                     MOVE LA1       CLIE3
     C                     MOVE HA1       CLII3
     C                     MOVE LA2       CLIE2
     C                     MOVE HA2       CLII2
F3  C                     END
F2  C                     END
     * PEINTURE
D2  C           PTDIF     IFNE *BLANK
     C                     Z-ADD2         USPT
F2  C                     END
     *
     C                     Z-ADD*ZEROS    XE      10
     C                     Z-ADD*ZEROS    XI      10
     C                     MOVE *BLANK    APP
D2  C           SUPEXT    IFNE *ZEROS
D3  C           NIMPE1    IFNE *BLANKS
     C                     Z-ADDSUPEXT    XE
D4  C           PAPI,2    IFEQ 'XXX'
    C           GRAM,2    ANDEQ999
     C                     Z-ADD3         XE
F4  C                     END
F3  C                     END
     C                     Z-ADDSUPEXT    S
     C                     MOVE APPEX     APP,S
D3  C           APPEX     IFEQ 'O'                        FORMAT NEUTRE
     C                     MOVE 'F'       APP,3            EXTERIEUR
F3  C                     END
X2  C                     ELSE
D3  C           APPEX     IFEQ 'F'                        FORMAT NEUTRE
    C           APPEX     OREQ 'O'                        FORMAT NEUTRE
     C                     MOVE 'F'       APP,3            EXTERIEUR
F3  C                     END
F2  C                     END
D2  C           SUPINT    IFNE *ZEROS
D3  C           NIMPI1    IFNE *BLANKS
     C                     Z-ADDSUPINT    XI
D4  C           PAPI,6    IFEQ 'XXX'
    C           GRAM,6    ANDEQ999
     C                     Z-ADD5         XI
F4  C                     END
F3  C                     END
D3  C           SUPINT    IFNE SUPEXT
     C                     Z-ADDSUPINT    S
     C                     MOVE APPIN     APP,S
D4  C           APPIN     IFEQ 'O'                        FORMAT NEUTRE
     C                     MOVE 'F'       APP,5            EXTERIEUR
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           APPIN     IFEQ 'F'                        FORMAT NEUTRE
    C           APPIN     OREQ 'O'                        FORMAT NEUTRE
D4  C           CCOL      IFEQ 7
     C                     MOVE 'F'       APP,4            INT. PELLIC.
X4  C                     ELSE
     C                     MOVE 'F'       APP,5            INTERIEUR
F4  C                     END
F3  C                     END
F2  C                     END
    C*
D2  C           CCOL      IFEQ 0
    C           ONDUL     ANDEQ0
D3  C           APPEX     IFNE *BLANK
     C                     MOVE APPEX     APP,3
X3  C                     ELSE
D4  C           APPIN     IFNE *BLANK
     C                     MOVE APPIN     APP,3
F4  C                     END
F3  C                     END
F2  C                     END
    C*
D2  C           LUTIL     IFNE *ZEROS
    C           LMINI     ANDNE*ZEROS
    C           LMINI     ANDNELUTIL
     C           LUTIL     DIV  LMINI     LRAPS   54
X2  C                     ELSE
     C                     Z-ADD1         LRAPS
F2  C                     END
    C*
     C                     MOVE ' '       NONSFM  1
D2  C           FLPEAP    IFEQ *ZEROS
    C           LZPEAP    ANDNE*ZEROS
     C                     MOVE FORL      FLPEAP
     C                     MOVE FORH      FHPEAP
     C                     MOVE '*'       NONSFM  1
F2  C                     END
    C*
     C                     Z-ADD*ZEROS    LZRAP   41
D2  C           FLPEAP    IFNE *ZEROS
D3  C           IAEI2     IFEQ 'O'
     C                     MOVE FHPEAP    LZRAP
X3  C                     ELSE
     C                     MOVE FLPEAP    LZRAP
F3  C                     END
X2  C                     ELSE
D3  C           LMINI     IFNE *ZEROS
     C                     Z-ADDLMINI     LZRAP
X3  C                     ELSE
D4  C           FORL      IFNE *ZEROS
     C                     MOVE FORL      LZRAP
X4  C                     ELSE
D5  C           ONDL      IFNE *ZEROS
     C                     MOVE ONDL      LZRAP
X5  C                     ELSE
D6  C           DECL      IFNE *ZEROS
     C                     MOVE DECL      LZRAP
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
    C*
D2  C           STCOD1    IFEQ 'A'
     C                     MOVE '*'       GENCO1
     C                     Z-ADD2         USAFF
F2  C                     END
D2  C           STCOD2    IFEQ 'A'
     C                     Z-ADD2         USAFF
D3  C           GENCO1    IFEQ '*'
     C                     MOVE '*'       GENCO2
X3  C                     ELSE
     C                     MOVE '*'       GENCO1
F3  C                     END
F2  C                     END
D2  C           STCOD3    IFEQ 'A'
     C                     Z-ADD2         USAFF
D3  C           GENCO1    IFEQ '*'
     C                     MOVE '*'       GENCO2
X3  C                     ELSE
     C                     MOVE '*'       GENCO1
F3  C                     END
F2  C                     END
D2  C           STCOD4    IFEQ 'A'
     C                     Z-ADD2         USAFF
D3  C           GENCO1    IFEQ '*'
     C                     MOVE '*'       GENCO2
X3  C                     ELSE
     C                     MOVE '*'       GENCO1
F3  C                     END
F2  C                     END
    C*
D2  C           IMPEXT    IFEQ 5
    C           IMPINT    OREQ 5
    C           IMPEXT    OREQ 3
    C           IMPINT    OREQ 3
     C                     Z-ADD3         USPP
F2  C                     END
    C* Usine pour Oeillet
D2  C           EYECOD    IFNE *BLANK
     C                     Z-ADD2         USOEI
F2  C                     END
    C*
     C                     SETOF                     81
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D3  C           USOND     IFNE *ZEROS
    C           USOND     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USCOL     IFNE *ZEROS
    C           USCOL     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USDEC     IFNE *ZEROS
    C           USDEC     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USAUT     IFNE *ZEROS
    C           USAUT     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USFEN     IFNE *ZEROS
    C           USFEN     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USAS1     IFNE *ZEROS
    C           USAS1     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USAS2     IFNE *ZEROS
    C           USAS2     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USGAU     IFNE *ZEROS
    C           USGAU     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USAFF     IFNE *ZEROS
    C           USAFF     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USPP      IFNE *ZEROS
    C           USPP      ANDNEUSINE
     C                     SETON                     81
F3  C                     END
D3  C           USOEI     IFNE *ZEROS
    C           USOEI     ANDNEUSINE
     C                     SETON                     81
F3  C                     END
F2  C                     END
    C*
F1  C                     END
D1  C           DSGP      IFEQ 'SU'
D2  C           SECTS     IFEQ '1'
    C           SSECTS    ANDEQ'3'
D3  C           ONDH      IFEQ 0
     C                     MOVE DECH      ONDM    43
X3  C                     ELSE
     C                     MOVE ONDH      ONDM
F3  C                     END
     C           ONDM      MULT QTENES    QTENES
F2  C                     END
F1  C                     END
     C/SPACE 5
     *<--------- DEBUT DU TRAITEMENT DU PROGRAMME ------------------>*
     C   U5                Z-ADDLMINIS    LMINI
     *<--------------------------------------------------->*
    C*          GP        IFEQ ' '
     C                     EXSR MODULA
    C*                    END
     C                     Z-ADD0         ERR1
     C                     MOVE *BLANKS   ERR2
     C/SPACE 1
D1  C           LUTIL     IFNE *ZEROS
     C           LUTIL     ADD  1         LUTILX  41
F1  C                     END
D1  C           LMINI     IFGT LUTILX
    C           LUTIL     ANDNE*ZEROS
    C           LRAPS     ORGE 2
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     Z-ADD32        ERR1,A
     C                     MOVE LMINI     Z9A
     C                     MOVELLUTIL     Z9A
     C                     MOVE Z9A       ERR2,A
F1  C                     END
     C/SPACE 2
     * lecture d'un enregistrement, formatage de depart .
     C                     MOVE ANDEV     ANDEVZ  20
     C                     MOVE ETUDE     ETUDEZ  40
     C                     MOVE SSEQDE    SEQDEZ  40
     C                     MOVE 'C'       GP      1
D1  C           DSGP      IFEQ 'AB'
     C                     MOVE 'B'       GP
F1  C                     END
     C                     MOVE '1'       *IN95
     * recherche des support en impression .
     C                     MOVE *BLANKS   COUPR   1
     C                     MOVE *BLANKS   INN96   1
     C                     MOVE *BLANKS   INN97   1
D1  C           IMPEXT    IFNE *ZEROS
     C                     MOVE '1'       INN96
D2  C           COUPEX    IFEQ 'R'
     C                     MOVE 'R'       COUPR
F2  C                     END
F1  C                     END
D1  C           IMPINT    IFNE *ZEROS
     C                     MOVE '1'       INN97
D2  C           COUPIN    IFEQ 'R'
     C                     MOVE 'R'       COUPR
F2  C                     END
F1  C                     END
     * si marquage sur complexeuse repéré  .
D1  C           CPECXH    IFEQ 'R'
    C           CPICXH    OREQ 'R'
     C                     MOVE 'R'       COUPR
F1  C                     END
     *
     C/SPACE 3
     * enchainement de depart .
     * MISE A ZEROS ZONES
     C           GP2       TAG
     C                     EXSR BLKDS
     C                     Z-ADD0         SPPOS   30
     C                     Z-ADD0         TOTAMT
     C                     Z-ADD0         TOTDIR
     C                     Z-ADD0         QTLIV
     C                     Z-ADD0         TOROUL
     C                     Z-ADD0         REGUNT
     C                     Z-ADD0         STFIXF
     C                     Z-ADD0         STFIXE
     C                     Z-ADD0         STFIIN
     C                     Z-ADD0         STVAFF
     C                     Z-ADD0         STVARE
     C                     Z-ADD0         STVARI
     C                     Z-ADD0         TOTDHT
     C                     Z-ADD0         STOCA
     C                     Z-ADD0         TORERS
     C                     Z-ADD0         GARNI
     C                     Z-ADD0         UVPORT  82
     C                     Z-ADD0         TOTUVE  82
     C                     Z-ADD0         TMATUN
     C                     Z-ADD0         DEXUNT
     C                     Z-ADD0         DINUNT
     C                     Z-ADD0         FACUNT
     C                     Z-ADD0         TOTUNT
     * raz des zones cout direct et amortissements en % sur pvs depart
     C                     Z-ADD0         PCDIR   42
     C                     Z-ADD0         PCAMT
     C                     Z-ADD0         REGDIR
     C                     Z-ADD0         NETDIR
     C                     Z-ADD0         ROUDIR
     C                     Z-ADD0         REGAMT
     C                     Z-ADD0         NETAMT
     C                     Z-ADD0         ROUAMT
     C                     Z-ADD0         TEGDIR
     C                     Z-ADD0         TOUDIR
     C                     Z-ADD0         TOTAMT
     C                     Z-ADD0         RMADIR
     C                     Z-ADD0         RM2DIR
     C                     Z-ADD0         DIRREG
     C                     Z-ADD0         RGUNDI
     C                     Z-ADD0         ROUNDI
     C                     Z-ADD0         DIRPAR
     C                     Z-ADD0         AMT
     C                     Z-ADD0         SUPDIR
     C                     Z-ADD0         TOTDIR
     C                     Z-ADD0         TALAMT
     C                     Z-ADD0         PAPDIR
     C                     Z-ADD0         DIRMAT
     C                     Z-ADD0         TDIRMA
     C                     Z-ADD0         DEXCOU
     C                     Z-ADD0         DINCOU
     C                     Z-ADD0         DIVDIR
     C                     Z-ADD0         MATDIR
     C                     Z-ADD0         QTREN
     C                     Z-ADD0         QTPRE
     C                     Z-ADD0         X
     C                     Z-ADD*ZEROS    ROCXII
     C                     Z-ADD*ZEROS    ROCXIE
     C                     Z-ADD*ZEROS    ROCXFI
     C                     Z-ADD*ZEROS    ROCXFE
     C                     Z-ADD*ZEROS    RECXII
     C                     Z-ADD*ZEROS    RECXIE
     C                     Z-ADD*ZEROS    RECXFI
     C                     Z-ADD*ZEROS    RECXFE
     C/SPACE 3
    C*****************************************************
    C*  SUIVI DE PRODUCTION                              *
    C*****************************************************
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE *IN08     IN08    1
     C                     MOVE '0'       *IN
     C                     SETON                     U4U2
     C                     MOVE IN08      *IN08
     C                     Z-ADDQTTOT1    QTFAB
     C                     EXSR MODULE
     C                     EXSR MODULC
D2  C           STE       IFNE *ZEROS                     PAS PRE-IMP
     C                     EXSR MODULH
F2  C                     END
     C                     EXSR MODULF
     C                     MOVE SUIMPS    S       10
     C                     EXSR MODULI
    C                     GOTO DEPART
F1  C                     END
     C/SPACE 2
     * 2EME DEVIS MEME ANDEV/ETUDE/SEQDE .
D1  C           GP        IFEQ 'C'
     C                     MOVE 'B'       GP
D2  C           QTTOT2    IFNE *ZEROS
     C           SSEQDE    ADD  1         SEQDE
     C                     Z-ADDQTTOT2    QTTOT
     C           QTTOT2    DIV  NBFAC2    QTFAB
     C           NBIMP2    ADD  NBIRE2    NBIMP
D3  C           NBIMP2    IFNE *ZEROS
D4  C           NBIRE2    IFNE *ZEROS
     C                     Z-ADDQTFAB     QTPRE
X4  C                     ELSE
     C                     Z-ADDQTTOT2    QTPRE
F4  C                     END
F3  C                     END
     C           QTTOT2    SUB  QTPRE     QTREST  80
D3  C           NBIRE2    IFNE *ZEROS
     C           QTREST    DIV  NBIRE2    QTREN
F3  C                     END
     C                     Z-ADDNBLIV2    NBLIV
     C                     Z-ADDFRLIV2    FRLIV
     C                     Z-ADDNBFAC2    NBFAC   20
     C                     MOVEARA2,1     RASP,2
     C                     Z-ADDNBFAC2    NBFAB   20
     C                     Z-ADDNBIRE2    NBREN   20
F2  C                     END
    C                     GOTO GP1
F1  C                     END
     C/SPACE 2
     * 1EME DEVIS MEME ANDEV/ETUDE/SEQDE .
D1  C           GP        IFEQ 'B'
     C                     MOVE 'A'       GP
     C           SSEQDE    ADD  0         SEQDE
     C                     Z-ADDQTTOT1    QTTOT
     C           QTTOT1    DIV  NBFAC1    QTFAB
     C           NBIMP1    ADD  NBIRE1    NBIMP
D2  C           NBIMP1    IFNE *ZEROS
D3  C           NBIRE1    IFNE *ZEROS
     C                     Z-ADDQTFAB     QTPRE
X3  C                     ELSE
     C                     Z-ADDQTTOT1    QTPRE
F3  C                     END
F2  C                     END
     C           QTTOT1    SUB  QTPRE     QTREST  80
D2  C           NBIRE1    IFNE *ZEROS
     C           QTREST    DIV  NBIRE1    QTREN
F2  C                     END
     C                     Z-ADDNBLIV1    NBLIV
     C                     Z-ADDFRLIV1    FRLIV
     C                     Z-ADDNBFAC1    NBFAC   20
     C                     MOVEARA1,1     RASP,2
     C                     Z-ADDNBFAC1    NBFAB   20
     C                     Z-ADDNBIRE1    NBREN   20
    C                     GOTO GP1
F1  C                     END
     C/SPACE 1
     C           GP1       TAG
     C                     SETOF                     3839
D1  C           CDE       IFEQ 1
     C                     EXSR MODULP
F1  C                     END
     *<--------- OBJECTIF DE PRODUCTION ------------------>*
D1  C           DSGP      IFEQ 'AB'
     C                     MOVE '0'       *IN
     C                     Z-ADDCDEOBJ    CDE
     C                     EXSR BLKDS
     C                     EXSR MODULE
     C                     EXSR MODULC
     C                     EXSR MODULF
     C                     EXSR MODULI
     C                     UPDATDEVCALF
    C                     GOTO FINAL
F1  C                     END
     C/SPACE 2
     * CALCUL DEVIS MEME ANDEV/ETUDE/SEQDE .
D1  C           QTTOT     IFNE 0
     C   95                EXSR MODULE
     C                     EXSR MODULC
D2  C           *IN95     IFEQ '1'
     C                     EXSR MODULD
D3  C           DSGP      IFNE 'A4'
    C           STOCKE    ANDEQ' '
     C                     EXSR MODULH
F3  C                     END
     C                     MOVE '0'       *IN95
F2  C                     END
     C                     EXSR MODUDD
     C                     EXSR MODULF
     C                     EXSR MODULG
     C                     EXSR MODULI
     C                     EXSR MODULB
     C                     EXSR MODULK
     C                     EXSR MODULN
     C                     EXSR MODULT
    C*
D2  C           GP        IFEQ 'A'
     C                     Z-ADDPCDIR     PCDIR1  31
     C                     Z-ADDPCAMT     PCAMT1  31
     C                     Z-ADDQTLIV     QTLIV1  70
     C                     Z-ADDTOROUL    TORO1
     C                     Z-ADDREGUNT    REGU1
     C                     Z-ADDTOTDHT    TOTD1
     C                     Z-ADDSTOCA     STOC1
     *
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D3  C           DSGPS     IFEQ 'CI'
     C                     Z-ADD0         STOC1
F3  C                     END
     C                     Z-ADDTORERS    TOLE1
     C                     Z-ADDGARNI     GAR1
     C                     Z-ADDUVPORT    PRIP1
     C                     Z-ADDTOTUVE    TOTU1
     C                     Z-ADDTMATUN    TMATU1
     C                     Z-ADDDEXUNT    DEXUN1
     C                     Z-ADDDINUNT    DINUN1
     C                     Z-ADDFACUNT    FACUN1
     C                     Z-ADDTOTUNT    TOTUN1
     C                     Z-ADDTALU,2    TALU11
     C                     Z-ADDTALU,3    TALU12
     C                     Z-ADDTALU,4    TALU13
     C                     Z-ADDTALU,5    TALU14
     C                     Z-ADDTALU,6    TALU15
     C                     Z-ADDSUFTOT    SUFTO1
     C                     Z-ADDSUPLV     SUPLV1
F2  C                     END
D2  C           GP        IFEQ 'B'
     C                     Z-ADDPCDIR     PCDIR2  31
     C                     Z-ADDPCAMT     PCAMT2  31
     C                     Z-ADDQTLIV     QTLIV2  70
     C                     Z-ADDTOROUL    TORO2
     C                     Z-ADDREGUNT    REGU2
     C                     Z-ADDTOTDHT    TOTD2
     C                     Z-ADDSTOCA     STOC2
     C                     Z-ADDTORERS    TOLE2
     C                     Z-ADDGARNI     GAR2
     C                     Z-ADDUVPORT    PRIP2
     C                     Z-ADDTOTUVE    TOTU2
     C                     Z-ADDTMATUN    TMATU2
     C                     Z-ADDDEXUNT    DEXUN2
     C                     Z-ADDDINUNT    DINUN2
     C                     Z-ADDFACUNT    FACUN2
     C                     Z-ADDTOTUNT    TOTUN2
     C                     Z-ADDTALU,2    TALU21
     C                     Z-ADDTALU,3    TALU22
     C                     Z-ADDTALU,4    TALU23
     C                     Z-ADDTALU,5    TALU24
     C                     Z-ADDTALU,6    TALU25
     C                     Z-ADDSUFTOT    SUFTO2
     C                     Z-ADDSUPLV     SUPLV2
F2  C                     END
F1  C                     END
     *
     C                     Z-ADD*ZEROS    TALU
     C                     Z-ADD*ZEROS    TSTO
     C                     Z-ADD*ZEROS    CUMCOC
     C                     MOVE *BLANKS   PR
    C           GP        CABNE'A'       GP2
     C/SPACE 2
     C           COEREX    TAG
     C/SPACE 2
     C                     EXSR SPERR
     C/SPACE 2
     * pre-imprime a stocke --> 'preimp2' .
D1  C           DSGP      IFEQ 'A0'
    C           STOCKE    ANDEQ'O'
    C           ERR1,1    ANDEQ0
     C           CLE2      CHAINPREIMP2              80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADDDEMARG    DEMAR
     C                     Z-ADDCMATG     CMAT
     C                     Z-ADDCREGLG    CREGL
     C                     Z-ADDCROULG    CROUL
     C                     Z-ADDCMA10G    CMA100
     C                     Z-ADDCRE10G    CRE100
     C                     Z-ADDCRO10G    CRO100
     C                     Z-ADDPXNOS     PXP
     C                     Z-ADDPAPINS    NOPX
     C                     Z-ADDLMINI     LMINIS
     C                     MOVELLMINI     LAIZS
     C                     MOVE *BLANKS   DPRIMP
     C                     MOVELCOUEX     COULDS
     C                     MOVE COUEX     COULS
     C                     MOVE COUPEX    COUPS
     C                     Z-ADDPRD,1     PREXTS
     C                     Z-ADDPRO,1     KDIFS
     C                     Z-ADDPEF,1     EFEXTS
     C                     Z-ADDPDE,1     DECEXS
     C                     Z-ADDPRD,1     PRREXS
     C                     Z-ADDPRO,2     RDIFS
     C                     Z-ADDPEF,2     EFREXS
     C                     Z-ADDPDE,2     DECRES
     C                     WRITEPREIMPF1
F2  C                     END
F1  C                     END
     C/SPACE 2
     * si x usines dans gamme calcul priori
D1  C           DSGP      IFEQ 'OB'                       ORDO BIDON
    C           *IN81     ANDEQ'1'
    C           DSGP      OREQ 'OR'                       ORDO.
    C           *IN81     ANDEQ'1'
     C                     MOVE DSGP      DSGP40
     C                     Z-ADDSTE       STE40
     C                     Z-ADDNOCLI     CLI40
     C                     Z-ADDNCONF     NCON40
     C                     Z-ADDNOPRO     PRO40
     C                     CALL 'DEV040L'
     C                     PARM           DEV040
F1  C                     END
     * besoins matieres creation des enreg. au passage des :
D1  C           DSGP      IFEQ 'A5'                       PRIX REVIENT
     C                     MOVE *BLANKS   NCONF
     C                     MOVE ANDEVZ    NCONF
     C                     Z-ADDSEQDEZ    NOPRO
    C                     GOTO SUITE6
F1  C                     END
     C/SPACE 2
D1  C           DSGP      IFEQ 'A2'                       COMMANDES
    C           ERRDEV    ANDEQ*BLANK
    C*          NOAFF     ANDEQ*ZEROS                     PAS AFFICHE
    C           DSGP      OREQ 'OR'                       ORDO.
    C           ERRDEV    ANDEQ*BLANK
    C           DSGP      OREQ 'OB'                       ORDO.BIDON
    C           DSGP      OREQ 'CX'
    C           ERRDEV    ANDEQ*BLANK
    C           DSGP      OREQ 'PR'
     C           SUITE6    TAG
     C                     Z-ADDTALO,1    TALO1
     C                     Z-ADDTALO,2    TALO2
     C                     Z-ADDTALO,3    TALO3
     C                     Z-ADDTALO,4    TALO4
     C                     Z-ADDTALO,5    TALO5
     C                     Z-ADDTALO,6    TALO6
     C                     Z-ADDTALO,7    TALO7
     C                     Z-ADD*ZEROS    STD3
D2  C           NOAFF     IFNE *ZEROS
D3  C           APPEX     IFEQ 'B'
     C                     Z-ADDLMINI     STD3
F3  C                     END
D3  C           FMASL     IFEQ *ZEROS
D4  C           CCOL      IFEQ 8                          ONDULE ACHETE
     C                     Z-ADDONDL      FORLBM
     C                     Z-ADDONDH      FORHBM
F4  C                     END
     C                     Z-ADDFORL      FORLBM
     C                     Z-ADDFORH      FORHBM
X3  C                     ELSE
     C                     Z-ADDFMASL     FORLBM
     C                     Z-ADDFMASD     FORHBM
F3  C                     END
F2  C                     END
     * TRAITEMENT FSC
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'A2'
    C           DSGP      OREQ 'OB'
D3  C           ICEI2     IFNE *BLANKS
     C           *HIVAL    SETLLTAUFSC
     C                     READ TAUFSC                   99
D4  C           *IN99     IFEQ '0'
     C           MONCDE    MULT TAUX      MONCDE
F4  C                     END
F3  C                     END
F2  C                     END
     *
     C                     WRITEBESOMATF
     C/SPACE 1
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'A2'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'PR'
D3  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
     C                     Z-ADDSNCONF    NCONF
F3  C                     END
     C                     Z-ADDUDAY      CONFJ
     C                     Z-ADDUMONTH    CONFM
     C                     Z-ADDUYEAR     CONFA
    C*
D3  C           STOCKE    IFNE 'O'                        PAS CDE
     C                     MOVE 'F'       SECPAP            PRE IMPRIME
D4  C           DSGP      IFEQ 'CX'
     C                     MOVE EI        SECPAP            PASSAGE CXH
F4  C                     END
     C                     Z-ADDUSINE     USFAB
     C           SUPLV     SUB  PLUPOR    SUPUV
     C                     MOVE NPRUF     NONPRU
     C           STVAFF    MULT QT        STVARF
     C                     ADD  OTFIXF    STFIXF
     C                     ADD  OTVARF    STVARF
D4  C           AUTFRB    IFNE 0
    C           CDE       ANDEQ1
     C           AUTFRB    MULT 0,2       ZZZFRB  61
     C                     SUB  ZZZFRB    SUPLV
F4  C                     END
     C                     WRITEBESOFAF1
F3  C                     END
    C*
     C                     Z-ADD1         S                IMPRESSION
D3  C           SUPEXT    IFNE *ZEROS                     EXTERIEURE
     C                     Z-ADDSUPEXT    S
F3  C                     END
D3  C           IMPEXT    IFNE 0
    C           IMPEXT    ANDNE3
    C           IMPEXT    ANDNE5
    C           NIMPE1    ORNE *BLANKS
D4  C           NIMPE1    IFEQ *BLANKS
     C                     Z-ADDUSEXT     USIMP
X4  C                     ELSE
     C                     Z-ADD0         USIMP
F4  C                     END
     C                     MOVE 'E'       SUPOR
     C                     MOVE 'I'       SECPAP
     C                     Z-ADDPAPIEX    PAPIMP
     C                     Z-ADDSTOPEX    STOPIM
     C                     Z-ADDHELEN1    HELENV
     C                     Z-ADDFLEEN1    FLEENV
     C                     Z-ADDOFFEN1    OFFENV
     C                     Z-ADDCYLAP1    CYLENV
     C                     Z-ADDFOFFEX    FORIMP
     C                     Z-ADDHELFO1    FORHE
     C                     Z-ADDFLEFO1    FORFL
     C                     Z-ADDFOROF1    FOROF
     C                     Z-ADDEXREAM    REGAMO
     C                     Z-ADDEXRENT    REGENT
     C                     Z-ADDEXRENE    REGENE
     C                     Z-ADDEXREST    REGSTU
     C                     Z-ADDEXREMO    REGLMO
     C                     Z-ADDEXREMR    REGTPM
     C                     Z-ADDEXNEAM    NETAMO
     C                     Z-ADDEXNENT    NETENT
     C                     Z-ADDEXNENE    NETENE
     C                     Z-ADDEXNEST    NETSTU
     C                     Z-ADDEXNEMO    NETTMO
     C                     Z-ADDEXNEMR    NETTPM
     C                     Z-ADDEXROAM    ROUAMO
     C                     Z-ADDEXRONT    ROUENT
     C                     Z-ADDEXRONE    ROUENE
     C                     Z-ADDEXROST    ROUSTU
     C                     Z-ADDEXROMO    ROULMO
     C                     Z-ADDEXROMR    ROUTPM
     C                     Z-ADDFILEXB    FILEXT
     C           OTFIXE    ADD  STFIXE    STFIIM
     C           OTVARE    ADD  STVARE    STVRIM
     C                     MOVE NPRUE     NONPRU
     C                     MOVELNIMPE1    NIMP2
     C                     MOVE NIMPE2    NIMP3
     C                     WRITEBESOIMF1
F3  C                     END
    C*
     C                     Z-ADD1         S                IMPRESSION
D3  C           SUPINT    IFNE *ZEROS                     INTERIEURE
     C                     Z-ADDSUPINT    S
F3  C                     END
D3  C           IMPINT    IFNE 0
    C           IMPINT    ANDNE3
    C           IMPINT    ANDNE5
    C           NIMPI1    ORNE *BLANKS
D4  C           NIMPI1    IFEQ *BLANKS
     C                     Z-ADDUSINT     USIMP
X4  C                     ELSE
     C                     Z-ADD0         USIMP
F4  C                     END
     C                     MOVE 'I'       SUPOR
     C                     MOVE 'I'       SECPAP
     C                     Z-ADDPAPINT    PAPIMP
     C                     Z-ADDSTOPIN    STOPIM
     C                     Z-ADDHELEN2    HELENV
     C                     Z-ADDFLEEN2    FLEENV
     C                     Z-ADDOFFEN2    OFFENV
     C                     Z-ADDCYLAP2    CYLENV
     C                     Z-ADDFOFFIN    FORIMP
     C                     Z-ADDHELFO2    FORHE
     C                     Z-ADDFLEFO2    FORFL
     C                     Z-ADDFOROF2    FOROF
     C                     Z-ADDINREAM    REGAMO
     C                     Z-ADDINRENT    REGENT
     C                     Z-ADDINRENE    REGENE
     C                     Z-ADDINREST    REGSTU
     C                     Z-ADDINREMO    REGLMO
     C                     Z-ADDINREMR    REGTPM
     C                     Z-ADDINNEAM    NETAMO
     C                     Z-ADDINNENT    NETENT
     C                     Z-ADDINNENE    NETENE
     C                     Z-ADDINNEST    NETSTU
     C                     Z-ADDINNEMO    NETTMO
     C                     Z-ADDINNEMR    NETTPM
     C                     Z-ADDINROAM    ROUAMO
     C                     Z-ADDINRONT    ROUENT
     C                     Z-ADDINRONE    ROUENE
     C                     Z-ADDINROST    ROUSTU
     C                     Z-ADDINROMO    ROULMO
     C                     Z-ADDINROMR    ROUTPM
     C                     Z-ADDFILINB    FILINT
     C                     Z-ADD*ZEROS    FILEXT
     C           OTFIIN    ADD  STFIIN    STFIIM
     C           OTVARI    ADD  STVARI    STVRIM
     C                     MOVE NPRUI     NONPRU
     C                     MOVELNIMPI1    NIMP2
     C                     MOVE NIMPI2    NIMP3
     C                     WRITEBESOIMF1
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'A0'
    C           DSGP      OREQ 'A1'
    C           DSGP      OREQ 'AC'
    C           DSGP      OREQ 'A2'
    C           DSGP      OREQ 'A3'
    C           DSGP      OREQ 'B3'
    C           DSGP      OREQ 'C3'
    C           DSGP      OREQ 'SP'
     C                     MOVE DSGP      ORINDV
     C                     Z-ADDUDAY      JJ
     C                     Z-ADDUMONTH    MM
     C                     Z-ADDUYEAR     AA
D2  C           NBLIV     IFEQ *ZEROS
     C                     Z-ADDNBFAB     NBLIV
F2  C                     END
D2  C           NBIMP     IFEQ *ZEROS
     C                     Z-ADD1         NBIMP
F2  C                     END
     C                     Z-ADDFOFFEX    FORFEX
     C                     DIV  NBIMP     FORFEX
     C                     Z-ADDFOFFIN    FORFIN
     C                     DIV  NBIMP     FORFIN
D2  C           STE       IFEQ 0
     C                     Z-ADD*ZEROS    NBFAB
F2  C                     END
     C                     WRITESDEVISF1
F1  C                     END
     C/SPACE 1
     C                     Z-ADD*ZEROS    EXREAM  60
     C                     Z-ADD*ZEROS    EXRENT  60
     C                     Z-ADD*ZEROS    EXRENE  60
     C                     Z-ADD*ZEROS    EXREST  60
     C                     Z-ADD*ZEROS    EXREMO  60
     C                     Z-ADD*ZEROS    EXREMR  60
     C                     Z-ADD*ZEROS    EXNEAM  60
     C                     Z-ADD*ZEROS    EXNENT  60
     C                     Z-ADD*ZEROS    EXNENE  60
     C                     Z-ADD*ZEROS    EXNEST  60
     C                     Z-ADD*ZEROS    EXNEMO  60
     C                     Z-ADD*ZEROS    EXNEMR  60
     C                     Z-ADD*ZEROS    EXROAM  60
     C                     Z-ADD*ZEROS    EXRONT  60
     C                     Z-ADD*ZEROS    EXRONE  60
     C                     Z-ADD*ZEROS    EXROST  60
     C                     Z-ADD*ZEROS    EXROMO  60
     C                     Z-ADD*ZEROS    EXROMR  60
     C                     Z-ADD*ZEROS    INREAM  60
     C                     Z-ADD*ZEROS    INRENT  60
     C                     Z-ADD*ZEROS    INRENE  60
     C                     Z-ADD*ZEROS    INREST  60
     C                     Z-ADD*ZEROS    INREMO  60
     C                     Z-ADD*ZEROS    INREMR  60
     C                     Z-ADD*ZEROS    INNEAM  60
     C                     Z-ADD*ZEROS    INNENT  60
     C                     Z-ADD*ZEROS    INNENE  60
     C                     Z-ADD*ZEROS    INNEST  60
     C                     Z-ADD*ZEROS    INNEMO  60
     C                     Z-ADD*ZEROS    INNEMR  60
     C                     Z-ADD*ZEROS    INROAM  60
     C                     Z-ADD*ZEROS    INRONT  60
     C                     Z-ADD*ZEROS    INRONE  60
     C                     Z-ADD*ZEROS    INROST  60
     C                     Z-ADD*ZEROS    INROMO  60
     C                     Z-ADD*ZEROS    INROMR  60
     C                     Z-ADD*ZEROS    STFIXE  60
     C                     Z-ADD*ZEROS    STFIIN  60
     C                     Z-ADD*ZEROS    STFIXF  60
     C                     Z-ADD*ZEROS    STVARE  72
     C                     Z-ADD*ZEROS    STVARI  72
     C                     Z-ADD*ZEROS    STVAFF  72
     C                     Z-ADD*ZEROS    OTFIXE  60
     C                     Z-ADD*ZEROS    OTFIIN  60
     C                     Z-ADD*ZEROS    OTVARE  72
     C                     Z-ADD*ZEROS    OTVARI  72
     C                     Z-ADD*ZEROS    OTFIXF  60
     C                     Z-ADD*ZEROS    OTVARF  72
     C                     Z-ADD*ZEROS    FILEXB  62
     C                     Z-ADD*ZEROS    FILINB  62
     C                     MOVE *BLANK    NPRUF
     C                     MOVE *BLANK    NPRUE
     C                     MOVE *BLANK    NPRUI
     C/SPACE 2
     * reactualisation 'preimp'
D1  C           DSGP      IFEQ 'A4'
     C           CLE2      CHAINPREIMPL              80
D2  C           ERR1,1    IFEQ 0
D3  C           *IN80     IFEQ '0'
     C                     Z-ADDDEMARG    DEMAR
     C                     Z-ADDCMATG     CMAT
     C                     Z-ADDCREGLG    CREGL
     C                     Z-ADDCROULG    CROUL
     C                     Z-ADDCMA10G    CMA100
     C                     Z-ADDCRE10G    CRE100
     C                     Z-ADDCRO10G    CRO100
     C                     Z-ADDPXNOS     PXP
     C                     Z-ADDPAPINS    NOPX
     C                     Z-ADDUDATE     DATDE
     C                     EXCPTPREIMU
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C/SPACE 2
     * ecriture du tag f.tech.+devis bidon ou du tag calcul devis .
D2  C           ERR1,1    IFEQ 0
D3  C           DSGP      IFEQ 'A6'
     C                     MOVE '*'       TAG1
F3  C                     END
D3  C           DSGP      IFEQ 'A0'
    C           DSGP      OREQ 'A1'
    C           DSGP      OREQ 'AC'
    C           DSGP      OREQ 'SP'
     C                     MOVE '*'       TAG2
F3  C                     END
F2  C                     END
    C*
     C                     Z-ADDSSEQDE    SEQDE
     C                     MOVEALMA,1     LIBMAT
     C                     MOVE *BLANKS   LMA
D2  C           IMPEX     IFNE *ZEROS
     C                     Z-ADDIMPEX     IMPEXT
F2  C                     END
D2  C           IMPIN     IFNE *ZEROS
     C                     Z-ADDIMPIN     IMPINT
F2  C                     END
D2  C           IMPER     IFNE *ZEROS
     C                     Z-ADDIMPER     RIMPEX
F2  C                     END
D2  C           IMPIR     IFNE *ZEROS
     C                     Z-ADDIMPIR     RIMPIN
F2  C                     END
    C*
D2  C           STOCKE    IFNE *BLANKS
     C                     Z-ADD*ZEROS    DECFAZ
F2  C                     END
     *
D2  C           TYPDEV    IFEQ 2
     C                     Z-ADD*ZEROS    ACOTE
F2  C                     END
    C*
     C                     ADD  ROCXIE    DECFAZ
     C                     ADD  ROCXII    DECFAZ
     C                     ADD  ROCXFE    DECFAZ
     C                     ADD  ROCXFI    DECFAZ
     C                     UPDATDEVCALF
F1  C                     END
     C/SPACE 2
     * remise a zero ou a blanc des zones de FICHIERS
     C                     CLEARBESOMATF
     C                     Z-ADD0         DECEXT
     C                     Z-ADD0         DECINT
     C                     Z-ADDFOREXP    EXP1
     C                     Z-ADD0         FIXEXT
     C                     Z-ADD0         FIXINT
     C                     Z-ADD0         FIXFAC
     C                     Z-ADD0         VAREXT
     C                     Z-ADD0         VARINT
     C                     Z-ADD0         VARFAC
     C                     Z-ADD0         TORERS
     C                     CLEARBESOIMF1
     C                     CLEARBESOFAF1
     C                     CLEARSDEVISF1
     C                     Z-ADDEXP1      FOREXP
     * remise a zero ou a blanc des zones de sortie fiche devis .
     C                     Z-ADD0         SBFE    76
     C                     Z-ADD0         TORO1   72
     C                     Z-ADD0         REGU1   72
     C                     Z-ADD0         TOTD1   82
     C                     Z-ADD0         TOTU1   82
     C                     Z-ADD0         TORO2   72
     C                     Z-ADD0         REGU2   72
     C                     Z-ADD0         TOTD2   82
     C                     Z-ADD0         TOTU2   82
     C                     Z-ADD0         PCDIR1  31
     C                     Z-ADD0         PCDIR2  31
     C                     Z-ADD0         PCAMT1  31
     C                     Z-ADD0         PCAMT2  31
     C                     Z-ADD0         TMATU1  62
     C                     Z-ADD0         TOTUN1  72
     C                     Z-ADD0         TMATU2  62
     C                     Z-ADD0         TOTUN2  72
     C                     Z-ADD0         PCDIR
     C                     Z-ADD0         PCAMT
     C                     Z-ADD0         QTLIV1
     C                     Z-ADD0         QTLIV2
     C                     MOVE *BLANKS   QUAL
     C                     Z-ADD0         VALPAP
     C                     Z-ADD0         VTEPAP
     C                     Z-ADD0         TMATUN
     C                     Z-ADD0         TOTCEN
     C                     Z-ADD0         TOTUNT
     C                     Z-ADD0         EXDEC
     C                     Z-ADD0         INDEC
     C                     Z-ADD0         EXDECD
     C                     Z-ADD0         INDECD
     *
     C                     Z-ADD0         EMBDIR
     C                     Z-ADD0         COUDIR  62
     *
     C                     Z-ADD0         REGDIR
     C                     Z-ADD0         NETDIR
     C                     Z-ADD0         ROUDIR
     C                     Z-ADD0         REGAMT
     C                     Z-ADD0         NETAMT
     C                     Z-ADD0         ROUAMT
     C                     Z-ADD0         TEGDIR
     C                     Z-ADD0         TOUDIR
     C                     Z-ADD0         TOTAMT
     C                     Z-ADD0         RMADIR
     C                     Z-ADD0         RM2DIR
     C                     Z-ADD0         DIRREG
     C                     Z-ADD0         RGUNDI
     C                     Z-ADD0         ROUNDI
     C                     Z-ADD0         DIRPAR
     C                     Z-ADD0         AMT
     C                     Z-ADD0         SUPDIR
     C                     Z-ADD0         TALAMT
     C                     Z-ADD0         PAPDIR
     C                     Z-ADD0         DIRMAT
     C                     Z-ADD0         TDIRMA
     C                     Z-ADD0         DEXCOU
     C                     Z-ADD0         DINCOU
     C                     Z-ADD0         DIVDIR
     C                     Z-ADD0         MATDIR
     *
     C                     Z-ADD0         RO
     C                     Z-ADD0         ROU
     C                     Z-ADD0         RMA
     C                     Z-ADD0         REG
     C/SPACE 1
    C                     GOTO FIN
     C/SPACE 3
     ****************************************************************
     * fin du programme calcul general des devis .
     C           FIN       TAG
    C                     GOTO DEPART
     C/SPACE 2
     ****************************************************************
     C           FINAL     TAG
     C                     SETON                     LR
     C/EJECT
     * sous programme de traitement d'erreur/exception relative au
     *                                                     programme .
    C           *PSSR     BEGSR
     *
D1  C           SGAP      IFEQ SSGAP
     C                     ADD  1         SSSGAP
D2  C           SSSGAP    IFGE 30
     C           *MDEV15   DSPLY'QSYSOPR' SGAP
    C                     GOTO FINAL
X2  C                     ELSE
     C                     Z-ADD0         SSSGAP  30
     C                     MOVE SGAP      SSGAP   8
F2  C                     END
F1  C                     END
     *
D1  C           ERREUR    IFEQ 102
     C                     Z-ADD1         A
     C           *ZERO     LOKUPERR1,A                   80
     C                     MOVE 18        ERR1,A
     C                     MOVE SGAP      ERR2,A
     C                     EXSR BLRESU
     C                     EXSR BLMODB
     C                     EXSR BLMODK
     C                     EXSR BLMODN
     C                     EXSR BLMODT
    C                     GOTO COEREX
F1  C                     END
     *
D1  C           ERREUR    IFEQ 121
     C                     Z-ADD1         A
     C           *ZERO     LOKUPERR1,A                   80
     C                     MOVE 19        ERR1,A
     C                     MOVE SGAP      ERR2,A
     C                     EXSR BLRESU
     C                     EXSR BLMODB
     C                     EXSR BLMODK
     C                     EXSR BLMODN
     C                     EXSR BLMODT
    C                     GOTO COEREX
F1  C                     END
     *
D1  C           ERREUR    IFEQ 907
     C                     Z-ADD1         A
     C           *ZERO     LOKUPERR1,A                   80
     C                     MOVE 20        ERR1,A
     C                     MOVE SGAP      ERR2,A
     C                     EXSR BLRESU
     C                     EXSR BLMODB
     C                     EXSR BLMODK
     C                     EXSR BLMODN
     C                     EXSR BLMODT
    C                     GOTO COEREX
F1  C                     END
     *
    C                     ENDSR'*CANCL'
     C/EJECT
     *******************************************
     * uniquement a l'entree dans le programme ***********************
     *******************************************    - module -A- -
    C           MODULA    BEGSR
     ** formatage des libelles des erreurs devis . ..................
     C                     Z-ADD0         A       20       .  l      .
     C                     Z-ADD0         B       20       .  i      .
D1  C                     DO   32        A                .  b   e  .
     C                     ADD  1         B                .  l   r  .
     C                     MOVELERR,B     ERR3,A           .  l   e  .
     C                     ADD  1         B                .  e   u  .
     C                     MOVE ERR,B     ERR3,A           .  s   r  .
F1  C                     END                             .      s  .
     ** .............................................................
    C*
D1  C           CDE       IFEQ 1                          COMMERCIAL
     C           'TA'      CHAINTARIF2               80
D2  C           DSGP      IFEQ 'A3'
    C* TMAFBU 20/11/2014
    C*                    MOVE 'R'       TYPE    1        ESSAI
     C                     MOVE 'C'       TYPE    1        COMMANDE
X2  C                     ELSE
     C                     MOVE 'C'       TYPE             COMMANDE
F2  C                     END
     C                     Z-ADDKMATC     KMAT    54
     C                     Z-ADDKREGC     KREG    54
     C                     Z-ADDKROUC     KROUL   54
     C                     Z-ADDKMATAC    KMATA   54
    C*
X1  C                     ELSE                            PRU
     C           'TB'      CHAINTARIF2               80
D2  C           DSGP      IFEQ 'B3'
     C                     MOVE 'S'       TYPE    1        ESSAI
X2  C                     ELSE
     C                     MOVE 'D'       TYPE             COMMANDE
F2  C                     END
     C                     Z-ADD1         KMAT
     C                     Z-ADD1         KREG
     C                     Z-ADD1         KROUL
     C                     Z-ADD1         KMATA
     C                     Z-ADD*ZEROS    FOR3
F1  C                     END
    C*
     C                     Z-ADDKINTC     KINT    54
     C                     Z-ADDFORFAC    FORFAB  50
     C                     Z-ADDFOREXC    FOREXP
     C                     Z-ADDFOR2      PARFON  50
     C                     Z-ADDFOR5      PARFDE  50
     C                     Z-ADDFD4       FORIM1  50
     C                     Z-ADDFOV4      FORDEC  50
     C                     Z-ADDFOR3      FORCH1  50
     C           FILL24    DIV  5200      STS1S   65H
     C                     Z-ADDPXNO      PXNOS   20
     C                     Z-ADDPAPINO    PAPINS  20
     C           FORSTT    DIV  10        FORSTO  62       A LA TONNE
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D1  C           DSGPS     IFEQ 'CI'
     C           FORSTO    MULT 0,40      FORSTO
F1  C                     END
    C*
    C                     ENDSR
     C/EJECT
     ************************************************
     * calcul des valeurs matieres pour application ******************
     * dechets de roulage .                         ******************
     ************************************************ <-- module B -->
    C           MODULB    BEGSR
     C                     EXSR BLMODB
     *
    C* Si affiche
     C                     Z-ADD*ZEROS    AFFUN1  82
     C                     Z-ADDTOTU1     SVTOU1  82
     C                     Z-ADDTOTU2     SVTOU2  82
     C                     MOVE TYPP2     STYPP2  1
D1  C           AFFI      IFNE *BLANK
    C*
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'A2'
     C                     Z-ADDANDEV     XNDEV
     C                     Z-ADDETUDE     XTUDE
     C                     Z-ADDSEQDE     XEQDE
     C                     MOVEL'1'       XNDEV
     C                     MOVEL'8'       XEQDE
     C           CLE1      CHAINDEVCALL2             80
D3  C           *IN80     IFEQ '0'
D4  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU1
F4  C                     END
     C                     ADD  TOTU1     AFFUN1
F3  C                     END
     C                     MOVEL'2'       XNDEV
     C                     MOVEL'9'       XEQDE
     C           CLE1      CHAINDEVCALL2             80
D3  C           *IN80     IFEQ '0'
D4  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU1
F4  C                     END
     C                     ADD  TOTU1     AFFUN1
F3  C                     END
    C*
X2  C                     ELSE
     C                     Z-ADDANDEV     XNDEV
     C                     Z-ADDETUDE     XTUDE
     C                     Z-ADDSEQDE     XEQDE
D3  C           GP        IFEQ 'A'
     C                     MOVEL'01'      XNDEV
     C           CLE1      CHAINDEVCALL2             80
D4  C           *IN80     IFEQ '0'
D5  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU1
F5  C                     END
     C                     ADD  TOTU1     AFFUN1
F4  C                     END
     C                     MOVEL'02'      XNDEV
     C           CLE1      CHAINDEVCALL2             80
D4  C           *IN80     IFEQ '0'
D5  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU1
F5  C                     END
     C                     ADD  TOTU1     AFFUN1
F4  C                     END
F3  C                     END
D3  C           GP        IFEQ 'B'
     C                     Z-ADDSEQDE     XEQDE
     C                     SUB  1         XEQDE
     C                     MOVEL'01'      XNDEV
     C           CLE1      CHAINDEVCALL2             80
D4  C           *IN80     IFEQ '0'
D5  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU2
F5  C                     END
     C                     ADD  TOTU2     AFFUN1
F4  C                     END
     C                     MOVEL'02'      XNDEV
     C           CLE1      CHAINDEVCALL2             80
D4  C           *IN80     IFEQ '0'
D5  C           POSF1     IFNE 0
     C                     DIV  POSF1     TOTU2
F5  C                     END
     C                     ADD  TOTU2     AFFUN1
F4  C                     END
F3  C                     END
    C*
F2  C                     END
D2  C           ERRDEV    IFNE *BLANKS
     C                     Z-ADD1         A
     C           *ZERO     LOKUPERR1,A                   80
     C                     MOVE 06        ERR1,A
     C                     MOVEL'AFFICHE' ERR2,A
X2  C                     ELSE
     C                     ADD  1         X
     C                     Z-ADD0         R
     C                     Z-ADD9         I
     C                     MOVE '  '      NOMAC
     C                     MOVE '9'       SECT
     C                     MOVE '9'       SSECT
     C                     Z-ADDAFFUN1    ROULUV
     C                     Z-ADDAFFUN1    ROU,X
     C                     Z-ADD*ZEROS    MOYCAD
     C                     Z-ADD*ZEROS    ROEFF
     C                     Z-ADD*ZEROS    RNTPS
     C                     WRITEDEVRESF
F2  C                     END
    C*
F1  C                     END
     C                     Z-ADDSVTOU1    TOTU1
     C                     Z-ADDSVTOU2    TOTU2
     C                     MOVE STYPP2    TYPP2
     *
     * Calcul du port pour mutation grande feuille contrecollée
     C                     Z-ADD*ZEROS    MUTGFO  60
D1  C           CCOL      IFEQ 1                          CONTRECOLLE
    C           USINE     ANDEQ3                          GRANDE FEUILLE
    C           MACDEC    ANDEQ'K'
     C           SUFAB     MULT TOTGRA    Z12N   120
     C                     MULT NBFAB     Z12N
     C           Z12N      DIV  1000000   Z6N     60H
     C           FORCH1    MULT Z6N       FORCHA  70
     C                     ADD  FORCHA    PLUPOR
     C                     ADD  FORCHA    MUTGFO
F1  C                     END
     * Calcul du port pour mutation pre-imprimé .
     C                     SETOF                     64
     C                     Z-ADDUSINE     USIS    10
     C                     Z-ADD*ZEROS    USPEX   10
D1  C           USEXT     IFNE *ZEROS
     C                     Z-ADDUSEXT     USPEX
X1  C                     ELSE
D2  C           USPE      IFNE *ZEROS
     C                     Z-ADDUSPE      USPEX
F2  C                     END
F1  C                     END
     C                     Z-ADD*ZEROS    USPIN   10
D1  C           USINT     IFNE *ZEROS
     C                     Z-ADDUSINT     USPIN
X1  C                     ELSE
D2  C           USPI      IFNE *ZEROS
     C                     Z-ADDUSPI      USPIN
F2  C                     END
F1  C                     END
     C           SUFAB     MULT NBFAB     SUFTOT 110
D1  C           QTPRE     IFEQ 0
    C           QTREN     CABEQ0         DULBH
F1  C                     END
D1  C           USIS      IFEQ 3
    C           MUTGFO    ANDNE*ZEROS
    C                     GOTO DULBH
F1  C                     END
    C*
     C                     Z-ADDSUFTOT    SURIMZ
     C           SURIMZ    MULT DECROU    MARFAC  80
    C*
    C           USPEX     CABEQ0         DULBF
D1  C           USEXT     IFEQ 4
    C           IMPEXT    ANDEQ4
     C                     Z-ADDSUPEXT    S
D2  C           APPEX     IFEQ 'B'
     C                     Z-ADD2         USIS
F2  C                     END
F1  C                     END
    C           USPEX     CABNEUSIS      DULBG
     C           DULBF     TAG
    C*
    C           USPIN     CABEQ0         DULBH
D1  C           USINT     IFEQ 4
    C           IMPINT    ANDEQ4
     C                     Z-ADDSUPINT    S
D2  C           APPIN     IFEQ 'B'
     C                     Z-ADD2         USIS
F2  C                     END
F1  C                     END
    C           USPIN     CABEQUSIS      DULBH
     C                     Z-ADDSUPINT    S
     C                     Z-ADDGRAM,S    GGR     30
D1  C           USPI      IFNE *ZEROS
     C                     Z-ADDGRAMS5    GGR
F1  C                     END
     C                     MOVE USPIN     USIMP
     C                     SETON                     64
     C           SURIMZ    MULT DECINT    MARIMP
     C                     Z-ADD0         SURTAL
    C                     GOTO DULBA
     C           DULBG     TAG
     C                     Z-ADDSUPEXT    S
     C                     Z-ADDGRAM,S    GGR     30
D1  C           USPE      IFNE *ZEROS
     C                     Z-ADDGRAMS3    GGR
F1  C                     END
     C                     MOVE USPEX     USIMP
     C           SURIMZ    MULT DECEXT    MARIMP  80
     C           DULBA     TAG
     C                     EXSR SPKGF
    C*
     C           SURIMZ    ADD  MARFAC    SURTAL 100
     C                     ADD  MARIMP    SURTAL
     C           SURTAL    MULT GGR       PDSSUP 120
     C           PDSSUP    MULT 0,001     PDSSUP
D1  C           TALO,S    IFGT 1,00
     C           PDSSUP    MULT TALO,S    PDSSUP
F1  C                     END
     C           PDSSUP    MULT KGF       PORPLU  82
     C                     ADD  PORPLU    PLUPOR  82
    C*
D1  C           S         IFLE 3
     C           PORPLU    DIV  QT        SPORTE           * * * * * *
X1  C                     ELSE
     C           PORPLU    DIV  QT        SPORTI           * * * * * *
F1  C                     END
    C*
D1  C           *IN64     IFEQ '0'
     C                     SETON                     64
    C                     GOTO DULBF
F1  C                     END
    C*
     C           DULBH     TAG
     * Mutation de complexe
     *
D1  C           GRCXHE    IFNE *ZEROS
    C           GRCXHI    ORNE *ZEROS
     C                     Z-ADD0         SURTAL
     C           SUFAB     MULT NBFAB     SUFTOT 110
     C                     Z-ADDSUFTOT    SURIMZ
     C           SURIMZ    MULT DECROU    MARFAC
     C           SURIMZ    ADD  MARFAC    SURTAL 100
D2  C           GRCXHE    IFNE *ZEROS
D3  C           USPEX     IFEQ 0
    C           USIS      ANDNE2
     C                     Z-ADD2         USIMP
     C                     EXSR SPKGF
     C           SURTAL    MULT GRCXHE    PDSSUP 120
     C           PDSSUP    MULT 0,001     PDSSUP
     C           PDSSUP    MULT KGF       PORPLU  82
     C                     ADD  PORPLU    PLUPOR  82
F3  C                     END
D3  C           USPEX     IFNE 0
    C           USPEX     ANDNE2
     C                     Z-ADD2         USIMP
     C                     EXSR SPKGF
     C           SURTAL    MULT GRCXHE    PDSSUP 120
     C           PDSSUP    MULT 0,001     PDSSUP
     C           PDSSUP    MULT KGF       PORPLU  82
     C                     ADD  PORPLU    PLUPOR  82
F3  C                     END
F2  C                     END
D2  C           GRCXHI    IFNE *ZEROS
D3  C           USPIN     IFEQ 0
    C           USIS      ANDNE2
     C                     Z-ADD2         USIMP
     C                     EXSR SPKGF
     C           SURTAL    MULT GRCXHI    PDSSUP 120
     C           PDSSUP    MULT 0,001     PDSSUP
     C           PDSSUP    MULT KGF       PORPLU  82
     C                     ADD  PORPLU    PLUPOR  82
F3  C                     END
D3  C           USPIN     IFNE 0
    C           USPIN     ANDNE2
     C                     Z-ADD2         USIMP
     C                     EXSR SPKGF
     C           SURTAL    MULT GRCXHI    PDSSUP 120
     C           PDSSUP    MULT 0,001     PDSSUP
     C           PDSSUP    MULT KGF       PORPLU  82
     C                     ADD  PORPLU    PLUPOR  82
F3  C                     END
F2  C                     END
F1  C                     END
     * Calcul des valeurs matieres pour application dechet roulage .
     *
     C                     ADD  DREGST    DIRMAT
     C                     ADD  DROUST    DIRMAT
     C                     ADD  VREGST    MATCEN
     C                     ADD  VROUST    MATCEN
    C*
     C                     Z-ADDIMPEXT    IMPES   10
D1  C           IMPEXT    IFEQ 0
    C           IMPEXT    OREQ 3
    C           IMPEXT    OREQ 5
    C           IMPEX     CABEQ0         DULBB
     C                     ADD  DEMAE     EXDEC
     C                     Z-ADDSUPEXT    S
D2  C           RIMPEX    IFEQ 0
    C           RIMPEX    OREQ 3
     C                     Z-ADDIMPEX     IMPES
    C                     GOTO SUIT17
X2  C                     ELSE
     C                     Z-ADDRIMPEX    IMPES
F2  C                     END
F1  C                     END
     * dechets de roulage support exterieur .
     C           DIREXT    MULT EXDEC     DEXCOU  62
     * <---PAGE-B2--->
     C           VALEXT    MULT EXDEC     DEXCEN  62H
     C           VTEEXT    MULT EXDEC     DEXUNT  62H
     C           SUIT17    TAG
D1  C           IMPES     IFEQ 4
     C           EXDEC     MULT 25        SUPFAC  42
X1  C                     ELSE
     C           EXDEC     MULT 50        SUPFAC
F1  C                     END
     * <---PAGE-B2BIS--->
     C           DULBB     TAG
     C                     SUB  DEMAE     EXDEC
     C                     Z-ADDIMPINT    IMPIS   10
D1  C           IMPINT    IFEQ 0
    C           IMPINT    OREQ 3
    C           IMPINT    OREQ 5
    C           IMPIN     CABEQ0         DULBB2
     C                     ADD  DEMAI     INDEC
     C                     Z-ADDSUPINT    S
D2  C           RIMPIN    IFEQ 0
    C           RIMPIN    OREQ 3
     C                     Z-ADDIMPIN     IMPIS
    C                     GOTO SUIT19
X2  C                     ELSE
     C                     Z-ADDRIMPIN    IMPIS
F2  C                     END
F1  C                     END
     C           DIRINT    MULT INDEC     DINCOU  62H
     C           VALINT    MULT INDEC     DINCEN  62H
     C           VTEINT    MULT INDEC     DINUNT  62H
     C           SUIT19    TAG
D1  C           IMPIS     IFEQ 4
     C           INDEC     MULT 25        SUPFA
X1  C                     ELSE
     C           INDEC     MULT 50        SUPFA
F1  C                     END
     C                     ADD  SUPFA     SUPFAC
     C           DULBB2    TAG
     C                     SUB  DEMAI     INDEC
     * <---PAGE-B3--->
D1  C           DECFAC    IFEQ *ZEROS
     C                     Z-ADDDIRMAT    TDIRMA
     C                     Z-ADDMATCEN    TMATCE
     C                     Z-ADDMATUNT    TMATUN
F1  C                     END
     C                     MOVE DECFAC    DECFAZ
     C                     MOVELSUPFAC    SUPFAZ  44
     *
     C           DIREXT    ADD  DIRINT    TWO
     C           DIRMAT    SUB  TWO       SOLD    62
     C                     SUB  DREGST    SOLD
     C           SOLD      MULT SUPFAZ    TWO       H
     C                     SUB  DREGST    DIRMAT
     C           DIRMAT    MULT DECFAZ    DECDIR  62H
     C                     ADD  TWO       DECDIR
     *
     C           VALEXT    ADD  VALINT    TWO
D1  C           *IN94     IFEQ '1'                        RECTO/VERSO
     C                     SUB  PVSPS     TWO
F1  C                     END
     C           MATCEN    SUB  TWO       SOLD    62
     C                     SUB  VREGST    SOLD
     C           SOLD      MULT SUPFAZ    TWO       H
     C                     SUB  VREGST    MATCEN
     C           MATCEN    MULT DECFAZ    FACCEN  62H
     C                     ADD  TWO       FACCEN
     *
     C           VREGST    MULT 0,01      VREGS2  64
     C           VREGS2    MULT SUVENT    UVREST  62H
     C           VTEEXT    ADD  VTEINT    TWO     72
D1  C           *IN94     IFEQ '1'                        RECTO/VERSO
     C                     SUB  PAPVS     TWO
F1  C                     END
     C           MATUNT    SUB  TWO       SOLD    62
     C                     SUB  UVREST    SOLD
     C           SOLD      MULT SUPFAZ    TWO       H
     C                     SUB  UVREST    MATUNT
     C           MATUNT    MULT DECFAZ    FACUNT  62H
     C                     ADD  TWO       FACUNT
     *
D1  C           *IN76     IFEQ '1'                        COMPLEXAGE
    C           *IN77     OREQ '1'
D2  C           CXHIN     IFNE *ZEROS                     INTERIEUR
D3  C           ROCXII    IFNE *ZEROS                     AVANT IMP
     C                     MOVELROCXII    ROCXH   44
     C                     MOVE RECXII    RECXH   50
D4  C           QTPRE     IFEQ *ZEROS
     C                     Z-ADDNBREN     MULTI
X4  C                     ELSE
     C           NBREN     ADD  1         MULTI
F4  C                     END
F3  C                     END
D3  C           ROCXFI    IFNE *ZEROS                     APRES IMP
     C                     MOVELROCXFI    ROCXH
     C                     MOVE RECXFI    RECXH
D4  C           PAPINT    IFEQ *ZEROS
     C                     Z-ADDNBFAB     MULTI
X4  C                     ELSE
D5  C           QTPRE     IFEQ *ZEROS
     C                     Z-ADDNBREN     MULTI
X5  C                     ELSE
     C           NBREN     ADD  1         MULTI
F5  C                     END
F4  C                     END
F3  C                     END
     C           RECXH     MULT MULTI     REGCXH  60
     C           SUFAB     MULT NBFAB     SURTAL
     C           REGCXH    DIV  SURTAL    RELREG  44
     C           ROCXH     ADD  RELREG    DECXH   54
     C                     Z-ADDCXHIN     I
     C           TACO,I    MULT DECXH     PAPCXH  62H
D3  C           PAPINT    IFEQ *ZEROS
     C                     ADD  PAPCXH    PAPFAC
     C           TSTO,I    MULT DECXH     SUPSTO  60
     C                     ADD  SUPSTO    STOPFA
X3  C                     ELSE
     C                     ADD  PAPCXH    PAPINT
     C           STOPIN    MULT DECXH     SUPSTO  60
     C                     ADD  SUPSTO    STOPIN
F3  C                     END
     C           TACO,I    ADD  FILINT    VAPRU   62
     C           FILINT    MULT KMATA     COLV    62H
     C           TAVA,I    ADD  COLV      VALCEN  62
     C           COLV      DIV  100       COLM2   64H
     C           COLM2     MULT SUVENT    COLTV   62H
     C           TALU,I    ADD  COLTV     VALUNT  62
D3  C           ROCXFI    IFNE *ZEROS
     C                     ADD  ENCINT    VAPRU
     C           ENCINT    MULT KMATA     VAL62   62H
     C                     ADD  VAL62     VALCEN
     C                     ADD  ENCVTI    VALUNT
     C                     ADD  VERINT    VAPRU
     C           VERINT    MULT KMATA     VAL62     H
     C                     ADD  VAL62     VALCEN
     C                     ADD  VERVTI    VALUNT
F3  C                     END
     C           VAPRU     MULT ROCXH     SUPL    62H
     C                     ADD  SUPL      DECDIR
     C           VALCEN    MULT ROCXH     SUPL      H
     C                     ADD  SUPL      FACCEN
     C           VALUNT    MULT ROCXH     SUPL      H
     C                     ADD  SUPL      FACUNT
F2  C                     END
     *
D2  C           CXHEX     IFNE *ZEROS                     EXTERIEUR
D3  C           ROCXIE    IFNE *ZEROS                     AVANT IMP
     C                     MOVELROCXIE    ROCXH
     C                     MOVE RECXIE    RECXH
D4  C           QTPRE     IFEQ *ZEROS
     C                     Z-ADDNBREN     MULTI
X4  C                     ELSE
     C           NBREN     ADD  1         MULTI
F4  C                     END
F3  C                     END
D3  C           ROCXFE    IFNE *ZEROS                     APRES IMP
     C                     MOVELROCXFE    ROCXH
     C                     MOVE RECXFE    RECXH
D4  C           PAPIEX    IFEQ *ZEROS
     C                     Z-ADDNBFAB     MULTI
X4  C                     ELSE
D5  C           QTPRE     IFEQ *ZEROS
     C                     Z-ADDNBREN     MULTI
X5  C                     ELSE
     C           NBREN     ADD  1         MULTI
F5  C                     END
F4  C                     END
F3  C                     END
     C           RECXH     MULT MULTI     REGCXH
     C           SUFAB     MULT NBFAB     SURTAL
     C           REGCXH    DIV  SURTAL    RELREG
     C           ROCXH     ADD  RELREG    DECXH
     C                     Z-ADDCXHEX     I
     C           TACO,I    MULT DECXH     PAPCXH
D3  C           PAPIEX    IFEQ *ZEROS
     C                     ADD  PAPCXH    PAPFAC
     C           TSTO,I    MULT DECXH     SUPSTO  60
     C                     ADD  SUPSTO    STOPFA
X3  C                     ELSE
     C                     ADD  PAPCXH    PAPIEX
     C           STOPEX    MULT DECXH     SUPSTO  60
     C                     ADD  SUPSTO    STOPEX
F3  C                     END
     C           TACO,I    ADD  FILEXT    VAPRU   62
     C           FILEXT    MULT KMATA     COLV
     C           TAVA,I    ADD  COLV      VALCEN  62
     C           COLV      DIV  100       COLM2   64H
     C           COLM2     MULT SUVENT    COLTV   62H
     C           TALU,I    ADD  COLTV     VALUNT  62
D3  C           ROCXFE    IFNE *ZEROS
     C                     ADD  ENCEXT    VAPRU
     C           ENCEXT    MULT KMATA     VAL62     H
     C                     ADD  VAL62     VALCEN
     C                     ADD  ENCVTE    VALUNT
     C                     ADD  VERINT    VAPRU
     C           VEREXT    MULT KMATA     VAL62     H
     C                     ADD  VAL62     VALCEN
     C                     ADD  VERVTE    VALUNT
F3  C                     END
     C           VAPRU     MULT ROCXH     SUPL    62H
     C                     ADD  SUPL      DECDIR
     C           VALCEN    MULT ROCXH     SUPL      H
     C                     ADD  SUPL      FACCEN
     C           VALUNT    MULT ROCXH     SUPL      H
     C                     ADD  SUPL      FACUNT
F2  C                     END
F1  C                     END
     *
     C                     ADD  DREGST    DIRMAT
     C           DIRMAT    ADD  DECDIR    TDIRMA
     C                     ADD  VREGST    MATCEN
     C           MATCEN    ADD  FACCEN    TMATCE
     C                     ADD  UVREST    MATUNT
     C           MATUNT    ADD  FACUNT    TMATUN
     *
     C                     MOVELDECFAZ    DECFZZ  44
     C           DECFAZ    ADD  SUPFAZ    FACDEC  44
     C                     SUB  DECROX    FACDEC
     C                     MOVELFACDEC    DECFAC
    C*
     C                     MOVELDECFAC    DECFAZ
     * <---PAGE-B4--->
D1  C           MATSTE    IFEQ *ZEROS
     C           DIREXT    MULT DECFZZ    SEVEN   62H
X1  C                     ELSE
     C           MATSTE    MULT DECFZZ    SEVEN
F1  C                     END
     C                     ADD  SEVEN     DIREXT
     C                     ADD  DEXCOU    DIREXT
D1  C           MATSTI    IFEQ *ZEROS
     C           DIRINT    MULT DECFZZ    SEVEN     H
X1  C                     ELSE
     C           MATSTI    MULT DECFZZ    SEVEN
F1  C                     END
     C                     ADD  SEVEN     DIRINT
     C                     ADD  DINCOU    DIRINT
    C*
     C                     ADD  DEXCOU    TDIRMA
     C                     ADD  DINCOU    TDIRMA
     C                     ADD  DEXCEN    TMATCE
     C                     ADD  DINCEN    TMATCE
     C                     ADD  DEXUNT    TMATUN
     C                     ADD  DINUNT    TMATUN
     * fin du module -B-
    C                     ENDSR
     C/EJECT
     *****************************************
     * valorisation des papiers par support ************************
     *****************************************   < module C >
    C           MODULC    BEGSR
     C                     Z-ADD0         PRUTOT  62
     C                     Z-ADD0         DECSUP  42
     C                     Z-ADD0         MATCM2  72
     C                     Z-ADD0         CRECM2  72
     C                     Z-ADD0         CROCM2  72
     C                     Z-ADD0         PVSPAP  72
     C                     Z-ADD0         GRAAUT  40
     C                     Z-ADD0         GRAOND  40
     C                     Z-ADD0         GRONCC  40
     C                     Z-ADD0         IMPEX   10
     C                     Z-ADD0         IMPIN   10
     C                     Z-ADD0         IMPER   10
     C                     Z-ADD0         IMPIR   10
     C                     Z-ADD0         ALLONG  32
     C                     Z-ADD0         GRADD   30
     C                     Z-ADD0         GRACAN  40
     C                     Z-ADD0         TALO
     C                     Z-ADD0         TACO
     C                     Z-ADD0         PAPM2   64
     C                     Z-ADD0         PAPVT   72
     C                     Z-ADD0         PAPEXT  62
     C                     Z-ADD0         DIRPEX  62
     C                     Z-ADD0         VTPEXT  72
     C                     Z-ADD0         PAPINX  62
     C                     Z-ADD0         DIRPIN  62
     C                     Z-ADD0         VTPINT  72
     C                     Z-ADD0         TOTGRA  40
     C                     Z-ADD0         PAPDIR  62
     C                     MOVE *BLANKS   QUAL
     C                     Z-ADD0         VALPAP  62
     C                     Z-ADD0         VTEPAP  62
     C                     Z-ADD*ZEROS    S
     C                     Z-ADD*ZEROS    COUSTS  92
     C                     Z-ADD*ZEROS    MATSTO  72
     C                     Z-ADD*ZEROS    MATSTE  72
     C                     Z-ADD*ZEROS    MATSTI  72
     C                     Z-ADD*ZEROS    VREGST  72
     C                     Z-ADD*ZEROS    VROUST  72
     C                     Z-ADD*ZEROS    DREGST  72
     C                     Z-ADD*ZEROS    DROUST  72
     C                     Z-ADD*ZEROS    DEMAE   44
     C                     Z-ADD*ZEROS    DEMAI   44
     C                     Z-ADD*ZEROS    PAPFAC
     C                     Z-ADD*ZEROS    STOPFA
     C                     Z-ADD*ZEROS    PAPIEX
     C                     Z-ADD*ZEROS    STOPEX
     C                     Z-ADD*ZEROS    PAPINT
     C                     Z-ADD*ZEROS    STOPIN
     C                     MOVE *BLANKS   QUAPAI  3
     C                     Z-ADD*ZEROS    GRAPAI  30
     C                     MOVE *BLANKS   ADPPAI  6
     C                     Z-ADD*ZEROS    ADGPAI  30
     C                     MOVE *BLANKS   QUAPAE  3
     C                     Z-ADD*ZEROS    GRAPAE  30
     C                     MOVE *BLANKS   ADPPAE  6
     C                     Z-ADD*ZEROS    ADGPAE  30
     C                     Z-ADD*ZEROS    CXHEX   10
     C                     Z-ADD*ZEROS    CXHIN   10
     C                     Z-ADD*ZEROS    SURCXE  80
     C                     Z-ADD*ZEROS    SURCXI  80
     C                     Z-ADD*ZEROS    TOTGR1
     C                     Z-ADD*ZEROS    TOTGR2
     C                     Z-ADD*ZEROS    TOTGR3
     C                     Z-ADD*ZEROS    USPI    10
     C                     Z-ADD*ZEROS    USPE    10
     C                     Z-ADD*ZEROS    GRAMS3  30
     C                     Z-ADD*ZEROS    GRAMS5  30
     C                     SETOF                     94
     * SI SOUS TRAITANCE INTÉGRALE
    C* ----------------------------------
    C           TYPDEV    CABEQ4         DULCFI
     *
     C                     Z-ADD1         S
D1  C                     DO   7         S
     C                     Z-ADD*ZEROS    TTSTO
     C                     Z-ADD*ZEROS    TOTPR
     C                     Z-ADD*ZEROS    CISTO   72
     C                     MOVE ' '       APPO    1
D2  C           PAPI,S    IFNE ' '
    C           S         OREQ XE
    C           S         OREQ XI
D3  C           PAPI,S    IFNE 'XXX'
    C           GRAM,S    ANDNE999
     *
D4  C           APP,S     IFEQ 'F'
     C                     MOVE 'F'       FOUB
X4  C                     ELSE
     C                     MOVE 'B'       FOUB
F4  C                     END
D4  C           APPEX     IFEQ 'O'                        IMP. APRES OND.
    C           S         ANDEQ3
     C                     MOVE 'B'       FOUB
     C                     MOVE APPEX     APPO
F4  C                     END
D4  C           APPIN     IFEQ 'O'
    C           S         ANDEQ5
     C                     MOVE 'B'       FOUB
     C                     MOVE APPIN     APPO
F4  C                     END
     *
    C* SI ORDONNANCEMENT OU PRIX REVIENT
    C* ----------------------------------
    C*                    MOVE ' '       FOUB
     C                     MOVE ADPA,S    PSOF    3
     C                     MOVELADPA,S    PELPEL  3
     *  DEMANDE GUY 22/01/2013 POUR APPLIQUER LE COEF ALLONGEMENT
D4  C           DSGP      IFEQ 'SP'
     C                     Z-ADDUSINE     USPAP
D5  C           S         IFEQ SUPINT
     C                     Z-ADDUSINT     USPAP
F5  C                     END
D5  C           S         IFEQ SUPEXT
     C                     Z-ADDUSEXT     USPAP
F5  C                     END
F4  C                     END
D4  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'A5'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'PR'
D5  C           PSOF      IFNE 'CXH'
     C                     Z-ADDUSINE     USPAP   10
D6  C           S         IFEQ SUPINT
     C                     Z-ADDUSINT     USPAP
F6  C                     END
D6  C           S         IFEQ SUPEXT
     C                     Z-ADDUSEXT     USPAP
F6  C                     END
     *
     C           CLEQUA    CHAINQUAUSI               80
    C           *IN80     CABEQ'1'       DULCB4
    C*
X5  C                     ELSE                            COMPLEXE
     C           DULCX5    TAG
     C                     EXSR VALCX1
D6  C           *IN78     IFEQ '1'
     C                     EXSR VALCX2
     C           CLEPRE    CHAINCXHENTL1             80
D7  C           S         IFLE 3
     C                     Z-ADDS         CXHEX
     C                     Z-ADDSURCXH    SURCXE
X7  C                     ELSE
     C                     Z-ADDS         CXHIN
     C                     Z-ADDSURCXH    SURCXI
F7  C                     END
     C                     MOVE *BLANK    CATEGO
    C                     GOTO DULC3
F6  C                     END
     C           CLEQUX    CHAINQUAUSI               80
D6  C           *IN80     IFEQ '1'
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVE GRACXH    Z7A
     C                     MOVELQUACXH    Z7A
     C                     MOVE ADGCXH    Z10A   10
     C                     MOVELADPCXH    Z10A
     C                     Z-ADD11        ERR1,A
     C                     MOVELZ7A       ERR2,A
     C                     MOVE Z10A      ERR2,A
    C                     GOTO DULCA
F6  C                     END
F5  C                     END
    C*
D5  C           STDPRI    IFNE *ZEROS
     C                     Z-ADDSTDPRI    QUINTA
X5  C                     ELSE
D6  C           PMP       IFGT *ZEROS
     C                     Z-ADDPMP       QUINTA  72
X6  C                     ELSE
     C                     Z-ADDDERPRI    QUINTA
F6  C                     END
F5  C                     END
    C           QUINTA    CABEQ*ZEROS    DULCB4
     *
D5  C           PSOF      IFNE 'CXH'
     C           CLEPRE    CHAINMATPREL1             80
X5  C                     ELSE
     C           CLEPRX    CHAINMATPREL1             80
F5  C                     END
D5  C           *IN80     IFEQ '0'
    C           CATEGO    ANDEQ'G'
     C           QUINTA    MULT KASTOG    COUSTO  92
     C                     DIV  100       COUSTO
     C                     ADD  COUSTO    QUINTA
     C                     DIV  0,99      QUINTA    H
     C           COUSTO    DIV  0,99      PAPSTO  72H
    C                     GOTO DULCB3
F5  C                     END
     *
     C                     ADD  FORSTO    QUINTA
D5  C           FOUB      IFEQ 'F'
     C                     DIV  0,985     QUINTA    H
     C           FORSTO    DIV  0,985     PAPSTO    H
X5  C                     ELSE
D6  C           GRAMOY    IFGT 55
     C                     DIV  0,97      QUINTA    H
     C           FORSTO    DIV  0,97      PAPSTO    H
X6  C                     ELSE
     C                     DIV  0,96      QUINTA    H
     C           FORSTO    DIV  0,96      PAPSTO    H
F6  C                     END
F5  C                     END
     C           DULCB3    TAG
     *          ---------------
    C           ADPA,S    CABEQ'FOURNI'  DULC3
     *
     C           PAPSTO    MULT GRAMOY    PRIXX     H
     C           PRIXX     DIV  1000      PAPSTO    H
     C           QUINTA    MULT GRAMOY    PRIXX  102H
     C           PRIXX     DIV  1000      PRUTOT    H
D5  C           *IN75     IFEQ '1'                        COMPLEXE
     C                     ADD  PAPSTO    TTSTO   72
     C                     ADD  PRUTOT    TOTPR   72
D6  C           APIECX    IFEQ 'O'
    C           SUPCXH    ANDEQRSIECX
    C           S         ANDLE3
    C           APIICX    OREQ 'O'
    C           SUPCXH    ANDEQRSIICX
    C           S         ANDGT3
     C                     ADD  PRUTOT    CISTO
F6  C                     END
    C                     GOTO DULCX5
X5  C                     ELSE
    C                     GOTO DULC3
F5  C                     END
     *
F4  C                     END
     C           DULCB4    TAG
     *          ---------------
D4  C           S         IFEQ XE
    C           NIMPE1    ANDNE*BLANKS
    C           S         OREQ XI
    C           NIMPI1    ANDNE*BLANKS
     * recherche dans le f. preimp .
D5  C           S         IFLE 3
     C                     MOVE NIMPE1    NOI1
     C                     MOVE NIMPE2    NOI2
X5  C                     ELSE
     C                     MOVE NIMPI1    NOI1
     C                     MOVE NIMPI2    NOI2
F5  C                     END
     C           CPREIM    CHAINPREIMP2              80
D5  C           *IN80     IFEQ '1'
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVELNOI1      Z9A     9
     C                     MOVE NOI2      Z9A
     C                     Z-ADD11        ERR1,A
     C                     MOVE Z9A       ERR2,A
    C                     GOTO DULCA
F5  C                     END
D5  C           S         IFLE 3
     C                     Z-ADDUSINEP    USPE
     C                     Z-ADDGRAMS     GRAMS3
X5  C                     ELSE
     C                     Z-ADDUSINEP    USPI
     C                     Z-ADDGRAMS     GRAMS5
F5  C                     END
     *
     C           FORSTO    MULT GRAMS     COUSTO
     C                     DIV  1000      COUSTO    H
D5  C           COUPS     IFEQ 'F'
     C           COUSTO    DIV  0,985     PAPSTO    H
X5  C                     ELSE
D6  C           GRAMS     IFLE 55
     C           COUSTO    DIV  0,96      PAPSTO    H
X6  C                     ELSE
     C           COUSTO    DIV  0,97      PAPSTO    H
F6  C                     END
F5  C                     END
     * matiere au 100m2 (prv) -matpre-
     C                     Z-ADDCMA100    MATCM2
     * reglage au 100m2 (prv) -matpre-
     C                     Z-ADDCRE100    CRECM2
     * roulage au 100m2 (prv) -matpre-
     C                     Z-ADDCRO100    CROCM2
     * rapport des laizes entre pre-imprime STOCK et laizes mini
     *                                                 du devis .
     C                     ADD  CRECM2    DREGST
     C                     ADD  CROCM2    DROUST
     C                     Z-ADDMATCM2    MATSTO
     *
     C           MATCM2    ADD  CRECM2    PRUTOT
     C                     ADD  CROCM2    PRUTOT
     C           MATCM2    MULT KMAT      MATCM2    H
     C           CRECM2    MULT KREG      CRECM2    H
     * <---PAGE-C3BIS--->
     C           CROCM2    MULT KROUL     CROCM2    H
     C           MATCM2    ADD  CRECM2    PVSPAP  72
     C                     ADD  CROCM2    PVSPAP
D5  C           S         IFNE 4
D6  C           TIMPS     IFEQ 4
     C                     ADD  GRAMS     GRAAUT
X6  C                     ELSE
     C                     ADD  GRAMS     GRAOND
F6  C                     END
     C                     Z-ADD1,00      ALLONG
X5  C                     ELSE
D6  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'SP'
D7  C                     SELEC
     C           USPAP     WHEQ 2
     C                     MOVE 'OND2'    PXARGU
     C           USPAP     WHEQ 3
     C                     MOVE 'OND3'    PXARGU
     C           USPAP     WHEQ 4
     C                     MOVE 'OND4'    PXARGU
     C           USPAP     WHEQ 7
     C                     MOVE 'OND7'    PXARGU
     C                     OTHER
     C                     MOVE 'ONDU'    PXARGU
F7  C                     ENDSL
X6  C                     ELSE
     C                     MOVE 'ONDU'    PXARGU
F6  C                     END
     C                     MOVE ONDUL     PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D6  C  N80      PXMONT    IFNE 0
     C           GRAMS     MULT PXMONT    GRACAN
     C                     Z-ADDPXMONT    ALLONG
F6  C                     END
F5  C                     END
     * formatage du tableau des qualites et grammages papiers .
     C                     MOVE QULS      QUAL,S
     * <---PAGE-C4--->
D5  C           S         IFLE 3
     C                     SETON                     99
     C                     MOVE TIMPS     IMPEX
     C                     MOVE TREPS     IMPER
     C                     MOVE DEMAR     DEMAE
     C                     Z-ADDS         SUPEXT
     C                     Z-ADD0         IMPEXT
D6  C           TREPS     IFNE *ZEROS
     C                     Z-ADD0         RIMPEX
F6  C                     END
X5  C                     ELSE
     C                     SETON                     98
     C                     MOVE TIMPS     IMPIN
     C                     MOVE TREPS     IMPIR
     C                     MOVE DEMAR     DEMAI
     C                     Z-ADDS         SUPINT
     C                     Z-ADD0         IMPINT
D6  C           TREPS     IFNE *ZEROS
     C                     Z-ADD0         RIMPIN
F6  C                     END
F5  C                     END
     C           PRUTOT    MULT ALLONG    PRUTOT
     C           PVSPAP    MULT ALLONG    PVSPAP
     C                     MULT ALLONG    CISTO
     * formatage de la zone "coupr" si pre-imprime stocke .
D5  C           COUPR     IFEQ ' '
D6  C           COUPS     IFEQ 'R'
     C                     MOVE 'R'       COUPR
F6  C                     END
F5  C                     END
    C                     GOTO DULCV
     *
     *
X4  C                     ELSE
     * prix 100m2 prv + supplement marche .
D5  C           PSOF      IFNE 'CXH'
     C           CLEPRE    CHAINMATPREL1             80
X5  C                     ELSE
     C           DULCX7    TAG
     C                     EXSR VALCX1
D6  C           *IN78     IFEQ '1'
     C                     EXSR VALCX2
     C           CLEPRE    CHAINCXHENTL1             80
D7  C           S         IFLE 3
     C                     Z-ADDS         CXHEX
     C                     Z-ADDSURCXH    SURCXE
X7  C                     ELSE
     C                     Z-ADDS         CXHIN
     C                     Z-ADDSURCXH    SURCXI
F7  C                     END
     C                     MOVE *BLANK    CATEGO
    C                     GOTO DULC3
F6  C                     END
     C           CLEPRX    CHAINMATPREL1             80
F5  C                     END
D5  C           *IN80     IFEQ '1'
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
D6  C           PSOF      IFNE 'CXH'
     C                     MOVE GRAM,S    Z7A
     C                     MOVELPAPI,S    Z7A
     C                     MOVE *BLANKS   Z10A
X6  C                     ELSE
     C                     MOVE GRACXH    Z7A
     C                     MOVELQUACXH    Z7A
     C                     MOVE ADGCXH    Z10A   10
     C                     MOVELADPCXH    Z10A
F6  C                     END
     C                     Z-ADD11        ERR1,A
     C                     MOVELZ7A       ERR2,A
     C                     MOVE Z10A      ERR2,A
    C                     GOTO DULCA
F5  C                     END
     * <---PAGE-C2BIS--->
D5  C           CATEGO    IFEQ 'G'
     C           PAPRI     MULT KASTOG    COUSTO    H
     C                     DIV  1000      COUSTO    H
     C                     Z-ADDCOUSTO    COUSTS
     C           COUSTO    DIV  0,99      PAPSTO    H
X5  C                     ELSE
     C           FORSTO    MULT GRLABO    COUSTO
     C                     DIV  1000      COUSTO    H
     C                     Z-ADDCOUSTO    COUSTS
D6  C           FOUB      IFEQ 'F'
     C           COUSTO    DIV  0,985     PAPSTO    H
X6  C                     ELSE
D7  C           GRLABO    IFLE 55
     C           COUSTO    DIV  0,96      PAPSTO    H
X7  C                     ELSE
     C           COUSTO    DIV  0,97      PAPSTO    H
F7  C                     END
F6  C                     END
F5  C                     END
     * CALCUL PRIX PAPIER
     *-------------------------
     C                     MOVE GRLABO    GRABOB  55
D5  C           FOUB      IFEQ 'F'
     C                     Z-ADDPRIACH    PRUTOT
X5  C                     ELSE
     C           PRIACH    SUB  MINBOB    PRUTOT           MINORATION MÊME UNITE
F5  C                     END
     * GUY 14/01/2013
D5  C           DSGP      IFNE 'SP'
     C           MMARGE    DIV  100       MARGE1  44
     C           1         ADD  MARGE1    MARGE2  54
     C                     MULT MARGE2    PRUTOT
F5  C                     END
D5  C           CATEGO    IFEQ 'G'
     C           PRUTOT    MULT KASTOG    PRUTO2  92
     C                     DIV  100       PRUTO2
     C                     ADD  PRUTO2    PRUTOT
     C                     DIV  0,99      PRUTOT    H
X5  C                     ELSE
D6  C           UNIAC2    IFEQ 'KG'
     C                     ADD  FORSTO    PRUTOT
X6  C                     ELSE
     C                     ADD  COUSTS    PRUTOT
F6  C                     END
D6  C           FOUB      IFEQ 'F'
     C                     DIV  0,985     PRUTOT    H
X6  C                     ELSE
D7  C           GRLABO    IFLE 55
     C                     DIV  0,96      PRUTOT    H
X7  C                     ELSE
     C                     DIV  0,97      PRUTOT    H
F7  C                     END
F6  C                     END
F5  C                     END
D5  C           UNIAC2    IFEQ 'KG'
     C                     MULT GRABOB    PRUTOT
F5  C                     END
    C*
D5  C           LZPEAP    IFGT *ZEROS                     FILM PELLICULE
D6  C           PSOF      IFNE 'CXH'
    C           GRAM,S    ANDLT50
    C           PSOF      OREQ 'CXH'
    C           GRACXH    ANDLT50
     C           LZPEAP    DIV  LZRAP     RDCOL     H
D7  C           RDCOL     IFEQ 0
     C                     Z-ADD1         RDCOL
F7  C                     END
     C                     MULT RDCOL     PRUTOT
F6  C                     END
F5  C                     END
    C*
D5  C           *IN75     IFEQ '1'                        COMPLEXE
     C                     MULT RSUCXH    PRUTOT
     C                     ADD  PRUTOT    TOTPR
D6  C           APIECX    IFEQ 'O'
    C           SUPCXH    ANDEQRSIECX
    C           S         ANDLE3
    C           APIICX    OREQ 'O'
    C           SUPCXH    ANDEQRSIICX
    C           S         ANDGT3
     C                     ADD  PRUTOT    CISTO
F6  C                     END
    C                     GOTO DULCX7
F5  C                     END
     *
     C           DULC3     TAG
    C*------------------------
     * ponderation papiers speciaux .
D5  C           CATEGO    IFNE 'A'
    C           CATEGO    ANDNE'B'
D6  C           RASP,S    IFNE *ZEROS
     C                     MULT RASP,S    PRUTOT
     C                     MULT RASP,S    CISTO
F6  C                     END
F5  C                     END
    C*
D5  C           FOUB      IFEQ 'B'
    C           APP,S     ANDNE' '
    C           APP,S     ANDNE'O'
    C           APPO      ANDNE'O'
    C           PSOF      ANDNE'CXH'                      PAS COMPEXE
     C                     MULT 1,025     PRUTOT
     C                     MULT 1,025     CISTO
F5  C                     END
     * si U3 on = simulation <essai nouveau tarif>
D5  C   U3      KPPAP     IFNE 0
     C   U3                MULT KPPAP     PRUTOT    H
     C   U3                MULT KPPAP     CISTO     H
F5  C                     END
     C/SPACE 2
     * formatage du tableau des papiers speciaux .
     C                     MOVE PAPI,S    PAPIK
     C                     Z-ADDGRAM,S    GRAMK
     C                     MOVE ADPA,S    ADPAK
     C                     Z-ADDADGR,S    ADGRK
     C                     MOVE QUL       QUAL,S
D5  C           DECPAP    IFNE 0
     C                     ADD  DECPAP    DECSUP  42
F5  C                     END
     *------------------------
D5  C           S         IFEQ 3
    C           ONDUL     CABEQ7         DULCF
    C           CCOL      CABEQ9         DULCF
D6  C           CCOL      IFEQ 6
     C                     ADD  GRAM,S    GRONCC           1° TRANSF.  GE
    C                     GOTO DULCF
F6  C                     END
D6  C           *IN77     IFEQ '1'                        COMPLEXE
    C           LMINI     ANDEQ*ZEROS                      SANS ONDUL OU
     C                     ADD  GRAM,S    GRAOND            CONTRECOLLAGE
     C                     Z-ADD1,00      ALLONG           BESOIN POUR
    C                     GOTO DULCT                      RECHER. CADDEC
F6  C                     END
F5  C                     END
D5  C           S         IFEQ 4
D6  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
    C           CCOL      OREQ 5
    C           CCOL      OREQ 6
    C           CCOL      OREQ 9
     C                     ADD  GRAM,S    GRAOND
     C                     Z-ADD1,00      ALLONG
D7  C           CCOL      IFEQ 6
     C                     ADD  GRAM,S    GRONCC           1° TRANSF.  GE
F7  C                     END
    C                     GOTO DULCT
F6  C                     END
    C                     GOTO DULCF
F5  C                     END
D5  C           S         IFEQ 5
    C           CCOL      CABEQ6         DULCF
    C           CCOL      CABEQ9         DULCF
F5  C                     END
     * grammage ondule et autres supports .
D5  C           S         IFEQ 3
    C           APPEX     ANDNE*BLANKS
    C           APPEX     ANDNE'O'
    C           S         OREQ 5
    C           APPIN     ANDNE*BLANKS
    C           APPIN     ANDNE'O'
     C                     ADD  GRAM,S    GRAAUT
X5  C                     ELSE
     C                     ADD  GRAM,S    GRAOND
D6  C           CCOL      IFEQ 6
    C           S         ANDEQ2
     C                     ADD  GRAM,S    GRONCC           1° TRANSF.  GE
F6  C                     END
F5  C                     END
     C                     Z-ADD1,00      ALLONG
    C                     GOTO DULCT
     * <---PAGE-C7--->
     C           DULCF     TAG
D5  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'SP'
D6  C                     SELEC
     C           USPAP     WHEQ 2
     C                     MOVE 'OND2'    PXARGU
     C           USPAP     WHEQ 3
     C                     MOVE 'OND3'    PXARGU
     C           USPAP     WHEQ 4
     C                     MOVE 'OND4'    PXARGU
     C           USPAP     WHEQ 7
     C                     MOVE 'OND7'    PXARGU
     C                     OTHER
     C                     MOVE 'ONDU'    PXARGU
F6  C                     ENDSL
X5  C                     ELSE
     C                     MOVE 'ONDU'    PXARGU
F5  C                     END
D5  C           CCOL      IFEQ 9
    C           CCOL      OREQ 6
D6  C           S         IFEQ 3
     C                     MOVE DD1       PXVALE    P
X6  C                     ELSE
     C                     MOVE DD2       PXVALE    P
F6  C                     END
     C           CLEPAR    CHAINPARAME               80
D6  C  N80      PXMONT    IFNE 0
     C                     Z-ADDPXMONT    ALLONG
F6  C                     END
X5  C                     ELSE
     C                     MOVE ONDUL     PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D6  C  N80      PXMONT    IFNE 0
     C                     Z-ADDPXMONT    ALLONG
F6  C                     END
F5  C                     END
    C*
    C           CCOL      CABEQ6         DULCI
    C           CCOL      CABEQ9         DULCI
     * allongement micro f.papier .
D5  C           ONDUL     IFEQ 1
D6  C           PASMC     IFNE 0
     C                     Z-ADDPASMC     ALLONG
F6  C                     END
F5  C                     END
     * allongement p.c. f.papier .
D5  C           ONDUL     IFEQ 2
D6  C           PASPC     IFNE 0
     C                     Z-ADDPASPC     ALLONG
F6  C                     END
F5  C                     END
     * allongement g.c. f.papier .
D5  C           ONDUL     IFEQ 3
D6  C           PASGC     IFNE 0
     C                     Z-ADDPASGC     ALLONG
F6  C                     END
F5  C                     END
    C                     GOTO DULCP
     * <---PAGE-C9--->
     C           DULCI     TAG
D5  C           S         IFEQ 3
     * allongement m.c. f.papier .
D6  C           PASMC     IFNE 0
     C                     Z-ADDPASMC     ALLONG
F6  C                     END
     C           GRAM,3    MULT ALLONG    GRADD   30H
     C                     ADD  GRADD     GRACAN  40
X5  C                     ELSE
     * allongement p.c. f.papier .
D6  C           PASPC     IFNE 0
     C                     Z-ADDPASPC     ALLONG
F6  C                     END
     C           GRAM,5    MULT ALLONG    GRADD     H
     C                     ADD  GRADD     GRACAN
F5  C                     END
    C                     GOTO DULCO
     * <---PAGE-C10--->
     C           DULCP     TAG
D5  C           ONDUL     IFEQ 7
     C           GRAM,3    MULT ALLONG    GRACAN    H
X5  C                     ELSE
     C           GRAM,4    MULT ALLONG    GRACAN    H
F5  C                     END
     C           DULCO     TAG
     C                     MULT ALLONG    PRUTOT    H
     C                     MULT ALLONG    PAPSTO    H
     C                     MULT ALLONG    CISTO     H
     * formatage du tableau des coefficients d'allongement par support
     C           DULCT     TAG
     C           PRUTOT    MULT KMAT      PVSPAP  72H
     C                     MULT KMAT      CISTO   72H
    C*
     C           DULCV     TAG
     C                     MOVE ALLONG    TALO,S
     * formatage du tableau des couts directs par support .
     C                     Z-ADDPRUTOT    TACO,S
     * formatage du tableau des valeurs ventes au 100m2 par support .
     C                     Z-ADDPVSPAP    TAVA,S
     * prix de vente au m2 .
     C           PVSPAP    MULT 0,01      PAPM2   64
     C           CISTO     MULT 0,01      CISM2   64
     * surface a l'unite de vente .
     C           PAPM2     MULT SUVENT    PAPVT     H
     C           CISM2     MULT SUVENT    CISVT   62H
     * <---PAGE-C12--->
     * formatage du tableau des valeurs ventes a l'unite de vente
     *                                               par support .
     C                     Z-ADDPAPVT     TALU,S
     C                     Z-ADDPAPSTO    TSTO,S
D5  C           S         IFLE 3
D6  C           S         IFEQ SUPEXT
D7  C           CISTO     IFNE *ZEROS
     C                     Z-ADDCISTO     PAPEXT
     C                     Z-ADDCISVT     VTPEXT
X7  C                     ELSE
     C                     Z-ADDPVSPAP    PAPEXT  62
     C                     Z-ADDPAPVT     VTPEXT
F7  C                     END
     C                     Z-ADDPRUTOT    DIRPEX  62
D7  C           S         IFEQ SUPINT
     C                     Z-ADDPVSPAP    PAPINX
     C                     Z-ADDPRUTOT    DIRPIN  62
     C                     Z-ADDPAPVT     VTPINT
     C                     SETON                     94
     C                     Z-ADDPVSPAP    PVSPS   62
     C                     Z-ADDPAPVT     PAPVS   72
F7  C                     END
     C                     Z-ADDMATSTO    MATSTE
     C                     ADD  CRECM2    VREGST
     C                     ADD  CROCM2    VROUST
F6  C                     END
D6  C           S         IFEQ SUPEXT
    C           IMPEXT    ANDNE3
    C           IMPEXT    ANDNE5
     C                     Z-ADDPAPSTO    STOPEX  72
     C                     Z-ADDPRUTOT    PAPIEX  72
X6  C                     ELSE
     C                     ADD  PRUTOT    PAPFAC  72
     C                     ADD  PAPSTO    STOPFA  72
F6  C                     END
X5  C                     ELSE
D6  C           S         IFEQ SUPINT
D7  C           CISTO     IFNE *ZEROS
     C                     Z-ADDCISTO     PAPINX
     C                     Z-ADDCISVT     VTPINT
X7  C                     ELSE
     C                     Z-ADDPVSPAP    PAPINX
     C                     Z-ADDPAPVT     VTPINT
F7  C                     END
     C                     Z-ADDPRUTOT    DIRPIN  62
     C                     Z-ADDMATSTO    MATSTI
     C                     ADD  CRECM2    VREGST
     C                     ADD  CROCM2    VROUST
F6  C                     END
D6  C           S         IFEQ SUPINT
    C           IMPINT    ANDNE3
    C           IMPINT    ANDNE3
     C                     Z-ADDPAPSTO    STOPIN  72
     C                     Z-ADDPRUTOT    PAPINT  72
X6  C                     ELSE
     C                     ADD  PRUTOT    PAPFAC
     C                     ADD  PAPSTO    STOPFA
F6  C                     END
F5  C                     END
     *
D5  C           *IN31     IFEQ '0'
D6  C           TSEXT     IFEQ 'I'
    C           TSINT     OREQ 'I'
D7  C           FORL      IFNE *ZEROS
     C                     Z-ADDFORL      FORHBM
F7  C                     END
D7  C           FORH      IFNE *ZEROS
     C                     Z-ADDFORH      FORLBM
F7  C                     END
X6  C                     ELSE
D7  C           FORL      IFNE *ZEROS
     C                     Z-ADDFORL      FORLBM
F7  C                     END
D7  C           FORH      IFNE *ZEROS
     C                     Z-ADDFORH      FORHBM
F7  C                     END
F6  C                     END
F5  C                     END
     *
     C           DULCA     TAG
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     * support composant ondule - support cannelure - grammage ondule
     C                     ADD  GRACAN    GRAOND
     * grammage autres supports - grammage total .
     C           GRAOND    ADD  GRAAUT    TOTGRA  40
     * total des couts directs .
     C                     XFOOTTACO      PAPDIR  62
     * total valeurs papier 100m2 .
     C                     XFOOTTAVA      VALPAP  62
     * total valeurs papier à l'unite de vente
     C                     XFOOTTALU      VTEPAP  62
     * fin du module C *
    C           DULCFI    ENDSR
     C/EJECT
     *********************************
     * prix colle ondulation 100 m2  *
     * matieres annexes      100 m2  *
     *********************************            - module -D- -
    C           MODULD    BEGSR
    C*          ---------------
     C                     Z-ADD0         COLOND  62
     C                     Z-ADD0         COLON1  62
     C                     Z-ADD0         COLON2  62
     C                     Z-ADD0         COLCCO  62
     C                     Z-ADD0         COLCC1  62
     C                     Z-ADD0         COLCC2  62
     C                     Z-ADD0         COLGEN  62
     C                     Z-ADD0         COLM2   64
     C                     Z-ADD0         FORCOU  60
     C                     Z-ADD0         ENCRE1  62
     C                     MOVE *BLANKS   OCAL    1
     C                     Z-ADD0         COCAL   10
     C                     Z-ADD0         CORCUA  21
     C                     Z-ADD0         ENCRE2  52
     C                     Z-ADD0         ENCRE   52
     C                     Z-ADD0         VERNIX  52
     C                     Z-ADD0         FOREP   40
     C                     Z-ADD0         ENCRE3  52
     C                     Z-ADD0         VERREP  52
     C                     Z-ADD0         COUTEX  62
     C                     Z-ADD0         COUTIN  62
     C                     Z-ADD0         ENCM2   64
     C                     Z-ADD0         VERM2   64
     C                     Z-ADD0         FOREXT  40
     C                     Z-ADD0         FOREPE  40
     C                     Z-ADD0         ENCM2   64
     C                     Z-ADD0         VERM2   64
     C                     Z-ADD0         FORINT  40
     C                     Z-ADD0         FOREPI  40
     C                     Z-ADD0         VALEXT  62
     C                     Z-ADD0         VTEEXT  72
     C                     Z-ADD0         VALINT  62
     C                     Z-ADD0         VTEINT  72
     C                     Z-ADD0         VALMAT  62
     C                     Z-ADD0         VTEMAT  62
     C                     Z-ADD0         HELEN1
     C                     Z-ADD0         FLEEN1
     C                     Z-ADD0         OFFEN1
     C                     Z-ADD0         CYLAP1
     C                     Z-ADD0         HELFO1
     C                     Z-ADD0         FLEFO1
     C                     Z-ADD0         FOROF1
     C                     Z-ADD0         HELEN2
     C                     Z-ADD0         FLEEN2
     C                     Z-ADD0         OFFEN2
     C                     Z-ADD0         CYLAP2
     C                     Z-ADD0         HELFO2
     C                     Z-ADD0         FLEFO2
     C                     Z-ADD0         FOROF2
     C                     Z-ADD0         TYPENC
     C                     Z-ADD0         TYPFOR
     C                     Z-ADD0         COLVIN  62
     C                     Z-ADD0         COLAMY  62
     C                     Z-ADD0         AMTHEL
     C                     Z-ADD0         AMTFLE
     C                     Z-ADD0         AMTHER  62
     C                     Z-ADD0         AMTFLR  62
     C                     Z-ADD0         AMTCYL
     C                     Z-ADD0         COLLE
    C*
    C           TYPDEV    CABEQ4         DULDFI
     *-----------------------------*
     * PRIX COLLES                 *
     *-----------------------------*
     * COLLE COMPLEXAGE
     C                     ADD  CUMCOC    COLLE
     C                     Z-ADD*ZEROS    CUMCOC
     C                     Z-ADD*ZEROS    CCRR
     * ROLL ROLL SUR RT OU NE  ET COLLE NON = AM
D1  C           CCOL      IFEQ 3
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D3  C           USOND     IFEQ 2
    C           USOND     OREQ 4
D4  C           COLRH     IFNE 'AM'
     C                     Z-ADD1         CCRR    10
     C                     MOVE *BLANKS   COLRH
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           USINE     IFEQ 2
D4  C           COLRH     IFNE 'AM'
    C           USINE     OREQ 4
     C                     Z-ADD1         CCRR    10
     C                     MOVE *BLANKS   COLRH
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
     *
D1  C           ONDUL     IFEQ 0                           colle
    C           CCOL      ANDEQ0
    C           ONDUL     OREQ 7                           c/collage
    C           CCOL      OREQ 4
    C           CCOL      OREQ 5
    C           CCOL      OREQ 7
     C                     EXSR DULDA
X1  C                     ELSE
     * COLLE CANNELURES CROISSES
D2  C           CCOL      IFEQ 6
     C                     EXSR DULDB
X2  C                     ELSE
     * COLLE ONDULATION
D3  C           COLRH     IFEQ '  '
    C           COLRH     OREQ 'RH'
    C           COLRH     OREQ 'VP'
    C           COLRH     OREQ 'AM'
    C           COLRH     OREQ 'BT'
     *
D4  C           TOTGRA    IFGE 300
D5  C           CCOL      IFEQ 1
    C           CCOL      OREQ 2
    C           CCRR      OREQ 1
D6  C           ONDUL     IFEQ 1
    C           ONDUL     OREQ 6
    C           ONDUL     OREQ 4
     C                     Z-ADDCOSFMC    COLOND
D7  C           ONDUL     IFEQ 6
     C           COLOND    MULT 1,20      COLOND    H
F7  C                     END
D7  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,15      COLOND    H
F7  C                     END
F6  C                     END
D6  C           ONDUL     IFEQ 2
     C                     Z-ADDCOSFPC    COLOND
F6  C                     END
D6  C           ONDUL     IFEQ 3
     C                     Z-ADDCOSFGC    COLOND
F6  C                     END
F5  C                     END
     *
D5  C           CCOL      IFEQ 3
    C           CCRR      ANDNE1
D6  C           ONDUL     IFEQ 1
    C           ONDUL     OREQ 6
    C           ONDUL     OREQ 4
     C                     Z-ADDCODFMC    COLOND
D7  C           ONDUL     IFEQ 6
     C           COLOND    MULT 1,20      COLOND    H
F7  C                     END
D7  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,15      COLOND    H
F7  C                     END
F6  C                     END
D6  C           ONDUL     IFEQ 2
     C                     Z-ADDCODFPC    COLOND
F6  C                     END
F5  C                     END
D5  C           CCOL      IFEQ 9
     C                     Z-ADDCODDHN    COLOND
F5  C                     END
    C*
D5  C           COLRH     IFEQ 'RH'
D6  C           CCOL      IFEQ 9
     C           COLOND    MULT RHDDHN    COLOND    H
X6  C                     ELSE
     C                     Z-ADDCOLOND    COLAMY
     C           COLOND    MULT RHPLUS    COLOND    H
F6  C                     END
F5  C                     END
     *                                                               A
X4  C                     ELSE
D5  C           CCOL      IFEQ 1
    C           CCOL      OREQ 2
    C           CCRR      OREQ 1
D6  C           ONDUL     IFEQ 1
    C           ONDUL     OREQ 6
    C           ONDUL     OREQ 4
     C                     Z-ADDCOOND1    COLOND
D7  C           ONDUL     IFEQ 6
     C           COLOND    MULT 1,20      COLOND    H
F7  C                     END
D7  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,15      COLOND    H
F7  C                     END
F6  C                     END
D6  C           ONDUL     IFEQ 2
     C                     Z-ADDCOOND2    COLOND
F6  C                     END
D6  C           ONDUL     IFEQ 3
     C                     Z-ADDCOOND3    COLOND
F6  C                     END
F5  C                     END
D5  C           CCOL      IFEQ 3
    C           CCRR      ANDNE1
D6  C           ONDUL     IFEQ 1
    C           ONDUL     OREQ 6
    C           ONDUL     OREQ 4
     C                     Z-ADDCOOND4    COLOND
D7  C           ONDUL     IFEQ 6
     C           COLOND    MULT 1,20      COLOND    H
F7  C                     END
D7  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,15      COLOND    H
F7  C                     END
F6  C                     END
D6  C           ONDUL     IFEQ 2
     C                     Z-ADDCOOND5    COLOND
F6  C                     END
F5  C                     END
D5  C           CCOL      IFEQ 9
     C                     Z-ADDCODDHN    COLOND
F5  C                     END
     *
D5  C           COLRH     IFEQ 'RH'
D6  C           CCOL      IFEQ 9
     C           COLOND    MULT RHDDHN    COLOND    H
X6  C                     ELSE
     C                     Z-ADDCOLOND    COLAMY
     C           COLOND    MULT RH        COLOND    H
F6  C                     END
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
D4  C           CCOL      IFEQ 9
D5  C           COLRH     IFEQ 'BH'
     C                     Z-ADDFILL12    COLVIN
X5  C                     ELSE
     C                     Z-ADDCOVYMC    COLVIN
F5  C                     END
     C                     Z-ADDCOSFMC    COLOND
     C                     ADD  CODFPC    COLOND
D5  C           COLRH     IFEQ 'VH'
    C           COLRH     OREQ 'BH'
     C           COLOND    MULT RHDDHN    COLOND    H
F5  C                     END
X4  C                     ELSE
D5  C           ONDUL     IFEQ 1
    C           CCOL      ANDEQ1
    C           ONDUL     OREQ 1
    C           CCOL      ANDEQ3
D6  C           COLRH     IFEQ 'BH'
     C                     Z-ADDFILL12    COLVIN  62
X6  C                     ELSE
     C                     Z-ADDCOVYMC    COLVIN
F6  C                     END
     C                     Z-ADDCOSFMC    COLOND  62
X5  C                     ELSE
D6  C           COLRH     IFEQ 'BH'
     C                     Z-ADDFILL3     COLVIN  62
X6  C                     ELSE
     C                     Z-ADDCOVYPC    COLVIN
F6  C                     END
     C                     Z-ADDCOSFPC    COLOND
F5  C                     END
D5  C           COLRH     IFEQ 'VH'
    C           COLRH     OREQ 'BH'
     C           COLOND    MULT RHPLUS    COLOND    H
F5  C                     END
D5  C           ONDUL     IFEQ 6
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,20      COLVIN    H
F5  C                     END
D5  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLOND    H
     C                     MULT 1,15      COLOND    H
     C                     MULT 1,20      COLVIN    H
     C                     MULT 1,15      COLVIN    H
F5  C                     END
     *
F4  C                     END
F3  C                     END
    C* SI SIMPLE DOUBLE
D3  C           CCOL      IFEQ 9
    C           PAPI,2    ANDEQ'XXX'
    C           GRAM,2    ANDEQ999
    C           CCOL      OREQ 9
    C           PAPI,6    ANDEQ'XXX'
    C           GRAM,6    ANDEQ999
     C                     MULT 0,85      COLOND
     C                     MULT 0,85      COLVIN
F3  C                     END
    C*
     C                     ADD  COLVIN    COLOND
     C                     ADD  COLOND    COUDIR
     C           COLOND    MULT KMATA     COLONK  62H
     C                     ADD  COLONK    COLLE   62       COLLE
     *
     C                     EXSR DULDA
F2  C                     END
F1  C                     END
     * prix des colles a l'unite de vente
     C           COLLE     MULT 0,01      COLM2   64
     C           COLM2     MULT SUVENT    COLVT   62H
     * COLLE GENCO
D1  C           GENCO1    IFEQ '*'
     C                     Z-ADDCOLAFF    COLGEN
     C                     Z-ADDCOLAFF    COLVIN
     C                     ADD  COLGEN    COUDIR
     C                     MULT KMATA     COLGEN
     C                     ADD  COLGEN    COLLE
     C                     MOVE CLIE3     AFFL1   43
     C                     MOVE CLII3     AFFD1   40
     C           AFFL1     MULT AFFD1     SURAFF  83
     C           COLGEN    MULT 0,01      COLM2   64
     C           COLM2     MULT SURAFF    VCAFF   62H
D2  C           UVENT     IFEQ 5
     C                     DIV  1000      VCAFF     H
F2  C                     END
D2  C           POSF1     IFNE *ZEROS
     C                     DIV  POSF1     VCAFF
F2  C                     END
     C                     ADD  VCAFF     COLVT
F1  C                     END
D1  C           GENCO2    IFEQ '*'
     C                     Z-ADDCOLAFF    COLGEN
     C                     Z-ADDCOLAFF    COLVIN
     C                     ADD  COLGEN    COUDIR
     C                     MULT KMATA     COLGEN
     C                     ADD  COLGEN    COLLE
     C                     MOVE CLIE2     AFFL2   43
     C                     MOVE CLII2     AFFD2   40
     C           AFFL2     MULT AFFD2     SURAFF  83
     C           COLGEN    MULT 0,01      COLM2   64
     C           COLM2     MULT SURAFF    VCAFF   62H
D2  C           UVENT     IFEQ 5
     C                     DIV  1000      VCAFF     H
F2  C                     END
D2  C           POSF1     IFNE *ZEROS
     C                     DIV  POSF1     VCAFF
F2  C                     END
     C                     ADD  VCAFF     COLVT
F1  C                     END
     C/SPACE 3
     *-----------------------------*
     * PRIX ENCRES ET VERNIS       *
     *-----------------------------*
     C                     Z-ADD0         VERNIX
     C                     Z-ADD0         ENCRE
     C                     Z-ADD0         ENCRE1
     C                     Z-ADD0         ENCRE2
     C                     Z-ADD0         ENCRE3
     C                     Z-ADD0         ENCRE4
     C/SPACE 3
     C                     Z-ADD0         GPEX    10
     C                     Z-ADD0         GPEXR   10
     C                     Z-ADD0         GPIN    10
     C                     Z-ADD0         GPINR   10
    C* ----------------------------------------
    C* Impression EXT 3B PRINCIPALE + REPIQUAGE
    C* ----------------------------------------
D1  C           SUPEXT    IFEQ 3
    C           OTCOEP    ANDNE*ZEROS
    C           IMPEXT    ANDEQ4
     C                     EXSR EXT3B
    C                     GOTO STAND
F1  C                     END
    C*
     * impression EXT STANDARD
     *********************************
     C/SPACE 1
D1  C           SUPEXT    IFNE *ZEROS
     C                     Z-ADDSUPEXT    S
D2  C           NIMPE1    IFEQ *BLANKS
     C                     SETOF                     98
     C           CLEPRE    CHAINMATPREL1             99
     C   99      CLEPRE    CHAINCXHENTL1             99
D3  C           *IN99     IFEQ '0'
    C           IMPFA     ANDEQ1
     C                     SETON                     98
F3  C                     END
     C/SPACE 1
     * ENCRE
     *-----------------------
D3  C           COUEX     IFNE *ZEROS
D4  C           GRPEX     IFNE *ZEROS
     C                     Z-ADDGRPEX     GRP     20
X4  C                     ELSE
     C                     Z-ADDCOUEX     GRP
F4  C                     END
     * helio
D4  C           IMPEXT    IFEQ 1
     C           FORHEL    MULT GRP       FORCOU  60
     C           ENCRH     MULT ENCEX     ENCRE1  62H
F4  C                     END
     * flexo
D4  C           IMPEXT    IFEQ 2
     C           FORFLE    MULT GRP       FORCOU
D5  C           UVEXT     IFEQ 'E'
     C           ENCRLO    MULT ENCEX     ENCRE1    H
X5  C                     ELSE
     C           ENCRF     MULT ENCEX     ENCRE1    H
F5  C                     END
F4  C                     END
     * typo
D4  C           IMPEXT    IFEQ 3
     C           FORTYP    MULT GRP       FORCOU
     C           ENCRT     MULT ENCEX     ENCRE1    H
F4  C                     END
     * POST PRINT
D4  C           IMPEXT    IFEQ 5
     C           FORTYP    MULT GRP       FORCOU
     C           ENCRT     MULT ENCEX     ENCRE1    H
F4  C                     END
     * offset
D4  C           IMPEXT    IFEQ 4
     C           FOROFF    MULT GRP       FORCOU
D5  C           UVEXT     IFNE 'U'
D6  C           UVEXT     IFEQ 'F'
    C           UVEXT     OREQ 'N'
     C           FILL20    MULT ENCEX     ENCRE1    H
X6  C                     ELSE
D7  C           UVEXT     IFEQ 'G'
    C           UVEXT     OREQ 'O'
     C           FILL21    MULT ENCEX     ENCRE1    H
X7  C                     ELSE
     C           ENCRO     MULT ENCEX     ENCRE1    H
F7  C                     END
F6  C                     END
X5  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D6  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F6  C                     END
     C           SENCUV    MULT ENCEX     ENCRE1    H
F5  C                     END
F4  C                     END
     * majoration encre special .
D4  C           ESPEX     IFNE 0
     C           ENCRE1    MULT ESPEX     ENCRE1    H
F4  C                     END
    C*
D4  C           ENCEX     IFGE 1,0
D5  C           IMPEXT    IFLT 2
     C                     ADD  AMTAPH    ENCRE1
     C                     ADD  AMTAPH    AMTHEL  52
F5  C                     END
D5  C           IMPEXT    IFEQ 2
     C                     ADD  AMTAPF    ENCRE1
     C                     ADD  AMTAPF    AMTFLE  52
F5  C                     END
F4  C                     END
     * majoration encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D4  C           CFLEX     IFNE *ZEROS
     C           VERNU1    MULT CFLEX     ENCRFL    H
     C                     ADD  ENCRFL    ENCRE1
F4  C                     END
    C*
F3  C                     END
     C/SPACE 1
     * OU CUIVRE ALU
     *-----------------------
D3  C           OREX      IFEQ ' '
     C                     Z-ADDENCRE1    ENCRE
X3  C                     ELSE
     C                     MOVELOREX      OCAL    1
     C                     MOVE OREX      COCAL   10
     *
D4  C           COCAL     IFEQ 0
     C                     Z-ADD1,0       CORCUA  21
X4  C                     ELSE
     C                     MOVE COCAL     CORCUA
F4  C                     END
     * ALU
     *-------
D4  C           OCAL      IFEQ 'A'
     * helio
D5  C           IMPEXT    IFEQ 1
     C                     ADD  FORALH    FORCOU
     C           ALUHE     MULT CORCUA    ENCRE2  52H
F5  C                     END
     * flexo
D5  C           IMPEXT    IFEQ 2
     C                     ADD  FORALF    FORCOU
     C           ALUFL     MULT CORCUA    ENCRE2    H
F5  C                     END
     * typo
D5  C           IMPEXT    IFEQ 3
     C                     ADD  FORALT    FORCOU
     C           ALUTY     MULT CORCUA    ENCRE2    H
F5  C                     END
     * offset
D5  C           IMPEXT    IFEQ 4
     C                     ADD  FORALO    FORCOU
     C           ALUOF     MULT CORCUA    ENCRE2    H
F5  C                     END
     * POST PRINT
D5  C           IMPEXT    IFEQ 5
     C                     ADD  FORALT    FORCOU
     C           ALUTY     MULT CORCUA    ENCRE2    H
F5  C                     END
     *
X4  C                     ELSE
     * OR
     *-------
D5  C           OCAL      IFEQ 'O'
     * helio
D6  C           IMPEXT    IFEQ 1
     C                     ADD  FORORH    FORCOU
     C           ORHEL     MULT CORCUA    ENCRE2    H
F6  C                     END
     * flexo
D6  C           IMPEXT    IFEQ 2
     C                     ADD  FORORF    FORCOU
     C           ORFLE     MULT CORCUA    ENCRE2    H
F6  C                     END
     * typo
D6  C           IMPEXT    IFEQ 3
     C                     ADD  FORORT    FORCOU
     C           ORTYP     MULT CORCUA    ENCRE2    H
F6  C                     END
     * offset
D6  C           IMPEXT    IFEQ 4
     C                     ADD  FORORO    FORCOU
     C           OROFF     MULT CORCUA    ENCRE2    H
F6  C                     END
     * POST PRINT
D6  C           IMPEXT    IFEQ 5
     C                     ADD  FORORT    FORCOU
     C           ORTYP     MULT CORCUA    ENCRE2    H
F6  C                     END
     *
X5  C                     ELSE
     * CUIVRE
     *-------
     C                     ADD  FORCU     FORCOU
     C           CUIVRE    MULT CORCUA    ENCRE2    H
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C           ENCRE1    ADD  ENCRE2    ENCRE   52
     C/SPACE 1
     * VERNIS
     *-----------------------
D3  C           TVEEX     IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPEXT    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D4  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X4  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F4  C                     END
     C           KTBA01    CHAINXTBASE01             99
D4  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D5  C           TVEEX     IFEQ 'F'
    C           CVEEX     ANDEQ*ZEROS
     C                     Z-ADD1         CVEEX
F5  C                     END
D5  C           TVEEX     IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F5  C                     END
     *
     C                     Z-ADDXVER05    GPEX
     C                     Z-ADDXVER04    FORCXX  60
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT CVEEX     VERNIX    H
     *
D5  C           IMPEXT    IFEQ 2
    C*                    Z-ADDGP1EX     GPEX
D6  C           GPEX      IFEQ *ZEROS
     C                     Z-ADD1         GPEX
F6  C                     END
     C                     SUB  XVER04    FORCOU
     C                     MULT GPEX      FORCXX
     C                     ADD  FORCXX    FORCOU
F5  C                     END
D5  C           TVEEX     IFEQ 'P'
    C           IMPEXT    ANDNE2
     C           VERNIX    MULT 2         VERNIX
F5  C                     END
D5  C           IMPEXT    IFEQ 1
D6  C           TVEEX     IFEQ 'P'
    C           TVEEX     OREQ 'T'
     C                     ADD  AMTCVH    VERNIX
     C                     ADD  AMTCVH    AMTHEL
F6  C                     END
F5  C                     END
D5  C           IMPEXT    IFEQ 2
D6  C           TVEEX     IFNE ' '
    C           CVEEX     ANDGE1
     C                     ADD  AMTCVF    VERNIX
     C                     ADD  AMTCVF    AMTFLE
F6  C                     END
F5  C                     END
     * majoration vernis special .
D5  C           VSPEX     IFNE 0
     C                     MULT VSPEX     VERNIX    H
F5  C                     END
     *
F4  C                     END
F3  C                     END
     *
     C           ENCRE     ADD  VERNIX    ENCVER  62
     C                     SUB  AMTHEL    ENCVER
     C                     SUB  AMTFLE    ENCVER
     C/SPACE 1
     * FORFAITS
     *-----------------------
D3  C           IMPEXT    IFEQ 1
     C                     Z-ADDFORCOU    HELFO1  60
     C                     ADD  ENCVER    HELEN1  62
F3  C                     END
D3  C           IMPEXT    IFEQ 2
     C                     Z-ADDFORCOU    FLEFO1  60
     C                     ADD  ENCVER    FLEEN1  62
F3  C                     END
D3  C           IMPEXT    IFEQ 3
     C                     Z-ADDFORCOU    TYPFOR  60
     C                     ADD  ENCVER    TYPENC  62
F3  C                     END
D3  C           IMPEXT    IFEQ 4
     C                     Z-ADDFORCOU    FOROF1  60
     C                     ADD  ENCVER    OFFEN1  62
F3  C                     END
D3  C           IMPEXT    IFEQ 5
     C                     Z-ADDFORCOU    TYPFOR  60
     C                     ADD  ENCVER    TYPENC  62
F3  C                     END
F2  C                     END
     C/SPACE 3
     * impression EXT repiquage .
     *********************************
D2  C           RIMPEX    IFNE 0
     C/SPACE 1
     * ENCRE
     *-----------------------
D3  C           COUEXR    IFNE 0
D4  C           GRPEXR    IFNE *ZEROS
     C                     Z-ADDGRPEXR    GRP     20
X4  C                     ELSE
     C                     Z-ADDCOUEXR    GRP
F4  C                     END
D4  C           RIMPEX    IFEQ 1
     C           FORHEL    MULT GRP       FOREP   40
     C           ENCRH     MULT ENCEXR    ENCRE3  52H
D5  C           ENCEXR    IFGE 1,0
     C                     ADD  AMTCVH    ENCRE3
     C                     ADD  AMTCVH    AMTHER
F5  C                     END
F4  C                     END
D4  C           RIMPEX    IFEQ 2
     C           FORFLE    MULT GRP       FOREP
     C           ENCRF     MULT ENCEXR    ENCRE3    H
F4  C                     END
D4  C           RIMPEX    IFEQ 3
     C           FORTYP    MULT GRP       FOREP
     C           ENCRT     MULT ENCEXR    ENCRE3    H
F4  C                     END
D4  C           RIMPEX    IFEQ 4
     C           FOROFF    MULT GRP       FOREP
D5  C           UVEXTR    IFEQ 'U'
     C           ENCRUV    MULT ENCEXR    ENCRE3    H
X5  C                     ELSE
D6  C           UVEXTR    IFEQ 'F'
    C           UVEXTR    OREQ 'N'
     C           FILL20    MULT ENCEXR    ENCRE3    H
X6  C                     ELSE
D7  C           UVEXTR    IFEQ 'G'
    C           UVEXTR    OREQ 'O'
     C           FILL21    MULT ENCEXR    ENCRE3    H
X7  C                     ELSE
     C           ENCRO     MULT ENCEXR    ENCRE3    H
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
D4  C           RIMPEX    IFEQ 5
     C           FORTYP    MULT GRP       FOREP
     C           ENCRT     MULT ENCEXR    ENCRE3    H
F4  C                     END
     * majoration encre special .
D4  C           ESPEXR    IFNE 0
     C           ENCRE3    MULT ESPEXR    ENCRE3    H
F4  C                     END
D4  C           ENCEXR    IFGE 1,0
D5  C           RIMPEX    IFLT 2
     C                     ADD  AMTAPH    ENCRE3
     C                     ADD  AMTAPH    AMTHER
F5  C                     END
D5  C           RIMPEX    IFEQ 2
     C                     ADD  AMTAPF    ENCRE3
     C                     ADD  AMTAPF    AMTFLR
F5  C                     END
F4  C                     END
     * majoration encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D4  C           FLUEXR    IFNE *BLANK
     C           VERNU1    MULT CFLEXR    ENCRFL    H
     C                     ADD  ENCRFL    ENCRE3
F4  C                     END
    C*
F3  C                     END
     C/SPACE 1
     * OU CUIVRE ALU
     *-----------------------
D3  C           OREXR     IFNE ' '
     C                     MOVELOREXR     OCAL    1
     C                     MOVE OREXR     COCAL   10
     *
D4  C           COCAL     IFEQ 0
     C                     Z-ADD1,0       CORCUA  21
X4  C                     ELSE
     C                     MOVE COCAL     CORCUA
F4  C                     END
     * ALU
     *-------
D4  C           OCAL      IFEQ 'A'
     * helio
D5  C           RIMPEX    IFEQ 1
     C                     ADD  FORALH    FOREP
     C           ALUHE     MULT CORCUA    ENCRE4  52H
F5  C                     END
     * flexo
D5  C           RIMPEX    IFEQ 2
     C                     ADD  FORALF    FOREP
     C           ALUFL     MULT CORCUA    ENCRE4    H
F5  C                     END
     * typo
D5  C           RIMPEX    IFEQ 3
     C                     ADD  FORALT    FOREP
     C           ALUTY     MULT CORCUA    ENCRE4    H
F5  C                     END
     * offset
D5  C           RIMPEX    IFEQ 4
     C                     ADD  FORALO    FOREP
     C           ALUOF     MULT CORCUA    ENCRE4    H
F5  C                     END
     * POST PRINT
D5  C           RIMPEX    IFEQ 5
     C                     ADD  FORALT    FOREP
     C           ALUTY     MULT CORCUA    ENCRE4    H
F5  C                     END
     *
X4  C                     ELSE
     * OR
     *-------
D5  C           OCAL      IFEQ 'O'
     * helio
D6  C           RIMPEX    IFEQ 1
     C                     ADD  FORORH    FOREP
     C           ORHEL     MULT CORCUA    ENCRE4    H
F6  C                     END
     * flexo
D6  C           RIMPEX    IFEQ 2
     C                     ADD  FORORF    FOREP
     C           ORFLE     MULT CORCUA    ENCRE4    H
F6  C                     END
     * typo
D6  C           RIMPEX    IFEQ 3
     C                     ADD  FORORT    FOREP
     C           ORTYP     MULT CORCUA    ENCRE4    H
F6  C                     END
     * offset
D6  C           RIMPEX    IFEQ 4
     C                     ADD  FORORO    FOREP
     C           OROFF     MULT CORCUA    ENCRE4    H
F6  C                     END
     * POST PRINT
D6  C           RIMPEX    IFEQ 5
     C                     ADD  FORORT    FOREP
     C           ORTYP     MULT CORCUA    ENCRE4    H
F6  C                     END
     *
X5  C                     ELSE
     * CUIVRE
     *-------
     C                     ADD  FORCU     FOREP
     C           CUIVRE    MULT CORCUA    ENCRE4    H
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C                     ADD  ENCRE3    ENCRE
     C                     ADD  ENCRE4    ENCRE
     C/SPACE 1
     * VERNIS
     *-----------------------
D3  C           TVEEXR    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D4  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X4  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F4  C                     END
     C           KTBA01    CHAINXTBASE01             99
D4  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D5  C           TVEEXR    IFEQ 'F'
    C           CVEEXR    ANDEQ*ZEROS
     C                     Z-ADD1         CVEEXR
F5  C                     END
D5  C           TVEEXR    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F5  C                     END
     *
     C                     Z-ADDXVER05    GPEXR
     C                     ADD  XVER04    FOREP
     C                     Z-ADDXVER04    FORCXX
     C           XVER03    MULT CVEEXR    VERREP  52H
     *
D5  C           RIMPEX    IFEQ 2
    C*                    Z-ADDGP1EXR    GPEXR
D6  C           GPEXR     IFEQ *ZEROS
     C                     Z-ADD1         GPEXR
F6  C                     END
     C                     SUB  XVER04    FOREP
     C                     MULT GPEXR     FORCXX
     C                     ADD  FORCXX    FOREP
F5  C                     END
D5  C           TVEEXR    IFEQ 'P'
    C           RIMPEX    ANDNE2
     C           VERREP    MULT 2         VERREP
F5  C                     END
D5  C           RIMPEX    IFEQ 1
D6  C           TVEEXR    IFEQ 'P'
    C           TVEEXR    OREQ 'T'
     C                     ADD  AMTCVH    VERREP
     C                     ADD  AMTCVH    AMTHER
F6  C                     END
F5  C                     END
D5  C           RIMPEX    IFEQ 2
D6  C           TVEEXR    IFNE ' '
    C           CVEEXR    ANDGE1
     C                     ADD  AMTCVF    VERREP
     C                     ADD  AMTCVF    AMTFLR
F6  C                     END
F5  C                     END
     * majoration vernis special .
D5  C           VSPEXR    IFNE 0
     C                     MULT VSPEXR    VERREP    H
F5  C                     END
     *
F4  C                     END
F3  C                     END
     *
     C                     ADD  VERREP    VERNIX
     C           ENCRE3    ADD  VERREP    ENCREP  62
     C                     ADD  ENCRE4    ENCREP
     C                     SUB  AMTHER    ENCREP
     C                     SUB  AMTFLR    ENCREP
     *
D3  C           RIMPEX    IFEQ 1
     C                     ADD  FOREP     HELFO1
     C                     ADD  ENCREP    HELEN1
F3  C                     END
D3  C           RIMPEX    IFEQ 2
     C                     ADD  FOREP     FLEFO1
     C                     ADD  ENCREP    FLEEN1
F3  C                     END
D3  C           RIMPEX    IFEQ 3
     C                     ADD  FOREP     TYPFOR
     C                     ADD  ENCREP    TYPENC
F3  C                     END
D3  C           RIMPEX    IFEQ 4
     C                     ADD  FOREP     FOROF1
     C                     ADD  ENCREP    OFFEN1
F3  C                     END
D3  C           RIMPEX    IFEQ 5
     C                     ADD  FOREP     TYPFOR
     C                     ADD  ENCREP    TYPENC
F3  C                     END
     *
F2  C                     END
     C           AMTHEL    ADD  AMTFLE    AMTCYL  62
     C                     ADD  AMTFLR    AMTCYL
     C                     ADD  AMTHER    AMTCYL
     C                     Z-ADDAMTCYL    CYLAP1  62
     *
D2  C           TALO,S    IFNE 0
     C                     MULT TALO,S    HELEN1
     C                     MULT TALO,S    FLEEN1
     C                     MULT TALO,S    CYLAP1
     C           ENCRE     MULT TALO,S    ENCRE     H
     C           VERNIX    MULT TALO,S    VERNIX
F2  C                     END
     *
     C                     ADD  ENCRE     COUDIR  62
     C                     ADD  VERNIX    COUDIR
     C                     ADD  ENCRE     COUTEX  62
     C                     ADD  VERNIX    COUTEX
     C           ENCRE     MULT KMATA     ENCRE     H
     C           VERNIX    MULT KMATA     VERNIX    H
     *
     C                     Z-ADDENCRE     ENCEXT  62
     C           ENCEXT    MULT 0,01      ENCM2   64
     C           ENCM2     MULT SUVENT    ENCVTE  62H
     C                     Z-ADDVERNIX    VEREXT  62
     C           VEREXT    MULT 0,01      VERM2   64
     C           VERM2     MULT SUVENT    VERVTE  62H
     C                     Z-ADDFORCOU    FOREXT  40
     C                     Z-ADDFOREP     FOREPE  40
F1  C                     END
     C/SPACE 3
     C           STAND     TAG
     C                     Z-ADD0         VERNIX
     C                     Z-ADD0         ENCRE
     C                     Z-ADD0         ENCRE1
     C                     Z-ADD0         ENCRE2
     C                     Z-ADD0         ENCRE3
     C                     Z-ADD0         ENCRE4
    C* ----------------------------------------
    C* Impression INT 3B PRINCIPALE + REPIQUAGE
    C* ----------------------------------------
D1  C           SUPINT    IFEQ 5
    C           OTCOEP    ANDNE*ZEROS
    C           IMPINT    ANDEQ4
     C                     EXSR INT3B
    C                     GOTO FINSTA
F1  C                     END
     *
     * impression INT STANDARD
     *********************************
D1  C           SUPINT    IFNE *ZERO
     C                     Z-ADDSUPINT    S
D2  C           NIMPI1    IFEQ *BLANKS
     C                     SETOF                     98
     C           CLEPRE    CHAINMATPREL1             99
     C   99      CLEPRE    CHAINCXHENTL1             99
D3  C           *IN99     IFEQ '0'
    C           IMPFA     ANDEQ1
     C                     SETON                     98
F3  C                     END
     C/SPACE 1
     * ENCRE
     *-----------------------
D3  C           COUIN     IFNE *ZEROS
D4  C           GRPIN     IFNE *ZEROS
     C                     Z-ADDGRPIN     GRP     20
X4  C                     ELSE
     C                     Z-ADDCOUIN     GRP
F4  C                     END
     * helio
D4  C           IMPINT    IFEQ 1
     C           FORHEL    MULT GRP       FORCOU  60
     C           ENCRH     MULT ENCIN     ENCRE1  62H
F4  C                     END
     * flexo
D4  C           IMPINT    IFEQ 2
     C           FORFLE    MULT GRP       FORCOU
D5  C           UVINT     IFEQ 'E'
     C           ENCRLO    MULT ENCIN     ENCRE1    H
X5  C                     ELSE
     C           ENCRF     MULT ENCIN     ENCRE1    H
F5  C                     END
F4  C                     END
     * typo
D4  C           IMPINT    IFEQ 3
     C           FORTYP    MULT GRP       FORCOU
     C           ENCRT     MULT ENCIN     ENCRE1    H
F4  C                     END
     * offset
D4  C           IMPINT    IFEQ 4
     C           FOROFF    MULT GRP       FORCOU
D5  C           UVINT     IFNE 'U'
D6  C           UVINT     IFEQ 'F'
    C           UVINT     OREQ 'N'
     C           FILL20    MULT ENCIN     ENCRE1    H
X6  C                     ELSE
D7  C           UVINT     IFEQ 'G'
    C           UVINT     OREQ 'O'
     C           FILL21    MULT ENCIN     ENCRE1    H
X7  C                     ELSE
     C           ENCRO     MULT ENCIN     ENCRE1    H
F7  C                     END
F6  C                     END
X5  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D6  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F6  C                     END
     C           SENCUV    MULT ENCIN     ENCRE1    H
F5  C                     END
F4  C                     END
     * POST PRINT
D4  C           IMPINT    IFEQ 5
     C           FORTYP    MULT GRP       FORCOU
     C           ENCRT     MULT ENCIN     ENCRE1    H
F4  C                     END
     * majoration encre special .
D4  C           ESPIN     IFNE 0
     C           ENCRE1    MULT ESPIN     ENCRE1    H
F4  C                     END
D4  C           ENCIN     IFGE 1,0
D5  C           IMPINT    IFLT 2
     C                     ADD  AMTAPH    ENCRE1
     C                     ADD  AMTAPH    AMTHEL  52
F5  C                     END
D5  C           IMPINT    IFEQ 2
     C                     ADD  AMTAPF    ENCRE1
     C                     ADD  AMTAPF    AMTFLE  52
F5  C                     END
F4  C                     END
     * majoration encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D4  C           CFLIN     IFNE *ZEROS
     C           VERNU1    MULT CFLIN     ENCRFL    H
     C                     ADD  ENCRFL    ENCRE1
F4  C                     END
    C*
F3  C                     END
     C/SPACE 1
     * OU CUIVRE ALU
     *-----------------------
D3  C           ORIN      IFEQ ' '
     C                     Z-ADDENCRE1    ENCRE
X3  C                     ELSE
     C                     MOVELORIN      OCAL    1
     C                     MOVE ORIN      COCAL   10
     *
D4  C           COCAL     IFEQ 0
     C                     Z-ADD1,0       CORCUA  21
X4  C                     ELSE
     C                     MOVE COCAL     CORCUA
F4  C                     END
D4  C           OCAL      IFEQ 'A'
     * helio
D5  C           IMPINT    IFEQ 1
     C                     ADD  FORALH    FORCOU
     C           ALUHE     MULT CORCUA    ENCRE2  52H
F5  C                     END
     * flEXO
D5  C           IMPINT    IFEQ 2
     C                     ADD  FORALF    FORCOU
     C           ALUFL     MULT CORCUA    ENCRE2    H
F5  C                     END
     * typo
D5  C           IMPINT    IFEQ 3
     C                     ADD  FORALT    FORCOU
     C           ALUTY     MULT CORCUA    ENCRE2    H
F5  C                     END
     * offset
D5  C           IMPINT    IFEQ 4
     C                     ADD  FORALO    FORCOU
     C           ALUOF     MULT CORCUA    ENCRE2    H
F5  C                     END
     * POST PRINT
D5  C           IMPINT    IFEQ 5
     C                     ADD  FORALT    FORCOU
     C           ALUTY     MULT CORCUA    ENCRE2    H
F5  C                     END
     *
X4  C                     ELSE
D5  C           OCAL      IFEQ 'O'
     * helio
D6  C           IMPINT    IFEQ 1
     C                     ADD  FORORH    FORCOU
     C           ORHEL     MULT CORCUA    ENCRE2    H
F6  C                     END
     * flEXo
D6  C           IMPINT    IFEQ 2
     C                     ADD  FORORF    FORCOU
     C           ORFLE     MULT CORCUA    ENCRE2    H
F6  C                     END
     * typo
D6  C           IMPINT    IFEQ 3
     C                     ADD  FORORT    FORCOU
     C           ORTYP     MULT CORCUA    ENCRE2    H
F6  C                     END
     * offset
D6  C           IMPINT    IFEQ 4
     C                     ADD  FORORO    FORCOU
     C           OROFF     MULT CORCUA    ENCRE2    H
F6  C                     END
     * POST PRINT
D6  C           IMPINT    IFEQ 5
     C                     ADD  FORORT    FORCOU
     C           ORTYP     MULT CORCUA    ENCRE2    H
F6  C                     END
     *
X5  C                     ELSE
     * CUIVRE
     *-------
     C                     ADD  FORCU     FORCOU
     C           CUIVRE    MULT CORCUA    ENCRE2    H
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C           ENCRE1    ADD  ENCRE2    ENCRE   52
     C/SPACE 1
     * VERNIS
     *-----------------------
D3  C           TVEIN     IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPINT    XVERA1
     C                     MOVE TVEIN     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D4  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X4  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F4  C                     END
     C           KTBA01    CHAINXTBASE01             99
D4  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D5  C           TVEIN     IFEQ 'F'
    C           CVEIN     ANDEQ*ZEROS
     C                     Z-ADD1         CVEIN
F5  C                     END
D5  C           TVEIN     IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F5  C                     END
     *
     C                     Z-ADDXVER05    GPIN
     C                     ADD  XVER04    FORCOU
     C                     Z-ADDXVER04    FORCXX
     C           XVER03    MULT CVEIN     VERNIX    H
     *
D5  C           IMPINT    IFEQ 2
    C*                    Z-ADDGP1IN     GPIN
D6  C           GPIN      IFEQ *ZEROS
     C                     Z-ADD1         GPIN
F6  C                     END
     C                     SUB  XVER04    FORCOU
     C                     MULT GPIN      FORCXX
     C                     ADD  FORCXX    FORCOU
F5  C                     END
D5  C           TVEIN     IFEQ 'P'
    C           IMPINT    ANDNE2
     C           VERNIX    MULT 2         VERNIX
F5  C                     END
D5  C           IMPINT    IFEQ 1
D6  C           TVEIN     IFEQ 'P'
    C           TVEIN     OREQ 'T'
     C                     ADD  AMTCVH    VERNIX
     C                     ADD  AMTCVH    AMTHEL
F6  C                     END
F5  C                     END
D5  C           IMPINT    IFEQ 2
D6  C           TVEIN     IFNE ' '
    C           CVEIN     ANDGE1
     C                     ADD  AMTCVF    VERNIX
     C                     ADD  AMTCVF    AMTFLE
F6  C                     END
F5  C                     END
     * majoration vernis special .
D5  C           VSPIN     IFNE 0
     C                     MULT VSPIN     VERNIX    H
F5  C                     END
F4  C                     END
     *
F3  C                     END
     *
     C           ENCRE     ADD  VERNIX    ENCVER  62
     C                     SUB  AMTHEL    ENCVER
     C                     SUB  AMTFLE    ENCVER
     C/SPACE 1
     * FORFAITS
     *-----------------------
D3  C           IMPINT    IFEQ 1
     C                     Z-ADDFORCOU    HELFO2  60
     C                     ADD  ENCVER    HELEN2  62
F3  C                     END
D3  C           IMPINT    IFEQ 2
     C                     Z-ADDFORCOU    FLEFO2  60
     C                     ADD  ENCVER    FLEEN2  62
F3  C                     END
D3  C           IMPINT    IFEQ 3
     C                     Z-ADDFORCOU    TYPFOR  60
     C                     ADD  ENCVER    TYPENC  62
F3  C                     END
D3  C           IMPINT    IFEQ 4
     C                     Z-ADDFORCOU    FOROF2  60
     C                     ADD  ENCVER    OFFEN2  62
F3  C                     END
D3  C           IMPINT    IFEQ 5
     C                     Z-ADDFORCOU    TYPFOR  60
     C                     ADD  ENCVER    TYPENC  62
F3  C                     END
F2  C                     END
     C/SPACE 3
     * impression INT repiquage .
     *********************************
D2  C           RIMPIN    IFNE 0
     C/SPACE 1
     * ENCRE
     *-----------------------
D3  C           COUINR    IFNE 0
D4  C           GRPINR    IFNE *ZEROS
     C                     Z-ADDGRPINR    GRP     20
X4  C                     ELSE
     C                     Z-ADDCOUINR    GRP
F4  C                     END
D4  C           RIMPIN    IFEQ 1
     C           FORHEL    MULT GRP       FOREP   40
     C           ENCRH     MULT ENCINR    ENCRE3  52H
D5  C           ENCINR    IFGE 1,0
     C                     ADD  AMTCVH    ENCRE3
     C                     ADD  AMTCVH    AMTHER
F5  C                     END
F4  C                     END
D4  C           RIMPIN    IFEQ 2
     C           FORFLE    MULT GRP       FOREP
     C           ENCRF     MULT ENCINR    ENCRE3    H
F4  C                     END
D4  C           RIMPIN    IFEQ 3
     C           FORTYP    MULT GRP       FOREP
     C           ENCRT     MULT ENCINR    ENCRE3    H
F4  C                     END
D4  C           RIMPIN    IFEQ 4
     C           FOROFF    MULT GRP       FOREP
D5  C           UVINTR    IFEQ 'U'
     C           ENCRUV    MULT ENCINR    ENCRE3    H
X5  C                     ELSE
D6  C           UVINTR    IFEQ 'F'
    C           UVINTR    OREQ 'N'
     C           FILL20    MULT ENCINR    ENCRE3    H
X6  C                     ELSE
D7  C           UVINTR    IFEQ 'G'
    C           UVINTR    OREQ 'O'
     C           FILL21    MULT ENCINR    ENCRE3    H
X7  C                     ELSE
     C           ENCRO     MULT ENCINR    ENCRE3    H
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
D4  C           RIMPIN    IFEQ 5
     C           FORTYP    MULT GRP       FOREP
     C           ENCRT     MULT ENCINR    ENCRE3    H
F4  C                     END
     * majoration encre special .
D4  C           ESPINR    IFNE 0
     C           ENCRE3    MULT ESPINR    ENCRE3    H
F4  C                     END
D4  C           ENCINR    IFGE 1,0
D5  C           RIMPIN    IFLT 2
     C                     ADD  AMTAPH    ENCRE3
     C                     ADD  AMTAPH    AMTHER
F5  C                     END
D5  C           RIMPIN    IFEQ 2
     C                     ADD  AMTAPF    ENCRE3
     C                     ADD  AMTAPF    AMTFLR
F5  C                     END
F4  C                     END
     * majoration encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D4  C           FLUINR    IFNE *BLANK
     C           VERNU1    MULT CFLINR    ENCRFL    H
     C                     ADD  ENCRFL    ENCRE3
F4  C                     END
    C*
F3  C                     END
     C/SPACE 1
     * OU CUIVRE ALU
     *-----------------------
D3  C           ORINR     IFNE ' '
     C                     MOVELORINR     OCAL    1
     C                     MOVE ORINR     COCAL   10
     *
D4  C           COCAL     IFEQ 0
     C                     Z-ADD1,0       CORCUA  21
X4  C                     ELSE
     C                     MOVE COCAL     CORCUA
F4  C                     END
     * ALU
     *-------
D4  C           OCAL      IFEQ 'A'
     * helio
D5  C           RIMPIN    IFEQ 1
     C                     ADD  FORALH    FOREP
     C           ALUHE     MULT CORCUA    ENCRE4  52H
F5  C                     END
     * flexo
D5  C           RIMPIN    IFEQ 2
     C                     ADD  FORALF    FOREP
     C           ALUFL     MULT CORCUA    ENCRE4    H
F5  C                     END
     * typo
D5  C           RIMPIN    IFEQ 3
     C                     ADD  FORALT    FOREP
     C           ALUTY     MULT CORCUA    ENCRE4    H
F5  C                     END
     * offset
D5  C           RIMPIN    IFEQ 4
     C                     ADD  FORALO    FOREP
     C           ALUOF     MULT CORCUA    ENCRE4    H
F5  C                     END
     * POST PRINT
D5  C           RIMPIN    IFEQ 5
     C                     ADD  FORALT    FOREP
     C           ALUTY     MULT CORCUA    ENCRE4    H
F5  C                     END
     *
X4  C                     ELSE
     * OR
     *-------
D5  C           OCAL      IFEQ 'O'
     * helio
D6  C           RIMPIN    IFEQ 1
     C                     ADD  FORORH    FOREP
     C           ORHEL     MULT CORCUA    ENCRE4    H
F6  C                     END
     * flexo
D6  C           RIMPIN    IFEQ 2
     C                     ADD  FORORF    FOREP
     C           ORFLE     MULT CORCUA    ENCRE4    H
F6  C                     END
     * typo
D6  C           RIMPIN    IFEQ 3
     C                     ADD  FORORT    FOREP
     C           ORTYP     MULT CORCUA    ENCRE4    H
F6  C                     END
     * offset
D6  C           RIMPIN    IFEQ 4
     C                     ADD  FORORO    FOREP
     C           OROFF     MULT CORCUA    ENCRE4    H
F6  C                     END
     * POST PRINT
D6  C           RIMPIN    IFEQ 5
     C                     ADD  FORORT    FOREP
     C           ORTYP     MULT CORCUA    ENCRE4    H
F6  C                     END
     *
X5  C                     ELSE
     * CUIVRE
     *-------
     C                     ADD  FORCU     FOREP
     C           CUIVRE    MULT CORCUA    ENCRE4    H
F5  C                     END
F4  C                     END
F3  C                     END
     *
     C                     ADD  ENCRE3    ENCRE
     C                     ADD  ENCRE4    ENCRE
     C/SPACE 1
     * VERNIS
     *-----------------------
D3  C           TVEINR    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE TVEINR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D4  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X4  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F4  C                     END
     C           KTBA01    CHAINXTBASE01             99
D4  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D5  C           TVEINR    IFEQ 'F'
    C           CVEINR    ANDEQ*ZEROS
     C                     Z-ADD1         CVEINR
F5  C                     END
D5  C           TVEINR    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F5  C                     END
     *
     C                     Z-ADDXVER05    GPINR
     C                     ADD  XVER04    FOREP
     C                     Z-ADDXVER04    FORCXX
     C           XVER03    MULT CVEINR    VERREP  52H
     *
D5  C           RIMPIN    IFEQ 2
    C*                    Z-ADDGP1INR    GPINR
D6  C           GPINR     IFEQ *ZEROS
     C                     Z-ADD1         GPINR
F6  C                     END
     C                     SUB  XVER04    FOREP
     C                     MULT GPINR     FORCXX
     C                     ADD  FORCXX    FOREP
F5  C                     END
D5  C           TVEINR    IFEQ 'P'
    C           RIMPIN    ANDNE2
     C           VERREP    MULT 2         VERREP
F5  C                     END
D5  C           RIMPIN    IFEQ 1
D6  C           TVEINR    IFEQ 'P'
    C           TVEINR    OREQ 'T'
     C                     ADD  AMTCVH    VERREP
     C                     ADD  AMTCVH    AMTHER
F6  C                     END
F5  C                     END
D5  C           RIMPIN    IFEQ 2
D6  C           TVEINR    IFNE ' '
    C           CVEINR    ANDGE1
     C                     ADD  AMTCVF    VERREP
     C                     ADD  AMTCVF    AMTFLR
F6  C                     END
F5  C                     END
     * majoration vernis special .
D5  C           VSPINR    IFNE 0
     C                     MULT VSPINR    VERREP    H
F5  C                     END
     *
F4  C                     END
F3  C                     END
     *
     C                     ADD  VERREP    VERNIX
     C           ENCRE3    ADD  VERREP    ENCREP  62
     C                     ADD  ENCRE4    ENCREP
     C                     SUB  AMTHER    ENCREP
     C                     SUB  AMTFLR    ENCREP
     *
D3  C           RIMPIN    IFEQ 1
     C                     ADD  FOREP     HELFO2
     C                     ADD  ENCREP    HELEN2
F3  C                     END
D3  C           RIMPIN    IFEQ 2
     C                     ADD  FOREP     FLEFO2
     C                     ADD  ENCREP    FLEEN2
F3  C                     END
D3  C           RIMPIN    IFEQ 3
     C                     ADD  FOREP     TYPFOR
     C                     ADD  ENCREP    TYPENC
F3  C                     END
D3  C           RIMPIN    IFEQ 4
     C                     ADD  FOREP     FOROF2
     C                     ADD  ENCREP    OFFEN2
F3  C                     END
D3  C           RIMPIN    IFEQ 5
     C                     ADD  FOREP     TYPFOR
     C                     ADD  ENCREP    TYPENC
F3  C                     END
     *
F2  C                     END
     *
     C           AMTHEL    ADD  AMTFLE    AMTCYL  62
     C                     ADD  AMTFLR    AMTCYL
     C                     ADD  AMTHER    AMTCYL
     C                     Z-ADDAMTCYL    CYLAP2  62
     *
D2  C           TALO,S    IFNE 0
     C                     MULT TALO,S    HELEN2
     C                     MULT TALO,S    FLEEN2
     C                     MULT TALO,S    CYLAP2
     C           ENCRE     MULT TALO,S    ENCRE     H
     C           VERNIX    MULT TALO,S    VERNIX
F2  C                     END
     *
     C                     ADD  ENCRE     COUDIR  62
     C                     ADD  VERNIX    COUDIR
     C                     ADD  ENCRE     COUTIN  62
     C                     ADD  VERNIX    COUTIN
     C           ENCRE     MULT KMATA     ENCRE     H
     C           VERNIX    MULT KMATA     VERNIX    H
     *
     C                     Z-ADDENCRE     ENCINT  62
     C           ENCINT    MULT 0,01      ENCM2   64
     C           ENCM2     MULT SUVENT    ENCVTI  62H
     C                     Z-ADDVERNIX    VERINT  62
     C           VERINT    MULT 0,01      VERM2   64
     C           VERM2     MULT SUVENT    VERVTI  62H
     C                     Z-ADDFORCOU    FORINT  40
     C                     Z-ADDFOREP     FOREPI  40
F1  C                     END
     *---------------------
     C           FINSTA    TAG
     C                     ADD  ENCEXT    VALMAT  62
     C                     ADD  ENCINT    VALMAT
     C                     ADD  VEREXT    VALMAT
     C                     ADD  VERINT    VALMAT
     C                     ADD  ENCVTE    VTEMAT  62
     C                     ADD  ENCVTI    VTEMAT
     C                     ADD  VERVTE    VTEMAT
     C                     ADD  VERVTI    VTEMAT
     *
     C                     ADD  COLLE     VALMAT
     C                     ADD  COLVT     VTEMAT
     ***  fin du module -D-
    C           DULDFI    ENDSR
     *
     C/SPACE 3
    C           MODUDD    BEGSR
     *
     C           PAPEXT    ADD  ENCEXT    VALEXT
     C                     ADD  VEREXT    VALEXT
     C           VTPEXT    ADD  ENCVTE    VTEEXT
     C                     ADD  VERVTE    VTEEXT
     C           PAPINX    ADD  ENCINT    VALINT
     C                     ADD  VERINT    VALINT
     C           VTPINT    ADD  ENCVTI    VTEINT
     C                     ADD  VERVTI    VTEINT
     *
    C                     ENDSR
     C/EJECT
     *******************************************
     * calcul des surfaces a l'unite de vente .***********************
     *******************************************  --module--E--
     *
     * SBFEU   7/0 : surface brut d'une feuille en mm2 .
     * SBDEC   7/0 :    "      "    "   decoupe  "  "  .
     * SBACOT  7/0 :    "      "  de la feuille a cote en mm2 .
     * SUVENT 10/6 :    "    a l'unite de vente en mm2 .
     * LALAIZ  4/0 : laize mini en mm. .
     *
    C           MODULE    BEGSR
     *
     C                     Z-ADD0         GRATAL
     C                     Z-ADD0         SBZ
     C                     Z-ADD0         NBR     20
     C                     Z-ADD0         TOTDE   52
     C                     Z-ADD0         RESTE   80
     C                     Z-ADD0         SBFEU   70
     C                     Z-ADD0         SBDEC   70
     C                     Z-ADD0         SFEBRU  70
     C                     Z-ADD0         SBACOT  70
     C                     Z-ADD0         SURFA  100
     C                     Z-ADD0         SUVENT 106
     C                     Z-ADD0         COEFF   54
     C                     Z-ADD0         SNDEC   70
     C                     Z-ADD0         NETSU  106
     C                     Z-ADD0         LAIZSM
     * SI SOUS TRAITANCE INTÉGRALE
    C* ----------------------------------
D1  C           TYPDEV    IFEQ 4
     C                     MOVELOBSI6     SUVENT
D2  C           SUVENT    IFEQ *ZEROS
     C                     Z-ADD1         SUVENT
F2  C                     END
     C                     Z-ADDSUVENT    SBFE
    C                     GOTO DULEFI
F1  C                     END
     ** <--PAGE-E1-->
     *                           LAIZE MINI DE CM.--> MM. .
D1  C           FLPEAP    IFNE *ZEROS                     PELLICULEUSE
    C           NONSFM    ANDEQ' '                        PAS DANS DEVCAL
D2  C           IAEI2     IFEQ 'O'
     C                     Z-ADDFHPEAP    LALAIZ
     C           FHPEAP    DIV  10        LAIZSM
     C                     Z-ADDDECL      SVDECL  40
     C                     Z-ADDDECH      DECL
     C                     Z-ADDSVDECL    DECH
X2  C                     ELSE
     C                     Z-ADDFLPEAP    LALAIZ
     C           FLPEAP    DIV  10        LAIZSM
F2  C                     END
X1  C                     ELSE
D2  C           LUTIL     IFNE *ZEROS
     C           LUTIL     MULT 10        LALAIZ  40
     C                     Z-ADDLUTIL     LAIZSM
X2  C                     ELSE
     C           LMINI     MULT 10        LALAIZ
     C                     Z-ADDLMINI     LAIZSM
F2  C                     END
F1  C                     END
    C* RECHERCHE SI PAPIER COMPLEXE
     C                     Z-ADD0         Y
     C                     Z-ADD0         XCE     10
     C                     Z-ADD0         XCI     10
     C                     Z-ADD0         GRCXHE  30
     C                     Z-ADD0         GRCXHI  30
     C                     MOVEA'000000'  *IN,72
     C                     MOVE *BLANKS   PELI    3
     C                     MOVE *BLANKS   PELE    3
D1  C                     DO   7         Y
     C                     MOVE ADPA,Y    CXH     3
D2  C           CXH       IFEQ 'CXH'
D3  C           Y         IFLE 3
     C                     SETON                     77
     C                     Z-ADDY         XCE
     C                     MOVELADPA,Y    PELE
X3  C                     ELSE
     C                     SETON                     76
     C                     Z-ADDY         XCI
     C                     MOVELADPA,Y    PELI
F3  C                     END
F2  C                     END
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
D3  C           Y         IFLE 3
     C                     Z-ADDGRAM,Y    GRCXHE
X3  C                     ELSE
     C                     Z-ADDGRAM,Y    GRCXHI
F3  C                     END
F2  C                     END
F1  C                     END
    C* SI COMPLEXE
D1  C           *IN76     IFEQ '1'
    C           LMINI     ANDEQ0
    C           *IN77     OREQ '1'
    C           LMINI     ANDEQ0
     *                              SANS ONDULATION   NI CONTRECOLLAGE
D2  C           FACON     IFGE 6                          FACON: 6 7 8
    C           FACON     ANDLE8
D3  C           FORL      IFEQ *ZEROS
     C           ONDL      MULT NBPECX    LARCX   40
X3  C                     ELSE
     C           FORL      MULT NBPECX    LARCX
F3  C                     END
     C                     ADD  10        LARCX
     C                     MOVE LARCX     Z1      10
D3  C           Z1        IFNE *ZEROS
    C           Z1        ANDNE5
D4  C           Z1        IFLT 5
     C                     MOVE '5'       LARCX
X4  C                     ELSE
     C                     MOVE '0'       LARCX
     C                     ADD  10        LARCX
F4  C                     END
F3  C                     END
     C                     DIV  NBPECX    LARCX
D3  C           FORH      IFEQ *ZEROS
     C           ONDH      MULT LARCX     SBFEU
X3  C                     ELSE
     C           FORH      MULT LARCX     SBFEU
F3  C                     END
     C           SBFEU     DIV  POSF1     SBDEC
     C                     MOVE LARCX     LAIZSM
    C                     GOTO DULEC
F2  C                     END
    C*
D2  C           FACON     IFEQ 4                          FACON: 4
     C           DECL      MULT NBPECX    LARCX
     C                     ADD  10        LARCX
     C                     MOVE LARCX     Z1      10
D3  C           Z1        IFNE *ZEROS
    C           Z1        ANDNE5
D4  C           Z1        IFLT 5
     C                     MOVE '5'       LARCX
X4  C                     ELSE
     C                     MOVE '0'       LARCX
     C                     ADD  10        LARCX
F4  C                     END
F3  C                     END
     C           DECH      MULT LARCX     SFEBRU
     C           SFEBRU    DIV  NBPECX    SBDEC
     C                     MOVE LARCX     LAIZSM
D3  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
    C                     GOTO DULEC
X3  C                     ELSE
     C           DECL      MULT DECH      SNDEC
     C           SBDEC     DIV  SNDEC     COEFF     H
     C           COEFF     MULT 100       SUVENT
    C                     GOTO DULEFI
F3  C                     END
F2  C                     END
    C*
D2  C           FACON     IFEQ 1                          FACON: 1 2
    C           FACON     OREQ 2
     C           DECL      MULT NBPECX    LARCX
     C                     ADD  10        LARCX
     C                     MOVE LARCX     Z1      10
D3  C           Z1        IFNE *ZEROS
    C           Z1        ANDNE5
D4  C           Z1        IFLT 5
     C                     MOVE '5'       LARCX
X4  C                     ELSE
     C                     MOVE '0'       LARCX
     C                     ADD  10        LARCX
F4  C                     END
F3  C                     END
     C                     MOVE LARCX     LAIZSM
D3  C           UVENT     IFEQ 3
     C           LARCX     DIV  1000      LARCXN  43
     C           LARCXN    DIV  NBPECX    SUVENT
X3  C                     ELSE
     C           DECL      MULT NBPECX    LARNET  40
     C           LARCX     DIV  LARNET    COEFF     H
D4  C           UVENT     IFEQ 2
     C           COEFF     MULT 100       SUVENT
X4  C                     ELSE
     C                     Z-ADDGRAM,3    GRATAL
     C           100000    DIV  GRATAL    NETSU     H
     C           COEFF     MULT NETSU     SUVENT
F4  C                     END
F3  C                     END
    C                     GOTO DULEFI
F2  C                     END
     *
F1  C                     END
     * -----------------------   dec.de forme assemblage automatique.
    C           FACON     CABEQ8         DULEA
     * -----------------------   dec.de forme assemblage manuel.
    C           FACON     CABEQ7         DULEA
     * -----------------------   dec.reguliere + dec.annexe.
    C           FACON     CABEQ5         DULEA
     * -----------------------   dec.de forme sans assemblage.
D1  C           FACON     IFEQ 6
    C*                           unite de vente au 1000.
    C           UVENT     CABEQ1         DULEA
    C           UVENT     CABEQ5         DULEA
    C*                           unite de vente au 100 M2.
    C                     GOTO DULED
F1  C                     END
     * -----------------------   decoupe reguliere.
D1  C           FACON     IFEQ 4
    C*                           unite de vente au 1000.
    C           UVENT     CABEQ1         DULEA
    C           UVENT     CABEQ5         DULEA
    C*                           unite de vente au 100 M2.
    C           UVENT     CABEQ4         DULEG
    C*                           unite de vente au 100 KG.
    C                     GOTO DULED
F1  C                     END
     * -----------------------   rouleaux
D1  C           FACON     IFEQ 1
    C*                           unite de vente au 100 M2.
    C           UVENT     CABEQ2         DULEE
    C*                           unite de vente au 100 KG.
    C           UVENT     CABEQ4         DULEG
    C*                           unite de vente au 100 ML.
    C                     GOTO DULEF
F1  C                     END
     ** <--PAGE-E2-->
D1  C           FACON     IFEQ 2
    C           UVENT     CABEQ4         DULEG            100 KG.
    C           UVENT     CABEQ2         DULEE            100 M2.
    C                     GOTO DULEF                      100 ML.
F1  C                     END
    C           FACON     CABEQ9         DULEA
D1  C           FACON     IFEQ 0
    C           UVENT     CABEQ1         DULEH            1000.
    C           UVENT     CABEQ5         DULEH            1
    C           UVENT     CABEQ2         DULEH            100 M2.
    C           UVENT     CABEQ3         DULEF            100 ML.
    C           UVENT     CABEQ4         DULEG            100 KG.
    C                     GOTO DULEFI
F1  C                     END
    C                     GOTO DULEFI
     ** <--PAGE-E3-->
     ** calcul surface au 1000 - decoupes regulieres - decoupes sur
     ** formes - decoupes regulieres + decoupage annexes .
     C           DULEA     TAG
     *
D1  C           LALAIZ    IFEQ 0
D2  C           FORL      IFNE 0
     C           FORL      MULT FORH      SBFEU   70
X2  C                     ELSE
     C           ONDL      MULT ONDH      SBFEU
F2  C                     END
     C           SBFEU     DIV  POSF1     SBDEC   70H
    C                     GOTO DULEC
F1  C                     END
     *
     C           LALAIZ    SUB  ACOTE     RESTE
D1  C           FACON     IFEQ 4
D2  C           FORL      IFNE 0
     C           FORL      MULT FORH      SBFEU
X2  C                     ELSE
D3  C           ONDL      IFNE 0
     C           ONDL      MULT ONDH      SBFEU
X3  C                     ELSE
     C           DECL      MULT DECH      SBFEU
F3  C                     END
F2  C                     END
    C                     GOTO DULE3
F1  C                     END
    C           FACON     CABEQ9         DULE3
     *
D1  C           FACON     IFEQ 5
     C                     Z-ADDPOSF1     TOTDE
     C           RESTE     DIV  ONDL      NBR
     C           LALAIZ    MULT ONDH      SFEBRU
     C           TOTDE     MULT NBR       TOTDE
     C                     ADD  POSF2     TOTDE
     C           SFEBRU    DIV  TOTDE     SBDEC     H
    C                     GOTO DULEC
F1  C                     END
     *
     C           RESTE     DIV  ONDL      NBR     20
D1  C           NBR       IFEQ 0
     C                     Z-ADD1         NBR
F1  C                     END
     C           POSF1     MULT NBR       TOTDE   52
     C                     ADD  POSF2     TOTDE
     C           LALAIZ    MULT ONDH      SFEBRU  70
    C                     GOTO DULEB
     *
     C           DULE3     TAG
     C           RESTE     DIV  DECL      NBR
D1  C           NBR       IFEQ 0
     C                     Z-ADD1         NBR
F1  C                     END
     C           LALAIZ    MULT DECH      SFEBRU
     C           SFEBRU    DIV  NBR       SBDEC   70H
    C                     GOTO DULEC
     ** <--PAGE-E4-->
     C           DULEB     TAG
     *
     C           SFEBRU    DIV  TOTDE     SBDEC     H
     C           SBDEC     MULT POSF1     SBFEU   70H
     C           SBDEC     MULT POSF2     SBACOT  70H
     C           DULEC     TAG
D1  C           UVENT     IFEQ 5
     C           SBDEC     MULT 1         SURFA  100
X1  C                     ELSE
     C           SBDEC     MULT 1000      SURFA  100
F1  C                     END
     C                     MOVE SURFA     SUVENT 106
     C                     MOVELSBFEU     SBFE    76
     C                     MOVELSBDEC     SBZ
    C                     GOTO DULEFI
     ** <--PAGE-E5-->
     ** calcul de la surface au 100 m2 -pour : le decoupe regulieres,
     **                            les decoupes sur formes non assemb.
     C           DULED     TAG
     *
D1  C           FACON     IFEQ 6
     C           LALAIZ    DIV  ONDL      NBR
     C           LALAIZ    MULT ONDH      SFEBRU
     C           SFEBRU    DIV  NBR       SBFEU   70H
     C           ONDL      MULT ONDH      SNFEU   70
     C           SBFEU     DIV  SNFEU     COEFF   54H
     C           SBFEU     DIV  POSF1     SBDEC     H
X1  C                     ELSE
     C           LALAIZ    DIV  DECL      NBR
     C           LALAIZ    MULT DECH      SFEBRU
     C           SFEBRU    DIV  NBR       SBDEC     H
     C           DECL      MULT DECH      SNDEC   70
     C           SBDEC     DIV  SNDEC     COEFF     H
F1  C                     END
     C           100,000000MULT COEFF     SUVENT    H
     C                     MOVELSBFEU     SBFE    76
     C                     MOVELSBDEC     SBZ
    C                     GOTO DULEFI
     ** <--PAGE-E6-->
     ** rouleaux au 10 m2 .
     C           DULEE     TAG
     *
     C           LMINI     MULT 10        LMMMM
     C           LMMMM     DIV  DECL      NBR
    C*          LALAIZ    DIV  DECL      NBR
     C           DECL      MULT NBR       SNDEC
     C           LALAIZ    DIV  SNDEC     COEFF     H
     C           100,000000MULT COEFF     SUVENT    H
    C                     GOTO DULEFI
     ** <--PAGE-E7-->
     ** rouleaux au 10 ML . avec ou sans ondulation .
     C           DULEF     TAG
     *
D1  C           LAIZSM    IFNE *ZEROS
     C                     Z-ADDLAIZSM    NET     63
D2  C           DECL      IFEQ 0
     C                     Z-ADDNET       SUVENT
    C                     GOTO DULEFI
F2  C                     END
     C           LMINI     MULT 10        LMMMM
     C           LMMMM     DIV  DECL      NBR
    C*          LALAIZ    DIV  DECL      NBR
     C           NET       DIV  NBR       SUVENT    H
X1  C                     ELSE
     C           DECL      DIV  10        SUVENT
F1  C                     END
    C                     GOTO DULEFI
     ** <--PAGE-E8-->
     ** rouleaux au 10 KG . avec ou sans ondulation .
     C           DULEG     TAG                             ************
D1  C           XE        IFNE 3
     C                     Z-ADDGRAM,3    GRATAL  40
X1  C                     ELSE
     C                     MOVE NIMPE1    NOI1
     C                     MOVE NIMPE2    NOI2
     C           CPREIM    CHAINPREIMP2              80
     C  N80                Z-ADDGRAMS     GRATAL
F1  C                     END
    C*
D1  C           ONDUL     IFEQ *ZEROS
D2  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     ADD  DEPCOL    GRATAL
F2  C                     END
D2  C           CCOL      IFNE 7
    C                     GOTO DULEG1
F2  C                     END
F1  C                     END
    C*
     C                     SETOF                     79
D1  C           XI        IFNE 4
     C                     MOVE PAPI,4    PAPIK
     C                     Z-ADDGRAM,4    GRAMK
     C                     MOVE ADPA,4    ADPAK
     C                     Z-ADDADGR,4    ADGRK
     C           CLEPRK    CHAINMATPREL1             80
X1  C                     ELSE
     C                     MOVE NIMPI1    NOI1
     C                     MOVE NIMPI2    NOI2
     C           CPREIM    CHAINPREIMP2              80
     C                     SETON                     79
     C                     MOVE PAPIS     PAPIK
     C                     Z-ADDGRAMS     GRAMK
     C                     MOVE ADPAPS    ADPAK
     C                     Z-ADDADGRAS    ADGRK
     C           CLEPRK    CHAINMATPREL1             80          *
D2  C           *IN80     IFEQ '1'                              *
     C                     MOVELPAPIS     Z8A     8              *
     C                     MOVE GRAMS     Z8A                    *
     C                     Z-ADD1         A                      *
     C           *ZEROS    LOKUPERR1,A                   80      *
     C                     Z-ADD11        ERR1,A                 *
     C                     MOVE Z8A       ERR2,A                 *
    C                     GOTO DULEFI                           *
F2  C                     END                                   *
F1  C                     END
    C*
     C                     Z-ADD1         PLUS    32
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE ONDUL     PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D1  C  N80      PXMONT    IFNE 0
     C                     Z-ADDPXMONT    PLUS
F1  C                     END
D1  C           ONDUL     IFEQ 1
    C           PASMC     ANDNE0
     C                     Z-ADDPASMC     PLUS
F1  C                     END
D1  C           ONDUL     IFEQ 2
    C           PASPC     ANDNE0
     C                     Z-ADDPASPC     PLUS
F1  C                     END
D1  C           ONDUL     IFEQ 3
    C           PASGC     ANDNE0
     C                     Z-ADDPASGC     PLUS
F1  C                     END
    C*
     C  N79      GRAM,4    MULT PLUS      CAN     40H
     C   79      GRAMS     MULT PLUS      CAN       H
     C                     ADD  CAN       GRATAL
     *
     C           DULEG1    TAG
     C           100000    DIV  GRATAL    NETSU  106H
D1  C           DECL      IFNE *ZEROS
     C           LMINI     MULT 10        LMMMM   40
     C           LMMMM     DIV  DECL      NBR
     C           DECL      MULT NBR       SNDEC
     C           LALAIZ    DIV  SNDEC     COEFF     H
X1  C                     ELSE
     C                     Z-ADD1         COEFF
F1  C                     END
     C           NETSU     MULT COEFF     SUVENT    H
    C                     GOTO DULEFI
     ** <--PAGE-E9-->
     ** feuilles sans faconnage mais avec massicottage possible
     ** vendues au 1000 ou au 10m2 .
     C           DULEH     TAG
     *
     C           FORL      MULT FORH      SBFEU
D1  C           SBFEU     IFEQ 0
     C           LALAIZ    MULT DECH      SBFEU
F1  C                     END
     C           DECL      MULT DECH      SNDEC
D1  C           SNDEC     IFEQ 0
     C                     Z-ADDSBFEU     SBDEC
     C                     Z-ADD1,0000    COEFF
X1  C                     ELSE
D2  C           SNDEC     IFNE *ZEROS
     C           SBFEU     DIV  SNDEC     NBR
X2  C                     ELSE
     C                     Z-ADD1         NBR
F2  C                     END
     C           SNDEC     MULT NBR       SNFEU
D2  C           SNFEU     IFNE *ZEROS
     C           SBFEU     DIV  SNFEU     COEFF     H
X2  C                     ELSE
     C                     Z-ADD1         COEFF
F2  C                     END
D2  C           NBR       IFNE *ZEROS
     C           SBFEU     DIV  NBR       SBDEC     H
X2  C                     ELSE
     C                     Z-ADDSBFEU     SBDEC
F2  C                     END
F1  C                     END
     ** <--PAGE-E10-->
    C           UVENT     CABEQ1         DULEC
    C           UVENT     CABEQ5         DULEC
     C           100,000000MULT COEFF     SUVENT
     C                     MOVELSBFEU     SBFE    76
     C                     MOVELSBDEC     SBZ
     ***  fin du module -E-
    C           DULEFI    ENDSR
     C/EJECT
     **********************************************
     * calcul : des tranches de fabrication .     *
     *        :  "     "     d'impression .       *
     *        :  "  surfaces nettes fabrication . *
     *        :                     impression .  *
     *        :                     livraison .   *
     **********************************************
    C           MODULF    BEGSR
     C                     Z-ADD0         RESTE
     C                     Z-ADD0         QTFA    72
     C                     Z-ADD0         SUFAB   90
     C                     Z-ADD0         QTLIV   70
     C                     Z-ADD0         QTF     72
     C                     Z-ADD0         SULIV   90
     C                     Z-ADD0         NB1TR   42
     C                     Z-ADD0         SUIMP1  90
     C                     Z-ADD0         SUIMPR  90
     C                     Z-ADD0         QT      82
     * nbr.de tranche de fabrication ................. : NBFAB  2/0
     * nbr.de tranche de renouvellement impression ... : NBREN  2/0
     * surface nette par fabrication ................. : SUFAB  9/0
     * surface nette d'une livraison ................. : SULIV  9/0
     * surface nette de la premiere tranche impression : SUIMP1 9/0
     * surface nette des tranches de renouvellement .. : SUIMPR 9/0
     * quantite par livraison ........................ : QTLIV  7/0
     * quantite par livraison (en unite de vente)..... : QTF    7/2
     * quantite par fabrication (en unite de vente)... : QTFA   7/2
     * quantite totale (en unite de vente)............ : QT     8/2
D1  C           UVENT     IFEQ 1
     C           QTFAB     MULT 0,001     QTFA    72H
X1  C                     ELSE
D2  C           UVENT     IFEQ 5
     C           QTFAB     MULT 1         QTFA    72
X2  C                     ELSE
     C           QTFAB     MULT 0,01      QTFA
F2  C                     END
F1  C                     END
     C           SUVENT    MULT QTFA      SUFAB   90H
     * <---PAGE-F2--->
D1  C           NBLIV     IFEQ 0
     C                     MOVE QTFAB     QTLIV   70
X1  C                     ELSE
     C           QTTOT     DIV  NBLIV     QTLIV     H
F1  C                     END
D1  C           UVENT     IFEQ 1
     C           QTLIV     MULT 0,001     QTF     72H
X1  C                     ELSE
D2  C           UVENT     IFEQ 5
     C           QTLIV     MULT 1         QTF
X2  C                     ELSE
     C           QTLIV     MULT 0,01      QTF
F2  C                     END
F1  C                     END
     C           SUVENT    MULT QTF       SULIV   90H
    C           QTPRE     CABEQ0         DULFC
     C           QTPRE     DIV  QTFAB     NB1TR   42H
    C                     GOTO DULFB
     * <---PAGE-F3--->
     C           DULFB     TAG
     C           SUFAB     MULT NB1TR     SUIMP1  90H
     C           DULFC     TAG
D1  C           QTREN     IFNE 0
     C           QTREN     DIV  QTFAB     NB1TR     H
     C           SUFAB     MULT NB1TR     SUIMPR  90H
F1  C                     END
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'                       PROVISOIRE
    C           DSGP      OREQ 'CX'
     C                     Z-ADDNCONF     SNCONF  50
F1  C                     END
D1  C           DSGP      IFEQ 'PR'
     C                     Z-ADD1         SNCONF
     C                     Z-ADD1         NCONF
F1  C                     END
     C  NU2                Z-ADDETUDE     NCONF   50
     C  NU2                Z-ADDSEQDE     NOPRO   40
    C*
     C           QTFA      MULT NBFAB     QT
     * fin du module F *
    C                     ENDSR
     C/EJECT
     **************
     * transport ****************************************************
     **************             - module -G- -
    C           MODULG    BEGSR
     *
     C                     Z-ADD0         PRIPOR  82
     C                     MOVE *BLANK    ERR112
    C           STOCKE    CABNE*BLANKS   EJPORT           PRE-IMP STOCKE
    C           DSGP      CABEQ'A4'      EJPORT           REAC.PRE-IMP
    C           TYPOR     CABEQ3         EJPORT           depart
    C           TYPOR     CABEQ4         EJPORT           enlevement clt.
     *
     C                     Z-ADDFACON     FAC112
     C                     Z-ADDONDUL     OND112
     C                     Z-ADDCCOL      CCO112
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         CCO112
     C                     Z-ADD0         OND112
F1  C                     END
     C                     MOVE CVEI3     DDH112
     C                     Z-ADDCOAS1     COA112
     C                     Z-ADDHPAL30    HPA112
     C                     Z-ADD0         PORTLI
     C                     Z-ADD0         PORTUV
     C                     Z-ADDSUVENT    SURFUV
D1  C           AFFI      IFNE *BLANK
    C           CCOL      ANDEQ0
    C           ONDUL     ANDEQ0
     C                     Z-ADD5         CCO112
F1  C                     END
D1  C           LMINI     IFNE *ZEROS
    C           LUTIL     ANDNE*ZEROS
     C           LMINI     DIV  LUTIL     RAPL    43H
     C                     MULT RAPL      SURFUV    H
F1  C                     END
     * APPEL PGM DEV112£
     C                     CALL 'DEV112£'
     C                     PARM           DEV112
    C*
D1  C           ERR112    IFNE '0'
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVE ERR112    ERR1,A
     C                     MOVEL'PORT. '  ERR2,A
    C                     GOTO EJPORT
F1  C                     END
    C*
     *
D1  C           NBLIV     IFNE 0
     C           PORTLI    MULT NBLIV     PRIPOR
X1  C                     ELSE
     C           PORTLI    MULT NBFAB     PRIPOR
F1  C                     END
     * fin du module -G- .
    C           EJPORT    ENDSR
     C/EJECT
     ***********************************
     ** valorisation de l'emballage . *******************************
     ***********************************        MODULE  H
    C           MODULH    BEGSR
     C                     MOVE DSGP      DSBL
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D1  C           DSGPS     IFEQ 'CI'
     C                     MOVE DSGPS     DSBL
F1  C                     END
     C                     Z-ADD0         TOTEMB
     C                     Z-ADD0         EMBDIV
     C                     Z-ADD0         CAISSE
     C                     Z-ADD0         PALET
     C                     Z-ADD0         BANROL
     C                     Z-ADD0         CERCLA
     C                     Z-ADD0         HOUSSE
     C                     Z-ADD0         EMBFOR
     C                     Z-ADD0         KEMB
     C                     Z-ADD0         EMBUNS
     C                     MOVE *BLANKS   LIBEM1
     C                     MOVE *BLANKS   LIBEM2
     C                     MOVE *BLANKS   LIBEM3
     C                     MOVE *BLANKS   LIBEM4
     C                     MOVE *BLANK    ERRE
     C                     MOVE *BLANK    EMBZ1
     C                     MOVE *BLANK    EMBZ2
     C                     MOVE *BLANK    EMBZ3
     * SI SOUS TRAITANCE INTÉGRALE
    C* ----------------------------------
    C*          TYPDEV    CABEQ4         FINEMB
    C*
D1  C           FACON     IFEQ 1
    C           DECH      ANDLE75
    C           DECH      ANDGT0
     C                     MOVE '*'       RLXPLV
X1  C                     ELSE
     C                     MOVE *BLANKS   RLXPLV
F1  C                     END
     C                     MOVE CVEI3     SIDD
     * APPEL PGM DEV030£
     C                     Z-ADDCCOL      CCO030
     C                     Z-ADDONDUL     OND030
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         CCO030
     C                     Z-ADD0         OND030
F1  C                     END
D1  C           AFFI      IFNE *BLANK
    C           CCOL      ANDEQ0
    C           ONDUL     ANDEQ0
     C                     Z-ADD5         CCO030
F1  C                     END
    C* Pour Oeillet : 30% de découpe en moins par caisse
D1  C           EYECOD    IFNE *BLANK
     C                     MOVEL'O'       LIBEM1
F1  C                     END
     C                     CALL 'DEV030L'
     C                     PARM           DEV030
    C*
D1  C           ERRE      IFNE *BLANK
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVE 10        ERR1,A
     C                     MOVEL'EMBAL.'  ERR2,A
    C                     GOTO FINEMB
F1  C                     END
    C*
D1  C           IMPEXT    IFEQ 3
    C           IMPINT    OREQ 3
     C                     MULT 0,95      TOTEMB
F1  C                     END
     C                     Z-ADDTOTEMB    EMBDIR  72
     C           TOTEMB    MULT KMATA     EMBCEN  62H
     C           EMBCEN    MULT 0,01      EMBM2   64
     C           SUVENT    DIV  LRAPS     SURFNT 106
     C           EMBM2     MULT SURFNT    EMBUNT  62H
     C           EMBM2     MULT SUVENT    EMBUNS  62H
     * FIN DU MODULE H .
    C           FINEMB    ENDSR
     C/EJECT
     *******************************
     * faconnage plus valorisation **********************************
     *******************************   module -I-
     C/SPACE 1
     * recherche du circuit de fabrication .
    C           MODULI    BEGSR
     C/SPACE 1
D1  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
D2  C           SECTS     IFEQ '1'
    C           ZZSS      CABNE'16'      MODULJ           PAS DORURE
F2  C                     END
F1  C                     END
     C/SPACE 1
     C                     SETOF                     88
     C                     MOVE '0'       IN85    1
     C                     MOVE *ZEROS    RAPFAC
     C                     MOVE *ZEROS    ROULCO
     C                     MOVE *ZEROS    SUPDEC  42
     C                     MOVE *ZEROS    RAPDEC  54
     C                     MOVE *ZEROS    USFAB   10
     C                     MOVE *BLANKS   SECT
     C                     MOVE *BLANKS   SSECT   1
     C                     MOVE *ZEROS    ROUDEC  54
     C                     MOVE *ZEROS    QTENET  70
     C                     MOVE *ZEROS    DIFF    32
     C                     MOVE *ZEROS    DROUA2  44
     C                     MOVE *ZEROS    DECRO   44
     C                     MOVE *ZEROS    SREG   100
     C                     MOVE *ZEROS    REGM2   40
     C                     MOVE *ZEROS    SUREG   50
     C                     MOVE *ZEROS    DECROU  44
     C                     MOVE *ZEROS    DECROX  44
     C                     MOVE *ZEROS    SUREGX  50
     C                     MOVE *ZEROS    REGL    63
     C                     MOVE *ZEROS    DROUA1  44
     C                     MOVE *ZEROS    DROUOE  44
     C                     MOVE *ZEROS    QTEB    90
     C                     MOVE *ZEROS    SB1F    70
     C                     MOVE *ZEROS    SBTOT   70
     C                     MOVE *ZEROS    RETPS1  42
     C                     MOVE *ZEROS    REDEC1  50
     C                     MOVE *ZEROS    TPSTO1  62
     C                     MOVE *ZEROS    ROEFF   20
     C                     MOVE *ZEROS    ROEF1   20
     C                     MOVE *ZEROS    REEF1   20
     C                     MOVE *ZEROS    NETPS1  42
     C                     MOVE *ZEROS    LONGML  43
     C                     MOVE *ZEROS    COCOL   10
     C                     MOVE *ZEROS    LARGML  43
     C                     MOVE *ZEROS    LAIZML  32
     C                     MOVE *ZEROS    TPSDD   62
     C                     MOVE *ZEROS    RETPDD  42
     C                     MOVE *ZEROS    NETPDD  42
     C                     MOVE *ZEROS    TPSTOT  62
     C                     MOVE *ZEROS    ROULTO  92
     C                     MOVE *ZEROS    DECRAP  44
     C                     MOVE *ZEROS    MOYDEC  31
     C                     Z-ADD0         MOYCDD
     C                     Z-ADD0         R
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   TESTGP  1
     C                     Z-ADD0         TPSRE   62
     C                     Z-ADD0         TPSNE   42
     C                     Z-ADD0         DECR    50
     C                     Z-ADD0         MATCEN  72
     C                     Z-ADD0         MATUNT  72
     C                     Z-ADD0         DIREXT  72
     C                     Z-ADD0         DIRINT  72
     C                     Z-ADD0         DIRMAT  72
     C                     MOVE '0'       *IN31
     C                     MOVE *ZEROS    RT1
     C                     MOVE *BLANK    SVU5
     C                     MOVE *BLANK    FIONDT
     C                     MOVE *BLANK    PQFLX   1
     C                     MOVE ' '       BAPS    1
     C                     MOVE ' '       PASMA   1
     * remise a zero des tableaux de sortie sur la fiche devis .
     C                     Z-ADDUSFAB     USFABS  10
     C/SPACE 1
     * cout direct support ext. matieres 100m2 + papier. .
     C           COUTEX    ADD  DIRPEX    DIREXT
     * cout direct support int. matieres 100m2 + papier. .
     C           COUTIN    ADD  DIRPIN    DIRINT
     * cout direct tous les supports matieres 100m2 + papier. .
     C           COUDIR    ADD  PAPDIR    DIRMAT
     * valeur des matieres au 100m2 papier + matieres annexes .
     C           VALMAT    ADD  VALPAP    MATCEN
     * valeur des matieres a l'unite de vente papier + mat.annexes
     *                                                  au 100m2 .
     C           VTEMAT    ADD  VTEPAP    MATUNT
     C                     SUB  DREGST    DIRMAT
     C                     SUB  DROUST    DIRMAT
     C                     SUB  VREGST    MATCEN
     C                     SUB  VROUST    MATCEN
     * SI SOUS TRAITANCE INTÉGRALE
    C* ----------------------------------
    C*          TYPDEV    CABEQ4         DULIFI
D1  C           TYPDEV    IFEQ 4
     C                     Z-ADD1         R
     C                     Z-ADD1         I
     C                     MOVE '6'       SECT
     C                     MOVE '7'       SSECT
     C                     MOVEL'99'      NOMAC
     C                     Z-ADDUSINE     USFAB
     C                     Z-ADDQTFAB     QTENET
     C                     Z-ADD120       TPSTOT
     C                     Z-ADD1         ROUDEC
     C                     Z-ADD90        PRIORI
     C                     Z-ADD*ZEROS    RETPS
     C                     Z-ADD*ZEROS    REEFF
     C                     Z-ADD*ZEROS    NETPS
     C                     Z-ADD*ZEROS    NEEFF
     C                     Z-ADD*ZEROS    MOYCAD
     C                     WRITEPLANIFF1
    C                     GOTO DULIFI
F1  C                     END
     C/SPACE 1
     C           DECSUP    ADD  SUDEC     SUPDEC  42
     C                     ADD  STDEC1    SUPDEC
     C                     ADD  STDEC2    SUPDEC
     C                     ADD  STDEC3    SUPDEC
     C                     ADD  STDEC4    SUPDEC
     C                     MOVE SUPDEC    RAPDEC  54
     C                     ADD  1,0000    RAPDEC
     C                     Z-ADDUSINE     USFAB   10
     * OBJECTIF DE PRODUCTION
D1  C           DSGP      IFEQ 'AB'
    C           ZZSS      CABEQ'21'      FACO7
    C           ZZSS      CABEQ'22'      FACO11
D2  C           ZZSS      IFEQ '31'
D3  C           CCOL      IFEQ 6
    C                     GOTO FACO23
X3  C                     ELSE
    C                     GOTO FACO9
F3  C                     END
F2  C                     END
    C           ZZSS      CABEQ'41'      FACO8
    C           ZZSS      CABEQ'51'      FACO5
    C           ZZSS      CABEQ'52'      FACO5
    C           ZZSS      CABEQ'61'      FACO6
    C           ZZSS      CABEQ'70'      FACO4
    C           ZZSS      CABEQ'80'      FACO27
    C           ZZSS      CABEQ'81'      FACO3
    C           ZZSS      CABEQ'82'      FACO2
D2  C           ZZSS      IFEQ '83'
D3  C           NOMACS    IFEQ '01'                       MACHINE
    C           NOPASS    ANDEQ2                          OEILLET
    C           EYECOD    ANDNE*BLANKS
    C                     GOTO FACO28
X3  C                     ELSE
    C                     GOTO FACO1
F3  C                     END
F2  C                     END
    C           ZZSS      CABEQ'16'      FACO26
F1  C                     END
     *
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
    C           ZZSS      CABEQ'21'      FACO7
    C           ZZSS      CABEQ'22'      FACO11
    C           ZZSS      CABEQ'31'      FACO9
    C           ZZSS      CABEQ'41'      FACO8
D2  C           SECTS     IFEQ '5'
    C           GFRA      CABEQ*BLANKS   FACO5
    C           GFRA      CABEQ'GD'      FACO5
D3  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
X3  C                     ELSE
    C                     GOTO FACO16                     GAUFRAGE APRES
F3  C                     END
F2  C                     END
    C           ZZSS      CABEQ'61'      FACO6
    C           ZZSS      CABEQ'70'      FACO4            NON UTILISE
    C           ZZSS      CABEQ'80'      FACO27
    C           ZZSS      CABEQ'81'      FACO3
    C           ZZSS      CABEQ'82'      FACO2
D2  C           ZZSS      IFEQ '83'
D3  C           NOMACS    IFEQ '01'                       MACHINE
    C           USINE     ANDEQ2                          OEILLET
    C           EYECOD    ANDNE*BLANKS
    C                     GOTO FACO28
X3  C                     ELSE
    C                     GOTO FACO1
F3  C                     END
F2  C                     END
    C           ZZSS      CABEQ'16'      FACO26
F1  C                     END
    C*-----------------------------------
    C* SI CONTROLE / TRI
     * -------------------
D1  C           TVEI3     IFNE *BLANKS
     C                     EXSR SPCTRI
F1  C                     END
    C*-----------------------------------
     *
D1  C           FACON     IFEQ 8
    C           FACON     OREQ 7
    C           EYECOD    CABNE' '       FACO28           POSE OEILLET
D2  C           COAS2     IFEQ 0
    C                     GOTO FACO2                      1ER.ASSEMBLAGE
X2  C                     ELSE
    C                     GOTO FACO1                      2EME.ASSEMBLAGE
F2  C                     END
X1  C                     ELSE
D2  C           FACON     IFEQ 6
    C           EYECOD    CABNE' '       FACO28           POSE OEILLET
    C           TYPPOI    CABEQ'C '      FACO2            1ER ASSEMBLAGE
    C*          LGBAX     CABNE*BLANKS   FACO2            1ER ASSEMBLAGE
D3  C           COFEN     IFEQ 0
    C           PTDIF     CABNE' '       FACO27           PEINTURE
    C           DECORT    CABEQ' '       FACO5            DECOUPAGE
    C           DECORT    CABEQ'0'       FACO5            DECOUPAGE
    C                     GOTO FACO4                      DECORTICAGE
F3  C                     END
    C           COFEN     CABNE0         FACO3            POSE FENETRES
F2  C                     END
    C           FACON     CABEQ5         FACO6            DECOUP.ANNEXES
    C           FACON     CABEQ9         FACO6            DECOUP.ANNEXES
D2  C           FACON     IFEQ 1
    C           FACON     OREQ 2
    C           FACON     OREQ 4
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           IMPEXT    CABEQ3         FACO8            TYPO/GENCO
    C           IMPINT    CABEQ3         FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
    C           CCOL      CABEQ1         FACO9            C/COLLAGE
    C           CCOL      CABEQ5         FACO9            C/COLLAGE
    C           CCOL      CABEQ4         FACO11           COMPEXAGE SOF
    C           CCOL      CABEQ7         FACO11           COMPEXAGE SOF
    C           CCOL      CABEQ2         FACO7            ONDULATION
    C           CCOL      CABEQ3         FACO7            ONDULATION
    C           CCOL      CABEQ8         FACO7            ONDULATION
    C           CCOL      CABEQ9         FACO7            ONDULATION
    C           CCOL      CABEQ6         FACO23           CC/OND +CC
    C           *IN77     CABEQ'1'       FACO12           COMPEXAGE CXH
F2  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           PELLI     CABEQ'*'       FACO25           PELLICULEUSE
    C*
D2  C           CODDOR    IFEQ '*'
    C           GFRA      ANDEQ*BLANKS
    C                     GOTO FACO26                     DORURE      EUX
F2  C                     END
    C*
D2  C           FACON     IFEQ 0
D3  C           IMPEXT    IFEQ 0
    C           IMPINT    ANDEQ0
    C           APPEX     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FACON
F3  C                     END
D3  C           MASSI     IFEQ '*'
    C           GFRA      ANDEQ*BLANKS
    C                     GOTO FACO24                     AFFICHE EN DEUX
F3  C                     END
D3  C           FMASL     IFNE *ZEROS
    C           IMPEXT    ANDEQ0
    C           IMPINT    ANDEQ0
     C                     Z-ADD2         USFAB
    C                     GOTO FACO13                     MASSICOT NEUTRE
F3  C                     END
F2  C                     END
    C*
D2  C           DSGP      IFNE 'A4'
    C           STOCKE    ANDNE'O'
    C*          COUPR     ANDNE'R'
    C                     GOTO FACO7                      SECT.ONDULATION
F2  C                     END
D2  C           SUPDEC    IFNE 0
     C                     Z-ADDRAPDEC    ROUDEC
F2  C                     END
    C                     GOTO DULIFI
F1  C                     END
     * --------------------
     * SECTION POSE OEILLET
     * --------------------
     C           FACO28    TAG
    C* Suivi production
     * ----------------------------------------
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C                     GOTO DULI01
F1  C                     END
     * Section, Sous section, Rang(R) et Pas(I)
     * ----------------------------------------
     C                     MOVE '8'       SECT
     C                     MOVE '3'       SSECT
     C                     ADD  1         R
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     C                     ADD  1         I
F1  C                     END
     * Usine et machine
     * ----------------------------------------
     C                     Z-ADD2         USFAB
     C                     MOVEL'01'      NOMAC
     * Détermination clé pour CADDEC
     * ----------------------------------------
     C           DULI01    TAG
     C                     MOVE *BLANK    TYPCAD
     C                     MOVE 'EYES'    ACCCAT
     C                     MOVE EYECOD    ACCCOD
     C           CLEEYE    CHAINACCVALL1             80
     C                     MOVE TYPCAD    OEICAD
     C                     Z-ADDEYENB     OEINBO
     C                     MOVE EYEMOD    OEIMOD
     C                     Z-ADDCORDNB    OEINBA
     C                     MOVELDSOEI     CLEREC
     * Détermination Quantité net
     * ----------------------------------------
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           QTFAB     MULT ROUDEC    QTENET    H
     C           SUREG     DIV  SUVENT    REGL      H
     C           REGL      MULT 1000      REGL
     C           QTENET    ADD  REGL      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     * Calcul des normes standards (CADDEC)
     * ----------------------------------------
     C                     Z-ADD28        WWS     20
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FAC281
     * Les cas particuliers (CASPAR)
     * ----------------------------------------
     C                     EXSR CAPART                     CAS PARTICUL
     * Les pondérations
     * ----------------------------------------
     C                     Z-ADD28        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     * Calcul PRIORI + ecriture PLANIF
     * ----------------------------------------
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI                     CAL PRIORI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     * Valorisation des temps machine (COUHOR)
     * ----------------------------------------
     C                     MOVELMOYDEC    DROUOE
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
     * Stockage résulat dans DEVRES
     * ----------------------------------------
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
     * Pas = 1 pour le circuit  de fabrication
     * ----------------------------------------
     C           FAC281    TAG
     C                     Z-ADD1         I
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     C                     SUB  1         R
F1  C                     END
     * Circuit  de fabrication
     * ----------------------------------------
D1  C           FACON     IFEQ 8
    C           FACON     OREQ 7
D2  C           COAS2     IFEQ 0
    C                     GOTO FACO2                      1ER.ASSEMBLAGE
X2  C                     ELSE
    C                     GOTO FACO1                      2EME.ASSEMBLAGE
F2  C                     END
X1  C                     ELSE
D2  C           FACON     IFEQ 6
    C           TYPPOI    CABEQ'C '      FACO2            1ER ASSEMBLAGE
D3  C           COFEN     IFEQ 0
    C           PTDIF     CABNE' '       FACO27           PEINTURE
    C           DECORT    CABEQ' '       FACO5            DECOUPAGE
    C           DECORT    CABEQ'0'       FACO5            DECOUPAGE
    C                     GOTO FACO4                      DECORTICAGE
F3  C                     END
    C           COFEN     CABNE0         FACO3            POSE FENETRES
F2  C                     END
F1  C                     END
     * --------------------
     * FIN     POSE OEILLET
     * --------------------
    C*
     * section 2eme assemblage .
     * page A
     C           FACO1     TAG
     C                     MOVE '1'       PQFLX
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C           SSECT     CABEQ'3'       DULI61
    C                     GOTO DULI10
F1  C                     END
    C*
     C                     ADD  1         R
     C                     MOVE '8'       SECT
     C                     MOVEL'ASSEMBLA'Z10A   10
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
    C* TMAFBU 27/01/2015
    C           COAS2     OREQ 83
     C                     MOVE '3'       SSECT
X1  C                     ELSE
     C                     MOVE '2'       SSECT
     C                     ADD  1         I
F1  C                     END
    C* ordonnancement
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSAS2     USFAB
D2  C           MAAS21    IFNE *ZEROS
     C                     MOVE MAAS21    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FACO2
     C                     MOVE NOMAC1    NOMAC
F2  C                     END
    C           SSECT     CABEQ'3'       DULI61
    C                     GOTO DULI10
F1  C                     END
     * page A bis
D1  C           AXES2     IFNE *ZEROS
     C                     Z-ADDAXES2     AXES    40
X1  C                     ELSE
D2  C           PASS2     IFEQ DECL
     C                     Z-ADDDECH      DEV     40
X2  C                     ELSE
     C                     Z-ADDDECL      DEV
F2  C                     END
D2  C           DEV       IFEQ *ZEROS
     C                     Z-ADD*ZEROS    DEV
X2  C                     ELSE
D3  C           COAS2     IFEQ 28
    C           COAS2     OREQ 38
    C           COAS2     OREQ 39
     C           DEV       DIV  1,5       AXES
X3  C                     ELSE
     C                     SUB  20        DEV
     C           DEV       DIV  2         AXES
F3  C                     END
F2  C                     END
F1  C                     END
     * page A ter
     C                     Z-ADDCOAS2     COAS    20
     C                     MOVE PATS2     PATS    1
     C                     Z-ADDPASS2     PASS    40
     C                     MOVE COLA2     COLA    1
     C                     MOVE ETIQ2     ETIQ    1
     C                     MOVE ZB14      ENCA    1
     C                     MOVE RELC2     RELC    1
     C                     MOVE MTPS2     MTPS    1
     C                     MOVE PLIA2     PLIA    1
    C*
     C                     EXSR ASSEM
     * page A quatro
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     * TMAFBU LE 27/01/2015
    C           COAS2     OREQ 83
     C           DULI61    TAG
     C                     MOVELCOAS2     ERTCOD
     C                     MOVELDSPOIG    CLEREC
X1  C                     ELSE
     *
     C           DULI10    TAG
     *
     C                     MOVELCOAS2     ASSCOD
     C                     Z-ADDONDUL     ASSOND
     C                     Z-ADDCCOL      ASSCC
D2  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         ASSCC
     C                     Z-ADD0         ASSOND
F2  C                     END
     *
     C                     MOVE *BLANKS   ASSJUM
D2  C           PLIA2     IFEQ ' '
     C                     MOVEL'B'       ASSDIF
X2  C                     ELSE
     C                     MOVELPLIA2     ASSDIF
F2  C                     END
     C                     MOVELPASS2     ASSPAS
     C                     MOVELDSPLIE    CLEREC
F1  C                     END
     * page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           QTFAB     MULT ROUDEC    QTENET    H
     C           SUREG     DIV  SUVENT    REGL      H
     C           REGL      MULT 1000      REGL
     C           QTENET    ADD  REGL      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD14        WWS     20
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACO2
     C                     MOVE '2'       TESTGP
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C                     Z-ADD14        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     * <---PAGE-D--->
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
    C*
     C                     MOVELMOYDEC    DROUA2
     C                     MOVELMOYDEC    DECRO   44
     C           REDEC     MULT SBDEC     SREG   100
     C                     MOVELSREG      REGM2   40
     C                     ADD  REGM2     SUREG   50
     C                     ADD  DECRO     DECROU  44
     *
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHARG.RESULTATS
F1  C                     END
     C                     Z-ADD1         I
     C/SPACE 2
     * section 1er assemblage .
     * 1er assemblage page A
     C           FACO2     TAG
     C                     MOVE '2'       PQFLX
    C* SI POIGNEE CHAMPION
     C                     Z-ADDCOAS1     SCOAS1  20
D1  C           TYPP      IFEQ 'C'
    C           COAS1     ANDNE44
     C                     Z-ADD44        COAS1
F1  C                     END
    C* SI BANDE ADHESIVE
    C*          LGBAX     IFNE *BLANKS
    C*          COAS1     ANDNE48
    C*          PSBA      ANDNE'O'
    C*                    Z-ADD48        COAS1
    C*                    END
    C*          LGBAX     IFNE *BLANKS
    C*          COAS1     ANDNE*ZEROS
    C*          PSBA      ANDEQ'O'
    C*          BAPS      ANDEQ'*'
    C*                    Z-ADD48        COAS1
    C*                    END
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C                     GOTO DULI76
F1  C                     END
    C*
     C                     ADD  1         R
     C                     MOVE '8'       SECT
     C                     MOVEL'ASSEMBLA'Z10A   10
     C                     MOVE '2'       SSECT
    C* ordonnancement
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSAS1     USFAB
    C*          LGBAX     IFNE *BLANKS
    C*          COAS1     ANDNE*ZEROS
    C*          PSBA      ANDEQ'O'
    C*          BAPS      ANDEQ'*'
    C*                    MOVE '48'      NOMAC
    C*                    ELSE
D2  C           MAAS11    IFNE *ZEROS
     C                     MOVE MAAS11    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FACO34
     C                     MOVE NOMAC1    NOMAC
F2  C                     END
    C*                    END
    C                     GOTO DULI76
F1  C                     END
     * page A1
D1  C           AXES1     IFNE *ZEROS
     C                     Z-ADDAXES1     AXES    40
X1  C                     ELSE
D2  C           PASS1     IFEQ DECL
     C                     Z-ADDDECH      DEV     40
X2  C                     ELSE
     C                     Z-ADDDECL      DEV
F2  C                     END
D2  C           DEV       IFEQ *ZEROS
     C                     Z-ADD*ZEROS    DEV
X2  C                     ELSE
D3  C           COAS1     IFEQ 28
    C           COAS1     OREQ 38
    C           COAS1     OREQ 39
     C           DEV       DIV  1,5       AXES
X3  C                     ELSE
     C                     SUB  20        DEV
     C           DEV       DIV  2         AXES
F3  C                     END
F2  C                     END
F1  C                     END
     * page A2
     C                     Z-ADDCOAS1     COAS    20
     C                     MOVE PATS1     PATS    1
     C                     Z-ADDPASS1     PASS    40
     C                     MOVE COLA1     COLA    1
     C                     MOVE ETIQ1     ETIQ    1
     C                     MOVE ZB13      ENCA    1
     C                     MOVE RELC1     RELC    1
     C                     MOVE MTPS1     MTPS    1
     C                     MOVE PLIA1     PLIA    1
     * page A3
D1  C           JUMEL     IFEQ 'J'
    C           USINE     ANDEQ4
D2  C           COAS1     IFEQ 24
    C           COAS1     OREQ 26
     C                     Z-ADD2         USFAB
     C                     MOVEL'06'      NOMAC
    C                     GOTO DULI76
F2  C                     END
F1  C                     END
D1  C           JUMEL     IFEQ 'J'
    C           COFEN     ANDEQ22
    C           CDE       ANDEQ1
    C           JUMEL     OREQ 'J'
    C           COFEN     ANDEQ21
    C           CDE       ANDEQ1
     C                     MOVEL'05'      NOMAC
     C                     Z-ADD2         USFAB
    C                     GOTO DULI76
F1  C                     END
    C*
     C                     EXSR ASSEM
     * page A4
     C           DULI76    TAG
     *
     C                     MOVELCOAS1     ASSCOD
     C                     Z-ADDONDUL     ASSOND
     C                     Z-ADDCCOL      ASSCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         ASSCC
     C                     Z-ADD0         ASSOND
F1  C                     END
     *
D1  C           JUMEL     IFNE *BLANKS
     C                     MOVE 'J'       ASSJUM
X1  C                     ELSE
     C                     MOVE *BLANKS   ASSJUM
F1  C                     END
D1  C           PLIA1     IFEQ ' '
     C                     MOVEL'B'       ASSDIF
X1  C                     ELSE
     C                     MOVELPLIA1     ASSDIF
F1  C                     END
     C                     MOVELPASS1     ASSPAS
     C                     MOVELDSPLIE    CLEREC
     *  page B
     C           RAPDEC    ADD  DECROU    ROUDEC  54
     C           QTFAB     MULT ROUDEC    QTENET    H
     C           SUREG     DIV  SUVENT    REGL      H
     C           REGL      MULT 1000      REGL
     C                     ADD  REGL      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD13        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACO34
     C                     MOVE '1'       TESTGP
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD13        WSS     20
    C*          BAPS      IFEQ '*'                        BANDE ADHESIVE
    C*                    Z-ADD23        WSS     20
    C*                    ELSE
     C                     Z-ADD13        WSS     20
    C*                    END
     C                     EXSR KOEFF                      PONDERATION
     * page D
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DROUA1
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     * page E
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
    C* BANDE ADHESIVE SÉPAREE
    C*          LGBAX     IFNE *BLANKS
    C*          COAS1     ANDNE*ZEROS
    C*          PSBA      ANDEQ'O'
    C*          BAPS      ANDEQ' '
    C*                    MOVE '*'       BAPS
    C*                    Z-ADDSCOAS1    COAS1
    C*                    GOTO FACO2
    C*                    END
     C                     Z-ADDSCOAS1    COAS1
     *
     C           FACO34    TAG
    C           COFEN     CABNE0         FACO3            POSE FENETRES
D1  C           COFEN     IFEQ 0
    C           PTDIF     CABNE' '       FACO27           PEINTURE
    C           DECORT    CABEQ' '       FACO5            DECOUPAGE
    C           DECORT    CABEQ'0'       FACO5            DECOUPAGE
    C                     GOTO FACO4                      DECORTICAGE
F1  C                     END
     C/SPACE 2
     * section pose fenetres .
     C           FACO3     TAG
     C                     MOVE '2'       PQFLX
     * fenetre page A
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
     C                     MOVE PASFE     FENPAS
D2  C           COFEN     IFEQ 22
     C                     MOVE LONFEN    FENGAI
F2  C                     END
D2  C           COFEN     IFEQ 20
     C                     MOVE LONFEN    FENGAI
F2  C                     END
X1  C                     ELSE
    C*
     C                     ADD  1         R
     C                     MOVE '8'       SECT
     C                     MOVE '1'       SSECT
     C                     MOVE '02'      NOMAC
    C*
D2  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
F2  C                     END
    C*
     C                     MOVE PASFE     FENPAS
D2  C           COFEN     IFEQ 22
     C                     MOVE LONFEN    FENGAI
     C                     MOVE '02'      NOMAC
     C                     Z-ADD2         USFAB
F2  C                     END
D2  C           COFEN     IFEQ 20
     C                     MOVE LONFEN    FENGAI
     C                     MOVE '03'      NOMAC
     C                     Z-ADD2         USFAB
F2  C                     END
D2  C           COFEN     IFEQ 11
     C                     MOVE '99'      NOMAC
     C                     Z-ADD2         USFAB
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSFEN     USFAB
D3  C           MAFEN1    IFNE *ZEROS
     C                     MOVE MAFEN1    NOMAC
X3  C                     ELSE
D4  C           USFAB     IFEQ 2
     C                     MOVE '02'      NOMAC
D5  C           COFEN     IFEQ 20
     C                     MOVE '03'      NOMAC
F5  C                     END
X4  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FACOCO
     C                     MOVE NOMAC1    NOMAC
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C                     MOVELDSFEN     CLEREC
     * fenetre page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           QTFAB     MULT ROUDEC    QTENET    H
     C           SUREG     DIV  SUVENT    REGL      H
     C           REGL      MULT 1000      REGL
     C           QTENET    ADD  REGL      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD12        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACOCO
     C                     EXSR CAPART
     *
     C                     Z-ADD12        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     * fenetre page D
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     * fenetre page E
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FACOCO
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
     *
     C           FACOCO    TAG
    C           PTDIF     CABNE' '       FACO27           PEINTURE
    C           DECORT    CABEQ' '       FACO5            DECOUPAGE
    C           DECORT    CABEQ'0'       FACO5
    C                     GOTO FACO4                      DECORTICAGE
     C/SPACE 2
     * section decoupages annexes .
     C           FACO6     TAG
     * decoupage annexes page A
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
     C                     ADD  1         R
     C                     MOVE '6'       SECT
     C                     MOVE '1'       SSECT
    C* ordonnancement
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSAUT     USFAB
D3  C           MAAUT1    IFNE *ZEROS
     C                     MOVE MAAUT1    NOMAC
    C                     GOTO DULI34
F3  C                     END
F2  C                     END
    C*
D2  C           ONDUL     IFEQ 7
     C                     MOVE '03'      NOMAC
X2  C                     ELSE
     C                     MOVE '01'      NOMAC
F2  C                     END
F1  C                     END
    C*
D1  C           CDE       IFEQ 1
     C                     Z-ADD3         USFAB
F1  C                     END
    C*
     C           DULI34    TAG
     C                     Z-ADDONDUL     DECOND
     C                     Z-ADDCCOL      DECCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DECCC
     C                     Z-ADD0         DECOND
F1  C                     END
     C                     MOVELSUVENT    DECUNI
     C                     MOVELDSDECA    CLEREC
    C*
     * decoupage annexes page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           QTFAB     MULT RAPDEC    QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACO7
     * decoupage annexes page C
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     * decoupage annexes page D
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FACO7
     *
     C                     EXSR RESULT                     CHRG.RESULTATS
     *
    C                     GOTO FACO7                      SECT.ONDULATION
     C/SPACE 2
     * section decorticage .
     C           FACO4     TAG
     C                     Z-ADD0         REGM2
     * decorticage page A
D1  C           CDE       IFEQ 1                          PAS REACTEUR
    C           DECORT    ANDEQ'9'                        EN PVS
     C                     MOVE '2'       DECORT
F1  C                     END
    C           DECORT    CABEQ'9'       FACO19             REACTEUR
    C           DECORT    CABEQ'0'       FACO5              DECOUPAGE
    C           DECORT    CABEQ'7'       FACO5                  "
    C           DECORT    CABEQ'8'       FACO5                  "
    C           DECORT    CABEQ'A'       FACO5                  "
    C           DECORT    CABEQ'B'       FACO5                  "
    C*
D1  C           CDE       IFEQ 1
     C                     Z-ADD3         USFAB
X1  C                     ELSE
     C                     Z-ADDUSINE     USFAB
F1  C                     END
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSDEC     USFAB
F1  C                     END
    C*
     C                     ADD  1         R
     C                     MOVE '7'       SECT
     C                     MOVE '0'       SSECT
     C                     MOVE '00'      NOMAC
     C                     MOVE DECORT    DCORTI
     C                     Z-ADDONDUL     DCOOND
     C                     Z-ADDCCOL      DCOCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DCOCC
     C                     Z-ADD0         DCOOND
F1  C                     END
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DCOPOS
X1  C                     ELSE
     C                     MOVE POSFO     DCOPOS
F1  C                     END
     C                     MOVELDSDCOR    CLEREC
     * decorticage page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB    90H
     C                     ADD  SUREG     QTEB
D1  C           SBZ       IFNE *ZEROS                      EN FEUILLES
     C           POSF1     ADD  POSF2     TOTDE
     C           QTEB      DIV  SBZ       QTENET
     C                     DIV  TOTDE     QTENET
D2  C           POSF2     IFNE 0
     C                     MULT 2         QTENET
F2  C                     END
X1  C                     ELSE
     C           QTEB      DIV  SBFE      QTENET    H
F1  C                     END
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD11        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACO5
     *
D1  C           AMALS     IFNE *ZEROS
    C           SIM       ANDEQ1
     C           RETPS     MULT AMALS     RETPS
F1  C                     END
     * decorticage
     C                     EXSR CAPART
     *
     C                     Z-ADD11        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
     C                     EXSR KOARI                      ARIANE CAI
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FACO5
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
     *
     C/SPACE 2
     * section decoupage .
     C           FACO5     TAG
     C                     SETOF                     90
    C* SI PAQUET FICELLE  TOUS LIENS SUR AUTRE
    C*-------------------------------------------------------------
D1  C           DSGP      IFNE 'SU'
D2  C           PQFL1     IFEQ 'Q'
    C           PQFLX     ANDEQ*BLANK
D3  C           FACON     IFNE 2
    C           FACON     ORNE 5
D4  C           PQFL2     IFEQ 'L'
    C           PQFL2     OREQ 'F'
     C                     MOVE '4'       PQFLX
     C                     MOVE SS        SVSS    2
     C                     MOVE NOMAC     NOMACS
    C                     GOTO FACO22
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     * decoupage page A1/A2
     *
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
    C           DSGP      OREQ 'AB'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C                     GOTO DULI11
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSDEC     USFAB
X1  C                     ELSE
     C                     Z-ADDUSINE     USFAB
F1  C                     END
     C                     ADD  1         R
     C                     MOVE '5'       SECT
    C*
D1  C           MACDEC    IFEQ 'G'
     C                     MOVE '1'       SSECT
D2  C           CDE       IFEQ 1
     C                     Z-ADD3         USFAB
     C                     MOVE '06'      NOMAC
X2  C                     ELSE
D3  C           MADEC1    IFNE '  '
     C                     MOVE MADEC1    NOMAC
X3  C                     ELSE
     C                     MOVE '01'      NOMAC
F3  C                     END
D3  C           USFAB     IFEQ 4
     C                     MOVE '1'       SSECT
F3  C                     END
F2  C                     END
    C                     GOTO DULI11
F1  C                     END
    C*
     C                     MOVE '1'       SSECT
    C* ordonnancement
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSDEC     USFAB
D2  C           MADEC1    IFNE '  '
     C                     MOVE MADEC1    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI24
     C                     MOVE NOMAC1    NOMAC
F2  C                     END
X1  C                     ELSE
    C* COMMERCIAL
D2  C           MACDEC    IFEQ 'E'
     C                     Z-ADD2         USFAB
     C                     MOVE '19'      NOMAC
X2  C                     ELSE
D3  C           ONDL      IFGT ONDH
     C                     Z-ADDONDL      PGMM    40
     C                     Z-ADDONDH      PPMM    40
X3  C                     ELSE
     C                     Z-ADDONDH      PGMM
     C                     Z-ADDONDL      PPMM
F3  C                     END
D3  C           CCOL      IFEQ 0
    C           CCOL      OREQ 5
    C           CCOL      OREQ 4
    C           CCOL      OREQ 7
D4  C           PGMM      IFLE 1040
    C           PPMM      ANDLE740
     C                     Z-ADD3         USFAB
     C                     MOVE '15'      NOMAC
X4  C                     ELSE
D5  C           PGMM      IFLE 1420
    C           PPMM      ANDLE1021
     C                     Z-ADD2         USFAB
     C                     MOVE '15'      NOMAC
X5  C                     ELSE
     C                     Z-ADD7         USFAB
     C                     MOVE '04'      NOMAC
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           ONDUL     IFEQ 4
D5  C           PGMM      IFLE 1040
    C           PPMM      ANDLE740
     C                     Z-ADD3         USFAB
     C                     MOVE '15'      NOMAC
X5  C                     ELSE
     C                     Z-ADD2         USFAB
     C                     MOVE '15'      NOMAC
F5  C                     END
X4  C                     ELSE
D5  C           MACDEC    IFEQ 'A'
    C           MACDEC    OREQ 'B'
     C                     Z-ADD3         USFAB
     C                     MOVE '01'      NOMAC
X5  C                     ELSE
D6  C           MACDEC    IFEQ 'C'
D7  C           CCOL      IFEQ 2
     C                     Z-ADD3         USFAB
     C                     MOVE '11'      NOMAC
X7  C                     ELSE
D8  C           PGMM      IFGT 1060
    C           PPMM      ORGT 760
     C                     Z-ADD3         USFAB
     C                     MOVE '11'      NOMAC
X8  C                     ELSE
D9  C           PGMM      IFGT 1020
    C           PPMM      ORGT 720
     C                     Z-ADD3         USFAB
     C                     MOVE '19'      NOMAC
X9  C                     ELSE
     C                     Z-ADD3         USFAB
     C                     MOVE '14'      NOMAC
F9  C                     END
F8  C                     END
F7  C                     END
X6  C                     ELSE
D7  C           MACDEC    IFEQ 'J'
D8  C           PGMM      IFGT 1060
    C           PPMM      ORGT 760
     C                     Z-ADD3         USFAB
     C                     MOVE '11'      NOMAC
X8  C                     ELSE
D9  C           PGMM      IFGT 1020
    C           PPMM      ORGT 720
     C                     Z-ADD3         USFAB
     C                     MOVE '19'      NOMAC
X9  C                     ELSE
     C                     Z-ADD3         USFAB
     C                     MOVE '14'      NOMAC
F9  C                     END
F8  C                     END
X7  C                     ELSE
D8  C           MACDEC    IFEQ 'D'
     C                     Z-ADD3         USFAB
     C                     MOVE '10'      NOMAC
X8  C                     ELSE
D9  C           MACDEC    IFEQ 'F'
    C           MACDEC    OREQ 'I'
    C           MACDEC    OREQ 'K'
D10 C           CCOL      IFEQ 1
    C* TMAFBU 26/08/13    Z-ADD3         USFAB
    C* TMAFBU 26/08/13    MOVE '18'      NOMAC
     C                     Z-ADD7         USFAB
     C                     MOVE '04'      NOMAC
X10 C                     ELSE
     C                     Z-ADD3         USFAB
     C                     MOVE '16'      NOMAC
F10 C                     END
X9  C                     ELSE
    C* TMAFBU 24/09/14    MOVE '14'      NOMAC
     C                     Z-ADD2         USFAB
     C                     MOVE '17'      NOMAC
F9  C                     END
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C           DULI11    TAG
     *          -FACO22--------
    C* SI PAQUET FICELLE  TOUS LIENS SUR AUTRE
    C*-------------------------------------------------------------
D1  C           DSGP      IFNE 'SU'
D2  C           PQFL1     IFEQ 'Q'
    C           PQFLX     ANDEQ*BLANK
D3  C           FACON     IFNE 2
    C           FACON     ORNE 5
D4  C           PQFL2     IFEQ 'L'
    C           PQFL2     OREQ 'F'
     C                     MOVE '3'       PQFLX
     C                     MOVE SS        SVSS    2
     C                     MOVE NOMAC     NOMACS
    C                     GOTO FACO22
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     * decoupage page A3
D1  C           DSGP      IFEQ 'SU'
    C           SSECT     ANDEQ'2'
    C*          MACDEC    OREQ 'G'
     C                     Z-ADDONDUL     JUOND
     C                     Z-ADDCCOL      JUCC
D2  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         JUCC
     C                     Z-ADD0         JUOND
F2  C                     END
     C                     MOVE TYPDEC    JUDEC
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     JUPOSE
X2  C                     ELSE
     C                     MOVE POSFO     JUPOSE
F2  C                     END
     C                     MOVELDSJURI    CLEREC
X1  C                     ELSE
    C*
     C                     Z-ADDONDUL     SPOND
     C                     Z-ADDCCOL      SPCC
D2  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         SPCC
     C                     Z-ADD0         SPOND
F2  C                     END
     C                     MOVE TYPDEC    SPDEC
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     SPPOSE
X2  C                     ELSE
     C                     MOVE POSFO     SPPOSE
F2  C                     END
     C                     MOVELDSAUTO    CLEREC
F1  C                     END
     C/SPACE 1
     C           RAPDEC    ADD  DECROU    ROUDEC
     * decoupage page B
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADD0         SUF1
     C                     Z-ADD0         SUF2
D2  C           ACOTE     IFEQ 0                             O
     C           QTENES    MULT SBFEU     SUF1   130          B   P
X2  C                     ELSE                               J   R
     C           NBR       ADD  1         NBTOTA  20          E   O
     C           QTENES    DIV  NBTOTA    NBCOT   70          C   D
     C           NBCOT     MULT SBACOT    SUF2   130          T   U
     C           QTENES    SUB  NBCOT     QTENES              I   C
     C           QTENES    MULT SBFEU     SUF1                F   T
F2  C                     END                                    I
     C           SUF1      ADD  SUF2      TOTSUF 130              O
     C                     MOVELTOTSUF    SUF3    70              N
     C                     MOVE SUF3      SUFAB
F1  C                     END
     C/SPACE 1
     C           SUFAB     MULT ROUDEC    QTEB      H
     C           QTEB      ADD  SUREG     QTEB
D1  C           ACOTE     IFEQ 0
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
D2  C           ONDUL     IFEQ 7
    C           POSFO     CABEQ0         DULI16
    C           POSFO     CABGEPOSF1     DULI16
     C           POSF1     DIV  POSFO     GAUFO   54
     C           QTENET    MULT GAUFO     QTENET
F2  C                     END
X1  C                     ELSE
     C           LALAIZ    SUB  ACOTE     RESTE
     C           RESTE     DIV  ONDL      NBR
     C           SBFEU     MULT NBR       SB1F    70
     C           SB1F      ADD  SBACOT    SBTOT   70
     C                     MOVELSBTOT     SBFEZ   76
     C           QTEB      DIV  SBFEZ     QTEAUT  70H
D2  C           NBR       IFLT 1
     C                     Z-ADD1         NBR
F2  C                     END
     C           QTEAUT    MULT NBR       QTENET
F1  C                     END
     *
     * decoupage page C
     C           DULI16    TAG
     C                     Z-ADD10        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULI24
     *
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'A5'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     MOVE ZB15      KEASY
X1  C                     ELSE
D2  C           KEASY     IFEQ ' '
     C                     MOVE 'B'       KEASY
F2  C                     END
F1  C                     END
D1  C           POSFO     IFEQ *ZEROS
     C                     Z-ADDPOSF1     SPPOS
X1  C                     ELSE
     C                     Z-ADDPOSFO     SPPOS
F1  C                     END
     *
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD10        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D1  C           ACOTE     IFNE 0
     *
     * decoupage page E
D2  C           *IN90     IFEQ '1'
     C                     ADD  RETPS1    RETPS
     C                     Z-ADDREDEC1    REDEC
     C                     ADD  TPSTO1    TPSTOT
     C                     ADD  NETPS1    NETPS
     C                     Z-ADDMOYDE1    MOYDEC
     C                     Z-ADDROEF1     ROEFF
     C                     Z-ADDREEF1     REEFF
X2  C                     ELSE
     C                     SETON                     90
     C                     Z-ADDRETPS     RETPS1  42
     C                     Z-ADDREDEC     REDEC1  50
     C                     Z-ADDTPSTOT    TPSTO1  62
     C                     Z-ADDMOYDEC    MOYDE1  31
     C                     Z-ADDROEFF     ROEF1
     C                     Z-ADDREEFF     REEF1   20
     C                     Z-ADDQTEAUT    QTENET
     C                     Z-ADDNETPS     NETPS1
    C*          MACDEC    IFNE 'G'
     C                     MOVELPOSF2     SPPOSE
     C                     MOVELDSAUTO    CLEREC
    C*                    ELSE
    C*                    MOVELPOSF2     JUPOSE
    C*                    MOVELDSJURI    CLEREC
    C*                    END
    C                     GOTO DULI16
F2  C                     END
F1  C                     END
     *
     * decoupage page F
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     * decoupage page G
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI24
     *
     C                     EXSR RESULT                     CHARG.RESULTATS
     *
D1  C           USFAB     IFEQ 3
D2  C           NOMAC     IFEQ '14'
    C           NOMAC     OREQ '15'
    C           NOMAC     OREQ '17'
    C           NOMAC     OREQ '19'
    C           NOMAC     OREQ '11'
    C           DSGP      ANDEQ'OR'
    C           NOMAC     OREQ '11'
    C           DSGP      ANDEQ'OB'
    C                     GOTO PREPTY
F2  C                     END
F1  C                     END
    C*
D1  C           USFAB     IFEQ 4
D2  C           CDE       IFEQ 0
    C           ZB15      CABEQ' '       DULI24
D3  C           NOMAC     IFEQ '05'
    C           NOMAC     OREQ '08'
    C           NOMAC     OREQ '09'
    C                     GOTO EASY
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C           DULI24    TAG
     * POST PRINT 2 PASSAGES
D1  C           IMPEXT    IFEQ 2
    C           IMPINT    ANDEQ5
    C           IMPEXT    OREQ 4
    C           IMPINT    ANDEQ5
    C           IMPEXT    OREQ 5
    C           IMPINT    ANDEQ2
    C           IMPEXT    OREQ 5
    C           IMPINT    ANDEQ4
    C                     GOTO FACO15                     POST PRINT 2 P
F1  C                     END
    C           RIMPEX    CABEQ5         FACO15           POST PRINT 2
    C           RIMPIN    CABEQ5         FACO15           POST PRINT 2
     C           DULI28    TAG
     *
D1  C           CCOL      IFNE 4                          MARQUAGE FLEXO
    C           CCOL      ANDNE7
    C           IMPEXT    CABEQ3         FACO8            SECTION TYPO
    C           IMPINT    CABEQ3         FACO8
    C           RIMPEX    CABEQ3         FACO8
    C           RIMPIN    CABEQ3         FACO8
F1  C                     END
     * decoupage page H
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
D2  C           GFRA2     IFEQ 'XA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'XB'
    C           GFRA2     OREQ 'XC'
    C                     GOTO FACO18                     GAUFARGE APRES
F2  C                     END
D2  C           GFRA      IFEQ 'XA'
    C           GFRA      OREQ 'XB'
    C           GFRA      OREQ 'XC'
    C                     GOTO FACO16                     GAUFARGE APRES
F2  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
    C                     GOTO FACO9                      SECT.C/COL  ION
F1  C                     END
D1  C           CCOL      IFEQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
D2  C           GFRA2     IFEQ 'XA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'XB'
    C           GFRA2     OREQ 'XC'
    C                     GOTO FACO18                     GAUFARGE APRES
F2  C                     END
D2  C           GFRA      IFEQ 'XA'
    C           GFRA      OREQ 'XB'
    C           GFRA      OREQ 'XC'
    C                     GOTO FACO16                     GAUFARGE APRES
F2  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
    C                     GOTO FACO7                      SECT.ONDULATION
F1  C                     END
D1  C           CCOL      IFEQ 8
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
D2  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F2  C                     END
D2  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F2  C                     END
    C                     GOTO FACO7                      SECT.ONDULATION
F1  C                     END
D1  C           CCOL      IFEQ 4                                      ION
    C           CCOL      OREQ 7                                      ION
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
D2  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F2  C                     END
D2  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F2  C                     END
    C                     GOTO FACO11                     COMPLEXAGE SOF
F1  C                     END
D1  C           CCOL      IFEQ 0                                      ION
D2  C           GFRA2     IFEQ 'XA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'XB'
    C           GFRA2     OREQ 'XC'
    C                     GOTO FACO18                     GAUFARGE APRES
F2  C                     END
D2  C           GFRA      IFEQ 'XA'
    C           GFRA      OREQ 'XB'
    C           GFRA      OREQ 'XC'
    C                     GOTO FACO16                     GAUFARGE APRES
F2  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
D2  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F2  C                     END
D2  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F2  C                     END
D2  C           FMASL     IFNE *ZEROS
    C           IMPEXT    ANDEQ*ZERO
    C                     GOTO FACO13                     MASSICOT FACON
F2  C                     END
D2  C           IMPEXT    IFEQ 0
    C           IMPINT    ANDEQ0
    C           APPEX     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FACON
F2  C                     END
D2  C           COUPR     IFEQ 'R'
    C           ONDUL     OREQ 7
    C                     GOTO FACO7                      SECT.ONDULATION
F2  C                     END
    C           PELLI     CABEQ'*'       FACO25
    C           CODDOR    CABEQ'*'       FACO26           DORURE
D2  C           *IN77     IFEQ '1'
    C                     GOTO FACO12                     COMPLEXAGE CXH
F2  C                     END
    C                     GOTO DULIFI                     FIN --> IMP.
F1  C                     END
D1  C           CCOL      IFEQ 6
D2  C           GFRA2     IFEQ 'XA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'XB'
    C           GFRA2     OREQ 'XC'
    C                     GOTO FACO18                     GAUFRAGE APRES
F2  C                     END
D2  C           GFRA      IFEQ 'XA'
    C           GFRA      OREQ 'XB'
    C           GFRA      OREQ 'XC'
    C                     GOTO FACO16                     GAUFRAGE APRES
F2  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
    C                     GOTO FACO23                     CC/OND + CC ION
F1  C                     END
     *
    C                     GOTO DULIFI                     FIN --> IMP.
     *
     C/SPACE 2
     * section Easy Press
     C           EASY      TAG
D1  C           KEASY     IFEQ ' '
     C                     MOVE 'B'       KEASY
F1  C                     END
     * easy press page E1
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C*
X1  C                     ELSE
     C                     MOVE 5         SECT
     C                     MOVE 1         SSECT
     C                     Z-ADD0         I
     C                     MOVE '99'      NOMAC
F1  C                     END
     * easy press page E2
D1  C           POSFO     IFEQ *ZEROS
     C                     Z-ADDPOSF1     SPPOS
X1  C                     ELSE
     C                     Z-ADDPOSFO     SPPOS
F1  C                     END
     C                     MOVELDSEASY    CLEREC
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET
    C*
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULI24
     * easy press page E3
     C           10        LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW    32
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW    32
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG    42
D2  C           PREG      IFNE *ZEROS
     C           RETPS     MULT PREG      RETPS
F2  C                     END
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'SU'
     C           NOPASS    ADD  1         I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBFE      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI24
     *
     C                     ADD  1         X
     C                     Z-ADDTOLREG    REG,X            CHAR.RESULTATS
     C                     Z-ADD*ZEROS    MOYDEC
     C                     Z-ADD*ZEROS    TREGMA
     C                     Z-ADD*ZEROS    DIFF
     C                     Z-ADD*ZEROS    TOLROU
     C                     Z-ADD*ZEROS    ROULUV
D1  C           PREG      IFNE 1
     C                     Z-ADDPREG      REGK
F1  C                     END
     C           RETPS     ADD  NETPS     RNTPS
     C                     WRITEDEVRESF
     *
     C                     Z-ADD1         I
     C                     Z-ADD*ZEROS    REGK
     C                     Z-ADD*ZEROS    TOLREG
     C                     MOVE *BLANKS   SS
     * easy press page E4
    C                     GOTO DULI24
     C/SPACE 2
     * section PREPARATION REGLAGE TOURY
     C           PREPTY    TAG
     C                     Z-ADD3         USFAB
     C                     MOVE 5         SECT
     C                     MOVE 1         SSECT
     C                     Z-ADD0         I
     C                     MOVE '80'      NOMAC
     C                     Z-ADD1         QTENET
     *
D1  C           CFORM     IFEQ ' '                        SANS FORME
    C           CFORM     OREQ '1'                        FORME + C.F.
     C                     Z-ADD2,5       RETPS
X1  C                     ELSE
     C                     Z-ADD1,5       RETPS
F1  C                     END
     C                     Z-ADD*ZEROS    MOYDEC
     C                     Z-ADD*ZEROS    MOYCAD
     C                     Z-ADD*ZEROS    TPSTOT
     C                     Z-ADD*ZEROS    REDEC
     C                     Z-ADD1         REEFF
     C                     Z-ADD*ZEROS    NEEFF
     C                     Z-ADD*ZEROS    ROEFF
     C                     Z-ADD*ZEROS    NETPS
     C           10        LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW    32
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW    32
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG    42
D2  C           PREG      IFNE *ZEROS
     C           RETPS     MULT PREG      RETPS
F2  C                     END
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'SU'
     C           NOPASS    ADD  1         I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI24
     *
     C                     ADD  1         X
     C                     Z-ADDTOLREG    REG,X            CHAR.RESULTATS
     C                     Z-ADD*ZEROS    MOYDEC
     C                     Z-ADD*ZEROS    TREGMA
     C                     Z-ADD*ZEROS    DIFF
     C                     Z-ADD*ZEROS    TOLROU
     C                     Z-ADD*ZEROS    ROULUV
     C                     Z-ADD*ZEROS    REGK
     C           RETPS     ADD  NETPS     RNTPS
     C                     WRITEDEVRESF
     *
     C                     Z-ADD1         I       10
     C                     Z-ADD*ZEROS    TOLREG
     C                     MOVE *BLANKS   SS
     * easy press page E4
    C                     GOTO DULI24
     C/SPACE 2
     * section typo .
     C           FACO8     TAG
     * Impression Offset sur feuilles ondulées
D1  C           APPEX     IFEQ 'O'
    C           APPIN     OREQ 'O'
     C                     Z-ADD0         I
     C                     Z-ADDQTENET    QTNETS  70
D2  C           POSF1     IFNE *ZEROS
     C           QTFAB     DIV  POSF1     QTENET
X2  C                     ELSE
     C                     Z-ADDQTFAB     QTENET
F2  C                     END
D2  C           FORL      IFEQ *ZEROS
D3  C           ONDL      IFNE *ZEROS
     C                     Z-ADDONDL      FORL
     C                     Z-ADDONDH      FORH
X3  C                     ELSE
     C                     Z-ADDDECL      FORL
     C                     Z-ADDDECH      FORH
F3  C                     END
F2  C                     END
    C*
D2  C           APPIN     IFEQ 'O'
D3  C           RIMPIN    IFEQ 4
     C                     SETON                     863139
     C                     EXSR CHIMP
     C                     ADD  1         R
     C                     Z-ADD1         RT1     10
    C                     GOTO OFFSET
     C           FACO8A    TAG
     C                     SETOF                     863139
F3  C                     END
     C                     SETON                     963139
     C                     EXSR CHIMP
     C                     ADD  1         R
     C                     Z-ADD2         RT1
    C                     GOTO OFFSET
     C           FACO8B    TAG
     C                     SETOF                     963139
F2  C                     END
D2  C           APPEX     IFEQ 'O'
D3  C           RIMPEX    IFEQ 4
     C                     SETON                     873139
     C                     EXSR CHIMP
     C                     ADD  1         R
     C                     Z-ADD3         RT1
    C                     GOTO OFFSET
     C           FACO8C    TAG
     C                     SETOF                     873139
F3  C                     END
     C                     SETON                     973139
     C                     EXSR CHIMP
     C                     ADD  1         R
     C                     Z-ADD4         RT1
    C                     GOTO OFFSET
     C           FACO8D    TAG
     C                     SETOF                     973139
F2  C                     END
    C*
     C                     Z-ADDQTNETS    QTENET
    C                     GOTO DULIV
F1  C                     END
     * typo page A
     C                     SETOF                     206667
     C                     SETOF                     6869
     C                     Z-ADD0         I
     C                     ADD  1         R
    C*
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
     C                     MOVE '4'       SECT
     C                     MOVE '1'       SSECT
D2  C           GENCO1    IFEQ '*'
D3  C           USFAB     IFEQ 7
    C           DSGP      ANDEQ'OB'
    C           USFAB     OREQ 7
    C           DSGP      ANDEQ'OR'
     C                     MOVE '01'      NOMAC
X3  C                     ELSE
     C                     MOVE '02'      NOMAC
     C                     MOVE 2         USFAB
F3  C                     END
X2  C                     ELSE
D3  C           IMPEXT    IFEQ 3
D4  C           USEXT     IFEQ 2
     C                     MOVE 2         USFAB
     C                     MOVE '01'      NOMAC
X4  C                     ELSE
     C                     MOVE '03'      NOMAC
     C                     MOVE 3         USFAB
F4  C                     END
F3  C                     END
D3  C           IMPINT    IFEQ 3
D4  C           USINT     IFEQ 2
     C                     MOVE 2         USFAB
     C                     MOVE '01'      NOMAC
X4  C                     ELSE
     C                     MOVE '03'      NOMAC
     C                     MOVE 3         USFAB
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
D1  C           SBFE      IFNE *ZEROS
     C           QTEB      DIV  SBFE      QTENET
X1  C                     ELSE
     C           QTEB      DIV  1         QTENET
F1  C                     END
     *
     * typo page B
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
    C           SUIMPS    CABEQ0         DULI23
D2  C           SUIMPS    IFLT 3
     C                     SETON                     68
X2  C                     ELSE
     C                     SETON                     69
F2  C                     END
    C                     GOTO DULI17
F1  C                     END
    C*
D1  C           IMPEXT    IFEQ 3
     C                     Z-ADDSUPEXT    S
     C                     SETON                     69
    C                     GOTO DULI17
X1  C                     ELSE
    C           GENCO1    CABEQ'*'       DULI23
F1  C                     END
     C           DULIA1    TAG
D1  C           IMPINT    IFEQ 3
     C                     Z-ADDSUPINT    S
     C                     SETON                     68
    C                     GOTO DULI17
F1  C                     END
D1  C           RIMPEX    IFEQ 3
     C                     Z-ADDSUPEXT    S
     C                     SETON                     67
    C                     GOTO DULIE
F1  C                     END
D1  C           RIMPIN    IFEQ 3
     C                     Z-ADDSUPINT    S
     C                     SETON                     66
    C                     GOTO DULII
F1  C                     END
D1  C           GENCO1    IFEQ '*'
    C           *IN20     ANDEQ'0'
    C           GENCO2    OREQ '*'
    C           *IN20     ANDEQ'1'
     C           DULI23    TAG
     C                     MOVE 'X'       TYPABC
     C                     Z-ADD*ZEROS    TYPEN
     C                     Z-ADD*ZEROS    TYPCOU
     C                     MOVELDSTYPO    CLEREC
    C                     GOTO DULI19
F1  C                     END
    C                     GOTO DULIV                      FIN GAUFRAGE
     *
     C           DULI17    TAG
D1  C           S         IFLE 3
     C                     MOVE COUEX     TYPCOU
     C                     MOVE ENCEX     TYPEN
D2  C           DDEEX     IFEQ ' '
     C                     MOVE 'B'       TYPABC
X2  C                     ELSE
     C                     MOVE DDEEX     TYPABC
F2  C                     END
X1  C                     ELSE
     C                     MOVE ENCIN     TYPEN
     C                     MOVE COUIN     TYPCOU
D2  C           DDEIN     IFEQ ' '
     C                     MOVE 'B'       TYPABC
X2  C                     ELSE
     C                     MOVE DDEIN     TYPABC
F2  C                     END
F1  C                     END
D1  C           *IN20     IFEQ '0'
D2  C           GENCO1    IFEQ '*'
     C                     Z-ADDS         SUPCXY
D3  C           TYPABC    IFEQ 'A'
     C                     MOVE 'X'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'B'
     C                     MOVE 'Y'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'C'
     C                     MOVE 'Z'       TYPABC
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           GENCO2    IFEQ '*'
     C                     Z-ADDS         SUPCXY
D3  C           TYPABC    IFEQ 'A'
     C                     MOVE 'X'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'B'
     C                     MOVE 'Y'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'C'
     C                     MOVE 'Z'       TYPABC
F3  C                     END
F2  C                     END
F1  C                     END
     C                     MOVELDSTYPO    CLEREC
     *
     C           DULI19    TAG
     * typo page C
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD9         WWS
D1  C           GENCO2    IFEQ '*'
    C           *IN20     ANDEQ'1'
     C                     Z-ADD19        WWS
F1  C                     END
D1  C           AFFIC     IFEQ '1'
     C                     Z-ADD21        WWS
F1  C                     END
D1  C           AFFIC     IFEQ '2'
     C                     Z-ADD22        WWS
F1  C                     END
D1  C           AFFIC     IFEQ '3'
D2  C           *IN20     IFEQ '0'
     C                     Z-ADD21        WWS
X2  C                     ELSE
     C                     Z-ADD22        WWS
F2  C                     END
F1  C                     END
D1  C           AFFIC     IFEQ '4'
D2  C           *IN20     IFEQ '0'
     C                     Z-ADD22        WWS
X2  C                     ELSE
     C                     Z-ADD21        WWS
F2  C                     END
F1  C                     END
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIV
     *
     C                     Z-ADD9         WSS
D1  C           GENCO2    IFEQ '*'
    C           *IN20     ANDEQ'1'
     C                     Z-ADD19        WSS
F1  C                     END
D1  C           AFFIC     IFEQ '1'
     C                     Z-ADD21        WSS
F1  C                     END
D1  C           AFFIC     IFEQ '2'
     C                     Z-ADD22        WSS
F1  C                     END
D1  C           AFFIC     IFEQ '3'
D2  C           *IN20     IFEQ '0'
     C                     Z-ADD21        WSS
X2  C                     ELSE
     C                     Z-ADD22        WSS
F2  C                     END
F1  C                     END
D1  C           AFFIC     IFEQ '4'
D2  C           *IN20     IFEQ '0'
     C                     Z-ADD22        WSS
X2  C                     ELSE
     C                     Z-ADD21        WSS
F2  C                     END
F1  C                     END
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG
D2  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F2  C                     END
D2  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F2  C                     END
D2  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F2  C                     END
D2  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F2  C                     END
F1  C                     END
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C                     GOTO FIN                        -> SUIVI
F1  C                     END
     *
     * typo page D
    C   20                GOTO DULIL
    C           GENCO2    CABEQ'*'       DULIY
     *
D1  C           *IN69     IFEQ '1'
D2  C           RIMPEX    IFEQ 3
     C                     SETON                     67
    C                     GOTO DULIY
F2  C                     END
D2  C           IMPINT    IFNE 3
    C           RIMPIN    CABNE3         DULI18
D3  C           RIMPIN    IFEQ 3
     C                     SETON                     66
    C                     GOTO DULIY
F3  C                     END
F2  C                     END
D2  C           IMPINT    IFEQ 3
     C           DULIY     TAG
    C*                    Z-ADDRETPS     RETPS1
    C*                    Z-ADDREDEC     REDEC1
    C*                    Z-ADDTPSTOT    TPSTO1
    C*                    Z-ADDMOYDEC    MOYDE1
    C*                    Z-ADDROEFF     ROEF1
    C*                    Z-ADDREEFF     REEF1
    C*                    Z-ADDNETPS     NETPS1
    C                     GOTO DULID
F2  C                     END
F1  C                     END
     *
D1  C           *IN69     IFEQ '0'
D2  C           RIMPIN    IFEQ 3
     C                     SETON                     66
    C                     GOTO DULIY
F2  C                     END
D2  C           RIMPEX    IFEQ 3
     C                     SETON                     67
    C                     GOTO DULIY
F2  C                     END
D2  C           RIMPEX    IFNE 3
     C           DULI18    TAG
     C                     ADD  1         I
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
     C                     Z-ADD*ZEROS    SUPCXY
D3  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F3  C                     END
     *
    C                     GOTO DULIW
F2  C                     END
F1  C                     END
     *
     C           DULIZ     TAG
    C*                    ADD  RETPS1    RETPS
    C*                    ADD  REDEC1    REDEC
    C*                    ADD  TPSTO1    TPSTOT
    C*                    ADD  MOYDE1    MOYDEC
    C*                    ADD  NETPS1    NETPS
    C                     GOTO DULIX
     *
     * typo page E
     C           DULID     TAG
     C                     ADD  1         I
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
     C                     Z-ADD*ZEROS    SUPCXY
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
     C                     EXSR RESULT
     *
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
     C           QTEB      DIV  SBFE      QTENET
     C                     MOVE '4'       SECT
     C                     MOVE '1'       SSECT
    C           GPTEST    CABNE' '       DULIV
    C           GENCO2    CABEQ'*'       DULIA1         20
D1  C           *IN67     IFEQ '0'
    C           *IN66     CABEQ'0'       DULIA1         20
    C           *IN66     CABEQ'1'       DULII          20
F1  C                     END
D1  C           *IN67     IFEQ '1'
    C           *IN66     CABEQ'1'       DULII          20
D2  C           *IN66     IFEQ '0'
     C                     SETON                     20
     C           DULIE     TAG
     C                     Z-ADDSUPEXT    S
D3  C           DDEEXR    IFEQ ' '
     C                     MOVE 'B'       TYPABC
X3  C                     ELSE
     C                     MOVE DDEEXR    TYPABC
F3  C                     END
     C                     MOVE COUEXR    TYPCOU
     C                     MOVE ENCEXR    TYPEN
    C                     GOTO DULIF
F2  C                     END
F1  C                     END
     *
     * typo page F
     C           DULIF     TAG
     C                     MOVELDSTYPO    CLEREC
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD9         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIV
     *
     C                     Z-ADD9         WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW    32
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW    32
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG
D2  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F2  C                     END
D2  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F2  C                     END
D2  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F2  C                     END
D2  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F2  C                     END
F1  C                     END
     * typo page H
    C           *IN20     CABEQ'1'       DULIL
D1  C           *IN20     IFEQ '0'
    C           RIMPIN    CABNE3         DULIL
    C           RIMPIN    CABEQ3         DULIY          66
F1  C                     END
     *
     C           DULII     TAG
     C         66          Z-ADDSUPINT    S
D1  C           DDEINR    IFNE ' '
     C                     MOVE DDEINR    TYPABC
X1  C                     ELSE
     C                     MOVE 'B'       TYPABC
F1  C                     END
     C                     MOVE COUINR    TYPCOU
     C                     MOVE ENCINR    TYPEN
D1  C           *IN20     IFEQ '0'
D2  C           GENCO1    IFEQ '*'
     C                     Z-ADDS         SUPCXY
D3  C           TYPABC    IFEQ 'A'
     C                     MOVE 'X'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'B'
     C                     MOVE 'Y'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'C'
     C                     MOVE 'Z'       TYPABC
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           GENCO2    IFEQ '*'
     C                     Z-ADDS         SUPCXY
D3  C           TYPABC    IFEQ 'A'
     C                     MOVE 'X'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'B'
     C                     MOVE 'Y'       TYPABC
F3  C                     END
D3  C           TYPABC    IFEQ 'C'
     C                     MOVE 'Z'       TYPABC
F3  C                     END
F2  C                     END
F1  C                     END
     *
     * typo page I
     C                     MOVELDSTYPO    CLEREC
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD9         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIV
     *
     C                     Z-ADD9         WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW    32
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW    32
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG
D2  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F2  C                     END
D2  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F2  C                     END
D2  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F2  C                     END
D2  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F2  C                     END
F1  C                     END
     * typo page K
     C           DULIL     TAG
     C                     ADD  1         I
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
     C                     Z-ADD*ZEROS    SUPCXY
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIV
    C           *IN20     CABEQ'0'       DULIX
    C           *IN20     CABEQ'1'       DULIZ
     *
     C           DULIW     TAG
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIV
     C           DULIX     TAG
     C                     EXSR RESULT                     CHAR.RESULTATS
     *
     C           DULIV     TAG
     C                     MOVE USINE     USFAB
     C                     Z-ADD1         I
    C*
    C           CCOL      CABEQ1         FACO9            SECT.C/COLLAGE
    C           CCOL      CABEQ5         FACO9                 "
    C           CCOL      CABEQ4         FACO11           COMPLEXAGE SOF
    C           CCOL      CABEQ7         FACO11                "     SOF
    C           CCOL      CABEQ9         FACO7            SECT.ONDULATION
    C           CCOL      CABEQ2         FACO7            SECT.ONDULATION
    C           CCOL      CABEQ3         FACO7            SECT.ONDULATION
    C           CCOL      CABEQ6         FACO7            CC/OND + CC ION
D1  C           CCOL      IFEQ 8
D2  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F2  C                     END
D2  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F2  C                     END
    C                     GOTO FACO7                      SECT.ONDULATION
F1  C                     END
D1  C           CCOL      IFEQ 0                                      ION
D2  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F2  C                     END
D2  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F2  C                     END
    C           ONDUL     CABEQ7         FACO7
D2  C           *IN77     IFEQ '1'
    C                     GOTO FACO12                     COMPLEXAGE CXH
F2  C                     END
D2  C           FMASL     IFNE *ZEROS
    C           IMPEXT    ANDEQ*ZERO
    C                     GOTO FACO13                     MASSICOT FACON
F2  C                     END
D2  C           IMPEXT    IFEQ 0
    C           IMPINT    ANDEQ0
    C           APPEX     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FACON
F2  C                     END
    C           PELLI     CABEQ'*'       FACO25           PELLICULEUSE
    C           CODDOR    CABEQ'*'       FACO26           DORURE
    C                     GOTO DULIFI                     FIN --> IMP.
F1  C                     END
     C/SPACE 2
     * section contre-collage .
     C           FACO9     TAG
D1  C           FIOND     IFNE *BLANKS
    C           FIONDT    ANDEQ*BLANK
     C                     MOVE 'C'       FIONDT  1
    C                     GOTO FACO21
F1  C                     END
     C                     SETOF                     20
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
D2  C           FACON     IFEQ 4
     C                     MOVELDECH      LONGML
X2  C                     ELSE
     C                     MOVELONDH      LONGML
F2  C                     END
     C           QTENES    MULT LONGML    QTENET
     C                     Z-ADDCCOL      COCOL
    C                     GOTO DULI20
F1  C                     END
     * contre-collage page A
     C                     Z-ADDUSINE     USFAB
     C                     ADD  1         R
     C                     MOVE '3'       SECT
     C                     MOVE '1'       SSECT
     C                     Z-ADD1         I
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
    C           FACON     CABNE4         SUIT37
     C                     MOVELSBDEC     SBDE    76
     C           QTEB      DIV  SBDE      QTENET
     C                     MOVELDECH      LONGML
    C                     GOTO SUIT38
     C           SUIT37    TAG
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVELONDH      LONGML  43
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C           SUIT38    TAG
     C           QTENET    MULT LONGML    QTENET    H
     C                     Z-ADDCCOL      COCOL   10
     * contre-collage page B
    C* ordonnancement
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSCOL     USFAB
D2  C           MACOL1    IFNE *ZEROS
     C                     MOVE MACOL1    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI21
     C                     MOVE NOMAC1    NOMAC
F2  C                     END
X1  C                     ELSE
    C* TARIF COMMERCIAL
     C                     Z-ADD2         USFAB
D2  C           CCOL      IFEQ 5
     C                     MOVE '08'      NOMAC
X2  C                     ELSE
     C                     MOVE '08'      NOMAC
F2  C                     END
F1  C                     END
     *
     C           DULI20    TAG
     C                     MOVE COCOL     COLCOL
     C                     MOVE ONDUL     COLON
     C                     MOVE COUPR     COLCOU
     *
     * contre-collage page C
     C                     MOVELDSCCOL    CLEREC
     C                     Z-ADD8         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULI21
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C                     Z-ADD8         WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     * contre-collage page E
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
D1  C           FACON     IFEQ 4
     C                     MOVELDECL      LARGML
X1  C                     ELSE
     C                     MOVELONDL      LARGML  43
F1  C                     END
     C           REDEC     MULT LARGML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI21
     *
     * contre-collage page F
     C                     EXSR RESULT                     CHAR.RESULTATS
     C           DULI21    TAG
D1  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F1  C                     END
D1  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F1  C                     END
    C           PELLI     CABEQ'*'       FACO25
    C           CODDOR    CABEQ'*'       FACO26           DORURE
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXAGE CXH
F1  C                     END
D1  C           FORL      IFNE *ZEROS
D2  C           IMPEXT    IFEQ *ZERO
    C           APPEX     ANDEQ'B'
    C           IMPINT    OREQ *ZERO
    C           APPIN     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FAC
F2  C                     END
D2  C           FMASL     IFNE *ZEROS
    C           IMPEXT    ANDEQ*ZERO
    C           IMPINT    ANDEQ*ZERO
    C                     GOTO FACO13                     MASSICOT FACON
F2  C                     END
X1  C                     ELSE
D2  C           IMPEXT    IFEQ 1
    C           IMPINT    OREQ 1
    C                     GOTO FACO14                     COUPEUSE FAC
F2  C                     END
F1  C                     END
    C                     GOTO DULIFI                     FIN ---> IMP
     C/SPACE 2
     * section ondulation .
     C           FACO7     TAG
D1  C           FIOND     IFNE *BLANKS
    C           FIONDT    ANDEQ*BLANK
     C                     MOVE 'O'       FIONDT  1
    C                     GOTO FACO21
F1  C                     END
     C                     Z-ADD0         PARFUM  50
     C                     SETOF                     50
    C* 2° PASSAGE ONDULEUSE
    C*-------------------------
     C                     MOVE *BLANK    OND2P
D1  C           FACON     IFEQ 1                          ROULEAUX
    C           CCOL      ANDEQ2                          SIMPLE FACE
    C           DECH      ANDLE10                         - DE 10 M
    C           FACON     OREQ 2                          BOBINETTES
    C           CCOL      ANDEQ2                          SIMPLE FACE
    C           DECH      ANDLE10                         - DE 10 M
    C           FACON     OREQ 2                          BOBINETTES
    C           CCOL      ANDEQ2                          SIMPLE FACE
    C           ONDUL     ANDEQ6                          MINI MICRO
     C                     MOVE '*'       OND2P   1
F1  C                     END
D1  C           OND2P     IFEQ '*'
D2  C           GRAMS3    IFGE 300                        PRE IMP
    C           GRAMS5    ORGE 300                        > 300
     C                     MOVE ' '       OND2P
F2  C                     END
F1  C                     END
     * ondulation page A
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDQTENES    QTEB
D2  C           LUTIL     IFEQ *ZEROS
     C                     MOVELLMINI     LAIZML
X2  C                     ELSE
     C                     MOVELLUTIL     LAIZML
F2  C                     END
     * ondulation page B'
D2  C           UVENT     IFEQ 1
    C           FACON     ANDEQ9
    C           UVENT     OREQ 1
    C           FACON     ANDEQ4
    C           UVENT     OREQ 5
    C           FACON     ANDEQ9
    C           UVENT     OREQ 5
    C           FACON     ANDEQ4
    C           UVENT     OREQ 3
     C                     Z-ADDQTENES    QTENET
    C                     GOTO DULI27
F2  C                     END
    C*
D2  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C                     MOVELONDH      L       43
     C           LALAIZ    SUB  ACOTE     RESTE
     C           RESTE     DIV  ONDL      NBR
D3  C           ACOTE     IFNE *ZEROS
     C                     ADD  1         NBR
F3  C                     END
     C           QTENES    DIV  NBR       QTENET
     C           QTENET    MULT L         QTENET
X2  C                     ELSE
     C           SUFAB     DIV  LAIZML    QTENET
F2  C                     END
    C                     GOTO DULI27
F1  C                     END
     * ondulation page A (SUITE)
D1  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
    C           FACON     CABEQ1         DULI25
    C           COUPR     CABEQ'R'       DULI25
    C                     GOTO DULI26
X1  C                     ELSE
    C           CCOL      CABEQ8         DULI26
    C           CCOL      CABEQ1         DULI26
    C                     GOTO DULI25
F1  C                     END
     C           DULI25    TAG
     C                     Z-ADD1         I
     C                     ADD  1         R
     C                     MOVE '2'       SECT
     C                     MOVE '1'       SSECT
     * ondulation page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C/SPACE 1
D1  C           DSGP      IFEQ 'AB'
D2  C           ACOTE     IFNE 0                             O
     C                     ADD  1         NBR                 B   P
F2  C                     END                                J   R
     C           QTENES    DIV  NBR       QTENET              E   O
D2  C           TOTDE     IFNE *ZEROS
     C           QTENET    MULT TOTDE     QTENET              C   D
F2  C                     END
D2  C           UVENT     IFEQ 1                             T   U
     C           QTENET    MULT 0,001     ZQ      73          I   C
X2  C                     ELSE                               F   T
D3  C           UVENT     IFEQ 5                             T   U
     C           QTENET    MULT 1         ZQ                  I   C
X3  C                     ELSE                               F   T
     C           QTENET    MULT 0,01      ZQ                      I
F3  C                     END                                    O
F2  C                     END                                    O
     C           SUVENT    MULT ZQ        SUFAB                   N
F1  C                     END
     C/SPACE 1
D1  C           LUTIL     IFEQ *ZEROS
     C                     MOVELLMINI     LAIZML  32
X1  C                     ELSE
     C                     MOVELLUTIL     LAIZML
F1  C                     END
D1  C           FACON     IFEQ 4
D2  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
X2  C                     ELSE
D3  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C           QTFAB     MULT ROUDEC    QTENET
X3  C                     ELSE
D4  C           UVENT     IFEQ 2
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     MOVELSBDEC     SBZ     76
     C           QTEB      DIV  SBZ       QTENET    H
X4  C                     ELSE
    C                     GOTO DULI51
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           FACON     IFNE 4
     C           DULI51    TAG
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C           QTEB      DIV  LAIZML    QTENET    H
F1  C                     END
     * ondulation page C
    C* TARIF COMMANDE
D1  C           CDE       IFEQ 1
     *
D2  C           ONDUL     IFEQ 4
    C*                    MOVE '11'      NOMAC            TMAFBU 23/06/14
     C                     MOVE '10'      NOMAC
     C                     Z-ADD3         USFAB
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           ONDUL     IFEQ 7
     C                     MOVE '09'      NOMAC
     C                     Z-ADD3         USFAB
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           CCOL      IFEQ 1
    C           CCOL      OREQ 3
     C                     MOVE '10'      NOMAC
     C                     Z-ADD3         USFAB
    C*          USINE     IFEQ 5
D3  C           GRAOND    IFGT 320
    C*                    MOVE '11'      NOMAC            TMAFBU 23/06/14
     C                     MOVE '10'      NOMAC
     C                     Z-ADD3         USFAB
F3  C                     END
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           CCOL      IFEQ 2
    C           ONDUL     ANDNE3
     C                     Z-ADD3         USFAB
     C                     MOVE '48'      NOMAC
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           CCOL      IFEQ 2
    C           ONDUL     ANDEQ3
     C                     MOVE '03'      NOMAC
     C                     Z-ADD3         USFAB
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           CCOL      IFEQ 9
    C*                    MOVE '11'      NOMAC            TMAFBU 23/06/14
     C                     MOVE '10'      NOMAC
     C                     Z-ADD3         USFAB
    C                     GOTO DULI27
F2  C                     END
     *
D2  C           ONDUL     IFEQ 0
D3  C           FACON     IFEQ 1
     C                     Z-ADD3         USFAB
     C                     MOVE '48'      NOMAC
    C                     GOTO DULI27
F3  C                     END
D3  C           COUPR     IFEQ 'R'
     C                     Z-ADD2         USFAB
     C                     MOVE '03'      NOMAC
     C                     MOVE '1'       SECT
     C                     MOVE '3'       SSECT
     C                     SETON                     68
     C                     Z-ADDLMINI     JAGLAI
     C                     Z-ADDONDH      JAGDEV
     C                     Z-ADDGRAM,3    JAGGRA
     C                     MOVELDSJAGE    CLEREC
    C*                    MOVE '1'       HECOUP
    C                     GOTO DULI22
F3  C                     END
F2  C                     END
    C*
    C                     GOTO MSG16
F1  C                     END
    C* ordonnancement
     C                     Z-ADDUSINE     USFAB
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D2  C           USOND     IFNE *ZEROS
     C                     Z-ADDUSOND     USFAB
F2  C                     END
D2  C           MAOND1    IFNE *ZEROS
     C                     MOVE MAOND1    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI26
     C                     MOVE NOMAC1    NOMAC
D3  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
    C           COUPR     ANDEQ'R'
     C                     Z-ADD2         USFAB
     C                     MOVE '03'      NOMAC
     C                     MOVE '1'       SECT
     C                     MOVE '3'       SSECT
     C                     SETON                     68
     C                     Z-ADDLMINI     JAGLAI
     C                     Z-ADDONDH      JAGDEV
     C                     Z-ADDGRAM,3    JAGGRA
     C                     MOVELDSJAGE    CLEREC
    C*                    MOVE '1'       HECOUP
    C                     GOTO DULI22
F3  C                     END
    C                     GOTO DULI27
F2  C                     END
F1  C                     END
     *
     * ondulation page E
     C           DULI27    TAG
     C                     MOVE CCOL      ONDCOL
     C                     MOVE ONDUL     ONDOND
     C                     MOVE FACON     ONDFAC
     C                     MOVE COUPR     ONDCOU
     C                     MOVE GRAOND    ONDGRA
     C                     MOVELDSOND     CLEREC
     C           DULI22    TAG
     *
     * ondulation page F
     C                     Z-ADD7         WWS
     C                     EXSR NORSTD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULI26
     *
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 3
D2  C           PAPI,3    IFEQ 'KBI'
    C           PAPI,4    ANDEQ'KBI'
    C           PAPI,5    ANDEQ'KBI'
D3  C           GRAM,3    IFEQ 72
    C           GRAM,3    OREQ 90
    C           GRAM,3    OREQ 80
    C           GRAM,4    ANDEQ72
    C           GRAM,4    OREQ 90
    C           GRAM,4    OREQ 80
    C           GRAM,5    ANDEQ72
    C           GRAM,5    OREQ 90
    C           GRAM,5    OREQ 80
     C                     Z-ADD*ZEROS    TPSRE
     C                     Z-ADD*ZEROS    TPSNE
     C                     Z-ADD*ZEROS    TOTTPS
     C                     Z-ADDPARFON    PARFUM
D4  C           MACDEC    IFEQ 'B'
     C                     ADD  PARFDE    PARFUM
F4  C                     END
D4  C           TYPOPR    IFEQ 'B'
     C                     EXSR TYPOLB
F4  C                     END
    C                     GOTO DULI46
F3  C                     END
F2  C                     END
F1  C                     END
    C           *IN50     CABEQ'1'       XXXXXX
D1  C           FACON     IFEQ 1                          ROULEAUX
    C           CCOL      ANDEQ2                          SIMPLE FACE
    C           DECH      ANDLE10                         + DE 25 M
     C                     Z-ADD*ZEROS    TPSRE
     C                     Z-ADD*ZEROS    TPSNE
     C                     Z-ADD*ZEROS    TOTTPS
    C                     GOTO DULI46
F1  C                     END
    C*
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C           DULI46    TAG
     C                     Z-ADD7         WSS     20
D1  C           OND2P     IFEQ ' '                        PAS 2 PASSAGES
    C           OND2P     OREQ '*'                        2 PASSAGES
    C           POND2     ANDEQ'*'                        ET 2° PASSAGE
     C                     EXSR KOEFF                      PONDERATION
F1  C                     END
     * ondulation page H
     C           XXXXXX    TAG
    C*
D1  C           NOMAC     IFEQ '10'                       TEMPS MINI
    C           USFAB     ANDEQ3                          DE 6 MN
    C           TPSTOT    ANDLT0,10
    C* TMAFBU 25/07/2016
D2  C           W         IFGT 0
    C           W         ANDLE14
    C           ROC,W     CABEQ99999     XXXXX1
F2  C                     END
     C                     Z-ADD0,10      TPSTOT
     C           QTENET    DIV  TPSTOT    MOYCAD    H
F1  C                     END
    C*
     C           XXXXX1    TAG
D1  C           *IN50     IFEQ '1'
     C                     Z-ADDTPSDD     TPSTOT
     C                     Z-ADDRETPDD    RETPS
D2  C           TPSTOT    IFNE *ZEROS
     C           QTENET    DIV  TPSTOT    MOYCAD    H
X2  C                     ELSE
     C                     MOVELMOYCDD    MOYCAD
F2  C                     END
     C                     Z-ADDNETPDD    NETPS
F1  C                     END
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C  N50                WRITEPLANIFF1
D1  C           DSGP      IFEQ 'SU'                       -> SUIVI
D2  C           CCOL      IFNE 9
    C           *IN50     OREQ '1'
    C                     GOTO FIN
F2  C                     END
F1  C                     END
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     C                     Z-ADDUSFAB     USFXX   10
D1  C           *IN50     IFEQ '1'
     C                     Z-ADD3         USFAB
     C                     MOVE '12'      NOMAC
F1  C                     END
     C                     EXSR VALORI                     VALORISATION
     C                     SETOF                     68
     C                     Z-ADDUSFXX     USFAB
    C           GPTEST    CABNE' '       DULI26
D1  C           CCOL      IFEQ 9
D2  C           *IN50     IFEQ '1'
     C                     MOVELDDHNZ     MOYDEC
     C                     Z-ADDROEFFD    ROEFF
     C                     MOVE NOMXX     NOMAC
X2  C                     ELSE
     C                     MOVE NOMAC     NOMXX   2
     C                     SETON                     50
     C                     Z-ADDTPSTOT    TPSDD   62
     C                     Z-ADDRETPS     RETPDD  42
     C                     Z-ADDNETPS     NETPDD  42
     C                     Z-ADDROEFF     ROEFFD  20
     C                     MOVELMOYDEC    DDHNZ   44
     C                     Z-ADDMOYCAD    MOYCDD  60
D3  C           DSGP      IFEQ 'SU'
    C           USFAB     ANDEQ5
    C           DSGP      OREQ 'OR'
    C           USFAB     ANDEQ5
    C           DSGP      OREQ 'OB'
    C           USFAB     ANDEQ5
     C                     MOVE '02'      NOMAC
X3  C                     ELSE
     C                     MOVE '12'      NOMAC
F3  C                     END
    C                     GOTO DULI27
F2  C                     END
F1  C                     END
    C*
     C                     EXSR RESULT                     CHAR.RESULTATS
    C*
    C* 2° PASSAGE ONDULEUSE
    C*-------------------------
D1  C           OND2P     IFEQ '*'
    C           POND2     ANDEQ*BLANKS
     C                     Z-ADD2         I
     C                     MOVE '*'       POND2   1
     C                     Z-ADD3         USFAB
     C                     MOVE '2'       SECT
     C                     MOVE '1'       SSECT
D2  C           TYPE      IFEQ 'D'
    C           TYPE      OREQ 'S'
     C                     MOVE '48'      NOMAC
X2  C                     ELSE
     C                     MOVE '48'      NOMAC
F2  C                     END
     C                     MOVE '0'       ONDCOL
     C                     MOVE '0'       ONDOND
     C                     MOVE FACON     ONDFAC
     C                     MOVE ' '       ONDCOU
     C                     MOVE '000'     ONDGRA
     C                     MOVELDSOND     CLEREC
    C                     GOTO DULI22
F1  C                     END
     C                     MOVE ' '       POND2
     C                     Z-ADD0         I
     C                     MOVE *BLANK    OND2P
    C*
    C                     GOTO DULI26
    C*
     C           MSG16     TAG                             * * * * * *
     C                     Z-ADD1         A                *         *
     C           *ZEROS    LOKUPERR1,A                   80*  MSG.16 *
     C   80                Z-ADD16        ERR1,A           *         *
     C   80                MOVE USFAB     ERR2,A           * * * * * *
     C           DULI26    TAG
D1  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F1  C                     END
D1  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F1  C                     END
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXE CXH
F1  C                     END
    C           PELLI     CABEQ'*'       FACO25
    C           CODDOR    CABEQ'*'       FACO26           DORURE
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section gaufrage avant ondulation / contre collage
     C           FACO10    TAG
     * gaufrage page A
    C           GFRA      CABEQ' '       DULIFI
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSGAU     USFAB
X1  C                     ELSE
D2  C           DSGP      IFNE 'SU'
     C                     Z-ADD2         USFAB
F2  C                     END
F1  C                     END
     C                     ADD  1         R
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
D2  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
D3  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X3  C                     ELSE
     C                     MOVE '20'      NOMAC
F3  C                     END
X2  C                     ELSE
D3  C           MAGAU1    IFNE *ZEROS
     C                     MOVE MAGAU1    NOMAC
X3  C                     ELSE
D4  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X4  C                     ELSE
     C                     MOVE '20'      NOMAC
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVE GFRA      SPGA
     C                     Z-ADD0         SPOND
     C                     Z-ADD0         SPCC
     C                     MOVE *BLANKS   SPDEC
     C                     Z-ADD0         SPPOSE
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     SPPOSE
X1  C                     ELSE
     C                     MOVE POSFO     SPPOSE
F1  C                     END
D1  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    SPPOSE
F1  C                     END
     C                     MOVELDSAUTO    CLEREC
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD6         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     Z-ADD*ZEROS    TOTTPS
     C                     Z-ADD*ZEROS    DECR
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     SETOF                     90
     C                     Z-ADD6         WSS     20
     C                     EXSR KOEFF
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     MOVE GFRA      GAUF
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     * gaufrage page B
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHRG.RESULTATS
F1  C                     END
     C                     MOVE *BLANKS   GAUF
    C           PELLI     CABEQ'*'       FACO25
    C           CODDOR    CABEQ'*'       FACO26           DORURE
D1  C           CCOL      IFEQ 4                                      ION
    C           CCOL      OREQ 7                                      ION
    C                     GOTO FACO11                     COMPLEXAGE SOF
F1  C                     END
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXE CXH
F1  C                     END
D1  C           FORL      IFNE *ZEROS
D2  C           IMPEXT    IFEQ *ZERO
    C           APPEX     ANDEQ'B'
    C           IMPINT    OREQ *ZERO
    C           APPIN     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FAC
F2  C                     END
F1  C                     END
D1  C           FACON     IFEQ 0
    C           MASSI     ANDEQ'*'
    C                     GOTO FACO24                     AFFICHE EN DEUX
F1  C                     END
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section complexage
     C           FACO11    TAG
     C           FACO12    TAG
     C                     SETOF                     20
     C                     Z-ADD0         INN72   10
     C                     Z-ADD0         INN73   10
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
D2  C           FLPEAP    IFNE *ZEROS                     PELLICULEUSE
     C                     Z-ADDQTENES    QTENET
D3  C           IAEI2     IFEQ 'O'
     C           FHPEAP    DIV  1000      LAIZML
X3  C                     ELSE
     C           FLPEAP    DIV  1000      LAIZML
F3  C                     END
X2  C                     ELSE
     C                     MOVELLMINI     LAIZML           COMPLEXEUSE
D3  C           NOMAC     IFEQ '07'
    C           NOMAC     OREQ '08'
     C           DECH      DIV  1000      DECHM
     C           DECL      DIV  1000      DECLM   43
D4  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
D5  C           FACON     IFEQ 4
D6  C           LAIZML    IFNE *ZEROS
     C           LAIZML    DIV  DECLM     Z1M     10
D7  C           Z1M       IFGE 2
     C           DECHM     DIV  Z1M       DECHM
F7  C                     END
F6  C                     END
X5  C                     ELSE
     C           ONDH      DIV  1000      DECHM   43
F5  C                     END
     C           QTENES    MULT DECHM     QTENET
X4  C                     ELSE
D5  C           UVENT     IFEQ 4
    C           FACON     ANDEQ4
     C           QTENES    MULT DECHM     QTENET
X5  C                     ELSE
     C           SUFAB     DIV  LAIZML    QTENET
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDQTENES    QTENET
F3  C                     END
F2  C                     END
D2  C           QTENET    IFEQ *ZEROS
    C           QTENES    ANDNE*ZEROS
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     C                     Z-ADDQTENES    QTEB
    C                     GOTO DULI80
F1  C                     END
     * complexage SOF
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     SETOF                     5253
     C                     Z-ADD2         USFAB
     C                     ADD  1         R
     C                     MOVE '2'       SECT
     C                     MOVE '2'       SSECT
    C*
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
    C*
D2  C           FLPEAP    IFNE *ZEROS                     PELLICULEUSE
     C           FLPEAP    MULT FHPEAP    SFEAP1  82
     C           SFEAP1    DIV  10000     SBFEAP  76
D3  C           IAEI2     IFEQ 'O'
     C           FHPEAP    DIV  1000      LAIZML
X3  C                     ELSE
     C           FLPEAP    DIV  1000      LAIZML
F3  C                     END
    C*          QTEB      DIV  SBFEAP    QTENET
     C           QTEB      DIV  LAIZML    QTENET
     C                     MOVE '08'      NOMAC
X2  C                     ELSE
     C                     MOVELLMINI     LAIZML           COMPLEXEUSE
     C           QTEB      DIV  LAIZML    QTENET
    C*
D3  C           FACON     IFEQ 1
     C                     MOVE '06'      NOMAC
X3  C                     ELSE
     C                     MOVE '07'      NOMAC
F3  C                     END
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'AB'
D3  C           FACON     IFEQ 1
     C                     Z-ADDQTENES    QTENET
X3  C                     ELSE
     C           DECH      DIV  1000      DECHM
     C           DECL      DIV  1000      DECLM
D4  C           LAIZML    IFNE *ZEROS
     C           LAIZML    DIV  DECLM     Z1M     10
D5  C           Z1M       IFGE 2
     C           DECHM     DIV  Z1M       DECHM
F5  C                     END
F4  C                     END
     C           QTENES    MULT DECHM     QTENET
F3  C                     END
F2  C                     END
     * complexage page C & D
     C           DULI80    TAG
     C                     MOVE CCOL      COMCOL
     C                     MOVE COLRH     COMCLL
     C                     MOVE *BLANK    COMIMP
     C                     MOVE *BLANK    COMCOU
D2  C           IMPEXT    IFEQ 3
    C           IMPINT    OREQ 3
    C           IMPEXT    OREQ 5
    C           IMPINT    OREQ 5
     C                     MOVE 'O'       COMIMP
F2  C                     END
D2  C           COUPEX    IFEQ 'R'
    C           COUPIN    OREQ 'R'
     C                     MOVE 'R'       COMCOU
F2  C                     END
D2  C           CCOL      IFEQ 4
     C                     Z-ADDGRAM,3    COMGR
X2  C                     ELSE
D3  C           GRAM,3    IFGE GRAM,4
     C                     Z-ADDGRAM,3    COMGR
X3  C                     ELSE
     C                     Z-ADDGRAM,4    COMGR
F3  C                     END
F2  C                     END
     *
     * complexage page E
     C                     MOVELDSCOMP    CLEREC
     C                     Z-ADD5         WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD5         WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
D3  C           NOPRO     IFGT 8000
D4  C           TOTTPS    IFNE *ZEROS
     C                     Z-ADDTOTTPS    TPSTOT
     C                     Z-ADDCADMOY    MOYCAD
F4  C                     END
D4  C           DECR      IFNE 0
     C                     Z-ADDDECR      REDEC
F4  C                     END
D4  C           TPSRE     IFNE *ZEROS
     C                     Z-ADDTPSRE     RETPS
F4  C                     END
D4  C           TPSNE     IFNE *ZEROS
     C                     Z-ADDTPSNE     NETPS
F4  C                     END
F3  C                     END
F2  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     * complexage page F
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
     *
D2  C           FLPEAP    IFNE *ZEROS                     PELLICULAGE
D3  C           APPEX     IFEQ 'B'
    C           APPIN     OREQ 'B'
    C                     GOTO FACO14                     MISE AU FORMAT
F3  C                     END
F2  C                     END
     *
    C                     GOTO DULIFI
     * complexage CXH
X1  C                     ELSE
D2  C           *IN88     IFEQ '0'                        1° FOIS
     C                     SETON                     88
     C           RAPDEC    ADD  DECROU    ROUDEC
     C                     Z-ADDROUDEC    RAPFAC  54
X2  C                     ELSE
     C                     Z-ADDRAPFAC    ROUDEC
F2  C                     END
D2  C           *IN85     IFEQ '1'                        1° FOIS
     C                     Z-ADDROUL      ROULCO  54
X2  C                     ELSE
     C                     Z-ADDROULCO    ROUL
F2  C                     END
    C*
     C                     Z-ADD*ZEROS    SCOMIN
D2  C           *IN73     IFEQ '0'
    C           *IN72     ANDEQ'0'
    C*
D3  C           *IN77     IFEQ '1'                        EXTERIEUR
D4  C           IMPEXT    IFEQ 0
    C           IMPEXT    OREQ 1
    C           APIECX    ANDEQ'O'
    C           IMPEXT    OREQ 2
    C           APIECX    ANDEQ'O'
     C                     SETON                     75    APRES IMP
X4  C                     ELSE
     C                     SETON                     72    AVANT IMP
F4  C                     END
F3  C                     END
    C*
D3  C           *IN76     IFEQ '1'                        INTERIEUR
D4  C           IMPINT    IFEQ 0
    C           IMPINT    OREQ 1
    C           APIICX    ANDEQ'O'
    C           IMPINT    OREQ 2
    C           APIICX    ANDEQ'O'
     C                     SETON                     74    APRES IMP
X4  C                     ELSE
     C                     SETON                     73    AVANT IMP
F4  C                     END
F3  C                     END
    C*
D3  C           *IN75     IFEQ '0'
    C           *IN74     ANDEQ'0'
    C                     GOTO MODULJ
F3  C                     END
F2  C                     END
    C*
     C                     Z-ADD2         USFAB
     C                     MOVE '2'       SSECT
     C                     MOVE '2'       SECT
D2  C           FLPEAP    IFNE *ZEROS                     PELLICULEUSE
D3  C           IAEI2     IFEQ 'O'
     C           FHPEAP    DIV  1000      LCXH
X3  C                     ELSE
     C           FLPEAP    DIV  1000      LCXH
F3  C                     END
X2  C                     ELSE                            COMPLEXEUSE
D3  C           LMINI     IFNE *ZEROS
     C           LMINI     DIV  100       LCXH    43
X3  C                     ELSE
D4  C           ONDL      IFNE *ZEROS
     C           ONDL      DIV  1000      LCXH
X4  C                     ELSE
     C           DECL      DIV  1000      LCXH
F4  C                     END
F3  C                     END
F2  C                     END
     C           DULI94    TAG
    C*
D2  C           *IN75     IFEQ '1'                        FACONNAGE
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
D3  C           *IN75     IFEQ '1'                        EXTERIEUR
D4  C           IMPEXT    IFEQ 4
     C                     Z-ADD50        PRIORI
X4  C                     ELSE
D5  C           IMPEXT    IFEQ 0
    C           IMPEXT    OREQ 3
    C           IMPEXT    OREQ 5
     C                     Z-ADD72        PRIORI
X5  C                     ELSE
     C                     Z-ADD68        PRIORI
F5  C                     END
F4  C                     END
     C                     Z-ADDNBPECX    POCXH   10
     C                     MOVE CPECXH    COUCXH  1
     C                     MOVE APPEX     API     1
D4  C           CCOL      IFEQ 9
    C           CCOL      OREQ 6
     C                     Z-ADD2         S
X4  C                     ELSE
     C                     Z-ADD3         S
F4  C                     END
X3  C                     ELSE                            INTERIEUR
D4  C           IMPINT    IFEQ 4
     C                     Z-ADD20        PRIORI
X4  C                     ELSE
D5  C           IMPINT    IFEQ 0
    C           IMPEXT    OREQ 3
    C           IMPEXT    OREQ 5
     C                     Z-ADD71        PRIORI
X5  C                     ELSE
     C                     Z-ADD38        PRIORI
F5  C                     END
F4  C                     END
     C                     Z-ADDNBPICX    POCXH
     C                     MOVE CPICXH    COUCXH
     C                     MOVE APPIN     API
D4  C           CCOL      IFEQ 9
    C           CCOL      OREQ 6
     C                     Z-ADD6         S
X4  C                     ELSE
D5  C           PAPI,5    IFNE *BLANKS
     C                     Z-ADD5         S
X5  C                     ELSE
     C                     Z-ADD4         S
F5  C                     END
F4  C                     END
F3  C                     END
X2  C                     ELSE                            IMPRESSION
D3  C           SUIMP     IFLE 3                          EXTERIEUR
D4  C           IMPEXT    IFEQ 4
     C                     Z-ADD50        PRIORI
X4  C                     ELSE
     C                     Z-ADD52        PRIORI
F4  C                     END
     C                     Z-ADDNBPECX    POCXH   10
     C                     MOVE CPECXH    COUCXH  1
     C                     MOVE APPEX     API     1
D4  C           CCOL      IFEQ 9
     C                     Z-ADD2         S
X4  C                     ELSE
     C                     Z-ADD3         S
F4  C                     END
X3  C                     ELSE                            INTERIEUR
D4  C           IMPINT    IFEQ 4
     C                     Z-ADD20        PRIORI
X4  C                     ELSE
     C                     Z-ADD21        PRIORI
F4  C                     END
     C                     Z-ADDNBPICX    POCXH
     C                     MOVE CPICXH    COUCXH
     C                     MOVE APPIN     API
D4  C           CCOL      IFEQ 9
     C                     Z-ADD6         S
X4  C                     ELSE
D5  C           PAPI,5    IFNE *BLANKS
     C                     Z-ADD5         S
X5  C                     ELSE
     C                     Z-ADD4         S
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     C                     Z-ADDS         SUPCXY
     C                     MULT POCXH     LCXH
    C* SI EMPLOI BOBINEUSE REFENDEUSE
D2  C           POCXH     IFGT 1
    C           FORL      ANDEQ0
D3  C           LMINI     IFNE 0
    C           LMINI     OREQ 0
    C           FACON     ANDLE2
D4  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
     C                     ADD  1         R
     C           RAPDEC    ADD  DECROU    ROUDEC
     C                     MOVE '09'      NOMAC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
     C           QTEB      MULT LCXH      QTENET
     C                     Z-ADDLMINI     BOBILA
     C                     Z-ADDPOCXH     BOBIPO
     C                     Z-ADDGRAM,S    BOBIGR
     C                     MOVELDSBOBI    CLEREC
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D5  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F5  C                     END
    C           GPTEST    CABNE' '       DULIFI
D5  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F5  C                     END
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LAIZML    REGM2     H
D5  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
     C                     WRITEPLANIFF1
     C                     ADD  DECRO     DECROU
     C                     ADD  REGM2     SUREG
X5  C                     ELSE
     C                     WRITEPLAIMPF1
     C                     ADD  DECRO     ROUL
     C                     ADD  REGM2     SURIMP
F5  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D5  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F5  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI92
     C                     EXSR RESULT                     CHAR.RESULTATS
F4  C                     END
F3  C                     END
F2  C                     END
     C                     ADD  1         R
    C*
     C           CLEPRE    SETLLCXHLIGL2
     C           CLEPRE    READECXHLIGL2                 80
     C           DULI93    TAG
    C           *IN80     CABEQ'1'       DULI92
     C                     Z-ADDPASCXH    I
     C                     MOVE *BLANK    COMIMP
     C                     MOVE *BLANK    COMCOU
D2  C           I         IFEQ 3
     C           TOTGR3    ADD  TOTGR2    COMGR
     C                     ADD  TOTGR1    COMGR
F2  C                     END
D2  C           I         IFEQ 2
     C           TOTGR3    ADD  TOTGR2    COMGR
F2  C                     END
D2  C           I         IFEQ 1
     C                     Z-ADDTOTGR1    COMGR
F2  C                     END
D2  C           TRACXH    IFEQ 'C'
     C                     Z-ADD7         COMCOL
     C                     MOVE 'C'       CXHTRA
X2  C                     ELSE
     C                     Z-ADD4         COMCOL
     C                     MOVE 'E'       CXHTRA
F2  C                     END
D2  C           SUPCXH    IFEQ 'F'
     C                     MOVELQUACXH    COMCLL
F2  C                     END
D2  C           *IN73     IFEQ '0'
    C           COCXE,I   ANDNE0
     C                     MOVE 'O'       COMIMP
F2  C                     END
     *
D2  C           S         IFLE 3
     C                     MOVE PELE      PEL     3
X2  C                     ELSE
     C                     MOVE PELI      PEL
F2  C                     END
    C*
D2  C           PEL       IFEQ 'PEL'
     C                     MOVE '08'      NOMAC
X2  C                     ELSE
    C*
D3  C           *IN71     IFEQ '1'
     C                     MOVE '06'      NOMAC
X3  C                     ELSE
D4  C           FORL      IFNE *ZEROS
    C           API       ANDNE*BLANK
     C                     MOVE '07'      NOMAC
X4  C                     ELSE
D5  C           LMINI     IFNE *ZEROS
    C           LMINI     OREQ *ZEROS
    C           FACON     ANDEQ2
    C           LMINI     OREQ *ZEROS
    C           FACON     ANDEQ1
     C                     MOVE '06'      NOMAC
X5  C                     ELSE
     C                     MOVE '07'      NOMAC
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           NOMAC     IFEQ '07'
D4  C           COUCXH    IFEQ 'R'
    C           COUCXH    OREQ 'V'
     C                     MOVE 'R'       COMCOU
F4  C                     END
F3  C                     END
F2  C                     END
    C*
     C           DULI90    TAG
     C           CLEPRE    READECXHLIGL2                 80
    C           *IN80     CABEQ'1'       DULI91
D2  C           PASCXH    IFEQ I
D3  C           SUPCXH    IFEQ 'F'
     C                     MOVELQUACXH    COMCLL
F3  C                     END
    C                     GOTO DULI90
F2  C                     END
     C           DULI91    TAG
    C*
D2  C           *IN74     IFEQ '1'
    C           *IN75     OREQ '1'
     C   88      RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
D3  C           *IN75     IFEQ '1'
     C                     ADD  RECXFE    QTEB
X3  C                     ELSE
     C                     ADD  RECXFI    QTEB
F3  C                     END
D3  C           *IN71     IFEQ '0'
     C                     Z-ADDQTEB      SCOMIN  70
F3  C                     END
X2  C                     ELSE
D3  C           *IN70     IFEQ '1'
     C                     Z-ADDSCOMIN    QTEB
X3  C                     ELSE
D4  C           PR        IFEQ 'P'
     C           SUIMP1    MULT ROUL      QTEB
X4  C                     ELSE
     C           SUIMPR    MULT ROUL      QTEB
F4  C                     END
D4  C           *IN73     IFEQ '1'
     C                     Z-ADDRIMPI     RECXH
     C                     ADD  RECXII    QTEB
     C                     Z-ADDSURCXI    SURCXH
X4  C                     ELSE
     C                     Z-ADDRIMPE     RECXH
     C                     ADD  RECXIE    QTEB
     C                     Z-ADDSURCXE    SURCXH
F4  C                     END
     C                     ADD  SURGFA    QTEB
     C                     ADD  RECXH     QTEB
F3  C                     END
F2  C                     END
D2  C           LCXH      IFNE *ZEROS
     C           QTEB      DIV  LCXH      QTENET
X2  C                     ELSE
     C                     Z-ADDQTEB      QTENET
F2  C                     END
    C*
    C*                    Z-ADDQTENET    QTECXH  70       SUPRRIME LE
    C*          SURCXH    DIV  LCXH      MLCXH   70H      20/11/97
    C*                    Z-ADDMLCXH     QTENET           NOTE GUY DU 18/11
    C*          QTECXH    DIV  MLCXH     RAPCXH  74              "
    C*
     C                     MOVELDSCOMP    CLEREC
     C                     MOVE '2'       SSECT
     C                     MOVE '2'       SECT
     * TRAITEMENT FACONNAGE
D2  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
D3  C           *IN75     IFEQ '1'
     C                     Z-ADD15        WSSX
     C                     Z-ADD15        WWS
F3  C                     END
D3  C           *IN74     IFEQ '1'
    C           *IN75     ANDEQ'0'
    C           *IN70     OREQ '1'
     C                     Z-ADD16        WSSX
     C                     Z-ADD16        WWS
F3  C                     END
     *
     * TRAITEMENT IMPRESSION
X2  C                     ELSE
D3  C           *IN73     IFEQ '1'
     C                     Z-ADD16        WSSX
     C                     Z-ADD16        WWS
     C                     Z-ADD1         INN73
F3  C                     END
D3  C           *IN72     IFEQ '1'
    C           *IN73     ANDEQ'0'
     C                     Z-ADD15        WSSX    20
     C                     Z-ADD15        WWS
     C                     Z-ADD1         INN72
F3  C                     END
F2  C                     END
     *
     C                     EXSR NORSTD                     NORMES STD
     *
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULI92
     *
     C                     EXSR CAPART                     CAS PARTICUL
     C                     Z-ADDWSSX      WSS
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LCXH      REGM2     H
D2  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
     C                     WRITEPLANIFF1
     C                     ADD  DECRO     DECROU
     C                     ADD  DECRO     DECROX
     C                     ADD  REGM2     SUREGX
X2  C                     ELSE
     C                     WRITEPLAIMPF1
     C                     ADD  DECRO     ROUL
     C                     ADD  REGM2     SURIMP
F2  C                     END
     *
    C           DSGP      CABEQ'SU'      FIN
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
D2  C           *IN75     IFEQ '1'
     C                     ADD  DECRO     ROCXFE  44
     C                     ADD  REGM2     RECXFE  50
X2  C                     ELSE
D3  C           *IN74     IFEQ '1'
    C           *IN70     OREQ '1'
     C                     ADD  DECRO     ROCXFI  44
     C                     ADD  REGM2     RECXFI  50
X3  C                     ELSE
D4  C           *IN73     IFEQ '1'
     C                     ADD  DECRO     ROCXII  44
     C                     ADD  REGM2     RECXII  50
X4  C                     ELSE
     C                     ADD  DECRO     ROCXIE  44
     C                     ADD  REGM2     RECXIE  50
F4  C                     END
F3  C                     END
F2  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
    C*
D2  C           I         IFNE 1
     C                     SETON                     71
    C                     GOTO DULI93
F2  C                     END
     C           DULI92    TAG
     C                     Z-ADD0         SUPCXY
     C                     SETOF                     71
D2  C           *IN75     IFEQ '1'
     C                     SETOF                     75
D3  C           *IN74     IFEQ '1'
     C                     SETON                     70
     C                     SETOF                     74
    C                     GOTO DULI94
X3  C                     ELSE
    C                     GOTO DULI95
F3  C                     END
F2  C                     END
D2  C           *IN74     IFEQ '1'
     C                     SETOF                     74
    C                     GOTO DULI95
F2  C                     END
D2  C           *IN70     IFEQ '1'
     C                     SETOF                     70
    C                     GOTO DULI95
F2  C                     END
D2  C           *IN52     IFEQ '1'
D3  C           *IN53     IFEQ '0'
     C                     MOVE 'R'       PR
     C                     SETON                     53
    C                     GOTO DULI91
X3  C                     ELSE
     C                     SETOF                     5253
F3  C                     END
F2  C                     END
D2  C           *IN73     IFEQ '1'
     C                     SETOF                     73
     C                     ADD  1         R
     C                     Z-ADDSUREGC    SURIMP
    C                     GOTO DULJ35
F2  C                     END
D2  C           *IN72     IFEQ '1'
     C                     SETOF                     72
F2  C                     END
     C                     MOVE *BLANK    TTPEL   1
D2  C           TVEI2     IFEQ 'B'                        PEL: APPRO BOB
     C                     MOVE '*'       TTPEL
    C                     GOTO FACO14                     COUPEUSE FAC
     C                     MOVE *BLANK    TTPEL
F2  C                     END
D2  C           TVEI2     IFEQ 'M'                        PEL: MASSICOT
    C           TVEI2     OREQ 'N'
     C                     MOVE '*'       TTPEL
    C                     GOTO FACO13                     MASSICOT FACON
     C                     MOVE *BLANK    TTPEL
F2  C                     END
    C                     GOTO DULJFI
    C*
F1  C                     END
     C/SPACE 2
     C           DULI95    TAG
D1  C           FORL      IFNE *ZEROS
D2  C           IMPEXT    IFEQ *ZERO
    C           APPEX     ANDEQ'B'
    C           *IN77     ANDEQ'0'
    C           IMPINT    OREQ *ZERO
    C           APPIN     ANDEQ'B'
    C           *IN76     ANDEQ'0'
    C                     GOTO FACO14                     COUPEUSE FAC
F2  C                     END
D2  C           PASMA     IFEQ ' '
    C           FMASL     ANDNE*ZEROS
    C           IMPEXT    ANDEQ*ZERO
    C           IMPINT    ANDEQ*ZERO
    C                     GOTO FACO13                     MASSICOT FACON
F2  C                     END
F1  C                     END
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section massicot avant façonnage
     C           FACO13    TAG
    C*          ---------------
     C                     MOVE '*'       PASMA
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
    C*
     C                     ADD  1         R
     C                     MOVE '1'       SECT
     C                     MOVE '5'       SSECT
D2  C           USFAB     IFEQ 3                                      ENT
     C                     Z-ADDUSFAB     USFABX
     C                     Z-ADD4         USFAB
F2  C                     END
D2  C           USFAB     IFEQ 2                          SECT. PRECEDENT
     C                     MOVE '03'      NOMAC
X2  C                     ELSE
     C                     MOVE '01'      NOMAC
F2  C                     END
D2  C           TTPEL     IFEQ ' '                        SANS PELCXH
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET
F2  C                     END
D2  C           FMASL     IFNE FORLST
    C           FMASD     ANDNEFORHST
     C                     Z-ADD1500      MOYCAD
X2  C                     ELSE
     C                     Z-ADD3000      MOYCAD
F2  C                     END
D2  C           TVEI2     IFEQ 'M'
     C                     Z-ADD1500      MOYCAD
F2  C                     END
D2  C           TVEI2     IFEQ 'N'
     C                     Z-ADD3000      MOYCAD
F2  C                     END
     C           QTENET    DIV  MOYCAD    TPSTOT
     C                     Z-ADD1         ROEFF
     C                     Z-ADD*ZEROS    NEEFF
     C                     Z-ADD*ZEROS    REDEC
     C                     Z-ADD*ZEROS    REEFF
     C                     Z-ADD*ZEROS    NETPS
D2  C           APPEX     IFNE ' '
     C                     Z-ADD3         SUPCXY
X2  C                     ELSE
     C                     Z-ADD5         SUPCXY
F2  C                     END
D2  C           TTPEL     IFEQ '*'                        AVANT PELCXH
D3  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
     C                     WRITEPLANIFF1
X3  C                     ELSE
     C                     WRITEPLAIMPF1
F3  C                     END
X2  C                     ELSE
     C                     EXSR CALPRI
     C                     Z-ADD70        PRIORI
     C                     WRITEPLANIFF1
F2  C                     END
     C                     Z-ADD0         SUPCXY
     *
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     Z-ADDUSFABX    USFAB
F1  C                     END
D1  C           TVEI2     IFEQ 'M'                        PEL: MASSICOT
    C           TVEI2     OREQ 'N'
    C                     GOTO DULJFI                                 ON
F1  C                     END
    C                     GOTO DULI95
     C/SPACE 2
     * section coupeuse avant façonnage
     C           FACO14    TAG
    C*          ---------------
D1  C           LMINI     IFNE *ZEROS
     C                     MOVELLMINI     LAIZML
X1  C                     ELSE
     C                     MOVELONDL      LAIZML
F1  C                     END
D1  C           FACON     IFEQ 0
     C                     MOVELFORL      LAIZML
F1  C                     END
D1  C           LAIZML    IFEQ *ZEROS
    C           FLPEAP    ANDNE*ZEROS
D2  C           IAEI2     IFEQ 'O'
     C                     MOVELFHPEAP    LAIZML
X2  C                     ELSE
     C                     MOVELFLPEAP    LAIZML
F2  C                     END
F1  C                     END
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDQTENES    QTEB
     C                     Z-ADDQTENES    QTENET
X1  C                     ELSE
D2  C           TTPEL     IFEQ ' '                        SANS PELCXH
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
     C           QTEB      DIV  LAIZML    QTENET
F2  C                     END
     C                     ADD  1         R
     C                     MOVE '1'       SECT
     C                     MOVE '3'       SSECT
     C                     MOVE '03'      NOMAC
F1  C                     END
     C                     Z-ADD2         USFAB
D1  C           APPEX     IFEQ 'B'
    C           TVEI2     OREQ 'B'
     C                     Z-ADDGRAM,3    JAGGRA
X1  C                     ELSE
D2  C           FLPEAP    IFNE *ZEROS
     C                     Z-ADDGRAM,4    JAGGRA
X2  C                     ELSE
     C                     Z-ADDGRAM,5    JAGGRA
F2  C                     END
F1  C                     END
     C                     Z-ADDLMINI     JAGLAI
     C                     Z-ADDONDH      JAGDEV
D1  C           FACON     IFEQ 0
D2  C           SEQDE     IFGT 8000
    C           DSGP      ANDEQ'OR'
X2  C                     ELSE
     C                     Z-ADDFORL      JAGLAI
     C                     Z-ADDFORH      JAGDEV
F2  C                     END
F1  C                     END
     C                     MOVELDSJAGE    CLEREC
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD.
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR CAPART
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
D1  C           CCOL      IFNE 6
D2  C           APPEX     IFEQ 'B'
     C                     Z-ADD3         SUPCXY
X2  C                     ELSE
D3  C           FLPEAP    IFNE *ZEROS
     C                     Z-ADD4         SUPCXY
X3  C                     ELSE
     C                     Z-ADD5         SUPCXY
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           APPEX     IFEQ 'B'
     C                     Z-ADD2         SUPCXY
X2  C                     ELSE
     C                     Z-ADD6         SUPCXY
F2  C                     END
F1  C                     END
D1  C           TTPEL     IFEQ '*'                        AVANT PELCXH
D2  C           *IN75     IFEQ '1'
    C           *IN74     OREQ '1'
    C           *IN70     OREQ '1'
     C                     WRITEPLANIFF1
X2  C                     ELSE
     C                     WRITEPLAIMPF1
F2  C                     END
X1  C                     ELSE
     C                     Z-ADD70        PRIORI
     C                     WRITEPLANIFF1
F1  C                     END
     C                     Z-ADD0         SUPCXY
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LAIZML    REGM2     H
D1  C           APPEX     IFEQ 'B'
     C                     ADD  DECRO     ROCXFE
     C                     ADD  REGM2     RECXFE
X1  C                     ELSE
     C                     ADD  DECRO     ROCXFI
     C                     ADD  REGM2     RECXFI
F1  C                     END
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHRG.RESULTATS
F1  C                     END
     *
D1  C           TVEI2     IFEQ 'B'                        PEL: APPRO BOB
    C                     GOTO DULJFI
F1  C                     END
    C                     GOTO DULIFI
     C/SPACE 2
     * section POST PRINT 2 PASSAGES
     C           FACO15    TAG
     *          ---------------
D1  C           IMPEXT    IFEQ 2
    C           IMPINT    ANDEQ5
    C           IMPEXT    OREQ 4
    C           IMPINT    ANDEQ5
    C           IMPEXT    OREQ 5
    C           IMPINT    ANDEQ2
    C           IMPEXT    OREQ 5
    C           IMPINT    ANDEQ4
    C                     GOTO FACO20                     RETOUR PILES P
F1  C                     END
     *
     C           FAC155    TAG
    C*          ---------------
     C                     SETOF                     206667
     C                     SETOF                     6869
     C                     ADD  1         R
     C                     Z-ADD1         I
     C                     MOVE '4'       SECT
     C                     MOVE '1'       SSECT
     C                     MOVE 3         USFAB
     C                     MOVE '03'      NOMAC
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET
     *
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
D2  C           SUIMPS    IFLT 3
    C                     GOTO FAC151
X2  C                     ELSE
D3  C           RIMPIN    IFEQ 5
    C                     GOTO FAC152
X3  C                     ELSE
    C                     GOTO FAC156
F3  C                     END
F2  C                     END
F1  C                     END
     * EXTERIEUR
D1  C           RIMPEX    IFEQ 5
     C           FAC151    TAG
     C                     MOVE COUEXR    TYPCOU
     C                     MOVE ENCEXR    TYPEN
D2  C           DDEEXR    IFEQ ' '
     C                     MOVE 'B'       TYPABC
X2  C                     ELSE
     C                     MOVE DDEEXR    TYPABC
F2  C                     END
     C                     MOVELDSTYPO    CLEREC
     *
D2  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
     C                     Z-ADD17        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       FAC153
     *
     C                     Z-ADD17        WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D2  C           *IN80     IFEQ '1'
D3  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW
X3  C                     ELSE
     C                     Z-ADD1         PRDW
F3  C                     END
D3  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW
X3  C                     ELSE
     C                     Z-ADD1         PRGW
F3  C                     END
     C           PRDW      MULT PRGW      PREG
D3  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F3  C                     END
D3  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F3  C                     END
D3  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F3  C                     END
D3  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F3  C                     END
F2  C                     END
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C                     GOTO FIN                        -> SUIVI
F2  C                     END
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
     C                     EXSR RESULT
F1  C                     END
     C           FAC153    TAG
     * INTERIEUR
D1  C           RIMPIN    IFEQ 5
     C           FAC152    TAG
     C                     MOVE ENCINR    TYPEN
     C                     MOVE COUINR    TYPCOU
D2  C           DDEINR    IFEQ ' '
     C                     MOVE 'B'       TYPABC
X2  C                     ELSE
     C                     MOVE DDEINR    TYPABC
F2  C                     END
     C                     MOVELDSTYPO    CLEREC
     *
D2  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
     C                     Z-ADD18        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       FAC154
     *
     C                     Z-ADD18        WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D2  C           *IN80     IFEQ '1'
D3  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW
X3  C                     ELSE
     C                     Z-ADD1         PRDW
F3  C                     END
D3  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW
X3  C                     ELSE
     C                     Z-ADD1         PRGW
F3  C                     END
     C           PRDW      MULT PRGW      PREG
D3  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F3  C                     END
D3  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F3  C                     END
D3  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F3  C                     END
D3  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F3  C                     END
F2  C                     END
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C                     GOTO FIN                        -> SUIVI
F2  C                     END
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
     C                     EXSR RESULT
F1  C                     END
     C           FAC154    TAG
     * INTERIEUR PRINCIPAL ET FLEXO INTÉRIEUR
D1  C           IMPINT    IFEQ 5
     C           FAC156    TAG
     C                     MOVE COUIN     TYPCOU
     C                     MOVE ENCIN     TYPEN
D2  C           DDEIN     IFEQ ' '
     C                     MOVE 'B'       TYPABC
X2  C                     ELSE
     C                     MOVE DDEIN     TYPABC
F2  C                     END
     C                     MOVELDSTYPO    CLEREC
     *
D2  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
     C                     Z-ADD18        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULI28
     *
     C                     Z-ADD18        WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D2  C           *IN80     IFEQ '1'
D3  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW
X3  C                     ELSE
     C                     Z-ADD1         PRDW
F3  C                     END
D3  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW
X3  C                     ELSE
     C                     Z-ADD1         PRGW
F3  C                     END
     C           PRDW      MULT PRGW      PREG
D3  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
F3  C                     END
D3  C           PREG      IFNE 0
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
     C           REDEC     MULT PREG      REDEC
F3  C                     END
D3  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F3  C                     END
D3  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F3  C                     END
F2  C                     END
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C                     GOTO FIN                        -> SUIVI
F2  C                     END
     *
     C                     ADD  1         I
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
     C                     EXSR RESULT
F1  C                     END
    C                     GOTO DULI28
     C/SPACE 2
     * section gaufrage après ondulation / contre collage
     C           FACO16    TAG
     * gaufrage page A
    C           GFRA      CABEQ' '       DULIFI
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSGAU     USFAB
X1  C                     ELSE
D2  C           DSGP      IFNE 'SU'
     C                     Z-ADD2         USFAB
F2  C                     END
F1  C                     END
     C                     ADD  1         R
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
D2  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
D3  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X3  C                     ELSE
     C                     MOVE '20'      NOMAC
F3  C                     END
X2  C                     ELSE
D3  C           MAGAU1    IFNE *ZEROS
     C                     MOVE MAGAU1    NOMAC
X3  C                     ELSE
     C                     MOVE '15'      NOMAC
F3  C                     END
F2  C                     END
F1  C                     END
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVELGFRA      SPGA
     C                     Z-ADD0         SPOND
     C                     Z-ADD0         SPCC
     C                     MOVE *BLANKS   SPDEC
     C                     Z-ADD0         SPPOSE
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     SPPOSE
X1  C                     ELSE
     C                     MOVE POSFO     SPPOSE
F1  C                     END
D1  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    SPPOSE
F1  C                     END
     C                     MOVELDSAUTO    CLEREC
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD6         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     Z-ADD*ZEROS    TOTTPS
     C                     Z-ADD*ZEROS    DECR
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     SETOF                     90
     C                     Z-ADD6         WSS     20
     C                     EXSR KOEFF
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     MOVE GFRA      GAUF
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     * gaufrage page B
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHRG.RESULTATS
F1  C                     END
     C                     MOVE *BLANKS   GAUF
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
    C                     GOTO FACO9                      SECT.C/COL  ION
F1  C                     END
D1  C           CCOL      IFEQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
    C                     GOTO FACO7                      SECT.ONDULATION
F1  C                     END
    C           CCOL      CABEQ6         FACO23           CC/OND + CC ION
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section gaufrage avant ondulation / contre collage
     C           FACO17    TAG
     * gaufrage page A
    C           GFRA2     CABEQ' '       DULIFI
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSGAU     USFAB
X1  C                     ELSE
D2  C           DSGP      IFNE 'SU'
     C                     Z-ADD2         USFAB
F2  C                     END
F1  C                     END
     C                     ADD  1         R
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
D2  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
D3  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X3  C                     ELSE
     C                     MOVE '20'      NOMAC
F3  C                     END
X2  C                     ELSE
D3  C           DECA1     IFNE *ZEROS
     C                     MOVE DECA1     NOMAC
X3  C                     ELSE
D4  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X4  C                     ELSE
     C                     MOVE '20'      NOMAC
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVE GFRA2     SPGA
     C                     Z-ADD0         SPOND
     C                     Z-ADD0         SPCC
     C                     MOVE *BLANKS   SPDEC
     C                     Z-ADD0         SPPOSE
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     SPPOSE
X1  C                     ELSE
     C                     MOVE POSFO     SPPOSE
F1  C                     END
D1  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    SPPOSE
F1  C                     END
     C                     MOVELDSAUTO    CLEREC
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD6         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     Z-ADD*ZEROS    TOTTPS
     C                     Z-ADD*ZEROS    DECR
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     SETOF                     90
     C                     Z-ADD66        WSS     20
    C*          TYPP2     IFEQ '*'                        AFFICHE
    C*                    Z-ADD66        WSS
    C*                    END
     C                     EXSR KOEFF
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     MOVE GFRA2     GAUF
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     * gaufrage page B
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHRG.RESULTATS
F1  C                     END
     C                     MOVE *BLANKS   GAUF
    C                     GOTO FACO10                     1° GAUFRAGE .
     C/SPACE 2
     * section gaufrage après ondulation / contre collage
     C           FACO18    TAG
     * gaufrage page A
    C           GFRA2     CABEQ' '       DULIFI
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSGAU     USFAB
X1  C                     ELSE
D2  C           DSGP      IFNE 'SU'
     C                     Z-ADD2         USFAB
F2  C                     END
F1  C                     END
     C                     ADD  1         R
     C                     MOVE '5'       SECT
     C                     MOVE '1'       SSECT
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
D2  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
D3  C           OUVERT    IFGT 1270
    C           DEFIL     ORGT 940
     C                     MOVE '15'      NOMAC
X3  C                     ELSE
     C                     MOVE '20'      NOMAC
F3  C                     END
X2  C                     ELSE
D3  C           DECA1     IFNE *ZEROS
     C                     MOVE DECA1     NOMAC
X3  C                     ELSE
     C                     MOVE '15'      NOMAC
F3  C                     END
F2  C                     END
F1  C                     END
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVELGFRA2     SPGA
     C                     Z-ADD0         SPOND
     C                     Z-ADD0         SPCC
     C                     MOVE *BLANKS   SPDEC
     C                     Z-ADD0         SPPOSE
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     SPPOSE
X1  C                     ELSE
     C                     MOVE POSFO     SPPOSE
F1  C                     END
D1  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    SPPOSE
F1  C                     END
     C                     MOVELDSAUTO    CLEREC
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD6         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     Z-ADD*ZEROS    TOTTPS
     C                     Z-ADD*ZEROS    DECR
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     SETOF                     90
     C                     Z-ADD66        WSS     20
    C*          TYPP2     IFEQ '*'                        AFFICHE
    C*                    Z-ADD66        WSS
    C*                    END
     C                     EXSR KOEFF
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     MOVE GFRA2     GAUF
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     * gaufrage page B
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHRG.RESULTATS
F1  C                     END
     C                     MOVE *BLANKS   GAUF
D1  C           GFRA      IFEQ 'XA'
    C           GFRA      OREQ 'XB'
    C           GFRA      OREQ 'XC'
    C                     GOTO FACO16                     GAUFRAGE AVANT
F1  C                     END
    C           GENCO1    CABEQ'*'       FACO8            TYPO/GENCO
    C           APPEX     CABEQ'O'       FACO8            OFFSET APRES
    C           APPIN     CABEQ'O'       FACO8            OFFSET APRES
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
    C                     GOTO FACO9                      SECT.C/COL  ION
F1  C                     END
D1  C           CCOL      IFEQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
    C                     GOTO FACO7                      SECT.ONDULATION
F1  C                     END
    C           CCOL      CABEQ6         FACO23           CC/OND + CC
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section decorticage REACTEUR
     C           FACO19    TAG
    C*          ---------------
     C                     Z-ADD0         REGM2
     C                     Z-ADD3         USFAB
     *
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSDEC     USFAB
F1  C                     END
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADD3         USFAB
     C                     MOVE NOMACS    NOMAC
F1  C                     END
    C*
     C                     ADD  1         R
     C                     Z-ADD1         I
     C                     MOVE '7'       SECT
     C                     MOVE '0'       SSECT
     C                     MOVE '10'      NOMAC
     C                     Z-ADDONDUL     DCOOND
     C                     Z-ADDCCOL      DCOCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DCOCC
     C                     Z-ADD0         DCOOND
F1  C                     END
     C                     Z-ADD*ZEROS    DCOPOS
     C                     MOVE *BLANKS   DCORTI
     C                     MOVELDSDCOR    CLEREC
     *
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB    90H
     C                     ADD  SUREG     QTEB
     *
     C                     Z-ADDQTFAB     QTENET            EN DECOUPES
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD11        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FACO5
     *
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C                     Z-ADD11        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FACO5
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
    C                     GOTO FACO5
     C/SPACE 2
     * section RETOURNEMENT DE PILE AVANT POST PRINT
     C           FACO20    TAG
    C*          ---------------
     *
     C                     Z-ADD3         USFAB
    C*
     C                     ADD  1         R
     C                     Z-ADD1         I
     C                     MOVE '4'       SECT
     C                     MOVE '1'       SSECT
     C                     MOVE '99'      NOMAC
     C                     Z-ADDONDUL     DCOOND
     C                     Z-ADDCCOL      DCOCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DCOCC
     C                     Z-ADD0         DCOOND
F1  C                     END
     C                     Z-ADD*ZEROS    DCOPOS
     C                     MOVE *BLANKS   DCORTI
     C                     MOVELDSDCOR    CLEREC
     *
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FAC155
     *
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FAC155
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
    C                     GOTO FAC155
     C/SPACE 2
     * section CONDITIONNEMENT FEUILLES D'ONDULES
     C           FACO21    TAG
    C*          ---------------
     C                     Z-ADD0         REGM2
D1  C           CDE       IFEQ 1
     C                     Z-ADD3         USFAB
X1  C                     ELSE
D2  C           USOND     IFNE *ZEROS
     C                     Z-ADDUSOND     USFAB
F2  C                     END
F1  C                     END
     *
    C*
     C                     ADD  1         R
     C                     Z-ADD1         I
     C                     MOVE '7'       SECT
     C                     MOVE '0'       SSECT
     C                     MOVE '99'      NOMAC
     C                     Z-ADDONDUL     DCOOND
     C                     Z-ADDCCOL      DCOCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DCOCC
     C                     Z-ADD0         DCOOND
F1  C                     END
     C                     Z-ADD*ZEROS    DCOPOS
     C                     MOVE *BLANKS   DCORTI
     C                     MOVELDSDCOR    CLEREC
     *
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C                     Z-ADDQTFAB     QTENET            EN FEUILLES
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
     C                     EXSR SPERR
D2  C           DSGP      IFEQ 'SU'
    C           DSGP      OREQ 'AB'
    C                     GOTO FIN
F2  C                     END
    C           FIONDT    CABEQ'O'       FACO7
    C           FIONDT    CABEQ'C'       FACO9
F1  C                     END
     *
     C                     EXSR CAPART                     CAS PARTICUL
    C*
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFNE ' '
    C           FIONDT    CABEQ'O'       FACO7
    C           FIONDT    CABEQ'C'       FACO9
F1  C                     END
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
    C           FIONDT    CABEQ'O'       FACO7
    C           FIONDT    CABEQ'C'       FACO9
     C/SPACE 2
     * section FICELEUSE
     C           FACO22    TAG
    C*          ---------------
     C                     Z-ADD0         REGM2
     C                     Z-ADDUSFAB     SVUS
     *
     C                     ADD  1         R
     C                     Z-ADD1         I
     C                     MOVE '7'       SECT
     C                     MOVE '0'       SSECT
D1  C           CDE       IFNE 1                          USINE
D2  C           USFAB     IFEQ 3
D3  C           DECL      IFGT 680
     C                     MOVE '04'      NOMAC
X3  C                     ELSE
     C                     MOVE '03'      NOMAC
F3  C                     END
X2  C                     ELSE
     C                     MOVE '03'      NOMAC
F2  C                     END
X1  C                     ELSE                            COMMERCIAL
     C                     Z-ADD3         USFAB
     C                     MOVE '03'      NOMAC
F1  C                     END
     *
     C                     MOVE *BLANK    DCORTI
     C                     Z-ADDONDUL     DCOOND
     C                     Z-ADDCCOL      DCOCC
D1  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD9         DCOCC
     C                     Z-ADD0         DCOOND
F1  C                     END
D1  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DCOPOS
X1  C                     ELSE
     C                     MOVE POSFO     DCOPOS
F1  C                     END
     C                     MOVELDSDCOR    CLEREC
     * decorticage page B
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB    90H
     C                     ADD  SUREG     QTEB
D1  C           SBZ       IFNE *ZEROS                      EN FEUILLES
     C           POSF1     ADD  POSF2     TOTDE
     C           QTEB      DIV  SBZ       QTENET
     C                     DIV  TOTDE     QTENET
D2  C           POSF2     IFNE 0
     C                     MULT 2         QTENET
F2  C                     END
X1  C                     ELSE
     C           QTEB      DIV  SBFE      QTENET    H
F1  C                     END
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
     C                     MOVE SVSS      SS
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDSVUS      USFAB
     C                     EXSR SPERR
D2  C           DSGP      IFEQ 'SU'
    C           DSGP      OREQ 'AB'
    C                     GOTO FIN
F2  C                     END
    C           PQFLX     CABEQ'1'       DULI76
    C           PQFLX     CABEQ'2'       DULI10
    C           PQFLX     CABEQ'3'       DULI11
    C           PQFLX     CABEQ'4'       FACO5
F1  C                     END
     *
D1  C           AMALS     IFNE *ZEROS
    C           SIM       ANDEQ1
     C           RETPS     MULT AMALS     RETPS
F1  C                     END
     *
     C                     EXSR CAPART
     *
    C*          RAPDEC    ADD  DECROU    ROUDEC
    C*          SUFAB     MULT ROUDEC    QTEB      H
    C*                    ADD  SUREG     QTEB
    C*                    Z-ADDQTFAB     QTENET            EN DECOUPES
     *
    C*          DSGP      IFEQ 'AB'
    C*                    Z-ADDQTENES    QTENET
    C*                    END
     *
    C*                    MOVE PQFL3     QTPQ    50
    C*          QTPQ      IFEQ 0
    C*                    Z-ADD75        QTPQ
    C*                    END
    C*          QTENET    DIV  QTPQ      NBRPQ   70H
    C*          NBRPQ     IFLT 100
    C*                    Z-ADD50        MOYCAD
    C*                    ELSE
    C*                    Z-ADD60        MOYCAD
    C*                    END
    C*          NBRPQ     DIV  MOYCAD    TPSTOT    H
    C*
    C*                    Z-ADD2         ROEFF
    C*                    Z-ADD*ZEROS    NEEFF
    C*                    Z-ADD1         RETPS
    C*                    Z-ADD*ZEROS    REDEC
    C*                    Z-ADD1         REEFF
    C*                    Z-ADD*ZEROS    NETPS
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFNE ' '
     C                     MOVE SVSS      SS
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDSVUS      USFAB
    C           PQFLX     CABEQ'1'       DULI76
    C           PQFLX     CABEQ'2'       DULI10
    C           PQFLX     CABEQ'3'       DULI11
    C           PQFLX     CABEQ'4'       FACO5
F1  C                     END
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
     C                     ADD  1         R
     C                     MOVE SVSS      SS
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDSVUS      USFAB
    C           PQFLX     CABEQ'1'       DULI76
    C           PQFLX     CABEQ'2'       DULI10
    C           PQFLX     CABEQ'3'       DULI11
    C           PQFLX     CABEQ'4'       FACO5
     * -----------------------
     C/SPACE 2
     * section CC OU OND +CC SI CANNELURES CROISSÉES
     C           FACO23    TAG
    C*          ---------------
    C*  2° PASSAGE CONTRE-COLLAGE
    C*  ----------------------------
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
D2  C           FACON     IFEQ 4
     C                     MOVELDECH      LONGML
X2  C                     ELSE
     C                     MOVELONDH      LONGML
F2  C                     END
     C           QTENES    MULT LONGML    QTENET
     C                     Z-ADDCCOL      COCOL
    C                     GOTO DULI70
F1  C                     END
     * contre-collage
     C                     Z-ADDUSINE     USFAB
     C                     ADD  1         R
     C                     MOVE '3'       SECT
     C                     MOVE '1'       SSECT
     C                     Z-ADD1         I
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
D1  C           FACON     IFEQ 4
     C                     MOVELSBDEC     SBDE    76
     C           QTEB      DIV  SBDE      QTENET
     C                     MOVELDECH      LONGML
X1  C                     ELSE
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
     C                     MOVELONDH      LONGML  43
D2  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
F1  C                     END
     *
     C           QTENET    MULT LONGML    QTENET    H
     C                     Z-ADDCCOL      COCOL   10
     * contre-collage
    C* ordonnancement
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSCOL     USFAB
D2  C           MACOL1    IFNE *ZEROS
     C                     MOVE MACOL1    NOMAC
X2  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI71
     C                     MOVE NOMAC1    NOMAC
F2  C                     END
X1  C                     ELSE
    C* TARIF COMMERCIAL
     C                     Z-ADD2         USFAB
     C                     MOVE '08'      NOMAC
F1  C                     END
     *
     C           DULI70    TAG
     C                     MOVE COCOL     COLCOL
     C                     MOVE DD2       COLON
     C                     MOVE COUPIN    COLCOU
     *
     * contre-collage page C
     C                     MOVELDSCCOL    CLEREC
     C                     Z-ADD8         WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       DULI71
     C                     MOVE '1'       DCP1    1
     C                     EXSR CAPART                     CAS PARTICUL
     C                     MOVE *BLANK    DCP1
    C*
     C                     Z-ADD8         WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULI71
F1  C                     END
     *
     * contre-collage page E
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
D1  C           FACON     IFEQ 4
     C                     MOVELDECL      LARGML
X1  C                     ELSE
     C                     MOVELONDL      LARGML  43
F1  C                     END
     C           REDEC     MULT LARGML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI71
     *
     * contre-collage page F
     C                     EXSR RESULT                     CHAR.RESULTATS
     C           DULI71    TAG
    C*          ---------------
D1  C           COUI3     IFEQ 1
    C*  1° PASSAGE CONTRE-COLLAGE
    C*  ----------------------------
    C* suivi production
D2  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
D3  C           ICEI3     IFEQ 'O'
D4  C           FACON     IFEQ 4
     C                     MOVELDECL      LONGML
X4  C                     ELSE
     C                     MOVELONDL      LONGML
F4  C                     END
X3  C                     ELSE
D4  C           FACON     IFEQ 4
     C                     MOVELDECH      LONGML
X4  C                     ELSE
     C                     MOVELONDH      LONGML
F4  C                     END
F3  C                     END
     C           QTENES    MULT LONGML    QTENET
     C                     Z-ADD1         COCOL
    C                     GOTO DULI74
F2  C                     END
     * contre-collage
     C                     Z-ADDUSINE     USFAB
     C                     ADD  1         R
     C                     MOVE '3'       SECT
     C                     MOVE '1'       SSECT
     C                     Z-ADD1         I
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
D2  C           FACON     IFEQ 4
     C                     MOVELSBDEC     SBDE    76
     C           QTEB      DIV  SBDE      QTENET
D3  C           ICEI3     IFEQ 'O'
     C                     MOVELDECL      LONGML
X3  C                     ELSE
     C                     MOVELDECH      LONGML
F3  C                     END
X2  C                     ELSE
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET    H
D3  C           ICEI3     IFEQ 'O'
     C                     MOVELONDL      LONGML  43
X3  C                     ELSE
     C                     MOVELONDH      LONGML  43
F3  C                     END
D3  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F3  C                     END
F2  C                     END
     *
     C           QTENET    MULT LONGML    QTENET    H
     C                     Z-ADDCCOL      COCOL   10
     * contre-collage
    C* ordonnancement
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSOND     USFAB
D3  C           MAOND1    IFNE *ZEROS
     C                     MOVE MAOND1    NOMAC
X3  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI75
     C                     MOVE NOMAC1    NOMAC
F3  C                     END
X2  C                     ELSE
    C* TARIF COMMERCIAL
     C                     Z-ADD2         USFAB
     C                     MOVE '08'      NOMAC
F2  C                     END
     *
     C           DULI74    TAG
     C                     MOVE '1'       COLCOL
     C                     MOVE DD1       COLON
     C                     MOVE COUPEX    COLCOU
     *
     * contre-collage page C
     C                     MOVELDSCCOL    CLEREC
     C                     Z-ADD20        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULI75
     C                     Z-ADDONDL      ONDLA   40
     C                     Z-ADDONDH      ONDHA   40
     C                     Z-ADDDECL      DECLA   40
     C                     Z-ADDDECH      DECHA   40
D2  C           ICEI3     IFEQ '0'
     C                     Z-ADDONDLA     ONDH
     C                     Z-ADDONDHA     ONDL
     C                     Z-ADDDECLA     DECH
     C                     Z-ADDDECHA     DECL
F2  C                     END
     C                     EXSR CAPART                     CAS PARTICUL
     C                     Z-ADDONDHA     ONDH
     C                     Z-ADDONDLA     ONDL
     C                     Z-ADDDECHA     DECH
     C                     Z-ADDDECLA     DECL
    C*
     C                     Z-ADD20        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     * contre-collage page E
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
D2  C           FACON     IFEQ 4
     C                     MOVELDECL      LARGML
X2  C                     ELSE
     C                     MOVELONDL      LARGML  43
F2  C                     END
     C           REDEC     MULT LARGML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI75
     *
     * contre-collage page F
     C                     EXSR RESULT                     CHAR.RESULTATS
D2  C           FORL      IFNE *ZEROS
D3  C           IMPEXT    IFEQ *ZERO
    C           APPEX     ANDEQ'B'
    C           IMPINT    OREQ *ZERO
    C           APPIN     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FAC
F3  C                     END
D3  C           FMASL     IFNE *ZEROS
    C           IMPEXT    ANDEQ*ZERO
    C           IMPINT    ANDEQ*ZERO
    C                     GOTO FACO13                     MASSICOT FACON
F3  C                     END
F2  C                     END
     C           DULI75    TAG
X1  C                     ELSE
    C*  1° PASSAGE ONDULATION
    C*  ----------------------------
     * ondulation
    C* suivi production
D2  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDQTENES    QTEB
D3  C           ICEI3     IFEQ 'O'
     C                     MOVELONDH      LAIZML
X3  C                     ELSE
D4  C           LUTIL     IFEQ *ZEROS
     C                     MOVELLMINI     LAIZML
X4  C                     ELSE
     C                     MOVELLUTIL     LAIZML
F4  C                     END
F3  C                     END
     * ondulation
D3  C           UVENT     IFEQ 1
    C           FACON     ANDEQ9
    C           UVENT     OREQ 1
    C           FACON     ANDEQ4
    C           UVENT     OREQ 5
    C           FACON     ANDEQ9
    C           UVENT     OREQ 5
    C           FACON     ANDEQ4
    C           UVENT     OREQ 3
     C                     Z-ADDQTENES    QTENET
    C                     GOTO DULI77
F3  C                     END
    C*
D3  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C                     MOVELONDH      L       43
     C           LALAIZ    SUB  ACOTE     RESTE
     C           RESTE     DIV  ONDL      NBR
D4  C           ACOTE     IFNE *ZEROS
     C                     ADD  1         NBR
F4  C                     END
     C           QTENES    DIV  NBR       QTENET
     C           QTENET    MULT L         QTENET
X3  C                     ELSE
     C           SUFAB     DIV  LAIZML    QTENET
F3  C                     END
    C                     GOTO DULI77
F2  C                     END
     * ondulation
     C                     Z-ADD1         I
     C                     ADD  1         R
     C                     MOVE '2'       SECT
     C                     MOVE '1'       SSECT
     * ondulation
     C           RAPDEC    ADD  DECROU    ROUDEC
     C/SPACE 1
D2  C           DSGP      IFEQ 'AB'
D3  C           ACOTE     IFNE 0                             O
     C                     ADD  1         NBR                 B   P
F3  C                     END                                J   R
     C           QTENES    DIV  NBR       QTENET              E   O
D3  C           TOTDE     IFNE *ZEROS
     C           QTENET    MULT TOTDE     QTENET              C   D
F3  C                     END
D3  C           UVENT     IFEQ 1                             T   U
     C           QTENET    MULT 0,001     ZQ      73          I   C
X3  C                     ELSE                               F   T
D4  C           UVENT     IFEQ 5                             T   U
     C           QTENET    MULT 1         ZQ                  I   C
X4  C                     ELSE                               F   T
     C           QTENET    MULT 0,01      ZQ                      I
F4  C                     END                                    O
F3  C                     END                                    O
     C           SUVENT    MULT ZQ        SUFAB                   N
F2  C                     END
     C/SPACE 1
D2  C           ICEI3     IFEQ 'O'
     C                     MOVELONDH      LAIZML
X2  C                     ELSE
D3  C           LUTIL     IFEQ *ZEROS
     C                     MOVELLMINI     LAIZML  32
X3  C                     ELSE
     C                     MOVELLUTIL     LAIZML
F3  C                     END
F2  C                     END
D2  C           FACON     IFEQ 4
D3  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
X3  C                     ELSE
D4  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C           QTFAB     MULT ROUDEC    QTENET
X4  C                     ELSE
D5  C           UVENT     IFEQ 2
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     MOVELSBDEC     SBZ     76
     C           QTEB      DIV  SBZ       QTENET    H
X5  C                     ELSE
    C                     GOTO DULI78
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           FACON     IFNE 4
     C           DULI78    TAG
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
     C           QTEB      DIV  LAIZML    QTENET    H
F2  C                     END
     * ondulation
    C* TARIF COMMANDE
    C*                    MOVE '0'       HECOUP  1
D2  C           CDE       IFEQ 1
     C                     MOVE '11'      NOMAC
     C                     Z-ADD3         USFAB
    C                     GOTO DULI77
F2  C                     END
    C* ordonnancement
     C                     Z-ADDUSINE     USFAB
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D3  C           USOND     IFNE *ZEROS
     C                     Z-ADDUSOND     USFAB
F3  C                     END
D3  C           MAOND1    IFNE *ZEROS
     C                     MOVE MAOND1    NOMAC
X3  C                     ELSE
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    DULI79
     C                     MOVE NOMAC1    NOMAC
    C                     GOTO DULI77
F3  C                     END
F2  C                     END
     *
     * ondulation
     C           DULI77    TAG
     C                     MOVE '3'       ONDCOL
     C                     MOVE DD1       ONDOND
     C                     MOVE FACON     ONDFAC
     C                     MOVE COUPEX    ONDCOU
     C                     MOVE GRAOND    ONDGRA
     C                     MOVELDSOND     CLEREC
     *
     * ondulation
     C                     Z-ADD7         WWS
     C                     EXSR NORSTD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULI79
     *
     C                     Z-ADDONDL      ONDLA   40
     C                     Z-ADDONDH      ONDHA   40
     C                     Z-ADDDECL      DECLA   40
     C                     Z-ADDDECH      DECHA   40
D2  C           ICEI3     IFEQ '0'
     C                     Z-ADDONDLA     ONDH
     C                     Z-ADDONDHA     ONDL
     C                     Z-ADDDECLA     DECH
     C                     Z-ADDDECHA     DECL
F2  C                     END
     C                     EXSR CAPART                     CAS PARTICUL
     C                     Z-ADDONDHA     ONDH
     C                     Z-ADDONDLA     ONDL
     C                     Z-ADDDECHA     DECH
     C                     Z-ADDDECLA     DECL
    C*
     C                     Z-ADD7         WSS     20
     C                     EXSR KOEFF                      PONDERATION
     * ondulation
    C*
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
     C                     EXSR CALPRI
     C  N50                WRITEPLANIFF1
D2  C           DSGP      IFEQ 'SU'                       -> SUIVI
D3  C           DD1       IFNE 9
    C           *IN50     OREQ '1'
    C                     GOTO FIN
F3  C                     END
F2  C                     END
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULI79
     C                     EXSR RESULT                     CHAR.RESULTATS
    C*
     C           DULI79    TAG
F1  C                     END
     *
D1  C           GFRA2     IFEQ 'GA'                       2° GAUFRAGE
    C           GFRA2     OREQ 'GB'
    C           GFRA2     OREQ 'GC'
    C                     GOTO FACO17                     GAUFRAGE AVANT
F1  C                     END
D1  C           GFRA      IFEQ 'GA'
    C           GFRA      OREQ 'GB'
    C           GFRA      OREQ 'GC'
    C                     GOTO FACO10                     GAUFRAGE AVANT
F1  C                     END
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXE CXH
F1  C                     END
    C           PELLI     CABEQ'*'       FACO25           PELLICULEUSE
    C           CODDOR    CABEQ'*'       FACO26           DORURE
    C                     GOTO DULIFI                     FIN ---> IMP.
     C/SPACE 2
     * section massicot avant façonnage
     C           FACO24    TAG
    C*          ---------------
     C                     ADD  1         R
     C                     MOVE '1'       SECT
     C                     MOVE '5'       SSECT
     C                     Z-ADDUSFAB     USFABX
D1  C           CDE       IFEQ 1
    C           CDE       ORNE 1
    C           MAMAS     ANDEQ*ZEROS
D2  C           USFAB     IFEQ 3                                      ENT
     C                     Z-ADD2         USFAB
F2  C                     END
D2  C           USFAB     IFEQ 4                                      ENT
     C                     MOVE '01'      NOMAC
X2  C                     ELSE
D3  C           USFAB     IFEQ 7                                      ENT
     C                     MOVE '02'      NOMAC
X3  C                     ELSE
     C                     MOVE '03'      NOMAC
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           CDE       IFNE 1
    C           MAMAS     ANDNE*ZEROS
     C                     Z-ADDUSMAS     USFAB
     C                     MOVE MAMAS     NOMAC
F1  C                     END
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB
     C                     ADD  SUREG     QTEB
     C                     MOVELSBFEU     SBFE
     C           QTEB      DIV  SBFE      QTENET
     C                     Z-ADD3000      MOYCAD
     C           QTENET    DIV  MOYCAD    TPSTOT
     C                     Z-ADD1         ROEFF
     C                     Z-ADD*ZEROS    NEEFF
     C                     Z-ADD*ZEROS    REDEC
     C                     Z-ADD*ZEROS    REEFF
     C                     Z-ADD*ZEROS    NETPS
     C                     Z-ADD70        PRIORI
     C                     Z-ADD3         SUPCXY
     C                     WRITEPLANIFF1
     C                     Z-ADD0         SUPCXY
     *
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR RESULT                     CHAR.RESULTATS
     C                     Z-ADDUSFABX    USFAB
    C*
    C                     GOTO DULIFI
     C/SPACE 2
     * section PELICULAGE APRÈS IMPRESSION
     C           FACO25    TAG
    C*          ---------------
     C                     Z-ADD2         USFAB
     C                     ADD  1         R
     C                     MOVE '2'       SECT
     C                     MOVE '2'       SSECT
     C                     MOVE '08'      NOMAC
     C                     MOVE '*'       PASPEL  1
    C* 2° PASSAGE
     C                     MOVELQUAPP2    QUAFIP  3
D1  C           QUAFIP    IFNE *BLANKS
     C                     Z-ADD2         I
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
    C*
     C                     MOVE QUAPP2    INVFPE  1
D2  C           INVFPE    IFEQ ' '
D3  C           FORL      IFNE *ZEROS
     C           FORL      DIV  1000      LAIZML
X3  C                     ELSE
D4  C           ONDL      IFNE *ZEROS
     C           ONDL      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           DECL      IFNE *ZEROS
     C           DECL      DIV  1000      LAIZML
F5  C                     END
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           FORH      IFNE *ZEROS
     C           FORH      DIV  1000      LAIZML
X3  C                     ELSE
D4  C           ONDH      IFNE *ZEROS
     C           ONDH      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           DECH      IFNE *ZEROS
     C           DECH      DIV  1000      LAIZML
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     C           QTEB      DIV  LAIZML    QTENET
    C*
D2  C           DSGP      IFEQ 'AB'
D3  C           FACON     IFEQ 1
     C                     Z-ADDQTENES    QTENET
X3  C                     ELSE
     C           DECH      DIV  1000      DECHM
     C           DECL      DIV  1000      DECLM
D4  C           LAIZML    IFNE *ZEROS
     C           LAIZML    DIV  DECLM     Z1M     10
D5  C           Z1M       IFGE 2
     C           DECHM     DIV  Z1M       DECHM
F5  C                     END
F4  C                     END
     C           QTENES    MULT DECHM     QTENET
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD7         COMCOL
D2  C           CODPP2    IFEQ 'A'
     C                     MOVE 'PL'      COMCLL
F2  C                     END
     C                     MOVE *BLANK    COMIMP
     C                     MOVE *BLANK    COMCOU
D2  C           COUPP2    IFEQ 'R'
     C                     MOVE 'R'       COMCOU
F2  C                     END
D2  C           IMPEXT    IFEQ 4
     C                     Z-ADDGRAM,3    COMGR
X2  C                     ELSE
     C                     Z-ADDGRAM,5    COMGR
F2  C                     END
     *
     C                     MOVELDSCOMP    CLEREC
     C                     Z-ADD25        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD25        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
     C                     Z-ADD70        PRIORI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
    C* 1° PASSAGE
     C                     MOVELQUAPP1    QUAFIP  3
D1  C           QUAFIP    IFNE *BLANKS
     C                     Z-ADD1         I
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
    C*
     C                     MOVE QUAPP1    INVFPE  1
D2  C           INVFPE    IFEQ ' '
D3  C           FORL      IFNE *ZEROS
     C           FORL      DIV  1000      LAIZML
X3  C                     ELSE
D4  C           ONDL      IFNE *ZEROS
     C           ONDL      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           DECL      IFNE *ZEROS
     C           DECL      DIV  1000      LAIZML
F5  C                     END
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           FORH      IFNE *ZEROS
     C           FORH      DIV  1000      LAIZML
X3  C                     ELSE
D4  C           ONDH      IFNE *ZEROS
     C           ONDH      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           DECH      IFNE *ZEROS
     C           DECH      DIV  1000      LAIZML
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     C           QTEB      DIV  LAIZML    QTENET
    C*
D2  C           DSGP      IFEQ 'AB'
D3  C           FACON     IFEQ 1
     C                     Z-ADDQTENES    QTENET
X3  C                     ELSE
     C           DECH      DIV  1000      DECHM
     C           DECL      DIV  1000      DECLM
D4  C           LAIZML    IFNE *ZEROS
     C           LAIZML    DIV  DECLM     Z1M     10
D5  C           Z1M       IFGE 2
     C           DECHM     DIV  Z1M       DECHM
F5  C                     END
F4  C                     END
     C           QTENES    MULT DECHM     QTENET
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD7         COMCOL
D2  C           CODPP1    IFEQ 'A'
     C                     MOVE 'PL'      COMCLL
F2  C                     END
     C                     MOVE *BLANK    COMIMP
     C                     MOVE *BLANK    COMCOU
D2  C           COUPP1    IFEQ 'R'
     C                     MOVE 'R'       COMCOU
F2  C                     END
D2  C           IMPEXT    IFEQ 4
     C                     Z-ADDGRAM,3    COMGR
X2  C                     ELSE
     C                     Z-ADDGRAM,5    COMGR
F2  C                     END
     *
     C                     MOVELDSCOMP    CLEREC
     C                     Z-ADD24        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD24        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
     C                     Z-ADD70        PRIORI
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT LAIZML    REGM2     H
     C                     ADD  REGM2     SUREG
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
     *
     C                     MOVE ' '       PASPEL
     *
    C           CODDOR    CABEQ'*'       FACO26           DORURE
D1  C           CCOL      IFEQ 4                                      ION
    C           CCOL      OREQ 7                                      ION
    C                     GOTO FACO11                     COMPLEXAGE SOF
F1  C                     END
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXE CXH
F1  C                     END
     *
D1  C           FACON     IFEQ 0
    C           IMPEXT    ANDEQ0
    C           IMPINT    ANDEQ0
    C           APPEX     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FACON
F1  C                     END
D1  C           FACON     IFEQ 0
    C           MASSI     ANDEQ'*'
    C           GFRA      ANDEQ*BLANKS
    C                     GOTO FACO24                     AFFICHE EN DEUX
F1  C                     END
    C*
    C                     GOTO DULIFI
     C/SPACE 2
     * section DORURE
     C           FACO26    TAG
    C*          ---------------
     C                     Z-ADD*ZEROS    EXDECD  44
     C                     Z-ADD*ZEROS    INDECD  44
     C                     Z-ADD*ZEROS    SURIMD  50
     C                     MOVE DECROU    DECFAC
     C                     ADD  SUPDEC    DECFAC
     C           RAPDEC    ADD  DECROU    ROUL
     C           SUREG     ADD  SUREGX    SURIMP
     C           SUREG     ADD  SUREGX    SURGFA
D1  C           QTPRE     IFNE *ZEROS
     C           QTPRE     DIV  QTFAB     RAPO      H
X1  C                     ELSE
D2  C           QTREN     IFNE *ZEROS
     C           QTREN     DIV  QTFAB     RAPO      H
X2  C                     ELSE
     C                     Z-ADD1         RAPO
F2  C                     END
F1  C                     END
     C                     MULT RAPO      SURGFA    H
     C           SUFAB     MULT NBFAB     SUFTOT
D1  C           ROUDEC    IFEQ 0
     C                     Z-ADD1         ROUDEC
F1  C                     END
    C*
     C                     Z-ADD2         USFAB
     C                     ADD  1         R
     C                     MOVE '1'       SECT
     C                     MOVE '6'       SSECT
     C                     MOVE '01'      NOMAC
    C*
     C                     MOVE *BLANK    DORNEU  1
D1  C           IMPEXT    IFNE *ZEROS
     C                     Z-ADD3         SUIMP
     C                     MOVEA'1'       *IN,87
     C                     Z-ADD62        PRIORI
X1  C                     ELSE
D2  C           IMPINT    IFNE *ZEROS
     C                     Z-ADD5         SUIMP
     C                     MOVEA'1'       *IN,86
     C                     Z-ADD31        PRIORI
X2  C                     ELSE
     C                     MOVE '*'       DORNEU
     C                     Z-ADD90        PRIORI
F2  C                     END
F1  C                     END
    C* 4° PASSAGE
    C* ----------
D1  C           DNATP4    IFNE *BLANKS
     C                     Z-ADD4         I
     C           RAPDEC    ADD  DECROU    ROUL
D2  C           DORNEU    IFEQ '*'
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X2  C                     ELSE
D3  C           SUIMP1    IFEQ *ZEROS
     C                     Z-ADDQTREN     QTPREV
     C                     MOVE 'R'       PR
     C           SUIMPR    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X3  C                     ELSE
     C                     Z-ADDQTPRE     QTPREV
     C                     MOVE 'P'       PR
     C           SUIMP1    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
F3  C                     END
F2  C                     END
    C*
D2  C           SBFE      IFNE *ZEROS
     C           QTEB      DIV  SBFE      QTENET    H
X2  C                     ELSE
     C                     Z-ADDQTEB      QTENET
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
D2  C           DNATP4    IFEQ 'X'
     C                     MOVE 'G'       DORNAT
X2  C                     ELSE
     C                     MOVE DNATP4    DORNAT
F2  C                     END
     C                     MOVE DDIFP4    DORDIF
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DORPOS
X2  C                     ELSE
     C                     MOVE POSFO     DORPOS
F2  C                     END
D2  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    DORPOS
F2  C                     END
     *
     C                     MOVELDSDOR     CLEREC
     C                     Z-ADD31        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD31        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
D2  C           DORNEU    IFEQ '*'
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
X2  C                     ELSE
     C                     WRITEPLAIMPF1
F2  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
D2  C           DORNEU    IFEQ '*'
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
X2  C                     ELSE
D3  C           IMPEXT    IFEQ 4
     C                     ADD  DECRO     EXDECD
X3  C                     ELSE
     C                     ADD  DECRO     INDECD
F3  C                     END
     C           REDEC     MULT SBFE      SURIM     H
     C                     ADD  SURIM     SURIMP
     C                     ADD  SURIM     SURIMD
     C                     ADD  DECRO     ROUL
F2  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
    C* 3° PASSAGE
    C*-----------
D1  C           DNATP3    IFNE *BLANKS
     C                     Z-ADD3         I
     C                     MOVE '1'       SECT
     C                     MOVE '6'       SSECT
     C                     MOVE '01'      NOMAC
    C*
     C                     ADD  DECRO     ROUDEC
D2  C           DORNEU    IFEQ '*'
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X2  C                     ELSE
D3  C           SUIMP1    IFEQ *ZEROS
     C                     Z-ADDQTREN     QTPREV
     C                     MOVE 'R'       PR
     C           SUIMPR    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X3  C                     ELSE
     C                     Z-ADDQTPRE     QTPREV
     C                     MOVE 'P'       PR
     C           SUIMP1    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
F3  C                     END
F2  C                     END
    C*
D2  C           SBFE      IFNE *ZEROS
     C           QTEB      DIV  SBFE      QTENET    H
X2  C                     ELSE
     C                     Z-ADDQTEB      QTENET
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
D2  C           DNATP3    IFEQ 'X'
     C                     MOVE 'G'       DORNAT
X2  C                     ELSE
     C                     MOVE DNATP3    DORNAT
F2  C                     END
     C                     MOVE DDIFP3    DORDIF
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DORPOS
X2  C                     ELSE
     C                     MOVE POSFO     DORPOS
F2  C                     END
D2  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    DORPOS
F2  C                     END
     *
     C                     MOVELDSDOR     CLEREC
     C                     Z-ADD30        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD30        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
D2  C           DORNEU    IFEQ '*'
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
X2  C                     ELSE
     C                     WRITEPLAIMPF1
F2  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
D2  C           DORNEU    IFEQ '*'
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
X2  C                     ELSE
D3  C           IMPEXT    IFEQ 4
     C                     ADD  DECRO     EXDECD
X3  C                     ELSE
     C                     ADD  DECRO     INDECD
F3  C                     END
     C           REDEC     MULT SBFE      SURIM     H
     C                     ADD  SURIM     SURIMP
     C                     ADD  SURIM     SURIMD
     C                     ADD  DECRO     ROUL
F2  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
    C* 2° PASSAGE
    C*-----------
D1  C           DNATP2    IFNE *BLANKS
     C                     Z-ADD2         I
     C                     MOVE '1'       SECT
     C                     MOVE '6'       SSECT
     C                     MOVE '01'      NOMAC
    C*
     C                     ADD  DECRO     ROUDEC
D2  C           DORNEU    IFEQ '*'
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X2  C                     ELSE
D3  C           SUIMP1    IFEQ *ZEROS
     C                     Z-ADDQTREN     QTPREV
     C                     MOVE 'R'       PR
     C           SUIMPR    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X3  C                     ELSE
     C                     Z-ADDQTPRE     QTPREV
     C                     MOVE 'P'       PR
     C           SUIMP1    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
F3  C                     END
F2  C                     END
    C*
D2  C           SBFE      IFNE *ZEROS
     C           QTEB      DIV  SBFE      QTENET    H
X2  C                     ELSE
     C                     Z-ADDQTEB      QTENET
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
D2  C           DNATP2    IFEQ 'X'
     C                     MOVE 'G'       DORNAT
X2  C                     ELSE
     C                     MOVE DNATP2    DORNAT
F2  C                     END
     C                     MOVE DDIFP2    DORDIF
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DORPOS
X2  C                     ELSE
     C                     MOVE POSFO     DORPOS
F2  C                     END
D2  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    DORPOS
F2  C                     END
     *
     C                     MOVELDSDOR     CLEREC
     C                     Z-ADD27        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD27        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
D2  C           DORNEU    IFEQ '*'
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
X2  C                     ELSE
     C                     WRITEPLAIMPF1
F2  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
D2  C           DORNEU    IFEQ '*'
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
X2  C                     ELSE
D3  C           IMPEXT    IFEQ 4
     C                     ADD  DECRO     EXDECD
X3  C                     ELSE
     C                     ADD  DECRO     INDECD
F3  C                     END
     C           REDEC     MULT SBFE      SURIM     H
     C                     ADD  SURIM     SURIMP
     C                     ADD  SURIM     SURIMD
     C                     ADD  DECRO     ROUL
F2  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
    C* 1° PASSAGE
D1  C           DNATP1    IFNE *BLANKS
     C                     Z-ADD1         I
     C                     MOVE '1'       SECT
     C                     MOVE '6'       SSECT
     C                     MOVE '01'      NOMAC
    C*
     C                     ADD  DECRO     ROUDEC
D2  C           DORNEU    IFEQ '*'
     C           SUFAB     MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X2  C                     ELSE
D3  C           SUIMP1    IFEQ *ZEROS
     C                     Z-ADDQTREN     QTPREV
     C                     MOVE 'R'       PR
     C           SUIMPR    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
X3  C                     ELSE
     C                     Z-ADDQTPRE     QTPREV
     C                     MOVE 'P'       PR
     C           SUIMP1    MULT ROUDEC    QTEB      H
     C                     ADD  SUREG     QTEB
F3  C                     END
F2  C                     END
    C*
D2  C           SBFE      IFNE *ZEROS
     C           QTEB      DIV  SBFE      QTENET    H
X2  C                     ELSE
     C                     Z-ADDQTEB      QTENET
F2  C                     END
    C*
D2  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
     C                     Z-ADDQTENES    QTENET
F2  C                     END
     *
D2  C           DNATP1    IFEQ 'X'
     C                     MOVE 'G'       DORNAT
X2  C                     ELSE
     C                     MOVE DNATP1    DORNAT
F2  C                     END
     C                     MOVE DDIFP1    DORDIF
D2  C           POSFO     IFEQ 0
     C                     MOVELPOSF1     DORPOS
X2  C                     ELSE
     C                     MOVE POSFO     DORPOS
F2  C                     END
D2  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     MOVELPOSGAF    DORPOS
F2  C                     END
     *
     C                     MOVELDSDOR     CLEREC
     C                     Z-ADD26        WWS
     C                     EXSR NORSTD                     NORMES STD
D2  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F2  C                     END
    C           GPTEST    CABNE' '       DULIFI
     C                     EXSR CAPART                     CAS PARTICUL
     *
     C                     Z-ADD26        WSS     20
     C                     EXSR KOEFF                      PONDERATION
     *
D2  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F2  C                     END
D2  C           DORNEU    IFEQ '*'
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
X2  C                     ELSE
     C                     WRITEPLAIMPF1
F2  C                     END
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F2  C                     END
     *
     C                     MOVELMOYDEC    DECRO
D2  C           DORNEU    IFEQ '*'
     C                     ADD  DECRO     DECROU
     C           REDEC     MULT SBFE      REGM2     H
     C                     ADD  REGM2     SUREG
X2  C                     ELSE
D3  C           IMPEXT    IFEQ 4
     C                     ADD  DECRO     EXDECD
X3  C                     ELSE
     C                     ADD  DECRO     INDECD
F3  C                     END
     C           REDEC     MULT SBFE      SURIM     H
     C                     ADD  SURIM     SURIMP
     C                     ADD  SURIM     SURIMD
     C                     ADD  DECRO     ROUL
F2  C                     END
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       DULIFI
     C                     Z-ADD0         SUIMP
     C                     MOVEA'00'      *IN,86
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
     C                     MOVE *BLANK    DORNEU  1
     C                     Z-ADD90        PRIORI
     *
D1  C           CCOL      IFEQ 4                                      ION
    C           CCOL      OREQ 7                                      ION
    C                     GOTO FACO11                     COMPLEXAGE SOF
F1  C                     END
D1  C           *IN77     IFEQ '1'
    C           *IN76     OREQ '1'
    C                     GOTO FACO12                     COMPLEXE CXH
F1  C                     END
     *
D1  C           FACON     IFEQ 0
    C           IMPEXT    ANDEQ0
    C           IMPINT    ANDEQ0
    C           APPEX     ANDEQ'B'
    C                     GOTO FACO14                     COUPEUSE FACON
F1  C                     END
D1  C           FACON     IFEQ 0
    C           MASSI     ANDEQ'*'
    C           GFRA      ANDEQ*BLANKS
    C                     GOTO FACO24                     AFFICHE EN DEUX
F1  C                     END
    C*
    C                     GOTO DULIFI
     C/SPACE 2
     * PEINTURE SUR TRANCHE
     C           FACO27    TAG
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
X1  C                     ELSE
     C                     ADD  1         R
     C                     MOVE '8'       SECT
     C                     MOVE '0'       SSECT
     C                     Z-ADD2         USFAB
     C                     MOVE '01'      NOMAC
F1  C                     END
    C*
     C                     MOVELPTDIF     CLEREC    P
     *
     C           RAPDEC    ADD  DECROU    ROUDEC
     C           QTFAB     MULT ROUDEC    QTENET    H
     C           SUREG     DIV  SUVENT    REGL      H
     C           REGL      MULT 1000      REGL
     C           QTENET    ADD  REGL      QTENET
     *
D1  C           DSGP      IFEQ 'AB'
     C                     Z-ADDQTENES    QTENET
F1  C                     END
     *
D1  C           PTNBR     IFEQ *ZEROS
     C                     Z-ADD1         TBNSEG
     C                     MOVE ONDUL     XPTPA1
     C                     MOVELXPTPKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XPTPAQUE'TBLNOM
     C           KTBA01    CHAINXTBASE01             99
D2  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XPTP00
     C                     Z-ADDXPTP01    PTNBR
F2  C                     END
F1  C                     END
D1  C           PTNBR     IFNE *ZEROS
     C           QTENET    DIV  PTNBR     QTENET    H
F1  C                     END
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C           GPTEST    CABNE' '       FAFO27
     C                     EXSR CAPART
     *
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
F1  C                     END
     C                     EXSR CALPRI
     C           MOYCAD    MULT PTNBR     MOYCAD
     C                     WRITEPLANIFF1
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
    C                     GOTO DULIFI
F1  C                     END
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
D1  C           GPTEST    IFEQ ' '
     C                     EXSR RESULT                     CHAR.RESULTATS
F1  C                     END
     *
     C           FAFO27    TAG
    C           DECORT    CABEQ' '       FACO5            DECOUPAGE
    C           DECORT    CABEQ'0'       FACO5
    C                     GOTO FACO4                      DECORTICAGE
     *************************************
     C           DULIFI    TAG
    C*-------------------------
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'PR'
     C                     Z-ADDUSFABS    USFAB
F1  C                     END
     C/EJECT
     *************************************
     * pre-impression plus valorisation *****************************
     *************************************  module -J-
     C/SPACE 1
     C           MODULJ    TAG
    C           TYPDEV    CABEQ4         DULJFI
     *
     C/SPACE 1
D1  C           DSGP      IFEQ 'AB'
    C           DSGP      OREQ 'SU'
    C           SECTS     CABNE'1'       DULJFI
    C           SSECTS    CABEQ'3'       PASSAB
F1  C                     END
     C/SPACE 1
     C                     MOVE *ZEROS    DECFAC  42
     C                     MOVE *ZEROS    ROUL    54
     C                     MOVE *ZEROS    SUFIMP  10
     C                     MOVE *BLANKS   PR      1
     C                     MOVE *ZEROS    QTPREV  70
     C                     MOVE *ZEROS    RAPO    42
     C                     MOVE *ZEROS    SURGFA  50
     C                     MOVE *ZEROS    LAIZML  32
     C                     MOVE *BLANKS   NOMAC   2
     C                     MOVE *BLANKS   LET     1
     C                     MOVE *ZEROS    GROUPE  20
     C                     MOVE *ZEROS    GR      10
     C                     MOVE *ZEROS    KINDUS
     C                     MOVE *BLANKS   VER     1
     C                     MOVE *BLANKS   ENC
     C                     Z-ADD*ZEROS    COU
     C                     MOVE *ZEROS    SURIM   90
     C                     MOVE *ZEROS    DECINT  44
     C                     MOVE *ZEROS    DECEXT  44
D1  C           IMPIN     IFEQ 0
     C                     MOVE *ZEROS    INDEC   44
F1  C                     END
D1  C           IMPEX     IFEQ 0
     C                     MOVE *ZEROS    EXDEC   44
F1  C                     END
     C                     MOVE *ZEROS    DECIMP  44
     C                     MOVE *ZEROS    COUPRE  70
     C                     MOVE *ZEROS    DECPRE  44
     C                     MOVE *ZEROS    ROUL1   80
     C                     MOVE *ZEROS    ROUREN  60
     C                     MOVE *ZEROS    COUREN  70
     C                     MOVE *ZEROS    RUODEC  44
     C                     MOVE *ZEROS    SUF     90
     C                     MOVE *ZEROS    FOREG   70
     C                     MOVE *ZEROS    TREGMA 100
     C                     MOVE *BLANKS   COLO
     C                     MOVE *BLANKS   VERA
     C                     Z-ADD0         I
     C                     Z-ADD0         RIMPI   50
     C                     Z-ADD0         RIMPE   50
     C                     SETOF                     013839
     C                     SETOF                     931096
     C                     SETOF                     978687
     C                     SETOF                     11
     C                     MOVE *BLANK    UNPPAS
     C           SUREG     ADD  SUREGX    SURIMP
     C                     ADD  SURIMD    SURIMP
     C           SUREG     ADD  SUREGX    SUREGC  50
     C/SPACE 1
    C* suivi production
     * page C
D1  C           DSGP      IFEQ 'SU'
D2  C           SUIMPS    IFLE 3
D3  C           IMPEX     IFNE *ZEROS
    C           IMPEXT    ANDEQ*ZEROS
     C                     Z-ADDIMPEX     IMPEXT
F3  C                     END
X2  C                     ELSE
D3  C           IMPIN     IFNE *ZEROS
    C           IMPINT    ANDEQ*ZEROS
     C                     Z-ADDIMPEX     IMPINT
F3  C                     END
F2  C                     END
    C*
D2  C           IMPEXT    IFEQ 0
    C           IMPINT    ANDEQ0
    C           RIMPEX    ANDEQ0
    C           RIMPIN    ANDEQ0
    C           SSECTS    ANDEQ'3'
    C                     GOTO FACO14
F2  C                     END
    C*
D2  C           SUIMPS    IFLE 3
    C*
D3  C           IMPEXT    IFNE 0
D4  C           IMPEXT    IFNE 1
    C           IMPEXT    ANDNE2
    C           IMPEXT    ANDNE4
    C                     GOTO FIN
X4  C                     ELSE
D5  C           SSECTS    IFNE '1'
    C           SSECTS    ANDNE'2'
    C           SSECTS    ANDNE'4'
    C                     GOTO FIN
X5  C                     ELSE
     C                     SETON                     97
    C                     GOTO DULJ15
F5  C                     END
F4  C                     END
F3  C                     END
    C*
D3  C           RIMPEX    IFNE 0
D4  C           RIMPEX    IFNE 1
    C           RIMPEX    ANDNE2
    C           RIMPEX    ANDNE4
    C                     GOTO FIN
X4  C                     ELSE
D5  C           SSECTS    IFNE '1'
    C           SSECTS    ANDNE'2'
    C           SSECTS    ANDNE'4'
    C                     GOTO FIN
X5  C                     ELSE
     C                     SETON                     87
    C                     GOTO DULJ15
F5  C                     END
F4  C                     END
F3  C                     END
    C*
X2  C                     ELSE
    C*
D3  C           IMPINT    IFNE 0
D4  C           IMPINT    IFNE 1
    C           IMPINT    ANDNE2
    C           IMPINT    ANDNE4
    C                     GOTO FIN
X4  C                     ELSE
D5  C           SSECTS    IFNE '1'
    C           SSECTS    ANDNE'2'
    C           SSECTS    ANDNE'4'
    C                     GOTO FIN
X5  C                     ELSE
     C                     SETON                     96
    C                     GOTO DULJ15
F5  C                     END
F4  C                     END
F3  C                     END
    C*
D3  C           RIMPIN    IFNE 0
D4  C           RIMPIN    IFNE 1
    C           RIMPIN    ANDNE2
    C           RIMPIN    ANDNE4
    C                     GOTO FIN
X4  C                     ELSE
D5  C           SSECTS    IFNE '1'
    C           SSECTS    ANDNE'2'
    C           SSECTS    ANDNE'4'
    C                     GOTO FIN
X5  C                     ELSE
     C                     SETON                     86
    C                     GOTO DULJ15
F5  C                     END
F4  C                     END
F3  C                     END
    C*
F2  C                     END
     * page D
     C           DULJ15    TAG
     C                     MOVE SUIMPS    SUIMP
D2  C           QTPRE     IFEQ *ZEROS
     C                     MOVE 'R'       PR
     C                     SETON                     38
X2  C                     ELSE
     C                     MOVE 'P'       PR
     C                     SETON                     39
F2  C                     END
     C                     EXSR CHIMP                      CHARGEMENT IMP
     C                     Z-ADDQTENES    QTENET
D2  C           SSECTS    IFEQ '2'
    C                     GOTO ROTATI
X2  C                     ELSE
D3  C           SSECTS    IFEQ '1'
     C                     SETON                     11
    C                     GOTO ROTATI
X3  C                     ELSE
    C                     GOTO OFFSET
F3  C                     END
F2  C                     END
    C*
F1  C                     END
     C/SPACE 1
    C*
     C           RAPDEC    ADD  DECROU    ROUDEC
     * recherche des types pre-impression .
     C                     MOVE DECROU    DECFAC
     C                     ADD  SUPDEC    DECFAC
    C*
D1  C           DSGP      IFEQ 'AB'
     C           PROBJ     COMP 'P'                      39
     C           PROBJ     COMP 'R'                      38
    C                     GOTO DULJ2
F1  C                     END
    C*
D1  C           QTPRE     IFEQ 0
    C           QTREN     CABNE0         DULJ1
    C                     GOTO DULJFI
    C*
     C           DULJ19    TAG
     C                     Z-ADDSUPEXT    S
D2  C           S         IFNE *ZERO
D3  C           RIMPEX    IFNE 3
    C           RIMPEX    ANDNE0
     C                     SETON                     87
    C                     GOTO QTEIMP
F3  C                     END
F2  C                     END
    C                     GOTO DULJFI
    C*
X1  C                     ELSE
     C                     SETON                     39
    C           QTREN     CABNE0         DULJ1
    C           QTREN     CABEQ0         DULJ2
F1  C                     END
     *
     C           DULJ1     TAG
     C                     SETON                     38
     *
     C           DULJ2     TAG
     C  N01                ADD  1         R
    C           APPIN     CABEQ'O'       DULJ35
    C           IMPINT    CABEQ0         DULJ3
    C           IMPINT    CABEQ3         DULJ35
    C           IMPINT    CABEQ5         DULJ35
     C                     SETON                     96
     C                     Z-ADDSUPINT    S
    C           RIMPIN    CABEQ0         QTEIMP
    C           RIMPIN    CABEQ3         QTEIMP
    C           RIMPIN    CABNE3         QTEIMP     8686
     *
     C           DULJ3     TAG
     C                     Z-ADDSUPINT    S
D1  C           S         IFNE *ZERO
D2  C           RIMPIN    IFNE 3
    C           RIMPIN    ANDNE0
     C                     SETON                     86
    C                     GOTO QTEIMP
F2  C                     END
F1  C                     END
     C           DULJ35    TAG
    C           APPEX     CABEQ'O'       DULJFI
D1  C           IMPEXT    IFEQ 0                          INTERIEUR
    C           RIMPEX    ANDEQ0                            UNIQUEMENT
    C                     GOTO STMAS
F1  C                     END
    C           IMPEXT    CABEQ0         DULJ19
    C           IMPEXT    CABEQ3         DULJFI
    C           IMPEXT    CABEQ5         DULJFI
     C                     SETON                     97
     C                     Z-ADDSUPEXT    S
    C           RIMPEX    CABEQ0         QTEIMP
    C           RIMPEX    CABEQ3         QTEIMP
    C           RIMPEX    CABNE3         QTEIMP     8787
     C/SPACE 1
     C           QTEIMP    TAG
    C*          ----------------
     *
     C                     EXSR CHIMP                      CHARGEMENT IMP
D1  C           ROUL      IFEQ 0
     C                     Z-ADD1,0000    ROUL
F1  C                     END
D1  C           *IN39     IFEQ '0'
    C           *IN01     OREQ '1'
     C           SUIMPR    MULT ROUL      QTEB      H
     C                     MOVE 'R'       PR
     C                     Z-ADDQTREN     QTPREV
     C           QTREN     DIV  QTFAB     RAPO      H
     *
X1  C                     ELSE
     C           SUIMP1    MULT ROUL      QTEB      H
     C                     MOVE 'P'       PR      1
     C                     Z-ADDQTPRE     QTPREV  70
     C           QTPRE     DIV  QTFAB     RAPO      H
F1  C                     END
     *
     C           SUREGC    MULT RAPO      SURGFA  50H
     C           QTEB      ADD  SURGFA    QTEB
    C*
D1  C           *IN72     IFEQ '1'
    C           *IN01     ANDEQ'1'
    C           *IN73     OREQ '1'
    C           *IN01     ANDEQ'1'
     C                     SETON                     52
F1  C                     END
    C*
D1  C           SUIMP     IFEQ 4
D2  C           TALO,4    IFNE 0,00
     C           QTEB      MULT TALO,4    QTEB      H
F2  C                     END
F1  C                     END
    C*
D1  C           CCOL      IFEQ 9                          SIMPLE DF
D2  C           SUIMP     IFEQ 3                          IMP. CANNELURE
D3  C           TALO,3    IFNE 0,00
     C           QTEB      MULT TALO,3    QTEB      H
F3  C                     END
F2  C                     END
D2  C           SUIMP     IFEQ 5
D3  C           TALO,5    IFNE 0,00
     C           QTEB      MULT TALO,5    QTEB      H
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
     C                     ADD  RIMPI     QTEB
D2  C           *IN86     IFEQ '1'                         REPRISE
D3  C           RIMPIN    IFNE 4
D4  C           LMINI     IFEQ 0
     C                     MOVELFORL      LAIZML
     C           QTEB      DIV  LAIZML    QTENET
    C                     GOTO DULJ8
X4  C                     ELSE
    C                     GOTO DULJ7
F4  C                     END
X3  C                     ELSE
    C                     GOTO DULJ71
F3  C                     END
F2  C                     END
    C           IMPINT    CABNE4         DULJ7
D2  C           *IN13     IFEQ '1'                        PRINCIPALE
    C           LMINI     CABNE0         DULJ7
     C                     MOVELFORL      LAIZML
     C           QTEB      DIV  LAIZML    QTENET
    C                     GOTO DULJ8
F2  C                     END
     C           DULJ71    TAG
D2  C           FACON     IFEQ 4
     C                     MOVELSBDEC     SBDE    76
     C           QTEB      DIV  SBDE      QTENET
    C                     GOTO DULJ8
F2  C                     END
     C           QTEB      DIV  SBFE      QTENET    H
    C                     GOTO DULJ8
X1  C                     ELSE
     C                     ADD  RIMPE     QTEB
D2  C           *IN87     IFEQ '1'                        REPRISE
D3  C           RIMPEX    IFNE 4
D4  C           LMINI     IFEQ 0
     C                     MOVELFORL      LAIZML
     C           QTEB      DIV  LAIZML    QTENET
    C                     GOTO DULJ8
X4  C                     ELSE
    C                     GOTO DULJ7
F4  C                     END
X3  C                     ELSE
    C                     GOTO DULJ72
F3  C                     END
F2  C                     END
    C           IMPEXT    CABNE4         DULJ7
D2  C           *IN13     IFEQ '1'                        PRINCIPALE
    C           LMINI     CABNE0         DULJ7
     C                     MOVELFORL      LAIZML
     C           QTEB      DIV  LAIZML    QTENET
    C                     GOTO DULJ8
F2  C                     END
     C           DULJ72    TAG
D2  C           FACON     IFEQ 4
     C                     MOVELSBDEC     SBDE    76
     C           QTEB      DIV  SBDE      QTENET
    C                     GOTO DULJ8
F2  C                     END
     C           QTEB      DIV  SBFE      QTENET    H
    C                     GOTO DULJ8
F1  C                     END
     C           DULJ7     TAG
D1  C           LMINI     IFNE *ZEROS
     C                     MOVELLMINI     LAIZML  32
X1  C                     ELSE
     C                     MOVELONDL      LAIZML
F1  C                     END
     C           QTEB      DIV  LAIZML    QTENET    H
     *
     C           DULJ8     TAG
    C*          ---------------
D1  C           ONDUL     IFEQ 7                           GAUFRE
     C                     MULT 1,16      QTENET
F1  C                     END
    C*
    C           *IN13     CABEQ'1'       PASSAB           PASSABAN
D1  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
D2  C           *IN86     IFEQ '1'
     C                     Z-ADDSUPINT    S
    C           RIMPIN    CABEQ2         ROTATI              FELXO
    C           RIMPIN    CABEQ1         ROTATI         11   HELIO
    C           RIMPIN    CABEQ4         OFFSET              OFFSET
X2  C                     ELSE
    C           IMPINT    CABEQ1         ROTATI         11   HELIO
    C           IMPINT    CABEQ2         ROTATI              FLEXO
    C           IMPINT    CABEQ4         OFFSET              OFFSET
F2  C                     END
     *
X1  C                     ELSE
D2  C           *IN87     IFEQ '1'
     C                     Z-ADDSUPEXT    S
    C           RIMPEX    CABEQ2         ROTATI              FELXO
    C           RIMPEX    CABEQ1         ROTATI         11   HELIO
    C           RIMPEX    CABEQ4         OFFSET              OFFSET
X2  C                     ELSE
    C           IMPEXT    CABEQ1         ROTATI         11   HELIO
    C           IMPEXT    CABEQ2         ROTATI              FLEXO
    C           IMPEXT    CABEQ4         OFFSET
F2  C                     END
F1  C                     END
     C/SPACE 2
     * rotatives .
     C           ROTATI    TAG
    C           *IN10     CABEQ'1'       DULJ20
     C                     Z-ADD0         I
D1  C           *IN76     IFEQ '1'
    C           *IN77     OREQ '1'
D2  C           LUTIL     IFNE *ZEROS
     C                     Z-ADDLUTIL     LAIZ    30
X2  C                     ELSE
D3  C           LMINI     IFNE *ZEROS
     C                     Z-ADDLMINI     LAIZ
X3  C                     ELSE
D4  C           ONDL      IFNE *ZEROS
     C                     MOVELONDL      LAIZ
X4  C                     ELSE
     C                     MOVELDECL      LAIZ
F4  C                     END
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           LUTIL     IFNE *ZEROS
     C                     Z-ADDLUTIL     LAIZ
X2  C                     ELSE
     C                     Z-ADDLMINI     LAIZ
F2  C                     END
F1  C                     END
     C                     MOVE *BLANKS   QUAPAR  3
     C                     Z-ADD*ZEROS    GRAPAR  30
     C                     MOVE *BLANKS   ADPPAR  6
     C                     Z-ADD*ZEROS    AGDPAR  30
D1  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
     C                     MOVE USINT     USFAB
D2  C           *IN73     IFEQ '1'
     C                     MOVE QUAPAI    QUAPAR
     C                     Z-ADDGRAPAI    GRAPAR
     C                     MOVE ADPPAI    ADPPAR
     C                     Z-ADDADGPAI    AGDPAR
     C                     MULT NBPICX    LAIZ
F2  C                     END
X1  C                     ELSE
     C                     MOVE USEXT     USFAB
D2  C           CCOL      IFEQ 6                          CANNELURES
    C           ICEI3     ANDEQ'O'
D3  C           ONDH      IFNE *ZEROS
     C                     MOVELONDH      LAIZ
X3  C                     ELSE
     C                     MOVELDECH      LAIZ
F3  C                     END
F2  C                     END
D2  C           *IN72     IFEQ '1'
     C                     MOVE QUAPAE    QUAPAR
     C                     Z-ADDGRAPAE    GRAPAR
     C                     MOVE ADPPAE    ADPPAR
     C                     Z-ADDADGPAE    AGDPAR
     C                     MULT NBPECX    LAIZ
F2  C                     END
F1  C                     END
     C         U5          MOVE USINE     USFAB
     *
    C*
D1  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
    C           *IN86     CABEQ'0'       DULJ11           PRINCIPALE
X1  C                     ELSE
    C           *IN87     CABEQ'0'       DULJ11           PRINCIPALE
F1  C                     END
     * REPIQUAGE
     C                     Z-ADDRCOU      GROUPE
D1  C           ORCUR     IFNE *BLANKS
     C                     MOVELORCUR     LET     1
D2  C           LET       IFEQ 'C'
     C                     ADD  2         GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
F1  C                     END
     C                     Z-ADDGROUPE    GR
D1  C           *IN87     IFEQ '1'
     C                     ADD  GPEXR     GR
X1  C                     ELSE
     C                     ADD  GPINR     GR
F1  C                     END
D1  C           GROUPE    IFNE 0
     C                     ADD  1         I
     C                     MOVE GROUPE    COLO,I
F1  C                     END
D1  C           RVER      IFEQ *BLANKS
    C                     GOTO DULJ20
F1  C                     END
D1  C           TIMP      IFNE 2
D2  C           RVER      IFEQ 'T'
     C                     ADD  1         I
     C                     MOVE RVER      VERA,I
    C                     GOTO DULJ20
F2  C                     END
D2  C           RVER      IFEQ 'P'
     C                     ADD  1         I
     C                     MOVE RVER      VERA,I
     C                     ADD  1         I
     C                     MOVE RVER      VERA,I
    C                     GOTO DULJ20
F2  C                     END
F1  C                     END
D1  C           GROUPE    IFEQ 0
     C                     ADD  1         I
F1  C                     END
     C                     MOVE RVER      VERA,I
    C                     GOTO DULJ20
     * PRINCIPALE
     C           DULJ11    TAG
     C                     Z-ADDCOUL      GROUPE
D1  C           ORCU      IFNE *BLANKS
     C                     MOVELORCU      LET     1
D2  C           LET       IFEQ 'C'
     C                     ADD  2         GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
F1  C                     END
    C*
     C                     Z-ADDGROUPE    GR      10
D1  C           *IN97     IFEQ '1'
     C                     ADD  GPEX      GR
X1  C                     ELSE
     C                     ADD  GPIN      GR
F1  C                     END
    C*
    C* ordonnancement ou suivi
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SU'
    C           DSGP      OREQ 'A5'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'AB'
    C           DSGP      OREQ 'PR'
    C                     GOTO DULJ18
F1  C                     END
    C*
D1  C           *IN11     IFEQ '0'
    C           USFAB     CABLT3         DULJ18
D2  C           GR        IFGT 3
     C                     MOVE '01'      NOMAC
F2  C                     END
    C                     GOTO DULJ18
F1  C                     END
D1  C           *IN11     IFEQ '1'
D2  C           USFAB     IFLT 3
D3  C           GR        IFGT 7
     C                     MOVE '02'      NOMAC
F3  C                     END
    C                     GOTO DULJ18
F2  C                     END
D2  C           USFAB     IFGT 3
D3  C           GR        IFGT 7
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVE 24        ERR1,A
     C                     MOVE 'GROUPE  'ERR2,A
     C                     MOVE GR        ERR2,A
     C                     MOVEL'USINE'   Z7A     7
     C                     MOVE USINE     Z7A
     C                     MOVELZ7A       ERR2,A
F3  C                     END
    C                     GOTO DULJ18
F2  C                     END
F1  C                     END
     *
     C           DULJ18    TAG
D1  C           GROUPE    IFNE 0
     C                     ADD  1         I
     C                     MOVE GROUPE    COLO,I
F1  C                     END
    C           TVER      CABEQ*BLANKS   DULJ20
D1  C           TIMP      IFNE 2
D2  C           TVER      IFEQ 'T'
     C                     ADD  1         I
     C                     MOVE TVER      VERA,I
    C                     GOTO DULJ20
F2  C                     END
D2  C           TVER      IFEQ 'P'
D3  C           *IN11     IFEQ '0'
     C                     ADD  1         I
     C                     MOVE TVER      VERA,I
F3  C                     END
     C                     ADD  1         I
     C                     MOVE TVER      VERA,I
    C                     GOTO DULJ20
F2  C                     END
F1  C                     END
D1  C           GROUPE    IFEQ 0
     C                     ADD  1         I
F1  C                     END
     C                     MOVE TVER      VERA,I
     *
     C           DULJ20    TAG
     C                     MOVE '1'       SECT
D1  C           *IN11     IFEQ '1'                        HELIO
     C                     MOVE '1'       SSECT
X1  C                     ELSE
     C                     MOVE '2'       SSECT            FLEXO
F1  C                     END
    C* TARIF COMMERCIAL
D1  C           CDE       IFEQ 1
D2  C           *IN11     IFEQ '1'                        HELIO
     C                     MOVE '02'      NOMAC
     C                     Z-ADD2         USFAB
    C*
X2  C                     ELSE                            FLEXO
D3  C           VERA,I    IFEQ 'I'
    C*                    MOVE '02'      NOMAC
     C                     MOVE '01'      NOMAC
     C                     MOVE 'E'       CXHTRA
X3  C                     ELSE
     C                     MOVE '01'      NOMAC
D4  C           COUPE     IFNE 'R'
    C           GR        ANDLT3
    C           LAIZ      ANDLE140
    C*                    MOVE '02'      NOMAC
     C                     MOVE '01'      NOMAC
F4  C                     END
F3  C                     END
D3  C           VERA,I    IFEQ 'C'
     C                     MOVE '01'      NOMAC
F3  C                     END
     C                     Z-ADD3         USFAB
F2  C                     END
    C                     GOTO DULJ21
    C* TARIF    PRU
X1  C                     ELSE
     *
    C* suivi production
D2  C           DSGP      IFEQ 'SU'
     C                     MOVE NOMACS    NOMAC
    C                     GOTO DULJ21
F2  C                     END
    C* ordonnancement
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'A5'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'AB'
    C           DSGP      OREQ 'PR'
D3  C           *IN97     IFEQ '1'                        PRINCIPALE
    C           *IN87     ANDEQ'0'
D4  C           MAIME1    IFNE *ZEROS
     C                     MOVE MAIME1    NOMAC
X4  C                     ELSE
     C                     MOVE '1'       INN
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FINPAS
     C                     MOVE NOMAC1    NOMAC
F4  C                     END
    C                     GOTO DULJ21
F3  C                     END                             REPIQUAGE
D3  C           *IN87     IFEQ '1'
D4  C           MAIRE1    IFNE *ZEROS
     C                     MOVE MAIRE1    NOMAC
X4  C                     ELSE
     C                     MOVE '2'       INN
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FINPAS
     C                     MOVE NOMAC1    NOMAC
F4  C                     END
    C                     GOTO DULJ21
F3  C                     END
D3  C           *IN96     IFEQ '1'                        PRINCIPALE
    C           *IN86     ANDEQ'0'
D4  C           MAIMI1    IFNE *ZEROS
     C                     MOVE MAIMI1    NOMAC
X4  C                     ELSE
     C                     MOVE '3'       INN
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FINPAS
     C                     MOVE NOMAC1    NOMAC
F4  C                     END
    C                     GOTO DULJ21
F3  C                     END
D3  C           *IN86     IFEQ '1'                        REPIQUAGE
D4  C           MAIRI1    IFNE *ZEROS
     C                     MOVE MAIRI1    NOMAC
X4  C                     ELSE
     C                     MOVE '4'       INN
     C                     EXSR RECMAC
    C           NOMAC1    CABEQ*ZEROS    FINPAS
     C                     MOVE NOMAC1    NOMAC
F4  C                     END
    C                     GOTO DULJ21
F3  C                     END
F2  C                     END
    C*          VERA,I    IFEQ 'E'
    C*          *IN12     ANDEQ'1'
D2  C           VERA,I    IFEQ 'I'
    C           *IN12     ANDEQ'1'
     C                     MOVE 'E'       CXHTRA
F2  C                     END
     *
F1  C                     END
     C           DULJ21    TAG
    C* HELIO
D1  C           *IN11     IFEQ '1'
     C                     MOVE COLO,I    HELCOU
     C                     MOVE VERA,I    HELVER
D2  C           HELVER    IFEQ 'T'
    C           HELVER    OREQ 'P'
     C                     MOVE *BLANKS   HELABC
     C                     MOVE *BLANKS   HELTS
X2  C                     ELSE
D3  C           DDECOR    IFEQ ' '
     C                     MOVE 'B'       HELABC
X3  C                     ELSE
     C                     MOVE DDECOR    HELABC
F3  C                     END
D3  C           *IN86     IFEQ '1'                        REPIQUAGE
    C           *IN87     OREQ '1'
D4  C           S         IFLE 3
     C                     MOVE TSEXTR    HELTS
X4  C                     ELSE
     C                     MOVE TSINTR    HELTS
F4  C                     END
X3  C                     ELSE                            PRINCIPAL
D4  C           S         IFLE 3
     C                     MOVE TSEXT     HELTS
X4  C                     ELSE
     C                     MOVE TSINT     HELTS
F4  C                     END
F3  C                     END
F2  C                     END
    C*
     C   39N01             MOVE 'P'       HELPR
     C  N39
     COR 39 01             MOVE 'R'       HELPR
     C                     MOVELDSHELI    CLEREC
X1  C                     ELSE
    C*
     C                     MOVE COLO,I    FLECOU
     C                     MOVE VERA,I    FLEVER
D2  C           FLEVER    IFEQ 'T'
    C           FLEVER    OREQ 'P'
    C           FLEVER    OREQ 'E'
    C           FLECOU    ANDEQ*ZEROS
    C           FLEVER    OREQ 'I'
    C           FLECOU    ANDEQ*ZEROS
     C                     MOVE *BLANKS   FLEABC
     C                     MOVE *BLANKS   FLETS
X2  C                     ELSE
D3  C           DDECOR    IFEQ ' '
     C                     MOVE 'B'       FLEABC
X3  C                     ELSE
     C                     MOVE DDECOR    FLEABC
F3  C                     END
D3  C           *IN86     IFEQ '1'                        REPIQUAGE
    C           *IN87     OREQ '1'
D4  C           S         IFLE 3
     C                     MOVE TSEXTR    FLETS
X4  C                     ELSE
     C                     MOVE TSINTR    FLETS
F4  C                     END
X3  C                     ELSE                            PRINCIPAL
D4  C           S         IFLE 3
     C                     MOVE TSEXT     FLETS
X4  C                     ELSE
     C                     MOVE TSINT     FLETS
F4  C                     END
F3  C                     END
F2  C                     END
     C  N39
     COR 39 01             MOVE 'R'       FLEPR
     C   39N01             MOVE 'P'       FLEPR
     C                     MOVELDSFLEX    CLEREC
     *
F1  C                     END
     C                     EXSR PONDI1                     PONDERATIONS
     C                     EXSR NORSTD                     NORMES STD.
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
     C                     EXSR CAPART                     CAS PARTICUL
     C                     EXSR PONDI1                     PONDERATIONS
     C                     EXSR PONDIM                     PONDERATIONS
    C                     GOTO FINPAS
     C/SPACE 3
    C* PASSAGE OFFSET
    C*-------------------------
     C/SPACE 1
     C           OFFSET    TAG
    C*          ---------------
     * page 1
D1  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
     C                     Z-ADDSUPINT    S
D2  C           DSGP      IFEQ 'SP'
    C           USSPI     ANDNE*BLANKS
     C                     MOVE USSPI     USFAB
X2  C                     ELSE
     C                     MOVE USINT     USFAB
     * Nouvelle OFFSET
D3  C           OTCOEP    IFNE *ZEROS
     C                     Z-ADDUSIMAC    USFAB
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           *IN97     IFEQ '1'
    C           *IN87     OREQ '1'
     C                     Z-ADDSUPEXT    S
D2  C           DSGP      IFEQ 'SP'
    C           USSPE     ANDNE*BLANKS
     C                     MOVE USSPE     USFAB
X2  C                     ELSE
     C                     MOVE USEXT     USFAB
     * Nouvelle OFFSET
D3  C           OTCOEP    IFNE *ZEROS
     C                     Z-ADDUSIMAC    USFAB
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           USFAB     IFEQ *ZERO
D2  C           *IN86     IFEQ '1'                         REPRISE
    C           *IN87     OREQ '1'
     C                     MOVE USINE     USFAB
F2  C                     END
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D3  C           *IN31     IFEQ '1'
D4  C           USDEC     IFNE *ZEROS
     C                     Z-ADDUSDEC     USFAB
X4  C                     ELSE
     C                     Z-ADDUSINE     USFAB
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C   U5                MOVE USINE     USFAB
    C*
     C                     MOVE *BLANK    SVU5    1
D1  C           USFAB     IFEQ 5
     C                     Z-ADD2         USFAB
D2  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
     C                     Z-ADD7         MAIMI1
F2  C                     END
D2  C           *IN97     IFEQ '1'
    C           *IN87     OREQ '1'
     C                     Z-ADD7         MAIME1
F2  C                     END
     C                     MOVE '*'       SVU5             SI OFFSET CH
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE UV        ENC
     C                     MOVE TVER      VER
D2  C           ENC       IFEQ 'F'
     C                     MOVE ENC       ENCALI  1
     C                     MOVE *BLANKS   ENC
X2  C                     ELSE
D3  C           ENC       IFEQ 'G'
     C                     MOVE ENC       ENCALI
     C                     MOVE 'U'       ENC
X3  C                     ELSE
D4  C           ENC       IFEQ 'N'
     C                     MOVE ENC       ENCALI
     C                     MOVE *BLANKS   ENC
X4  C                     ELSE
D5  C           ENC       IFEQ 'O'
     C                     MOVE ENC       ENCALI
     C                     MOVE 'U'       ENC
X5  C                     ELSE
     C                     MOVE *BLANK    ENCALI
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
    C                     GOTO OFFS1
F1  C                     END
    C*
D1  C           *IN38     IFEQ '1'
D2  C           POSF1     IFNE *ZEROS
     C           QTREN     DIV  POSF1     QTNETR  70
X2  C                     ELSE
     C                     Z-ADDQTREN     QTNETR
F2  C                     END
     C           QTNETR    MULT 1,08      QTNETR    H
X1  C                     ELSE
     C                     Z-ADDQTENET    QTNETR
F1  C                     END
    C*
    C           *IN10     CABEQ'1'       OFFO             PAS 1° FOIS
     C                     SETOF                     636465
     C                     SETOF                     666267
     C                     SETOF                     61
     C                     SETOF                     585960
     C                     Z-ADD*ZEROS    TMA
    C********************************************
    C* Passage OFFSET non standard 3B et autres *
    C********************************************
D1  C           OTCOEP    IFNE *ZEROS
     C                     EXSR PAS3B
    C                     GOTO OFFO
X1  C                     ELSE
     C                     EXSR RAZ3B
F1  C                     END
    C*
D1  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X1  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F1  C                     END
    C*
D1  C           *IN86     IFEQ '1'                         REPRISE
    C           *IN87     OREQ '1'                         --------
     C                     Z-ADDRCOU      COULES
D2  C           ORCUR     IFNE *BLANKS
     C                     ADD  1         COULES
F2  C                     END
     C                     MOVE RVER      VERX    1
     C                     MOVE RUV       UVX     1
X1  C                     ELSE                             PRINCIPAL
     C                     Z-ADDCOUL      COULES
D2  C           ORCU      IFNE *BLANKS
     C                     ADD  1         COULES
F2  C                     END
     C                     MOVE TVER      VERX
     C                     MOVE UV        UVX
F1  C                     END
     C/SPACE 3
    C* ------------------------------------------------------------- *
    C*                          TARIF PRU                            *
    C* ------------------------------------------------------------- *
D1  C           CDE       IFNE 1
    C*
D2  C           USFAB     IFEQ 5
     C                     SETON                     67    SOUS TRAIT.
    C                     GOTO OFFA                       CHABANAIS
X2  C                     ELSE
    C*
D3  C           USFAB     IFEQ 4
D4  C           DEFIL     IFLE 720
    C           OUVERT    ANDLE1030
     C                     SETON                     65    NEUVILLE
    C                     GOTO OFFA                       PETIT
F4  C                     END
D4  C           DEFIL     IFLE 1030
    C           OUVERT    ANDLE1420
     C                     SETON                     66    NEUVILLE
    C                     GOTO OFFA                       GRAND
F4  C                     END
F3  C                     END
    C*
D3  C           USFAB     IFEQ 7
D4  C           DEFIL     IFLE 1035
    C           OUVERT    ANDLE1420
     C                     SETON                     58    FEGERSHEIM
    C                     GOTO OFFA                       GRAND
X4  C                     ELSE
     C                     SETON                     59    FEGERSHEIM
    C                     GOTO OFFA                       TRES GRAND
F4  C                     END
F3  C                     END
    C*
D3  C           OUVERT    IFGT 1420
    C           DEFIL     ORGT 1035
     C                     SETON                     64    SOUS TRAIT.
    C                     GOTO OFFA                       TRES GRAND
F3  C                     END
     C                     SETON                     62    GRAND FORMAT
    C*
F2  C                     END
     C/SPACE 1
X1  C                     ELSE
    C* ------------------------------------------------------------- *
    C*                         TARIF COMMERCIAL                      *
    C* ------------------------------------------------------------- *
    C*
    C* Format <= 600 X 800                      Membre OFCOMP
D2  C           DEFIL     IFLE 600
    C           OUVERT    ANDLE800
     C                     SETON                     65
X2  C                     ELSE
    C* Format >  600 X 800  Et <= 1035 X 1420   Membre OFCOMM
D3  C           DEFIL     IFLE 1035
    C           OUVERT    ANDLE1420
     C                     SETON                     62
X3  C                     ELSE
    C* Format >  1035 X 1420 Et <= 1050 X 1450  Membre OFCOMG
D4  C           DEFIL     IFLE 1050
    C           OUVERT    ANDLE1450
     C                     SETON                     64
X4  C                     ELSE
    C* Format >  1050 X 1450                    Membre OFCOMF
     C                     SETON                     60
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 1
     * page 2
     C           OFFA      TAG
    C*          ---------------
     C                     MOVE TVER      TVERSS  1
    C*
D1  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'A5'
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D2  C           *IN96     IFEQ '1'
D3  C           MAIMI1    IFEQ 07
     C                     SETOF                     626665
     C                     SETON                     64
     C                     SETOF                     605958
F3  C                     END
X2  C                     ELSE
D3  C           MAIME1    IFEQ 07
     C                     SETOF                     626665
     C                     SETON                     64
     C                     SETOF                     605958
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           OFP1      IFEQ *ZERO
    C                     GOTO PASSTD                      STANDARD
X1  C                     ELSE
    C                     GOTO PASIMP                      IMPOSE
F1  C                     END
    C*
     C/SPACE 1
     * page 8
    C* ------------------------------------------------------------- *
    C*                     PASSAGE IMPOSE                            *
    C* ------------------------------------------------------------- *
     C           PASIMP    TAG
    C*          ---------------
    C*                         TARIF COMMERCIAL                      *
    C* ------------------------------------------------------------- *
     C                     MOVE VERX      VERSAV  1        FB 21/07/14
D1  C           CDE       IFEQ 1
     C                     Z-ADD0         KINDUS
     C                     Z-ADDCOULES    GROUPE
D2  C           VERX      IFNE *BLANK
     C                     ADD  1         GROUPE
D3  C           VERX      IFEQ 'D'
     C                     ADD  1         GROUPE
     C                     MOVE 'U'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'P'
     C                     MOVE 'U'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'N'                        GJ 19/04/11
    C           VERX      OREQ 'G'                        GJ 20/12/12
    C           VERX      OREQ 'M'                        GJ 05/04/13
    C           VERX      OREQ 'A'                        FB 10/06/14
    C           VERX      OREQ 'C'                        FB 10/06/14
     C                     MOVE 'F'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'T'                        GJ 19/04/11
    C           VERX      OREQ 'H'                        FB 10/06/14
    C           VERX      OREQ 'B'                        FB 10/06/14
     C                     MOVE 'K'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'O'
    C           VERX      OREQ 'Q'                        FB 10/06/14
    C           VERX      OREQ 'E'                        FB 10/06/14
    C           VERX      OREQ 'J'                        FB 10/06/14
    C           VERX      OREQ 'I'                        FB 10/06/14
    C           VERX      OREQ 'R'                        FB 10/06/14
    C           VERX      OREQ 'S'                        FB 17/07/14
     C                     MOVE 'U'       VERX
F3  C                     END
F2  C                     END
     C/SPACE 1
     * page 9
     C                     ADD  1         I
D2  C           UVX       IFEQ 'U'
    C           UVX       OREQ 'G'
    C           UVX       OREQ 'O'
     C                     MOVE 'U'       ENC
F2  C                     END
D2  C           UVX       IFEQ 'F'
    C           UVX       OREQ 'G'
    C           UVX       OREQ 'N'
    C           UVX       OREQ 'O'
     C                     MOVE UVX       ENCALI
X2  C                     ELSE
     C                     MOVE *BLANK    ENCALI
F2  C                     END
     C/SPACE 1
D2  C           GROUPE    IFLE OFP1
     C           OFFG2     TAG
    C*          ---------------
    C           VERX      CABEQ*BLANK    OFFD12
     C                     MOVE GROUPE    COLOR
     C                     MOVE VERX      VERA,I
     C                     SUB  1         GROUPE
D3  C           GROUPE    IFEQ *ZEROS
    C           VERX      ANDEQ'U'
    C* RECHERCHE MACHINE OFPAS
     C                     MOVE VERX      VER
     C                     MOVE COLOR     COU
     C                     EXSR SPOFP
     C                     Z-ADDTYPE1     TMA,I
    C                     GOTO OFFF2
F3  C                     END
D3  C           GROUPE    IFNE *ZEROS
     C                     MOVE GROUPE    COLO,I
     C                     Z-ADD*ZEROS    GROUPE
    C                     GOTO OFFE2
F3  C                     END
D3  C           GROUPE    IFEQ *ZEROS
    C           VERX      ANDNE'U'
     C                     Z-ADD1         COLOR   10
    C                     GOTO OFFE2
F3  C                     END
    C*
X2  C                     ELSE
     C           OFFD12    TAG
    C*          ---------------
D3  C           *IN63     IFEQ '0'
     C                     MOVE OFP1      COLO,I
     C           GROUPE    SUB  OFP1      GROUPE
X3  C                     ELSE
     C                     MOVE OFP2      COLO,I
     C           GROUPE    SUB  OFP2      GROUPE
F3  C                     END
     C                     MOVE COLO,I    COLOR
    C                     GOTO OFFE2
F2  C                     END
     C/SPACE 1
     * pages 10  11
     C           OFFE2     TAG
    C*          ---------------
D2  C           COLOR     IFGT 7
    C                     GOTO PASSTD
F2  C                     END
    C*
    C* RECHERCHE MACHINE OFPAS
     C                     MOVE VERX      VER
     C                     MOVE COLOR     COU
     C                     EXSR SPOFP
     C                     Z-ADDTYPE1     TMA,I
    C                     GOTO OFFF2
     C/SPACE 1
     * pages 13
     C           OFFF2     TAG
    C*          ---------------
D2  C           *IN63     IFEQ '1'
D3  C           GROUPE    IFEQ *ZERO
    C                     GOTO OFFO
F3  C                     END
    C*
     C                     ADD  1         I
D3  C           VERX      IFNE *BLANK
D4  C           GROUPE    IFEQ 1
     C                     MOVE VERX      VERA,I
D5  C           VERX      IFEQ 'U'
    C* RECHERCHE MACHINE OFPAS
     C                     MOVE VERX      VER
     C                     MOVE COLOR     COU
     C                     EXSR SPOFP
     C                     Z-ADDTYPE1     TMA,I
     C                     Z-ADD*ZEROS    GROUPE
    C                     GOTO OFFO
X5  C                     ELSE
    C                     GOTO OFFF42
F5  C                     END
X4  C                     ELSE
     C                     MOVE VERX      VER
     C                     SUB  1         GROUPE
     C                     Z-ADDGROUPE    COU
    C                     GOTO OFFF42
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDGROUPE    COU
     C           OFFF42    TAG
    C*          ---------------
D4  C           UVX       IFEQ 'V'
     C                     MOVE 'V'       ENC
F4  C                     END
     C                     Z-ADD0         KINDUS
D4  C           *IN64     IFEQ '1'
    C* RECHERCHE MACHINE OFPAS
     C                     MOVE VERX      VER
     C                     MOVE COLOR     COU
     C                     EXSR SPOFP
     C                     Z-ADDTYPE1     TMA,I
F4  C                     END
    C                     GOTO OFFM
F3  C                     END
    C*
X2  C                     ELSE
    C           GROUPE    CABEQ*ZEROS    OFFO
     C                     ADD  1         I
D3  C           GROUPE    IFLE OFP2
     C                     SETON                     63
    C                     GOTO OFFG2
X3  C                     ELSE
     C                     MOVE OFP2      COLO,I
     C           GROUPE    SUB  OFP2      GROUPE
     C                     MOVE COLO,I    COLOR
     C                     SETON                     63
    C                     GOTO OFFE2
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
    C*                          TARIF PRU                            *
    C* ------------------------------------------------------------- *
     C                     Z-ADDCOULES    GROUPE
D2  C           VERX      IFNE *BLANK
     C                     ADD  1         GROUPE
D3  C           VERX      IFEQ 'D'
     C                     ADD  1         GROUPE
     C                     MOVE 'U'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'P'
     C                     MOVE 'U'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'N'                        GJ 19/04/11
    C           VERX      OREQ 'G'                        GJ 20/12/12
    C           VERX      OREQ 'M'                        GJ 05/04/13
    C           VERX      OREQ 'A'                        FB 10/06/14
    C           VERX      OREQ 'C'                        FB 10/06/14
     C                     MOVE 'F'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'T'                        GJ 19/04/11
    C           VERX      OREQ 'H'                        FB 10/06/14
    C           VERX      OREQ 'B'                        FB 10/06/14
     C                     MOVE 'K'       VERX
F3  C                     END
D3  C           VERX      IFEQ 'O'
    C           VERX      OREQ 'Q'                        FB 10/06/14
    C           VERX      OREQ 'E'                        FB 10/06/14
    C           VERX      OREQ 'J'                        FB 10/06/14
    C           VERX      OREQ 'I'                        FB 10/06/14
    C           VERX      OREQ 'R'                        FB 10/06/14
    C           VERX      OREQ 'S'                        FB 17/07/14
     C                     MOVE 'U'       VERX
F3  C                     END
F2  C                     END
     C/SPACE 1
     * page 9
     C                     ADD  1         I
D2  C           UVX       IFEQ 'U'
    C           UVX       OREQ 'G'
    C           UVX       OREQ 'O'
     C                     MOVE 'U'       ENC
F2  C                     END
D2  C           UVX       IFEQ 'F'
    C           UVX       OREQ 'G'
    C           UVX       OREQ 'N'
    C           UVX       OREQ 'O'
     C                     MOVE UVX       ENCALI
X2  C                     ELSE
     C                     MOVE *BLANK    ENCALI
F2  C                     END
     C/SPACE 1
D2  C           GROUPE    IFLE OFP1
     C           OFFG      TAG
    C*          ---------------
    C           VERX      CABEQ*BLANK    OFFD1
     C                     MOVE GROUPE    COLOR
     C                     MOVE VERX      VERA,I
     C                     SUB  1         GROUPE
D3  C           GROUPE    IFEQ *ZEROS
    C           VERX      ANDEQ'U'
D4  C           USFAB     IFEQ 4
D5  C           UVX       IFEQ 'U'
     C                     Z-ADD02        TMA,I
X5  C                     ELSE
D6  C           *IN66     IFEQ '1'                        NEUVILLE
     C                     Z-ADD03        TMA,I
X6  C                     ELSE
     C                     Z-ADD01        TMA,I            ?????
F6  C                     END
F5  C                     END
    C                     GOTO OFFF
X4  C                     ELSE
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F4  C                     END
F3  C                     END
D3  C           GROUPE    IFNE *ZEROS
     C                     MOVE GROUPE    COLO,I
     C                     Z-ADD*ZEROS    GROUPE
    C                     GOTO OFFE
F3  C                     END
D3  C           GROUPE    IFEQ *ZEROS
    C           VERX      ANDNE'U'
     C                     Z-ADD1         COLOR   10
    C                     GOTO OFFE
F3  C                     END
    C*
X2  C                     ELSE
     C           OFFD1     TAG
    C*          ---------------
D3  C           *IN63     IFEQ '0'
     C                     MOVE OFP1      COLO,I
     C           GROUPE    SUB  OFP1      GROUPE
X3  C                     ELSE
     C                     MOVE OFP2      COLO,I
     C           GROUPE    SUB  OFP2      GROUPE
F3  C                     END
     C                     MOVE COLO,I    COLOR
    C                     GOTO OFFE
F2  C                     END
     C/SPACE 1
     * pages 10  11
     C           OFFE      TAG
    C*          ---------------
D2  C           COLOR     IFGT 7
    C                     GOTO PASSTD
F2  C                     END
    C*
D2  C           *IN64     IFEQ '1'
     C                     Z-ADD07        TMA,I
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           USFAB     IFEQ 4
D3  C           UVX       IFEQ 'U'
    C           VERX      ANDEQ'U'
     C                     Z-ADD02        TMA,I
    C                     GOTO OFFF
F3  C                     END
D3  C           *IN66     IFEQ '1'
     C                     Z-ADD03        TMA,I
X3  C                     ELSE
     C                     Z-ADD01        TMA,I            ???
F3  C                     END
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           USFAB     IFEQ 7
D3  C           UVX       IFEQ 'U'
    C           VERX      ANDEQ'U'
     C                     Z-ADD01        TMA,I
    C                     GOTO OFFF
F3  C                     END
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           COLOR     IFEQ 1
    C           COLOR     OREQ 2
D3  C           VERX      IFEQ 'K'
     C                     Z-ADD12        TMA,I
    C                     GOTO OFFF
F3  C                     END
D3  C           ENC       IFNE 'U'
D4  C           VERX      IFNE 'U'
    C           *IN63     OREQ '0'
     C                     Z-ADD01        TMA,I            ???
    C                     GOTO OFFF
F4  C                     END
F3  C                     END
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           COLOR     IFEQ 3
    C           COLOR     OREQ 4
D3  C           VERX      IFEQ 'K'
     C                     Z-ADD12        TMA,I
    C                     GOTO OFFF
F3  C                     END
D3  C           ENC       IFNE 'U'
D4  C           VERX      IFNE 'U'
    C           *IN63     OREQ '0'
     C                     Z-ADD09        TMA,I
    C                     GOTO OFFF
F4  C                     END
F3  C                     END
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           COLOR     IFEQ 5
    C           COLOR     OREQ 6
D3  C           VERX      IFEQ 'K'
     C                     Z-ADD12        TMA,I
    C                     GOTO OFFF
F3  C                     END
D3  C           ENC       IFNE 'U'
D4  C           VERX      IFNE 'U'
    C           *IN63     OREQ '0'
     C                     Z-ADD12        TMA,I
    C                     GOTO OFFF
F4  C                     END
F3  C                     END
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F2  C                     END
    C*
D2  C           COLOR     IFEQ 7
D3  C           VERX      IFEQ 'F'
    C           VERX      OREQ 'K'
     C                     Z-ADD12        TMA,I
    C                     GOTO OFFF
F3  C                     END
D3  C           VERX      IFEQ 'U'
    C           UVX       ANDEQ'U'
     C                     Z-ADD14        TMA,I
    C                     GOTO OFFF
F3  C                     END
F2  C                     END
     C/SPACE 1
     * pages 13
     C           OFFF      TAG
    C*          ---------------
D2  C           *IN63     IFEQ '1'
D3  C           GROUPE    IFEQ *ZERO
D4  C           *IN64     IFEQ '1'
     C                     Z-ADD07        TMA,I
F4  C                     END
    C                     GOTO OFFO
F3  C                     END
    C*
     C                     ADD  1         I
D3  C           VERX      IFNE *BLANK
D4  C           GROUPE    IFEQ 1
     C                     MOVE VERX      VERA,I
D5  C           VERX      IFEQ 'U'
     C                     Z-ADD01        TMA,I
     C                     Z-ADD*ZEROS    GROUPE
    C                     GOTO OFFO
X5  C                     ELSE
    C                     GOTO OFFF4
F5  C                     END
X4  C                     ELSE
     C                     MOVE VERX      VER
     C                     SUB  1         GROUPE
     C                     Z-ADDGROUPE    COU
    C                     GOTO OFFF4
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDGROUPE    COU
     C           OFFF4     TAG
    C*          ---------------
D4  C           UVX       IFEQ 'V'
     C                     MOVE 'V'       ENC
F4  C                     END
     C                     Z-ADDQTNETR    KINDUS
D4  C           *IN64     IFEQ '1'
     C                     Z-ADD07        TMA,I
F4  C                     END
    C                     GOTO OFFM
F3  C                     END
    C*
X2  C                     ELSE
    C           GROUPE    CABEQ*ZEROS    OFFO
     C                     ADD  1         I
D3  C           GROUPE    IFLE OFP2
     C                     SETON                     63
    C                     GOTO OFFG
X3  C                     ELSE
     C                     MOVE OFP2      COLO,I
     C           GROUPE    SUB  OFP2      GROUPE
     C                     MOVE COLO,I    COLOR
     C                     SETON                     63
    C                     GOTO OFFE
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 1
     * pages 14 - 15 - 16
    C* ------------------------------------------------------------- *
    C*                     PASSAGE STANDARD                          *
    C* ------------------------------------------------------------- *
     C           PASSTD    TAG
    C*          ---------------
     C                     Z-ADDQTNETR    KINDUS
     C                     Z-ADD0         KINDUS
     C                     MOVE ' '       ENC
     C                     MOVE ' '       VER
    C*
D1  C           *IN86     IFEQ '1'                         REPRISE
    C           *IN87     OREQ '1'                         --------
     C                     Z-ADDRCOU      COULES
D2  C           ORCUR     IFNE *BLANKS
     C                     ADD  1         COULES
F2  C                     END
     C                     MOVE RVER      VER
     C                     MOVE RUV       ENC
X1  C                     ELSE                             PRINCIPAL
    C*
     C                     Z-ADDCOUL      COULES  20
D2  C           ORCU      IFNE *BLANKS
     C                     ADD  1         COULES
F2  C                     END
     C                     MOVE UV        ENC
     C                     MOVE TVER      VER
F1  C                     END
     C                     MOVE VER       VERSAV           FB 21/07/14
D1  C           VER       IFEQ 'P'                         P = U
     C                     MOVE 'U'       VER
F1  C                     END
     * GUY JAVELAUD LE 19/04/2011 , 20/12/2012 , 05/04/2013
D1  C           VER       IFEQ 'N'                         N = F
    C           VER       OREQ 'G'                         G = F
    C           VER       OREQ 'M'                         M = F
    C           VER       OREQ 'A'                        FB 10/06/14
    C           VER       OREQ 'C'                        FB 10/06/14
     C                     MOVE 'F'       VER
F1  C                     END
D1  C           VER       IFEQ 'T'                         T = K
    C           VER       OREQ 'H'                        FB 10/06/14
    C           VER       OREQ 'B'                        FB 10/06/14
     C                     MOVE 'K'       VER
F1  C                     END
D1  C           VER       IFEQ 'O'                         O = U
    C           VER       OREQ 'Q'                        FB 10/06/14
    C           VER       OREQ 'E'                        FB 10/06/14
    C           VER       OREQ 'J'                        FB 10/06/14
    C           VER       OREQ 'I'                        FB 10/06/14
    C           VER       OREQ 'R'                        FB 10/06/14
    C           VER       OREQ 'S'                        FB 17/07/14
     C                     MOVE 'U'       VER
F1  C                     END
D1  C           ENC       IFEQ 'F'
     C                     MOVE ENC       ENCALI  1
     C                     MOVE *BLANKS   ENC
X1  C                     ELSE
D2  C           ENC       IFEQ 'G'
     C                     MOVE ENC       ENCALI
     C                     MOVE 'U'       ENC
X2  C                     ELSE
D3  C           ENC       IFEQ 'N'
     C                     MOVE ENC       ENCALI
     C                     MOVE *BLANKS   ENC
X3  C                     ELSE
D4  C           ENC       IFEQ 'O'
     C                     MOVE ENC       ENCALI
     C                     MOVE 'U'       ENC
X4  C                     ELSE
     C                     MOVE *BLANK    ENCALI
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           COULES    IFNE *ZERO
     C                     Z-ADDCOULES    COU
X1  C                     ELSE
     C                     Z-ADD*ZEROS    COU
F1  C                     END
     C                     ADD  1         I
     C           OFFM      TAG
    C*          ---------------
    C* TMAFBU 28/11/2014 INC0204267
    C*          DSGP      IFNE 'SP'
     C                     EXSR SPOFP
    C*                    ELSE
    C*                    MOVE ' '       GPTEST
    C*                    MOVE MAIME1    TYPE1
    C*                    MOVE COULES    COULE1
    C*                    MOVE VER       VERNI1
    C*                    END
D1  C           GPTEST    IFEQ '1'
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
    C*
    C           TYPE1     CABEQ*ZEROS    OFFO
     C                     Z-ADDTYPE1     TMA,I
     C                     MOVE COULE1    COLO,I
     C                     MOVE VERNI1    VERA,I
D1  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN61     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN60     OREQ '1'
    C                     GOTO OFFJ2
F1  C                     END
D1  C           ENC       IFNE 'U'
    C           ENC       ANDNE'V'
D2  C           VER       IFNE 'U'
    C           VER       ANDNE'V'
    C           VER       ANDNE'D'
    C*          VER       ANDNE'M'                        GJ 5/04/2013
D3  C           GRAM,S    IFGE 450
D4  C           CDE       IFNE 1
     C                     Z-ADD12        TMA,I
F4  C                     END
    C                     GOTO OFFJ2
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           OFFJ2     TAG
    C*          ---------------
     C                     ADD  1         I
D1  C           TYPE2     IFEQ *ZEROS
     C                     SUB  1         I
    C                     GOTO OFFO
F1  C                     END
    C*
     C                     Z-ADDTYPE2     TMA,I
     C                     MOVE COULE2    COLO,I
     C                     MOVE VERNI2    VERA,I
D1  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN61     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN60     OREQ '1'
    C                     GOTO OFFJ3
F1  C                     END
D1  C           ENC       IFNE 'U'
    C           ENC       ANDNE'V'
D2  C           VER       IFNE 'U'
    C           VER       ANDNE'V'
    C           VER       ANDNE'D'
    C*          VER       ANDNE'M'                        GJ 5/04/2013
D3  C           GRAM,S    IFGE 450
D4  C           CDE       IFNE 1
     C                     Z-ADD12        TMA,I
F4  C                     END
    C                     GOTO OFFJ3
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           OFFJ3     TAG
    C*          ---------------
     C                     ADD  1         I
D1  C           TYPE3     IFEQ *ZEROS
     C                     SUB  1         I
    C                     GOTO OFFO
F1  C                     END
    C*
     C                     Z-ADDTYPE3     TMA,I
     C                     MOVE COULE3    COLO,I
     C                     MOVE VERNI3    VERA,I
D1  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN61     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN60     OREQ '1'
    C                     GOTO OFFJ4
F1  C                     END
D1  C           ENC       IFNE 'U'
    C           ENC       ANDNE'V'
D2  C           VER       IFNE 'U'
    C           VER       ANDNE'V'
    C           VER       ANDNE'D'
    C*          VER       ANDNE'M'                        GJ 5/04/2013
D3  C           GRAM,S    IFGE 450
D4  C           CDE       IFNE 1
     C                     Z-ADD12        TMA,I
F4  C                     END
    C                     GOTO OFFJ4
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           OFFJ4     TAG
    C*          ---------------
     C                     ADD  1         I
D1  C           TYPE4     IFEQ *ZEROS
     C                     SUB  1         I
    C                     GOTO OFFO
F1  C                     END
    C*
     C                     Z-ADDTYPE4     TMA,I
     C                     MOVE COULE4    COLO,I
     C                     MOVE VERNI4    VERA,I
D1  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN61     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN60     OREQ '1'
    C                     GOTO OFFJ5
F1  C                     END
D1  C           ENC       IFNE 'U'
    C           ENC       ANDNE'V'
D2  C           VER       IFNE 'U'
    C           VER       ANDNE'V'
    C           VER       ANDNE'D'
    C*          VER       ANDNE'M'                        GJ 5/04/2013
D3  C           GRAM,S    IFGE 450
D4  C           CDE       IFNE 1
     C                     Z-ADD12        TMA,I
F4  C                     END
    C                     GOTO OFFJ5
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C           OFFJ5     TAG
    C*          ---------------
     C                     ADD  1         I
D1  C           TYPE5     IFEQ *ZEROS
     C                     SUB  1         I
    C                     GOTO OFFO
F1  C                     END
    C*
     C                     Z-ADDTYPE5     TMA,I
     C                     MOVE COULE5    COLO,I
     C                     MOVE VERNI5    VERA,I
D1  C           *IN64     IFEQ '1'
    C           *IN65     OREQ '1'
    C           *IN61     OREQ '1'
    C           *IN67     OREQ '1'
    C           *IN60     OREQ '1'
    C                     GOTO OFFO
F1  C                     END
D1  C           ENC       IFNE 'U'
    C           ENC       ANDNE'V'
D2  C           VER       IFNE 'U'
    C           VER       ANDNE'V'
    C           VER       ANDNE'D'
    C*          VER       ANDNE'M'                        GJ 5/04/2013
D3  C           GRAM,S    IFGE 450
D4  C           CDE       IFNE 1
     C                     Z-ADD12        TMA,I
F4  C                     END
    C                     GOTO OFFO
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 1
     * pages 17
     C           OFFO      TAG
    C*          ---------------
     C                     MOVE TVERSS    TVER
     C                     MOVE TMA,I     NOMAC
    C*
    C* Dans le cas COMMERCIAL choix de l'usine en fonction de la machine
    C* -----------------------------------------------------------------
D1  C           CDE       IFEQ 1
D2  C           NOMAC     IFEQ '14'
    C           NOMAC     OREQ '07'
     C                     Z-ADD2         USFAB
F2  C                     END
D2  C           NOMAC     IFEQ '06'
     C                     Z-ADD4         USFAB
F2  C                     END
D2  C           VERSAV    IFEQ 'R'
    C           VERSAV    OREQ 'P'
     C                     Z-ADD2         USFAB
     C                     MOVE '14'      NOMAC
F2  C                     END
F1  C                     END
     C/SPACE 1
     * pages 18  - 19
    C*
D1  C           DSGP      IFEQ 'OR'                       ZONES
    C           DSGP      OREQ 'OB'                       FICHIER
    C           DSGP      OREQ 'CX'                       PRODUITS
    C           DSGP      OREQ 'A5'                       PRIORITAIRES
    C           DSGP      OREQ 'SP'
    C           DSGP      OREQ 'PR'
D2  C           *IN96     IFEQ '1'                        PRINCIPAL
    C           *IN86     ANDEQ'0'
D3  C           I         IFEQ 1
    C           MAIMI1    ANDNE*ZEROS
     C                     MOVE MAIMI1    NOMAC
F3  C                     END
D3  C           I         IFEQ 2
    C           MAIMI2    ANDNE*ZEROS
     C                     MOVE MAIMI2    NOMAC
F3  C                     END
D3  C           I         IFEQ 3
    C           MAIMI3    ANDNE*ZEROS
     C                     MOVE MAIMI3    NOMAC
F3  C                     END
D3  C           I         IFEQ 4
    C           MAIMI4    ANDNE*ZEROS
     C                     MOVE MAIMI4    NOMAC
F3  C                     END
D3  C           I         IFEQ 5
    C           MAIMI5    ANDNE*ZEROS
     C                     MOVE MAIMI5    NOMAC
F3  C                     END
F2  C                     END
     C/SPACE 1
D2  C           *IN97     IFEQ '1'                        PRINCIPAL
    C           *IN87     ANDEQ'0'
D3  C           I         IFEQ 1
    C           MAIME1    ANDNE*ZEROS
     C                     MOVE MAIME1    NOMAC
F3  C                     END
D3  C           I         IFEQ 2
    C           MAIME2    ANDNE*ZEROS
     C                     MOVE MAIME2    NOMAC
F3  C                     END
D3  C           I         IFEQ 3
    C           MAIME3    ANDNE*ZEROS
     C                     MOVE MAIME3    NOMAC
F3  C                     END
D3  C           I         IFEQ 4
    C           MAIME4    ANDNE*ZEROS
     C                     MOVE MAIME4    NOMAC
F3  C                     END
D3  C           I         IFEQ 5
    C           MAIME5    ANDNE*ZEROS
     C                     MOVE MAIME5    NOMAC
F3  C                     END
F2  C                     END
     C/SPACE 1
D2  C           *IN86     IFEQ '1'                        REPRISE
D3  C           I         IFEQ 1
    C           MAIRI1    ANDNE*ZEROS
     C                     MOVE MAIRI1    NOMAC
F3  C                     END
D3  C           I         IFEQ 2
    C           MAIRI2    ANDNE*ZEROS
     C                     MOVE MAIRI2    NOMAC
F3  C                     END
D3  C           I         IFEQ 3
    C           MAIRI3    ANDNE*ZEROS
     C                     MOVE MAIRI3    NOMAC
F3  C                     END
D3  C           I         IFEQ 4
    C           MAIRI4    ANDNE*ZEROS
     C                     MOVE MAIRI4    NOMAC
F3  C                     END
D3  C           I         IFEQ 5
    C           MAIRI5    ANDNE*ZEROS
     C                     MOVE MAIRI5    NOMAC
F3  C                     END
F2  C                     END
     C/SPACE 1
D2  C           *IN87     IFEQ '1'                        REPRISE
D3  C           I         IFEQ 1
    C           MAIRE1    ANDNE*ZEROS
     C                     MOVE MAIRE1    NOMAC
F3  C                     END
D3  C           I         IFEQ 2
    C           MAIRE2    ANDNE*ZEROS
     C                     MOVE MAIRE2    NOMAC
F3  C                     END
D3  C           I         IFEQ 3
    C           MAIRE3    ANDNE*ZEROS
     C                     MOVE MAIRE3    NOMAC
F3  C                     END
D3  C           I         IFEQ 4
    C           MAIRE4    ANDNE*ZEROS
     C                     MOVE MAIRE4    NOMAC
F3  C                     END
D3  C           I         IFEQ 5
    C           MAIRE5    ANDNE*ZEROS
     C                     MOVE MAIRE5    NOMAC
F3  C                     END
F2  C                     END
    C*
F1  C                     END
    C* Dans le cas PRU choix de l'usine en fonction de la machine
    C* ----------------------------------------------------------
D1  C           CDE       IFEQ 0
    C           DSGP      ANDEQ'SP'
D2  C           NOMAC     IFEQ '06'
     C                     Z-ADD4         USFAB
F2  C                     END
D2  C           NOMAC     IFEQ '14'
     C                     Z-ADD2         USFAB
F2  C                     END
F1  C                     END
     C/SPACE 1
    C* page 20
     C           OFFR1     TAG
    C*          ---------------
     C                     MOVE '1'       SECT
     C                     MOVE '4'       SSECT
    C*
     C  N39
     COR 39 01             MOVE 'R'       OFFPR
     C   39N01             MOVE 'P'       OFFPR
D1  C           DDECOR    IFEQ ' '
     C                     MOVE 'B'       OFFABC
X1  C                     ELSE
     C                     MOVE DDECOR    OFFABC
F1  C                     END
     C                     MOVE COLO,I    OFFCOU
     C                     MOVE VERA,I    OFFVER
    C*
    C                     GOTO OFFS
     C/SPACE 1
    C* page 21
     C           OFFS1     TAG
    C*          ---------------
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
    C*
D1  C           *IN86     IFEQ '1'                         REPRISE
    C           *IN87     OREQ '1'
     C                     Z-ADDRCOU      GROUPE
D2  C           ORCUR     IFNE *BLANK
     C                     ADD  1         GROUPE
F2  C                     END
     C                     MOVE RVER      OFFVER
X1  C                     ELSE                             PRINCIPAL
    C*
     C                     Z-ADDCOUL      GROUPE
D2  C           ORCU      IFNE *BLANK
     C                     ADD  1         GROUPE
F2  C                     END
     C                     MOVE TVER      OFFVER
F1  C                     END
     C/SPACE 1
    C* page 22
     C                     MOVE NOPASS    I
    C*
D1  C           USFAB     IFEQ 2
D2  C           NOMAC     IFEQ '01'
D3  C           GROUPE    IFGT 2
     C                     Z-ADD2         GROUPE
F3  C                     END
D3  C           GROUPE    IFEQ 2
    C           OFFVER    ANDNE*BLANKS
     C                     SUB  1         GROUPE
F3  C                     END
F2  C                     END
     C/SPACE 1
D2  C           GROUPE    IFGT 6
     C                     Z-ADD6         GROUPE
F2  C                     END
D2  C           GROUPE    IFEQ 6
D3  C           NOMAC     IFNE '09'
    C           OFFVER    ANDNE*BLANKS
     C                     SUB  1         GROUPE
F3  C                     END
D3  C           NOMAC     IFEQ '09'
D4  C           OFFVER    IFNE 'F'
    C           OFFVER    ANDNE'K'
     C                     SUB  1         GROUPE
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C                     MOVE GROUPE    OFFCOU
     C                     MOVE GROUPE    COLO,I
     C                     MOVE OFFVER    VERA,I
    C* page 24
D1  C           *IN39     IFEQ '1'
     C                     MOVE 'P'       OFFPR
X1  C                     ELSE
     C                     MOVE 'R'       OFFPR
F1  C                     END
D1  C           DDECOR    IFEQ ' '
     C                     MOVE 'B'       OFFABC
X1  C                     ELSE
     C                     MOVE DDECOR    OFFABC
F1  C                     END
     C/SPACE 1
    C* page 25
     C           OFFS      TAG
    C*          ---------------
     C                     MOVELDSOFFS    CLEREC
     C                     EXSR PONDI1                     PONDERATIONS
     C                     EXSR NORSTD                     NORMES STD.
    C*
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
    C           GPTEST    ORNE *BLANK
    C           DSGP      ANDEQ'AB'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
     C                     EXSR CAPART                     CAS PARTICUL
     C                     EXSR PONDI1                     PONDERATIONS
     C                     EXSR PONDIM                     PONDERATIONS
     C/SPACE 2
     * traitement fin de passage .
     C           FINPAS    TAG
    C*          ---------------
D1  C           DSGP      IFEQ 'SU'
     C                     Z-ADDNOPASS    I
     C                     MOVE NOMACS    NOMAC
F1  C                     END
D1  C           DSGP      IFEQ 'A5'                       PRIX REVIENT
     C                     MOVE ANDEV     SUIMP
     C                     Z-ADDSEQDEZ    NOPRO
F1  C                     END
     C                     MOVE VERA,I    VERNIS
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C                     Z-ADD31        PRIORI
X1  C                     ELSE                            EXTERIEUR
     C                     Z-ADD62        PRIORI
F1  C                     END
    C*
D1  C           TIMP      IFEQ 4
     C           REDEC     MULT SBFE      SURIM     H
X1  C                     ELSE
     C           REDEC     MULT LAIZML    SURIM     H
F1  C                     END
     C                     MOVELMOYDEC    DECRO
     C                     ADD  DECRO     DECIMP  44
D1  C           *IN31     IFEQ '0'
     C                     Z-ADDUSFAB     SVUS    10
     C                     MOVE NOMAC     SVNM    2
D2  C           SVU5      IFEQ '*'                        OFFSET CH
D3  C           DSGP      IFEQ 'OR'                       ORDO
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'CX'
    C           DSGP      OREQ 'PR'
     C                     Z-ADD5         USFAB
     C                     MOVE '01'      NOMAC
F3  C                     END
F2  C                     END
     C                     WRITEPLAIMPF1
     C                     Z-ADDSVUS      USFAB
     C                     MOVE SVNM      NOMAC
X1  C                     ELSE
     C                     Z-ADD90        PRIORI
     C                     MOVE '4'       SECT
D2  C           *IN96     IFEQ '1'
    C           *IN86     OREQ '1'
     C                     Z-ADD5         SUPCXY
X2  C                     ELSE
     C                     Z-ADD3         SUPCXY
F2  C                     END
     C                     MOVE SUIMP     TPO8
     C                     MOVE COULX     TPO9
     C                     MOVE VERNIS    TPO10
     C                     WRITEPLANIFF1                   OFF. APRES OND
     C                     Z-ADD*ZEROS    SUPCXY
     C                     MOVE *BLANKS   TPOSTE
     C           REDEC     MULT SBFE      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     C                     MOVE '1'       SECT
F1  C                     END
     C                     MOVE *BLANKS   VERNIS
D1  C           I         IFEQ 1
     C                     MOVE NOMAC     MACO1   2        1° MACHINE OFF
F1  C                     END
     *
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C                     ADD  DECRO     DECINT  44
     C                     ADD  SURIM     RIMPI
     C                     ADD  SURIM     SURIMP
X1  C                     ELSE                            EXTERIEUR
     C                     ADD  DECRO     DECEXT  44
     C                     ADD  SURIM     RIMPE
     C                     ADD  SURIM     SURIMP
F1  C                     END
     *
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
D1  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
F1  C                     END
     C/SPACE 1
     C                     EXSR VALORI                     VALORISATION
     *
D1  C           *IN01     IFEQ '0'
    C           I         ANDNE1
     C                     EXSR RESULT                     CHARG.RESULTATS
F1  C                     END
     *
     C                     SUB  1         I
     C                     ADD  1         CTR1    20
     C                     ADD  1         CTR
D1  C           I         IFNE 0
     C                     SETON                     10
    C                     GOTO QTEIMP
F1  C                     END
     * sauvegarde du nombres de passage en offset pour edition .
     C                     Z-ADD0         CTR1
     *
     C                     SETOF                     5051
D1  C           *IN39     IFEQ '0'                          QUE RENOU
    C           *IN38     ANDEQ'1'
    C           *IN39     OREQ '1'                          QUE PREMIERE
    C           *IN38     ANDEQ'0'
    C*          *IN87     OREQ '1'                          OU REPIQUAGE
    C*          *IN86     OREQ '1'                                "
    C           *IN93     OREQ '1'                          ROT/COUP/OFF
     C                     Z-ADD0         CTR
D2  C           *IN96     IFEQ '1'                          EXTERIEUR
    C           *IN86     OREQ '1'
     C                     ADD  DECIMP    INDEC
     C           ROUDEC    ADD  DECIMP    ROUL
X2  C                     ELSE                              INTERIEUR
     C                     ADD  DECIMP    EXDEC
     C           ROUDEC    ADD  DECEXT    ROUL
F2  C                     END
    C                     GOTO DULJ61
F1  C                     END
     *
    C   39 01             GOTO DULJ60                      PREMIERE ET
     C                     Z-ADDCTR       I                   RENOU
     C                     Z-ADD0         CTR
     C                     SETON                     0110
     C                     ADD  TOLREG    COUPRE  70
     C                     ADD  TOLROU    COUPRE
     C                     ADD  TREGMA    COUPRE
     C                     Z-ADDDECIMP    DECPRE
     C           DECPRE    MULT SUIMP1    ROUPRE  80H
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C                     Z-ADD0         DECINT
     C                     Z-ADD0         RIMPI
     C           ROUPRE    MULT VALINT    ROUL1   80H
X1  C                     ELSE                            EXTERIEUR
     C                     Z-ADD0         DECEXT
     C                     Z-ADD0         RIMPE
     C           ROUPRE    MULT VALEXT    ROUL1     H
F1  C                     END
     C           ROUL1     MULT 0,01      ROUL1     H
    C                     GOTO QTEIMP
    C*
     C           DULJ60    TAG
     C                     Z-ADD0         CTR
     C                     Z-ADDDECIMP    RUODEC
     C                     SUB  DECPRE    RUODEC
     C           RUODEC    MULT SUIMPR    ROUREN  60H
     C           ROUREN    MULT MULTI     ROUREN
     C                     ADD  ROUPRE    ROUREN
     C           SUIMPR    MULT MULTI     SUF
     C                     ADD  SUIMP1    SUF
     C           ROUREN    DIV  SUF       DECW1   44
     C           DECW1     MULT 100       DECW2   31H
     C                     MOVELDECW2     DECRAP  44P
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C                     ADD  DECRAP    INDEC
X1  C                     ELSE                            EXTERIEUR
     C                     ADD  DECRAP    EXDEC
F1  C                     END
     C           DECRAP    MULT 100       MOYDEC    H
    C*
     C           DULJ61    TAG
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C   86      FOREPI    MULT MULTI     FOREG   70
     C  N86      FORINT    MULT MULTI     FOREG
     C   86      FOREPI    MULT MULTI     RMAINX
     C  N86      FORINT    MULT MULTI     RMAINZ
X1  C                     ELSE                            EXTERIEUR
     C   87      FOREPE    MULT MULTI     FOREG
     C  N87      FOREXT    MULT MULTI     FOREG
     C   87      FOREPE    MULT MULTI     RMAEXX
     C  N87      FOREXT    MULT MULTI     RMAEXZ
F1  C                     END
     C                     ADD  FOREG     RM2DIR
     C           FOREG     MULT KMATA     FOREG     H
     C                     ADD  FOREG     TREGMA
     *
     C                     Z-ADD1         I
     C                     EXSR RESULT                     CHARG.RESULTATS
     *
D1  C           *IN01     IFEQ '1'
     C                     MOVE '1'       IN01    1
X1  C                     ELSE
     C                     MOVE '0'       IN01
F1  C                     END
     C                     SETOF                     0110
     C                     ADD  1         R
     C                     Z-ADD0         I
     C                     Z-ADD0         DECIMP
     C                     Z-ADD0         COUPRE
     C                     Z-ADD0         ROUL1
     C                     Z-ADD0         COUREN
     C                     Z-ADD0         COUPRE
     C                     Z-ADD0         ROUREN
     C                     MOVE *BLANKS   COLO
     C                     MOVE *BLANKS   VERA
     * SI OFFSET SUR FEUILLE ONDULÉE
D1  C           *IN31     IFEQ '1'
    C           RT1       CABEQ1         FACO8A
    C           RT1       CABEQ2         FACO8B
    C           RT1       CABEQ3         FACO8C
    C           RT1       CABEQ4         FACO8D
F1  C                     END
    C*
     C                     SETOF                     9192
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
D2  C           *IN86     IFEQ '1'                        REPIQAGE
     C                     SETOF                     86
D3  C           RIMPIN    IFEQ 4
    C           IMPINT    ANDNE4
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9193
    C                     GOTO PASSAB
F3  C                     END
     C           DULJ51    TAG
D3  C           *IN96     IFEQ '1'                        PRINCIPAL
    C                     GOTO QTEIMP
X3  C                     ELSE
    C                     GOTO DULJ91
F3  C                     END
X2  C                     ELSE
     C                     SETOF                     96
    C                     GOTO DULJ91
F2  C                     END
    C*
X1  C                     ELSE                            EXTERIEUR
D2  C           *IN87     IFEQ '1'                        REPIQUAGE
     C                     SETOF                     87
D3  C           RIMPEX    IFEQ 4
    C           IMPEXT    ANDNE4
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9293
    C                     GOTO PASSAB
F3  C                     END
     C           DULJ52    TAG
D3  C           *IN97     IFEQ '1'                        PRINCIPAL
    C                     GOTO QTEIMP
X3  C                     ELSE
    C                     GOTO DULJ92
F3  C                     END
X2  C                     ELSE
     C                     SETOF                     97
    C                     GOTO DULJ92
F2  C                     END
F1  C                     END
     C/SPACE 2
     C           DULJ91    TAG
D1  C           *IN73     IFEQ '1'
     C                     SUB  1         R
D2  C           IN85      IFEQ '0'
     C                     MOVE '1'       IN85
     C                     SETON                     85
X2  C                     ELSE
     C                     SETOF                     85
F2  C                     END
D2  C           IN01      IFEQ '1'
     C                     MOVE 'P'       PR
F2  C                     END
    C                     GOTO FACO12
F1  C                     END
D1  C           IMPINT    IFEQ 4
     C                     Z-ADDSUPINT    S
D2  C           APP,S     IFEQ 'B'
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9613
    C                     GOTO QTEIMP
F2  C                     END
F1  C                     END
     C           SUREG     ADD  SUREGX    SURIMP
     C           SUREG     ADD  SUREGX    SUREGC
    C                     GOTO DULJ35
     C           DULJ92    TAG
D1  C           *IN72     IFEQ '1'
     C                     SUB  1         R
D2  C           IN85      IFEQ '0'
     C                     MOVE '1'       IN85
     C                     SETON                     85
X2  C                     ELSE
     C                     SETOF                     85
F2  C                     END
D2  C           IN01      IFEQ '1'
     C                     MOVE 'P'       PR
F2  C                     END
    C                     GOTO FACO12
F1  C                     END
D1  C           IMPEXT    IFEQ 4
     C                     Z-ADDSUPEXT    S
D2  C           APP,S     IFEQ 'B'
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9713
    C                     GOTO QTEIMP
F2  C                     END
F1  C                     END
     C/SPACE 1
    C* MASSICOT
    C*--------------------
    C*   QUE DANS PASSAGE COMMANDE ET OBJECTIF.
    C*   FORMAT MASSICOTE MIS DANS DEVSIM5
    C*   DANS FAMSL ET FMASD   PAR PROG. CDEC55£  CDEC56£  DEV021£
    C*--------------------
     C           STMAS     TAG
     C                     Z-ADDUSFAB     USFABX  10
     C                     Z-ADDSUIMP     SUIMPX  10
D1  C           IMPEXT    IFEQ 4
    C           FMASL     ANDGT*ZEROS
    C           IMPINT    OREQ 4
    C           FMASL     ANDGT*ZEROS
     C                     MOVE '1'       SECT
     C                     MOVE '5'       SSECT
D2  C           IMPEXT    IFEQ 4
    C           USEXT     ANDNE*ZEROS
D3  C           DSGP      IFEQ 'SP'
    C           USSPE     ANDNE*BLANKS
     C                     MOVE USSPE     USFAB
X3  C                     ELSE
     C                     Z-ADDUSEXT     USFAB
F3  C                     END
D3  C           CCOL      IFNE 6
     C                     Z-ADD3         SUIMP
X3  C                     ELSE
     C                     Z-ADD2         SUIMP
F3  C                     END
F2  C                     END
D2  C           IMPINT    IFEQ 4
    C           USINT     ANDNE*ZEROS
D3  C           DSGP      IFEQ 'SP'
    C           USSPI     ANDNE*BLANKS
     C                     MOVE USSPI     USFAB
X3  C                     ELSE
     C                     Z-ADDUSINT     USFAB
F3  C                     END
D3  C           CCOL      IFNE 6
     C                     Z-ADD5         SUIMP
X3  C                     ELSE
     C                     Z-ADD6         SUIMP
F3  C                     END
F2  C                     END
D2  C           USFAB     IFEQ 3                                      ENT
     C                     Z-ADD4         USFAB
F2  C                     END
D2  C           USFAB     IFEQ 4
     C                     MOVE '01'      NOMAC
X2  C                     ELSE
D3  C           USFAB     IFEQ 7
     C                     MOVE '02'      NOMAC
X3  C                     ELSE
     C                     MOVE '03'      NOMAC
F3  C                     END
F2  C                     END
     C                     Z-ADD*ZEROS    RETPS
     C                     Z-ADD*ZEROS    MOYDEC
     C                     Z-ADD*ZEROS    COULX
     C                     MOVE *BLANKS   TVERX   10
D2  C           FMASL     IFNE FORLST
    C           FMASD     ANDNEFORHST
     C                     Z-ADD1500      MOYCAD
X2  C                     ELSE
     C                     Z-ADD3000      MOYCAD
F2  C                     END
     C           QTENET    DIV  MOYCAD    TPSTOT
     C                     Z-ADD*ZEROS    REDEC
     C                     Z-ADD*ZEROS    REEFF
     C                     Z-ADD*ZEROS    NEEFF
     C                     Z-ADD1         ROEFF
     C                     Z-ADD*ZEROS    NETPS
    C*                    Z-ADDR         SVR1    20
    C*                    Z-ADDSVR       R
    C*          FORLST    SUB  FMASL     TAQ1    40
    C*          FMASL     DIV  2         TAQ2    40
    C*                    ADD  TAQ2      TAQ1
    C*          USFAB     IFEQ 2                          RT
    C*          TAQ1      IFGT 710
    C*                    Z-ADD0         I
    C*                    ELSE
    C*                    Z-ADD9         I
    C*                    END
    C*                    ELSE                            NE
    C*          MACO1     IFEQ '01'
    C*          TAQ1      IFGT 510
    C*          FORHST    ORGT 730
    C*                    Z-ADD0         I
    C*                    ELSE
    C*                    Z-ADD9         I
    C*                    END
    C*                    ELSE
    C*          TAQ1      IFGT 710
    C*                    Z-ADD0         I
    C*                    ELSE
    C*                    Z-ADD9         I
    C*                    END
    C*                    END
    C*                    Z-ADD0         I
    C*                    END
     C                     ADD  1         R
     C                     Z-ADD0         I
D2  C           SUIMP     IFGT 3                          INTERIEUR
     C                     Z-ADD20        PRIORI
X2  C                     ELSE                            EXTERIEUR
     C                     Z-ADD50        PRIORI
F2  C                     END
     C                     WRITEPLAIMPF1
     C                     MOVE PR        SVPR    1
D2  C           SVPR      IFEQ 'P'
     C                     MOVE 'R'       PR
X2  C                     ELSE
     C                     MOVE 'P'       PR
F2  C                     END
D2  C           PR        IFEQ 'P'
    C           QTPRE     ANDNE0
     C                     WRITEPLAIMPF1
F2  C                     END
D2  C           PR        IFEQ 'R'
    C           QTREN     ANDNE0
     C                     WRITEPLAIMPF1
F2  C                     END
     C                     MOVE SVPR      PR
D2  C           DSGP      IFEQ 'AB'                       -> OBJECTIF
     C                     EXSR OBJPRO                        PRODUCTION
F2  C                     END
F1  C                     END
     C                     Z-ADDUSFABX    USFAB
     C                     Z-ADDSUIMPX    SUIMP
     C/SPACE 1
    C           CCOL      CABNE1         DULJFI
D1  C           IMPINT    IFEQ 1
    C           IMPEXT    ANDNE4
    C           IMPINT    OREQ 2
    C           IMPEXT    ANDNE4
     C                     Z-ADDSUPEXT    S
D2  C           APPEX     IFEQ 'B'
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9613
    C                     GOTO QTEIMP
F2  C                     END
X1  C                     ELSE
D2  C           IMPEXT    IFEQ 1
    C           IMPINT    ANDNE4
    C           IMPEXT    OREQ 2
    C           IMPINT    ANDNE4
     C                     Z-ADDSUPINT    S
D3  C           APPIN     IFEQ 'B'
    C           UNPPAS    ANDEQ' '
     C                     SETON                     9713
    C                     GOTO QTEIMP
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 1
    C                     GOTO DULJFI
     C/SPACE 2
     * coupeuse jagenberg .
     C           PASSAB    TAG
     C                     MOVE '*'       UNPPAS  1
D1  C           DSGP      IFEQ 'SU'
     C                     MOVE SECTS     SECT
     C                     MOVE SSECTS    SSECT
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADD2         USFAB
     C                     Z-ADDGRAM,3    JAGGRA
X1  C                     ELSE
D2  C           DSGP      IFEQ 'A4'
    C           DSGP      OREQ 'A0'
    C           STOCKE    ANDEQ'O'
     C                     MOVE '1'       SECT
     C                     MOVE '3'       SSECT
     C                     MOVE '03'      NOMAC
     C                     Z-ADDUSINE     USFAB
     C                     Z-ADDGRAM,3    JAGGRA
D3  C           TS        IFNE 'I'
     C                     MOVELFORL      JAGLAI
     C                     MOVE FORL      JAGLA1  10
     C                     MOVE FORH      JAGDEV
X3  C                     ELSE
     C                     MOVELFORH      JAGLAI
     C                     MOVE FORH      JAGLA1  10
     C                     MOVE FORL      JAGDEV
F3  C                     END
D3  C           JAGLA1    IFNE *ZERO
     C                     ADD  1         JAGLAI
F3  C                     END
X2  C                     ELSE
D3  C           *IN96     IFEQ '1'                        INTERIEUR
     C                     Z-ADDSUPINT    S
     C                     Z-ADD2         USFAB
     C                     MOVE GRAM,S    JAGGRA
X3  C                     ELSE                            EXTERIEUR
     C                     Z-ADDSUPEXT    S
     C                     Z-ADD2         USFAB
     C                     MOVE GRAM,S    JAGGRA
F3  C                     END
     C                     MOVE '1'       SECT
     C                     MOVE '3'       SSECT
     C                     MOVE '03'      NOMAC
     C                     Z-ADDLMINI     JAGLAI
     C                     Z-ADDONDH      JAGDEV
F2  C                     END
F1  C                     END
     C                     MOVELDSJAGE    CLEREC
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD.
D1  C           GPTEST    IFNE *BLANK
    C           DSGP      ANDEQ'SU'
     C                     EXSR SPERR
    C                     GOTO FIN
F1  C                     END
     C                     EXSR CAPART
     *
D1  C           TOTTPS    IFNE *ZEROS
     C                     Z-ADDTOTTPS    TPSTOT
     C                     Z-ADDCADMOY    MOYCAD
F1  C                     END
D1  C           DECR      IFNE 0
     C                     Z-ADDDECR      REDEC
F1  C                     END
D1  C           TPSRE     IFNE *ZEROS
     C                     Z-ADDTPSRE     RETPS
F1  C                     END
D1  C           TPSNE     IFNE *ZEROS
     C                     Z-ADDTPSNE     NETPS
F1  C                     END
     C                     Z-ADD*ZEROS    PREG
    C*
     C           REDEC     MULT LAIZML    SURIM
     C                     EXSR VALORI                     VALORISATION
     *
D1  C           DSGP      IFEQ 'A5'                       PRIX REVIENT
     C                     MOVE ANDEV     SUIMP
     C                     Z-ADDSEQDEZ    NOPRO
F1  C                     END
     *
D1  C           S         IFLE 3
     C                     Z-ADD50        PRIORI
X1  C                     ELSE
     C                     Z-ADD20        PRIORI
F1  C                     END
     C                     Z-ADDS         SUPCXY
     C                     Z-ADD1         I
     C                     WRITEPLAIMPF1
     C                     Z-ADD0         SUPCXY
    C           DSGP      CABEQ'SU'      FIN              -> SUIVI
    C*
     C                     MOVELMOYDEC    DECRO
D1  C           *IN91     IFEQ '1'
     C                     ADD  DECRO     ROUL
     C                     ADD  DECRO     DECINT
F1  C                     END
D1  C           *IN92     IFEQ '1'
     C                     ADD  DECRO     ROUL
     C                     ADD  DECRO     DECEXT
F1  C                     END
    C*
D1  C           S         IFLE 3
     C                     ADD  DECRO     ROCXIE
     C                     ADD  REDEC     RECXIE
     C                     ADD  REDEC     SURIMP
X1  C                     ELSE
     C                     ADD  DECRO     ROCXII
     C                     ADD  REDEC     RECXII
     C                     ADD  REDEC     SURIMP
F1  C                     END
     *
D1  C           *IN01     IFEQ '0'
    C           *IN39     ANDEQ'1'
    C           *IN38     ANDEQ'1'
    C           *IN91     ANDEQ'0'
    C           *IN92     ANDEQ'0'
     C                     SETON                     01
    C                     GOTO QTEIMP
F1  C                     END
     C                     Z-ADD1         I
    C*
D1  C           *IN91     IFEQ '1'
    C           *IN92     OREQ '1'
     C                     EXSR RESULT                     CHARG.RESULTATS
     C                     ADD  1         R
    C   91                GOTO DULJ51
    C   92                GOTO DULJ52
F1  C                     END
    C*
D1  C           *IN96     IFEQ '1'
     C                     SETOF                     019613
     C                     EXSR RESULT                     CHARG.RESULTATS
     C                     ADD  1         R
     C           SUREG     ADD  SUREGX    SURIMP
     C           SUREG     ADD  SUREGX    SUREGC
    C                     GOTO DULJ35
F1  C                     END
     C                     SETOF                     13
     C                     EXSR RESULT                     CHARG.RESULTATS
    C*
     C           DULJFI    TAG
     C                     ADD  INDECD    INDEC
     C                     ADD  EXDECD    EXDEC
     C/SPACE 2
    C                     ENDSR
     C/EJECT
     *********************************************
     * calcul des matieres assemblages           ********************
     * valorises pour l'ensemble de la commande  ********************
     * et ramenees au 100m2 .                    ********************
     ********************************************* <-- module -K- -->
     * agrafes .                    prix au 100 et non au 1000 .
     * fenetres .
     * colle pose fenetres .
     * colle assemblage .
     * poignes plastiques .
     * poignes Champion .
     * rivets .                     prix au 100 et non au 1000 .
     * rondelles .                    "   "  "   "  "   "   "
     * poignes rinaldo .
     * scarset
     * pelliculage
     * dorure
     * peinture sur tranche
     *
     * zones en provenance de traitements precedents .
     *     DECSUP   cumul des dechets par support (f.papier) .
     *     DROUA1   dechets de roulage assemblage un .
     *     DROUA2      "     "    "        "      deux .
     *     DROUOE      "     "    "    Oeillet
     *     DECROU   total des dechets de roulage .
     *
    C           MODULK    BEGSR
     C                     EXSR BLMODK
     C/SPACE 1
     * SI SOUS TRAITANCE INTÉGRALE
    C* ----------------------------------
    C           TYPDEV    CABEQ4         MODUKF
     * <---PAGE-K1--->
D1  C           FACON     IFLT 7
    C           FACON     CABEQ4         DULKO
    C           FACON     CABEQ1         DULKO
    C           FACON     CABEQ0         DULKO
    C           FACON     CABLT6         DULKQ
    C           FACON     CABEQ6         DULKE
F1  C                     END
    C           FACON     CABEQ9         DULKQ
     C           DECSUP    ADD  SUDEC     DECPL
     C                     ADD  STDEC1    DECPL
     C                     ADD  STDEC2    DECPL
     C                     ADD  STDEC3    DECPL
     C                     ADD  STDEC4    DECPL
     C                     MOVE DECPL     DECPLU
    C           AGRAF     CABEQ0         DULKE
     * 2% de dechets si agrafage .
     * pas de valorisation sous traitance .
     C           DECPLU    ADD  1,0200    DEC
     C                     MOVEA'Agrafe-' LMA,A
     C                     ADD  7         A
     * <---PAGE-K3--->
     C           DULKE     TAG
     * dechets de roulage .
     C           DROUA1    ADD  DROUA2    DROUA
     C           DROUA     ADD  DECPLU    DECFIN
     C                     ADD  DROUOE    DECFIN
    C* fenetres
D1  C           COFEN     IFEQ 0
    C           FACON     CABEQ6         DULKO
D2  C           FACON     IFNE 6
    C                     GOTO DULKH
F2  C                     END
F1  C                     END
     * dechets de marche fenetres .
     C           DECFIN    ADD  1,0300    DEC
     C           QTTOT     MULT DEC       NBFEN     H
     C                     MOVELLARFEN    HAUT
     C                     MOVELLONFEN    LARG
     * <---PAGE-K4--->
     C           NBFEN     MULT HAUT      LONGEU
     C           LONGEU    MULT LARG      FENM2     H
     * surface cadree au 100m2 .
     C                     MOVELFENM2     SURFEN
D1  C           COFEN     IFEQ 21
    C           COFEN     OREQ 11
D2  C           RHODO     IFEQ '1'
     C           RODO1     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '2'
     C           RODO2     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '3'
     C           RODO3     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '4'
     C           RODO4     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '5'
     C           RODO5     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '6'
     C           RODO6     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '7'
     C           RODO7     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '8'
     C           RODO8     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '9'
     C           RODO9     MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ 'A'
     C           FILL25    MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ 'B'
     C           FILL26    MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ 'C'
     C           FILL32    MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ 'D'
     C           FILL33    MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ 'E'
     C           FILL34    MULT SURFEN    TOTFEN    H
F2  C                     END
     C                     MOVEA'Fenètre-'LMA,A
     C                     ADD  8         A
F1  C                     END
D1  C           COFEN     IFEQ 20
D2  C           RHODO     IFEQ '1'
     C           RONDEL    MULT NBFEN     TOTFEN    H
     C           TOTFEN    MULT 0,001     TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '2'
     C           FILL36    MULT NBFEN     TOTFEN    H
     C           TOTFEN    MULT 0,001     TOTFEN    H
F2  C                     END
     C                     MOVEA'Languet-'LMA,A
     C                     ADD  8         A
F1  C                     END
D1  C           COFEN     IFEQ 22
D2  C           RHODO     IFEQ '2'
     C           RINAL5    MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '3'
     C           POR1      MULT SURFEN    TOTFEN    H
F2  C                     END
D2  C           RHODO     IFEQ '4'
     C           MOPT      MULT SURFEN    TOTFEN    H
F2  C                     END
     C                     MOVEA'Gaine-'  LMA,A
     C                     ADD  6         A
F1  C                     END
     * <---PAGE-K5--->
     C           HAUT      ADD  LARG      PERIM
     * perimetre d'une fenetre .
     C           PERIM     MULT 2         PERIM
     * longueur de pose de colle en ml. .
     C           PERIM     MULT NBFEN     LONGF
     * longueur au 100ml. .
     C                     MOVELLONGF     LGF
D1  C           COFEN     IFNE 20
     C           LGF       MULT COLFEN    TALFEN    H
     C                     ADD  TALFEN    TOTFEN
     C                     Z-ADDTALFEN    AUTCOL
F1  C                     END
     * <---PAGE-K6--->
     C           DULKH     TAG
     * colle assemblage .
    C           COAS1     CABEQ0         DULKP
D1  C           COAS1     IFEQ 31
    C           COAS1     OREQ 33
    C                     GOTO DULKJ
F1  C                     END
     * <---PAGE-K7--->
     * roulage assemblage 1 et 2 + dechets supplementaires .
     C           DECFIN    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBDEC1    H
     C                     MOVELLPAT1     LONGX
     * longueur depot de colle en ml. .
     C           NBDEC1    MULT LONGX     LONML     H
     * longueur depot de colle au 100ml. .
     C                     MOVELLONML     LON100
D1  C           COLA1     IFEQ 'M'
    C           COLA1     OREQ 'V'
     * colle vynilique .
     C           LON100    MULT COLVYN    COLAS1    H
X1  C                     ELSE
D2  C           COLA1     IFEQ 'P'
     * colle POLYURÉTHANE
     C           LON100    MULT FILL31    COLAS1    H
X2  C                     ELSE
     * colle hot melt .
     C           LON100    MULT COLHME    COLAS1    H
F2  C                     END
F1  C                     END
     C                     MOVEA'Colle-'  LMA,A
     C                     ADD  6         A
     * <---PAGE-K8--->
     C           DULKJ     TAG
    C           COAS2     CABEQ0         DULKL
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     * TMAFBU 27/01/2015
    C           COAS2     OREQ 83
    C                     GOTO DULKL
F1  C                     END
     C           DROUA2    ADD  DECPLU    DECA22
     C                     ADD  DROUOE    DECA22
     C                     ADD  1,0000    DECA22
     C           QTTOT     MULT DECA22    NBDEC1    H
     C                     MOVELLPAT2     LONGX
     * <---PAGE-K9--->
     C           NBDEC1    MULT LONGX     LONML     H
     C                     MOVELLONML     LON100
D1  C           COLA2     IFEQ 'M'
    C           COLA2     OREQ 'V'
     C           LON100    MULT COLVYN    COLAS2    H
X1  C                     ELSE
D2  C           COLA2     IFEQ 'P'
     C           LON100    MULT FILL31    COLAS2    H
X2  C                     ELSE
     C           LON100    MULT COLHME    COLAS2    H
F2  C                     END
F1  C                     END
     C                     MOVEA'Colle-'  LMA,A
     C                     ADD  6         A
     C           DULKL     TAG
     C           COLAS1    ADD  COLAS2    COLASS
     * <---PAGE-K10--->
     * poignees, rivets, rondelles .
D1  C           RINAL     IFNE ' '
     C           DECFIN    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBRIN     H
     C                     MOVELNBRIN     NBRINA
     C                     MOVE 'RINA'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE RINAL     PXVALE
     C                     Z-ADD1         PXMONT
     C           CLEPAR    CHAINPARAME               80
D2  C           PXMONT    IFEQ 1
     C           NBRINA    MULT RINAL1    RINALD    H
F2  C                     END
D2  C           PXMONT    IFEQ 2
     C           NBRINA    MULT RINAL2    RINALD    H
F2  C                     END
D2  C           PXMONT    IFEQ 3
     C           NBRINA    MULT RINAL3    RINALD    H
F2  C                     END
D2  C           PXMONT    IFEQ 4
     C           NBRINA    MULT RINAL4    RINALD    H
F2  C                     END
     C                     ADD  RINALD    TOTASS
     C                     MOVEA'Pearson-'LMA,A
     C                     ADD  8         A
F1  C                     END
     *
     * traceur antivol
D1  C           TTRACE    IFNE ' '
     C           DECFIN    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBRIN     H
     C                     MOVELNBRIN     NBRINA
     C                     MOVE 'TTRA'    PXARGU
     C                     MOVE TTRACE    PXVALE    P
     C           CLEPAR    CHAINPARAME               80
     C  N80      NBRINA    MULT PXMONT    MTRACE    H
     C                     ADD  MTRACE    TOTASS
     C                     MOVEA'Traceur 'LMA,A
     C                     ADD  8         A
     C                     MOVEATTRACE    LMA,A
     C                     ADD  1         A
     C                     MOVEA'-'       LMA,A
     C                     ADD  1         A
F1  C                     END
     *
D1  C           COAS2     IFGT 30
    C           COAS2     ANDLT35
     C           DROUA2    ADD  DECPLU    DECA22
     C                     ADD  DROUOE    DECA22
     C                     ADD  1,0000    DECA22
     C           QTTOT     MULT DECA22    NBDEC1    H
     C                     MOVELLONPOI    LONGX
     C           NBDEC1    MULT LONGX     LONML     H
     C                     MOVELLONML     LON100
     C                     MOVEA'Poignée-'LMA,A
     C                     ADD  8         A
     * <---PAGE-K11--->
D2  C           POIGNE    IFEQ 'P'
     C           LON100    MULT POIG18    POIGN     H         18mm.
X2  C                     ELSE
D3  C           POIGNE    IFEQ 'G'
     C           LON100    MULT POIG20    POIGN     H         20mm.
X3  C                     ELSE
D4  C           POIGNE    IFEQ 'F'
     C           LON100    MULT POIG21    POIGN     H         21mm.
X4  C                     ELSE
D5  C           POIGNE    IFEQ 'M'
     C           LON100    MULT FILL7     POIGN     H         15mm.
X5  C                     ELSE
D6  C           POIGNE    IFEQ 'H'
     C           LON100    MULT FILL14    POIGN     H         15mm.
X6  C                     ELSE
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     Z-ADD13        ERR1,A
     C                     MOVE COLA2     ERR2,A
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     * nombre de rivets ou de rondelles a poser .
     C           NBDEC1    MULT 2         QTRI
     * nombre cadree au 100 .
     C                     MOVELQTRI      QTRIV
     C           QTRIV     MULT RIVET     RIV       H
F1  C                     END
     * <---PAGE-K12--->
     C           DULKO     TAG
     *
     * poignée Champion
D1  C           TYPP      IFEQ 'C'
     C           DECFIN    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBRIN     H
     C                     MOVELNBRIN     NBRINA
     C           TYPPCH    CHAINPOIGNEL1             80
     C  N80      NBRINA    MULT PRIX      POIGN
     C                     MOVEA'Champion'LMA,A
     C                     ADD  8         A
     C                     MOVEA'-'       LMA,A
     C                     ADD  1         A
F1  C                     END
     * bande sesame et, tear tape .
D1  C           COSESA    IFEQ ' '
    C           COTAPE    CABEQ' '       DULKP
F1  C                     END
     C                     Z-ADD0         DECPLZ  80
D1  C           FACON     IFEQ 0
     C           SUFAB     MULT 1000000   SUF15
     C           SUF15     DIV  FORL      LINEA
X1  C                     ELSE
D2  C           FACON     IFEQ 1
     C           SUFAB     MULT 1000000   SUF15  150
     C           SUF15     DIV  LALAIZ    LINEA
X2  C                     ELSE
D3  C           FACON     IFEQ 4
     C           LALAIZ    DIV  DECL      TOTDEC
X3  C                     ELSE
D4  C           LALAIZ    IFNE *ZEROS
     C           LALAIZ    SUB  ACOTE     RESTE
X4  C                     ELSE
     C           FORL      SUB  ACOTE     RESTE
F4  C                     END
     C           RESTE     DIV  ONDL      NBR       H
D4  C           NBR       IFEQ 0
     C                     Z-ADD1         NBR
F4  C                     END
     C           POSF1     MULT NBR       TOTDEC    H
     * nombre de decoupes .
     C                     ADD  POSF2     TOTDEC
F3  C                     END
     C           SUREG     MULT NBFAB     DECPLZ
     C                     MOVELSBDEC     SU      76
     C           DECPLZ    DIV  SU        DECPLZ
     C                     ADD  QTTOT     DECPLZ
     * nombre de coupes sur onduleuse .
     C           DECPLZ    DIV  TOTDEC    PAS       H
     * longueur passage en mm. .
D3  C           FACON     IFEQ 4
     C           PAS       MULT DECH      LINEA
X3  C                     ELSE
     C           PAS       MULT ONDH      LINEA
F3  C                     END
     * bande adhésive sur plieuse
D3  C           COSESA    IFEQ 'A'
    C           COSESA    OREQ 'B'
    C           COSESA    OREQ 'C'
    C           COSESA    OREQ 'D'
     C                     MOVE LGBAX     LGBA    40
D4  C           LGBA      IFNE *ZEROS
     C           QTTOT     MULT LGBA      LINEA
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     * dechets faconnage .
     C                     MOVELDECROU    DECSES  44
     C           LINEA     MULT DECSES    DECDEC    H
    C* <---PAGE-K13--->
     C           DULKQ     TAG
     * longueur au 100ml. par coupe .
     C                     ADD  DECDEC    LINEA
     C           LINEA     MULT 0,001     LINEA     H
     C           LINEA     MULT 0,01      LINEB  122
D1  C           COSESA    IFNE ' '
     * longueur total au 100ml .
     C           LINEB     MULT NBSESA    CENML
     * prix 100ml cout total .
D2  C           COSESA    IFEQ 'S'
     C           CENML     MULT SESAME    VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'E'
     C           CENML     MULT FILL8     VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'V'
     C           CENML     MULT FILL11    VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'A'
     C           CENML     MULT FILL16    VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'B'
     C           CENML     MULT FILL17    VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'C'
     C           CENML     MULT FILL19    VALSES
F2  C                     END
D2  C           COSESA    IFEQ 'D'
     C           CENML     MULT FILL37    VALSES
F2  C                     END
     C                     MOVEA'Sésame-' LMA,A
D2  C           COSESA    IFEQ 'A'
    C           COSESA    OREQ 'B'
    C           COSESA    OREQ 'C'
    C           COSESA    OREQ 'D'
     C                     MOVEA'Adhésif' LMA,A
F2  C                     END
     C                     ADD  7         A
     C                     MOVEA': '      LMA,A
     C                     ADD  1         A
     C                     MOVE NBSESA    NBTA    2
     C                     MOVEANBTA      LMA,A
     C                     ADD  2         A
F1  C                     END
D1  C           COTAPE    IFNE ' '
D2  C           ONDUL     IFNE 0                           COMPRIS
    C           CCOL      ORNE 0                             DANS
    C           APPEX     ORNE 'F'                             APPRO
     C           LINEB     MULT NBTAPE    CENML
     C                     MOVEA'Teartape'LMA,A
D3  C           COTAPE    IFEQ 'T'
    C           COTAPE    OREQ 'R'
     C           CENML     MULT TEARTA    VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'L'
     C           CENML     MULT FILL9     VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'G'
     C           CENML     MULT FILL18    VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'H'
     C           CENML     MULT VERNVE    VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'P'
     C           CENML     MULT VERNLH    VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'Q'
     C           CENML     MULT VERNBH    VALTAP
F3  C                     END
D3  C           COTAPE    IFEQ 'M'
     C           CENML     MULT VERNRO    VALTAP
     C                     MOVEA'Bd Armée'LMA,A
F3  C                     END
     C                     ADD  7         A
     C                     MOVEA': '      LMA,A
     C                     ADD  1         A
     C                     MOVE NBTAPE    NBTA    2
     C                     MOVEANBTA      LMA,A
     C                     ADD  2         A
F2  C                     END
F1  C                     END
     * <---PAGE-K14--->
     C           DULKP     TAG
     * scarset
    C*          TSOND     IFEQ 'SC'
    C*          SUFAB     MULT NBFAB     SNETOT
    C*                    MOVELSNETOT    SNE100
    C*          FILL15    MULT SNE100    MTSCAR    H
    C*          1         ADD  DECROU    PDECXX  54
    C*                    MULT PDECXX    MTSCAR    H
    C*                    ADD  MTSCAR    TOTASS
    C*                    MOVEA'Scarset-'LMA,A
    C*                    ADD  8         A
    C*                    END
     * pelliculage
D1  C           PELLI     IFEQ '*'
    C*
D2  C           PAFIL1    IFNE *BLANKS
D3  C           INVPP1    IFEQ 'O'
D4  C           FORL      IFNE *ZEROS
     C           FORL      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           ONDL      IFNE *ZEROS
     C           ONDL      DIV  1000      LAIZML
X5  C                     ELSE
D6  C           DECL      IFNE *ZEROS
     C           DECL      DIV  1000      LAIZML
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           FORH      IFNE *ZEROS
     C           FORH      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           ONDH      IFNE *ZEROS
     C           ONDH      DIV  1000      LAIZML
X5  C                     ELSE
D6  C           DECH      IFNE *ZEROS
     C           DECH      DIV  1000      LAIZML
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     C           LZPUP1    DIV  100       LZPUPM  43
     C           LZPUPM    MULT LAIZML    SURFM2  86
     C           SURFM2    MULT 1000      ZTR1    83
D3  C           POSF1     IFEQ 0
     C                     Z-ADDSUVENT    ZTR2    83
X3  C                     ELSE
     C           SUVENT    MULT POSF1     ZTR2
F3  C                     END
     C           ZTR1      DIV  ZTR2      ZTR3    64H
     C           DECROU    ADD  1,0000    DEC
     C                     MULT DEC       ZTR3      H
D3  C           CODPP1    IFEQ 'A'
     C                     Z-ADDFILL15    COLPEL  52
F3  C                     END
     C           DECPP1    DIV  3,5       GCXH    42       DEPOT MOYEN 20G
     C                     MULT GCXH      COLPEL
     C           COLPEL    MULT ZTR3      VALPEL    H
     C                     ADD  VALPEL    VALPET
     *
     C                     MOVELQUAPP1    QUAPPM
     C           CLEPRF    CHAINMATPREL1             80
D3  C           *IN80     IFEQ '0'
     * GUY 14/01/2013
D4  C           DSGP      IFEQ 'SP'
     C                     Z-ADDPAPRI     PXFILM  62                       UNITE
X4  C                     ELSE
     C           PAPRI     ADD  PAPSU     PXFILM  62                       UNITE
F4  C                     END
     C           PXFILM    MULT ZTR3      VAFILM    H
     C                     ADD  VAFILM    VAFILT
F3  C                     END
F2  C                     END
     *
D2  C           PAFIL2    IFNE *BLANKS
D3  C           INVPP2    IFEQ 'O'
D4  C           FORL      IFNE *ZEROS
     C           FORL      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           ONDL      IFNE *ZEROS
     C           ONDL      DIV  1000      LAIZML
X5  C                     ELSE
D6  C           DECL      IFNE *ZEROS
     C           DECL      DIV  1000      LAIZML
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           FORH      IFNE *ZEROS
     C           FORH      DIV  1000      LAIZML
X4  C                     ELSE
D5  C           ONDH      IFNE *ZEROS
     C           ONDH      DIV  1000      LAIZML
X5  C                     ELSE
D6  C           DECH      IFNE *ZEROS
     C           DECH      DIV  1000      LAIZML
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     C           LZPUP2    DIV  100       LZPUPM  43
     C           LZPUPM    MULT LAIZML    SURFM2  86
     C           SURFM2    MULT 1000      ZTR1
D3  C           POSF1     IFEQ 0
     C                     Z-ADDSUVENT    ZTR2
X3  C                     ELSE
     C           SUVENT    MULT POSF1     ZTR2
F3  C                     END
     C           ZTR1      DIV  ZTR2      ZTR3      H
     C           DECROU    ADD  1,0000    DEC
     C                     MULT DEC       ZTR3      H
D3  C           CODPP2    IFEQ 'A'
     C                     Z-ADDFILL15    COLPEL  52
F3  C                     END
     C           DECPP2    DIV  3,5       GCXH    42       DEPOT MOYEN 20G
     C                     MULT GCXH      COLPEL
     C           COLPEL    MULT ZTR3      VALPEL    H
     C                     ADD  VALPEL    VALPET
     *
     C                     MOVELQUAPP2    QUAPPM
     C           CLEPRF    CHAINMATPREL1             80
D3  C           *IN80     IFEQ '0'
     * GUY 14/01/2013
D4  C           DSGP      IFEQ 'SP'
     C                     Z-ADDPAPRI     PXFILM  62                       UNITE
X4  C                     ELSE
     C           PAPRI     ADD  PAPSU     PXFILM  62                       UNITE
F4  C                     END
     C           PXFILM    MULT ZTR3      VAFILM    H
     C                     ADD  VAFILM    VAFILT
F3  C                     END
F2  C                     END
    C*
     C                     MOVEA'Pellicul'LMA,A
     C                     ADD  8         A
     C                     MOVEA'age-'    LMA,A
     C                     ADD  4         A
F1  C                     END
     * dorure
D1  C           CODDOR    IFEQ '*'
     C           DECROU    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBFDOR    H
D2  C           POSF1     IFNE 0
     C                     DIV  POSF1     NBFDOR    H
X2  C                     ELSE
D3  C           POSFO     IFNE 0
     C                     DIV  POSFO     NBFDOR
F3  C                     END
F2  C                     END
     C                     Z-ADD0         D       20
D2  C                     DO   12
     C                     ADD  1         D
D3  C           DFX,D     IFNE *BLANKS
     C           NBFDOR    MULT DSF,D     SFDCM2 110       EN CM²
     C           SFDCM2    DIV  1000000   SFD100 115       POUR 100 M²
D4  C           DFX,D     IFEQ ' 1'
     C           SFD100    MULT FILL27    PXD100  92H
F4  C                     END
D4  C           DFX,D     IFEQ ' 2'
     C           SFD100    MULT FILL28    PXD100    H
F4  C                     END
D4  C           DFX,D     IFEQ ' 3'
     C           SFD100    MULT FILL29    PXD100    H
F4  C                     END
D4  C           DFX,D     IFEQ ' 4'
     C           SFD100    MULT FILL30    PXD100    H
F4  C                     END
D4  C           DFX,D     IFEQ ' 5'
     C           SFD100    MULT FILL35    PXD100    H
F4  C                     END
     C                     ADD  PXD100    VALDOR
F3  C                     END
F2  C                     END
    C*
     C                     MOVEA'Dorure-' LMA,A
     C                     ADD  7         A
F1  C                     END
     * Dorure a froid nouvelles OFFSET
     * -------------------------------
D1  C           OTCOEP    IFNE *ZEROS
D2  C           OTEMEP    IFNE *BLANK
    C           OTEMER    ORNE *BLANK
    C           OTEMIP    ORNE *BLANK
     C           DECROU    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBFDOR    H
D3  C           POSF1     IFNE 0
     C                     DIV  POSF1     NBFDOR    H
X3  C                     ELSE
D4  C           POSFO     IFNE 0
     C                     DIV  POSFO     NBFDOR
F4  C                     END
F3  C                     END
     C                     Z-ADD0         D       20
D3  C                     DO   9
     C                     ADD  1         D
D4  C           OFX,D     IFNE *BLANKS
     C           NBFDOR    MULT OSF,D     SFDCM2 110       EN CM²
     C           SFDCM2    DIV  1000000   SFD100 115       POUR 100 M²
D5  C           OFX,D     IFEQ ' 1'
     C           SFD100    MULT FILL27    PXD100  92H
F5  C                     END
D5  C           OFX,D     IFEQ ' 2'
     C           SFD100    MULT FILL28    PXD100    H
F5  C                     END
D5  C           OFX,D     IFEQ ' 3'
     C           SFD100    MULT FILL29    PXD100    H
F5  C                     END
D5  C           OFX,D     IFEQ ' 4'
     C           SFD100    MULT FILL30    PXD100    H
F5  C                     END
D5  C           OFX,D     IFEQ ' 5'
     C           SFD100    MULT FILL35    PXD100    H
F5  C                     END
     C                     ADD  PXD100    VALDAF
F4  C                     END
F3  C                     END
    C*
     C                     MOVEA'Daf-'    LMA,A
     C                     ADD  4         A
F2  C                     END
F1  C                     END
     * Peinture sur tranche
D1  C           PTDIF     IFNE ' '
     C           DROUA1    ADD  DROUA2    DROUA
     C                     ADD  DROUOE    DROUA
     C           DROUA     ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBDECP    H
    C*
D2  C           PTNBR     IFEQ *ZEROS
     C                     Z-ADD1         TBNSEG
     C                     MOVE ONDUL     XPTPA1
     C                     MOVELXPTPKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XPTPAQUE'TBLNOM
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XPTP00
     C                     Z-ADDXPTP01    PTNBR
F3  C                     END
F2  C                     END
D2  C           PTNBR     IFNE *ZEROS
     C           NBDECP    DIV  PTNBR     NBPAQ   70
X2  C                     ELSE
     C                     Z-ADDNBDECP    NBPAQ
F2  C                     END
    C*
     C                     Z-ADD1         TBNSEG
     C                     MOVE PTENC     XPTEA1
     C                     MOVELXPTEKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D2  C           CDE       IFEQ 1
     C                     MOVEL'XPTENCRE'TBLNOM
X2  C                     ELSE
     C                     MOVEL'XPTENPRU'TBLNOM
F2  C                     END
     C           KTBA01    CHAINXTBASE01             99
D2  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XPTE00
F2  C                     END
    C*
     C           NBPAQ     MULT XPTE02    VALPT     H
D2  C                     SELEC
     C           PTDIF     WHEQ 'B'
     C                     MULT 2         VALPT
     C           PTDIF     WHEQ 'C'
     C                     MULT 3         VALPT
     C           PTDIF     WHEQ 'D'
     C                     MULT 4         VALPT
F2  C                     ENDSL
    C*
     C                     MOVEA'Peinture'LMA,A
     C                     ADD  8         A
     C                     MOVEA'-'       LMA,A
     C                     ADD  1         A
F1  C                     END
     *
     * Oeillet
D1  C           EYECOD    IFNE *BLANK
    C           EYENB     ANDNE0
     C                     MOVE 'EYES'    ACCCAT
     C                     MOVE EYECOD    ACCCOD
     C           CLEEYE    CHAINACCVALL1             80
     C           DROUOE    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBOEI     H
     C           EYENB     MULT NBOEI     NBOEI
D2  C           A         IFLE 28
     C                     MOVEA'Oeillets'LMA,A
     C                     ADD  8         A
     C                     MOVEA': '      LMA,A
     C                     ADD  1         A
     C                     MOVE EYENB     NBOE    2
     C                     MOVEANBOE      LMA,A
     C                     ADD  2         A
     C                     MOVEA'-'       LMA,A
     C                     ADD  1         A
F2  C                     END
     C           NBOEI     MULT VALPRU    VALOEI           PRU
D2  C           CORCOD    IFNE *BLANK
    C           CORDNB    ANDNE0
     C                     MOVE 'CORD'    ACCCAT
     C                     MOVE CORCOD    ACCCOD
     C           CLEEYE    CHAINACCVALL1             80
     C           DROUOE    ADD  1,0000    DEC
     C           QTTOT     MULT DEC       NBCOR     H
     C           CORDNB    MULT NBCOR     NBCOR
D3  C           A         IFLE 29
     C                     MOVEA'Cordons' LMA,A
     C                     ADD  7         A
     C                     MOVEA': '      LMA,A
     C                     ADD  1         A
     C                     MOVE CORDNB    NBCO    2
     C                     MOVEANBCO      LMA,A
     C                     ADD  2         A
     C                     MOVEA'-'       LMA,A
     C                     ADD  1         A
F3  C                     END
     C           NBCOR     MULT VALPRU    VALCOR           PRU
F2  C                     END
F1  C                     END
     * Fin Oeillet
     *
    C*
     * poignees rivets colle .
     C                     ADD  RIV       TOTASS
     C                     ADD  POIGN     TOTASS
     C                     ADD  ROND      TOTASS
     * colle assemblage .
     C                     ADD  COLASS    TOTASS
     C                     ADD  COLASS    AUTCOL
     * fenetres .
     C                     ADD  TOTFEN    TOTASS
     * sesame .
     C                     ADD  VALSES    TOTASS
     C                     ADD  VALTAP    TOTASS
     * dorure .
     C                     ADD  VALDOR    TOTASS
     C                     ADD  VALDAF    TOTASS
     * peinture
     C                     ADD  VALPT     TOTASS
     * Oeillets
     C                     ADD  VALOEI    TOTASS
     C                     ADD  VALCOR    TOTASS
     * surface nette d'une fabrication --> surface nette totale .
     * TMAFBU 28/11/2014 INC020428
D1  C           SUFAB     IFEQ 0
     C                     Z-ADD1         SUFAB
F1  C                     END
D1  C           NBFAB     IFEQ 0
     C                     Z-ADD1         NBFAB
F1  C                     END
     C           SUFAB     MULT NBFAB     SNETOT
     * alignee au 100m2 .
     C                     MOVELSNETOT    SNE100
     C           TOTASS    DIV  SNE100    TOTDIV    H
     C           TOTASS    SUB  AUTCOL    AUTMAT  82
     C           AUTMAT    DIV  SNE100    MATANX  62H
     C           AUTCOL    DIV  SNE100    AUTCOL    H
     C                     ADD  VALPET    TOTDIV
     C                     ADD  VALPET    MATANX
     C                     ADD  VAFILT    TOTDIV
     C                     ADD  VAFILT    MATANX
     C                     Z-ADDTOTDIV    DIVDIR
     C           TOTDIV    MULT KMATA     DIVCEN  62H
     C           DIVCEN    MULT 0,01      DIVM2
     C           DIVM2     MULT SUVENT    DIVUNT  62H
     * fin du module -K-
    C           MODUKF    ENDSR
     C/EJECT
     *******************************
     * calcul total des matieres . **********************************
     *******************************   module -N-
    C           MODULN    BEGSR
     C                     EXSR BLMODN
     * <---PAGE-N1--->
     C           TMATCE    ADD  EMBCEN    TOTCEN  72
     C                     ADD  DIVCEN    TOTCEN
     C           TOTCEN    MULT 0,01      TOTM2
     C           TOTM2     MULT SUVENT    TOTUNT  72H
     C                     ADD  EMBUNT    TOTUNT           CAUSE RAPPORT
     C                     SUB  EMBUNS    TOTUNT           POUR EMBALLAGE
     C           TDIRMA    ADD  EMBDIR    MATDIR
     C                     ADD  DIVDIR    MATDIR
     C           MATDIR    MULT 0,01      TOTM2
     C           TOTM2     MULT SUVENT    TDIRMA    H
    C*
D1  C           IMPEXT    IFEQ 3
    C           IMPEXT    OREQ 5
     C                     Z-ADD*ZEROS    DIREXT
F1  C                     END
D1  C           IMPINT    IFEQ 3
    C           IMPINT    OREQ 5
     C                     Z-ADD*ZEROS    DIRINT
F1  C                     END
D1  C           NIMPE1    IFNE *BLANKS
D2  C           RIMPEX    IFNE *ZEROS
     C                     SUB  DIRPEX    DIREXT
X2  C                     ELSE
     C                     Z-ADD*ZEROS    DIREXT
F2  C                     END
F1  C                     END
D1  C           NIMPI1    IFNE *BLANKS
D2  C           RIMPIN    IFNE *ZEROS
     C                     SUB  DIRPIN    DIRINT
X2  C                     ELSE
     C                     Z-ADD*ZEROS    DIRINT
F2  C                     END
F1  C                     END
    C*
     C           DIREXT    MULT 0,01      TOTM2
     C           TOTM2     MULT SUVENT    CDIMEX    H
     C           DIRINT    MULT 0,01      TOTM2
     C           TOTM2     MULT SUVENT    CDIMIN    H
     C           TDIRMA    SUB  CDIMEX    CDIMNE
     C                     SUB  CDIMIN    CDIMNE
     * fin du module -N-
    C                     ENDSR
     C/EJECT
     *************************************
     * totalisation de la valorisation  *****************************
     *************************************   module -T-
     * GP.15/5/84 .
    C           MODULT    BEGSR
     C                     EXSR BLMODT
     C/SPACE 1
     * <---PAGE-T0--->
     C                     Z-ADD*ZEROS    PARFOR
     C                     Z-ADDFOREXP    EXP1    60
     C                     Z-ADDFORFAB    FAB1    60
D1  C           PARFUM    IFNE *ZEROS
     C           PARFUM    MULT NBFAB     PARFOR
X1  C                     ELSE
D2  C           AMALS     IFNE *ZEROS
D3  C           SIM       IFEQ 1
     * TMAFBU FORFAIT POUR A3 08/10/2015
    C           DSGP      OREQ 'A3'
     C           FOREXP    MULT AMALS     EXP1
     C           FORFAB    MULT AMALS     FAB1
F3  C                     END
X2  C                     ELSE
D3  C           FACON     IFEQ 0
    C           TYPDEV    ANDNE4
     C                     Z-ADD*ZEROS    EXP1
     C                     Z-ADD*ZEROS    FAB1
F3  C                     END
F2  C                     END
F1  C                     END
     * <---PAGE-T1--->
D1  C           NBLIV     IFNE 0
     C           EXP1      MULT NBLIV     EXEFOR  60
X1  C                     ELSE
     C           EXP1      MULT NBFAB     EXEFOR
F1  C                     END
     C           FAB1      MULT NBFAB     FABFOR
     C           EXEFOR    ADD  FABFOR    TOFORF  60
     C                     ADD  PARFOR    TOFORF
     C           PARFOR    ADD  FABFOR    FFACON
     * <---PAGE-T2--->
     C                     MOVE ADPA,3    PSOF    3
D1  C           CCOL      IFEQ 6
     C                     MOVE APP,2     AQW1    1
     C                     MOVE APP,6     AQW2    1
X1  C                     ELSE
     C                     MOVE APP,3     AQW1
     C                     MOVE APP,5     AQW2
F1  C                     END
D1  C           IMPEXT    IFEQ 4
    C           AQW1      ANDEQ'F'
    C           PSOF      ANDNE'SOF'
    C           PSOF      ANDNE'PEL'
    C           PSOF      ANDNE'CXH'
    C           ADPA,3    ANDNE'FOURNI '
     C           FORIM1    MULT NBIMP     FOFFEX  60
D2  C           PTTNE     IFEQ '*'
     C           FOFFEX    MULT 0,25      FOFFEX    H
F2  C                     END
D2  C           AMALS     IFNE 0
    C           SIM       ANDNE1
     C           FOFFEX    DIV  AMALS     FOFFEX    H
F2  C                     END
     C                     ADD  FOFFEX    TOFORF
F1  C                     END
     C                     MOVE ADPA,5    PSOF    3
D1  C           IMPINT    IFEQ 4
    C           AQW2      ANDEQ'F'
    C           PSOF      ANDNE'SOF'
    C           PSOF      ANDNE'PEL'
    C           PSOF      ANDNE'CXH'
    C           ADPA,5    ANDNE'FOURNI '
     C           FORIM1    MULT NBIMP     FOFFIN  60
D2  C           PTTNE     IFEQ '*'
     C           FOFFIN    MULT 0,25      FOFFIN    H
F2  C                     END
D2  C           AMALS     IFNE 0
    C           SIM       ANDNE1
     C           FOFFIN    DIV  AMALS     FOFFIN    H
F2  C                     END
     C                     ADD  FOFFIN    TOFORF
F1  C                     END
     C           FOFFIN    ADD  FOFFEX    FIMPRE
     *
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D1  C           DSGPS     IFEQ 'CI'
     C                     Z-ADD0         TOFORF
F1  C                     END
    C*
     C                     MULT NBIMP     HELFO1
     C                     MULT NBIMP     FLEFO1
     C                     MULT NBIMP     FOROF1
     C                     MULT NBIMP     HELFO2
     C                     MULT NBIMP     FLEFO2
     C                     MULT NBIMP     FOROF2
    C*
     C           QTFA      MULT NBFAB     QT      82
    C* SOUS TRAITANCE
     C                     Z-ADD*ZEROS    STREG   60
     C                     Z-ADD*ZEROS    STVAR   72
     C                     Z-ADD*ZEROS    STFIX   60
    C*
D1  C           STCOD1    IFNE *BLANK
     C                     Z-ADD*ZEROS    STRO    72
     C                     Z-ADD*ZEROS    STFI    60
     C                     Z-ADD*ZEROS    RESTX   60
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD1    PXVALE
     C           CLEPAR    CHAINPARAME               80
     C                     Z-ADDPXMONT    PXM1    10
D2  C           STREG1    IFNE *ZEROS
D3  C           PXM1      IFEQ 1
     C           STREG1    MULT NBFAB     RESTX
X3  C                     ELSE
D4  C           NBIMP     IFNE 0
     C           STREG1    MULT NBIMP     RESTX
X4  C                     ELSE
     C           STREG1    MULT NBFAB     RESTX
F4  C                     END
F3  C                     END
     C                     ADD  RESTX     STREG
     C           RESTX     DIV  1,2       STFI      H
F2  C                     END
D2  C           STROU1    IFNE *ZEROS
D3  C           PXMONT    IFGT 20
     C           STROU1    DIV  KROUL     STRO      H
X3  C                     ELSE
     C           STROU1    DIV  1,2       STRO      H
F3  C                     END
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADDRESTX     REST1
     C                     Z-ADDSTROU1    ROST1
X2  C                     ELSE
     C                     Z-ADDSTFI      REST1
     C                     Z-ADDSTRO      ROST1
F2  C                     END
D2  C           PXM1      IFEQ 1
     C                     ADD  STFI      STFIXF
     C                     ADD  STRO      STVAFF
F2  C                     END
D2  C           PXM1      IFEQ 2
     C                     ADD  STFI      STFIXE
     C                     ADD  STRO      STVARE
F2  C                     END
D2  C           PXM1      IFEQ 3
     C                     ADD  STFI      STFIIN
     C                     ADD  STRO      STVARI
F2  C                     END
D2  C           PXMONT    IFEQ 21
     C                     MOVE '*'       NPRUF   1
F2  C                     END
D2  C           PXMONT    IFEQ 22
     C                     MOVE '*'       NPRUE   1
F2  C                     END
D2  C           PXMONT    IFEQ 23
     C                     MOVE '*'       NPRUI   1
F2  C                     END
F1  C                     END
    C*
D1  C           STCOD2    IFNE *BLANK
     C                     Z-ADD*ZEROS    STRO
     C                     Z-ADD*ZEROS    STFI
     C                     Z-ADD*ZEROS    RESTX
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD2    PXVALE
     C           CLEPAR    CHAINPARAME               80
     C                     Z-ADDPXMONT    PXM1
D2  C           STREG2    IFNE *ZEROS
D3  C           PXM1      IFEQ 1
     C           STREG2    MULT NBFAB     RESTX
X3  C                     ELSE
D4  C           NBIMP     IFNE 0
     C           STREG2    MULT NBIMP     RESTX
X4  C                     ELSE
     C           STREG2    MULT NBFAB     RESTX
F4  C                     END
F3  C                     END
     C                     ADD  RESTX     STREG
     C           RESTX     DIV  1,2       STFI      H
F2  C                     END
D2  C           STROU2    IFNE *ZEROS
D3  C           PXMONT    IFGT 20
     C           STROU2    DIV  KROUL     STRO      H
X3  C                     ELSE
     C           STROU2    DIV  1,2       STRO      H
F3  C                     END
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADDRESTX     REST2
     C                     Z-ADDSTROU2    ROST2
X2  C                     ELSE
     C                     Z-ADDSTFI      REST2
     C                     Z-ADDSTRO      ROST2
F2  C                     END
D2  C           PXM1      IFEQ 1
     C                     ADD  STFI      STFIXF
     C                     ADD  STRO      STVAFF
F2  C                     END
D2  C           PXM1      IFEQ 2
     C                     ADD  STFI      STFIXE
     C                     ADD  STRO      STVARE
F2  C                     END
D2  C           PXM1      IFEQ 3
     C                     ADD  STFI      STFIIN
     C                     ADD  STRO      STVARI
F2  C                     END
D2  C           PXMONT    IFEQ 21
     C                     MOVE '*'       NPRUF   1
F2  C                     END
D2  C           PXMONT    IFEQ 22
     C                     MOVE '*'       NPRUE   1
F2  C                     END
D2  C           PXMONT    IFEQ 23
     C                     MOVE '*'       NPRUI   1
F2  C                     END
F1  C                     END
    C*
D1  C           STCOD3    IFNE *BLANK
     C                     Z-ADD*ZEROS    STRO
     C                     Z-ADD*ZEROS    STFI
     C                     Z-ADD*ZEROS    RESTX
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD3    PXVALE
     C           CLEPAR    CHAINPARAME               80
     C                     Z-ADDPXMONT    PXM1
D2  C           STREG3    IFNE *ZEROS
D3  C           PXM1      IFEQ 1
     C           STREG3    MULT NBFAB     RESTX
X3  C                     ELSE
D4  C           NBIMP     IFNE 0
     C           STREG3    MULT NBIMP     RESTX
X4  C                     ELSE
     C           STREG3    MULT NBFAB     RESTX
F4  C                     END
F3  C                     END
     C                     ADD  RESTX     STREG
     C           RESTX     DIV  1,2       STFI      H
F2  C                     END
D2  C           STROU3    IFNE *ZEROS
D3  C           PXMONT    IFGT 20
     C           STROU3    DIV  KROUL     STRO      H
X3  C                     ELSE
     C           STROU3    DIV  1,2       STRO      H
F3  C                     END
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADDRESTX     REST3
     C                     Z-ADDSTROU3    ROST3
X2  C                     ELSE
     C                     Z-ADDSTFI      REST3
     C                     Z-ADDSTRO      ROST3
F2  C                     END
D2  C           PXM1      IFEQ 1
     C                     ADD  STFI      STFIXF
     C                     ADD  STRO      STVAFF
F2  C                     END
D2  C           PXM1      IFEQ 2
     C                     ADD  STFI      STFIXE
     C                     ADD  STRO      STVARE
F2  C                     END
D2  C           PXM1      IFEQ 3
     C                     ADD  STFI      STFIIN
     C                     ADD  STRO      STVARI
F2  C                     END
D2  C           PXMONT    IFEQ 21
     C                     MOVE '*'       NPRUF   1
F2  C                     END
D2  C           PXMONT    IFEQ 22
     C                     MOVE '*'       NPRUE   1
F2  C                     END
D2  C           PXMONT    IFEQ 23
     C                     MOVE '*'       NPRUI   1
F2  C                     END
F1  C                     END
    C*
D1  C           STCOD4    IFNE *BLANK
     C                     Z-ADD*ZEROS    STRO
     C                     Z-ADD*ZEROS    STFI
     C                     Z-ADD*ZEROS    RESTX
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD4    PXVALE
     C           CLEPAR    CHAINPARAME               80
     C                     Z-ADDPXMONT    PXM1
D2  C           STREG4    IFNE *ZEROS
D3  C           PXM1      IFEQ 1
     C           STREG4    MULT NBFAB     RESTX
X3  C                     ELSE
D4  C           NBIMP     IFNE 0
     C           STREG4    MULT NBIMP     RESTX
X4  C                     ELSE
     C           STREG4    MULT NBFAB     RESTX
F4  C                     END
F3  C                     END
     C                     ADD  RESTX     STREG
     C           RESTX     DIV  1,2       STFI      H
F2  C                     END
D2  C           STROU4    IFNE *ZEROS
D3  C           PXMONT    IFGT 20
     C           STROU4    DIV  KROUL     STRO      H
X3  C                     ELSE
     C           STROU4    DIV  1,2       STRO      H
F3  C                     END
F2  C                     END
D2  C           CDE       IFEQ 1
     C                     Z-ADDRESTX     REST4
     C                     Z-ADDSTROU4    ROST4
X2  C                     ELSE
     C                     Z-ADDSTFI      REST4
     C                     Z-ADDSTRO      ROST4
F2  C                     END
D2  C           PXM1      IFEQ 1
     C                     ADD  STFI      STFIXF
     C                     ADD  STRO      STVAFF
F2  C                     END
D2  C           PXM1      IFEQ 2
     C                     ADD  STFI      STFIXE
     C                     ADD  STRO      STVARE
F2  C                     END
D2  C           PXM1      IFEQ 3
     C                     ADD  STFI      STFIIN
     C                     ADD  STRO      STVARI
F2  C                     END
D2  C           PXMONT    IFEQ 21
     C                     MOVE '*'       NPRUF   1
F2  C                     END
D2  C           PXMONT    IFEQ 22
     C                     MOVE '*'       NPRUE   1
F2  C                     END
D2  C           PXMONT    IFEQ 23
     C                     MOVE '*'       NPRUI   1
F2  C                     END
F1  C                     END
    C*
     C           STVAFF    ADD  STVARE    STVAR
     C                     ADD  STVARI    STVAR
     C           STROU1    ADD  STROU2    STROUL  72
     C                     ADD  STROU3    STROUL
     C                     ADD  STROU4    STROUL
     C           STFIXF    ADD  STFIXE    STFIX   60
     C                     ADD  STFIIN    STFIX
     *
     C                     MULT QT        STVARE
     C                     MULT QT        STVARI
     *
     C           FABFOR    ADD  PARFOR    FABFO1  60
     C           FABFO1    DIV  NBFAB     FFACON
     C                     MULT NBFAB     TYPFOR
     *
     C                     XFOOTRO        TODERO  42
     C                     XFOOTRMA       TOREMA  60
     C                     XFOOTREG       TOREVA  60
     C                     XFOOTROU       TOROUL  72
     C                     ADD  SUPDEC    TODERO  42
     C                     ADD  TOFORF    TOREVA
     C           TOREMA    ADD  TOREVA    TOREGL  60
    C*
D1  C           NBIMP     IFNE *ZEROS
     C           FIXEXT    DIV  NBIMP     CDIREX    H
     C           FIXINT    DIV  NBIMP     CDIRIN    H
F1  C                     END
     C           FIXFAC    DIV  NBFAB     CDIRFA    H
     C           VAREXT    DIV  QT        UNVAEX    H
     C           VARINT    DIV  QT        UNVAIN    H
     C           VARFAC    DIV  QT        UNVAFA    H
     C           TOREVA    SUB  TOFORF    PRUFIX
     C           PRUFIX    DIV  KREG      PRUFIX    H
     C                     ADD  TOFORF    PRUFIX
     C           TOREMA    DIV  KMAT      PR1     82H
     C                     ADD  PR1       PRUFIX
     C           PRUFIX    DIV  QT        PRUFIX    H
     C           TOROUL    DIV  KROUL     PRUVAR    H
     C                     Z-ADDTDIRMA    PRUMAT
    C*
D1  C           CDE       IFEQ 1
     C                     ADD  STROUL    TOROUL
     C                     ADD  STREG     TOREVA
     C                     ADD  STREG     TOREGL
X1  C                     ELSE
     C                     ADD  STVAR     TOROUL
     C                     ADD  STFIX     TOREVA
     C                     ADD  STFIX     TOREGL
F1  C                     END
    C*
     C           TOREGL    DIV  QT        REGUNT  72H
     C           TOROUL    ADD  REGUNT    TOTPAR  82
     C                     ADD  TOTUNT    TOTPAR
     C           RM2DIR    ADD  TEGDIR    DIRREG  60
     C           DIRREG    DIV  QT        RGUNDI  72H
     C           TOUDIR    DIV  QT        ROUNDI  72H
     C           ROUNDI    ADD  RGUNDI    DIRPAR  82
     C                     ADD  TDIRMA    DIRPAR
     C           TOTAMT    DIV  QT        AMT     72H
     * <---PAGE-T3--->
     C                     MULT 0,01      RMAFA     H
     C                     MULT 0,01      RMAEX     H
     C                     MULT 0,01      RMAIN     H
     C                     MOVELRELAT     RELAT2  44
D1  C           RELAT     IFNE 0
     C           RELAT     DIV  100       SUPLVA  54
     C                     ADD  1         SUPLVA
     C                     MULT SUPLVA    CDIREX    H
     C                     MULT SUPLVA    CDIRIN    H
     C                     MULT SUPLVA    CDIRFA    H
     C                     MULT SUPLVA    RMAEX     H
     C                     MULT SUPLVA    RMAIN     H
     C                     MULT SUPLVA    RMAFA     H
     C                     MULT SUPLVA    UNVAEX    H
     C                     MULT SUPLVA    UNVAIN    H
     C                     MULT SUPLVA    UNVAFA    H
     C                     MULT SUPLVA    CDIMEX    H
     C                     MULT SUPLVA    CDIMIN    H
     C                     MULT SUPLVA    CDIMNE    H
     C                     MULT SUPLVA    PRUMAT    H
     C                     MULT SUPLVA    PRUFIX    H
     C                     MULT SUPLVA    PRUVAR    H
     C           TOTPAR    MULT RELAT2    SUPLV   72H
     C           DIRPAR    MULT RELAT2    SUPDIR  72H
F1  C                     END
D1  C           AUTFRB    IFNE 0
D2  C           CDE       IFNE 1
     C                     DIV  1,2       AUTFRB
F2  C                     END
     C                     ADD  AUTFRB    SUPLV
     C                     ADD  AUTFRB    SUPDIR
     C                     ADD  AUTFRB    PRUMAT
F1  C                     END
D1  C           SUPLV     IFNE *ZEROS
     C                     MOVELLIB,2     LIBSUP
F1  C                     END
     * ajout du mt. port mutation  pre-imprime dans la zone supplement
     * <---PAGE-T4--->
D1  C           GP        IFEQ 'A'                        QUE 1° DEVIS
D2  C           PLUPOR    IFNE *ZEROS
D3  C           LIBSUP    IFNE *BLANKS
     C                     MOVELLIB,3     LIBSUP
X3  C                     ELSE
D4  C           PLUPOR    IFEQ MUTGFO
     C                     MOVELLIB,4     LIBSUP
X4  C                     ELSE
     C                     MOVELLIB,1     LIBSUP
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C           PLUPOR    DIV  QT        PLUPOR           * * * * * *
     C                     ADD  PLUPOR    SUPLV            * * * * * *
     *
     C                     ADD  SUPLV     TOROUL
     C           TOTPAR    ADD  SUPLV     TOTDHT  82
     C                     ADD  STVAR     PRUVAR
     C           STFIX     DIV  QT        STRUV   60H
     C                     ADD  STRUV     PRUFIX
     C           DIRPAR    ADD  SUPDIR    TOTDIR  82
     C                     ADD  STVAR     TOTDIR
     C                     ADD  STRUV     TOTDIR
     C           AMT       MULT 100       TALAMT  80
     C           TALAMT    DIV  TOTDHT    PCAMT   42H
     C                     Z-ADDTOTDHT    TOTUVE  82
     * <---PAGE-T4'-->
     C           CDIMEX    MULT KMAT      MATEXT    H
     C           CDIMIN    MULT KMAT      MATINT    H
     C           CDIMNE    MULT KMAT      MATIEF    H
     C                     ADD  AUTFRB    MATIEF
     C           SUVENT    DIV  100       SV100M 108
D1  C           DREGST    IFNE *ZEROS
     C           DREGST    MULT KMAT      WW72    72H
     C                     MULT SV100M    WW72      H
     C                     SUB  WW72      MATIEF
     C           DREGST    MULT KREG      WW72      H
     C                     MULT SV100M    WW72      H
     C                     ADD  WW72      MATIEF
F1  C                     END
D1  C           DROUST    IFNE *ZEROS
     C           DROUST    MULT KMAT      WW72      H
     C                     MULT SV100M    WW72      H
     C                     SUB  WW72      MATIEF
     C           DROUST    MULT KROUL     WW72      H
     C                     MULT SV100M    WW72      H
     C                     ADD  WW72      MATIEF
F1  C                     END
     C                     ADD  RMAEXX    RMAEX
     C                     ADD  RMAEXZ    RMAEX
     C                     ADD  RMAINX    RMAIN
     C                     ADD  RMAINZ    RMAIN
D1  C           NIMPE1    IFEQ *BLANKS
     C           RMAEX     MULT KMAT      MAREGE    H
X1  C                     ELSE
     C                     SUB  RMAEXX    RMAEX
     C                     SUB  RMAEXZ    RMAEX
     C                     Z-ADDRMAEX     MAREGE
     C           RMAEXX    MULT KMAT      MAREGX  60H
     C                     ADD  MAREGX    MAREGE
     C           RMAEXZ    MULT KMAT      MAREGX    H
     C                     ADD  MAREGX    MAREGE
F1  C                     END
D1  C           NIMPI1    IFEQ *BLANKS
     C           RMAIN     MULT KMAT      MAREGI    H
X1  C                     ELSE
     C                     SUB  RMAINX    RMAIN
     C                     SUB  RMAINZ    RMAIN
     C                     Z-ADDRMAIN     MAREGI
     C           RMAINX    MULT KMAT      MAREGX    H
     C                     ADD  MAREGX    MAREGI
     C           RMAINZ    MULT KMAT      MAREGX    H
     C                     ADD  MAREGX    MAREGI
F1  C                     END
     C           RMAFA     MULT KMAT      MAREGF    H
D1  C           NBIMP     IFNE *ZEROS
     C                     DIV  NBIMP     MAREGE
     C                     DIV  NBIMP     MAREGI
F1  C                     END
     C                     DIV  NBFAB     MAREGF
     C           CDIREX    MULT KREG      VAREGE    H
     C           CDIRIN    MULT KREG      VAREGI    H
     C           CDIRFA    MULT KREG      VAREGF    H
     C           UNVAEX    MULT KROUL     VAROUE    H
     C           UNVAIN    MULT KROUL     VAROUI    H
     C           UNVAFA    MULT KROUL     VAROUF    H
     C                     Z-ADD*ZEROS    RMAFA
     C                     Z-ADD*ZEROS    RMAEX
     C                     Z-ADD*ZEROS    RMAIN
     C                     Z-ADD*ZEROS    RMAEXX  60
     C                     Z-ADD*ZEROS    RMAINX  60
     C                     Z-ADD*ZEROS    RMAEXZ  60
     C                     Z-ADD*ZEROS    RMAINZ  60
     * <---PAGE-T5--->
D1  C           GARNT     IFNE *BLANKS
    C           XAPPS     ANDEQ*BLANKS
    C           PROMO     ANDEQ*BLANKS
D2  C                     DO   29        A
     C                     MOVELMAJO,A    Z12N   120
     C                     MOVE Z12N      MAJOR2  60
     C                     MOVE MAJO,A    MAJOR3  44
    C           QTFAB     CABLEMAJOR2    DULT7
F2  C                     END
     C           DULT7     TAG
     C                     MOVE GARNT     UNIGA   1
D2  C           UNIGA     IFEQ 'A'
    C           UNIGA     OREQ 'B'
     C                     Z-ADDMAJOR3    PCGARN  44
F2  C                     END
     * <---PAGE-T6--->
D2  C           UNIGA     IFEQ 'C'
     C           MAJOR3    MULT 1,33      PCGARN    H
F2  C                     END
D2  C           UNIGA     IFEQ 'D'
     C           MAJOR3    MULT 1,50      PCGARN    H
F2  C                     END
D2  C           UNIGA     IFEQ 'E'
     C           MAJOR3    MULT 1,60      PCGARN    H
F2  C                     END
D2  C           UNIGA     IFGE 'F'
     C           MAJOR3    MULT 1,67      PCGARN    H
F2  C                     END
     C           TOTDHT    MULT PCGARN    GARNI   62H
F1  C                     END
     * <---PAGE-T7--->
     C                     MOVEL*BLANK    PROTOL
     C                     Z-ADD*ZEROS    UNIPRO
D1  C           PROTO     IFNE *BLANKS
     C                     MOVELPROTO     PROTOL  1
     C                     MOVE PROTO     UNIPRO  10
    C                     GOTO DULTJ
F1  C                     END
D1  C           MACLI     IFEQ 0
    C           MICLI     ANDEQ0
    C                     GOTO DULTI
F1  C                     END
D1  C           IMPEXT    IFEQ 0
D2  C           IMPINT    IFEQ 0
    C           IMPINT    OREQ 3
    C           IMPINT    OREQ 5
    C           IMPINT    OREQ 1
    C           COUPIN    ANDEQ'C'
    C           IMPINT    OREQ 2
    C           COUPIN    ANDEQ'C'
     C                     MOVE 3         UNIPRO
    C                     GOTO DULTJ
X2  C                     ELSE
    C                     GOTO DULT1
F2  C                     END
X1  C                     ELSE
    C           IMPEXT    CABEQ4         DULT1
D2  C           IMPEXT    IFEQ 1
D3  C           COUPEX    IFEQ 'C'
     C                     MOVE 3         UNIPRO
    C                     GOTO DULTJ
X3  C                     ELSE
    C                     GOTO DULT1
F3  C                     END
F2  C                     END
D2  C           IMPEXT    IFEQ 2
D3  C           COUPEX    IFEQ 'C'
     C                     MOVE 3         UNIPRO
    C                     GOTO DULTJ
X3  C                     ELSE
    C                     GOTO DULT1
F3  C                     END
F2  C                     END
D2  C           IMPINT    IFEQ 0
    C           IMPINT    OREQ 3
    C           IMPINT    OREQ 5
     C                     MOVE 2         UNIPRO
    C                     GOTO DULTJ
F2  C                     END
    C                     GOTO DULT1
F1  C                     END
     C           DULT1     TAG
D1  C           FACON     IFEQ 1
     C                     MOVE 4         UNIPRO
X1  C                     ELSE
D2  C           FACON     IFEQ 8
     C                     MOVE 1         UNIPRO
X2  C                     ELSE
     C                     MOVE 2         UNIPRO
F2  C                     END
F1  C                     END
     * <---PAGE-T7'-->
     C           DULTJ     TAG
     C                     Z-ADDSUFAB     SURF    90
D1  C           AMALS     IFNE *ZEROS
    C           SIM       ANDEQ1
     * TMAFBU FORFAIT POUR A3 08/10/2015
    C           AMALS     ORNE *ZEROS
    C           DSGP      ANDEQ'A3'
     C           SUFAB     DIV  AMALS     SURF
F1  C                     END
     * <---PAGE-T8--->
D1  C           SURF      IFGE 10000
     C                     Z-ADD5,00      VSFO    42
    C                     GOTO DULT3
F1  C                     END
D1  C           SURF      IFGE 5000
     C                     Z-ADD7,00      VSFO    42
    C                     GOTO DULT3
F1  C                     END
D1  C           SURF      IFGE 2500
     C                     Z-ADD10,00     VSFO
    C                     GOTO DULT3
F1  C                     END
D1  C           SURF      IFGE 1000
     C                     Z-ADD15,00     VSFO
    C                     GOTO DULT3
F1  C                     END
D1  C           SURF      IFGE 500
     C                     Z-ADD20,00     VSFO
    C                     GOTO DULT3
X1  C                     ELSE
     C                     Z-ADD30,00     VSFO
F1  C                     END
     C           DULT3     TAG
     C           VSFO      MULT 2         ETUSFO  42
     C           MACLI     ADD  MICLI     ETCLT   42
     * <---PAGE-T9--->
D1  C           PROTO     IFNE *BLANKS
D2  C           PROTOL    IFEQ 'T'
     C                     Z-ADDETUSFO    ETEND   42
X2  C                     ELSE
     C                     Z-ADDVSFO      ETEND
F2  C                     END
X1  C                     ELSE
     C           ETUSFO    SUB  ETCLT     ETEND
    C           ETEND     CABLE0         DULTI
F1  C                     END
D1  C           UNIPRO    IFGT 3
    C           UNIPRO    OREQ 2
     C           ETEND     MULT 0,15      MAJOR     H
F1  C                     END
D1  C           UNIPRO    IFEQ 3
     C           ETEND     MULT 0,10      MAJOR     H
F1  C                     END
D1  C           UNIPRO    IFEQ 1
     C           ETEND     MULT 0,25      MAJOR   42H
F1  C                     END
D1  C           PROTO     IFEQ *BLANKS
D2  C           MICLI     IFEQ 0
    C           MACLI     OREQ 0
     C           MAJOR     MULT 1,50      MAJOR     H
F2  C                     END
X1  C                     ELSE
D2  C           PROTOL    IFEQ 'T'
D3  C                     SELEC
     C           SURF      WHGT 300000
     C           MAJOR     MULT 1,00      MAJOR     H
     C           SURF      WHGT 200000
     C           MAJOR     MULT 2,00      MAJOR     H
     C           SURF      WHGT 50000
     C           MAJOR     MULT 3,00      MAJOR     H
     C                     OTHER
     C           MAJOR     MULT 4,00      MAJOR     H
F3  C                     ENDSL
X2  C                     ELSE
     C           MAJOR     MULT 1,50      MAJOR     H
F2  C                     END
F1  C                     END
     * <---PAGE-T10--->
     C                     MOVELMAJOR     MAJORZ  44
     C           TOTDHT    MULT MAJORZ    TORERS  72H
     C           DULTI     TAG
D1  C           TYPP2     IFEQ '*'                        AFFICHE
     C                     Z-ADD*ZEROS    GARNI
     C                     Z-ADD*ZEROS    TORERS
F1  C                     END
     C                     ADD  GARNI     TOTUVE
     C                     ADD  TORERS    TOTUVE
     C                     Z-ADDTORERS    TORER
     * <---PAGE-T11--->
     C                     Z-ADD0         NBTRF   20
     C                     Z-ADD0         NBSTOC  20
     C                     Z-ADD0         CALIV   80
     C                     Z-ADD0         INTSTO 102
     C                     Z-ADD0         FABSTO  20
     C                     Z-ADD0         IMPUTE  20
     C                     Z-ADD0         RESTO   20
     C                     Z-ADD0         SEMSTO  30
     C                     Z-ADD0         TOTSTO  50
     C                     Z-ADD0         PLUSTO  30
     C                     Z-ADD0         TALSTO  30
     C                     Z-ADD0         STO     50
     C                     Z-ADD0         STOCA   62
     C/SPACE 1
     C                     Z-ADDNBFAB     NBTRF
D1  C           TYPP2     IFNE '*'                        PAS AFFICHE
     C           QTF       MULT TOTUVE    CALIV
    C           NBLIV     CABEQ0         DULTO
    C           NBLIV     CABLENBFAB     DULTO
    C           FRLIV     CABEQ0         DULTO
     C           NBLIV     SUB  NBTRF     NBSTOC
     C           CALIV     MULT KINT      INTSTO
     C           INTSTO    DIV  360       INTSTO
     C           NBSTOC    DIV  NBTRF     FABSTO
D2  C           FABSTO    IFEQ 0
     C                     SUB  1         NBTRF
     C           NBSTOC    DIV  NBTRF     FABSTO
F2  C                     END
     C           FABSTO    MULT NBTRF     IMPUTE
     C           NBSTOC    SUB  IMPUTE    RESTO
D2  C           FABSTO    IFNE 0
     C           SUIT25    TAG
     C                     ADD  FRLIV     SEMSTO
     C                     ADD  SEMSTO    TOTSTO
     C                     SUB  1         FABSTO
    C           FABSTO    CABGT0         SUIT25
F2  C                     END
     * <---PAGE-T12--->
     C           TOTSTO    MULT NBTRF     STO
D2  C           RESTO     IFNE 0
     C                     Z-ADDSEMSTO    PLUSTO
     C           SUIT78    TAG
     C                     ADD  FRLIV     PLUSTO
     C                     ADD  PLUSTO    TALSTO
     C                     SUB  1         RESTO
    C           RESTO     CABGT0         SUIT78
F2  C                     END
     C           TALSTO    ADD  STO       TOTSTO
     C           INTSTO    MULT TOTSTO    INTSTO
     C           INTSTO    DIV  QT        STOCA
     C                     ADD  STOCA     TOTUVE
     C           DULTO     TAG
    C*
     C                     Z-ADD*ZEROS    VALSST  62
     C                     Z-ADD*ZEROS    INTSTO
D2  C           NBSSTS    IFNE *ZEROS
     C           CALIV     MULT STS1S     INTSTO
     C           INTSTO    MULT NBSSTS    INTSTO
     C           INTSTO    DIV  QTF       VALSST
     C                     ADD  VALSST    STOCA
     C                     ADD  VALSST    TOTUVE
F2  C                     END
    C*
F1  C                     END
     *
D1  C           PRIPOR    IFNE 0
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D2  C           DSGP      IFEQ 'SP'
     C           PRIPOR    DIV  1,05      PRIPOR
F2  C                     END
     C           PRIPOR    DIV  QT        UVPORT
     C           UVPORT    MULT 100       TALPOR
     C                     ADD  UVPORT    TOTUVE
F1  C                     END
     * fin du module -T-
     C           TOTUVE    SUB  UVPORT    DHT     82       *FORMATAGE
     C           DHT       MULT QT        MONCDE  70       *POUR ECRIT.
     C           UVPORT    MULT QT        VALPOR  70       *F.BESOMAT
     *
D1  C           DSGP      IFEQ 'A0'
    C           STOCKE    ANDEQ'O'
    C           DSGP      OREQ 'A4'
     C           SUFAB     MULT NBFAB     SUFTOT
     C                     Z-ADD0         DEMARG  52
     C                     Z-ADD0         CMATG   82
     C                     Z-ADD0         CREGLG  82
     C                     Z-ADD0         CROULG  82
     C                     Z-ADD0         CMA10G  52
     C                     Z-ADD0         CRE10G  52
     C                     Z-ADD0         CRO10G  52
     C                     Z-ADDTODERO    DEMARG
     C                     Z-ADDDIRMAT    CMA10G
     C           DEXCEN    DIV  KROUL     DEXCE2  72H
     C                     ADD  DEXCE2    CMA10G
     C           DINCEN    DIV  KROUL     DINCE2  72H
     C                     ADD  DINCE2    CMA10G
     C           TOREGL    SUB  TOREMA    REGSTO  60
     C                     SUB  TOFORF    REGSTO
     C           TOREMA    DIV  KMAT      CREGL1  82H
     C           REGSTO    DIV  KREG      CREGLG    H
     C                     ADD  CREGL1    CREGLG
     C                     ADD  TOFORF    CREGLG
     C           SUFTOT    MULT 0,01      SM2     82
     C           CREGLG    DIV  SM2       CRE10G    H
     C           CMA10G    MULT SM2       CMATG
     C           TOROUL    DIV  KROUL     CROUL1  72H
     C           CROUL1    MULT QTROL     CROULG
     C           CROULG    DIV  SM2       CRO10G    H
F1  C                     END
     C                     Z-ADD0         PARFUM
    C                     ENDSR
     C/EJECT
     *************************************
     * PRICING                          **
     *************************************   module -P-
    C           MODULP    BEGSR
     C                     Z-ADD1         KMAT
     C                     Z-ADD1         KMATA
     C                     Z-ADD1         KREG
     C                     Z-ADD1         KROUL
     C           TYPOPR    CHAINFTYPOPL1             99
D1  C           *IN99     IFEQ '0'
     C                     Z-ADDKMP       KMAT
     C                     Z-ADDKMA       KMATA
     C                     Z-ADDKROU      KROUL
D2  C           TYPOPR    IFEQ *BLANKS
     C                     EXSR GESIND
F2  C                     END
X1  C                     ELSE
     C                     EXSR GESIND
F1  C                     END
    C                     ENDSR
     * ----------------------------------------------------- *
     * Recherche si application du code industrie
     * ----------------------------------------------------- *
    C           GESIND    BEGSR
     C           CLESTA    CHAINCLISTAL1             99
D1  C           *IN99     IFEQ '0'
     C                     Z-ADDINDUS     CINDUS
D2  C           CINDUS    IFNE 0
     C           CINDUS    CHAINFCODINL1             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDCKMP      KMAT
     C                     Z-ADDCKMA      KMATA
     C                     Z-ADDCKREG     KREG
     C                     Z-ADDCKROU     KROUL
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * calcul des normes standards en faconnage/impression .
     * ----------------------------------------------------- *
    C           NORSTD    BEGSR
     C                     MOVE *ZEROS    COULX
     C                     MOVE *BLANKS   TVERX
     C                     MOVE *ZEROS    CADEN1  50
     C                     MOVE *ZEROS    CADEN2  50
     C                     MOVE *ZEROS    CADEN3  50
     C                     MOVE *ZEROS    CADEN4  50
     C                     MOVE *ZEROS    RODEC1  42
     C                     MOVE *ZEROS    RODEC2  42
     C                     MOVE *ZEROS    RODEC3  42
     C                     MOVE *ZEROS    RODEC4  42
     C                     MOVE *ZEROS    TPS1    32
     C                     MOVE *ZEROS    DROUL1  70
     C                     MOVE *ZEROS    TPS2    32
     C                     MOVE *ZEROS    DROUL2  70
     C                     MOVE *ZEROS    TPS3    32
     C                     MOVE *ZEROS    DROUL3  70
     C                     MOVE *ZEROS    TPS4    62
     C                     MOVE *ZEROS    DROUL4  70
    C* suivi production
D1  C           DSGP      IFEQ 'SU'
D2  C           SECT      IFGT '3'
    C           SECT      OREQ '1'
    C           SSECT     ANDEQ'3'
D3  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'0'
X3  C                     ELSE
     C                     Z-ADDQTENES    QTENET
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           DSGP      IFEQ 'AB'
D2  C           QTENET    IFEQ *ZEROS
     C                     Z-ADDQTENES    QTENET
F2  C                     END
D2  C           NOMACS    IFNE *BLANKS
    C           NOMACS    ANDNE'00'
    C           DSGPS     ANDNE'AA'
    C           NOMAC     ANDEQ*BLANKS
    C           NOMACS    ORNE *BLANKS
    C           NOMACS    ANDNE'00'
    C           DSGPS     ANDEQ'AA'
    C           NOMAC     ANDEQ*BLANKS
     C                     MOVE NOMACS    NOMAC
     C                     Z-ADDNOPASS    USFAB
F2  C                     END
F1  C                     END
    C*
     C                     SETOF                     16
     C                     MOVELUSFAB     Z3A     3
     C                     MOVE SS        Z3A
     C                     MOVELZ3A       Z5A     5
     C                     MOVE NOMAC     Z5A
     C                     MOVELCLEREC    Z10AA  10
     *
     C                     MOVE HELPR     ELPR    1        helio
     C                     MOVE HELABC    ELABC   1
     C                     MOVE HELCOU    ELCOU   10
     C                     MOVE HELTS     ELTS    1
     C                     MOVE HELVER    ELVER   1
     C                     MOVE FLEPR     LEPR    1        flexo
     C                     MOVE FLEABC    LEABC   1
     C                     MOVE FLECOU    LECOU   10
     C                     MOVE FLEVER    LEVER   1
     C                     MOVE FLETS     LETS    1
     C                     MOVE JAGGRA    JGRA    30       coupeuse
     C                     MOVE JAGDEV    JDEV    40
     C                     MOVE JAGLAI    JLAI    30
     C                     MOVE BOBIGR    BGRA    30       bobineuse
     C                     MOVE BOBIPO    BPOS    10
     C                     MOVE BOBILA    BLAI    30
     C                     MOVE OFFPR     FFPR    1        offset
     C                     MOVE OFFABC    FFABC   1
     C                     MOVE OFFCOU    FFCOU   10
     C                     MOVE OFFVER    FFVER   1
     C                     MOVE ONDCOL    NDCOL   10       ondulation
     C                     MOVE ONDOND    NDOND   10
     C                     MOVE ONDFAC    NDFAC   10
     C                     MOVE ONDCOU    NDCOU   1
     C                     MOVE COLCOL    OLCOL   10       c/collage
     C                     MOVE COLON     OLOND   10
     C                     MOVE COLCOU    OLCOU   1
     C                     MOVE COMCOL    OMCOL   10       cmplexage
     C                     MOVE COMCLL    OMCLL   2
     C                     MOVE COMIMP    OMIMP   1
     C                     MOVE COMCOU    OMCOU   1
     C                     MOVE TYPABC    YPABC   1        typo
     C                     MOVE TYPCOU    YPCOU   10
     C                     MOVE SPOND     POND    10       autoplatines
     C                     MOVE SPCC      PCC     10
     C                     MOVE SPDEC     PDEC    1
     C                     MOVE SPGA      PGA     2
     C                     MOVE KEASY     YSAEK   1
     C                     Z-ADDJUOND     UOND    10       jurines
     C                     Z-ADDJUCC      UCC     10
     C                     MOVE JUDEC     UDEC    1
     C                     Z-ADDDECOND    ECOND   10       dec.annexes
     C                     Z-ADDDECCC     ECCC    10
     C                     MOVE DCORTI    CORTI   1        decorticage
     C                     Z-ADDDCOOND    COOND   10
     C                     Z-ADDDCOCC     COCC    10
     C                     MOVE ASSCOD    SSCOD   20       plieuses
     C                     Z-ADDASSOND    SSOND   10
     C                     Z-ADDASSCC     SSCC    10
     C                     MOVE ASSDIF    SSDIF   1
     C                     MOVE ASSJUM    SSJUM   1
     C                     MOVE ERTCOD    RTCOD   20       poignees
     C                     MOVE FENGAI    ENGAI   40
     C                     MOVE CTRTYP    TRTYP   1        contrôle/tri
     C                     MOVE DORNAT    £ORNAT  1        dorure
     C                     MOVE DORDIF    £ORDIF  1
     C                     Z-ADDDORPOS    £ORPOS  30
     C                     MOVE OEICAD    £EICAD  3        Oeillet
     C                     Z-ADDOEINBO    £EINBO  20
     C                     MOVE OEIMOD    £EIMOD  1
     C                     Z-ADDOEINBA    £EINBA  20
     *
     C           CLEDEC    SETLLCADDEC                   80
     C           DULI32    TAG
     C           CLEDE1    READECADDEC                   80
     C                     MOVE ' '       GPTEST  1
D1  C           *IN80     IFEQ '1'                         * * * * * *
     C           DULI33    TAG                              *
     C                     Z-ADD1         A                 *
     C           *ZEROS    LOKUPERR1,A                   80 *
     C   80                Z-ADD17        ERR1,A            *
     C   80                MOVELZ5A       ERR2,A            *
     C   80                MOVE Z10AA     ERR2,A            *
     C                     MOVE '1'       GPTEST            *
    C                     GOTO FINSTD                      *
F1  C                     END                              *
     *
D1  C           SS        IFEQ '11'                       helio
     C                     MOVELCLEREC    DSHELI
    C           HELPR     CABNEELPR      DULI33
    C           HELABC    CABNEELABC     DULI33
    C           HELCOU    CABNEELCOU     DULI33
    C           HELTS     CABNEELTS      DULI33
    C           HELVER    CABNEELVER     DULI33
     C                     MOVE HELCOU    COULX
     C                     MOVE HELVER    TVERX
F1  C                     END
D1  C           SS        IFEQ '12'                       flexo
     C                     MOVELCLEREC    DSFLEX
    C           FLEPR     CABNELEPR      DULI33
    C           FLEABC    CABNELEABC     DULI33
    C           FLECOU    CABNELECOU     DULI33
    C           FLETS     CABNELETS      DULI33
    C           FLEVER    CABNELEVER     DULI33
     C                     MOVE FLECOU    COULX
     C                     MOVE FLEVER    TVERX
F1  C                     END
D1  C           SS        IFEQ '13'                       coupeuse
     C                     MOVELCLEREC    DSJAGE
D2  C           JAGGRA    IFNE JGRA
     C                     MOVE JAGGRA    JGRA
     C                     MOVE JDEV      JAGDEV
     C                     MOVE JLAI      JAGLAI
     C                     MOVELDSJAGE    CLEREC
     C           CLEDEC    SETLLCADDEC                   80
    C                     GOTO DULI32
F2  C                     END
F1  C                     END
D1  C           SS        IFEQ '14'                       offset
     C                     MOVELCLEREC    DSOFFS
    C           OFFPR     CABNEFFPR      DULI33
    C           OFFABC    CABNEFFABC     DULI33
    C           OFFCOU    CABNEFFCOU     DULI33
    C           OFFVER    CABNEFFVER     DULI33
     C                     MOVE OFFCOU    COULX
     C                     MOVE OFFVER    TVERX
F1  C                     END
D1  C           SS        IFEQ '16'                       DORURE
     C                     MOVELCLEREC    DSDOR
    C           DORNAT    CABNE£ORNAT    DULI33
    C           DORDIF    CABNE£ORDIF    DULI33
F1  C                     END
D1  C           SS        IFEQ '21'                       ondulation
     C                     MOVELCLEREC    DSOND
    C           ONDCOL    CABNENDCOL     DULI33
    C           ONDOND    CABNENDOND     DULI33
    C           ONDFAC    CABNENDFAC     DULI33
    C           ONDCOU    CABNENDCOU     DULI33
F1  C                     END
D1  C           SS        IFEQ '22'                       complexage
    C           NOMAC     ANDNE'09'
     C                     MOVELCLEREC    DSCOMP
    C           COMCOL    CABNEOMCOL     DULI33
    C           COMCLL    CABNEOMCLL     DULI33
    C           COMIMP    CABNEOMIMP     DULI33
    C           COMCOU    CABNEOMCOU     DULI33
F1  C                     END
D1  C           SS        IFEQ '22'                       bobineuse
    C           NOMAC     ANDEQ'09'
     C                     MOVELCLEREC    DSBOBI
D2  C           BOBIGR    IFNE BGRA
     C                     MOVE BOBIGR    BGRA
     C                     MOVE BPOS      BOBIPO
     C                     MOVE BLAI      BOBILA
     C                     MOVELDSBOBI    CLEREC
     C           CLEDEC    SETLLCADDEC                   80
    C                     GOTO DULI32
F2  C                     END
F1  C                     END
D1  C           SS        IFEQ '31'                       c/collage
     C                     MOVELCLEREC    DSCCOL
    C           COLCOL    CABNEOLCOL     DULI33
    C           COLON     CABNEOLOND     DULI33
    C           COLCOU    CABNEOLCOU     DULI33
F1  C                     END
D1  C           SS        IFEQ '41'                       typo
    C           NOMAC     ANDNE'99'
     C                     MOVELCLEREC    DSTYPO
    C           TYPABC    CABNEYPABC     DULI33
    C           TYPCOU    CABNEYPCOU     DULI33
F1  C                     END
D1  C           SS        IFEQ '51'                       autoplatines
    C           NOMAC     ANDNE'99'
     C                     MOVELCLEREC    DSAUTO
    C           SPOND     CABNEPOND      DULI33
    C           SPCC      CABNEPCC       DULI33
    C           SPDEC     CABNEPDEC      DULI33
    C           SPGA      CABNEPGA       DULI32
F1  C                     END
D1  C           SS        IFEQ '51'                       ESAY PRESS
    C           NOMAC     ANDEQ'99'
     C                     MOVELCLEREC    DSEASY
    C           KEASY     CABNEYSAEK     DULI33
     C                     Z-ADD*ZEROS    MOYDEC
     C                     Z-ADD*ZEROS    MOYCAD
     C                     Z-ADD*ZEROS    TPSTOT
    C                     GOTO FINSTD
F1  C                     END
D1  C           SS        IFEQ '52'                       jurines
     C                     MOVELCLEREC    DSJURI
    C           JUOND     CABNEUOND      DULI33
    C           JUCC      CABNEUCC       DULI33
    C           JUDEC     CABNEUDEC      DULI33
F1  C                     END
D1  C           SS        IFEQ '61'                       dec.annexes
     C                     MOVELCLEREC    DSDECA
    C           DECOND    CABNEECOND     DULI33
    C           DECCC     CABNEECCC      DULI33
F1  C                     END
D1  C           SS        IFEQ '70'                       decorticage
    C           SS        OREQ '41'                       retournement
    C           NOMAC     ANDEQ'99'                       piles
     C                     MOVELCLEREC    DSDCOR
    C           DCORTI    CABNECORTI     DULI33
    C           DCOOND    CABNECOOND     DULI33
    C           DCOCC     CABNECOCC      DULI33
F1  C                     END
D1  C           SS        IFEQ '81'                       fenetre
    C           COFEN     ANDEQ22                         BIB
     C                     MOVELCLEREC    DSFEN
    C           FENGAI    CABLTENGAI     DULI32
F1  C                     END
D1  C           SS        IFEQ '81'                       fenetre
    C           COFEN     ANDEQ20                         LANGUETTES
     C                     MOVELCLEREC    DSFEN
    C           FENGAI    CABLTENGAI     DULI32
F1  C                     END
D1  C           SS        IFEQ '82'                       plieuses
     C                     MOVELCLEREC    DSPLIE
    C           ASSCOD    CABNESSCOD     DULI33
    C           ASSOND    CABNESSOND     DULI33
    C           ASSCC     CABNESSCC      DULI33
    C           ASSDIF    CABNESSDIF     DULI33
    C           ASSJUM    CABNESSJUM     DULI33
F1  C                     END
D1  C           SS        IFEQ '83'
D2  C           WWS       IFEQ 28                         Oeillet
     C                     MOVELCLEREC    DSOEI
    C           OEICAD    CABNE£EICAD    DULI33
    C           OEINBO    CABNE£EINBO    DULI33
    C           OEIMOD    CABNE£EIMOD    DULI33
    C           OEINBA    CABNE£EINBA    DULI33
X2  C                     ELSE
     C                     MOVELCLEREC    DSPOIG           poignees
    C           ERTCOD    CABNERTCOD     DULI33
F2  C                     END
F1  C                     END
     *
D1  C           SS        IFEQ '21'
D2  C           FACON     IFEQ 4
    C           ONDUL     ANDNE7
     C           LMINI     MULT 10        LMILI   40
     C           LMILI     DIV  DECL      NBDL    20
     C           1000      DIV  DECH      NBDD    42
     C           NBDL      MULT NBDD      Z62     62
     C           ROCAD     MULT Z62       ROCADD  60
     C                     Z-ADD7         WSS
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D3  C           *IN80     IFEQ '1'
    C           PRO,W     ANDEQ*ZEROS
    C           *IN80     OREQ '0'
D4  C           ONDUL     IFEQ 2
    C           ROCADD    ANDGT35000
     C                     Z-ADD35000     ROCAD
X4  C                     ELSE
D5  C           ONDUL     IFEQ 3
    C           ROCADD    ANDGT25000
     C                     Z-ADD25000     ROCAD
X5  C                     ELSE
     C                     Z-ADDROCADD    ROCAD
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDROCADD    ROCAD
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           SS        IFEQ '90'                       contrôle/tri
     C                     MOVELCLEREC    DSCTRI
    C           CTRTYP    CABNETRTYP     DULI33
F1  C                     END
     *
    C*SI TEMPS REGLAGE OU CADENCE
    C*----------------------------
     C                     MOVE '0'       INRE    1
     C                     MOVE '0'       INRO    1
D1  C           OND2P     IFEQ ' '                        PAS 2 PASSAGES
    C           OND2P     OREQ '*'                        2 PASSAGES
    C           POND2     ANDEQ'*'                        ET 2° PASSAGE
     C                     Z-ADD1         W
     C           WWS       LOKUPTSS,W                    80
D2  C           *IN80     IFEQ '1'
D3  C           ROC,W     IFNE *ZEROS
     C                     MOVE '1'       INRO
     C                     Z-ADDROC,W     ROCAD
     C                     Z-ADD1         CAD1
     C                     Z-ADD1         CAD2
     C                     Z-ADD1         CAD3
     C                     Z-ADD1         CAD4
F3  C                     END
D3  C           RET,W     IFNE *ZEROS
     C                     MOVE '1'       INRE
     C                     Z-ADDRET,W     RETPS
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C           ROCAD     MULT CAD1      CADEN1    H
     C           ROCAD     MULT CAD2      CADEN2    H
     C           ROCAD     MULT CAD3      CADEN3    H
     C           ROCAD     MULT CAD4      CADEN4    H
     C           RODEC     MULT DECH1     RODEC1    H
     C           RODEC     MULT DECH2     RODEC2    H
     C           RODEC     MULT DECH3     RODEC3    H
     C           RODEC     MULT DECH4     RODEC4    H
     *
D1  C           DSGP      IFEQ 'A2'
    C           AMALS     ANDNE0
    C           SS        ANDGE'21'
    C           SS        ANDNE'22'
     C                     SETON                     16
     C           QTENET    MULT AMALS     QTENET
F1  C                     END
     *
D1  C           QTENET    IFGT CADEN1
     C                     Z-ADD1,00      TPS1
     C           CADEN1    MULT RODEC1    DROUL1    H
X1  C                     ELSE
     C           QTENET    DIV  CADEN1    TPS1      H
     C           QTENET    MULT RODEC1    DROUL1    H
D2  C           TPS1      IFEQ *ZEROS                     PETITE QTE
     C                     Z-ADD0,01      TPS1
F2  C                     END
    C                     GOTO DULI35
F1  C                     END
     *
     C           QTENET    SUB  CADEN1    RESTE
D1  C           RESTE     IFGT CADEN2
     C                     Z-ADD1,00      TPS2
     C           CADEN2    MULT RODEC2    DROUL2    H
X1  C                     ELSE
     C           RESTE     DIV  CADEN2    TPS2      H
     C           RESTE     MULT RODEC2    DROUL2    H
    C                     GOTO DULI35
F1  C                     END
     *
     C           RESTE     SUB  CADEN2    RESTE
D1  C           RESTE     IFGT CADEN3
     C                     Z-ADD1,00      TPS3
     C           CADEN3    MULT RODEC3    DROUL3    H
X1  C                     ELSE
     C           RESTE     DIV  CADEN3    TPS3      H
     C           RESTE     MULT RODEC3    DROUL3    H
    C                     GOTO DULI35
F1  C                     END
     *
     C           RESTE     SUB  CADEN3    RESTE
     C           RESTE     DIV  CADEN4    TPS4      H
     C           RESTE     MULT RODEC4    DROUL4    H
     *
     C           DULI35    TAG
     C           TPS1      ADD  TPS2      TPSTOT  62
     C                     ADD  TPS3      TPSTOT
     C                     ADD  TPS4      TPSTOT
     C           DROUL1    ADD  DROUL2    ROULTO
     C                     ADD  DROUL3    ROULTO
     C                     ADD  DROUL4    ROULTO
     C           ROULTO    MULT 0,01      ROULTO    H
     *
     C           QTENET    DIV  TPSTOT    MOYCAD    H
     C           ROULTO    DIV  QTENET    DECRAP    H
     C           DECRAP    MULT 100       MOYDEC    H
D1  C           INRO      IFEQ '1'
     C                     Z-ADDROC,W     MOYCAD
F1  C                     END
D1  C           *IN16     IFEQ '1'
     C           QTENET    DIV  AMALS     QTENET
     C           TPSTOT    DIV  AMALS     TPSTOT
F1  C                     END
     *
     C           FINSTD    TAG
     C/SPACE 1
D1  C           DSGP      IFEQ 'AB'
     C                     MOVE 'V'       GG
D2  C           INRO      IFEQ '1'
    C           INRE      ANDEQ'1'
     C                     MOVE 'C'       GG
F2  C                     END
D2  C           INRO      IFEQ '1'
    C           INRE      ANDEQ'0'
     C                     MOVE 'B'       GG
F2  C                     END
D2  C           INRO      IFEQ '0'
    C           INRE      ANDEQ'1'
     C                     MOVE 'A'       GG
F2  C                     END
     C                     Z-ADDREDEC     WREDEC
     C                     Z-ADDMOYDEC    WOYDEC
     C                     Z-ADDRETPS     WRETPS
     C                     Z-ADDNETPS     WNETPS
     C                     Z-ADDTPSTOT    WTPSTO
     C                     Z-ADDMOYCAD    WMOYCA
     C                     Z-ADDREEFF     WREEFF
     C                     Z-ADDNEEFF     WNEEFF
     C                     Z-ADDROEFF     WROEFF
     C                     WRITEOBJCASF1
F1  C                     END
     C/SPACE 1
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * valorisation des temps machine et m.o. des dechets .
     * ----------------------------------------------------- *
    C           VALORI    BEGSR
     *
     C                     SETOF                     48
     C           DULI36    TAG
     C           CLEHOR    CHAINCOUHOR               80
     C                     MOVE ' '       GPTEST  1         * * * * * *
     C                     MOVELTYPE      S1      3 P       *
     C                     MOVE USFAB     S1                *
     C                     MOVELSECT      S2      3         *
     C                     MOVE SSECT     S2                *
     C                     MOVE S2        S3      4         *
     C                     MOVELS1        S4      7         *
     C                     MOVE S3        S4                *
     C                     MOVE NOMAC     S1        P       *
     C                     MOVELS4        S5     10         *
     C                     MOVE S1        S5                *
D1  C           *IN80     IFEQ '1'                         * * * * * *
     C                     Z-ADD1         A                 *
     C           *ZEROS    LOKUPERR1,A                   80 *
     C   80                Z-ADD21        ERR1,A            *
     C   80                MOVE S5        ERR2,A            *
     C                     MOVE '1'       GPTEST            *
    C                     GOTO FINVAL                      *
F1  C                     END                              *
     * GUY 16/01/2013 PASSAGE CDI POUR DEVANA
D1  C           DSGPS     IFEQ 'CI'
     C                     Z-ADD0         AMORT
     C                     MULT 0,50      ENTR
     C                     Z-ADD0         STRUCT
     C                     MULT 0,80      MOHOR
     *                    ENERGIE 100%
     C           ENTR      ADD  ENERG     MACHO
     C                     ADD  AMORT     MACHO
     C                     ADD  STRUCT    MACHO
F1  C                     END
     * POUR IMPRESSION
     * PONDERATION COUTS HORAIRES
     *
D1  C           SECT      IFEQ '1'
    C           SSECT     ANDEQ'1'
    C           SECT      OREQ '1'
    C           SSECT     ANDEQ'2'
D2  C           COLO,I    IFEQ *ZEROS
    C           COLO,I    OREQ *BLANK
     C                     Z-ADD1         NG      10
D3  C           SSECT     IFEQ '1'                        VERNIS P SUR
    C           VERA,I    ANDEQ'P'                        HELIO
     C                     ADD  1         NG
F3  C                     END
X2  C                     ELSE
D3  C           VERA,I    IFEQ 'S'
    C           VERA,I    OREQ 'G'
    C           VERA,I    OREQ 'A'
    C           VERA,I    OREQ 'F'
    C           VERA,I    OREQ 'R'
    C           VERA,I    OREQ 'U'
    C           VERA,I    OREQ 'D'
    C           VERA,I    OREQ 'C'
     C                     MOVE COLO,I    NG
     C                     ADD  1         NG
F3  C                     END
D3  C           VERA,I    IFEQ 'B'
    C           VERA,I    OREQ 'H'
    C           VERA,I    OREQ 'L'
     C                     MOVE COLO,I    NG
     C                     ADD  2         NG
F3  C                     END
D3  C           VERA,I    IFEQ 'E'
    C           VERA,I    OREQ 'I'
     C                     MOVE COLO,I    NG
     C                     ADD  3         NG
F3  C                     END
D3  C           VERA,I    IFEQ ' '
     C                     MOVE COLO,I    NG
F3  C                     END
F2  C                     END
     C                     MOVE *BLANKS   DECMAC
     C                     MOVELNG        DECMAC
     C           CLEPCM    CHAINPONDCM               80
D2  C           *IN,80    IFEQ '0'
     C           TXPAMO    DIV  100       TXPAM   54
     C           TXPENE    DIV  100       TXPEN   54
     C           TXPENT    DIV  100       TXPE    54
     C           TXPSTR    DIV  100       TXPST   54
     C           AMORT     MULT TXPAM     AMORT     H
     C           ENTR      MULT TXPE      ENTR      H
     C           ENERG     MULT TXPEN     ENERG     H
     C           STRUCT    MULT TXPST     STRUCT    H
     C           ENTR      ADD  ENERG     MACHO
     C                     ADD  AMORT     MACHO
     C                     ADD  STRUCT    MACHO
F2  C                     END
F1  C                     END
     *
D1  C           SS        IFEQ '31'
D2  C           CCOL      IFEQ 5
     C           AMORT     MULT 0,776     AMORT
     C           ENTR      MULT 0,454     ENTR
     C           ENERG     MULT 0,454     ENERG
     C           STRUCT    MULT 0,726     STRUCT
     C           ENTR      ADD  ENERG     MACHO
     C                     ADD  AMORT     MACHO
     C                     ADD  STRUCT    MACHO
F2  C                     END
F1  C                     END
     *
D1  C           SS        IFEQ '22'
D2  C           IMPEXT    IFEQ 3
    C           IMPINT    OREQ 3
     C           AMORT     MULT 1,05      AMORT
     C           ENTR      MULT 1,05      ENTR
     C           ENERG     MULT 1,05      ENERG
     C           STRUCT    MULT 1,05      STRUCT
     C           ENTR      ADD  ENERG     MACHO
     C                     ADD  AMORT     MACHO
     C                     ADD  STRUCT    MACHO
F2  C                     END
F1  C                     END
     *
D1  C           SS        IFEQ '21'
D2  C           POND2     IFEQ '*'
     C           AMORT     MULT 0,25      AMORT
     C           ENTR      MULT 0,25      ENTR
     C           ENERG     MULT 0,25      ENERG
     C           STRUCT    MULT 0,25      STRUCT
     C           ENTR      ADD  ENERG     MACHO
     C                     ADD  AMORT     MACHO
     C                     ADD  STRUCT    MACHO
F2  C                     END
F1  C                     END
     *
     * SDB 0302588 - GJ LE 3/10/2003
D1  C           CDE       IFEQ 1
    C           USINE     ANDEQ3
    C           SS        ANDEQ'21'
D2  C           NOMAC     IFEQ '03'
    C           NOMAC     OREQ '48'
     C                     SUB  AMORT     MACHO
F2  C                     END
F1  C                     END
     *
     C           RETPS     MULT REEFF     TPSREG  72
     C           NETPS     MULT NEEFF     TPSNET  72
     C           TPSTOT    MULT ROEFF     TPSROU  72
     C           RETPS     MULT MACHO     MACREG  70H
     C           NETPS     MULT MACHO     MACNET  70H
     C           TPSREG    MULT MOHOR     MOREG   70H
     C           TPSNET    MULT MOHOR     MONET   70H
     *
     C           TPSTOT    MULT MACHO     MACROU  70H
     C           TPSROU    MULT MOHOR     MOROU   70H
     C           MACREG    ADD  MOREG     COUREG  70
     C           MACNET    ADD  MONET     COUNET  70
     C           MACROU    ADD  MOROU     COUROU  70
     C           AMORT     MULT RETPS     REGAMT  70H
     C           AMORT     MULT NETPS     NETAMT  70H
     C           AMORT     MULT TPSTOT    ROUAMT  70H
     C                     Z-ADDCOUREG    REGDIR  70
     C                     Z-ADDCOUNET    NETDIR  70
     C                     Z-ADDCOUROU    ROUDIR  70
     *
     C                     Z-ADD1         MULTI
D1  C           SS        IFEQ '22'                       CXH
D2  C           *IN72     IFEQ '1'
    C           *IN73     OREQ '1'
D3  C           *IN39     IFEQ '1'
     C           1         ADD  NBREN     MULTI
X3  C                     ELSE
D4  C           NBREN     IFNE *ZEROS
     C                     Z-ADDNBREN     MULTI
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     Z-ADDNBFAB     MULTI   20
F2  C                     END
X1  C                     ELSE
D2  C           SS        IFEQ '16'                       DOREUSE
D3  C           DORNEU    IFEQ '*'
     C                     Z-ADDNBFAB     MULTI   20
X3  C                     ELSE
D4  C           QTPRE     IFEQ *ZEROS
     C                     Z-ADDNBREN     MULTI
X4  C                     ELSE
     C           NBREN     ADD  1         MULTI
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           SECT      IFNE '1'
    C           *IN68     OREQ '1'                        COUPEUSE
     C                     Z-ADDNBFAB     MULTI   20
X3  C                     ELSE
D4  C           *IN31     IFEQ '1'                        OFFSET APRES
     C                     Z-ADDNBFAB     MULTI   20
X4  C                     ELSE
D5  C           *IN39     IFEQ '1'
    C           *IN01     ANDEQ'1'
    C           *IN53     OREQ '1'
    C           *IN38     OREQ '1'
    C           *IN39     ANDEQ'0'
     C                     Z-ADDNBREN     MULTI
X5  C                     ELSE
     C                     Z-ADD1         MULTI
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           SS        IFEQ '14'
    C           NOMAC     ANDEQ'07'
     C           COUNET    ADD  COUREG    FIXST   70
     C                     MULT 1,52      FIXST     H
     C                     DIV  1,2       FIXST     H
     C           COUROU    MULT 1,17      VARST   70H
     C                     DIV  1,2       VARST
     C                     MULT MULTI     FIXST
     C                     MULT MULTI     VARST
    C                     GOTO DULICX
F1  C                     END
     * <---PAGE-3BTQ>
     C           RETPS     MULT MULTI     TRETPS  72
     C           NETPS     MULT MULTI     TNETPS  72
     C           TPSTOT    MULT MULTI     TTPSTO  72
     C           TPSREG    MULT MULTI     TTPSRE  72
     C           TPSNET    MULT MULTI     TTPSNE  72
     C           TPSROU    MULT MULTI     TTPSRO  72
     C           MORTS     DIV  100       PMOR    54
     C                     ADD  1         PMOR
     C           MACHO     MULT PMOR      MORMAC  62
     C                     SUB  MACHO     MORMAC
     C           MOHOR     MULT PMOR      MORMO   62
     C                     SUB  MOHOR     MORMO
     C           AMORT     MULT TRETPS    REAMT   60
     C           ENTR      MULT TRETPS    REENTR  60
     C           ENERG     MULT TRETPS    REENER  60
     C           STRUCT    MULT TRETPS    RESTRU  60
     C           MOHOR     MULT TTPSRE    REMO    60
     C           MORMAC    MULT TRETPS    MOR1    60
     C           MORMO     MULT TTPSRE    MOR2    60
     C           MOR1      ADD  MOR2      REMOR   60
     C           AMORT     MULT TNETPS    NEAMT   60
     C           ENTR      MULT TNETPS    NEENTR  60
     C           ENERG     MULT TNETPS    NEENER  60
     C           STRUCT    MULT TNETPS    NESTRU  60
     C           MOHOR     MULT TTPSNE    NEMO    60
     C           MORMAC    MULT TNETPS    MOR1    60
     C           MORMO     MULT TTPSNE    MOR2    60
     C           MOR1      ADD  MOR2      NEMOR   60
     C           AMORT     MULT TTPSTO    ROAMT   60
     C           ENTR      MULT TTPSTO    ROENTR  60
     C           ENERG     MULT TTPSTO    ROENER  60
     C           STRUCT    MULT TTPSTO    ROSTRU  60
     C           MOHOR     MULT TTPSRO    ROMO    60
     C           MORMAC    MULT TTPSTO    MOR1    60
     C           MORMO     MULT TTPSRO    MOR2    60
     C           MOR1      ADD  MOR2      ROMOR   60
    C*
D1  C           SECT      IFEQ '1'
    C           *IN68     ANDEQ'0'
    C           SS        OREQ '22'
    C           INN72     ANDEQ1
    C           SS        OREQ '22'
    C           INN73     ANDEQ1
D2  C           SUIMP     IFLE 3
     C                     ADD  REAMT     EXREAM
     C                     ADD  REENTR    EXRENT
     C                     ADD  REENER    EXRENE
     C                     ADD  RESTRU    EXREST
     C                     ADD  REMO      EXREMO
     C                     ADD  REMOR     EXREMR
     C                     ADD  NEAMT     EXNEAM
     C                     ADD  NEENTR    EXNENT
     C                     ADD  NEENER    EXNENE
     C                     ADD  NESTRU    EXNEST
     C                     ADD  NEMO      EXNEMO
     C                     ADD  NEMOR     EXNEMR
     C                     ADD  ROAMT     EXROAM
     C                     ADD  ROENTR    EXRONT
     C                     ADD  ROENER    EXRONE
     C                     ADD  ROSTRU    EXROST
     C                     ADD  ROMO      EXROMO
     C                     ADD  ROMOR     EXROMR
X2  C                     ELSE
     C                     ADD  REAMT     INREAM
     C                     ADD  REENTR    INRENT
     C                     ADD  REENER    INRENE
     C                     ADD  RESTRU    INREST
     C                     ADD  REMO      INREMO
     C                     ADD  REMOR     INREMR
     C                     ADD  NEAMT     INNEAM
     C                     ADD  NEENTR    INNENT
     C                     ADD  NEENER    INNENE
     C                     ADD  NESTRU    INNEST
     C                     ADD  NEMO      INNEMO
     C                     ADD  NEMOR     INNEMR
     C                     ADD  ROAMT     INROAM
     C                     ADD  ROENTR    INRONT
     C                     ADD  ROENER    INRONE
     C                     ADD  ROSTRU    INROST
     C                     ADD  ROMO      INROMO
     C                     ADD  ROMOR     INROMR
F2  C                     END
X1  C                     ELSE
     C                     ADD  REAMT     FAREAM
     C                     ADD  REENTR    FARENT
     C                     ADD  REENER    FARENE
     C                     ADD  RESTRU    FAREST
     C                     ADD  REMO      FAREMO
     C                     ADD  REMOR     FAREMR
     C                     ADD  NEAMT     FANEAM
     C                     ADD  NEENTR    FANENT
     C                     ADD  NEENER    FANENE
     C                     ADD  NESTRU    FANEST
     C                     ADD  NEMO      FANEMO
     C                     ADD  NEMOR     FANEMR
     C                     ADD  ROAMT     FAROAM
     C                     ADD  ROENTR    FAROET
     C                     ADD  ROENER    FAROEN
     C                     ADD  ROSTRU    FAROST
     C                     ADD  ROMO      FAROMO
     C                     ADD  ROMOR     FAROMR
F1  C                     END
     * <---PAGE-4--->
     C           DULICX    TAG
    C*
     C           COUREG    MULT MULTI     COUREG
     C           COUNET    MULT MULTI     COUNET
     C           COUROU    MULT MULTI     COUROU
D1  C           SS        IFEQ '22'
    C           NOMAC     ANDEQ'09'
     C                     ADD  FIXST     OTFIXF
     C                     ADD  VARST     OTVARF
F1  C                     END
D1  C           SECT      IFEQ '1'
    C           SSECT     ANDEQ'4'
D2  C           USFAB     IFEQ 5
    C           NOMAC     OREQ '07'
D3  C           SUIMP     IFLE 3
     C                     ADD  FIXST     OTFIXE
     C                     ADD  VARST     OTVARE
X3  C                     ELSE
     C                     ADD  FIXST     OTFIIN
     C                     ADD  VARST     OTVARI
F3  C                     END
F2  C                     END
F1  C                     END
     C           REGDIR    MULT MULTI     REGDIR
     C           NETDIR    MULT MULTI     NETDIR
     C           ROUDIR    MULT MULTI     ROUDIR
     C           REGAMT    MULT MULTI     REGAMT
     C           NETAMT    MULT MULTI     NETAMT
     C           ROUAMT    MULT MULTI     ROUAMT
     C           COUREG    MULT KREG      COUREG    H
     C           COUNET    MULT KREG      COUNET    H
     C           COUROU    MULT KROUL     COUROU    H
     * <---PAGE-5--->
     C           REGAMT    MULT KREG      REGAMT    H
     C           NETAMT    MULT KREG      NETAMT    H
     C           ROUAMT    MULT KROUL     ROUAMT    H
     C                     ADD  COUREG    TOLREG  70
     C                     ADD  COUNET    TOLREG
     C                     ADD  COUROU    TOLROU  70
    C      01             GOTO OK3501
     C                     ADD  REGDIR    TEGDIR  70
     C                     ADD  NETDIR    TEGDIR
     C                     ADD  ROUDIR    TOUDIR  70
     C                     ADD  REGAMT    TOTAMT  70
     C                     ADD  NETAMT    TOTAMT
     C                     ADD  ROUAMT    TOTAMT
     C           OK3501    TAG
    C*
D1  C           SECT      IFEQ '1'
    C           *IN68     ANDEQ'0'
    C           SS        OREQ '22'
    C           INN73     ANDEQ1
    C           SS        OREQ '22'
    C           INN72     ANDEQ1
D2  C           SUIMP     IFLE 3
     C                     ADD  REGDIR    FIXEXT  70
     C                     ADD  NETDIR    FIXEXT
     C                     ADD  ROUDIR    VAREXT  70
X2  C                     ELSE
     C                     ADD  REGDIR    FIXINT  70
     C                     ADD  NETDIR    FIXINT
     C                     ADD  ROUDIR    VARINT  70
F2  C                     END
X1  C                     ELSE
     C                     ADD  REGDIR    FIXFAC  70
     C                     ADD  NETDIR    FIXFAC
     C                     ADD  ROUDIR    VARFAC  70
F1  C                     END
    C*
D1  C           *IN48     IFEQ '0'
    C           SECT      ANDEQ'1'
    C           SSECT     ANDEQ'4'
D2  C           USFAB     IFEQ 2
    C           NOMAC     ANDEQ'01'
    C           USFAB     OREQ 7
    C           NOMAC     ANDNE'02'
    C           USFAB     OREQ 4
    C           NOMAC     ANDEQ'02'
D3  C           OFFVER    IFEQ 'U'
    C           ENC       OREQ 'U'
     C                     SETON                     48
     C                     MOVE NOMAC     NOMACS
     C                     MOVE '19'      NOMAC
    C                     GOTO DULI36
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           *IN48     IFEQ '0'
    C           SECT      ANDEQ'8'
    C           SSECT     ANDEQ'2'
    C           COAS1     ANDEQ44
     C                     SETON                     48
     C                     MOVE NOMAC     NOMACS
     C                     MOVE '44'      NOMAC
    C                     GOTO DULI36
F1  C                     END
     *
D1  C           *IN48     IFEQ '1'
     C                     MOVE NOMACS    NOMAC
F1  C                     END
     * <---PAGE-6--->
    C   68                GOTO VALOE2
    C           SECT      CABNE'1'       VALOE2
    C           DORNEU    CABEQ'*'       VALOE2           DORURE SUR NEUT
     C                     Z-ADD*ZEROS    RMAEXD
     C                     Z-ADD*ZEROS    RMAIND
     C           SURIM     MULT MULTI     TOREM2  60
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C           TOREM2    MULT DIRINT    RMADIR    H
     C           TOREM2    MULT VALINT    RMATCE    H
     C           TOREM2    MULT DIRINT    RMAIND  60H
D2  C           NIMPI1    IFNE *BLANKS
     C           TOREM2    MULT VALINT    RMAIND    H
F2  C                     END
F1  C                     END
D1  C           *IN97     IFEQ '1'                        EXTERIEUR
    C           *IN87     OREQ '1'
     C           TOREM2    MULT DIREXT    RMADIR    H
     C           TOREM2    MULT VALEXT    RMATCE    H
     C           TOREM2    MULT DIREXT    RMAEXD  60H
D2  C           NIMPE1    IFNE *BLANKS
     C           TOREM2    MULT VALEXT    RMAEXD    H
F2  C                     END
F1  C                     END
     C                     ADD  RMAEXD    RMAEX   60
     C                     ADD  RMAIND    RMAIN   60
    C                     GOTO VALOI
     * <---PAGE-7--->
     C           VALOE2    TAG
D1  C           SS        IFEQ '22'
    C           CCOL      ANDNE4
    C           CCOL      ANDNE7
    C           PASPEL    ANDEQ' '
D2  C           *IN75     IFEQ '1'
     C                     Z-ADDXCE       Y       10
X2  C                     ELSE
D3  C           *IN74     IFEQ '1'
    C           *IN70     OREQ '1'
    C           *IN73     OREQ '1'
     C                     Z-ADDXCI       Y
X3  C                     ELSE
     C                     Z-ADDXCE       Y
F3  C                     END
F2  C                     END
     C           REGM2     MULT MULTI     TOREM2
     C           TOREM2    MULT TACO,Y    RMADIR
     C           TOREM2    MULT TAVA,Y    RMATCE
D2  C           INN73     IFEQ 1
     C           TOREM2    MULT TACO,Y    RMAIND
     C                     ADD  RMAIND    RMAIN
X2  C                     ELSE
D3  C           INN72     IFEQ 1
     C           TOREM2    MULT TACO,Y    RMAEXD
     C                     ADD  RMAEXD    RMAEX
X3  C                     ELSE
     C           TOREM2    MULT TACO,Y    RMAFAD
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C           REGM2     MULT MULTI     TOREM2
    C           SECT      CABNE'3'       VALOR1
    C           CCOL      CABNE1         VALOR1
    C           APPEX     CABEQ' '       VALOR2
    C           VALINT    CABEQ0         VALOR3
    C           COUPR     CABNE'R'       VALOR3
     C           TOREM2    MULT 0,8       TOREM3  60
     C           TOREM2    MULT 0,2       TOREM4  60
    C                     GOTO VALOR5
     C           VALOR3    TAG
     C           TOREM2    MULT 0,5       TOREM3
     C           TOREM2    MULT 0,5       TOREM4
     C           VALOR5    TAG
     C           MATCEN    SUB  VALEXT    VALSF   62
    C                     GOTO VALORG
     C           VALOR2    TAG
    C           VALEXT    CABEQ0         VALOR4
    C           COUPR     CABNE'R'       VALOR4
     C           TOREM2    MULT 0,8       TOREM3
     C           TOREM2    MULT 0,2       TOREM4
    C                     GOTO VALOR6
     C           VALOR4    TAG
     C           TOREM2    MULT 0,5       TOREM3
     C           TOREM2    MULT 0,5       TOREM4
     C           VALOR6    TAG
     C           MATCEN    SUB  VALINT    VALSF   62
    C                     GOTO VALORH
     C           VALOR1    TAG
     C           TOREM2    MULT DIRMAT    RMADIR 100
     C           TOREM2    MULT MATCEN    RMATCE 100
     C           TOREM2    MULT DIRMAT    RMAFAD  60
    C                     GOTO VALOI
     * <---PAGE-8--->
     C           VALORG    TAG
     C           VALEXT    DIV  KMAT      DIRCC   62
     C                     Z-ADDVALEXT    VALCC   62
    C                     GOTO VALOR7
     C           VALORH    TAG
     C           VALINT    DIV  KMAT      DIRCC
     C                     Z-ADDVALINT    VALCC
     C           VALOR7    TAG
     C           VALSF     DIV  KMAT      DIRSF   62H
     C           DIRSF     MULT TOREM3    RCCD1   72
     C           VALSF     MULT TOREM3    RCCV1   72
     C           DIRCC     MULT TOREM4    RCCD2   72
     C           VALCC     MULT TOREM4    RCCV2   72
     C           RCCD1     ADD  RCCD2     RMADIR
     C           RCCV1     ADD  RCCV2     RMATCE
     C           RCCV1     ADD  RCCV2     RMAFAD
F1  C                     END
     * <---PAGE-9--->
     C           VALOI     TAG
     C                     MULT 0,01      RMATCE    H
     C                     MULT 0,01      RMADIR    H
D1  C           SECT      IFEQ '5'
     C           FORDEC    MULT MULTI     MATDEC
     C                     ADD  MATDEC    RMADIR
     C           MATDEC    MULT 100       MATDEZ  60
     C                     ADD  MATDEZ    RMAFAD
     C           MATDEC    MULT KMAT      MATDEZ  60
     C                     ADD  MATDEZ    RMATCE
F1  C                     END
    C*
D1  C           SECT      IFEQ '5'
    C           NOMAC     ANDEQ'80'
    C           SECT      OREQ '5'
    C           NOMAC     ANDEQ'99'
X1  C                     ELSE
     C                     ADD  RMAFAD    RMAFA   60
F1  C                     END
     C                     Z-ADD*ZEROS    RMAFAD
    C*
     C                     ADD  RMATCE    TREGMA
     C  N01                ADD  RMADIR    RM2DIR  60
    C           FINVAL    ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * recherche des passages OFFSET
     * ----------------------------------------------------- *
    C           SPOFP     BEGSR
     C                     MOVE *BLANK    PTTNE
D1  C           *IN65     IFEQ '1'                        PETIT NEUVILLE
     C                     MOVE '*'       PTTNE   1
F1  C                     END
     C                     CLOSEOFPAS
     C                     MOVELOVR,1     OVRDBF 40
     C                     Z-ADD40        GPLONG 155
     C                     CALL 'QCAEXEC'
     C                     PARM           OVRDBF
     C                     PARM           GPLONG
     * PRU
D1  C           CDE       IFEQ 0
D2  C           *IN62     IFEQ '1'
     C                     MOVELOVR,4     OVRDBF
F2  C                     END
D2  C           *IN64     IFEQ '1'
     C                     MOVELOVR,5     OVRDBF
F2  C                     END
D2  C           *IN65     IFEQ '1'
     C                     MOVELOVR,6     OVRDBF
F2  C                     END
D2  C           *IN66     IFEQ '1'
     C                     MOVELOVR,3     OVRDBF
F2  C                     END
D2  C           *IN67     IFEQ '1'
     C                     MOVELOVR,10    OVRDBF
F2  C                     END
D2  C           *IN58     IFEQ '1'
     C                     MOVELOVR,11    OVRDBF
F2  C                     END
D2  C           *IN59     IFEQ '1'
     C                     MOVELOVR,12    OVRDBF
F2  C                     END
X1  C                     ELSE
     * COMMERCIAL
     C           CLESTA    CHAINCLISTAL1             80
D2  C           *IN80     IFEQ '0'
     C                     Z-ADDINDUS     KINDUS
F2  C                     END
D2  C           *IN62     IFEQ '1'
     C                     MOVELOVR,7     OVRDBF
F2  C                     END
D2  C           *IN64     IFEQ '1'
     C                     MOVELOVR,8     OVRDBF
F2  C                     END
D2  C           *IN65     IFEQ '1'
     C                     MOVELOVR,9     OVRDBF
F2  C                     END
D2  C           *IN61     IFEQ '1'
     C                     MOVELOVR,2     OVRDBF
F2  C                     END
D2  C           *IN60     IFEQ '1'
     C                     MOVELOVR,13    OVRDBF
F2  C                     END
F1  C                     END
     C                     Z-ADD40        GPLONG
     C                     CALL 'QCAEXEC'
     C                     PARM           OVRDBF
     C                     PARM           GPLONG
     C                     OPEN OFPAS
    C*
    C*          CLEPAS    SETLLOFPAS
     C           CLEPAS    CHAINOFPAS                80
     C                     MOVELENC       Z2A     2
     C                     MOVE VER       Z2A
     C                     MOVELZ2A       Z4A     4
     C                     MOVE COU       Z4A
     C                     MOVELZ4A       Z11A   11
     C                     MOVE KINDUS    Z11A
     C   80                Z-ADD0         KINDUS
     C   80      CLEPAS    CHAINOFPAS                80
    C*
    C*          CLEPAX    REDPEOFPAS                    80
     C                     MOVE ' '       GPTEST  1
D1  C           *IN80     IFEQ '1'                         * * * * * *
     C                     Z-ADD1         A                 *
     C           *ZEROS    LOKUPERR1,A                   80 *
     C   80                Z-ADD26        ERR1,A            *
     C   80                MOVE Z11A      ERR2,A            *
     C                     MOVE '1'       GPTEST            *
    C                     GOTO FSPOFP                      *
F1  C                     END                              *
     *
     C                     EXSR SPOOL1
     *
    C           FSPOFP    ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * chargement des resultats de roulage .
     * ----------------------------------------------------- *
    C           RESULT    BEGSR
    C*          ---------------
D1  C           *IN53     IFEQ '0'
     C                     ADD  1         X       20
     C                     MOVELMOYDEC    RO,X
     C                     MOVE TREGMA    RMA,X
     C                     MOVE TOLREG    REG,X
     C           QTFA      MULT NBFAB     QTROL   82
D2  C           QTROL     IFNE *ZEROS
     C           TOLROU    DIV  QTROL     ROULUV  72H
X2  C                     ELSE
     C                     Z-ADD*ZEROS    ROULUV
F2  C                     END
     C                     MOVE ROULUV    ROU,X
D2  C           PREG      IFNE 1
     C                     Z-ADDPREG      REGK
F2  C                     END
     C           RETPS     ADD  NETPS     RNTPS
     C                     WRITEDEVRESF
F1  C                     END
    C*
     C                     EXSR BLRESU
     *
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * ponderation impression .
     * ----------------------------------------------------- *
    C           PONDI1    BEGSR
     C/SPACE 1
D1  C           *IN86     IFEQ '1'                        REPIQUAGE
     C                     Z-ADD4         WSS              INTERIEUR
     C                     Z-ADD4         WWS
F1  C                     END
D1  C           *IN96     IFEQ '1'                        PRINCIPAL
    C           *IN86     ANDEQ'0'
     C                     Z-ADD3         WSS              INTERIEUR
     C                     Z-ADD3         WWS
F1  C                     END
     C/SPACE 1
D1  C           *IN87     IFEQ '1'                        REPIQUAGE
     C                     Z-ADD2         WSS              EXTERIEUR
     C                     Z-ADD2         WWS
F1  C                     END
D1  C           *IN97     IFEQ '1'                        PRINCIPAL
    C           *IN87     ANDEQ'0'
     C                     Z-ADD1         WSS              EXTERIEUR
     C                     Z-ADD1         WWS
F1  C                     END
    C                     ENDSR
     C/SPACE 1
    C           PONDIM    BEGSR
     C                     EXSR KOEFF
D1  C           PDE,W     IFNE *ZEROS
D2  C           *IN51     IFEQ '1'
     C                     Z-ADD0         MOYDEC
X2  C                     ELSE
     C                     SETON                     51
F2  C                     END
F1  C                     END
     C/SPACE 1
    C                     ENDSR
     C/EJECT
     *********************************************
     * cas particuliers (impression/faconnage)  *********************
     *********************************************
     * GP.11/7/1984 .
    C           CAPART    BEGSR
     C                     Z-ADD0         TRETPR  32
     C                     Z-ADD0         TREDER  32
     C                     Z-ADD0         TREFF   20
     C                     Z-ADD0         TNETPR  32
     C                     Z-ADD0         TNEFF   20
     C                     Z-ADD0         TROTPR  32
     C                     Z-ADD0         TRODER  32
     C                     Z-ADD0         TROEFF  20
     C                     Z-ADD0         TRETPV  52
     C                     Z-ADD0         TREDEV  50
     C                     Z-ADD0         TNETPV  52
     C                     Z-ADD0         DECR
     C                     Z-ADD0         TPSRE
     C                     Z-ADD0         TPSNE
     C                     Z-ADD0         TOTTPS
     C                     Z-ADD0         CADMOY
     C                     Z-ADD0         MAXDRE
     C                     Z-ADD0         MAXDRO
     C                     Z-ADD0         MAXTRE
     C                     Z-ADD0         MAXTRO
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     Z-ADD0         AMREG
     C                     Z-ADD0         AMNET
     C/SPACE 1
D1  C           SECT      IFEQ '8'
    C           SSECT     ANDEQ'2'
    C           JUMEL     ANDEQ'J'
    C           SECT      OREQ '8'
    C           SSECT     ANDEQ'1'
    C           JUMEL     ANDEQ'J'
    C           SECT      OREQ '7'
    C                     GOTO FINCAS
F1  C                     END
     C/SPACE 1
     C                     MOVELUSFAB     Z2A     2
     C                     MOVE SECT      Z2A
     C                     MOVELSSECT     Z3A
     C                     MOVE NOMAC     Z3A
     C                     MOVELZ2A       Z5A     5
     C                     MOVE Z3A       Z5A
     C           CLECAS    SETLLCASPAR                   80
     C                     MOVE ' '       GPTEST  1
D1  C           *IN80     IFEQ '0'                         * * * * * *
    C                     GOTO FINCAS                      *
F1  C                     END                              *
     C                     SETON                     82
     C/SPACE 1
     * <---PAGE-P2--->
D1  C           SECT      IFEQ '1'
D2  C           DEVIMP    IFNE *ZEROS
     C                     Z-ADDDEVIMP    DEVIMX  40
X2  C                     ELSE
     C                     Z-ADDONDH      DEVIMX
F2  C                     END
D2  C           CCOL      IFEQ 6
    C           ICEI3     ANDEQ'O'
    C           *IN87     ANDEQ'1'
    C           CCOL      OREQ 6
    C           ICEI3     ANDEQ'O'
    C           *IN97     ANDEQ'1'
     C                     Z-ADDONDL      DEVIMX
F2  C                     END
    C           SSECT     CABEQ'1'       CHELIO
    C           SSECT     CABEQ'2'       CFLEXO
    C           SSECT     CABEQ'3'       CJAGEN
    C           SSECT     CABEQ'4'       COFFSE
    C           SSECT     CABEQ'6'       CDORUR
F1  C                     END
D1  C           SECT      IFEQ '2'
    C           SSECT     CABEQ'1'       CONDUL
    C                     GOTO CCOMPL
F1  C                     END
    C           SECT      CABEQ'3'       CCCOL
    C           SECT      CABEQ'4'       CTYPO
D1  C           SECT      IFEQ '5'
    C           SSECT     CABEQ'1'       CDECOU
F1  C                     END
D1  C           SECT      IFEQ '8'
    C           SSECT     CABLT'2'       CFENET
    C           SSECT     CABEQ'2'       CASSEM
F1  C                     END
    C                     GOTO FINCAS
     C/SPACE 1
     * <---PAGE-P3--->  cas particuliers "typo" .
     C           CTYPO     TAG
    C                     GOTO FINCAS
     * <---PAGE-P3--->  cas particuliers "helio" .
     C           CHELIO    TAG
     C                     MOVE 'HELIO '  CASLIB  6             *
     C           DULPB     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX                           *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'PTDEV'
    C           DEVIMX    CABEQ0         DULPB
    C           DEVIMX    CABLTVAL       DULPY
    C           DEVIMX    CABGEVAL       DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDDEV'
    C           DEVIMX    CABGTVAL       DULPY
    C           DEVIMX    CABLEVAL       DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDLAI'
    C           LMINI     CABGTVAL       DULPY
    C           LMINI     CABLEVAL       DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDGRA'
    C           GRAM,S    CABGTVAL       DULPY
    C           GRAM,S    CABLEVAL       DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'HEFOR'
    C           APP,S     CABEQ'F'       DULPY
    C                     GOTO DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'EBARB'
    C           GFRA      CABEQ*BLANKS   DULPB
    C           GFRA      CABNE*BLANKS   DULPY
F1  C                     END
D1  C           TRAPAR    IFEQ 'TYSU1'
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           IMPFA     CABEQ1         DULPY
    C           IMPFA     CABNE1         DULPB
F1  C                     END
     * <---PAGE P5--->
D1  C           TRAPAR    IFEQ 'TYENC'
    C           ENC       CABEQ'I'       DULPY
    C           ENC       CABNE'I'       DULPB
F1  C                     END
D1  C           TRAPAR    IFEQ 'TYSU2'
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           IMPFA     CABNE2         DULPB
    C           IMPFA     CABEQ2         DULPY
F1  C                     END
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'HELIO '  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPX
    C   82                GOTO FINCAS
     C           DULPY     TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPB
     C           DULPX     TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P6--->    cas particuliers "flexo" .
     C           CFLEXO    TAG
     C           DULPK     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPZ                           *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'PTDEV'
    C           DEVIMX    CABEQ0         DULPK
    C           DEVIMX    CABLTVAL       DULPL
    C           DEVIMX    CABGEVAL       DULPK
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDLAI'
D2  C           CCOL      IFEQ 6
    C           ICEI3     ANDEQ'O'
    C           *IN87     ANDEQ'1'
    C           CCOL      OREQ 6
    C           ICEI3     ANDEQ'O'
    C           *IN97     ANDEQ'1'
    C           ONDH      CABGTVAL       DULPL
    C           ONDH      CABLEVAL       DULPK
X2  C                     ELSE
    C           LMINI     CABGTVAL       DULPL
    C           LMINI     CABLEVAL       DULPK
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'PTGRA'
    C           GRAM,S    CABLTVAL       DULPL
    C           GRAM,S    CABGEVAL       DULPK
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDGRA'
    C           GRAM,S    CABGTVAL       DULPL
    C           GRAM,S    CABLEVAL       DULPK
F1  C                     END
D1  C           TRAPAR    IFEQ 'TYSU3'
     C                     MOVE 'FLEXO '  CASLIB  6             *
D2  C           QUAL,S    IFNE '        '
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D3  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPZ                           *
    C   82                GOTO FINCAS                        * * *
F3  C                     END                                  *
    C           IMPFA     CABNE3         DULPK
D3  C           IMPFA     IFEQ 3
    C           GRAM,S    CABLE0350      DULPL
    C           GRAM,S    CABGT0350      DULPK
F3  C                     END
X2  C                     ELSE
    C                     GOTO DULPK
F2  C                     END
F1  C                     END
     * <---PAGE P7--->
D1  C           TRAPAR    IFEQ 'ENCSK'
    C   86      RUV       CABEQ'P'       DULPL
    C  N86 96   UV        CABEQ'P'       DULPL
    C   87      RUV       CABEQ'P'       DULPL
    C  N87 97   UV        CABEQ'P'       DULPL
    C                     GOTO DULPK
F1  C                     END
D1  C           TRAPAR    IFEQ 'ENCO'
    C   86      RUV       CABEQ'E'       DULPL
    C  N86 96   UV        CABEQ'E'       DULPL
    C   87      RUV       CABEQ'E'       DULPL
    C  N87 97   UV        CABEQ'E'       DULPL
    C                     GOTO DULPK
F1  C                     END
     * <---PAGE P8--->
    C*          TRAPAR    IFEQ 'TYVER'
    C*  86      RVER      CABEQ'P'       DULPL
    C* N86 96   TVER      CABEQ'P'       DULPL             SI P = ALIMINTAIRE
    C*  87      RVER      CABEQ'P'       DULPL
    C* N87 97   TVER      CABEQ'P'       DULPL
    C*                    GOTO DULPK
    C*                    END
D1  C           TRAPAR    IFEQ 'GR200'
    C           GRAM,S    CABLTVAL1      DULPK
    C           GRAM,S    CABGTVAL2      DULPK
    C                     GOTO DULPL
F1  C                     END
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'FLEXO '  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPZ
    C   82                GOTO FINCAS
     C           DULPL     TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPK
     C           DULPZ     TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE-P --->  cas particuliers "Jagenberg"
     C           CJAGEN    TAG
     C           DULPW     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPW1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           NOMAC     IFEQ '03'                       COUPEUSE
D2  C           TRAPAR    IFEQ 'POSES'
D3  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
    C           ACOTE     CABNE0         DULPW
     C           ONDL      MULT 2         LAIZT   40
    C           LAIZT     CABGTLALAIZ    DULPW
     C           QTEB      DIV  SBFE      TENETQ  70       nbr.feuilles
    C           TENETQ    CABLE8000      DULPW
    C           GRAOND    CABLT320       DULPW
    C                     GOTO DULPW2
F3  C                     END
    C                     GOTO DULPW
F2  C                     END
    C*
D2  C           TRAPAR    IFEQ 'NITO2'
    C           COTAPE    CABEQ'M'       DULPW
D3  C           NBTAPE    IFEQ 1
    C           CCOL      ANDEQ0
    C           ONDUL     ANDEQ0
    C           NBTAPE    OREQ 2
    C           CCOL      ANDEQ0
    C           ONDUL     ANDEQ0
    C                     GOTO DULPW2
F3  C                     END
    C                     GOTO DULPW
F2  C                     END
    C*
D2  C           TRAPAR    IFEQ 'NITO3'
    C           COTAPE    CABEQ'M'       DULPW
D3  C           NBTAPE    IFGE 3
    C           CCOL      ANDEQ0
    C           ONDUL     ANDEQ0
    C                     GOTO DULPW2
F3  C                     END
    C                     GOTO DULPW
F2  C                     END
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'COUPE'
D2  C           COUPR     IFEQ 'R'
    C                     GOTO DULPW2
F2  C                     END
    C                     GOTO DULPW
F1  C                     END
    C*
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'JAGENB'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPW1
    C   82                GOTO FINCAS
     C           DULPW2    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPW
     C           DULPW1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P9---> cas particuliers "offset"
     C           COFFSE    TAG
     C                     MOVE 'OFFSET'  CASLIB  6             *
     C                     MOVELQUAL,S    QUL
     * Chargement tableau vernis par passage nouvelle OFFSET
D1  C           OTCOEP    IFNE *ZEROS
     C                     MOVE *BLANK    PVR
D2  C           I         IFEQ 1
     C                     MOVEAV1        PVR
F2  C                     END
D2  C           I         IFEQ 2
     C                     MOVEAV2        PVR
F2  C                     END
D2  C           I         IFEQ 3
     C                     MOVEAV3        PVR
F2  C                     END
     C                     MOVE SENSF     TS
     C                     MOVE APLA3B    APLA
     C                     MOVE *BLANK    ENC
     C                     MOVE *BLANK    ENCALI
     C                     MOVE *BLANK    TVER
     C                     MOVE *BLANK    NATE
F1  C                     END
     *
     C           DULPP     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'VERUV'
    C           CTR       CABNE*ZEROS    DULPP
    C           TVER      CABEQ'U'       DULPR
    C           TVER      CABNE'U'       DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'VERNP'
D2  C           OTCOEP    IFNE *ZEROS
    C           PVR,1     CABEQ'P'       DULPR
    C           PVR,2     CABEQ'P'       DULPR
    C                     GOTO DULPP
F2  C                     END
    C           CTR       CABNE*ZEROS    DULPP
    C           TVER      CABEQ'P'       DULPR
    C           TVER      CABNE'P'       DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'VERNR'                    FBU 17/07/2014
D2  C           OTCOEP    IFNE *ZEROS
    C           PVR,1     CABEQ'R'       DULPR
    C           PVR,2     CABEQ'R'       DULPR
    C                     GOTO DULPP
F2  C                     END
    C           CTR       CABNE*ZEROS    DULPP            FBU 17/07/2014
    C           TVER      CABEQ'R'       DULPR            FBU 17/07/2014
    C           TVER      CABNE'R'       DULPP            FBU 17/07/2014
F1  C                     END                             FBU 17/07/2014
D1  C           TRAPAR    IFEQ 'PTGRA'
    C           GRAMK     CABLTVAL       DULPR
    C           GRAMK     CABGEVAL       DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'GD500'
    C           GRAMK     CABLTVAL1      DULPP
    C           GRAMK     CABGTVAL2      DULPP
    C                     GOTO DULPR
F1  C                     END
D1  C           TRAPAR    IFEQ 'GD600'
    C           GRAMK     CABLTVAL1      DULPP
    C           GRAMK     CABGTVAL2      DULPP
    C                     GOTO DULPR
F1  C                     END
D1  C           TRAPAR    IFEQ 'FIBRE'
    C           TS        CABEQ'X'       DULPR
    C           TS        CABNE'X'       DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'APLAT'
    C           APLA      CABNE'A'       DULPP
D2  C           CTR       IFEQ *ZEROS
D3  C           VERA,I    IFEQ *BLANKS
     C                     SETON                     50
    C                     GOTO DULPR
X3  C                     ELSE
    C           I         CABEQ1         DULPR
    C                     GOTO DULPP
F3  C                     END
X2  C                     ELSE
    C           CTR       CABNE1         DULPP
D3  C           CTR       IFEQ 1
    C           *IN50     CABEQ'1'       DULPP
    C           *IN50     CABEQ'0'       DULPR
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'APLCO'
    C           APLA      CABNE'C'       DULPP
D2  C           CTR       IFEQ *ZEROS
D3  C           VERA,I    IFEQ *BLANKS
     C                     SETON                     50
    C                     GOTO DULPR
X3  C                     ELSE
    C           I         CABEQ1         DULPR
    C                     GOTO DULPP
F3  C                     END
X2  C                     ELSE
    C           CTR       CABNE1         DULPP
D3  C           CTR       IFEQ 1
    C           *IN50     CABEQ'1'       DULPP
    C           *IN50     CABEQ'0'       DULPR
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'EXFOR'
     * <---PAGE P10--->
D2  C           FORL      IFLT VAL2
    C           FORH      ANDLTVAL1
    C                     GOTO DULPP
F2  C                     END
D2  C           TS        IFEQ ' '
    C           FORH      CABGEVAL2      DULPR
    C           FORL      CABGEVAL1      DULPR
    C                     GOTO DULPP
X2  C                     ELSE
    C                     GOTO DULPR
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'ENCSK'
    C           ENC       CABEQ'P'       DULPR
    C           ENC       CABNE'P'       DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'ENCAL'
    C           ENCALI    CABEQ'N'       DULPR
    C           ENCALI    CABEQ'O'       DULPR
    C           ENCALI    CABEQ'F'       DULPR
    C           ENCALI    CABEQ'G'       DULPR
    C                     GOTO DULPP
F1  C                     END
D1  C           TRAPAR    IFEQ 'TEINT'
D2  C           OTCOEP    IFNE *ZEROS
    C           NATE1     CABEQ'B'       DULPR
    C           NATE2     CABEQ'B'       DULPR
    C                     GOTO DULPP
F2  C                     END
    C           NATE      CABEQ'B'       DULPR
    C           NATE      CABNE'B'       DULPP
F1  C                     END
     * <---PAGE P11--->
D1  C           TRAPAR    IFEQ 'GLPL'
D2  C           FORL      IFLT FORH
     C           FORL      DIV  FORH      DISP    21H
F2  C                     END
    C           FORL      CABEQFORH      DULPP
D2  C           FORL      IFGT FORH
     C           FORH      DIV  FORL      DISP
F2  C                     END
    C           DISP      CABLE0,5       DULPR
    C           DISP      CABGT0,5       DULPP
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU2'
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           IMPFA     CABNE2         DULPP
    C           IMPFA     CABEQ2         DULPR
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU1'
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           IMPFA     CABNE1         DULPP
    C           IMPFA     CABEQ1         DULPR
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU6'
     C                     MOVELQUAL,S    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           IMPFA     CABNE6         DULPP
    C           IMPFA     CABEQ6         DULPR
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'ENCUV'
    C           ENC       CABEQ'U'       DULPR
    C           TVER      CABEQ'U'       DULPR
    C                     GOTO DULPP
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'NANO '
    C           *IN31     CABEQ'1'       DULPR
    C           CCOL      CABEQ8         DULPR
    C                     GOTO DULPP
F1  C                     END
     * Non Stop
D1  C           TRAPAR    IFEQ 'NONST'
D2  C           FORL      IFLT VAL1
    C           FORH      ORLT VAL2
    C                     GOTO DULPR
F2  C                     END
    C                     GOTO DULPP
F1  C                     END
     * Deux groupes vernis
D1  C           TRAPAR    IFEQ '2GRVE'
D2  C           OTCOEP    IFNE *ZEROS
D3  C           PVR,1     IFNE *BLANK
    C           PVR,2     ANDNE*BLANK
    C                     GOTO DULPR
F3  C                     END
F2  C                     END
    C                     GOTO DULPP
F1  C                     END
     * Dorure à froid
D1  C           TRAPAR    IFEQ 'DORFR'
D2  C           OTCOEP    IFNE *ZEROS
D3  C           MOR,I     IFNE *BLANK
    C                     GOTO DULPR
F3  C                     END
F2  C                     END
    C                     GOTO DULPP
F1  C                     END
     * Grainage simultané
D1  C           TRAPAR    IFEQ 'GRAIW'
D2  C           OTCOEP    IFNE *ZEROS
D3  C           GRASIM    IFEQ 'W'
    C           CTR       ANDEQ*ZEROS
    C                     GOTO DULPR
F3  C                     END
F2  C                     END
    C                     GOTO DULPP
F1  C                     END
     * Compact lourd
D1  C           TRAPAR    IFEQ 'CLOUR'
    C                     GOTO DULPP
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'OFFSET'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPR
    C   82                GOTO FINCAS
     C           DULPR     TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPP
     C           DULPQ     TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE XX---> cas particuliers "DORURE"
     C           CDORUR    TAG
     C                     MOVE 'DORURE'  CASLIB  6             *
     C           DULPC     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPD1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'EXFOR'
D2  C           FORL      IFLT VAL2
    C           FORH      ANDLTVAL1
    C                     GOTO DULPC
F2  C                     END
D2  C           TS        IFEQ ' '
    C           FORH      CABGEVAL2      DULPD
    C           FORL      CABGEVAL1      DULPD
    C                     GOTO DULPC
X2  C                     ELSE
    C                     GOTO DULPD
F2  C                     END
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'DORURE'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPR
    C   82                GOTO FINCAS
     C           DULPD     TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPP
     C           DULPD1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P12--->  cas particuliers "ondulation" .
     C           CONDUL    TAG
     C                     MOVE 'ONDUL.'  CASLIB  6             *
     C           DULPB1    TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'TYSU2'
D2  C           CCOL      IFEQ 9
D3  C           QUAL,2    IFNE '        '
     C                     MOVELQUAL,2    QUL                   *
     C                     EXSR APPPRE                          *
D4  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX1                          *
    C   82                GOTO FINCAS                        * * *
F4  C                     END                                  *
    C           ONDFA     CABEQ2         DULPA1
F3  C                     END                                  *
D3  C           QUAL,6    IFNE '        '
     C                     MOVELQUAL,6    QUL                   *
     C                     EXSR APPPRE                          *
D4  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX1                          *
    C   82                GOTO FINCAS                        * * *
F4  C                     END                                  *
    C           ONDFA     CABEQ2         DULPA1
F3  C                     END                                  *
    C                     GOTO DULPB1
X2  C                     ELSE
     C                     MOVELQUAL,3    QUL                   *
     C                     EXSR APPPRE                          *
D3  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX1                          *
    C   82                GOTO FINCAS                        * * *
F3  C                     END                                  *
    C           ONDFA     CABEQ2         DULPA1
D3  C           CCOL      IFEQ 2
     C                     MOVELQUAL,4    QUL
X3  C                     ELSE
     C                     MOVELQUAL,5    QUL                   *
F3  C                     END
     C                     EXSR APPPRE                          *
D3  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPX1                          *
    C   82                GOTO FINCAS                        * * *
F3  C                     END                                  *
    C           ONDFA     CABEQ2         DULPA1
    C           ONDFA     CABNE2         DULPB1
F2  C                     END
F1  C                     END
     *
     * DEMANDE GUY LE 07/12/12
D1  C           TRAPAR    IFEQ 'PARNC'
    C           TYPOPR    CABNE'B'       DULPB1
    C                     GOTO DULPA1
F1  C                     END
     *
    C* <---PAGE P13--->
D1  C           TRAPAR    IFEQ 'DV600'
    C           TRAPAR    OREQ 'DV650'
    C           TRAPAR    OREQ 'DV700'
    C           ONDH      CABEQ0         DULPB1
    C           ONDH      CABLTVAL1      DULPB1
    C           ONDH      CABGEVAL2      DULPB1
    C                     GOTO DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'POSES'
    C           FACON     CABEQ6         SUIT26
    C           FACON     CABEQ7         SUIT26
    C           FACON     CABEQ8         SUIT26
    C                     GOTO DULPB1
     C           SUIT26    TAG
    C           ACOTE     CABNE0         DULPA1
D2  C           ACOTE     IFEQ 0
     C           ONDL      MULT 2         LAIZT   40
    C           LAIZT     CABGTLALAIZ    DULPB1
D3  C           LAIZT     IFLE LALAIZ
     C           QTEB      DIV  SBFE      TENETQ  70       nbr.feuilles
    C           TENETQ    CABLE8000      DULPB1
    C           GRAOND    CABGE320       DULPA1
    C           GRAOND    CABLT320       DULPB1
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           LUTIL     IFNE *ZEROS
     C                     Z-ADDLUTIL     LAIZO   41
X1  C                     ELSE
     C                     Z-ADDLMINI     LAIZO
F1  C                     END
D1  C           TRAPAR    IFEQ 'LEXCE'
    C           LAIZO     CABLTVAL1      DULPB1
    C           LAIZO     CABGTVAL2      DULPB1
    C                     GOTO DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'LM10 '
    C           LAIZO     CABLTVAL1      DULPB1
    C           LAIZO     CABGTVAL2      DULPB1
    C                     GOTO DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'LM20 '
    C           LAIZO     CABLTVAL1      DULPB1
    C           LAIZO     CABGTVAL2      DULPB1
    C                     GOTO DULPA1
F1  C                     END
     * <---PAGE P14--->
D1  C           TRAPAR    IFEQ 'NITO2'
    C           DCP1      CABEQ'1'       DULPB1
    C           COTAPE    CABEQ'M'       DULPB1
D2  C           NBTAPE    IFEQ 1
    C           NBTAPE    OREQ 2
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'NITO3'
    C           DCP1      CABEQ'1'       DULPB1
    C           COTAPE    CABEQ'M'       DULPB1
D2  C           NBTAPE    IFGE 3
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'RUMA4'
    C           DCP1      CABEQ'1'       DULPB1
D2  C           COTAPE    IFEQ 'M'
    C           NBTAPE    ANDLE4
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'RUMA5'
    C           DCP1      CABEQ'1'       DULPB1
D2  C           COTAPE    IFEQ 'M'
    C           NBTAPE    ANDGE5
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'SESA3'
    C           DCP1      CABEQ'1'       DULPB1
    C           LGBAX     CABNE*ZEROS    DULPB1
D2  C           NBSESA    IFEQ 1
    C           NBSESA    OREQ 2
    C           NBSESA    OREQ 3
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'SESA4'
    C           DCP1      CABEQ'1'       DULPB1
    C           LGBAX     CABNE*ZEROS    DULPB1
D2  C           NBSESA    IFGE 4
    C                     GOTO DULPA1
F2  C                     END
    C                     GOTO DULPB1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'VINYL'
    C           USINE     CABEQ3         DULPB1
    C           COLRH     CABEQ'VY'      DULPA1
    C           COLRH     CABEQ'VH'      DULPA1
    C                     GOTO DULPB1
F1  C                     END
D1  C           TRAPAR    IFEQ 'VINTY'
    C           USINE     CABNE3         DULPB1
    C           COLRH     CABEQ'VY'      DULPA1
    C           COLRH     CABEQ'VH'      DULPA1
    C                     GOTO DULPB1
F1  C                     END
D1  C           TRAPAR    IFEQ 'COMPL'
    C           REPCO     CABEQ*BLANKS   DULPB1
    C           REPCO     CABNE*BLANKS   DULPA1
F1  C                     END
    C* <---PAGE P15--->
D1  C           TRAPAR    IFEQ 'PTGRA'
    C           GRAOND    CABLTVAL       DULPA1
    C           GRAOND    CABGEVAL       DULPB1
F1  C                     END
D1  C           TRAPAR    IFEQ 'MYGRA'
    C           GRAOND    CABLTVAL1      DULPB1
    C           GRAOND    CABLEVAL2      DULPB1
    C                     GOTO DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDGRA'
    C           GRAOND    CABGTVAL       DULPA1
    C           GRAOND    CABLEVAL       DULPB1
F1  C                     END
D1  C           TRAPAR    IFEQ 'JUPE '
    C           TSOND     CABEQ'JU'      DULPA1
    C           TSOND     CABNE'JU'      DULPB1
F1  C                     END
D1  C           TRAPAR    IFEQ 'RAMAS'
    C           ACOTE     CABNE*ZEROS    DULPB1
    C* <---PAGE P16--->
     C           ONDL      MULT 2         LAIZT   40
    C           LAIZT     CABLELALAIZ    DULPB1
    C           ONDL      CABGT1350      DULPB1
    C           ONDH      CABLE1050      DULPA1
    C           ONDH      CABGT1320      DULPB1
    C           ONDL      CABLE1100      DULPA1
    C                     GOTO DULPB1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'PLVCA'
    C           FACON     CABNE1         DULPB1
    C           IMPINT    CABEQ0         DULPB1
    C           IMPINT    CABNE0         DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'PLV10'
    C           FACON     CABNE1         DULPB1
    C           POND2     CABEQ'*'       DULPB1
    C           IMPEXT    CABNE0         SUIT27
    C           IMPINT    CABNE0         SUIT27
    C                     GOTO DULPB1
     C           SUIT27    TAG
    C           DECH      CABGT10        DULPB1
    C           DECH      CABLE10        DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'PLV25'
    C           FACON     CABNE1         DULPB1
    C           POND2     CABEQ'*'       DULPB1
    C           IMPEXT    CABNE0         SUIT77
    C           IMPINT    CABNE0         SUIT77
    C                     GOTO DULPB1
     C           SUIT77    TAG
    C           DECH      CABGT25        DULPB1
    C           DECH      CABLE25        DULPA1
F1  C                     END
D1  C           TRAPAR    IFEQ 'PLV50'
    C           FACON     CABNE1         DULPB1
    C           POND2     CABEQ'*'       DULPB1
    C           IMPEXT    CABNE0         SUIT28
    C           IMPINT    CABNE0         SUIT28
    C                     GOTO DULPB1
     C           SUIT28    TAG
    C           DECH      CABGT75        DULPB1
    C           DECH      CABLE75        DULPA1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'BOBPC'
    C           FACON     CABNE2         DULPB1
    C           ONDUL     CABNE2         DULPB1
    C           DECH      CABLEVAL       DULPB1
    C                     GOTO DULPA1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'BOBGC'
    C           FACON     CABNE2         DULPB1
    C           ONDUL     CABNE3         DULPB1
    C           DECH      CABLEVAL       DULPB1
    C                     GOTO DULPA1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'DUEMM'
    C                     GOTO DULPA1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'POSDD'
    C           CCOL      CABNE9         DULPB1
D2  C           FACON     IFNE 6
    C           FACON     ANDNE7
    C           FACON     ANDNE8
    C                     GOTO DULPB1
F2  C                     END
    C           ACOTE     CABNE*ZEROS    DULPA1
     C           ONDL      MULT 2         LAIZT
    C           LAIZT     CABLELALAIZ    DULPA1
    C                     GOTO DULPB1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'SCARS'
    C           TSOND     CABNE'SC'      DULPB1
    C                     GOTO DULPA1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'SDHN '
D2  C           PAPI,2    IFEQ 'XXX'
    C           GRAM,2    ANDEQ999
    C           PAPI,6    OREQ 'XXX'
    C           GRAM,6    ANDEQ999
    C                     GOTO DULPA1
X2  C                     ELSE
    C                     GOTO DULPB1
F2  C                     END
F1  C                     END
     *
     * TOUJOURS DERNIERE CAS PARTICULIER
D1  C           TRAPAR    IFEQ 'TPSON'
    C           USFAB     CABNE3         DULPB1
    C           NOMAC     CABNE'10'      DULPB1
     C                     Z-ADDTPSTOT    TPXX    52
D2  C           DSGP      IFEQ 'A2'
    C           AMALS     ANDNE0
     C                     MULT AMALS     TPXX
F2  C                     END
    C           TPXX      CABLEVAL       DULPB1
    C                     GOTO DULPA1
F1  C                     END
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'ONDUL.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPX1
    C   82                GOTO FINCAS
     C           DULPA1    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPB1
     C           DULPX1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P17--->  cas particuliers  "c/collage" .
     C           CCCOL     TAG
     C                     MOVE 'C/COL.'  CASLIB  6             *
     C           DULPH1    TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPK1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'TYSU2'
     C                     MOVELQUAL,3    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPK1                          *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           ONDFA     CABEQ2         DULPG1
D2  C           CCOL      IFEQ 5
     C                     MOVELQUAL,4    QUL
    C                     GOTO SUIT35
F2  C                     END
     C                     MOVELQUAL,5    QUL                   *
     C           SUIT35    TAG
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPK1                          *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           ONDFA     CABEQ2         DULPG1
    C           ONDFA     CABNE2         DULPH1
F1  C                     END
D1  C           TRAPAR    IFEQ 'DV600'
    C           TRAPAR    OREQ 'DV650'
    C           TRAPAR    OREQ 'DV700'
D2  C           FACON     IFEQ 4
    C           DECH      CABEQ0         DULPH1
    C           DECH      CABLTVAL1      DULPH1
    C           DECH      CABGEVAL2      DULPH1
    C                     GOTO DULPG1
X2  C                     ELSE
    C           ONDH      CABEQ0         DULPH1
    C           ONDH      CABLTVAL1      DULPH1
    C           ONDH      CABGEVAL2      DULPH1
    C                     GOTO DULPG1
F2  C                     END
F1  C                     END
    C* <---PAGE P18--->
D1  C           TRAPAR    IFEQ 'GLPL '
D2  C           FACON     IFEQ 4
     C           DECL      DIV  DECH      TEST      H
X2  C                     ELSE
     C           ONDL      DIV  ONDH      TEST    54H
F2  C                     END
    C           TEST      CABGT0,5       DULPH1
    C           TEST      CABLE0,5       DULPG1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'NITO2'
    C           DCP1      CABEQ'1'       DULPH1
    C           COTAPE    CABEQ'M'       DULPH1
D2  C           NBTAPE    IFEQ 1
    C           NBTAPE    OREQ 2
    C                     GOTO DULPG1
F2  C                     END
    C                     GOTO DULPH1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'NITO3'
    C           DCP1      CABEQ'1'       DULPH1
    C           COTAPE    CABEQ'M'       DULPH1
D2  C           NBTAPE    IFGE 3
    C                     GOTO DULPG1
F2  C                     END
    C                     GOTO DULPH1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'SESA3'
    C           DCP1      CABEQ'1'       DULPH1
D2  C           NBSESA    IFEQ 1
    C           NBSESA    OREQ 2
    C           NBSESA    OREQ 3
    C                     GOTO DULPG1
F2  C                     END
    C                     GOTO DULPH1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'SESA4'
    C           DCP1      CABEQ'1'       DULPH1
D2  C           NBSESA    IFGE 4
    C                     GOTO DULPG1
F2  C                     END
    C                     GOTO DULPH1
F1  C                     END
    C* TMAFBU 18/11/2014 BANDE KRAFT ARMEE 8 CM
D1  C           TRAPAR    IFEQ 'RUARM'
    C           DCP1      CABEQ'1'       DULPH1
    C           COTAPE    CABNE'M'       DULPH1
    C                     GOTO DULPG1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'SUPOF'
    C           CCOL      CABNE1         DULPH1
D2  C           IMPEXT    IFEQ 4
    C           GRAM,3    ANDGE300
    C           IMPINT    OREQ 4
    C           GRAM,5    ANDGE300
    C                     GOTO DULPG1
F2  C                     END
    C                     GOTO DULPH1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'GAUFR'
    C           GFRA      CABEQ'GA'      DULPG1
    C           GFRA      CABEQ'GB'      DULPG1
    C           GFRA      CABEQ'GC'      DULPG1
    C                     GOTO DULPH1
F1  C                     END
D1  C           TRAPAR    IFEQ 'SFLEG'
    C           CCOL      CABNE1         DULPH1
     C                     MOVELQUAL,5    QUL
    C           GRAMK     CABGT90        DULPH1
    C                     GOTO DULPG1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'LEXCE'
D2  C           LUTIL     IFNE *ZEROS
     C                     Z-ADDLUTIL     LAIZO   41
X2  C                     ELSE
     C                     Z-ADDLMINI     LAIZO
F2  C                     END
    C           LAIZO     CABLTVAL1      DULPH1
    C           LAIZO     CABGTVAL2      DULPH1
    C                     GOTO DULPG1
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'C/COL.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPK1
    C   82                GOTO FINCAS
     * <---PAGE P19--->
     C           DULPG1    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPH1
     C           DULPK1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P20--->  cas particuliers decoupage .
     C           CDECOU    TAG
     C           DULPM1    TAG
     C                     MOVE ' '       PASAMA  1
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPR1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
     C                     SETOF                     2022
     C           ONDL      SUB  FMINL     FAF     20
    C           FAF       CABGT20        DULP30
D1  C           FAF       IFLT 20
    C           FAF       CABLT17        DULP31
    C           FAF       CABGT17        DULP31
D2  C           FAF       IFEQ 17
    C           IMPEXT    CABEQ4         DULP30
    C           IMPINT    CABEQ4         DULP30
    C                     GOTO DULP31
F2  C                     END
F1  C                     END
D1  C           FAF       IFEQ 20
     C           ONDH      SUB  FMINH     FAF
    C           FAF       CABLT20        DULP30
    C           FAF       CABGE20        DULP31
F1  C                     END
     C           DULP30    TAG                             PINCES PERPEND.
     C                     SETON                     20
    C                     GOTO DULPN1
     C           DULP31    TAG
     C                     SETON                     22    PINCES PARAL.
     * <---PAGE P21--->
     C           DULPN1    TAG
D1  C           TRAPAR    IFEQ 'FORMX'
    C           DECORT    CABEQ'0'       DULP32
    C           DECORT    CABEQ'7'       DULP32
    C                     GOTO DULPM1
     C           DULP32    TAG
D2  C           *IN20     IFEQ '0'
D3  C           ONDL      IFLE VAL1
    C           ONDH      CABLEVAL2      DULPM1
    C           ONDL      CABGTVAL2      DULPL1
    C           ONDH      CABGTVAL1      DULPL1
    C           ONDH      CABLEVAL1      DULPM1
X3  C                     ELSE
    C           ONDL      CABGTVAL2      DULPL1
    C           ONDH      CABGTVAL1      DULPL1
    C           ONDH      CABLEVAL1      DULPM1
F3  C                     END
F2  C                     END
D2  C           *IN20     IFEQ '1'
D3  C           ONDL      IFLE VAL2
    C           ONDH      CABLEVAL1      DULPM1
    C           ONDL      CABGTVAL1      DULPL1
    C           ONDH      CABLEVAL2      DULPM1
    C           ONDH      CABGTVAL2      DULPL1
X3  C                     ELSE
    C           ONDL      CABGTVAL1      DULPL1
    C           ONDH      CABLEVAL2      DULPM1
    C           ONDH      CABGTVAL2      DULPL1
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'FORMEX'
D2  C           ONDL      IFGE ONDH                       VAL1 > VAL2
    C           ONDL      CABLEVAL1      DULPM1
    C           ONDH      CABLEVAL2      DULPM1
    C                     GOTO DULPL1
X2  C                     ELSE
    C           ONDH      CABLEVAL1      DULPM1
    C           ONDL      CABLEVAL2      DULPM1
    C                     GOTO DULPL1
F2  C                     END
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'FORM2'
D2  C           TOTGRA    IFGT 400
    C           QTENET    ANDGT7500
    C           SBFEU     ANDGT1000000
    C           CCOL      OREQ 9
    C           SBFEU     ANDGT700000
    C                     GOTO DULPL1
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'IMPRV'
    C           IMPEXT    CABEQ0         DULPM1
D2  C           IMPEXT    IFEQ 4
     C           SUIT24    TAG
    C           IMPINT    CABEQ0         DULPM1
    C           IMPINT    CABEQ4         DULPL1
    C           COUPIN    CABEQ'R'       DULPL1
    C                     GOTO DULPM1
X2  C                     ELSE
    C           COUPEX    CABEQ'R'       SUIT24
    C                     GOTO DULPM1
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'PINCE'
    C           *IN22     CABEQ'0'       DULPM1
D2  C           *IN22     IFEQ '1'
    C           ONDUL     CABEQ2         DULPL1
    C                     GOTO DULPM1
F2  C                     END
F1  C                     END
    C* <---PAGE P22--->
D1  C           TRAPAR    IFEQ 'GLPL '
     C           ONDL      DIV  ONDH      TEST      H
    C           TEST      CABLE0,5       DULPL1
    C           TEST      CABGT0,5       DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'SEPOS'
    C           DECORT    CABEQ'A'       DULPL1
    C           DECORT    CABEQ'B'       DULPL1
    C           DECORT    CABEQ'8'       DULPL1
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'PARNC'
    C           TYPOPR    CABEQ'B'       DULPL1
    C                     GOTO DULPM1
F1  C                     END
     *
    C* <---PAGE P22A-->
D1  C           TRAPAR    IFEQ 'EPA2 '
D2  C           KEASY     IFEQ 'A'
    C           SPPOS     ANDLE2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPA5 '
D2  C           KEASY     IFEQ 'A'
    C           SPPOS     ANDLE5
    C           SPPOS     ANDGT2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPA6 '
D2  C           KEASY     IFEQ 'A'
    C           SPPOS     ANDGE6
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPB2 '
D2  C           KEASY     IFEQ 'B'
    C           SPPOS     ANDLE2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
    C* <---PAGE P22A-->
D1  C           TRAPAR    IFEQ 'EPB5 '
D2  C           KEASY     IFEQ 'B'
    C           SPPOS     ANDLE5
    C           SPPOS     ANDGT2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPB6 '
D2  C           KEASY     IFEQ 'B'
    C           SPPOS     ANDGE6
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPC2 '
D2  C           KEASY     IFEQ 'C'
    C           SPPOS     ANDLE2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPC5 '
D2  C           KEASY     IFEQ 'C'
    C           SPPOS     ANDLE5
    C           SPPOS     ANDGT2
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'EPC6 '
D2  C           KEASY     IFEQ 'C'
    C           SPPOS     ANDGE6
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'RUMAG'
D2  C           COTAPE    IFEQ 'M'
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'RUMAG'
D2  C           COTAPE    IFEQ 'M'
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
     *
     C                     Z-ADD*ZEROS    GRP
D1  C           IMPEXT    IFEQ 5
D2  C           GRPEX     IFNE *ZEROS
     C                     Z-ADDGRPEX     GRP     20
X2  C                     ELSE
     C                     Z-ADDCOUEX     GRP
F2  C                     END
D2  C           OREX      IFNE *BLANKS
     C                     ADD  1         GRP
F2  C                     END
F1  C                     END
D1  C           IMPINT    IFEQ 5
D2  C           GRPEX     IFNE *ZEROS
     C                     Z-ADDGRPEX     GRP     20
X2  C                     ELSE
     C                     Z-ADDCOUEX     GRP
F2  C                     END
D2  C           ORIN      IFNE *BLANKS
     C                     ADD  1         GRP
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'GRP1 '
D2  C           GRP       IFEQ 1
     C                     MOVE '*'       PASAMA  1
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GRP2 '
D2  C           GRP       IFEQ 2
     C                     MOVE '*'       PASAMA
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GRP3 '
D2  C           GRP       IFGE 3
     C                     MOVE '*'       PASAMA
    C                     GOTO DULPL0
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GAUFR'
    C           GFRA      CABEQ'GD'      DULPL0
    C           GFRA2     CABEQ'GD'      DULPL0
    C                     GOTO DULPM1
F1  C                     END
     C                     Z-ADD*ZEROS    POSXX   20
D1  C           POSFO     IFNE *ZEROS
     C                     Z-ADDPOSFO     POSXX
X1  C                     ELSE
D2  C           POSF1     IFNE *ZEROS
     C                     Z-ADDPOSF1     POSXX
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'GAU6 '
D2  C           GFRA      IFEQ 'GD'
    C           GFRA2     OREQ 'GD'
D3  C           POSXX     IFLE 6
    C                     GOTO DULPL0
F3  C                     END
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GAU9 '
D2  C           GFRA      IFEQ 'GD'
    C           GFRA2     OREQ 'GD'
D3  C           POSXX     IFGT 6
    C           POSXX     ANDLE9
    C                     GOTO DULPL0
F3  C                     END
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
D1  C           TRAPAR    IFEQ 'GAU10'
D2  C           GFRA      IFEQ 'GD'
    C           GFRA2     OREQ 'GD'
D3  C           POSXX     IFGE 10
    C                     GOTO DULPL0
F3  C                     END
F2  C                     END
    C                     GOTO DULPM1
F1  C                     END
     *
     C                     Z-ADD*ZEROS    EPTOT   41
D1  C           CCOL      IFEQ 6
    C           CCOL      OREQ 9
     C                     MOVE 'EPCA'    PXARGU
     C                     MOVE DD1       PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '0'
     C                     ADD  PXMONT    EPTOT
F2  C                     END
     C                     MOVE DD2       PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '0'
     C                     ADD  PXMONT    EPTOT
F2  C                     END
     C                     MULT 10        EPTOT
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN1 '
    C           EPTOT     CABEQ*ZEROS    DULPM1
    C           EPTOT     CABLTVAL1      DULPM1
    C           EPTOT     CABGTVAL2      DULPM1
    C                     GOTO DULPL1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN2 '
    C           EPTOT     CABEQ*ZEROS    DULPM1
    C           EPTOT     CABLTVAL1      DULPM1
    C           EPTOT     CABGTVAL2      DULPM1
    C                     GOTO DULPL1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN3 '
    C           EPTOT     CABEQ*ZEROS    DULPM1
    C           EPTOT     CABLTVAL1      DULPM1
    C           EPTOT     CABGTVAL2      DULPM1
    C                     GOTO DULPL1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN4 '
    C           EPTOT     CABEQ*ZEROS    DULPM1
    C           EPTOT     CABGEVAL       DULPL1
    C                     GOTO DULPM1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'SDHN '
D2  C           PAPI,2    IFEQ 'XXX'
    C           GRAM,2    ANDEQ999
    C           PAPI,6    OREQ 'XXX'
    C           GRAM,6    ANDEQ999
    C                     GOTO DULPL1
X2  C                     ELSE
    C                     GOTO DULPM1
F2  C                     END
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'BRAIA'
    C           CODBRA    CABNE'A'       DULPM1
    C                     GOTO DULPL1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'BRAIB'
    C           CODBRA    CABNE'B'       DULPM1
    C                     GOTO DULPL1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'BRAIC'
    C           CODBRA    CABNE'C'       DULPM1
    C                     GOTO DULPL1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'EXFOR'
D2  C           FORL      IFLT VAL2
    C           FORH      ANDLTVAL1
    C                     GOTO DULPM1
F2  C                     END
D2  C           TS        IFEQ ' '
    C           FORH      CABGEVAL2      DULPL1
    C           FORL      CABGEVAL1      DULPL1
    C                     GOTO DULPM1
X2  C                     ELSE
    C                     GOTO DULPL1
F2  C                     END
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'DECOU.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPR1
    C   82                GOTO FINCAS
     *
     C           DULPL0    TAG
     C                     Z-ADD1         W
     C           10        LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG
X1  C                     ELSE
     C                     Z-ADD0         PREG
F1  C                     END
D1  C           PREG      IFNE 0
    C           PREG      ANDLT1
    C           AMALS     ANDEQ0
     C           PRETPV    MULT PREG      PRETPV
F1  C                     END
D1  C           PREG      IFNE 0
    C           PASAMA    ANDEQ'*'
     C           PRETPV    MULT PREG      PRETPV
F1  C                     END
     * <---PAGE P19--->
     C           DULPL1    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPM1
     C           DULPR1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE P23---> cas particuliers assemblage .
     C           CASSEM    TAG
     C                     MOVE 'ASSEM.'  CASLIB  6             *
     C           DULPT1    TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPZ1                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
    C*
D1  C           COAS1     IFEQ 40
    C           COAS1     OREQ 41
    C           COAS1     OREQ 42
    C           COAS1     OREQ 43
    C                     GOTO FINCAS
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU2'
     * Nouvelle offset
D2  C           OTCOEP    IFNE *ZEROS
D3  C           OTV1EP    IFEQ 'E'
    C           OTV2EP    OREQ 'E'
    C           OTV3EP    OREQ 'E'
    C           OTV1IP    OREQ 'E'
    C           OTV2IP    OREQ 'E'
    C           OTV3IP    OREQ 'E'
    C           OTV1ER    OREQ 'E'
    C           OTV2ER    OREQ 'E'
    C           OTV3ER    OREQ 'E'
    C           OTV1IR    OREQ 'E'
    C                     GOTO DULPS1
F3  C                     END
F2  C                     END
D2  C           TVEEX     IFEQ 'E'
    C           TVEEXR    OREQ 'E'
    C           TVEIN     OREQ 'E'
    C           TVEINR    OREQ 'E'
    C                     GOTO DULPS1
F2  C                     END
     *
     C                     Z-ADD0         A
D2  C                     DO   5         A
D3  C           QUAL,A    IFNE *BLANKS
     C                     MOVELQUAL,A    QUL
     C                     EXSR APPPRE                        * * *
D4  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPZ1                          *
    C   82                GOTO FINCAS                        * * *
F4  C                     END                                  *
    C           ASSFA     CABEQ2         DULPS1
F3  C                     END
F2  C                     END
    C                     GOTO DULPT1
     *
F1  C                     END
     * <---PAGE P24--->
D1  C           TRAPAR    IFEQ 'MARGE'
D2  C           TESTGP    IFEQ '1'
    C           COAS1     CABEQ28        DULPT1
    C           COAS1     CABEQ30        DULPT1
    C           COAS1     CABEQ38        DULPT1
    C           MTPS1     CABEQ*BLANKS   DULPT1
    C                     GOTO DULPS1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           COAS2     CABEQ28        DULPT1
    C           COAS2     CABEQ30        DULPT1
    C           COAS2     CABEQ38        DULPT1
    C           MTPS2     CABEQ*BLANKS   DULPT1
    C                     GOTO DULPS1
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'GDDEV'
D2  C           TESTGP    IFEQ '1'
D3  C           PASS1     IFEQ DECL
    C           DECH      CABGTVAL       DULPS1
    C           DECH      CABLEVAL       DULPT1
X3  C                     ELSE
    C           DECL      CABGTVAL       DULPS1
    C           DECL      CABLEVAL       DULPT1
F3  C                     END
F2  C                     END
D2  C           TESTGP    IFEQ '2'
D3  C           PASS2     IFEQ DECL
    C           DECH      CABGTVAL       DULPS1
    C           DECH      CABLEVAL       DULPT1
X3  C                     ELSE
    C           DECL      CABGTVAL       DULPS1
    C           DECL      CABLEVAL       DULPT1
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'PIST2'
D2  C           TESTGP    IFEQ '1'
    C           PIST1     CABEQ1         DULPS1
    C           PIST1     CABEQ2         DULPS1
    C                     GOTO DULPT1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           PIST2     CABEQ1         DULPS1
    C           PIST2     CABEQ2         DULPS1
    C                     GOTO DULPT1
F2  C                     END
F1  C                     END
     * <---PAGE P25--->
D1  C           TRAPAR    IFEQ 'PIST3'
D2  C           TESTGP    IFEQ '1'
    C           PIST1     CABGE3         DULPS1
    C           PIST1     CABLT3         DULPT1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           PIST2     CABGE3         DULPS1
    C           PIST2     CABLT3         DULPT1
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'CLICH'
D2  C           TESTGP    IFEQ '1'
    C           COLV1     CABEQ'C'       DULPS1
    C           COLV1     CABNE'C'       DULPT1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           COLV2     CABEQ'C'       DULPS1
    C           COLV2     CABNE'C'       DULPT1
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'BUSES'
D2  C           TESTGP    IFEQ '1'
    C           COLV1     CABEQ'B'       DULPS1
    C           COLV1     CABNE'B'       DULPT1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           COLV2     CABEQ'B'       DULPS1
    C           COLV2     CABNE'B'       DULPT1
F2  C                     END
F1  C                     END
    C*          TRAPAR    IFEQ 'ETIQU'
    C*          TESTGP    IFEQ '1'
    C*          ETIQ1     CABEQ' '       DULPT1
    C*          ETIQ1     CABNE' '       DULPS1
    C*                    END
    C*          TESTGP    IFEQ '2'
    C*          ETIQ1     CABEQ' '       DULPT1
    C*          ETIQ2     CABNE' '       DULPS1
    C*                    END
    C*                    END
     * <---PAGE P26--->
D1  C           TRAPAR    IFEQ 'RELCO'
D2  C           TESTGP    IFEQ '1'
    C           RELC1     CABEQ' '       DULPT1
    C           RELC1     CABNE' '       DULPS1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           RELC2     CABEQ' '       DULPT1
    C           RELC2     CABNE' '       DULPS1
F2  C                     END
F1  C                     END
D1  C           TRAPAR    IFEQ 'SA   '
    C           CONDI     CABEQ'SA'      DULPS1
    C           CONDI     CABNE'SA'      DULPT1
F1  C                     END
D1  C           TRAPAR    IFEQ 'SB   '
    C           CONDI     CABEQ'SB'      DULPS1
    C           CONDI     CABNE'SB'      DULPT1
F1  C                     END
D1  C           TRAPAR    IFEQ 'SP   '
    C           CONDI     CABEQ'SP'      DULPS1
    C           CONDI     CABNE'SP'      DULPT1
F1  C                     END
D1  C           TRAPAR    IFEQ 'SY   '
    C           CONDI     CABEQ'SY'      DULPS1
    C           CONDI     CABNE'SY'      DULPT1
F1  C                     END
D1  C           TRAPAR    IFEQ 'PAQFC'
    C           EMBZ2     CABEQ'P'       DULPS1
    C           EMBZ2     CABNE'P'       DULPT1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'COMP1'
    C           TRAPAR    OREQ 'COMP2'
D2  C           CCOL      IFEQ 5
    C           CCOL      OREQ 4
    C           CCOL      OREQ 7
    C           TOTGRA    CABLTVAL1      DULPT1
    C           TOTGRA    CABGEVAL2      DULPT1
    C                     GOTO DULPS1
F2  C                     END
    C                     GOTO DULPT1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'COETU'
D2  C           ONDUL     IFEQ 0
    C           TOTGRA    CABGE500       DULPT1
    C           PASS1     CABGT400       DULPT1
D3  C           COAS1     IFEQ 23
    C           COAS1     OREQ 24
    C           COAS1     OREQ 26
    C           COAS1     OREQ 36
    C                     GOTO DULPS1
F3  C                     END
    C                     GOTO DULPT1
F2  C                     END
    C                     GOTO DULPT1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'CO450'
    C           TRAPAR    OREQ 'CO700'
    C           ONDUL     CABNE0         DULPT1
    C           GRAM,3    CABLTVAL1      DULPT1
    C           GRAM,3    CABGEVAL2      DULPT1
    C                     GOTO DULPS1
F1  C                     END
D1  C           TRAPAR    IFEQ 'DIRPA'
D2  C           TESTGP    IFEQ '1'
    C           COAS1     CABNE30        DULPT1
F2  C                     END
D2  C           TESTGP    IFEQ '2'
    C           COAS2     CABNE30        DULPT1
F2  C                     END
    C           EMBZ3     CABEQ'O'       DULPS1
    C                     GOTO DULPT1
F1  C                     END
     * <---PAGE P26'--->
D1  C           TRAPAR    IFEQ 'PAPIL'
D2  C           ONDUL     IFEQ 0
    C           CCOL      OREQ 9
    C                     GOTO DULPT1
F2  C                     END
     C                     MOVELQUAL,3    QUL
     C                     Z-ADDGRAMK     GRAMK3  30
     C                     MOVELQUAL,4    QUL
D2  C           PAPIK     IFNE *BLANKS
     C                     Z-ADDGRAMK     GRAMK4  30
X2  C                     ELSE
     C                     Z-ADD999       GRAMK4
F2  C                     END
     C                     MOVELQUAL,5    QUL
D2  C           PAPIK     IFNE *BLANKS
     C                     Z-ADDGRAMK     GRAMK5  30
X2  C                     ELSE
     C                     Z-ADD999       GRAMK5
F2  C                     END
D2  C           GRAMK3    IFLE 90
    C           GRAMK4    ORLE 90
    C           GRAMK5    ORLE 90
    C                     GOTO DULPS1
F2  C                     END
    C                     GOTO DULPT1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'VERES'
     * Nouvelle offset or compact ext/int
D2  C           OTCOEP    IFNE *ZEROS
D3  C           OTV1EP    IFEQ 'U'
    C           OPV1EP    ANDLT1
    C           OTV2EP    OREQ 'U'
    C           OPV2EP    ANDLT1
    C           OTV3EP    OREQ 'U'
    C           OPV3EP    ANDLT1
    C           OTV1IP    OREQ 'U'
    C           OPV1IP    ANDLT1
    C           OTV2IP    OREQ 'U'
    C           OPV2IP    ANDLT1
    C           OTV3IP    OREQ 'U'
    C           OPV3IP    ANDLT1
    C                     GOTO DULPS1
F3  C                     END
     * Nouvelle offset spécifique compact ext/int
D3  C           OCOMRV    IFEQ 'EI'
D4  C           OTV1ER    IFEQ 'U'
    C           OPV1ER    ANDLT1
    C           OTV2ER    OREQ 'U'
    C           OPV2ER    ANDLT1
    C           OTV3ER    OREQ 'U'
    C           OPV3ER    ANDLT1
    C                     GOTO DULPS1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           TVEEX     IFEQ 'U'
    C           CVEEX     ANDLT1
    C           TVEIN     OREQ 'U'
    C           CVEIN     ANDLT1
    C                     GOTO DULPS1
F2  C                     END
    C                     GOTO DULPT1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'VERNR'
     * Nouvelle offset or compact ext/int
D2  C           OTCOEP    IFNE *ZEROS
D3  C           OTV1EP    IFEQ 'U'
    C           OPV1EP    ANDGE1
    C           OTV2EP    OREQ 'U'
    C           OPV2EP    ANDGE1
    C           OTV3EP    OREQ 'U'
    C           OPV3EP    ANDGE1
    C           OTV1IP    OREQ 'U'
    C           OPV1IP    ANDGE1
    C           OTV2IP    OREQ 'U'
    C           OPV2IP    ANDGE1
    C           OTV3IP    OREQ 'U'
    C           OPV3IP    ANDGE1
    C                     GOTO DULPS1
F3  C                     END
     * Nouvelle offset spécifique compact ext/int
D3  C           OCOMRV    IFEQ 'EI'
D4  C           OTV1ER    IFEQ 'U'
    C           OPV1ER    ANDGE1
    C           OTV2ER    OREQ 'U'
    C           OPV2ER    ANDGE1
    C           OTV3ER    OREQ 'U'
    C           OPV3ER    ANDGE1
    C                     GOTO DULPS1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           TVEEX     IFEQ 'U'
    C           CVEEX     ANDGE1
    C           TVEIN     OREQ 'U'
    C           CVEIN     ANDGE1
    C                     GOTO DULPS1
F2  C                     END
    C                     GOTO DULPT1
F1  C                     END
     *
     C                     Z-ADD*ZEROS    EPTOT
D1  C           CCOL      IFEQ 6
    C           CCOL      OREQ 9
     C                     MOVE 'EPCA'    PXARGU
     C                     MOVE DD1       PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '0'
     C                     ADD  PXMONT    EPTOT
F2  C                     END
     C                     MOVE DD2       PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '0'
     C                     ADD  PXMONT    EPTOT
F2  C                     END
     C                     MULT 10        EPTOT
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN1 '
    C           EPTOT     CABEQ*ZEROS    DULPT1
    C           EPTOT     CABLTVAL1      DULPT1
    C           EPTOT     CABGTVAL2      DULPT1
    C                     GOTO DULPS1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN2 '
    C           EPTOT     CABEQ*ZEROS    DULPT1
    C           EPTOT     CABLTVAL1      DULPT1
    C           EPTOT     CABGTVAL2      DULPT1
    C                     GOTO DULPS1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN3 '
    C           EPTOT     CABEQ*ZEROS    DULPT1
    C           EPTOT     CABLTVAL1      DULPT1
    C           EPTOT     CABGTVAL2      DULPT1
    C                     GOTO DULPS1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DCAN4 '
    C           EPTOT     CABEQ*ZEROS    DULPT1
    C           EPTOT     CABGEVAL       DULPS1
    C                     GOTO DULPT1
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'ASSEM.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPZ1
    C   82                GOTO FINCAS
     * <---PAGE P27--->
     C           DULPS1    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPT1
     C           DULPZ1    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE-P28-->  cas particuliers "FENETRE"
     C           CFENET    TAG
     C                     SETOF                     30
     C           DULPF1    TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPF9                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'COLEG'
D2  C           CCOL      IFEQ *ZERO
    C           ONDUL     ANDEQ*ZERO
    C           GRAM,3    ANDLT450
    C           *IN30     ANDEQ'0'
     C                     SETON                     30
    C                     GOTO DULPF2
F2  C                     END
    C                     GOTO DULPF1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'LONFE'
D2  C           *IN30     IFEQ '0'
    C           LARFEN    ANDLTLONFEN
     C           LONFEN    DIV  LARFEN    LG      21
    C           LG        CABLE1,5       DULPF1
     C                     SETON                     30
    C                     GOTO DULPF2
F2  C                     END
    C                     GOTO DULPF1
F1  C                     END
     * <---PAGE P29--->
D1  C           TRAPAR    IFEQ 'POSLA'
    C           NBRFE     CABGT1         DULPF2
    C                     GOTO DULPF1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'RHODO'
D2  C           RHODO     IFEQ '1'
    C           RHODO     ANDEQ'4'
    C           RHODO     ANDEQ'6'
    C           RHODO     ANDEQ'8'
    C           RHODO     ANDEQ'9'
    C                     GOTO DULPF2
F2  C                     END
    C                     GOTO DULPF1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'COMPA'
    C           CCOL      CABEQ5         DULPF2
D2  C           CCOL      IFEQ *ZEROS
    C           ONDUL     ANDEQ*ZERO
    C                     GOTO DULPF2
F2  C                     END
    C                     GOTO DULPF1
F1  C                     END
     * <---PAGE P30--->
D1  C           TRAPAR    IFEQ 'PETCA'
    C           ONDUL     CABEQ2         DULPF2
    C                     GOTO DULPF1
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'FENET.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPF9
    C   82                GOTO FINCAS
     * <---PAGE P27--->
     C           DULPF2    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPF1
     C           DULPF9    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     * <---PAGE-xxx-->  cas particuliers "COMPLEXEUSE"
     C           CCOMPL    TAG
     C                     MOVE 'COMPL.'  CASLIB  6             *
     C                     SETOF                     30
     C           DULPV     TAG
     C                     EXSR APPCAS                        * * *
D1  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPV2                          *
    C   82                GOTO FINCAS                        * * *
F1  C                     END                                  *
     *
D1  C           TRAPAR    IFEQ 'POSES'
D2  C           ONDL      IFNE *ZEROS
     C           ONDL      MULT 2         LAIZT
X2  C                     ELSE
     C           DECL      MULT 2         LAIZT
F2  C                     END
    C           LAIZT     CABGTLALAIZ    DULPV
    C                     GOTO DULPV1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'NITO2'
    C           COTAPE    CABEQ'M'       DULPV
D2  C           NBTAPE    IFEQ 1
    C           ONDUL     ANDEQ0
    C           CCOL      ANDEQ0
    C           NBTAPE    OREQ 2
    C           ONDUL     ANDEQ0
    C           CCOL      ANDEQ0
    C           NBTAPE    OREQ 1
    C           CCOL      ANDEQ4
    C           NBTAPE    OREQ 1
    C           CCOL      ANDEQ7
    C           NBTAPE    OREQ 2
    C           CCOL      ANDEQ4
    C           NBTAPE    OREQ 2
    C           CCOL      ANDEQ7
    C                     GOTO DULPV1
F2  C                     END
    C                     GOTO DULPV
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'NITO3'
    C           COTAPE    CABEQ'M'       DULPV
D2  C           NBTAPE    IFGE 3
    C           ONDUL     ANDEQ0
    C           CCOL      ANDEQ0
    C           NBTAPE    OREQ 3
    C           CCOL      ANDEQ4
    C           NBTAPE    OREQ 3
    C           CCOL      ANDEQ7
    C                     GOTO DULPV1
F2  C                     END
    C                     GOTO DULPV
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'DV600'
    C           TRAPAR    OREQ 'DV650'
    C           TRAPAR    OREQ 'DV130'
    C           ONDH      CABEQ0         DULPV
    C           ONDH      CABLTVAL1      DULPV
    C           ONDH      CABGEVAL2      DULPV
    C                     GOTO DULPV1
F1  C                     END
    C*
D1  C           TRAPAR    IFEQ 'LEXCE'
    C           LMINI     CABLTVAL1      DULPV
    C           LMINI     CABGTVAL2      DULPV
    C                     GOTO DULPV1
F1  C                     END
D1  C           TRAPAR    IFEQ 'LM10 '
    C           LMINI     CABLTVAL1      DULPV
    C           LMINI     CABGTVAL2      DULPV
    C                     GOTO DULPV1
F1  C                     END
D1  C           TRAPAR    IFEQ 'LM20 '
    C           LMINI     CABLTVAL1      DULPV
    C           LMINI     CABGTVAL2      DULPV
    C                     GOTO DULPV1
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU4'
     C                     MOVELQUAL,3    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           ONDFA     CABEQ4         DULPV1
D2  C           PAPI,4    IFNE *BLANKS
     C                     MOVELQUAL,4    QUL                   *
     C                     EXSR APPPRE                          *
D3  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F3  C                     END                                  *
    C           IMPFA     CABEQ4         DULPV1
F2  C                     END                                  *
    C                     GOTO DULPV
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'TYSU5'
     C                     MOVELQUAL,3    QUL                   *
     C                     EXSR APPPRE                          *
D2  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F2  C                     END                                  *
    C           ONDFA     CABEQ5         DULPV1
D2  C           PAPI,4    IFNE *BLANKS
     C                     MOVELQUAL,4    QUL                   *
     C                     EXSR APPPRE                          *
D3  C           GPTEST    IFEQ '1'                             *
    C  N82                GOTO DULPQ                           *
    C   82                GOTO FINCAS                        * * *
F3  C                     END                                  *
    C           ONDFA     CABEQ5         DULPV1
F2  C                     END                                  *
    C                     GOTO DULPV
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'SULEG'
D2  C           GRAM,3    IFGE GRAM,4
    C           GRAM,4    CABLTVAL1      DULPV
    C           GRAM,4    CABGTVAL2      DULPV
    C                     GOTO DULPV1
X2  C                     ELSE
    C           GRAM,3    CABLTVAL1      DULPV
    C           GRAM,3    CABGTVAL2      DULPV
    C                     GOTO DULPV1
F2  C                     END
F1  C                     END
     *
D1  C           TRAPAR    IFEQ 'REPIN'
D2  C           IMPEXT    IFEQ *ZEROS
    C           IMPINT    ANDEQ3
    C           COUPIN    ANDEQ'R'
    C           IMPINT    OREQ *ZEROS
    C           IMPEXT    ANDEQ3
    C           COUPEX    ANDEQ'R'
    C           IMPEXT    OREQ 1
    C           IMPINT    ANDEQ3
    C           COUPEX    ANDEQ'R'
    C           COUPIN    ANDNE'R'
    C           IMPEXT    OREQ 3
    C           IMPINT    ANDEQ1
    C           COUPEX    ANDNE'R'
    C           COUPIN    ANDEQ'R'
    C           IMPEXT    OREQ 2
    C           IMPINT    ANDEQ3
    C           COUPEX    ANDEQ'R'
    C           COUPIN    ANDNE'R'
    C           IMPEXT    OREQ 3
    C           IMPINT    ANDEQ2
    C           COUPEX    ANDNE'R'
    C           COUPIN    ANDEQ'R'
    C                     GOTO DULPV1
F2  C                     END
    C                     GOTO DULPV
F1  C                     END
     *
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD28        ERR1,A
     C   80                MOVEL'COMPL.'  ERR2,A
     C   80                MOVE Z5A       ERR2,A
    C  N82                GOTO DULPV2
    C   82                GOTO FINCAS
     * <-------------->
     C           DULPV1    TAG
     C                     EXSR CUMUL                      cumul
    C                     GOTO DULPV
     C           DULPV2    TAG
     C                     EXSR TCUMUL                     total cumul
    C                     GOTO FINCAS
     *
     * fin du module des cas particuliers .
     C           FINCAS    TAG
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     *
     * ----------------------------------------------------- *
    C           APPCAS    BEGSR
     C                     MOVE ' '       GPTEST  1
     C           CLECAS    READECASPAR                   80
D1  C           *IN80     IFEQ '1'
     C                     MOVE '1'       GPTEST
F1  C                     END
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     *
     * ----------------------------------------------------- *
    C           APPPRE    BEGSR
     C                     MOVE ' '       GPTEST
    C           PAPIK     CABGE'000'     FAPPPR
    C           PAPIK     CABEQ'   '     FAPPPR
     C                     MOVE ADPAK     CXHK    3
D1  C           CXHK      IFNE 'CXH'
     C           CLEPRK    CHAINMATPREL1             80       * * *
X1  C                     ELSE
     C           CLEPRK    CHAINCXHENTL1             80       * * *
F1  C                     END                                  *
D1  C           *IN80     IFEQ '1'                         *   *   *
     C                     MOVE '1'       GPTEST                *
     C                     Z-ADD1         A                     *
     C           *ZEROS    LOKUPERR1,A                   80     *
     C                     MOVELPAPIK     Z7A       P
     C                     MOVE GRAMK     Z7A
     C                     Z-ADD29        ERR1,A                *
     C                     MOVELCASLIB    ERR2,A                *
     C                     MOVE Z7A       ERR2,A                *
F1  C                     END                                  *
    C           FAPPPR    ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * cas particuliers (sous prog. cumul)
     * ----------------------------------------------------- *
    C           CUMUL     BEGSR
     C                     SETOF                     82
D1  C           INRE      IFEQ '1'
     C                     Z-ADD*ZEROS    PRETPR
     C                     Z-ADD*ZEROS    PRETPV
F1  C                     END
D1  C           INRO      IFEQ '1'
     C                     Z-ADD*ZEROS    PROTPR
     C                     Z-ADD*ZEROS    CADPLA
F1  C                     END
     C                     ADD  PRETPR    TRETPR  32
     C                     ADD  PREDER    TREDER  32
     C                     ADD  PREFF     TREFF   20
     C                     ADD  PNETPR    TNETPR  32
     C                     ADD  PNEFF     TNEFF   20
     C                     ADD  PROTPR    TROTPR  32
     C                     ADD  PRODER    TRODER  32
     C                     ADD  PROEFF    TROEFF  20
     C                     ADD  PRETPV    TRETPV  52
     C                     ADD  PREDEV    TREDEV  50
     C                     ADD  PNETPV    TNETPV  52
D1  C           INRO      IFEQ '0'
D2  C           CADMAX    IFEQ 0
D3  C           CADPLA    IFNE 0
     C                     Z-ADDCADPLA    CADMAX  50
F3  C                     END
X2  C                     ELSE
D3  C           CADPLA    IFNE 0
D4  C           CADPLA    IFLT CADMAX
     C                     Z-ADDCADPLA    CADMAX
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *--formatage et ecriture CASPAR POUR OBJECTIF PRODUCTION
D1  C           DSGP      IFEQ 'AB'
     C                     MOVE 'W'       GG
     C                     MOVELTRAPAR    WLIBTR
     C           PRETPR    MULT RETPS     WRETPS
     C           PREDER    MULT REDEC     WREDEC
     C                     Z-ADDPREFF     WREEFF
     C           PNETPR    MULT NETPS     WNETPS
     C                     Z-ADDPNEFF     WNEEFF
     C           PROTPR    MULT TPSTOT    WTPSTO
     C           PRODER    MULT MOYDEC    WOYDEC    H
     C                     Z-ADDPROEFF    WROEFF
     C                     ADD  PRETPV    WRETPS
     C                     ADD  PREDEV    WREDEC
     C                     ADD  PNETPV    WNETPS
     C                     Z-ADDCADPLA    WMOYCA
     C                     ADD  WRETPS    YRETPS  42
     C                     ADD  WREDEC    YREDEC  50
     C                     ADD  WREEFF    YREEFF  20
     C                     ADD  WNETPS    YNETPS  42
     C                     ADD  WNEEFF    YNEEFF  20
     C                     ADD  WTPSTO    YTPSTO  62
     C                     ADD  WOYDEC    YOYDEC  42
     C                     ADD  WROEFF    YROEFF  20
     C                     ADD  PREDEV    YREDEC
     C                     ADD  PNETPV    YNETPS
     C                     Z-ADDCADMAX    YMOYCA  60
     C                     WRITEOBJCASF1
F1  C                     END
     C/SPACE 1
     C/SPACE 1
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * cas particuliers (sous prog. total cumul)
     * ----------------------------------------------------- *
    C           TCUMUL    BEGSR
     C                     Z-ADD0         DECR
     C                     Z-ADD0         TPSRE
     C                     Z-ADD0         TPSNE
     C                     Z-ADD0         TOTTPS
     C                     Z-ADD0         CADMOY
     C                     Z-ADD0         MAXDRE
     C                     Z-ADD0         MAXDRO
     C                     Z-ADD0         MAXTRE
     C                     Z-ADD0         MAXTRO
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     Z-ADD0         AMREG
     C                     Z-ADD0         AMNET
     C           CLECAS    CHAINMAXDEC               80
D1  C           *IN80     IFEQ '0'
D2  C           DSGP      IFEQ 'AB'
     * objectifs de production ---> ecriture -maxi retenu- .
     C                     MOVE 'X'       GG
     C           REDEC     MULT MAXDRE    WREDEC
     C           MOYDEC    MULT MAXDRO    WOYDEC
     C           RETPS     MULT MAXTRE    WRETPS
     C           TPSTOT    MULT MAXTRO    WTPSTO
D3  C           YREDEC    IFGE WREDEC
     C                     Z-ADDWREDEC    YREDEC
X3  C                     ELSE
     C                     Z-ADD0         WREDEC
F3  C                     END
D3  C           YOYDEC    IFGE WOYDEC
     C                     Z-ADDWOYDEC    YOYDEC
X3  C                     ELSE
     C                     Z-ADD0         WOYDEC
F3  C                     END
D3  C           YRETPS    IFGE WRETPS
     C                     Z-ADDWRETPS    YRETPS
X3  C                     ELSE
     C                     Z-ADD0         WRETPS
F3  C                     END
D3  C           YTPSTO    IFGE WTPSTO
     C                     Z-ADDWTPSTO    YTPSTO
X3  C                     ELSE
     C                     Z-ADD0         WTPSTO
F3  C                     END
     C                     Z-ADD0         WNETPS
     C                     Z-ADD0         WMOYCA
     C                     Z-ADD0         WREEFF
     C                     Z-ADD0         WNEEFF
     C                     Z-ADD0         WROEFF
     C                     WRITEOBJCASF1
F2  C                     END
    C*
D2  C           MAXDRE    IFNE 0
    C           TREDER    ANDGTMAXDRE
     C                     Z-ADDMAXDRE    TREDER
F2  C                     END
D2  C           MAXDRO    IFNE 0
    C           TRODER    ANDGTMAXDRO
     C                     Z-ADDMAXDRO    TRODER
F2  C                     END
D2  C           MAXTRE    IFNE 0
    C           TRETPR    ANDGTMAXTRE
     C                     Z-ADDMAXTRE    TRETPR
F2  C                     END
D2  C           MAXTRO    IFNE 0
    C           TROTPR    ANDGTMAXTRO
     C                     Z-ADDMAXTRO    TROTPR
F2  C                     END
F1  C                     END                                  *
     C/SPACE 1
D1  C           TRETPR    IFNE 0
     C           RETPS     MULT TRETPR    PRETPS  52
     C           RETPS     ADD  PRETPS    TPSRE   62
X1  C                     ELSE
     C                     Z-ADDRETPS     TPSRE
F1  C                     END
D1  C           TREDER    IFNE 0
     C           REDEC     MULT TREDER    PREDEC  50
     C           REDEC     ADD  PREDEC    DECR    50
X1  C                     ELSE
     C                     Z-ADDREDEC     DECR
F1  C                     END
D1  C           TREFF     IFNE 0
     C                     ADD  TREFF     REEFF
F1  C                     END
D1  C           TNETPR    IFNE 0
     C           NETPS     MULT TNETPR    PNETPS  42
     C           NETPS     ADD  PNETPS    TPSNE
X1  C                     ELSE
     C                     Z-ADDNETPS     TPSNE
F1  C                     END
    C*
D1  C           TNEFF     IFNE 0
     C                     ADD  TNEFF     NEEFF
F1  C                     END
D1  C           TROTPR    IFNE 0
     C           TPSTOT    MULT TROTPR    XTPSTO  62
     C           TPSTOT    ADD  XTPSTO    TOTTPS  82
X1  C                     ELSE
     C                     Z-ADDTPSTOT    TOTTPS
F1  C                     END
D1  C           TRODER    IFNE 0
     C           MOYDEC    MULT TRODER    TMOYDE  31H
     C           MOYDEC    ADD  TMOYDE    MOYDEC
F1  C                     END
    C*
D1  C           TROEFF    IFNE 0
     C                     ADD  TROEFF    ROEFF
F1  C                     END
     C                     ADD  TRETPV    TPSRE
     C                     ADD  TREDEV    DECR
     C                     ADD  TNETPV    TPSNE
    C*
     C           TPSRE     SUB  RETPS     REPART  52
D1  C           AMALS     IFNE *ZERO
     C           REPART    DIV  AMALS     AMREG   52
X1  C                     ELSE
     C                     Z-ADDREPART    AMREG
F1  C                     END
     C           TPSNE     SUB  NETPS     NEPART  52
D1  C           AMALS     IFNE *ZERO
     C           NEPART    DIV  AMALS     AMNET   52
X1  C                     ELSE
     C                     Z-ADDNEPART    AMNET
F1  C                     END
    C*
     C           TROTPR    ADD  1,00      NEW     32
     C           MOYCAD    DIV  NEW       CADMOY  60
D1  C           CADMAX    IFNE 0
     C           CADMOY    MULT TOTTPS    PREVIS  82
     C           PREVIS    DIV  CADMAX    TPSMAX  62H
D2  C           TPSMAX    IFGT TOTTPS
     C                     Z-ADDTPSMAX    TOTTPS  82
     C                     Z-ADDCADMAX    CADMOY
F2  C                     END
F1  C                     END
    C*
     C           TCUFIN    TAG
     C                     Z-ADD0         CADMAX
     C/SPACE 1
     * objectifs de production ---> standard rectifie-
D1  C           DSGP      IFEQ 'AB'
     C                     MOVE 'Y'       GG
     C                     Z-ADDDECR      YREDEC
     C                     Z-ADDMOYDEC    YOYDEC
     C                     Z-ADDTPSRE     YRETPS
     C                     Z-ADDTPSNE     YNETPS
     C                     Z-ADDTOTTPS    YTPSTO
     C                     Z-ADDREEFF     YREEFF
     C                     Z-ADDNEEFF     YNEEFF
     C                     Z-ADDROEFF     YROEFF
D2  C           CADMOY    IFNE 0
     C                     Z-ADDCADMOY    YMOYCA
X2  C                     ELSE
     C                     Z-ADDMOYCAD    YMOYCA
F2  C                     END
     C                     Z-ADDYREDEC    WREDEC
     C                     Z-ADDYOYDEC    WOYDEC
     C                     Z-ADDYRETPS    WRETPS
     C                     Z-ADDYNETPS    WNETPS
     C                     Z-ADDYTPSTO    WTPSTO
     C                     Z-ADDYMOYCA    WMOYCA
     C                     Z-ADDYREEFF    WREEFF
     C                     Z-ADDYNEEFF    WNEEFF
     C                     Z-ADDYROEFF    WROEFF
     C                     WRITEOBJCASF1
F1  C                     END
     C/SPACE 1
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * formatage et, edition des erreurs devis .
     * ----------------------------------------------------- *
    C           SPERR     BEGSR
    C*
D1  C           ERR1,1    IFNE 0
     C                     MOVE '*'       ERRDEV  1
     C                     SETOF                     4445
D2  C           DSGP      IFEQ 'OR'
    C           DSGP      OREQ 'OB'
    C           DSGP      OREQ 'PR'
     C                     SETON                     44
F2  C                     END
D2  C           DSGP      IFEQ 'SU'
     C                     SETON                     45
F2  C                     END
D2  C           DSGP      IFEQ 'SP'
     C                     SETON                     46
F2  C                     END
D2  C           DSGP      IFEQ 'CX'
     C                     SETON                     47
F2  C                     END
D2  C                     DO   100       P       30
D3  C           ERR1,P    IFNE 0
     C                     MOVE ERR2,P    MSGMSG    P
     C                     Z-ADDERR1,P    A
     C                     Z-ADDNOPRO     WNOPRO
     C  N08
     COR OA                EXCPTERRTET
     C                     EXCPTERRLIG
     C                     SETON                     08
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
     C/EJECT
    C*----------------------------------*
    C*   SOUS PROGRAMME ASSEMBLAGE      *
    C*----------------------------------*
    C           ASSEM     BEGSR
    C*                    ---------------
D1  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
D2  C           COAS      IFEQ 31
    C           COAS      OREQ 33
    C           COAS      OREQ 43
    C           COAS      OREQ 30
    C           COAS      OREQ 40
     C                     Z-ADD4         USFAB
X2  C                     ELSE
D3  C           COAS      IFEQ 60
    C           COAS      OREQ 61
    C           COAS      OREQ 62
     C                     Z-ADD5         USFAB
X3  C                     ELSE
D4  C           COAS      IFEQ 46
    C           COAS      OREQ 47
     C                     Z-ADD3         USFAB
X4  C                     ELSE
    C*          COAS      IFEQ 44
    C*                    Z-ADD2         USFAB
    C*                    ELSE
D5  C           COAS      IFEQ 24
    C           COAS      OREQ 26
    C           COAS      OREQ 27
    C           COAS      OREQ 28
    C           COAS      OREQ 38
    C           COAS      OREQ 39
D6  C           SUVENT    IFGT 500
    C           UVENT     ANDNE5
    C           CCOL      ANDNE0
    C           SUVENT    ORGT 0,500
    C           UVENT     ANDEQ5
    C           CCOL      ANDNE0
D7  C           IMPEXT    IFEQ 1
    C           IMPEXT    OREQ 4
    C           IMPINT    OREQ 1
    C           IMPINT    OREQ 4
X7  C                     ELSE
     C                     Z-ADD5         USFAB
F7  C                     END
F6  C                     END
F5  C                     END
D5  C           COAS      IFEQ 23
    C           COAS      OREQ 24
D6  C           QTFAB     IFGE 300000
D7  C           CCOL      IFEQ 0
    C           CCOL      OREQ 4
    C           CCOL      OREQ 5
    C           CCOL      OREQ 7
     C                     Z-ADD7         USFAB
F7  C                     END
F6  C                     END
F5  C                     END
    C*                    END
F4  C                     END
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
     C                     Z-ADDUSINE     USFAB
F1  C                     END
    C* FEGERSHEIM
    C*--------------------
    C*
    C* Cas particulier sur le code 'E' Giropack
D1  C           CDE       IFEQ 1
D2  C           PLIA      IFEQ 'E'
     C                     Z-ADD7         USFAB
     C                     MOVE '06'      NOMAC
    C                     GOTO FASSEB
F2  C                     END
F1  C                     END
    C*
D1  C           USFAB     IFEQ 7
D2  C           DSGP      IFEQ 'AB'
     C                     MOVE '02'      NOMAC
D3  C           CDE       IFEQ 1
     C                     MOVE '06'      NOMAC
F3  C                     END
X2  C                     ELSE
     C                     MOVE '06'      NOMAC
F2  C                     END
    C                     GOTO FASSEM
F1  C                     END
    C* CHABANAIS GARDE POUR FACILITÉ
    C*-------------------------------
D1  C           USFAB     IFEQ 5
D2  C           COAS      IFEQ 60
    C           COAS      OREQ 61
    C           COAS      OREQ 62
     C                     MOVE '15'      NOMAC
     C                     Z-ADD2         USFAB
X2  C                     ELSE
     *DEMANDE DE GUY LE 07/12/2012
    C*                    MOVE '08'      NOMAC
    C*                    Z-ADD3         USFAB
     C                     MOVE '04'      NOMAC
     C                     Z-ADD7         USFAB
F2  C                     END
    C                     GOTO FASSEM
F1  C                     END
    C* TOURY
    C*--------------------
D1  C           USFAB     IFEQ 3
    C*          CCOL      IFEQ 9
    C*                    MOVE '01'      NOMAC
    C*                    ELSE
    C*                    MOVE '02'      NOMAC
    C*                    END
    C*          COAS      IFEQ 45
    C*                    MOVE '05'      NOMAC
    C*                    END
D2  C           COAS      IFEQ 48
     C                     MOVE '48'      NOMAC
F2  C                     END
    C*
D2  C           COAS      IFEQ 46
     C                     MOVE '06'      NOMAC
F2  C                     END
D2  C           COAS      IFEQ 47
     C                     MOVE '09'      NOMAC
F2  C                     END
    C                     GOTO FASSEM
F1  C                     END
    C* ROCHECHOUART
    C*--------------------
D1  C           USFAB     IFEQ 2
D2  C           COAS      IFEQ 50
     C                     MOVE '50'      NOMAC
    C                     GOTO FASSEB
F2  C                     END
    C* TMAFBU 27/10/2015
D2  C           COAS      IFEQ 83
     C                     MOVE '01'      NOMAC
    C                     GOTO FASSEB
F2  C                     END
    C*
    C*          COAS      IFEQ 41
    C*          COAS      OREQ 42
    C*                    MOVE '01'      NOMAC
    C*                    GOTO FASSEB
    C*                    END
    C*
    C*          COAS      IFEQ 43
    C*                    MOVE '10'      NOMAC
    C*                    GOTO FASSEB
    C*                    END
    C*                           <
    C*          COAS      IFEQ 44
    C*          SCOAS1    IFEQ 40
    C*          SCOAS1    OREQ 42
    C*                    MOVE '10'      NOMAC
    C*                    ELSE
    C*          DSGP      IFEQ 'AB'
    C*                    MOVE '05'      NOMAC
    C*                    ELSE
    C*                    MOVE '04'      NOMAC
    C*                    END
    C*                    END
    C*                    GOTO FASSEB
    C*                    END
    C*
    C*          COAS      IFEQ 45
    C*                    MOVE '03'      NOMAC
    C*                    GOTO FASSEB
    C*                    END
    C*
D2  C           ENCA      IFEQ '*'
    C*          ETIQ      ORNE ' '
     C                     MOVE '08'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           RELC      IFNE *BLANKS
    C           MTPS      ORNE *BLANKS
D3  C           AXES      IFLE 400
     C                     MOVE '08'      NOMAC
X3  C                     ELSE
D4  C           DSGP      IFEQ 'AB'
     C                     MOVE '05'      NOMAC
X4  C                     ELSE
     C                     MOVE '08'      NOMAC
F4  C                     END
F3  C                     END
    C                     GOTO FASSEM
F2  C                     END
    C*
    C*          COAS      IFEQ 31
    C*                    MOVE '42'      NOMAC
    C*                    GOTO FASSEM
    C*                    END
    C*
    C*          COAS      IFEQ 33
    C*                    MOVE '44'      NOMAC
    C*                    GOTO FASSEM
    C*                    END
    C*
D2  C           COAS      IFEQ 39
    C           COAS      OREQ 26
     C                     MOVE '08'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 38
     C                     MOVE '08'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 37
     C                     MOVE '18'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 23
D3  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
    C           AXES      ANDLE490
    C           PASS      ANDLE600
    C           ONDUL     OREQ 4
    C           AXES      ANDLE490
    C           PASS      ANDLE600
     C                     MOVE '12'      NOMAC
X3  C                     ELSE
     C                     MOVE '08'      NOMAC
F3  C                     END
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 36
     C                     MOVE '08'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
    C*          COAS      IFEQ 30
    C*                    MOVE '04'      NOMAC
    C*                    GOTO FASSEM
    C*                    END
    C*
D2  C           COAS      IFEQ 24
D3  C           ONDUL     IFEQ 4
    C           AXES      ANDLE490
    C           PASS      ANDLE600
     C                     MOVE '12'      NOMAC
    C                     GOTO FASSEB
F3  C                     END
D3  C           USINE     IFEQ 2
    C           USINE     OREQ 4
    C           USINE     OREQ 5
    C           USINE     OREQ 7
D4  C           PLIA      IFEQ 'A'
    C           PLIA      OREQ 'B'
    C           PLIA      OREQ ' '
D5  C           PASS      IFLE 500
    C           TOTGRA    ANDGT320
D6  C           CCOL      IFEQ 1
    C           CCOL      OREQ 3
D7  C           DSGP      IFEQ 'AB'
     C                     MOVE '05'      NOMAC
X7  C                     ELSE
     C                     MOVE '02'      NOMAC
     C                     Z-ADD7         USFAB
D8  C           CDE       IFEQ 1
     C                     MOVE '06'      NOMAC
    C* TMAFBU LE 14/04/2016 INC0349215
D9  C           ONDUL     IFEQ 2
     C                     MOVE '18'      NOMAC
     C                     Z-ADD2         USFAB
    C                     GOTO FASSEB
F9  C                     END
F8  C                     END
F7  C                     END
    C                     GOTO FASSEB
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           CCOL      IFEQ 0
    C           CCOL      OREQ 4
    C           CCOL      OREQ 5
    C           CCOL      OREQ 7
D4  C           AXES      IFLE 490
    C           PASS      ANDLE600
     C                     MOVE '12'      NOMAC
    C                     GOTO FASSEB
F4  C                     END
F3  C                     END
D3  C           AXES      IFLE 320
D4  C           ONDUL     IFEQ 0
    C           ONDUL     OREQ 1
    C           ONDUL     OREQ 7
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
     C                     MOVE '08'      NOMAC
F4  C                     END
X3  C                     ELSE
D4  C           COLA      IFEQ 'H'
    C           COLA      OREQ 'M'
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
     C                     MOVE '08'      NOMAC
F4  C                     END
F3  C                     END
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 27
D3  C           ONDUL     IFEQ 0
    C           ONDUL     OREQ 4
    C           ONDUL     OREQ 1
    C           ONDUL     OREQ 7
D4  C           AXES      IFLE 320
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
D5  C           COLA      IFEQ 'M'
    C           COLA      OREQ 'H'
     C                     MOVE '08'      NOMAC
X5  C                     ELSE
     C                     MOVE '08'      NOMAC
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           AXES      IFLE 320
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
D5  C           COLA      IFEQ 'M'
    C           COLA      OREQ 'H'
     C                     MOVE '08'      NOMAC
X5  C                     ELSE
     C                     MOVE '08'      NOMAC
F5  C                     END
F4  C                     END
F3  C                     END
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 28
D3  C           COLA      IFEQ 'M'
    C           COLA      OREQ 'H'
D4  C           AXES      IFLE 680
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
     C                     MOVE '08'      NOMAC
F4  C                     END
X3  C                     ELSE
D4  C           AXES      IFLE 400
     C                     MOVE '08'      NOMAC
X4  C                     ELSE
     C                     MOVE '08'      NOMAC
F4  C                     END
F3  C                     END
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 16
     C                     MOVE '11'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
    C*          COAS      IFEQ 40
    C*                    MOVE '10'      NOMAC
    C*                    GOTO FASSEM
    C*                    END
    C*
     C                     MOVE '  '      NOMAC
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD31        ERR1,A           MSG.31
     C   80                MOVE COAS      ERR2,A
F1  C                     END
    C* NEUVILLE
    C*--------------------
D1  C           USFAB     IFEQ 4
    C*
D2  C           CDE       IFEQ 1
D3  C           COAS      IFEQ 31
     C                     MOVE '01'      NOMAC
    C                     GOTO FASSEM
F3  C                     END
D3  C           COAS      IFEQ 33
    C           COAS      OREQ 30
     C                     MOVE '02'      NOMAC
    C                     GOTO FASSEM
F3  C                     END
D3  C           COAS      IFEQ 43
    C           COAS      OREQ 40
     C                     MOVE '10'      NOMAC
    C                     GOTO FASSEM
F3  C                     END
F2  C                     END
    C*
D2  C           COAS      IFEQ 36
     C                     MOVE '06'      NOMAC            AV 05
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           ENCA      IFEQ '*'
     C                     MOVE '06'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           PATS      IFEQ 'D'
     C                     MOVE '01'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           RELC      IFNE *BLANKS
    C           MTPS      ORNE *BLANKS
     C                     MOVE '06'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFNE 31
D3  C           COAS      IFNE 33
D4  C           COLA      IFEQ 'M'
    C           COLA      OREQ 'H'
     C                     MOVE '01'      NOMAC
    C                     GOTO FASSEM
F4  C                     END
F3  C                     END
F2  C                     END
    C*
D2  C           ONDUL     IFEQ 0
     C                     MOVE '06'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 24
     C                     MOVE '06'      NOMAC            AV 05
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 30
    C           COAS      OREQ 33
     C                     MOVE '02'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 39
    C           COAS      OREQ 23
    C           COAS      OREQ 28
     C                     MOVE '06'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 26
    C           COAS      OREQ 27
    C           COAS      OREQ 31
     C                     MOVE '01'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
D2  C           COAS      IFEQ 16
     C                     MOVE '04'      NOMAC
    C                     GOTO FASSEM
F2  C                     END
    C*
     C                     MOVE '  '      NOMAC
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C   80                Z-ADD31        ERR1,A           MSG.31
     C   80                MOVE COAS      ERR2,A
F1  C                     END
    C*
     C           FASSEM    TAG
D1  C           CDE       IFEQ 1
D2  C           NOMAC     IFEQ '04'
    C           USFAB     ANDNE7
    C           NOMAC     OREQ '07'
    C           USFAB     ANDNE5
D3  C           USFAB     IFNE 4
     C                     MOVE '08'      NOMAC
X3  C                     ELSE
     C                     MOVE '08'      NOMAC
F3  C                     END
F2  C                     END
F1  C                     END
    C*
    C           FASSEB    ENDSR
     C/EJECT
     *-----------------------------------------*
     * prix colle contre-collage au 100 m2 .   *
     *-----------------------------------------*
    C           DULDA     BEGSR
    C*          ---------------
D1  C           CCOL      IFEQ 1
    C           CCRR      OREQ 1
     C                     Z-ADDCOLCC     COLCCO  62
D2  C           COLRH     IFEQ 'VP'
     C                     Z-ADDCOLCSP    COLCCO
F2  C                     END
D2  C           ONDUL     IFEQ 6
     C           COLCCO    MULT 1,20      COLCCO
F2  C                     END
D2  C           ONDUL     IFEQ 4
     C                     MULT 1,20      COLCCO
     C                     MULT 1,15      COLCCO
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 4
D2  C           COLRH     IFEQ 'PE'
     C                     Z-ADDFILL13    COLCCO
F2  C                     END
D2  C           COLRH     IFEQ 'PL'
     C                     Z-ADDFILL15    COLCCO
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 7
D2  C           COLRH     IFEQ 'HM'
     C                     Z-ADDFILL12    COLCCO
F2  C                     END
D2  C           COLRH     IFEQ 'PE'
     C                     Z-ADDFILL13    COLCCO
F2  C                     END
D2  C           COLRH     IFEQ 'PL'
     C                     Z-ADDFILL15    COLCCO
F2  C                     END
D2  C           COLRH     IFEQ 'VY'
     C                     Z-ADDFILL3     COLCCO
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 5
     C                     Z-ADDCOLAFF    COLCCO
F1  C                     END
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
D2  C           DEPCOL    IFNE *ZEROS
D3  C           COLRH     IFEQ 'PL'
     C           DEPCOL    DIV  3,5       RDCOL   42
X3  C                     ELSE
     C           DEPCOL    DIV  20        RDCOL
F3  C                     END
D3  C           RDCOL     IFEQ 0
     C                     Z-ADD1         RDCOL
F3  C                     END
     C           COLCCO    MULT RDCOL     COLCCO
D3  C           COLRH     IFEQ 'PL'
     C           LZPEUT    DIV  LZRAP     RDCOL     H
D4  C           RDCOL     IFEQ 0
     C                     Z-ADD1         RDCOL
F4  C                     END
     C           COLCCO    MULT RDCOL     COLCCO
F3  C                     END
F2  C                     END
     C                     Z-ADDCOLCCO    COLCOM
X1  C                     ELSE
     C                     Z-ADDCOLCCO    COLVIN
F1  C                     END
     C                     ADD  COLCCO    COUDIR  62
     C           COLCCO    MULT KMATA     COLCCO    H
     C                     ADD  COLCCO    COLLE
    C                     ENDSR
     *-----------------------------------------*
     * prix colle CANNELURES CROISSÉES         *
     *-----------------------------------------*
    C           DULDB     BEGSR
    C*          ---------------
     * COLLE ONDULATION  1° PASSAGE
D1  C           COLRH     IFEQ '  '
    C           COLRH     OREQ 'RH'
    C           COLRH     OREQ 'VP'
    C           COLRH     OREQ 'AM'
    C           COLRH     OREQ 'BT'
     *
D2  C           GRONCC    IFGE 300
D3  C           COUI3     IFEQ 1
D4  C           DD1       IFEQ 1
    C           DD1       OREQ 6
    C           DD1       OREQ 4
     C                     Z-ADDCOSFMC    COLON1
D5  C           DD1       IFEQ 6
     C                     MULT 1,20      COLON1    H
F5  C                     END
D5  C           DD1       IFEQ 4
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,15      COLON1    H
F5  C                     END
F4  C                     END
D4  C           DD1       IFEQ 2
     C                     Z-ADDCOSFPC    COLON1
F4  C                     END
D4  C           DD1       IFEQ 3
     C                     Z-ADDCOSFGC    COLON1
F4  C                     END
F3  C                     END
     *
D3  C           COUI3     IFEQ 3
D4  C           DD1       IFEQ 1
    C           DD1       OREQ 6
    C           DD1       OREQ 4
     C                     Z-ADDCODFMC    COLON1
D5  C           DD1       IFEQ 6
     C                     MULT 1,20      COLON1    H
F5  C                     END
D5  C           DD1       IFEQ 4
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,15      COLON1    H
F5  C                     END
F4  C                     END
D4  C           DD1       IFEQ 2
     C                     Z-ADDCODFPC    COLON1
F4  C                     END
F3  C                     END
    C*
X2  C                     ELSE
D3  C           COUI3     IFEQ 1
D4  C           DD1       IFEQ 1
    C           DD1       OREQ 6
    C           DD1       OREQ 4
     C                     Z-ADDCOOND1    COLON1
D5  C           DD1       IFEQ 6
     C                     MULT 1,20      COLON1    H
F5  C                     END
D5  C           DD1       IFEQ 4
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,15      COLON1    H
F5  C                     END
F4  C                     END
D4  C           DD1       IFEQ 2
     C                     Z-ADDCOOND2    COLON1
F4  C                     END
D4  C           DD1       IFEQ 3
     C                     Z-ADDCOOND3    COLON1
F4  C                     END
F3  C                     END
D3  C           COUI3     IFEQ 3
D4  C           DD1       IFEQ 1
    C           DD1       OREQ 6
    C           DD1       OREQ 4
     C                     Z-ADDCOOND4    COLON1
D5  C           DD1       IFEQ 6
     C                     MULT 1,20      COLON1    H
F5  C                     END
D5  C           DD1       IFEQ 4
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,15      COLON1    H
F5  C                     END
F4  C                     END
D4  C           DD1       IFEQ 2
     C                     Z-ADDCOOND5    COLON1
F4  C                     END
F3  C                     END
     *
D3  C           COLRH     IFEQ 'RH'
     C                     Z-ADDCOLOND    COLAMY
     C                     MULT RH        COLON1    H
F3  C                     END
F2  C                     END
     *
X1  C                     ELSE
D2  C           DD1       IFEQ 1
D3  C           COLRH     IFEQ 'BH'
     C                     Z-ADDFILL12    COLVIN
X3  C                     ELSE
     C                     Z-ADDCOVYMC    COLVIN
F3  C                     END
     C                     Z-ADDCOSFMC    COLON1
X2  C                     ELSE
D3  C           COLRH     IFEQ 'BH'
     C                     Z-ADDFILL3     COLVIN
X3  C                     ELSE
     C                     Z-ADDCOVYPC    COLVIN
F3  C                     END
     C                     Z-ADDCOSFPC    COLON1
F2  C                     END
D2  C           COLRH     IFEQ 'VH'
    C           COLRH     OREQ 'BH'
     C                     MULT RHPLUS    COLON1    H
F2  C                     END
D2  C           DD1       IFEQ 6
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,20      COLVIN    H
F2  C                     END
D2  C           DD1       IFEQ 4
     C                     MULT 1,20      COLON1    H
     C                     MULT 1,15      COLON1    H
     C                     MULT 1,20      COLVIN    H
     C                     MULT 1,15      COLVIN    H
F2  C                     END
     *
F1  C                     END
     *
D1  C           COUI3     IFEQ 1
     C                     Z-ADDCOLCC     COLCC1  62
D2  C           COLRH     IFEQ 'VP'
     C                     Z-ADDCOLCSP    COLCC1
F2  C                     END
D2  C           DD1       IFEQ 6
     C                     MULT 1,20      COLCC1
F2  C                     END
D2  C           DD1       IFEQ 4
     C                     MULT 1,20      COLCC1
     C                     MULT 1,15      COLCC1
F2  C                     END
F1  C                     END
     * 2° CONTRECOLLAGE
D1  C           GRAOND    IFGE 300
D2  C           DD2       IFEQ 1
    C           DD2       OREQ 6
    C           DD2       OREQ 4
     C                     Z-ADDCOSFMC    COLON2
D3  C           DD2       IFEQ 6
     C                     MULT 1,20      COLON2    H
F3  C                     END
D3  C           DD2       IFEQ 4
     C                     MULT 1,20      COLON2    H
     C                     MULT 1,15      COLON2    H
F3  C                     END
F2  C                     END
D2  C           DD2       IFEQ 2
     C                     Z-ADDCOSFPC    COLON2
F2  C                     END
D2  C           DD2       IFEQ 3
     C                     Z-ADDCOSFGC    COLON2
F2  C                     END
     *
X1  C                     ELSE
D2  C           DD2       IFEQ 1
    C           DD2       OREQ 6
    C           DD2       OREQ 4
     C                     Z-ADDCOOND1    COLON2
D3  C           DD2       IFEQ 6
     C                     MULT 1,20      COLON2    H
F3  C                     END
D3  C           DD2       IFEQ 4
     C                     MULT 1,20      COLON2    H
     C                     MULT 1,15      COLON2    H
F3  C                     END
F2  C                     END
D2  C           DD2       IFEQ 2
     C                     Z-ADDCOOND2    COLON2
F2  C                     END
D2  C           DD2       IFEQ 3
     C                     Z-ADDCOOND3    COLON2
F2  C                     END
F1  C                     END
    C*
     C                     Z-ADDCOLCC     COLCC2  62
D1  C           DD2       IFEQ 6
     C                     MULT 1,20      COLCC2
F1  C                     END
D1  C           DD2       IFEQ 4
     C                     MULT 1,20      COLCC2
     C                     MULT 1,15      COLCC2
F1  C                     END
     *
     C           COLON1    ADD  COLON2    COLOND
     C                     ADD  COLVIN    COLOND
     C                     ADD  COLOND    COUDIR
     C           COLOND    MULT KMATA     COLONK  62H
     C                     ADD  COLONK    COLLE   62       COLLE
     C                     ADD  COLCC1    COLVIN
     C                     ADD  COLCC2    COLVIN
     C                     ADD  COLCC1    COLCCO
     C                     ADD  COLCC2    COLCCO
     C                     ADD  COLCCO    COUDIR  62
     C           COLCCO    MULT KMATA     COLCCO    H
     C                     ADD  COLCCO    COLLE
    C                     ENDSR
     C/EJECT
     *-----------------------------------------*
     * APPLICATION COEFFICIENT ET PONDERATION  *
     *-----------------------------------------*
    C           KOEFF     BEGSR
    C*          ---------------
     C                     SETOF                     89
     C                     Z-ADD1         W       20
     C           WSS       LOKUPTSS,W                    80
D1  C           *IN80     IFEQ '1'
    C*
D2  C           PRD,W     IFNE *ZEROS
     C                     Z-ADDPRD,W     PRDW    32
     C                     SETON                     89
X2  C                     ELSE
     C                     Z-ADD1         PRDW
F2  C                     END
D2  C           PRG,W     IFNE *ZEROS
     C                     Z-ADDPRG,W     PRGW    32
     C                     SETON                     89
X2  C                     ELSE
     C                     Z-ADD1         PRGW
F2  C                     END
     C           PRDW      MULT PRGW      PREG
    C*
D2  C           PRO,W     IFNE 0
     C           TPSTOT    MULT PRO,W     TPSTOT    H
     C           MOYCAD    DIV  PRO,W     MOYCAD    H
     C                     Z-ADDPRO,W     DIFF
X2  C                     ELSE
D3  C           TOTTPS    IFNE 0
     C                     Z-ADDTOTTPS    TPSTOT
     C                     Z-ADDCADMOY    MOYCAD
F3  C                     END
F2  C                     END
    C*
D2  C           DECR      IFNE 0
     C                     Z-ADDDECR      REDEC
F2  C                     END
     *
D2  C           *IN89     IFEQ '1'
     C           RETPS     MULT PREG      RETPS     H
     C           NETPS     MULT PREG      NETPS     H
D3  C           SECT      IFEQ '1'                         IMPRESSION
     C           REDEC     MULT PREG      REDEC
F3  C                     END
D3  C           PREG      IFGE 1
     C                     ADD  REPART    RETPS
     C                     ADD  NEPART    NETPS
X3  C                     ELSE
D4  C           SECT      IFNE '1'                         PAS IMPRESSION
     C           REDEC     MULT PREG      REDEC
F4  C                     END
D4  C           SECT      IFEQ '5'                         DECOUPAGE
    C           WSS       ANDNE6                           PAS GAUFRAGE
    C           WSS       ANDNE66                          PAS GAUFRAGE
     C                     SETOF                     80
D5  C           AMREG     IFLT *ZEROS
     C                     Z-SUBAMREG     AMREGP  52
     C           AMREGP    COMP RETPS                80
F5  C                     END
     C  N80                ADD  AMREG     RETPS
X4  C                     ELSE
     C                     ADD  AMREG     RETPS
F4  C                     END
     C                     ADD  AMNET     NETPS
F3  C                     END
X2  C                     ELSE
D3  C           WSS       IFNE 6                           PAS GAUFRAGE
    C           WSS       ANDNE66                          PAS GAUFRAGE
D4  C           TPSRE     IFNE 0
     C                     Z-ADDTPSRE     RETPS
F4  C                     END
D4  C           TPSNE     IFNE 0
     C                     Z-ADDTPSNE     NETPS
F4  C                     END
F3  C                     END
F2  C                     END
     *
D2  C           SECT      IFEQ '5'                         DECOUPAGE
    C           *IN90     ANDEQ'1'                         2° PASSAGE
     C           RETPS     MULT 0,10      RETPS     H
F2  C                     END
     *
D2  C           PDE,W     IFNE 0
     C                     Z-ADDPDE,W     MOYDEC
F2  C                     END
D2  C           PEF,W     IFNE 0
     C                     Z-ADDPEF,W     ROEFF
F2  C                     END
     *
F1  C                     END
    C                     ENDSR
     C/EJECT
     *-----------------------------------------*
     * PENALISER 20% CADENCE DECORTICAGE       *
     *-----------------------------------------*
    C           KOARI     BEGSR
    C*          ---------------
D1  C           USFAB     IFEQ 3
    C           MOYCAD    ANDNE0
     C                     MOVE DSGP      PDSGP
     C                     Z-ADDANDEV     PANDEV
     C                     Z-ADDETUDE     PETUDE
     C                     Z-ADDSEQDE     PSEQDE
     C                     CALL 'DEV074L'
     C                     PARM           DEV074
D2  C           PTYPE     IFEQ 'A'
     C                     MULT 0,8       MOYCAD
     C           QTENET    DIV  MOYCAD    TPSTOT
F2  C                     END
F1  C                     END
    C                     ENDSR
     *-----------------------------------------*
     * CHARGEMENT ZONES IMPRESSION             *
     *-----------------------------------------*
    C           CHIMP     BEGSR
    C*          ---------------
D1  C           *IN96     IFEQ '1'                        INTERIEUR
    C           *IN86     OREQ '1'
     C                     Z-ADDSUPINT    S
     C                     MOVE TVEIN     TVER    1
     C                     MOVE TVEINR    RVER    1
     C                     MOVE ORIN      ORCU    2
     C                     MOVE ORINR     ORCUR   2
     C                     MOVE UVINT     UV      1
     C                     MOVE UVINTR    RUV     1
     C                     MOVE COUPIN    COUPE   1
D2  C           GRPIN     IFEQ *ZEROS
     C                     Z-ADDCOUIN     COUL    20
X2  C                     ELSE
     C                     Z-ADDGRPIN     COUL
F2  C                     END
D2  C           GRPINR    IFEQ *ZEROS
     C                     Z-ADDCOUINR    RCOU    10
X2  C                     ELSE
     C                     Z-ADDGRPINR    RCOU
F2  C                     END
     C  N86 96             Z-ADDIMPINT    TIMP    10
     C   86                Z-ADDRIMPIN    TIMP
     C  N86 96             Z-ADDGP1IN     OFP1    10
     C  N86 96             Z-ADDGP2IN     OFP2    10
     C  N86 96             Z-ADDGP3IN     OFP3    10
     C   86                Z-ADDGP1INR    OFP1
     C   86                Z-ADDGP2INR    OFP2
     C   86                Z-ADD*ZEROS    OFP3
     C                     MOVE TSINT     TS      1
     C  N86 96             MOVE DAPIN     APLA    1
     C   86                MOVE DAPINR    APLA
     C  N86 96             MOVE DDEIN     DDECOR  1
     C   86                MOVE DDEINR    DDECOR
     C                     MOVE NATIN     NATE    1
     C           ROUDEC    ADD  DECINT    ROUL    54
     C                     ADD  EXDECD    ROUL
     C                     ADD  INDECD    ROUL
     C                     MOVE SUPINT    SUIMP   10
F1  C                     END
D1  C           *IN97     IFEQ '1'                        EXTERIEUR
    C           *IN87     OREQ '1'
     C                     Z-ADDSUPEXT    S
     C                     MOVE TVEEX     TVER
     C                     MOVE TVEEXR    RVER
     C                     MOVE OREX      ORCU
     C                     MOVE OREXR     ORCUR
     C                     MOVE UVEXT     UV
     C                     MOVE UVEXTR    RUV
     C                     MOVE COUPEX    COUPE   1
D2  C           GRPEX     IFEQ *ZEROS
     C                     Z-ADDCOUEX     COUL    20
X2  C                     ELSE
     C                     Z-ADDGRPEX     COUL
F2  C                     END
D2  C           GRPEXR    IFEQ *ZEROS
     C                     Z-ADDCOUEXR    RCOU
X2  C                     ELSE
     C                     Z-ADDGRPEXR    RCOU
F2  C                     END
     C  N87 97             Z-ADDIMPEXT    TIMP
     C   87                Z-ADDRIMPEX    TIMP
     C  N87 97             Z-ADDGP1EX     OFP1
     C  N87 97             Z-ADDGP2EX     OFP2
     C  N87 97             Z-ADDGP3EX     OFP3
     C   87                Z-ADDGP1EXR    OFP1
     C   87                Z-ADDGP2EXR    OFP2
     C   87                Z-ADD*ZEROS    OFP3
     C                     MOVE TSEXT     TS
     C  N87 97             MOVE DAPEX     APLA
     C   87                MOVE DAPEXR    APLA
     C  N87 97             MOVE DDEEX     DDECOR  1
     C   87                MOVE DDEEXR    DDECOR
     C                     MOVE NATEX     NATE
     C           ROUDEC    ADD  DECEXT    ROUL
     C                     ADD  EXDECD    ROUL
     C                     ADD  INDECD    ROUL
     C                     MOVE SUPEXT    SUIMP
F1  C                     END
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * MISE A BLANV SDS POUR CADDEC
     * ----------------------------------------------------- *
    C           BLKDS     BEGSR
     *          ----------------       -
     *  formatage des zones de data structures du fichier "cadec" .
     C                     MOVE *BLANKS   DSHELI
     C                     MOVE *BLANKS   DSFLEX
     C                     MOVE *BLANKS   DSJAGE
     C                     MOVE *BLANKS   DSOFFS
     C                     MOVE *BLANKS   DSOND
     C                     MOVE *BLANKS   DSCCOL
     C                     MOVE *BLANKS   DSCOMP
     C                     MOVE *BLANKS   DSTYPO
     C                     MOVE *BLANKS   DSAUTO
     C                     MOVE *BLANKS   DSJURI
     C                     MOVE *BLANKS   DSDECA
     C                     MOVE *BLANKS   DSDCOR
     C                     MOVE *BLANKS   DSFEN
     C                     MOVE *BLANKS   DSPLIE
     C                     MOVE *BLANKS   DSPOIG
     C                     MOVE *BLANKS   DSBOBI
     C                     MOVE *BLANKS   DSDOR
     C                     MOVE *BLANKS   DSOEI
     C                     Z-ADD0         HELCOU
     C                     Z-ADD0         FLECOU
     C                     Z-ADD0         JAGGRA
     C                     Z-ADD0         JAGDEV
     C                     Z-ADD0         JAGLAI
     C                     Z-ADD0         OFFCOU
     C                     Z-ADD0         ONDCOL
     C                     Z-ADD0         ONDOND
     C                     Z-ADD0         ONDFAC
     C                     Z-ADD0         ONDGRA
     C                     Z-ADD0         COLCOL
     C                     Z-ADD0         COLON
     C                     Z-ADD0         TYPCOU
     C                     Z-ADD0         TYPEN
     C                     Z-ADD0         SPOND
     C                     Z-ADD0         SPCC
     C                     Z-ADD0         SPPOSE
     C                     Z-ADD0         JUOND
     C                     Z-ADD0         JUCC
     C                     Z-ADD0         JUPOSE
     C                     Z-ADD0         DECOND
     C                     Z-ADD0         DECCC
     C                     Z-ADD0         DECUNI
     C                     Z-ADD0         DCOOND
     C                     Z-ADD0         DCOCC
     C                     Z-ADD0         DCOPOS
     C                     Z-ADD0         FENPAS
     C                     Z-ADD0         FENGAI
     C                     Z-ADD0         ASSCOD
     C                     Z-ADD0         ASSOND
     C                     Z-ADD0         ASSCC
     C                     Z-ADD0         ASSPAS
     C                     Z-ADD0         ERTCOD
     C                     Z-ADD0         COMCOL
     C                     Z-ADD0         COMGR
     C                     Z-ADD0         BOBIGR
     C                     Z-ADD0         BOBIPO
     C                     Z-ADD0         BOBILA
     C                     Z-ADD0         DORPOS
     C                     Z-ADD0         OEINBO
     C                     Z-ADD0         OEINBA
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * recherche des objectifs de production
     * ----------------------------------------------------- *
    C           OBJPRO    BEGSR
     *          ----------------       --ecriture des objectif sed.--
     C                     Z-ADD0         WREDEC
     C                     Z-ADD0         WOYDEC
     C                     Z-ADD0         WRETPS
     C                     Z-ADD0         WNETPS
     C                     Z-ADD0         WTPSTO
     C                     Z-ADD0         WMOYCA
     C                     Z-ADD0         WREEFF
     C                     Z-ADD0         WNEEFF
     C                     Z-ADD0         WROEFF
     C                     MOVE *BLANKS   WLIBTR
     C                     MOVE 'Z'       GG
D1  C           YREDEC    IFNE REDEC
     C                     Z-ADDREDEC     WREDEC
F1  C                     END
D1  C           YOYDEC    IFNE MOYDEC
     C                     Z-ADDMOYDEC    WOYDEC
F1  C                     END
D1  C           YRETPS    IFNE RETPS
     C                     Z-ADDRETPS     WRETPS
F1  C                     END
D1  C           YNETPS    IFNE NETPS
     C                     Z-ADDNETPS     WNETPS
F1  C                     END
D1  C           YTPSTO    IFNE TPSTOT
     C                     Z-ADDTPSTOT    WTPSTO
F1  C                     END
D1  C           YMOYCA    IFNE MOYCAD
     C                     Z-ADDMOYCAD    WMOYCA
F1  C                     END
D1  C           YREEFF    IFNE REEFF
     C                     Z-ADDREEFF     WREEFF
F1  C                     END
D1  C           YNEEFF    IFNE NEEFF
     C                     Z-ADDNEEFF     WNEEFF
F1  C                     END
D1  C           YROEFF    IFNE ROEFF
     C                     Z-ADDROEFF     WROEFF
F1  C                     END
     C                     WRITEOBJCASF1
    C                     ENDSR
     C/EJECT
     * ----------------------------------------------------- *
     * Valorisation du complexe intégré   1°
     * ----------------------------------------------------- *
    C           VALCX1    BEGSR
     *          ----------------
     C  N75      CLEPRE    SETLLCXHLIGL2
     C  N75                Z-ADD*ZEROS    CUMCOB  62
     C           SVALCX    TAG
    C*          ---------------
     C           CLEPRE    READECXHLIGL2                 80
D1  C           *IN80     IFEQ '0'
D2  C           RSIECX    IFEQ SUPCXH
     C                     MOVE QUACXH    QUAPAE
     C                     Z-ADDGRACXH    GRAPAE
     C                     MOVE ADPCXH    ADPPAE
     C                     Z-ADDADGCXH    ADGPAE
F2  C                     END
D2  C           RSIICX    IFEQ SUPCXH
     C                     MOVE QUACXH    QUAPAI
     C                     Z-ADDGRACXH    GRAPAI
     C                     MOVE ADPCXH    ADPPAI
     C                     Z-ADDADGCXH    ADGPAI
F2  C                     END
D2  C           PASCXH    IFEQ 1
     C                     ADD  GRACXH    TOTGR1  30
F2  C                     END
D2  C           PASCXH    IFEQ 2
     C                     ADD  GRACXH    TOTGR2  30
F2  C                     END
D2  C           PASCXH    IFEQ 3
     C                     ADD  GRACXH    TOTGR3  30
F2  C                     END
D2  C           SUPCXH    IFEQ 'F'
D3  C           QUACXH    IFEQ 'PE'
     C                     Z-ADDFILL13    COLCXH  52
D4  C           CORCXH    IFNE *BLANK                     6 AU 100M2
     C                     ADD  1         COLCXH           PAR COULEUR
F4  C                     END
D4  C           COVCXH    IFNE *BLANK
     C                     ADD  1         COLCXH
F4  C                     END
     C           GRACXH    DIV  20        GCXH    42       DEPOT MOYEN 20G
     C                     MULT GCXH      COLCXH
     C                     ADD  COLCXH    CUMCOB  62
    C                     GOTO SVALCX
F3  C                     END
D3  C           QUACXH    IFEQ 'PL'
     C                     Z-ADDFILL15    COLCXH  52
D4  C           CORCXH    IFNE *BLANK                     6 AU 100M2
     C                     ADD  1         COLCXH           PAR COULEUR
F4  C                     END
D4  C           COVCXH    IFNE *BLANK
     C                     ADD  1         COLCXH
F4  C                     END
     C           GRACXH    DIV  3,5       GCXH    42       DEPOT MOYEN 20G
     C                     MULT GCXH      COLCXH
     C           LZPEUT    DIV  LZRAP     RDCOL     H
D4  C           RDCOL     IFEQ 0
     C                     Z-ADD1         RDCOL
F4  C                     END
     C           COLCXH    MULT RDCOL     COLCXH
     C                     ADD  COLCXH    CUMCOB  62
    C                     GOTO SVALCX
F3  C                     END
X2  C                     ELSE
D3  C           SUPEXT    IFEQ S
    C           IMPEXT    ANDLT4
    C           SUPINT    OREQ S
    C           IMPINT    ANDLT4
D4  C           *IN77     IFEQ '1'
D5  C           SUPCXH    IFEQ RSIECX
D6  C           APIECX    IFEQ 'N'
     C                     Z-ADD2         USCXH
X6  C                     ELSE
     C                     Z-ADDUSEXT     USCXH
F6  C                     END
X5  C                     ELSE
     C                     Z-ADD2         USCXH
F5  C                     END
X4  C                     ELSE
D5  C           SUPCXH    IFEQ RSIICX
D6  C           APIICX    IFEQ 'N'
     C                     Z-ADD2         USCXH
X6  C                     ELSE
     C                     Z-ADDUSINT     USCXH
F6  C                     END
X5  C                     ELSE
     C                     Z-ADD2         USCXH
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADD2         USCXH
F3  C                     END
     C                     SETON                     75
D3  C           PELPEL    IFEQ 'PEL'
     C                     Z-ADD2         USCXH
     C                     Z-ADD1         RSUCXH  54
X3  C                     ELSE
D4  C           LMINI     IFEQ *ZEROS
D5  C           ONDL      IFEQ 0
     C                     Z-ADD1         RSUCXH  54
X5  C                     ELSE
     C           PASCXH    MULT 15        EBARBF  20
     C           ONDL      ADD  EBARBF    ONDLPA  40
     C           ONDLPA    DIV  ONDL      RSUCXH
F5  C                     END
X4  C                     ELSE
     C           PASCXH    MULT 1,5       EBARB   21
     C           LMINI     ADD  EBARB     LAIPAS  41
     C           LAIPAS    DIV  LMINI     RSUCXH
F4  C                     END
F3  C                     END
D3  C           ASPCXH    IFEQ 'F'
     C                     MOVE 'F'       FOUB
     C                     MOVE 'F'       FBCXH
X3  C                     ELSE
     C                     MOVE 'B'       FOUB
     C                     MOVE 'B'       FBCXH
F3  C                     END
F2  C                     END
F1  C                     END
     C   80                SETON                     78
    C                     ENDSR
     C/SPACE 3
     * ----------------------------------------------------- *
     * Valorisation du complexe intégré   2°
     * ----------------------------------------------------- *
    C           VALCX2    BEGSR
     *          ----------------
     C                     Z-ADDTTSTO     PAPSTO
     C                     Z-ADDTOTPR     PRUTOT
     C                     SETOF                     7578
D1  C           SUPEXT    IFEQ S
    C           IMPEXT    ANDEQ1
    C           SUPEXT    OREQ S
    C           IMPEXT    ANDEQ2
    C           SUPINT    OREQ S
    C           IMPINT    ANDEQ1
    C           SUPINT    OREQ S
    C           IMPINT    ANDEQ2
D2  C           S         IFLE 3
D3  C           APIECX    IFEQ 'O'
     C                     Z-ADDCUMCOB    COLCOM
X3  C                     ELSE
     C                     Z-ADDCUMCOB    FILEXB
F3  C                     END
X2  C                     ELSE
D3  C           APIICX    IFEQ 'O'
     C                     Z-ADDCUMCOB    COLCOM
X3  C                     ELSE
     C                     Z-ADDCUMCOB    FILINB
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           SUPEXT    IFEQ S
    C           IMPEXT    ANDEQ4
    C           SUPINT    OREQ S
    C           IMPINT    ANDEQ4
D3  C           S         IFLE 3
     C                     Z-ADDCUMCOB    FILEXB
X3  C                     ELSE
     C                     Z-ADDCUMCOB    FILINB
F3  C                     END
X2  C                     ELSE
     C                     Z-ADDCUMCOB    COLCOM
F2  C                     END
F1  C                     END
     C                     ADD  CUMCOB    CUMCOC  62
     C                     ADD  CUMCOB    COUDIR
     C                     MULT KMATA     CUMCOC
    C                     ENDSR
     C/SPACE 3
     * ----------------------------------------------------- *
     * Calcul PRIORI pour PLANIF
     * ----------------------------------------------------- *
    C           CALPRI    BEGSR
     *          ----------------
D1  C           *IN81     IFEQ '0'
     C                     Z-ADD90        PRIORI
X1  C                     ELSE
D2  C           USFAB     IFEQ USINE
     C                     Z-ADD95        PRIORI
X2  C                     ELSE
     C                     Z-ADD80        PRIORI
F2  C                     END
F1  C                     END
    C                     ENDSR
     C/SPACE 3
     * ----------------------------------------------------- *
     * Recherche machine si calcul PRU
     * ----------------------------------------------------- *
    C           RECMAC    BEGSR
     *          ----------------
     C                     Z-ADD*ZEROS    NOMAC1
     C                     Z-ADD*ZEROS    NOMAC2
     C                     Z-ADD*ZEROS    NOMAC3
     C                     MOVE USFAB     USP
     C                     MOVE SSECT     SSECTP
     C                     MOVE SECT      SECTP
D1  C           DSGP      IFEQ 'SP'                       SIMUL PRU
     C                     MOVE '*'       DEVISP
     C                     Z-ADD*ZEROS    STEP
     C                     Z-ADD*ZEROS    NOCLIP
     C                     Z-ADD*ZEROS    NOPROP
     C                     Z-ADDANDEV     ANDEVP
     C                     Z-ADDETUDE     ETUDEP
     C                     Z-ADDSEQDE     SEQDEP
X1  C                     ELSE
     C                     MOVE ' '       DEVISP
     C                     Z-ADDSTE       STEP
     C                     Z-ADDNOCLI     NOCLIP
     C                     Z-ADDNOPRO     NOPROP
     C                     Z-ADD*ZEROS    ANDEVP
     C                     Z-ADD*ZEROS    ETUDEP
     C                     Z-ADD*ZEROS    SEQDEP
F1  C                     END
    C*
     C                     CALL 'POOL02£'
     C                     PARM           POOL02
    C*
D1  C           NOMAC1    IFEQ *ZEROS
     C                     Z-ADD1         A
     C           *ZEROS    LOKUPERR1,A                   80
     C                     MOVE 30        ERR1,A
     C                     MOVE SS        ERR2,A
F1  C                     END
    C                     ENDSR
     C/EJECT
    C*-----------------------------------------
    C* CONTROLE TRI FINITION
     * ----------------------
    C           SPCTRI    BEGSR
    C*
     C                     ADD  1         R
     C                     MOVE '9'       SECT
     C                     MOVE '0'       SSECT
     C                     MOVE '00'      NOMAC
D1  C           CDE       IFEQ 1
     C                     Z-ADD2         USFAB
F1  C                     END
    C*
     C                     MOVE TVEI3     CTRTYP
     C                     MOVELSUVENT    CTRUNI
     C                     MOVELDSCTRI    CLEREC
     *
     C                     Z-ADDRAPDEC    ROUDEC  54
     C           QTFAB     MULT RAPDEC    QTENET  70H
     *
     C                     Z-ADD99        WWS
     C                     EXSR NORSTD                     NORMES STD
    C           GPTEST    CABNE' '       FSPCTR
     *
     C                     EXSR CALPRI
     C                     WRITEPLANIFF1
     *
     C                     MOVELMOYDEC    DECRO
     C           REDEC     MULT SBDEC     SREG
     C                     MOVELSREG      REGM2
     C                     ADD  REGM2     SUREG
     C                     ADD  DECRO     DECROU
     *
     C                     EXSR VALORI                     VALORISATION
    C           GPTEST    CABNE' '       FSPCTR
     *
     C                     EXSR RESULT                     CHAR.RESULTATS
     *
    C           FSPCTR    ENDSR
     C/EJECT
     **************************************************************
     * SOUS PROGRAMME POOL MACHINE SUR OFPAS                      *
     **************************************************************
    C           SPOOL1    BEGSR
     *
     C                     MOVEL'XPOOLMAC'TBLNOM
     C                     Z-ADD1         TBNSEG
     C                     MOVELUSFAB     XPOOA1
     C                     MOVEL'1'       XPOOA2
     C                     MOVEL'4'       XPOOA3
     * -------------
D1  C           TYPE1     IFGE 60
    C           TYPE1     ANDLE79
     C                     MOVELTYPE1     XPOOA4
     C                     MOVELXPOOKE    TBVARG
     C           KTBA01    CHAINXTBASE01             99
     C  N99                MOVELTBVRES    XPOO00
     C  N99                MOVELXPOO01    TYPE1
F1  C                     END
     *
D1  C           TYPE2     IFGE 60
    C           TYPE2     ANDLE79
     C                     MOVELTYPE2     XPOOA4
     C                     MOVELXPOOKE    TBVARG
     C           KTBA01    CHAINXTBASE01             99
     C  N99                MOVELTBVRES    XPOO00
     C  N99                MOVELXPOO01    TYPE2
F1  C                     END
     *
D1  C           TYPE3     IFGE 60
    C           TYPE3     ANDLE79
     C                     MOVELTYPE3     XPOOA4
     C                     MOVELXPOOKE    TBVARG
     C           KTBA01    CHAINXTBASE01             99
     C  N99                MOVELTBVRES    XPOO00
     C  N99                MOVELXPOO01    TYPE3
F1  C                     END
     *
D1  C           TYPE4     IFGE 60
    C           TYPE4     ANDLE79
     C                     MOVELTYPE4     XPOOA4
     C                     MOVELXPOOKE    TBVARG
     C           KTBA01    CHAINXTBASE01             99
     C  N99                MOVELTBVRES    XPOO00
     C  N99                MOVELXPOO01    TYPE4
F1  C                     END
     *
D1  C           TYPE5     IFGE 60
    C           TYPE5     ANDLE79
     C                     MOVELTYPE5     XPOOA4
     C                     MOVELXPOOKE    TBVARG
     C           KTBA01    CHAINXTBASE01             99
     C  N99                MOVELTBVRES    XPOO00
     C  N99                MOVELXPOO01    TYPE5
F1  C                     END
     *
    C                     ENDSR
     C/EJECT
     **************************************************************
     * SOUS PROGRAMME MISE A BLANC                                *
     **************************************************************
    C           BLMODB    BEGSR
     C                     Z-ADD0         SURTAL 100
     C                     Z-ADD0         PLUPOR  82
     C                     Z-ADD0         SURIMZ  90
     C                     Z-ADD0         DECFAZ  44
     C                     Z-ADD0         DEXCOU  62
     C                     Z-ADD0         SUPFAC  42
     C                     Z-ADD0         SUPFAZ  44
     C                     Z-ADD0         SUPFA   42
     C                     Z-ADD0         DINCOU  62
     C                     Z-ADD0         DECDIR  62
     C                     Z-ADD0         DINUNT  62
     C                     Z-ADD0         TDIRMA  72
     C                     Z-ADD0         TMATCE  72
     C                     Z-ADD0         TMATUN  72
    C                     ENDSR
     *
    C           BLMODK    BEGSR
     C                     Z-ADD0         DECPL   42
     C                     Z-ADD0         DECPLU  54
     C                     Z-ADD0         DEC     54
     C                     Z-ADD0         DECDEC 100
     C                     Z-ADD0         DROUA   44
     C                     Z-ADD0         DECFIN  54
     C                     Z-ADD0         NBFEN   80
     C                     Z-ADD0         HAUT    43
     C                     Z-ADD0         LARG    43
     C                     Z-ADD0         LONGEU  92
     C                     Z-ADD0         FENM2   92
     C                     Z-ADD0         LONGX   43
     C                     Z-ADD0         SURFEN  94
     C                     Z-ADD0         TOTFEN 102
     C                     Z-ADD0         PERIM   43
     C                     Z-ADD0         LONGF   80
     C                     Z-ADD0         LGF     82
     C                     Z-ADD0         TALFEN  72
     C                     Z-ADD0         NBDEC1  80
     C                     Z-ADD0         LONML   80
     C                     Z-ADD0         LON100  82
     C                     Z-ADD0         COLAS1  72
     C                     Z-ADD0         DECA22  54
     C                     Z-ADD0         COLAS2  72
     C                     Z-ADD0         COLASS  82
     C                     Z-ADD0         NBRIN   80
     C                     Z-ADD0         NBRINA  82
     C                     Z-ADD0         NBFDOR  80
     C                     Z-ADD0         NBDECP  80
     C                     Z-ADD0         VALPT   92
     C                     Z-ADD0         RINALD  80
     C                     Z-ADD0         TOTASS  92
     C                     Z-ADD0         POIGN   92
     C                     Z-ADD0         QTRI    80
     C                     Z-ADD0         QTRIV   82
     C                     Z-ADD0         RIV     92
     C                     Z-ADD0         ROND    92
     C                     Z-ADD0         MTSCAR  92
     C                     Z-ADD0         RESTE   80
     C                     Z-ADD0         NBR     20
     C                     Z-ADD0         TOTDEC  50
     C                     Z-ADD0         PAS     80
     C                     Z-ADD0         LINEA  120
     C                     Z-ADD0         CENML  122
     C                     Z-ADD0         VALSES 102
     C                     Z-ADD0         VALTAP 102
     C                     Z-ADD0         SNETOT 100
     C                     Z-ADD0         SNE100 102
     C                     Z-ADD0         TOTDIV  62
     C                     Z-ADD0         DIVDIR  62
     C                     Z-ADD0         DIVM2   64
     C                     Z-ADD0         AUTMAT
     C                     Z-ADD0         MATANX
     C                     Z-ADD0         AUTCOL
     C                     Z-ADD1         A
     C                     Z-ADD0         MTRACE  80
     C                     Z-ADD0         VALPEL 102
     C                     Z-ADD0         VALPET 102
     C                     Z-ADD0         VAFILM 102
     C                     Z-ADD0         VAFILT 102
     C                     Z-ADD0         VALDOR 102
     C                     Z-ADD0         NBOEI   80
     C                     Z-ADD0         NBCOR   80
     C                     Z-ADD0         VALOEI  92
     C                     Z-ADD0         VALCOR  92
     C                     Z-ADD0         VALDAF 102
    C                     ENDSR
     *
    C           BLMODN    BEGSR
     C                     Z-ADD0         TOTM2   74
     C                     Z-ADD0         MATDIR  72
    C                     ENDSR
     *
    C           BLMODT    BEGSR
     C                     Z-ADD0         TALPOR 102
     C                     Z-ADD0         SUPLV
     C                     Z-ADD0         SUPDIR
     C                     Z-ADD0         TOROUL
     C                     Z-ADD0         PCGARN
     C                     Z-ADD0         VSFO
     C                     Z-ADD0         MAJOR
     C                     Z-ADD0         TORERS
     C                     Z-ADD0         GARNI
     C                     Z-ADD0         STOCA
     C                     Z-ADD0         EXEFOR
     C                     Z-ADD0         FABFOR
     C                     Z-ADD0         SUPUV
     C                     Z-ADD0         FOFFEX
     C                     Z-ADD0         FOFFIN
     C                     Z-ADD0         FORCHA
    C                     ENDSR
     *
    C           BLRESU    BEGSR
     C                     Z-ADD0         MOYDEC
     C                     Z-ADD0         TREGMA
     C                     Z-ADD0         DIFF
     C                     Z-ADD0         TOLREG
     C                     Z-ADD0         PREG
     C                     Z-ADD0         REGK
     C                     MOVE *BLANKS   SS
     C                     Z-ADD0         TOLROU
     C                     MOVE '0'       INRO
     C                     MOVE '0'       INRE
     C                     MOVE ' '       CXHTRA
    C                     ENDSR
     *
    C           SPKGF     BEGSR
     C                     Z-ADD*ZEROS    KGF     32
D1  C           USIMP     IFEQ 2
D2  C           USIS      IFEQ 5
     C                     Z-ADDPORNTY    KGF     32
X2  C                     ELSE
D3  C           USIS      IFEQ 7
     C                     Z-ADDKI1       KGF
X3  C                     ELSE
     C                     Z-ADDPORRTN    KGF
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USIMP     IFEQ 3
D2  C           USIS      IFEQ 4
     C                     Z-ADDPORNTY    KGF
X2  C                     ELSE
D3  C           USIS      IFEQ 7
     C                     Z-ADDKI2       KGF
X3  C                     ELSE
     C                     Z-ADDPORRTN    KGF
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USIMP     IFEQ 4
D2  C           USIS      IFEQ 3
     C                     Z-ADDPORNTY    KGF
X2  C                     ELSE
D3  C           USIS      IFEQ 7
     C                     Z-ADDKI2       KGF
X3  C                     ELSE
     C                     Z-ADDPORRTN    KGF
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USIMP     IFEQ 5
D2  C           USIS      IFEQ 2
     C                     Z-ADDPORNTY    KGF
X2  C                     ELSE
D3  C           USIS      IFEQ 7
     C                     Z-ADDKI1       KGF
X3  C                     ELSE
     C                     Z-ADDPORRTN    KGF
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USIMP     IFEQ 7
D2  C           USIS      IFEQ 2
    C           USIS      OREQ 5
     C                     Z-ADDKI1       KGF
X2  C                     ELSE
D3  C           USIS      IFEQ 3
    C           USIS      OREQ 4
     C                     Z-ADDKI2       KGF
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
    C           TYPOLB    BEGSR
     C                     Z-ADD0         TRETPR
     C                     Z-ADD0         TREDER
     C                     Z-ADD0         TREFF
     C                     Z-ADD0         TNETPR
     C                     Z-ADD0         TNEFF
     C                     Z-ADD0         TROTPR
     C                     Z-ADD0         TRODER
     C                     Z-ADD0         TROEFF
     C                     Z-ADD0         TRETPV
     C                     Z-ADD0         TREDEV
     C                     Z-ADD0         TNETPV
     C                     Z-ADD0         DECR
     C                     Z-ADD0         TPSRE
     C                     Z-ADD0         TPSNE
     C                     Z-ADD0         TOTTPS
     C                     Z-ADD0         CADMOY
     C                     Z-ADD0         MAXDRE
     C                     Z-ADD0         MAXDRO
     C                     Z-ADD0         MAXTRE
     C                     Z-ADD0         MAXTRO
     C                     Z-ADD0         REPART
     C                     Z-ADD0         NEPART
     C                     Z-ADD0         AMREG
     C                     Z-ADD0         AMNET
     C                     MOVE 'PARNC'   TRAPAR
     C           CLECA2    CHAINCASPAR               80
D1  C           *IN80     IFEQ '0'
     C                     EXSR CUMUL                      cumul
     C                     EXSR TCUMUL                     total cumul
F1  C                     END
    C                     ENDSR
     **************************************************************
     * Valorisation ENCRE et VERNIS pour nouvelles configurations *
     * OFFSET EXTERIEUR PRINCIPALE + REPIQUAGE                    *
     **************************************************************
    C           EXT3B     BEGSR
     **************************************************************
     *            IMPRESSION EXTERIEURE PRINCIPALE                *
     **************************************************************
     C                     Z-ADDSUPEXT    S
D1  C           NIMPE1    IFEQ *BLANKS
     C                     SETOF                     98
     C           CLEPRE    CHAINMATPREL1             99
     C   99      CLEPRE    CHAINCXHENTL1             99
D2  C           *IN99     IFEQ '0'
    C           IMPFA     ANDEQ1
     C                     SETON                     98
F2  C                     END
     ************************
     * ENCRE                *
     ************************
     C                     Z-ADD0         ENCR11  62
     C                     Z-ADD0         ENCR12  62
     C                     Z-ADD0         ENCR13  62
    C*
     C                     Z-ADDOGEEP1    GRP     20
     C                     ADD  OGEEP2    GRP
     C                     ADD  OGEEP3    GRP
D2  C           GRP       IFNE *ZEROS
     * Forfait encre
     C           FOROFF    MULT GRP       FORCOU
     * ENCRE 1 % encrage
     * -----------------
D3  C           OTE1EP    IFNE 'U'
D4  C           OTE1EP    IFEQ 'N'
     C           FILL20    MULT OPE1EP    ENCR11    H
X4  C                     ELSE
D5  C           OTE1EP    IFEQ 'O'
     C           FILL21    MULT OPE1EP    ENCR11    H
X5  C                     ELSE
     C           ENCRO     MULT OPE1EP    ENCR11    H
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D4  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F4  C                     END
     C           SENCUV    MULT OPE1EP    ENCR11    H
F3  C                     END
     * ENCRE 2 % encrage
     * -----------------
D3  C           OTE2EP    IFNE 'U'
D4  C           OTE2EP    IFEQ 'N'
     C           FILL20    MULT OPE2EP    ENCR12    H
X4  C                     ELSE
D5  C           OTE2EP    IFEQ 'O'
     C           FILL21    MULT OPE2EP    ENCR12    H
X5  C                     ELSE
     C           ENCRO     MULT OPE2EP    ENCR12    H
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D4  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F4  C                     END
     C           SENCUV    MULT OPE2EP    ENCR12    H
F3  C                     END
     * Ajout des 2 encres
     C           ENCR11    ADD  ENCR12    ENCRE1
     * Majoration encre special .
D3  C           OMESEP    IFNE 0
     C           ENCRE1    MULT OMESEP    ENCRE1    H
F3  C                     END
     * Ajout encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D3  C           OPEFEP    IFNE *ZEROS
     C           VERNU1    MULT OPEFEP    ENCRFL    H
     C                     ADD  ENCRFL    ENCRE1
F3  C                     END
F2  C                     END
     * Ajout Dont Or, cuivre , alu
D2  C           OTOAEP    IFEQ *BLANK
     C                     Z-ADDENCRE1    ENCRE
X2  C                     ELSE
     C                     MOVELOTOAEP    OCAL    1
     C                     Z-ADDOPOAEP    CORCUA  21
     * Alu
D3  C           OCAL      IFEQ 'A'
     C                     ADD  FORALO    FORCOU
     C           ALUOF     MULT CORCUA    ENCRE2    H
X3  C                     ELSE
     * Or
D4  C           OCAL      IFEQ 'O'
     C                     ADD  FORORO    FORCOU
     C           OROFF     MULT CORCUA    ENCRE2    H
X4  C                     ELSE
     * Cuivre
     C                     ADD  FORCU     FORCOU
     C           CUIVRE    MULT CORCUA    ENCRE2    H
F4  C                     END
F3  C                     END
F2  C                     END
     * ENCRE 3 % Mordante
     * ------------------
D2  C           OTEMEP    IFEQ 'U'
     C           FILL38    MULT OPEMEP    ENCR13    H
X2  C                     ELSE
D3  C           OTEMEP    IFEQ 'T'
     C           FILL39    MULT OPEMEP    ENCR13    H
F3  C                     END
F2  C                     END
     * Total encre
     * -----------
     C           ENCRE1    ADD  ENCRE2    ENCRE   52
     C                     ADD  ENCR13    ENCRE
     ************************
     * VERNIS               *
     ************************
     C                     Z-ADD0         VERN11  52
     C                     Z-ADD0         VERN12  52
     C                     Z-ADD0         VERN13  52
     * VERNIS 1 % vernis
     * -----------------
D2  C           OTV1EP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPEXT    XVERA1
     C                     MOVE OTV1EP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV1EP    IFEQ 'F'
    C           OPV1EP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV1EP
F4  C                     END
D4  C           OTV1EP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV1EP    VERN11    H
     *
D4  C           OTV1EP    IFEQ 'P'
     C           VERN11    MULT 2         VERN11
F4  C                     END
     * Majoration vernis special .
D4  C           OMV1EP    IFNE 0
     C                     MULT OMV1EP    VERN11    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 2 % vernis
     * -----------------
D2  C           OTV2EP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPEXT    XVERA1
     C                     MOVE OTV2EP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV2EP    IFEQ 'F'
    C           OPV2EP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV2EP
F4  C                     END
D4  C           OTV2EP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV2EP    VERN12    H
     *
D4  C           OTV2EP    IFEQ 'P'
     C           VERN12    MULT 2         VERN12
F4  C                     END
     * Majoration vernis special .
D4  C           OMV2EP    IFNE 0
     C                     MULT OMV2EP    VERN12    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 3 % vernis
     * -----------------
D2  C           OTV3EP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPEXT    XVERA1
     C                     MOVE OTV3EP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV3EP    IFEQ 'F'
    C           OPV3EP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV3EP
F4  C                     END
D4  C           OTV3EP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV3EP    VERN13    H
     *
D4  C           OTV3EP    IFEQ 'P'
     C           VERN13    MULT 2         VERN13
F4  C                     END
     * Majoration vernis special .
D4  C           OMV3EP    IFNE 0
     C                     MULT OMV3EP    VERN13    H
F4  C                     END
F3  C                     END
F2  C                     END
     * Total vernis
     * ------------
     C                     Z-ADDVERN11    VERNIX
     C                     ADD  VERN12    VERNIX
     C                     ADD  VERN13    VERNIX
     * Total encre + vernis
     * --------------------
     C           ENCRE     ADD  VERNIX    ENCVER  62
     * Total OFFSET forfait et encre + vernis
     * --------------------------------------
     C                     Z-ADDFORCOU    FOROF1  60
     C                     ADD  ENCVER    OFFEN1  62
F1  C                     END
     **************************************************************
     *            IMPRESSION EXTERIEURE REPIQUAGE                 *
     **************************************************************
D1  C           RIMPEX    IFEQ 4
     ************************
     * ENCRE                *
     ************************
     C                     Z-ADD0         ENCR11
     C                     Z-ADD0         ENCR12
     C                     Z-ADD0         ENCR13
    C*
     C                     Z-ADDOGEER1    GRP
     C                     ADD  OGEER2    GRP
     C                     ADD  OGEER3    GRP
D2  C           GRP       IFNE *ZEROS
     * Forfait encre
     C           FOROFF    MULT GRP       FOREP
     * ENCRE 1 % encrage
     * -----------------
D3  C           OTE1ER    IFEQ 'U'
     C           ENCRUV    MULT OPE1ER    ENCR11    H
X3  C                     ELSE
D4  C           OTE1ER    IFEQ 'N'
     C           FILL20    MULT OPE1ER    ENCR11    H
X4  C                     ELSE
D5  C           OTE1ER    IFEQ 'O'
     C           FILL21    MULT OPE1ER    ENCR11    H
X5  C                     ELSE
     C           ENCRO     MULT OPE1ER    ENCR11    H
F5  C                     END
F4  C                     END
F3  C                     END
     * ENCRE 2 % encrage
     * -----------------
D3  C           OTE2ER    IFEQ 'U'
     C           ENCRUV    MULT OPE2ER    ENCR12    H
X3  C                     ELSE
D4  C           OTE2ER    IFEQ 'N'
     C           FILL20    MULT OPE2ER    ENCR12    H
X4  C                     ELSE
D5  C           OTE2ER    IFEQ 'O'
     C           FILL21    MULT OPE2ER    ENCR12    H
X5  C                     ELSE
     C           ENCRO     MULT OPE2ER    ENCR12    H
F5  C                     END
F4  C                     END
F3  C                     END
     * Ajout des 2 encres
     C           ENCR11    ADD  ENCR12    ENCRE3
     * Majoration encre special .
D3  C           OMESER    IFNE 0
     C           ENCRE3    MULT OMESER    ENCRE3    H
F3  C                     END
     * Ajout encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D3  C           OTEFER    IFNE *BLANK
     C           VERNU1    MULT OPEFER    ENCRFL    H
     C                     ADD  ENCRFL    ENCRE3
F3  C                     END
F2  C                     END
     * Ajout Dont Or, cuivre , alu
D2  C           OTOAER    IFNE *BLANK
     C                     MOVELOTOAER    OCAL    1
     C                     Z-ADDOPOAER    CORCUA  21
     * Alu
D3  C           OCAL      IFEQ 'A'
     C                     ADD  FORALO    FOREP
     C           ALUOF     MULT CORCUA    ENCRE4    H
X3  C                     ELSE
     * Or
D4  C           OCAL      IFEQ 'O'
     C                     ADD  FORORO    FOREP
     C           OROFF     MULT CORCUA    ENCRE4    H
X4  C                     ELSE
     * Cuivre
     C                     ADD  FORCU     FOREP
     C           CUIVRE    MULT CORCUA    ENCRE4    H
F4  C                     END
F3  C                     END
F2  C                     END
     * ENCRE 3 % Mordante
     * ------------------
D2  C           OTEMER    IFEQ 'U'
     C           FILL38    MULT OPEMER    ENCR13    H
X2  C                     ELSE
D3  C           OTEMER    IFEQ 'T'
     C           FILL39    MULT OPEMER    ENCR13    H
F3  C                     END
F2  C                     END
     * Total encre
     * -----------
     C                     ADD  ENCRE3    ENCRE
     C                     ADD  ENCRE4    ENCRE
     C                     ADD  ENCR13    ENCRE
     ************************
     * VERNIS               *
     ************************
     C                     Z-ADD0         VERN11  52
     C                     Z-ADD0         VERN12  52
     C                     Z-ADD0         VERN13  52
     * VERNIS 1 % vernis
     * -----------------
D2  C           OTV1ER    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE OTV1ER    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV1ER    IFEQ 'F'
    C           OPV1ER    ANDEQ*ZEROS
     C                     Z-ADD1         OPV1ER
F4  C                     END
D4  C           OTV1ER    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FOREP
     C           XVER03    MULT OPV1ER    VERN11
     *
D4  C           OTV1ER    IFEQ 'P'
     C           VERN11    MULT 2         VERN11
F4  C                     END
     * Majoration vernis special .
D4  C           OMV1ER    IFNE 0
     C                     MULT OMV1ER    VERN11    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 2 % vernis
     * -----------------
D2  C           OTV2ER    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE OTV2ER    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV2ER    IFEQ 'F'
    C           OPV2ER    ANDEQ*ZEROS
     C                     Z-ADD1         OPV2ER
F4  C                     END
D4  C           OTV2ER    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FOREP
     C           XVER03    MULT OPV2ER    VERN12
     *
D4  C           OTV2ER    IFEQ 'P'
     C           VERN12    MULT 2         VERN12
F4  C                     END
     * Majoration vernis special .
D4  C           OMV2ER    IFNE 0
     C                     MULT OMV2ER    VERN12    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 3 % vernis
     * -----------------
D2  C           OTV3ER    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE OTV3ER    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV3ER    IFEQ 'F'
    C           OPV3ER    ANDEQ*ZEROS
     C                     Z-ADD1         OPV3ER
F4  C                     END
D4  C           OTV3ER    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FOREP
     C           XVER03    MULT OPV3ER    VERN13
     *
D4  C           OTV3ER    IFEQ 'P'
     C           VERN13    MULT 2         VERN13
F4  C                     END
     * Majoration vernis special .
D4  C           OMV3ER    IFNE 0
     C                     MULT OMV3ER    VERN13    H
F4  C                     END
F3  C                     END
F2  C                     END
     * Total vernis
     * ------------
     C                     Z-ADDVERN11    VERREP
     C                     ADD  VERN12    VERREP
     C                     ADD  VERN13    VERREP
     C                     ADD  VERREP    VERNIX
     * Total encre + vernis
     * --------------------
     C           ENCRE3    ADD  VERREP    ENCREP  62
     C                     ADD  ENCRE4    ENCREP
     C                     ADD  ENCR13    ENCREP
     * Total OFFSET forfait et encre + vernis
     * --------------------------------------
     C                     ADD  FOREP     FOROF1
     C                     ADD  ENCREP    OFFEN1
F1  C                     END
     **************************************************************
     *           PRIX TOTAL ENCRE VERNIS EXTERIEURE               *
     **************************************************************
D1  C           TALO,S    IFNE 0
     C           ENCRE     MULT TALO,S    ENCRE     H
     C           VERNIX    MULT TALO,S    VERNIX
F1  C                     END
     *
     C                     ADD  ENCRE     COUDIR  62
     C                     ADD  VERNIX    COUDIR
     C                     ADD  ENCRE     COUTEX  62
     C                     ADD  VERNIX    COUTEX
     C           ENCRE     MULT KMATA     ENCRE     H
     C           VERNIX    MULT KMATA     VERNIX    H
     *
     C                     Z-ADDENCRE     ENCEXT  62
     C           ENCEXT    MULT 0,01      ENCM2   64
     C           ENCM2     MULT SUVENT    ENCVTE  62H
     C                     Z-ADDVERNIX    VEREXT  62
     C           VEREXT    MULT 0,01      VERM2   64
     C           VERM2     MULT SUVENT    VERVTE  62H
     C                     Z-ADDFORCOU    FOREXT  40
     C                     Z-ADDFOREP     FOREPE  40
    C                     ENDSR
     **************************************************************
     * Valorisation ENCRE et VERNIS pour nouvelles configurations *
     * OFFSET INTERIEUR PRINCIPALE + REPIQUAGE                    *
     **************************************************************
    C           INT3B     BEGSR
     **************************************************************
     *            IMPRESSION INTERIEURE PRINCIPALE                *
     **************************************************************
     C                     Z-ADDSUPINT    S
D1  C           NIMPI1    IFEQ *BLANKS
     C                     SETOF                     98
     C           CLEPRE    CHAINMATPREL1             99
     C   99      CLEPRE    CHAINCXHENTL1             99
D2  C           *IN99     IFEQ '0'
    C           IMPFA     ANDEQ1
     C                     SETON                     98
F2  C                     END
     ************************
     * ENCRE                *
     ************************
     C                     Z-ADD0         ENCR11  62
     C                     Z-ADD0         ENCR12  62
     C                     Z-ADD0         ENCR13  62
    C*
     C                     Z-ADDOGEIP1    GRP     20
     C                     ADD  OGEIP2    GRP
     C                     ADD  OGEIP3    GRP
D2  C           GRP       IFNE *ZEROS
     * Forfait encre
     C           FOROFF    MULT GRP       FORCOU
     * ENCRE 1 % encrage
     * -----------------
D3  C           OTE1IP    IFNE 'U'
D4  C           OTE1IP    IFEQ 'N'
     C           FILL20    MULT OPE1IP    ENCR11    H
X4  C                     ELSE
D5  C           OTE1IP    IFEQ 'O'
     C           FILL21    MULT OPE1IP    ENCR11    H
X5  C                     ELSE
     C           ENCRO     MULT OPE1IP    ENCR11    H
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D4  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F4  C                     END
     C           SENCUV    MULT OPE1IP    ENCR11    H
F3  C                     END
     * ENCRE 2 % encrage
     * -----------------
D3  C           OTE2IP    IFNE 'U'
D4  C           OTE2IP    IFEQ 'N'
     C           FILL20    MULT OPE2IP    ENCR12    H
X4  C                     ELSE
D5  C           OTE2IP    IFEQ 'O'
     C           FILL21    MULT OPE2IP    ENCR12    H
X5  C                     ELSE
     C           ENCRO     MULT OPE2IP    ENCR12    H
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDENCRUV    SENCUV  52
D4  C           *IN98     IFEQ '1'
     C                     Z-ADDFILL6     SENCUV
F4  C                     END
     C           SENCUV    MULT OPE2IP    ENCR12    H
F3  C                     END
     * Ajout des 2 encres
     C           ENCR11    ADD  ENCR12    ENCRE1
     * Majoration encre special .
D3  C           OMESIP    IFNE 0
     C           ENCRE1    MULT OMESIP    ENCRE1    H
F3  C                     END
     * Ajout encre FLUO.
     C                     Z-ADD*ZEROS    ENCRFL  62
D3  C           OPEFIP    IFNE *ZEROS
     C           VERNU1    MULT OPEFIP    ENCRFL    H
     C                     ADD  ENCRFL    ENCRE1
F3  C                     END
F2  C                     END
     * Ajout Dont Or, cuivre , alu
D2  C           OTOAIP    IFEQ *BLANK
     C                     Z-ADDENCRE1    ENCRE
X2  C                     ELSE
     C                     MOVELOTOAIP    OCAL    1
     C                     Z-ADDOPOAIP    CORCUA  21
     * Alu
D3  C           OCAL      IFEQ 'A'
     C                     ADD  FORALO    FORCOU
     C           ALUOF     MULT CORCUA    ENCRE2    H
X3  C                     ELSE
     * Or
D4  C           OCAL      IFEQ 'O'
     C                     ADD  FORORO    FORCOU
     C           OROFF     MULT CORCUA    ENCRE2    H
X4  C                     ELSE
     * Cuivre
     C                     ADD  FORCU     FORCOU
     C           CUIVRE    MULT CORCUA    ENCRE2    H
F4  C                     END
F3  C                     END
F2  C                     END
     * ENCRE 3 % Mordante
     * ------------------
D2  C           OTEMIP    IFEQ 'U'
     C           FILL38    MULT OPEMIP    ENCR13    H
X2  C                     ELSE
D3  C           OTEMIP    IFEQ 'T'
     C           FILL39    MULT OPEMIP    ENCR13    H
F3  C                     END
F2  C                     END
     * Total encre
     * -----------
     C           ENCRE1    ADD  ENCRE2    ENCRE   52
     C                     ADD  ENCR13    ENCRE
     ************************
     * VERNIS               *
     ************************
     C                     Z-ADD0         VERN11  52
     C                     Z-ADD0         VERN12  52
     C                     Z-ADD0         VERN13  52
     * VERNIS 1 % vernis
     * -----------------
D2  C           OTV1IP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPINT    XVERA1
     C                     MOVE OTV1IP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV1IP    IFEQ 'F'
    C           OPV1IP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV1IP
F4  C                     END
D4  C           OTV1IP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV1IP    VERN11    H
     *
D4  C           OTV1IP    IFEQ 'P'
     C           VERN11    MULT 2         VERN11
F4  C                     END
     * Majoration vernis special .
D4  C           OMV1IP    IFNE 0
     C                     MULT OMV1IP    VERN11    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 2 % vernis
     * -----------------
D2  C           OTV2IP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPINT    XVERA1
     C                     MOVE OTV2IP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV2IP    IFEQ 'F'
    C           OPV2IP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV2IP
F4  C                     END
D4  C           OTV2IP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV2IP    VERN12    H
     *
D4  C           OTV2IP    IFEQ 'P'
     C           VERN12    MULT 2         VERN12
F4  C                     END
     * Majoration vernis special .
D4  C           OMV2IP    IFNE 0
     C                     MULT OMV2IP    VERN12    H
F4  C                     END
F3  C                     END
F2  C                     END
     * VERNIS 3 % vernis
     * -----------------
D2  C           OTV3IP    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE IMPINT    XVERA1
     C                     MOVE OTV3IP    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV3IP    IFEQ 'F'
    C           OPV3IP    ANDEQ*ZEROS
     C                     Z-ADD1         OPV3IP
F4  C                     END
D4  C           OTV3IP    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FORCOU
     C           XVER03    MULT OPV3IP    VERN13    H
     *
D4  C           OTV3IP    IFEQ 'P'
     C           VERN13    MULT 2         VERN13
F4  C                     END
     * Majoration vernis special .
D4  C           OMV3IP    IFNE 0
     C                     MULT OMV3IP    VERN13    H
F4  C                     END
F3  C                     END
F2  C                     END
     * Total vernis
     * ------------
     C                     Z-ADDVERN11    VERNIX
     C                     ADD  VERN12    VERNIX
     C                     ADD  VERN13    VERNIX
     * Total encre + vernis
     * --------------------
     C           ENCRE     ADD  VERNIX    ENCVER  62
     * Total OFFSET forfait et encre + vernis
     * --------------------------------------
     C                     Z-ADDFORCOU    FOROF2  60
     C                     ADD  ENCVER    OFFEN2  62
F1  C                     END
     **************************************************************
     *            IMPRESSION INTERIEURE REPIQUAGE                 *
     **************************************************************
D1  C           RIMPIN    IFEQ 4
     ************************
     * ENCRE                *
     ************************
     C                     Z-ADD0         ENCR11
    C*
     C                     Z-ADDOGEIR1    GRP
D2  C           GRP       IFNE *ZEROS
     * Forfait encre
     C           FOROFF    MULT GRP       FOREP
     * ENCRE 1 % encrage
     * -----------------
D3  C           OTE1IR    IFEQ 'U'
     C           ENCRUV    MULT OPE1IR    ENCR11    H
X3  C                     ELSE
D4  C           OTE1IR    IFEQ 'N'
     C           FILL20    MULT OPE1IR    ENCR11    H
X4  C                     ELSE
D5  C           OTE1IR    IFEQ 'O'
     C           FILL21    MULT OPE1IR    ENCR11    H
X5  C                     ELSE
     C           ENCRO     MULT OPE1IR    ENCR11    H
F5  C                     END
F4  C                     END
F3  C                     END
    C*
     C                     Z-ADDENCR11    ENCRE3
     * Majoration encre special .
D3  C           OMESIR    IFNE 0
     C           ENCRE3    MULT OMESIR    ENCRE3    H
F3  C                     END
F2  C                     END
     * Total encre
     * -----------
     C                     ADD  ENCRE3    ENCRE
     ************************
     * VERNIS               *
     ************************
     C                     Z-ADD0         VERN11  52
    C*
     * VERNIS 1 % vernis
     * -----------------
D2  C           OTV1IR    IFNE ' '
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE OTV1IR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
D3  C           CDE       IFEQ 1
     C                     MOVEL'XVERNISS'TBLNOM
X3  C                     ELSE
     C                     MOVEL'XVERNPRU'TBLNOM
F3  C                     END
     C           KTBA01    CHAINXTBASE01             99
D3  C           *IN99     IFEQ '0'
     C                     MOVELTBVRES    XVER00
D4  C           OTV1IR    IFEQ 'F'
    C           OPV1IR    ANDEQ*ZEROS
     C                     Z-ADD1         OPV1IR
F4  C                     END
D4  C           OTV1IR    IFEQ 'U'
    C           *IN98     ANDEQ'1'
     C                     Z-ADDFILL10    XVER03
F4  C                     END
     *
     C                     ADD  XVER04    FOREP
     C           XVER03    MULT OPV1IR    VERN11
     *
D4  C           OTV1IR    IFEQ 'P'
     C           VERN11    MULT 2         VERN11
F4  C                     END
     * Majoration vernis special .
D4  C           OMV1IR    IFNE 0
     C                     MULT OMV1IR    VERN11    H
F4  C                     END
F3  C                     END
F2  C                     END
     *
     * Total vernis
     * ------------
     C                     Z-ADDVERN11    VERREP
     C                     ADD  VERREP    VERNIX
     * Total encre + vernis
     * --------------------
     C           ENCRE3    ADD  VERREP    ENCREP  62
     * Total OFFSET forfait et encre + vernis
     * --------------------------------------
     C                     ADD  FOREP     FOROF2
     C                     ADD  ENCREP    OFFEN2
F1  C                     END
     *
     **************************************************************
     *           PRIX TOTAL ENCRE VERNIS INTERIEURE               *
     **************************************************************
D1  C           TALO,S    IFNE 0
     C           ENCRE     MULT TALO,S    ENCRE     H
     C           VERNIX    MULT TALO,S    VERNIX
F1  C                     END
     *
     C                     ADD  ENCRE     COUDIR  62
     C                     ADD  VERNIX    COUDIR
     C                     ADD  ENCRE     COUTIN  62
     C                     ADD  VERNIX    COUTIN
     C           ENCRE     MULT KMATA     ENCRE     H
     C           VERNIX    MULT KMATA     VERNIX    H
     *
     C                     Z-ADDENCRE     ENCINT  62
     C           ENCINT    MULT 0,01      ENCM2   64
     C           ENCM2     MULT SUVENT    ENCVTI  62H
     C                     Z-ADDVERNIX    VERINT  62
     C           VERINT    MULT 0,01      VERM2   64
     C           VERM2     MULT SUVENT    VERVTI  62H
     C                     Z-ADDFORCOU    FORINT  40
     C                     Z-ADDFOREP     FOREPI  40
    C                     ENDSR
     **************************************************************
     * Recherche des passages OFFSETS 3B et autres                *
     **************************************************************
    C           PAS3B     BEGSR
     * ***************************************
     * Transformation des vernis pour CADDEC *
     * ***************************************
     *
     * Variables de l'ancienne version OFFSET
     C                     MOVE *BLANK    TVER
     C                     MOVE *BLANK    TVERSS
     C                     MOVE *BLANK    RVER
     C                     MOVE *BLANK    ORCU
     C                     MOVE *BLANK    ORCUR
     C                     MOVE *BLANK    UV
     C                     MOVE *BLANK    RUV
     C                     MOVE *BLANK    TS
     C                     MOVE *BLANK    APLA
     C                     MOVE *BLANK    ENC
     C                     MOVE *BLANK    ENCALI
     C                     MOVE *BLANK    NATE
     C                     MOVE *BLANK    DDECOR
     C                     MOVE *BLANKS   COLO
     C                     MOVE *BLANKS   VERA
     * RAZ des variables nouvelles OFFSETS
     C                     EXSR RAZ3B
     * Usine de l'offset
     C                     Z-ADDUSIMAC    USFAB
     * REMPLISSAGE DES VERNIS PAR PASSAGE
     * ----------------------------------
     *
     * Exterieur principal
     * -------------------
     *
D1  C           *IN97     IFEQ '1'
    C           *IN87     ANDEQ'0'
     * Groupe encreur
     C                     Z-ADDOGEEP1    GE1
     C                     Z-ADDOGEEP2    GE2
     C                     Z-ADDOGEEP3    GE3
     * Type de décor
     C                     MOVE ODDEP     DDECOR
     * Sens de la fibre
     C                     MOVE OTSSEP    SENSF
     * Apla
     C                     MOVE ODAEP     APLA3B
     * Nature
     C                     MOVE ONE1EP    NATE1
     C                     MOVE ONE2EP    NATE2
     * Dorure a froid
D2  C           ODPEP     IFNE *ZEROS
     C                     Z-ADDODPEP     ZX      10
     C                     MOVE OTEMEP    MOR,ZX
F2  C                     END
     * Grainage alternatif
D2  C           OTGEP     IFEQ 'X'
     C                     MOVE OTGEP     GRAALT
F2  C                     END
     * Grainage simultané
D2  C           OTGEP     IFEQ 'W'
     C                     MOVE OTGEP     GRASIM
F2  C                     END
     * Vernis 1
D2  C           OV1EP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV1EP    V1,XX
F2  C                     END
D2  C           OV1EP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV1EP    V2,YY
F2  C                     END
D2  C           OV1EP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV1EP    V3,ZZ
F2  C                     END
     * Vernis 2
D2  C           OV2EP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV2EP    V1,XX
F2  C                     END
D2  C           OV2EP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV2EP    V2,YY
F2  C                     END
D2  C           OV2EP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV2EP    V3,ZZ
F2  C                     END
     * Vernis 3
D2  C           OV3EP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV3EP    V1,XX
F2  C                     END
D2  C           OV3EP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV3EP    V2,YY
F2  C                     END
D2  C           OV3EP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV3EP    V3,ZZ
F2  C                     END
F1  C                     END
     * Exterieur repiquage
     * -------------------
D1  C           *IN87     IFEQ '1'
     * Groupe encreur
     C                     Z-ADDOGEER1    GE1
     C                     Z-ADDOGEER2    GE2
     C                     Z-ADDOGEER3    GE3
     * Type de décor
     C                     MOVE ODDER     DDECOR
     * Sens de la fibre
     C                     MOVE OTSSER    SENSF
     * Apla
     C                     MOVE ODAER     APLA3B
     * Nature
     C                     MOVE ONE1ER    NATE1
     C                     MOVE ONE2ER    NATE2
     * Dorure a froid
D2  C           ODPER     IFNE *ZEROS
     C                     Z-ADDODPER     ZX
     C                     MOVE OTEMER    MOR,ZX
F2  C                     END
     * Grainage alternatif
D2  C           OTGER     IFEQ 'X'
     C                     MOVE OTGER     GRAALT
F2  C                     END
     * Grainage simultané
D2  C           OTGER     IFEQ 'W'
     C                     MOVE OTGER     GRASIM
F2  C                     END
     * Vernis 1
D2  C           OV1ER1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV1ER    V1,XX
F2  C                     END
D2  C           OV1ER2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV1ER    V2,YY
F2  C                     END
D2  C           OV1ER3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV1ER    V3,ZZ
F2  C                     END
     * Vernis 2
D2  C           OV2ER1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV2ER    V1,XX
F2  C                     END
D2  C           OV2ER2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV2ER    V2,YY
F2  C                     END
D2  C           OV2ER3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV2ER    V3,ZZ
F2  C                     END
     * Vernis 3
D2  C           OV3ER1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV3ER    V1,XX
F2  C                     END
D2  C           OV3ER2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV3ER    V2,YY
F2  C                     END
D2  C           OV3ER3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV3ER    V3,ZZ
F2  C                     END
F1  C                     END
     * Interieur principal
     * -------------------
D1  C           *IN96     IFEQ '1'
    C           *IN86     ANDEQ'0'
     * Groupe encreur
     C                     Z-ADDOGEIP1    GE1
     C                     Z-ADDOGEIP2    GE2
     C                     Z-ADDOGEIP3    GE3
     * Type de décor
     C                     MOVE ODDIP     DDECOR
     * Sens de la fibre
     C                     MOVE OTSSIP    SENSF
     * Apla
     C                     MOVE ODAIP     APLA3B
     * Nature
     C                     MOVE ONE1IP    NATE1
     C                     MOVE ONE2IP    NATE2
     * Dorure a froid
D2  C           ODPIP     IFNE *ZEROS
     C                     Z-ADDODPIP     ZX
     C                     MOVE OTEMIP    MOR,ZX
F2  C                     END
     * Grainage alternatif
D2  C           OTGIP     IFEQ 'X'
     C                     MOVE OTGIP     GRAALT
F2  C                     END
     * Grainage simulatné
D2  C           OTGIP     IFEQ 'W'
     C                     MOVE OTGIP     GRASIM
F2  C                     END
     * Vernis 1
D2  C           OV1IP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV1IP    V1,XX
F2  C                     END
D2  C           OV1IP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV1IP    V2,YY
F2  C                     END
D2  C           OV1IP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV1IP    V3,ZZ
F2  C                     END
     * Vernis 2
D2  C           OV2IP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV2IP    V1,XX
F2  C                     END
D2  C           OV2IP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV2IP    V2,YY
F2  C                     END
D2  C           OV2IP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV2IP    V3,ZZ
F2  C                     END
     * Vernis 3
D2  C           OV3IP1    IFEQ 'V'
     C                     ADD  1         XX
     C                     MOVE OTV3IP    V1,XX
F2  C                     END
D2  C           OV3IP2    IFEQ 'V'
     C                     ADD  1         YY
     C                     MOVE OTV3IP    V2,YY
F2  C                     END
D2  C           OV3IP3    IFEQ 'V'
     C                     ADD  1         ZZ
     C                     MOVE OTV3IP    V3,ZZ
F2  C                     END
F1  C                     END
     * Interieur repiquage
     * -------------------
D1  C           *IN86     IFEQ '1'
     * Groupe encreur
     C                     Z-ADDOGEIR1    GE1
     * Nature
     C                     MOVE ONE1IR    NATE1
     * Vernis 1
D2  C           OTV1IR    IFNE *BLANK
     C                     ADD  1         XX
     C                     MOVE OTV1IR    V1,XX
F2  C                     END
F1  C                     END
     * TRANSFORMATION DES VERNIS PAR PASSAGE
     * -------------------------------------
     *
     * Transformation de chaque vernis de chaque passage
     C                     Z-ADD0         WW      10
D1  C                     DO   2         WW
D2  C           V1,WW     IFNE *BLANK
     C                     MOVE V1,WW     VERVER  1
     C                     EXSR VERSI
     C                     MOVE VERVER    TV1,WW
F2  C                     END
D2  C           V2,WW     IFNE *BLANK
     C                     MOVE V2,WW     VERVER  1
     C                     EXSR VERSI
     C                     MOVE VERVER    TV2,WW
F2  C                     END
D2  C           V3,WW     IFNE *BLANK
     C                     MOVE V3,WW     VERVER  1
     C                     EXSR VERSI
     C                     MOVE VERVER    TV3,WW
F2  C                     END
F1  C                     ENDDO
     *
     * Transformation des vernis en un seul vernis pour CADDEC
     *
     * Passage 1
D1  C           XX        IFNE *ZEROS
     C                     MOVE TV1,1     P1      1
     C                     MOVE TV1,2     P2      1
     C                     EXSR UNVER
     C                     MOVE P1        CV1
F1  C                     END
     * Passage 2
D1  C           YY        IFNE *ZEROS
     C                     MOVE TV2,1     P1      1
     C                     MOVE TV2,2     P2      1
     C                     EXSR UNVER
     C                     MOVE P1        CV2
F1  C                     END
     * Passage 3
D1  C           ZZ        IFNE *ZEROS
     C                     MOVE TV3,1     P1      1
     C                     MOVE TV3,2     P2      1
     C                     EXSR UNVER
     C                     MOVE P1        CV3
F1  C                     END
     * VALEUR PAR PASSAGE POUR CADDEC
     * ------------------------------
     * Passage 1
D1  C           GE1       IFNE *ZEROS
    C           XX        ORNE *ZEROS
     C                     ADD  1         I
     C                     MOVE GE1       COLO,I
D2  C           XX        IFNE 0
     C                     MOVE CV1       VERA,I
F2  C                     END
     C                     MOVE OMACEP    TMA,I
F1  C                     END
     * Passage 2
D1  C           GE2       IFNE *ZEROS
    C           YY        ORNE *ZEROS
     C                     ADD  1         I
     C                     MOVE GE2       COLO,I
D2  C           YY        IFNE 0
     C                     MOVE CV2       VERA,I
F2  C                     END
     C                     MOVE OMACEP    TMA,I
F1  C                     END
     * Passage 3
D1  C           GE3       IFNE *ZEROS
    C           ZZ        ORNE *ZEROS
     C                     ADD  1         I
     C                     MOVE GE3       COLO,I
D2  C           ZZ        IFNE 0
     C                     MOVE CV3       VERA,I
F2  C                     END
     C                     MOVE OMACEP    TMA,I
F1  C                     END
     * Grainage alternatif
D1  C           GRAALT    IFEQ 'X'
     C                     ADD  1         I
     C                     MOVE '0'       COLO,I
     C                     MOVE GRAALT    VERA,I
     C                     MOVE OMACEP    TMA,I
F1  C                     END
    C                     ENDSR
     **************************************************************
     * Changement vernis simple                                   *
     **************************************************************
    C           VERSI     BEGSR
     * TRADI
D1  C           VERVER    IFEQ 'N'
    C           VERVER    OREQ 'G'
    C           VERVER    OREQ 'M'
    C           VERVER    OREQ 'A'
    C           VERVER    OREQ 'C'
     C                     MOVE 'F'       VERVER
F1  C                     END
D1  C           VERVER    IFEQ 'T'
    C           VERVER    OREQ 'H'
    C           VERVER    OREQ 'B'
     C                     MOVE 'K'       VERVER
F1  C                     END
     * U.V
D1  C           VERVER    IFEQ 'O'
    C           VERVER    OREQ 'D'
    C           VERVER    OREQ 'P'
    C           VERVER    OREQ 'Q'
    C           VERVER    OREQ 'E'
    C           VERVER    OREQ 'J'
    C           VERVER    OREQ 'I'
    C           VERVER    OREQ 'R'
    C           VERVER    OREQ 'S'
     C                     MOVE 'U'       VERVER
F1  C                     END
    C                     ENDSR
     **************************************************************
     * Changement de 2 vernis en un seul                          *
     **************************************************************
    C           UNVER     BEGSR
D1  C           P1        IFEQ 'U'
    C           P2        OREQ 'U'
     C                     MOVE 'U'       P1
X1  C                     ELSE
D2  C           P1        IFEQ 'K'
    C           P2        OREQ 'K'
     C                     MOVE 'K'       P1
X2  C                     ELSE
D3  C           P1        IFEQ 'L'
    C           P2        OREQ 'L'
     C                     MOVE 'L'       P1
X3  C                     ELSE
     C                     MOVE 'F'       P1
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
     **************************************************************
     * RAZ des variables des nouvelles OFFSETS                    *
     **************************************************************
    C           RAZ3B     BEGSR
     * Vernis originaux par passage
     C                     MOVE *BLANKS   V1
     C                     MOVE *BLANKS   V2
     C                     MOVE *BLANKS   V3
     * Vernis transformé une fois par passage
     C                     MOVE *BLANKS   TV1
     C                     MOVE *BLANKS   TV2
     C                     MOVE *BLANKS   TV3
     * Vernis pour passage particulier
     C                     MOVE *BLANKS   PVR
     * Passage encre mordante
     C                     MOVE *BLANKS   MOR
     * Vernis transformé pour CADDEC par passsage
     C                     MOVE *BLANKS   CV1     1
     C                     MOVE *BLANKS   CV2     1
     C                     MOVE *BLANKS   CV3     1
     *
     C                     Z-ADD0         XX      10
     C                     Z-ADD0         YY      10
     C                     Z-ADD0         ZZ      10
     C                     Z-ADD0         GE1     20
     C                     Z-ADD0         GE2     20
     C                     Z-ADD0         GE3     20
     * Variables
     C                     MOVE *BLANK    SENSF   1
     C                     MOVE *BLANK    APLA3B  1
     C                     MOVE *BLANK    NATE1   1
     C                     MOVE *BLANK    NATE2   1
     C                     MOVE *BLANK    GRAALT  1
     C                     MOVE *BLANK    GRASIM  1
    C                     ENDSR
     *
     C/EJECT
     * erreur devis
     OERRDEVISE  202           ERRTET
     O                                   50 'ERREUR CALCUL DEVIS'
     O                    U1 U7          80 'Passage  devis        '
     O                    U1 U8          80 'Passage  simulation   '
     O                    U2             80 'Passage  commandes    '
     O                    U3             80 'Passage  simul.tarif  '
     O                    U4             80 'Passage  prix-revient '
     O                    U5             80 'Passage  react.pre-imp.'
     O                    U6 U7          80 'F.technique + devis    '
     O                 44                80 'Passage ordonnancement'
     O                 45                80 'Passage suivi fabricat.'
     O                 46                80 'Simulation PRU         '
     O                 47                80 'Passage commande CXH'
     O                         UDATE Y   10
     O                                  190 'PAGE'
     O                         PAGE  Z  195
     O/SPACE 1
     O        E  2             ERRLIG
     O                         ERR1,P     2
     O                         REFDS     46
     O                         ERR3,A   190
     O/SPACE 5
     OPREIMPF1E                PREIMU
     O                         DEMAR
     O                         CMAT
     O                         CREGL
     O                         CROUL
     O                         PXP
     O                         NOPX
     O                         CMA100
     O                         CRE100
     O                         CRO100
     O                         DATDE
     O/SPACE 1
** ERREUR **  TABLE DES ERREURS .
<01> CALCUL DU PORT SANS RESULTAT - PB: COEFFICIENT CAMION INCOMPLET

<02> CALCUL DU PORT SANS RESULTAT - PB: SURFACE PAR CAMION

<03> CALCUL DU PORT SANS RESULTAT - PB: TARIF DETAIL

<04> CALCUL DU PORT SANS RESULTAT - PB: DISTANCE PAR DEPARTEMENT

<05> CALCUL DU PORT SANS RESULTAT - PB: PRIX PAR PAYS/REGION

<06> PROBLEME SUR DEVIS "AFFICHE"

<07

<08

<09>

<10> CALCUL DU PRIX EMBALLAGE SANS RESULTAT .

<11> PAPIER INCONNUE DANS LE FICHIER "MATPRE" ET RECHERCHE DE PRE-IMPR
IME INFRUCTUEUSE .
<12>

<13> ERREUR SUR LE CODE POIGNEE EN ASSEMBLAGE .

<14>

<15>

<16> FACONNAGE SECTION ONDULATION :                        ONDULATION,
CONTRE-COLLAGE, FACONNAGE, USINE DE FABRICATION  INCOMPATIBLE .
<17> CHAINAGE DU FICHIER "CADDEC" SANS RESULTAT .

<18> DIVISION PAR ZERO

<19> INDEX DE TABLEAU NON VALIDE

<20> SIGNE OU CHIFFRE NON VALIDE

<21> CHAINAGE DU FICHIER "COUHOR" SANS RESULTAT .

<22>

<23>

<24> PRE-IMPRESSION : SECTION ROTATIVES ;
 USINE ET NOMBRE DE GROUPE INCOMPATIBLE .
<25>

<26> PRE-IMPRESSION : SECTION OFFSET ;
 APPEL FICHIER "OFFPAS" SANS RESULTAT .
<27> CAS PARTICULIERS : RECHERCHE DANS LE FICHIER "CASPAR" ERRONEE .

<28> CAS PARTICULIERS : TYPE DE CAS PARTICULIER ERRONEE .

<29> CAS PARTICULIERS :
 CHAINAGE DANS LE FICHIER "MATPRE" SANS RESULTAT .
<30> MACHINE NON ATRRIBUEE POUR CETTE SECTION

<31> CODE 1° OU 2° ASSEMBLAGE ERRONE

<32> LAIZE MINI SUPERIEUR A LAIZE UTILISE OU RAPPORT SUPERIEUR A 2

** MAJORATIONS A APPLIQUER AU PRIX FINAL POUR LES GARNITURES .
0000010009991625
0010000014991312
0015000019991000
0020000024990900
0025000029990800
0030000034990750
0035000039990700
0040000044990638
0045000049990575
0050000054990550
0055000059990525
0060000069990475
0070000079990425
0080000089990400
0090000099990375
0100000124990350
0125000149990325
0150000174990312
0175000199990300
0200000224990288
0225000244990275
0250000374990238
0375000499990200
0500000749990175
0750000999990150
1000001499990138
1500001999990125
2000002999990100
3000009999990075
** OVR **
DLTOVR *ALL
OVRDBF FILE(OFPAS  ) MBR(OFCOMI )
OVRDBF FILE(OFPAS  ) MBR(OFPANG )
OVRDBF FILE(OFPAS  ) MBR(OFPASR )
OVRDBF FILE(OFPAS  ) MBR(OFPASB )
OVRDBF FILE(OFPAS  ) MBR(OFPASN )
OVRDBF FILE(OFPAS  ) MBR(OFCOMM )
OVRDBF FILE(OFPAS  ) MBR(OFCOMG )
OVRDBF FILE(OFPAS  ) MBR(OFCOMP )
OVRDBF FILE(OFPAS  ) MBR(OFPASC )
OVRDBF FILE(OFPAS  ) MBR(OFPASF )
OVRDBF FILE(OFPAS  ) MBR(OFPASE )
OVRDBF FILE(OFPAS  ) MBR(OFCOMF )
** LIB **
Mutation Imp/CXH/CC.
Suppléments
Suppl. + mutation
Mutation Feuille CC.
