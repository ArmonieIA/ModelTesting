      *%CSTD===========================================================*
      ** Application. : EMAGE      Logiciel métier DS Smith            *
      ** Composant. . : CDEC98£                       Type: RPG        *
      **===============================================================*
      ** Sous-système :                                                *
      ** Fonction . . :                                                *
      ** Sous-fonction:                                                *
      **%S=============================================================*
      ** Description des fonctionnalités:                              *
      **                                                               *
      **                                                               *
      **                                                               *
      **%E=============================================================*
      ** AUTEUR:                          00:00                        *
      ** MODIFS: 04 TMAAQU     28/03/2023 16:17  90.60.85 FM 23/   23  *
      **           gestion du nouveau CCOL=6 COMPACT Format/format     *
      **         03 NOUZIERES  02/03/2022 16:14  01.07.19 FM 22/   66  *
      **           gestion des nouveaux tarifs                         *
      **         02 TMAAQU     24/01/2022 15:01  01.06.91 FM 22/   20  *
      **           Modif M de 1.0 à 2.0                                *
      **         01 TMAOCL     04/07/2019 17:22  01.01.50 FM 19/  176  *
      **           INC0731214 - Ajout nouveau code CF ('B')            *
      *%ECSTD==========================================================*
     ***************************************************************
     *                                                             *
     *          PGM: CDEC98£  REALISE PAR REMI COURTAINE           *
     *                                                             *
     *            BON DE FABRICATION TOURY                         *
     *            ------------------------                         *
     ***************************************************************
     *            INDICATEURS UTILISES DANS LE PROGAMME            *
     *                                                             *
     *  TOUTES LES ZONES D'EDITION SONT NOMMEES VXXX EN MARGE      *
     *                                                             *
     ***************************************************************
     *  Modif : 05/03/2015  Par : Philippe Le Cardinal                *
     *  But   : Suppression du fichier "Siecle" & recherche du siècle *
     *   via le fichier CALENAL0 (AA/MM/JJ)                           *
     *----------------------------------------------------------------*
     *  Modif : xx/xx/xxxx  Par : Xxxxxxxxxxxxxxxxxxxxxxxxx           *
     *  But   : Xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx *
     *------------------------------------------------------------------*
     FPRLANCXGUF  E           K        DISK
     FPRLANCLUUF  E           K        DISK
     F            PRLANCF1                          KRENAMEPRLANCU
     FPRLANCX4UF  E           K        DISK
     F            PRLANCF1                          KRENAMEPRLANC4
     FCARCDEL1IF  E           K        DISK
     FCARCDEZ8IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEU
     FCARCDEZ1IF  E           K        DISK
     F            CARCDEF1                          KRENAMECARCDEZ
     FCLIENTS1IF  E           K        DISK
     FPRODUL10IF  E           K        DISK
     FPRODST2 IF  E           K        DISK
     FCALENJL7IF  E           K        DISK
     FCALENS  IF  E           K        DISK
     FONDULEL1IF  E           K        DISK
     FPREIMPL IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FQUAUSI  IF  E           K        DISK
     FPLANIFL1IF  E           K        DISK
     FPLANIFL3IF  E           K        DISK
     F            PLANIFF1                          KRENAMEPLANIFF
     FHISTOF16IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FBESOMAL1IF  E           K        DISK
     FPLAMAL1 IF  E           K        DISK
     FRESCXHL3IF  E           K        DISK
     FRESPAPL2IF  E           K        DISK
     F            RESPAPF1                          KRENAMERESPAP2
     FCDESL1  IF  E           K        DISK
     FOBSPROL1UF  E           K        DISK
     FCDEQUAL1IF  E           K        DISK
     FFORDECL1IF  E           K        DISK
     FFORINTL3IF  E           K        DISK
     FFORMAG  IF  E           K        DISK
     FCAIPALL1IF  E           K        DISK
     FCLILIVL1IF  E           K        DISK                               LANC22
     FLIEUSTL3IF  E           K        DISK                               PROD17
     FMACHIN  IF  E           K        DISK                               PROD17
     FSTACOML8IF  E           K        DISK
     *--- Début --- Philippe  --- 05/03/2015 --*
     * - suppression du fichier siécle pour récupérer le siécle car il existe
     * dans le fichier CALENS; Utilisation de ce dernier pour le rechercher
    F**SIECLE  IF  E           K        DISK
     FCALENAL0IF  E           K        DISK
     F            CALENDF1                          KRENAMECALENSF1
     *--- Fin   --- Philippe  --- 05/03/2015 --*
     FCODBARL2IF  E           K        DISK
     FCAROFL3 UF  E           K        DISK                      A
     FCDECXHL2IF  E           K        DISK
     FCLIOBIL2IF  E           K        DISK
     FRESTPSLDIF  E           K        DISK
     FMAJPROL1IF  E                    DISK                      A
     FETATFABTO   F     132            PRINTER                        UC  PROD20
     *
     *****************************************************************
     *     TABLES INTERNES
     *****************************************************************
     E                    TI      1   7  1 0 LIM     9
     E                    CON     1  30 40
     E                    ETA     1   7  1   LET    12
     E                    TIM         7  1 0 TRE     1 0
     E                    COP         7  1
     E                    STD         7  4 1
     E                    FOH         7  4 0 FOL     4 0
     E                    VAR        20 40   VDT     6
     E                    CDE        10  7 0
     E                    SUP         5 93
     E                    TAL         7  3 2
     E                    CAR        75  1
     E                    WAR        40  1
     E                    EMB        56 25   MAE     5 0
     E                    DC         56  6 0 CAI     3 0
     E                    DIT        51 90
     E                    TSX         9  7 0A
     E                    TB          9  2 0
     E                    CXT       100  2               CODES EXTER.
     E                    NOE         7  1 0 POS     2 0
     E                    REF         7 40
     E                    PRE         7  9 0
     E                    OBS         5 40
     E                    SCX         5 14 0
     *****************************************************************
     *
     IONDULEF1
     I              ZONE1                           WONE1
     I              ZONE2                           WONE2
     I              ZONE3                           WONE3
     I              ZONE4                           WONE4
     I              ZONE5                           WONE5
     *
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     *  ZONES DE QUAUSI  RENOMMEES  COMMENCENT PAR Y
     IQUAUSIF1
     I              SUIVI                           SUISUI
     *  ZONES DE PRODUI2 RENOMMEES  COMMENCENT PAR Y
     IPRODUIF1
     I              PDUNI                           YDUNI
     I              FACON                           YACON
     I              GARNT                           YARNT
     I              NOFOR                           YOFOR
     I              ONDL                            YNDL
     I              ONDH                            YNDH
     I              POSFO                           YOSFO
     I              POSF1                           YOSF1
     I              POSF2                           YOSF2
     I              ACOTE                           YCOTE
     I              TIMP1                           TIM,1
     I              TIMP2                           TIM,2
     I              TIMP3                           TIM,3
     I              TIMP4                           TIM,4
     I              TIMP5                           TIM,5
     I              TIMP6                           TIM,6
     I              TIMP7                           TIM,7
     I              TREP1                           TRE,1
     I              TREP2                           TRE,2
     I              TREP3                           TRE,3
     I              TREP4                           TRE,4
     I              TREP5                           TRE,5
     I              TREP6                           TRE,6
     I              TREP7                           TRE,7
     I              COUP2                           COP,2
     I              COUP3                           COP,3
     I              COUP4                           COP,4
     I              COUP5                           COP,5
     I              COUP6                           COP,6
     I              COUP7                           COP,7
     I              FORH1                           FOH,1
     I              FORH2                           FOH,2
     I              FORH3                           FOH,3
     I              FORH4                           FOH,4
     I              FORH5                           FOH,5
     I              FORH6                           FOH,6
     I              FORH7                           FOH,7
     I              FORL1                           FOL,1
     I              FORL2                           FOL,2
     I              FORL3                           FOL,3
     I              FORL4                           FOL,4
     I              FORL5                           FOL,5
     I              FORL6                           FOL,6
     I              FORL7                           FOL,7
     I              CCOL                            YCOL
     I              ONDUL                           YNDUL
     I              ANDEV                           YNDEV
     I              ETUDE                           YTUDE
     I              SEQDE                           YEQDE
     I              LMINI                           YMINI
     I              TDECO                           YDECO
     *  ZONES DE CDES   RENOMMEES  COMMENCENT PAR W
     ICDESF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              CDEPRE                          WW4
     I              AGENT                           WW1
     I              USINE                           WW2
     I              QTOT                            WTOT
     I              UVENT                           WVENT
     I              MICLI                           WICLI
     I              MACLI                           WACLI
     I              PROTO                           WPROTO
     *  ZONES DE PRLANC RENOMMEES  COMMENCENT PAR W
     IPRLANCF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WDEPRE
     I              PRIORI                          WRIORI
     I              SUIMP                           WUIMP
     IPRLANC4
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WDEPRE
     I              PRIORI                          WRIORI
     I              SUIMP                           WUIMP
     IPRLANCU
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              CDEPRE                          WDEPRE
     I              PRIORI                          WRIORI
     I              SUIMP                           WUIMP
     ICARCDEZ
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     *  ZONES DE CARCDE RENOMMEES  COMMENCENT PAR W
     ICARCDEF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              USEXT                           WSEXT
     I              USINT                           WSINT
     I              USINE                           WSINE
     I              AGENT                           WGENT
     I              CDEPRE                          WDEPR2
     I              GARNT                           WARNT
     I              ANDEL                           WNDEL
     I              RGFAC                           WGFAC
     I              RGLIV                           WGLIV
     I              QTFAC                           WTFAC
     I              EDFABM                          WDFABM
     I              EDFABJ                          WDFABJ
     I              PEXPA                           WWXPA
     I              PEXPS                           WWXPS
     I              NBRBOB                          WBRBOB
     *  ZONES DE MAJPROD
     IMAJPROF1
     I              STE                             WTE
     I              NOCLI                           WOCLI
     I              NOPRO                           WOPRO
     I              NCONF                           WCONF
     I              SEQFAB                          WEQFAB
     I              USEXT                           WSEXT
     I              USINT                           WSINT
     I              USINE                           WSINE
     I              AGENT                           WGENT
     I              CDEPRE                          WDEPR2
     I              GARNT                           WARNT
     I              ANDEL                           WNDEL
     I              RGFAC                           WGFAC
     I              RGLIV                           WGLIV
     I              QTFAC                           WTFAC
     I              EDFABM                          WDFABM
     I              EDFABJ                          WDFABJ
     I              NBRBOB                          WBRBOB
     ICARCDEU
     I              AGENT                           WW1
     I              CDEPRE                          WW5
     *
     *  FICHIER STACOML1
     ISTACOMF1
     I              AGENT                           WW1
     I              NCONF                           WWC
     I              NOPRO                           WWP
     I              GARNT                           WWG
     I              STE                             WWE
     I              NOCLI                           WWNO
     I              QTOT                            WWQ
     I              USINE                           WWU
     I              GROUPE                          WWGR
     *  ZONES DE HISTOFA2 RENOMMEES  COMMENCENT PAR X
     IHISTOFA
     I              NCONF                           XCONF
     I              NOSEQ                           XOSEQ
     I              DECL                            WECL1
     I              DECH                            WECH1
     I              FMINL                           WMINL
     I              FMINH                           WMINH
     *  ZONES DE BESOMAT  RENOMMEES  COMMENCENT PAR B
     IBESOMATF
     I              LMINI                           BMINI
     I              UVENT                           BVENT
     I              QTFAB                           BTFAB
     I              QTTOT                           BTTOT
     I              QTPRE                           BTPRE
     I              QTREN                           BTREN
     I              TALO1                           TAL,1
     I              TALO2                           TAL,2
     I              TALO3                           TAL,3
     I              TALO4                           TAL,4
     I              TALO5                           TAL,5
     I              TALO6                           TAL,6
     I              TALO7                           TAL,7
     I              STD1                            STD,1
     I              STD2                            STD,2
     I              STD3                            STD,3
     I              STD4                            STD,4
     I              STD5                            STD,5
     I              STD6                            STD,6
     I              STD7                            STD,7
     *  ZONES DE PLANIFL1 RENOMMEES
     IPLANIFF1
     I              I                               PAS
     I              SUREG                           WUREG
     I              USFAB                           WUSFAB
     *  ZONES DE PLANIFL3 RENOMMEES
     IPLANIFF
     I              I                               PAS
     I              SUREG                           WUREG
     I              USFAB                           WUSFAB
     *  ZONES DE PLAMA    RENOMMEES
     IPLAMAF1
     I              USFAC                           XUSFAC
     *
     *  ZONES DE CODBAR   RENOMMEES
     ICODBARF1
     I              SUIMP                           NOEMB
     *
     *  ZONES DE OBSPROL  RENOMMEES
     IOBSPROF1
     I              AA                              ACRE
     I              MM                              MCRE
     I              JJ                              JCRE
     *
     ICAROFF1
     I              SECT                            CECT
     I              SSECT                           CSECT
     I              NOMAC                           COMAC
     I              TIMP                            CIMP
     I              PRIORI                          WRIORI
     I              SOBESO                          COBESO
     I              KGFAB                           CGFAB
     I              FEFAB                           CEFAB
     *
     ICDECXHF1
     I              PAPI                            CX1
     I              GRAMM                           CX2
     I              REFOUR                          CX3
     I              GRAREL                          CX4
     I              TIMP                            CX5
     I              LAIZE                           CX6
     I              USINE                           CX7
     *
     IFORINTF1
     I              RANG                            CANG
     *  ZONES DE RESTPSLD RENOMMEES
     IRESTPSF1
     I              I                               $AS
     I              USFAB                           $USFAB
     I              NOMAC                           $OMAC
     I              QTENET                          $TENET
     *
     *****************************************************************
     *     RUPTURES   ET  DS
     *****************************************************************
     * Zone de Communications de Données DATCDE
     * ----------------------------------------
     *
     I            DS
     I                                        1   20AA
     I                                        3   40MM
     I                                        5   60JJ
     I                                        1   60DATEJ
     *
     I            DS
     I                                        1  14 SUIVAN
     I                                        1   1 SUIV1
     I                                        8   8 SUIV2
     I                                       14  14 SUIV3
     *
     I            DS
     I                                        1   3 YDECO
     I                                        1   1 TDECO1
     I                                        3   3 TDECO3
     *
     I            DS
     I                                        1  100DEVIS
     I                                        1   20YNDEV
     I                                        3   60YTUDE
     I                                        7  100YEQDE
     *
     I            DS
     I                                        1   60DDEF
     I                                        1   20ADEF
     I                                        3   40MDEF
     I                                        5   60JDEF
     *
     I            DS
     I                                        1   60DSETAT
     I                                        1   10ETATE
     I                                        2   20ETATI
     I                                        3   30ETATD
     *
     I            DS
     I                                        1   60DDEFOR
     I                                        1   20ADEFOR
     I                                        3   40MDEFOR
     I                                        5   60JDEFOR
     *
     IBT3         DS
     I                                        1   1 BLANC
     I                                        2   20YACON
     I                                        3   40COAS1
     *
     I            DS
     I                                        1   40DALAN
     I                                        1   20LANIMP
     I                                        3   40LANFAC
     *
     I            DS
     I                                        1   60V006
     I                                        1   20V0061
     I                                        3   40V0062
     I                                        5   60V0063
     *
     *
     I            DS
     I                                        1   60X014
     I                                        1   20DAYX
     I                                        3   40MONTHX
     I                                        5   60YEAR1X
     *
     I            DS
     I                                        1   60DATFAB
     I                                        1   20AFAB
     I                                        3   40MFAB
     I                                        5   60JFAB
     *
     I            DS
     I                                        1   60DTMAJ
     I                                        1   20JMAJ
     I                                        3   40MMAJ
     I                                        5   60AMAJ
     *
     I            DS
     I                                        1   60DTPAN
     I                                        1   20PANAA
     I                                        3   40PANMM
     I                                        5   60PANJJ
     *
     I            DS
     I                                        1   60DTPRDE
     I                                        1   20AAPRDE
     I                                        3   40MMPRDE
     I                                        5   60JJPRDE
     *
     I            DS
     I                                        1   50DAPRDE
     I                                        1   20APRDE
     I                                        3   40SPRDE
     I                                        5   50JPRDE
     *
     I            DS
     I                                        1   60DTCRE
     I                                        1   20JCRE
     I                                        3   40MCRE
     I                                        5   60ACRE
     *
     I            DS
     I                                        1   60V003
     I                                        1   20V0031
     I                                        3   40V0032
     I                                        5   60V0033
     *
     I            DS
     I                                        1 100 PARAM2
     I                                        1   10PUS
     *
     I            DS
     I                                        1  40 V026
     I                                       25  40 V0261
     I                                       28  280V0262
     *
     I            DS
     I                                        1 240 VIMPL1
     I                                      241 280 VIMPL2
     I                                        1  40 V0541
     I                                       41  80 V0551
     I                                       81 120 V0561
     I                                      121 160 V0571
     I                                      161 200 V0581
     I                                      201 240 V0591
     I                                      241 280 V0601
     *
     I            DS
     I                                        1  42 VIMPD
     I                                        1   60V0542
     I                                        7  120V0552
     I                                       13  180V0562
     I                                       19  240V0572
     I                                       25  300V0582
     I                                       31  360V0592
     I                                       37  420V0602
     *
     I            DS
     I                                        1 240 VDECL1
     I                                      241 280 VDECL2
     I                                        1  40 V0711
     I                                       41  80 V0721
     I                                       81 120 V0731
     I                                      121 160 V0741
     I                                      161 200 V0751
     I                                      201 240 V0761
     I                                      241 280 V0771
     *
     I            DS
     I                                        1  42 VDECD
     I                                        1   60V0712
     I                                        7  120V0722
     I                                       13  180V0732
     I                                       19  240V0742
     I                                       25  300V0752
     I                                       31  360V0762
     I                                       37  420V0772
     *
     I            DS
     I                                        1 240 VASSL1
     I                                      241 280 VASSL2
     I                                        1  40 V0911
     I                                       41  80 V0921
     I                                       81 120 V0931
     I                                      121 160 V0941
     I                                      161 200 V0951
     I                                      201 240 V0961
     I                                      241 280 V0971
     *
     I            DS
     I                                        1  42 VASSD
     I                                        1   60V0912
     I                                        7  120V0922
     I                                       13  180V0932
     I                                       19  240V0942
     I                                       25  300V0952
     I                                       31  360V0962
     I                                       37  420V0972
     *
     IDSPARA      DS
     I                                        1   50WCONF1
     I                                        6   90WOPRO1
     I                                       10  160SURF
     I                                       17  203SF
     I                                       21  270MIN
     I                                       28  340MAX
     I                                       35  35 DS1
     I                                       36  420SURFF
     I                                       43  43 PROT
     I                                       44  470WOCLI1
     *
     I            DS
     I                                        1  93 W084
     I                                        1   3 V0841
     I                                        4   6 V0842
     I                                        7   90V0843
     I                                       10  12 V0844
     I                                       13  150V0845
     I                                       16  16 V0846
     I                                       17  200V0847
     I                                       21  21 V0848
     I                                       22  250V0849
     I                                       26  291V084A
     I                                       30  38 V084B
     I                                       45  500V084D
     I                                       51  570V084E
     I                                       58  59 V084F
     I                                       60  68 V084G
     I                                       69  73 V084H
     I                                       74  78 V084I
     I                                       79  790V084IN
     I                                       80  81 LM84
     I                                       82  870V084D2
     I                                       88  93 V08442
     *
     I            DS
     I                                        1  93 W085
     I                                        1   3 V0851
     I                                        4   6 V0852
     I                                        7   90V0853
     I                                       10  12 V0854
     I                                       13  150V0855
     I                                       16  16 V0856
     I                                       17  200V0857
     I                                       21  21 V0858
     I                                       22  250V0859
     I                                       26  291V085A
     I                                       30  38 V085B
     I                                       45  500V085D
     I                                       51  570V085E
     I                                       58  59 V085F
     I                                       60  68 V085G
     I                                       69  73 V085H
     I                                       74  78 V085I
     I                                       79  790V085IN
     I                                       80  81 LM85
     I                                       82  870V085D2
     I                                       88  93 V08542
     *
     I            DS
     I                                        1  93 W086
     I                                        1   3 V0861
     I                                        4   6 V0862
     I                                        7   90V0863
     I                                       10  12 V0864
     I                                       13  150V0865
     I                                       16  16 V0866
     I                                       17  200V0867
     I                                       21  21 V0868
     I                                       22  250V0869
     I                                       26  291V086A
     I                                       30  38 V086B
     I                                       45  500V086D
     I                                       51  570V086E
     I                                       58  59 V086F
     I                                       60  68 V086G
     I                                       69  73 V086H
     I                                       74  78 V086I
     I                                       79  790V086IN
     I                                       80  81 LM86
     I                                       82  870V086D2
     I                                       88  93 V08642
     *
     I            DS
     I                                        1  93 W087
     I                                        1   3 V0871
     I                                        4   6 V0872
     I                                        7   90V0873
     I                                       10  12 V0874
     I                                       13  150V0875
     I                                       16  16 V0876
     I                                       17  200V0877
     I                                       21  21 V0878
     I                                       22  250V0879
     I                                       26  291V087A
     I                                       30  38 V087B
     I                                       45  500V087D
     I                                       51  570V087E
     I                                       58  59 V087F
     I                                       60  68 V087G
     I                                       69  73 V087H
     I                                       74  78 V087I
     I                                       79  790V087IN
     I                                       80  81 LM87
     I                                       82  870V087D2
     I                                       88  93 V08742
     *
     I            DS
     I                                        1  93 W088
     I                                        1   3 V0881
     I                                        4   6 V0882
     I                                        7   90V0883
     I                                       10  12 V0884
     I                                       13  150V0885
     I                                       16  16 V0886
     I                                       17  200V0887
     I                                       21  21 V0888
     I                                       22  250V0889
     I                                       26  291V088A
     I                                       30  38 V088B
     I                                       45  500V088D
     I                                       51  570V088E
     I                                       58  59 V088F
     I                                       60  68 V088G
     I                                       69  73 V088H
     I                                       74  78 V088I
     I                                       79  790V088IN
     I                                       80  81 LM88
     I                                       82  870V088D2
     I                                       88  93 V08842
     *
     I            DS
     I                                        1  20 V041
     I                                        1   40V0411
     I                                        6   7 V0412
     I                                        9   9 V0413
     I                                       11  140V0414
     I                                       16  17 V0415
     I                                       19  200V0416
     *
     I            DS
     I                                        1  20 V043
     I                                        1   40V0431
     I                                        6   7 V0432
     I                                        9   9 V0433
     I                                       11  140V0434
     I                                       16  17 V0435
     I                                       19  200V0436
     *
     I            DS
     I                                        1  20 W043
     I                                        1   3 W0431
     I                                        5   80W0432
     I                                       10  10 W0433
     I                                       12  130W0434
     I                                       15  15 W0435
     I                                       16  190W0436
     *
     I            DS
     I                                        1   4 TYPCOL
     I                                        1   2 COLRH
     I                                        3   30YNDUL
     I                                        4   40YCOL
     *
     I            DS
     I                                        1   50DTDEL
     I                                        1   20ANDEL
     I                                        3   40SEDEL
     I                                        5   50JSDEL
     *
     I            DS
     I                                        1   50DTDDEL
     I                                        1   20ADEDEL
     I                                        3   40SDEDEL
     I                                        5   50JDEDEL
     *
     I            DS
     I                                        1   2 HABIL1
     I                                        1   1 HABI11
     I                                        2   2 HABI12
     *
     I            DS
     I                                        1   2 HABIL2
     I                                        1   1 HABI21
     I                                        2   2 HABI22
     *
     I            DS
     I                                        1   2 HABIL3
     I                                        1   1 HABI31
     I                                        2   2 HABI32
     *
     I            DS
     I                                        1  13 VARNT
     I                                        1   9 YARNT2
     I                                       12  13 YARNT
     I                                       12  12 YARNT1
     I                                       13  13 YARNT3
     *
     I            DS
     I                                        1  30 WDEC
     I                                        1  19 WDEC1
     I                                       20  23 WDEC2
     I                                       25  25 WDEC3
     I                                       27  30 WDEC4
     *
     I            DS
     I                                        1 240 VCTL1
     I                                        1  40 VCT01
     I                                       41  80 VCT02
     I                                       81 120 VCT03
     I                                      121 160 VCT04
     I                                      161 200 VCT05
     I                                      201 240 VCT06
     *
     I            DS
     I                                        1 240 VCTL2
     I                                        1  40 VCT07
     I                                       41  80 VCT08
     I                                       81 120 VCT09
     I                                      121 160 VCT10
     I                                      161 200 VCT11
     I                                      201 240 VCT12
     I            DS
     I                                        1  36 VDTL1
     I                                        1   6 VDT01
     I                                        7  12 VDT02
     I                                       13  18 VDT03
     I                                       19  24 VDT04
     I                                       25  30 VDT05
     I                                       31  36 VDT06
     *
     I            DS
     I                                        1  36 VDTL2
     I                                        1   6 VDT07
     I                                        7  12 VDT08
     I                                       13  18 VDT09
     I                                       19  24 VDT10
     I                                       25  30 VDT11
     I                                       31  36 VDT12
     *
     I            DS
     I                                        1  90 V100
     I                                        1  75 V1001
     I                                       76  810V1002
     I                                       82  840V1003
     I                                       85  900V1004
     *
     I            DS
     I                                        1  90 V101
     I                                        1  75 V1011
     I                                       76  810V1012
     I                                       82  840V1013
     I                                       85  900V1014
     *
     I            DS
     I                                        1  90 V102
     I                                        1  75 V1021
     I                                       76  810V1022
     I                                       82  840V1023
     I                                       85  900V1024
     *
     I            DS
     I                                        1  90 V103
     I                                        1  75 V1031
     I                                       76  810V1032
     I                                       82  840V1033
     I                                       85  900V1034
     *
     I            DS
     I                                        1  90 V104
     I                                        1  75 V1041
     I                                       76  810V1042
     I                                       82  840V1043
     I                                       85  900V1044
     *
     I            DS
     I                                        1  90 V105
     I                                        1  75 V1051
     I                                       76  810V1052
     I                                       82  840V1053
     I                                       85  900V1054
     *
     I            DS
     I                                        1  90 V106
     I                                        1  75 V1061
     I                                       76  810V1062
     I                                       82  840V1063
     I                                       85  900V1064
     *
     I            DS
     I                                        1  90 V107
     I                                        1  75 V1071
     I                                       76  810V1072
     I                                       82  840V1073
     I                                       85  900V1074
     *
     I            DS
     I                                        1  90 V108
     I                                        1  75 V1081
     I                                       76  810V1082
     I                                       82  840V1083
     I                                       85  900V1084
     *
     I            DS
     I                                        1  90 V109
     I                                        1  75 V1091
     I                                       76  810V1092
     I                                       82  840V1093
     I                                       85  900V1094
     *
     I            DS
     I                                        1  90 V110
     I                                        1  75 V1101
     I                                       76  810V1102
     I                                       82  840V1103
     I                                       85  900V1104
     *
     *
     I            DS
     I                                        1   8 COLF
     I                                        1   2 COLF1
     I                                        4   8 COLF2
     *
     I            DS
     I                                        1   5 ZB86
     I                                        1   4 ZB861
     I                                        5   5 ZB862
     *
     I            DS
     I                                        1  47 TIRPMS
     I                                        1   2 TIRE1
     I                                        3  11 TIRE2
     I                                        7   7 TT1
     I                                       12  21 TIRE3
     I                                       22  22 TT2
     I                                       23  24 TIRI1
     I                                       25  33 TIRI2
     I                                       29  29 TT3
     I                                       34  43 TIRI3
     *
     I            DS
     I                                        1   9 TNIMPE
     I                                        1   4 NIMPE1
     I                                        6   9 NIMPE2
     *
     I            DS
     I                                        1   9 TNIMPI
     I                                        1   4 NIMPI1
     I                                        6   9 NIMPI2
     *
     I            DS
     I                                        1 100 DSEMBP
     I                                        1   10EUS
     I                                        2   20ETE
     I                                        3   60EOCLI
     I                                        7  100EOPRO
     I                                       11  150ECONF
     I                                       16  170EEQFAB
     I                                       18  240ETLANC
     *
     I            DS
     I                                        1  40 CQU
     I                                        1  10 LIBCON
     I                                       13  22 LIBQUA
     I                                       25  34 LIBUTC
     *
     I            DS
     I                                        1  20 REFCO
     I                                       21  40 CLICO
     I                                        1  40 REFPRO
     *
     I            DS
     I                                        1   7 DEMAN
     I                                        1   6 RIREP
     *
     I            DS
     I                                        1  40 STAB
     I                                       28  30 STAB2
     I                                       37  40 STAB3
     *
     I            DS
     I                                        1  140CXHSPE
     I                                        1   50FORCXH
     I                                        6   60STECXH
     I                                        7  100CLICXH
     I                                       11  140PROCXH
     *
     I            DS
     I                                        1   90PREIMP
     I                                        1   10CIMP
     I                                        2   50NIMP2
     I                                        6   90NIMP3
     *
     I            DS
     I                                        1  40 PXLIBE
     I                                       21  22 TYP1
     I                                       24  25 TYP2
     *
     I            DS
     I                                        1   2 CNDD
     I                                        1   1 CNDD1
     I                                        2   2 CNDD2
     *
     I            DS
     I                                        1   8 CANDD
     I                                        1   4 CAN1
     I                                        5   6 CAN2
     *
     I            DS
     I                                        1  40 DECAL
     I                                        1  25 DECAL1
     I                                       26  40 DECAL2
     I            DS
     I                                        1   40HHMM
     I                                        1   20HHMAJ
     I                                        3   40MNMAJ
     *
     I            DS
     I                                        1  15 QUALT
     I                                        1   3 PAPI
     I                                        4   60GRAMM
     I                                        7  12 REFOUR
     I                                       13  150GRAREL
     *
     I            DS
     I                                        1   1 DZPNBR
     I                                        2   2 DZPNB2
     I                                        1   2 SUPHA2
     *
    I*
     *****************************************************************
     *     CLES D'ACCES AUX FICHIERS
     *****************************************************************
     *--- Début --- Philippe  --- 05/03/2015 --*
     * - Clé d'accès au ficheir CALENAL0
     C           KL0       KLIST
     C                     KFLD           AA
     C                     KFLD           MM
     C                     KFLD           JJ
     *--- Fin   --- Philippe  --- 05/03/2015 --*
     *
     * cle pour le fichier parametre .
     C           KPARAM    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *
     * cle pour le fichier PRLANC .
     C           KPRLAN    KLIST
     C                     KFLD           PUS
     C                     KFLD           PECPAP
     C                     KFLD           PANSS
     C                     KFLD           PANAA
     C                     KFLD           PANMM
     C                     KFLD           PANJJ
     *
     C           KPRLA2    KLIST
     C                     KFLD           PUS
     C                     KFLD           PECPAP
     *
     * cle pour le fichier PRLANCL0
     C           KPRLA1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WWQFAB
     C                     KFLD           PECPAP
     *
     * cle pour le fichier CDECXHL2
     C           KCXHL2    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQWEQ  20
     C                     KFLD           SUPPOR
     C                     Z-ADD0         WEQWEQ
     *
     * cle pour le fichier CARCDE .
     C           KCARCD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     *
     C           KCARCU    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     * cle pour le fichier CARCDEZ8
     C           KCARZ8    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           CSS
     C                     KFLD           CAA
     C                     KFLD           CMM
     C                     KFLD           CJJ
     *
     C           KCARLU    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     * cle pour le fichier STACOM
     C           KSTAL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           SSS
     C                     KFLD           AAA
     C                     KFLD           MMM
     *
     *
     * cle pour le fichier CALENS .
     C           KCALEN    KLIST
     C                     KFLD           YEARS   20
     C                     KFLD           YEAR
     C                     KFLD           MONTH
     C                     KFLD           DAY
     *
     C           KDPRDE    KLIST
     C                     KFLD           SSPRDE
     C                     KFLD           AAPRDE
     C                     KFLD           MMPRDE
     C                     KFLD           JJPRDE
     *
     * cle pour le fichier CALENJL7 .
     C           KCAL07    KLIST
     C                     KFLD           YEARS
     C                     KFLD           YEAR
     C                     KFLD           CALNOJ
     *
     *  CLE D'ACCES FICHIER CLIENTS
     C           KCLIL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     *
     *  CLE D'ACCES FICHIER CLILIV
     C           KCLILI    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WGLIV
     *
     *  CLE D'ACCES FICHIER HISTOF16
     C           KHISL6    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO   40
     C                     KFLD           WECT    1
     C                     KFLD           WSECT   1
     C                     KFLD           SSFAB
     C                     KFLD           DATFAB
     *
     C           KHIS06    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WECT
     C                     KFLD           WSECT
     *
     C           KHIS16    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           ANPRO
     C                     KFLD           WECT    1
     C                     KFLD           WSECT   1
     *
     C           KHIS26    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           ANPRO
     C                     KFLD           WECT
     C                     KFLD           WSECT
     C                     KFLD           SSFAB
     C                     KFLD           DATFAB
     *
     *  CLE D'ACCES FICHIER CDESL1 ET PLANIFL3
     C           KCDES1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     C           KPLAL3    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           RANG    20
     *
     *  CLE D'ACCES FICHIER PRODUI2
     C           KPRO10    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     C           KPROST    KLIST
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *
     *  CLE D'ACCES FICHIER MVTIMP
     C           KMVT1F    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           UNITE
     *
     C           KMVTLF    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           UNITE
     C                     KFLD           SUPPOR
     *
     C           KMVTPR    KLIST
     C                     KFLD           STEE    10
     C                     KFLD           WIMP1
     C                     KFLD           WIMP2
     *
     *  CLE D'ACCES FICHIER OBSPROL
     C           KOBSP1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     *
     C           KOBSP2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           DEST
     C                     KFLD           EMET
     *
     *  CLE D'ACCES FICHIER PREIMPL
     C           KPREI1    KLIST
     C                     KFLD           WIMP1
     C                     KFLD           WIMP2
     *  CLE D'ACCES FICHIER PLAMA
     C           KPLAM1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     *
     C           KPLAM2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     *
     C           KPLAM3    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WWQFAB
     *
     *  CLE D'ACCES FICHIER RESCXHL3
     C           KCXHL3    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     C                     KFLD           WRIORI
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     *
     *  CLE D'ACCES FICHIER RESPAPL2
     C           KRESP2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     *
     *  CLE D'ACCES FICHIER CLIOBI
     C           KCLIOB    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WCOD    8
     *
     *  CLE D'ACCES FICHIER BESOMAT
     C           KBESL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER QUAUSI
     C           KUSIL1    KLIST
     C                     KFLD           PUS
     C                     KFLD           PAPI
     C                     KFLD           GRAMM
     C                     KFLD           REFOUR
     C                     KFLD           GRAREL
     C                     KFLD           FOUB
     *
     *  CLE D'ACCES FICHIER PLANIFL1
     C           KPLAL1    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WECT
     C                     KFLD           WSECT
     *
     C           KPLAL2    KLIST
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     C                     KFLD           WCONF
     C                     KFLD           WECT
     *
     * cle pour le fichier CAIPALL1
     C           KCAIL1    KLIST
     C                     KFLD           PUS
     C                     KFLD           WTE
     C                     KFLD           WOCLI
     C                     KFLD           WOPRO
     *
     *
     *  CLE D'ACCES FICHIER CDEQUA
     C           KQUAL1    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     *
     *  CLE D'ACCES FICHIER MACHIN
     C           KMAC01    KLIST
     C                     KFLD           PUS
     C                     KFLD           WECT
     C                     KFLD           WSECT
     C                     KFLD           NOMAC
     *
     C           KMAC02    KLIST
     C                     KFLD           PUS
     C                     KFLD           CECT
     C                     KFLD           CSECT
     C                     KFLD           COMAC
     * cle pour le fichier ONDULE
     C           KONDUL    KLIST
     C                     KFLD           YNDUL
     C                     KFLD           YCOL
     *
     *
     *  CLE D'ACCES FICHIER CAROFL3
     C           KCOFL3    KLIST
     C                     KFLD           PUS
     C                     KFLD           WCONF
     C                     KFLD           WEQFAB
     C                     KFLD           WOPRO
     C                     KFLD           WRIORI
     * cle pour le fichier FORINT
     C           KFORIN    KLIST
     C                     KFLD           YOFOR
     C                     KFLD           CODINT
     *
     *  CLE D'ACCES FICHIER RESTPSLD
     C           KRESLD    KLIST
     C                     KFLD           WCONF
     C                     KFLD           WOPRO
     C                     KFLD           WEQFAB
     C                     KFLD           WRIORI
     *
     *
     C           *ENTRY    PLIST
     C                     PARM           PARAM 100
     C                     MOVE PARAM     PARAM2
     ***************************************************************
     *   DEBUT DU PROGRAMME                                        *
     ***************************************************************
     C  N99 99             READ MAJPROL1                 80
     C                     Z-ADD0         C       30
     C                     Z-ADD0         PREIMP
     C                     MOVE 'CEXT'    PXARGU
     C           PXARGU    CHAINPARAME               80
D1  C           *IN80     DOWEQ'0'
D2  C           PXMONT    IFEQ 0
     C                     ADD  1         C
     C                     MOVE PXVALE    CXT,C
F2  C                     END
     C           PXARGU    READEPARAME                   80
F1  C  N80                END
     C           *NAMVAR   DEFN           DATCDE  6
     C                     IN   DATCDE
     C                     MOVE DATCDE    DATEJ
     *
     C                     MOVE 'USFO'    PXARGU
     C           PXARGU    SETLLPARAME
D1  C                     DO   *HIVAL    I
     C           PXARGU    READEPARAME                   50
D2  C           *IN50     IFEQ '0'
     C                     MOVE PXVALE    TSX,I
     C                     Z-ADDPXMONT    TB,I
F2  C                     END
F1  C  N50                END
     *
     C                     Z-ADD0         SURF
     C                     Z-ADD0         SF
     C                     Z-ADD0         MAX
     C                     Z-ADD0         MIN
     C                     Z-ADD0         DTMAJ
     C                     Z-ADD0         DTCRE
     C                     MOVE *ZEROS    VIMPD
     C                     MOVE *ZEROS    VDECD
     C                     MOVE *ZEROS    VASSD
     C                     MOVE *ZEROS    VDTL1
     C                     MOVE *ZEROS    VDTL2
     C                     MOVE *BLANKS   V041
     C                     Z-ADD*ZEROS    V0411
     C                     Z-ADD*ZEROS    V0414
     C                     Z-ADD*ZEROS    V0416
     C                     MOVE *BLANKS   V043
     C                     Z-ADD*ZEROS    V0431
     C                     Z-ADD*ZEROS    V0434
     C                     Z-ADD*ZEROS    V0436
     C                     MOVE *BLANKS   V100
     C                     MOVE *ZEROS    V1002
     C                     MOVE *ZEROS    V1003
     C                     MOVE *ZEROS    V1004
     C                     MOVE V100      V101
     C                     MOVE V100      V102
     C                     MOVE V100      V103
     C                     MOVE V100      V104
     C                     MOVE V100      V105
     C                     MOVE V100      V106
     C                     MOVE V100      V107
     C                     MOVE V100      V108
     C                     MOVE V100      V109
     C                     MOVE V100      V110
     C                     Z-ADD0         WCONF1
     C                     Z-ADD0         WOPRO1
     C                     Z-ADD0         CROISE  10
     C                     MOVE ' '       FORHB   1
     C                     MOVE 'F'       PECPAP  1
     *--- Début --- Philippe  --- 24/02/2015 --*
     * - Mise ne commentaire car utilisation de CALENAL0 pour recherche de
     * valeur siècle
    C**         AA        CHAINSIECLE               99
    C**                   Z-ADDSS        YEARS
     C           KL0       CHAINCALENAL0             99
     C  N99                Z-ADDCALSS     YEARS
     C   99                Z-ADD20        YEARS
D1  C   99      AA        IFGE 90
     C                     Z-ADD19        YEARS
F1  C                     ENDIF
     *--- Fin   --- Philippe  --- 24/02/2015 --*
     C                     Z-ADDAA        YEAR    20
     C                     Z-ADDMM        MONTH   20
     C                     Z-ADDJJ        DAY     20
     C                     Z-ADDAA        YEAR1X
     C                     Z-ADDMM        MONTHX
     C                     Z-ADDJJ        DAYX
     C                     Z-ADD20        SSS     20
     C                     Z-ADD99        AAA     20
     C                     Z-ADD99        MMM     20
     C                     Z-ADD20        CSS     20
     C                     Z-ADDUYEAR     CAA     20
     C                     Z-ADDUMONTH    CMM     20
     C                     Z-ADDUDAY      CJJ     20
     *
     *
D1  C           *INU2     IFEQ '0'
D2  C           PUS       IFEQ 3
     C           *NAMVAR   DEFN           DALANT  4
     C                     IN   DALANT
     C                     MOVE DALANT    DALAN
F2  C                     END
D2  C           PUS       IFEQ 5
     C           *NAMVAR   DEFN           DALANC  4
     C                     IN   DALANC
     C                     MOVE DALANC    DALAN
F2  C                     END
X1  C                     ELSE
     C           *NAMVAR   DEFN           DANUIT  4
     C                     IN   DANUIT
     C                     MOVE DANUIT    DALAN
F1  C                     END
     *
    C           LANFAC    CABEQ0         FINNUL
     *
     C                     OPEN ETATFABT
     *  RECHERCHE DE LA DATE DU TRAITEMENT
     *  ==================================
     *
     C           KCALEN    CHAINCALENS               80
     C           KCAL07    CHAINCALENJL7             80
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
     *
     * SI JOUR = OV  FAIRE COMME SI  =  FIN DE S.(RECHERCHE DE LA SEM.
     * =========================================             SUIVANTE)
     C                     Z-ADD0         CPT     20
D1  C           *IN80     DOWEQ'0'
     *
D2  C           CALJOU    IFEQ 'SAMEDI  '
    C           CALJOU    OREQ 'DIMANCHE'
    C           CALJOU    OREQ 'FERIE   '
    C           CALJOU    OREQ 'OV      '
    C           OVRT      OREQ 1
    C           PUS       ANDEQ2
    C           OVTY      OREQ 1
    C           PUS       ANDEQ3
    C           OVNE      OREQ 1
    C           PUS       ANDEQ4
    C           OVCH      OREQ 1
    C           PUS       ANDEQ5
     C                     READ CALENJL7                 80
    C           *IN80     CABEQ'1'       FIN
X2  C                     ELSE
     C                     ADD  1         CPT
     C           CPT       COMP LANFAC                   80
     C  N80                READ CALENJL7                 80
F2  C                     END
F1  C  N80                END
     *
     C                     Z-ADDCALSS     PANSS   20
     C                     Z-ADDCALAA     PANAA   20
     C                     Z-ADDCALMM     PANMM   20
     C                     Z-ADDCALJJ     PANJJ   20
     *
     *              ///////////////////////////
     *              /  DEBUT DU TRAITEMENT :  /
     *              ///////////////////////////
     *
     C           DEBUT     TAG
     C   U8                SETON                     18
     *
D1  C           *IN18     IFEQ '0'
     C           KPRLA2    CHAINPRLANCXG             80
    C           *IN80     CABEQ'1'       FIN
X1  C                     ELSE
     C                     SETOF                     80
D2  C           *IN19     IFEQ '0'
     *
     C           KPRLA2    CHAINPRLANCX4             80
    C           *IN80     CABEQ'1'       FIN            25
     C                     Z-ADDWEQFAB    WWQFAB  20
X2  C                     ELSE
     C           KPRLA2    CHAINPRLANCLU             80
    C           *IN80     CABEQ'1'       FIN            24
F2  C                     END
F1  C                     END
     *
D1  C           *IN80     DOWEQ'0'
     *
     C                     SETOF                     303145
     C                     SETOF                     979192
     C                     SETOF                     9328
     C                     SETOF                     747576
     C                     SETOF                     777879
     C                     MOVE *ZEROS    V0661   20
     C                     MOVE *ZEROS    V0671   20
     C                     MOVE *ZEROS    V0681   20
     C                     MOVE *ZEROS    IMPO1   20
     C                     MOVE *ZEROS    IMPO2   20
     C                     MOVE *BLANKS   V0662   3
     C                     MOVE *BLANKS   V0672   3
     C                     MOVE *BLANKS   V0682   3
     C                     MOVE *BLANKS   V069
     C                     MOVE *BLANKS   V070
     C                     Z-ADD0         PRE
     C                     Z-ADD0         NOE
     C                     Z-ADD0         POS
     C                     MOVE *BLANKS   REF
     C                     MOVE ' '       SECT1   1
     C                     MOVE ' '       SECT2   1
     *  LA CDE NE DOIT PAS AVOIR ETE EDITEE
     *  ...................................
     C           KCARCD    CHAINCARCDEL1             81
    C           *IN81     CABEQ'1'       SUITE
     C  N18
    COR 19      FORDOC    CABEQ'*'       SUITE
     *
    C           MMFABD    CABNE*ZEROS    SUITE
     C                     Z-ADDWEQFAB    WWQFAB
D2  C           WRIORI    IFGE 80,0
    C           WRIORI    ANDNE90,0
     C                     SETON                     97
F2  C                     END
    C           WTFAC     CABEQ*ZEROS    SUITE
    C           WARNT     CABEQ'RE'      SUITE                           LANC22
    C           IMPSTO    CABNE*BLANK    SUITE
D2  C           FORDOC    IFEQ *BLANK
    C           *IN19     ANDEQ'0'
    C           CODEL     CABEQ'  '      SUITE
    C           CODEL     CABEQ'PR'      SUITE
    C           CODEL     CABEQ'AT'      SUITE
    C           DTDEL     CABEQ*ZEROS    SUITE
F2  C                     END
     *
D2  C           *IN19     IFEQ '1'
    C           DTPRDE    ANDLEDTPAN
D3  C           CODEL     IFEQ 'CO'
    C           CODEL     OREQ 'CS'
    C           CODEL     OREQ 'DE'
    C           CODEL     OREQ 'DS'
    C                     GOTO SUITE
F3  C                     END
F2  C                     END
     *
     C                     MOVE *BLANKS   OBS
     C           KCOFL3    CHAINCAROFL3              9099
D2  C           *IN90     DOWEQ'0'
     C                     Z-ADDSUPPOR    SU
D3  C           SU        IFEQ 0
     C                     Z-ADD1         SU
F3  C                     END
     C                     MOVE OBSERV    OBS,SU
     C           KCOFL3    READECAROFL3                9990
F2  C  N90                END
     *
     C           KCOFL3    DELETCAROFL3              9099
D2  C           *IN90     DOWEQ'0'
     C           KCOFL3    DELETCAROFL3              9099
F2  C  N90                END
     C                     Z-ADD0         CGFAB
     C                     Z-ADD0         CEFAB
     *
     C           KBESL1    CHAINBESOMAL1             81
    C           *IN81     CABEQ'1'       SUITE
D2  C           FORLBM    IFNE *ZEROS
    C           FORHBM    ANDNE*ZEROS
    C           SBFE      ANDEQ*ZEROS
     C           FORLBM    MULT 0,001     WORLBM  43
     C           FORHBM    MULT 0,001     WORHBM  43
     C           WORLBM    MULT WORHBM    SBFE
D3  C           SBFE      IFEQ *ZEROS
     C                     Z-ADDSBZ       SBFE
F3  C                     END
F2  C                     END
     *  ---> RECHERCHE DU PRODUIT
     *  -------------------------
     *
     C           KPRO10    CHAINPRODUL10             81
     C           KPROST    CHAINPRODST2              81
    C           *IN81     CABEQ'1'       SUITE
     C                     Z-ADDYMINI     V0501   41
     C                     MOVE REFEX     YEFEX   6
     C                     MOVE REFIN     YEFIN   6
     *
     *
     *  ---> NOM DU CLIENT
     *  ------------------
     *
     C                     MOVE *BLANKS   V001   40
     C                     MOVE *BLANKS   V0011  34
     C                     MOVE *BLANKS   V0012  22
     C           KCLIL1    CHAINCLIENTS1             71
    C           *IN71     CABEQ'1'       SUITE
     C                     MOVE NOMCLI    V001
     C                     MOVELNOMCLI    V0011
     C                     MOVELNOMCLI    V0012
     *
     *  ---> NUMERO DU CLIENT
     *  ---------------------
     *
     C                     MOVE WOCLI     V002    40
     *
     *  ---> DATE DERNIERE FABRICATION
     *  ------------------------------
     *
     C                     MOVE *ZEROS    V003
D2  C           YCOL      IFEQ 1
     C                     MOVE '3'       WECT
     C                     MOVE '1'       WSECT
X2  C                     ELSE
D3  C           YCOL      IFNE 9
    C*          YCOL      ANDNE6
    C           YNDUL     ANDEQ0
D4  C           YACON     IFEQ 0
    C           YACON     OREQ 1
     C                     MOVE '2'       WECT
     C                     MOVE '1'       WSECT
X4  C                     ELSE
D5  C           YCOL      IFEQ 0
     C                     MOVE '5'       WECT
D6  C           TDECO1    IFEQ 'G'
     C                     MOVE '2'       WSECT
X6  C                     ELSE
     C                     MOVE '1'       WSECT
F6  C                     END
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     MOVE '2'       WECT
     C                     MOVE '1'       WSECT
F3  C                     END
D3  C           YCOL      IFEQ 8
     C                     MOVE '5'       WECT
D4  C           TDECO1    IFEQ 'G'
     C                     MOVE '2'       WSECT
X4  C                     ELSE
     C                     MOVE '1'       WSECT
F4  C                     END
F3  C                     END
F2  C                     END
     *
     C                     Z-ADD99        SSFAB
     C                     Z-ADD999999    DATFAB
     C           KHISL6    SETLLHISTOF16
     C           KHIS06    READEHISTOF16                 81
D2  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D3  C           *IN81     DOWEQ'0'
     C           KHIS06    READEHISTOF16                 81
D4  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDLTXOSEQ1
     C                     READPHISTOF16                 81
     C                     Z-ADDAFAB      V0033
     C                     Z-ADDMFAB      V0032
     C                     Z-ADDJFAB      V0031
     C                     SETON                     81
F4  C                     END
F3  C  N81                END
X2  C                     ELSE
     C           KHIS26    SETLLHISTOF16
     C           KHIS16    READEHISTOF16                 81
D3  C           *IN81     IFEQ '0'
     C                     Z-ADDXCONF     XCONF1  50
     C                     Z-ADDXOSEQ     XOSEQ1  20
     *
D4  C           *IN81     DOWEQ'0'
     C           KHIS06    READEHISTOF16                 81
D5  C           XCONF     IFNE XCONF1
    C           XCONF     OREQ XCONF1
    C           XOSEQ     ANDLTXOSEQ1
     C                     READPHISTOF16                 81
     C                     Z-ADDAFAB      V0033
     C                     Z-ADDMFAB      V0032
     C                     Z-ADDJFAB      V0031
     C                     SETON                     81
F5  C                     END
F4  C  N81                END
F3  C                     END
F2  C                     END
     *
     *  ---> CONFIRMATION + SEQUENCE
     *  ----------------------------
     *
     C                     MOVELWCONF     V0041   50
     C                     MOVE WEQFAB    V0042   20
     *
     *  ---> REFERENCE CDE CLIENT
     *  -------------------------
     *
     C                     MOVE CLIREF    V005   20
     C                     Z-ADDCOMCLJ    V0061
     C                     Z-ADDCOMCLM    V0062
     C                     Z-ADDCOMCLA    V0063
     *
     *  ---> NUMERO DU PRODUIT
     *  ----------------------
     *
     C                     MOVE WOPRO     V007    40
     *
     *  ---> UNITE DE VENTE
     *  -------------------
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'UVEN'    PXARGU
     C                     MOVE BVENT     PXVALE
     C           KPARAM    CHAINPARAME               99
D2  C           *IN99     IFEQ '0'
     C                     MOVELPXLIBE    V008    8
F2  C                     END
     *
     *  ---> PRIX UNITAIRE
     *  ------------------
     *
D2  C           PUNIT     IFNE *ZEROS
     C                     Z-ADDPUNIT     V009    72
X2  C                     ELSE
     C                     Z-ADDPRIUNS    V009
F2  C                     END
     *
     *  ---> ADRESSE DE LIVRAISON
     *  -------------------------
     *
     C                     MOVE *BLANKS   V010   40
     C                     MOVE *BLANKS   V011   40
     C                     MOVE *BLANKS   V012    2
     C                     MOVE *BLANKS   V013   32
D2  C           WGLIV     IFNE 99
     C           KCLILI    CHAINCLILIVL1             81
D3  C           *IN81     IFEQ '0'
     C                     MOVE NOMLIV    V010   40
     C                     MOVE RUELIV    V011   40
     C                     MOVE DEPLIV    V012    2
     C                     MOVE VILLIV    V013   32
F3  C                     END
F2  C                     END
     *
     *  ---> DELAI DEMANDE
     *  ------------------
     *
     C                     Z-ADDDTDDEL    V014    50
     *
     *  ---> DELAI CONFIRME
     *  -------------------
     *
     C                     Z-ADDDTDEL     V015    50
     C                     MOVE CODEL     V016    2
     *
     *  ---> DATE LANCEMENT
     *  -------------------
     *
     C                     Z-ADD0         DAPRDE
     *
     C           KDPRDE    CHAINCALENS               80
     C                     Z-ADDCALAA     APRDE
     C                     Z-ADDCALNOS    SPRDE
     C                     Z-ADDCALNJ     JPRDE
     *
     *  ---> MATERIEL IMPRESSION, MATERIEL DECOUPAGE
     *  --------------------------------------------
     *
     C                     MOVE *BLANKS   V017   12
     C                     MOVE *BLANKS   V018   12
     C                     MOVE *BLANKS   V019   12
     C                     Z-ADD1         I       30
     C                     Z-ADD1         J       30
     C                     SETOF                     94
D2  C           WEQFAB    IFEQ 2
     C           KCARLU    SETLLCARCDEZ1                 94
F2  C                     END
     C   94                Z-ADD01        WWQFAB
     C   94      KPLAM3    SETLLPLAMAL1
     C  N94      KPLAM2    SETLLPLAMAL1
     C           KPLAM1    READEPLAMAL1                  82
D2  C           *IN82     IFEQ '0'
D3  C           WSEXT     IFNE *ZERO
D4  C           TIM01     IFNE ' '
     C           ETAT01    LOKUPETA,I                    55
     C   55                MOVELLET,I     V017
F4  C                     END
D4  C           TIM02     IFNE ' '
     C           ETAT02    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V017
     C   55                MOVE J         I
F4  C                     END
F3  C                     END
     *
     C                     Z-ADD1         I
     C                     Z-ADD1         J
D3  C           WSINT     IFNE *ZERO
D4  C           TIM03     IFNE ' '
     C           ETAT03    LOKUPETA,I                    55
     C   55                MOVELLET,I     V018
F4  C                     END
D4  C           TIM04     IFNE ' '
     C           ETAT04    LOKUPETA,J                    55
     C   55      J         COMP I                      55
     C   55                MOVELLET,J     V018
F4  C                     END
F3  C                     END
D3  C           WSINE     IFEQ 3
D4  C           TIM01     IFEQ '3'
     C           ETAT01    LOKUPETA,I                    55
     C   55                MOVELLET,I     V017
F4  C                     END
F3  C                     END
     *
     C                     Z-ADD1         I
     C                     Z-ADD1         J
D3  C           WSINE     IFEQ 3
D4  C           TIM03     IFEQ '3'
     C           ETAT03    LOKUPETA,I                    55
     C   55                MOVELLET,I     V018
F4  C                     END
F3  C                     END
D3  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     Z-ADD1         J
     C           ETAFOR    LOKUPETA,J                    55
     C   55                MOVELLET,J     V019
     C   55                Z-ADDDDEFOR    DV019   60
F3  C                     END
     *
X2  C                     ELSE
     *
D3  C           TIM,2     IFGT 0
    C           TIM,3     ORGT 0
    C           NIMPE1    ORGT *ZEROS
     C                     MOVELLET,5     V017
F3  C                     END
D3  C           TIM,4     IFGT 0
    C           TIM,5     ORGT 0
    C           TIM,6     ORGT 0
    C           NIMPI1    ORGT *ZEROS
     C                     MOVELLET,5     V018
F3  C                     END
D3  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     MOVELLET,5     V019
F3  C                     END
F2  C                     END
     *
     *  ---> QTE EN RELIQUAT
     *  --------------------
     *
     C                     Z-ADD*ZEROS    V020    70
     C                     Z-ADD0         STOCK   90
     C           KPRO10    CHAINLIEUSTL3             99
D2  C           *IN99     DOWEQ'0'
     C                     SETON                     96
D3  C           LILIEU    IFEQ 6
    C           CODEXT    ANDNE'  '
     C                     Z-ADD1         C
     C           CODEXT    LOKUPCXT,C                    96
F3  C                     END
D3  C           LILIEU    IFNE 8
    C           *IN96     ANDEQ'1'
     C                     ADD  STOLIE    STOCK                           PROD17
F3  C                     END
     C           KPRO10    READELIEUSTL3                 99              *PROD17
F2  C        N99          END                                           *PROD17
     C                     SETOF                     50
     *
     C           STOCK     COMP 0                      82
     C   82                Z-ADD0         STOCK
     *
     C           KCARZ8    SETLLCARCDEZ8
     C           KCARCU    READECARCDEZ8                 81
D2  C           *IN81     DOWEQ'0'
D3  C           NCONF     IFNE WCONF
     C                     SETON                     8150
F3  C                     END
     C  N81      KCARCU    READECARCDEZ8                 81
F2  C  N81                END
D2  C           *IN50     IFEQ '0'
    C           WEQFAB    ANDEQ01
D3  C           STOCK     IFNE 0
     C                     EXSR RECAL
F3  C                     END
     C                     ADD  STOCK     V020
F2  C                     END
     *
     *
     *  ---> QTE DEMANDEE
     *  -----------------
     *
     C                     Z-ADDWTFAC     V021    70
     *
     *
     *  ---> QTE A LANCER
     *  -----------------
     *
     C                     Z-ADD0         V023
D2  C           V021      IFGT V020
     C           V021      SUB  V020      V023    70
F2  C                     END
     C           V023      COMP *ZEROS                   29=
     *   SI *IN29 = '1' AFFICHAGE  '*******'
     *
     *  ---> IMPORTANCE DU MARCHE
     *  -------------------------
     *
     C                     MOVE *ZEROS    V022    80
     C           KCDES1    CHAINCDESL1               82
     C                     Z-ADDWTOT      V022
D2  C           STOND     IFNE 0
     C                     MOVE 'NCDE'    PXARGU
     C                     MOVE STOND     PXVALE    P
     C           KPARAM    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBSTO 20
F2  C                     END
     *
     *  ---> DESIGNATION PRODUIT
     *  ------------------------
     *
     *
     C                     MOVE BLOC1     V024   40
     C                     MOVE BLOC2     V025   40
     C                     MOVE *BLANKS   V026
     *
     * CONSTITUTUION DU BLOC3
D2  C           SUPB3     IFEQ ' '
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE ' BL3'    PXARGU
     C                     MOVE BT3       PXVALE
     C           KPARAM    CHAINPARAME               99
D3  C           *IN99     IFEQ '0'
     C                     MOVE PXLIBE    V026
D4  C           NBRFE     IFGT 0
     C                     MOVE ' 999'    PXVALE
     C           KPARAM    CHAINPARAME               98
D5  C           *IN98     IFEQ '0'
     C                     MOVELPXLIBE    V0261
     C                     MOVE NBRFE     V0262
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
     *
     C                     MOVE BLOC4     V027   40
     C                     MOVE BLOC5     V028   40
     C                     MOVE BLOC6     V029   40
     C                     MOVE BLOC7     V030   40
     *
     *
     *  ---> ANCIEN NUMERO DE PRODUIT
     *  -----------------------------
     *
     C                     MOVE ANPRO     V031    40
     *
     *  ---> CAUSE CHANGEMENT DE PRODUIT
     *  --------------------------------
     *
     C                     MOVE *BLANKS   V032   40
     C                     MOVEL'CAUSE '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V032
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
F2  C                     END
     *
     *  ---> OBSERVATIONS ALERTE
     *  ------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     Z-ADD0         I
     *
     *  - GROUPAGE
D2  C           YARNT1    IFEQ 'M'
    C           YARNT3    ANDGT'0'
     C                     ADD  1         I
     C                     MOVELCON,4     VAR,I
F2  C                     END
     *
     *  - GARNITURE
D2  C           YARNT1    IFNE 'M'
    C           YARNT1    ANDNE' '
     C                     ADD  1         I
     C                     MOVELCON,5     YARNT2
     C                     MOVELVARNT     VAR,I
F2  C                     END
     *
     *  - COMMANDE D'ESSAIS
D2  C           YARNT     IFEQ 'MD'
     C                     ADD  1         I
     C                     MOVELCON,6     VAR,I
F2  C                     END
     *
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - COMMANDE D'HOMOLOGATION
D2  C           YARNT     IFEQ 'MH'
     C                     ADD  1         I
     C                     MOVELCON,7     VAR,I
F2  C                     END
     *
     C                     MOVE 'ESSAIF'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELOBSLIB    VAR,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     C                     MOVE 'ONDUL '  DEST
     C                     MOVE 'ST    '  EMET
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELCON,9     VAR,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'L'
     C                     ADD  1         I
     C                     MOVELCON,10    VAR,I
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'A'
     C                     ADD  1         I
     C                     MOVELCON,14    VAR,I
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
D2  C           TYPPRP    IFEQ 'Z'
     C                     ADD  1         I
     C                     MOVELCON,25    VAR,I
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     *  - PREMIERE COMMANDE
     C                     MOVE ' '       PREM
     C           KSTAL1    SETLLSTACOML8
     C           KCARCU    READESTACOML8                 81
D2  C           *IN81     IFEQ '0'
D3  C           WWC       IFEQ WCONF
     C           KCARCU    READESTACOML8                 81
D4  C           *IN81     IFEQ '1'
    C           WEQFAB    ANDEQ01
     C                     ADD  1         I
     C                     MOVELCON,18    VAR,I
     C                     MOVE 'P'       PREM    1
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C                     ADD  1         I
     C                     MOVELCON,18    VAR,I
     C                     MOVE 'P'       PREM    1
F2  C                     END
     C           I         COMP 3                        50
    C           *IN50     CABEQ'1'       FINATT
     *
     * CONCEPTION,QUALITE,UTILISATION
     C                     MOVE *BLANKS   CQU
     C                     MOVE GRAP1     PXVALE    P
     C                     MOVE 'TUTC'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D2  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBUTC
F2  C                     END
     C                     MOVE COUP1     PXVALE    P
     C                     MOVE 'TCON'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D2  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBCON
F2  C                     END
     C                     MOVE NATE1     PXVALE    P
     C                     MOVE 'TQUA'    PXARGU
     C           KPARAM    CHAINPARAMEF1             98
D2  C           *IN98     IFEQ '0'
     C                     MOVELPXABRG    LIBQUA
F2  C                     END
     C                     ADD  1         I
     C                     MOVELCQU       VAR,I
     *
     C           FINATT    TAG
     C                     MOVELVAR,1     V033   40
     C                     MOVELVAR,2     V034   40
     C                     MOVELVAR,3     V035   40
     *
     *  ---> TEINTE VERNIS, PAPIER TEINTE
     *  ---------------------------------
     *
     C                     MOVE *BLANKS   V036   40
     C                     MOVE *BLANKS   V037   40
     C                     MOVE *BLANKS   V038   40
     C                     SETOF                     212223
     C                     Z-ADD*ZEROS    T       10
     C                     MOVEL'TEINTY'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           *IN23     ANDEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V036
     C   22                MOVE OBSLIB    V037
     C   23                MOVE OBSLIB    V038
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVEL'COLORE'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           *IN23     ANDEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V036
     C   22                MOVE OBSLIB    V037
     C   23                MOVE OBSLIB    V038
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVEL'COLORI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           *IN23     ANDEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V036
     C   22                MOVE OBSLIB    V037
     C   23                MOVE OBSLIB    V038
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *
     *  ---> TIRELLE ET PMS
     *  -------------------
     *
     C                     MOVE *BLANKS   TIRPMS
     C                     SETOF                     40
     *
D2  C           NIMPE1    IFNE *BLANKS
    C           REFEX     ORNE *BLANKS
     C                     MOVEL'COLORE'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
     C                     MOVEAOBSLIB    WAR
D4  C           1         DO   40        I
     C           I         ADD  1         II      20
     C           I         ADD  2         III     20
     C           I         ADD  3         IIII    20
D5  C           WAR,I     IFEQ '('
    C           WAR,II    ANDEQ'T'
    C           WAR,III   ANDEQ' '
     C                     MOVEAWAR,II    TIRE3
     C                     SETON                     40
F5  C                     END
D5  C           WAR,I     IFEQ 'P'
    C           WAR,II    ANDEQ'M'
    C           WAR,III   ANDEQ'S'
    C           TIRE3     ANDEQ*BLANKS
     C                     MOVEAWAR,I     TIRE3
     C                     SETON                     40
F5  C                     END
     C           I         COMP 37                       40
F4  C  N40                END
F3  C                     END
D3  C           NIMPE1    IFNE *BLANKS
     C                     MOVEL'S: '     TIRE1
     C                     MOVELTNIMPE    TIRE2
     C                     MOVEL'-'       TT1
X3  C                     ELSE
     C                     MOVEL'C:'      TIRE1
     C                     MOVELREFEX     TIRE2
F3  C                     END
F2  C                     END
     *
     C                     SETOF                     40
     *
D2  C           NIMPI1    IFNE *BLANKS
    C           REFIN     ORNE *BLANKS
     C                     MOVE '/'       TT2
     C                     MOVEL'COLORI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
     C                     MOVEAOBSLIB    WAR
D4  C           1         DO   40        I
     C           I         ADD  1         II      20
     C           I         ADD  2         III     20
     C           I         ADD  3         IIII    20
D5  C           WAR,I     IFEQ '('
    C           WAR,II    ANDEQ'T'
    C           WAR,III   ANDEQ' '
     C                     MOVEAWAR,II    TIRI3
     C                     SETON                     40
F5  C                     END
D5  C           WAR,I     IFEQ 'P'
    C           WAR,II    ANDEQ'M'
    C           WAR,III   ANDEQ'S'
    C           TIRI3     ANDEQ*BLANKS
     C                     MOVEAWAR,I     TIRI3
     C                     SETON                     40
F5  C                     END
F4  C  N40                END
F3  C                     END
D3  C           NIMPI1    IFNE *BLANKS
     C                     MOVEL'S:'      TIRI1
     C                     MOVELTNIMPI    TIRI2
     C                     MOVE '-'       TT3
X3  C                     ELSE
     C                     MOVEL'C:'      TIRI1
     C                     MOVELREFIN     TIRI2
F3  C                     END
F2  C                     END
     *
     *
     *  ---> QTE A REALISER MINI ET MAXI
     *  --------------------------------
     *
     C                     Z-ADD*ZEROS    V0461   70
     C                     MOVE *BLANKS   V0462   2
     C                     Z-ADD*ZEROS    V0471   70
     C                     MOVE *BLANKS   V0472   2
     C                     Z-ADD*ZEROS    W0461   70
     C                     MOVE *BLANKS   W0462   2
     C                     Z-ADD*ZEROS    W0471   70
     C                     MOVE *BLANKS   W0472   2
     *
     C           KPLAL1    CHAINPLANIFL1             82
D2  C           *IN82     IFEQ '1'
     C                     Z-ADD0         ROUDEC
     C                     Z-ADD0         WUREG
F2  C                     END
     *
D2  C           WECT      IFEQ '2'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
    C           WECT      OREQ '3'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
    C                     GOTO SUISUP
F2  C                     END
     *
     C                     MOVE WECT      CECT
     C                     MOVE WSECT     CSECT
     C                     MOVE NOMAC     COMAC
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           WTOT      MULT 0,01      SURFF     H
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           WTOT      MULT 0,001     SURFF     H
F2  C                     END
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDWTOT      SURFF     H
F2  C                     END
     *
     C           SURFF     MULT SUVENT    SURFF     H
     *
D2  C           SURFF     IFEQ 0
     C                     Z-ADD1         SURFF
F2  C                     END
     C           *LIKE     DEFN SURFF     WURFF
     C                     Z-ADDSURFF     WURFF
     *
D2  C           BVENT     IFEQ 2
    C           BVENT     OREQ 3
    C           BVENT     OREQ 4
     C           V023      MULT 0,01      W4     103
F2  C                     END
     *
D2  C           BVENT     IFEQ 1
     C           V023      MULT 0,001     W4
F2  C                     END
     *
D2  C           BVENT     IFEQ 5
     C                     Z-ADDV023      W4
F2  C                     END
     *
     C           W4        MULT SUVENT    SUFNET 100H
     *
     *
     C           SUFNET    MULT ROUDEC    SUFTH  100H
     *
D2  C           SUFNET    IFNE *ZEROS
     C                     ADD  WUREG     SUFTH
F2  C                     END
     *
D2  C           SBFE      IFEQ *ZEROS
     C                     Z-ADD1         SF
X2  C                     ELSE
     C                     Z-ADDSBFE      SF
F2  C                     END
     *
     *
     *
     C                     Z-ADD*ZERO     MIN
     C                     Z-ADD*ZERO     MAX
     C                     MOVE ' '       DS1
D2  C           SUFTH     IFNE *ZEROS
     C                     Z-ADDSUFTH     SURF
     C                     Z-ADDWCONF     WCONF1
     C                     Z-ADDWOPRO     WOPRO1
     C                     Z-ADDWOCLI     WOCLI1
     C                     CALL 'CDEC92£'
     C                     PARM           DSPARA
F2  C                     END
     C                     Z-ADDMIN       SFMIN   80
     C                     Z-ADDMAX       SFMAX   80
     *
     *  ---> COEFFICIENTS MINI ET MAXI
     *  ------------------------------
     *
     C                     Z-ADD*ZEROS    USFO1   31
     C                     Z-ADD*ZEROS    USFO2   31
     C                     MOVE *BLANKS   USFO    8
     *
     * TOLERANCE SUR QUANTITES
     *------------------------
     *
     C                     MOVE ' '       MOINS   1
     C                     MOVE ' '       PLUS    1
     C                     MOVELWPROTO    WROTO   1
D2  C           WACLI     IFEQ 0
    C           WICLI     ANDEQ0
    C           WROTO     ANDNE'T'
     *
     C                     Z-ADD1         I
     C           SURFF     LOKUPTSX,I                10
D3  C           WROTO     IFEQ 'P'
     C                     MOVEL'PROMO  :'USFO
     C                     Z-ADD0         USFO1
     C                     Z-ADDTB,I      USFO2     H
X3  C                     ELSE
     C                     Z-ADDTB,I      USFO1     H
     C                     Z-ADDTB,I      USFO2     H
     C                     MOVEL'USFO   :'USFO
F3  C                     END
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
     *
X2  C                     ELSE
D3  C           WROTO     IFEQ 'T'
     C                     MOVEL'ZERO.'   USFO
F3  C                     END
D3  C           WROTO     IFEQ 'P'
     C                     MOVEL'PROMO  :'USFO
     C                     Z-ADDWICLI     USFO1
     C                     Z-ADDWACLI     USFO2
     C                     MOVE '+'       PLUS
F3  C                     END
D3  C           WROTO     IFEQ ' '
     C                     MOVE 'CLIENT :'USFO
     C                     Z-ADDWICLI     USFO1
     C                     Z-ADDWACLI     USFO2
     C                     MOVE '-'       MOINS
     C                     MOVE '+'       PLUS
F3  C                     END
F2  C                     END
     *
D2  C           V035      IFEQ *BLANKS
     C                     MOVELCON,20    V035
     C                     SETON                     28
F2  C                     END
     *
     C           SFMAX     SUB  SURF      W1
     C           W1        MULT 100       W1
D2  C           SURF      IFNE *ZEROS
     C           W1        DIV  SURF      X0311   42
F2  C                     END
     *
     C           X0311     MULT V023      W1
     C           W1        MULT 0,01      QTLANC  70H
     C                     ADD  V023      QTLANC
     *
     *
D2  C           BVENT     IFEQ 3
    C           YACON     OREQ 9
     C                     MOVELBMINI     BMINIM                          LANC22
D3  C           YNDL      IFNE *ZEROS
     C           BMINIM    DIV  YNDL      W0434                           LANC22
X3  C                     ELSE
     C                     Z-ADD0         W0434
F3  C                     END
     C           BMINI     MULT 0,01      WMINI   43
D3  C           WMINI     IFNE *ZEROS
     C           SFMIN     DIV  WMINI     V0461
     C           SFMAX     DIV  WMINI     V0471
D4  C           W0434     IFGT 1
     C           V0461     MULT W0434     V0461
     C           V0471     MULT W0434     V0471
F4  C                     END
F3  C                     END
     C                     MOVE 'ML'      V0462
     C                     MOVE 'ML'      V0472
F2  C                     END
     *
D2  C           BVENT     IFEQ 4
     C           TOTGRA    MULT 0,001     WOTGRA  43
     C           SFMIN     MULT WOTGRA    V0461
     C           SFMAX     MULT WOTGRA    V0471
     C                     MOVE 'KG'      V0462
     C                     MOVE 'KG'      V0472
F2  C                     END
     *
D2  C           YACON     IFEQ 4
D3  C           SBZ       IFNE *ZEROS
     C           SFMIN     DIV  SBZ       V0461
     C           SFMAX     DIV  SBZ       V0471
F3  C                     END
     C                     MOVE 'DE'      V0462
     C                     MOVE 'DE'      V0472
F2  C                     END
     *
D2  C           YACON     IFEQ 5
    C           YACON     OREQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     *
D3  C           BMINI     IFNE *ZEROS
     C                     Z-ADD0         SURF1
     C                     Z-ADD0         SURF2
     C                     MOVELBMINI     LAIZM   40
     C           LAIZM     SUB  YCOTE     RESTE   40
D4  C           YNDL      IFNE *ZEROS
     C           RESTE     DIV  YNDL      NB      20
F4  C                     END
     *
     C           YOSF1     MULT SBZ       SURF1  155
     C                     MULT NB        SURF1
     *
D4  C           YCOTE     IFNE *ZEROS
     C                     ADD  1         NB
     C           YOSF2     MULT SBZ       SURF2  155
F4  C                     END
     *
     C           SURF1     ADD  SURF2     W1
D4  C           NB        IFNE *ZEROS
     C           W1        DIV  NB        W1
F4  C                     END
X3  C                     ELSE
     C                     Z-ADDSBFE      W1
F3  C                     END
     *
D3  C           W1        IFNE *ZEROS
     C           SFMIN     DIV  W1        V0461     H
     C           SFMAX     DIV  W1        V0471     H
F3  C                     END
     C                     MOVE 'FE'      V0462
     C                     MOVE 'FE'      V0472
D3  C           YCOTE     IFNE *ZEROS
    C           NB        ANDNE*ZEROS
     C           V0461     DIV  NB        W0461     H
     C           V0471     DIV  NB        W0471     H
     C                     SUB  W0461     V0461
     C                     SUB  W0471     V0471
     C                     MOVE 'FE'      W0462
     C                     MOVE 'FE'      W0472
F3  C                     END
F2  C                     END
     *
     C                     SETOF                     13
     C                     MOVE *BLANKS   W043
     C                     Z-ADD0         W0432
     C                     Z-ADD0         W0434
     C                     Z-ADD0         W0436
     C                     Z-ADD0         V0481
     C                     MOVEL*BLANKS   V0482
D2  C           YACON     IFEQ 1
    C           YACON     OREQ 2
     C           TOTGRA    MULT 0,001     WOTGRA  43
     C           SFMIN     MULT WOTGRA    V0461
     C           SFMAX     MULT WOTGRA    V0471
     C                     MOVE 'KG'      V0462
     C                     MOVE 'KG'      V0472
     C                     MOVELWBRBOB    V0481   50
     C                     MOVEL'BOB'     V0482   3
     C                     SETON                     13
     C                     MOVELBMINI     BMINIM  40                      LANC22
     C           DECL      ADD  1         WECL    40                      LANC22
D3  C           DECL      IFNE *ZEROS
     C           BMINIM    DIV  WECL      W0434                           LANC22
F3  C                     END
     C           DECL      MULT W0434     W0436                           LANC22
     C                     Z-ADDDECL      W0432
     C                     MOVEL'x'       W0433                           LANC22
     C                     MOVEL'='       W0435                           LANC22
     C                     MOVEL'BOB'     W0431                           LANC22
F2  C                     END
     * DEMANDE DE SERGE PIERRE LE 1/02/96
D2  C           V0461     IFNE 0
    C           V0461     ANDGT100
    C           V0462     ANDNE'KG'
     C                     Z-ADDV0461     A100    20
D3  C           A100      IFNE 0
     C                     MOVE '00'      V0461
     C                     ADD  100       V0461
F3  C                     END
F2  C                     END
D2  C           V0461     IFNE 0
    C           V0461     ANDGT100
    C           V0462     ANDEQ'KG'
     C                     Z-ADDV0461     A10     10
D3  C           A10       IFNE 0
     C                     MOVE '0'       V0461
     C                     ADD  10        V0461
F3  C                     END
F2  C                     END
     *
D2  C           W0461     IFNE 0
    C           W0461     ANDGT100
    C           W0462     ANDNE'KG'
     C                     Z-ADDW0461     A100    20
D3  C           A100      IFNE 0
     C                     MOVE '00'      W0461
     C                     ADD  100       W0461
F3  C                     END
F2  C                     END
D2  C           W0461     IFNE 0
    C           W0461     ANDGT100
    C           W0462     ANDEQ'KG'
     C                     Z-ADDW0461     A10     10
D3  C           A10       IFNE 0
     C                     MOVE '0'       W0461
     C                     ADD  10        W0461
F3  C                     END
F2  C                     END
     C           KRESLD    CHAINRESTPSLD             88
     C           *IN88     IFEQ '0'
     C           SECT      IFEQ '2'
     C                     Z-ADD$TENET    V0461
     C                     Z-ADD0         V0471
     C                     END
     C                     END
     *
     *  ---> INFORMATIONS SUPPORTS
     *  --------------------------
     *
     C           SUISUP    TAG
     C                     SETOF                     95
     C                     MOVE *BLANKS   SUP
     C                     MOVE *BLANKS   W084
     C                     MOVE *BLANKS   V061
     C                     MOVE *ZEROS    V0843
     C                     MOVE *ZEROS    V062
     C                     MOVE *ZEROS    V0845
     C                     MOVE *ZEROS    V0847
     C                     MOVE *ZEROS    V0849
     C                     MOVE *ZEROS    V084A
     C                     MOVE *ZEROS    V084D
     C                     MOVE *ZEROS    V084D2
     C                     MOVE *ZEROS    V084E
     C                     MOVE *ZEROS    V084IN
     C                     MOVE *ZEROS    SCX
     C                     MOVE W084      W085
     C                     MOVE W084      SUP,1
     C                     MOVE W084      SUP,2
     C                     MOVE W084      SUP,3
     C                     MOVE W084      SUP,4
     C                     MOVE W084      SUP,5
     C                     Z-ADD0         I
     C                     Z-ADD0         PRE
     C                     Z-ADD0         GRAMM
     C                     Z-ADD0         GRAREL
     C           *LIKE     DEFN QUALT     WUALT
     C                     MOVE QUALT     WUALT
     *
     C                     SETOF                     87
     C           KQUAL1    CHAINCDEQUAL1             81
     C                     MOVE QUALT     WUALT
D2  C           *IN81     DOWEQ'0'
     C           KQUAL1    READECDEQUAL1                 81
     C  N87N81   QUALT     COMP WUALT                8787
F2   C  N81                END
     *
     C           *LOVAL    SETLLCDEQUAL1
     C           KQUAL1    CHAINCDEQUAL1             81
D2  C           *IN81     DOWEQ'0'
D3  C*          YCOL      IFEQ 6
D4  C*          SUPPOR    IFEQ 5
    C*                    GOTO FINSUP
F4  C*                    END
F3  C*                    END
     C                     ADD  1         I
     C                     Z-ADD*ZEROS    V084IN
     C                     MOVE W085      W084
     C                     Z-ADD0         PREIMP
     C                     MOVE REFOUR    CCC     3
D3  C           CCC       IFEQ 'CXH'
     C           KCXHL2    CHAINCDECXHL2             99
D4  C           *IN99     IFEQ '0'
     C                     MOVE CXHSPE    SCX,I
F4  C                     END
F3  C                     END
     *
D3  C           SUPPOR    IFLT 4
D4  C           USEXT     IFNE 0
    C           USEXT     ANDNE3
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE
     C           KPARAM    CHAINPARAME               99
D5  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    V0841
F5  C                     END
F4  C                     END
X3  C                     ELSE
D4  C           USINT     IFNE 0
    C           USINT     ANDNE3
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'USDE'    PXARGU
     C                     MOVE USINT     PXVALE
     C           KPARAM    CHAINPARAME               99
D5  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    V0841
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           YCOL      IFEQ 9
    C*          YCOL      OREQ 6
D4  C           SUPPOR    IFEQ 2
     C                     MOVEL*BLANKS   V084G
     C                     MOVEL'EXTER.  'V084G
D5  C           RTPOND    IFEQ ' '
     C                     MOVE '     '   V084H
X5  C                     ELSE
     C                     MOVE '     '   V084H
F5  C                     END
D5  C           RTPOND    IFEQ ' '
     C                     MOVE COLDD2    V084I
X5  C                     ELSE
     C                     MOVE COLDD1    V084I
F5  C                     END
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 3
     C                     MOVEL*BLANKS   V084G
     C                     MOVEL*BLANKS   CANDD
     C                     MOVEL'CAN.'    CAN1
     C                     MOVE CVEI3     CNDD
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
D5  C           RTPOND    IFEQ ' '
     C                     MOVE COLODF    V084I
     C                     MOVE CNDD1     PXVALE
     C           KPARAM    CHAINPARAME               99
D6  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    CAN2
F6  C                     END
X5  C                     ELSE
     C                     MOVE COLOSF    V084I
     C                     MOVE CNDD2     PXVALE
     C           KPARAM    CHAINPARAME               99
D6  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    CAN2
F6  C                     END
F5  C                     END
D5  C           YCOL      IFEQ 9
    C           PAPI6     ANDEQ'XXX'
    C           GRAM6     ANDEQ999
    C           RTPOND    ANDNE' '
     C                     MOVE 'TAB.'    CAN1
F5  C                     END
     C                     MOVELCANDD     V084G
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 4
     C                     MOVEL*BLANKS   V084G
     C                     MOVEL'MEDIANE 'V084G
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 5
     C                     MOVEL*BLANKS   V084G
     C                     MOVEL*BLANKS   CANDD
     C                     MOVEL'CAN.'    CAN1
     C                     MOVE CVEI3     CNDD
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
D5  C           RTPOND    IFEQ ' '
     C                     MOVE COLODF    V084I
     C                     MOVE CNDD2     PXVALE
     C           KPARAM    CHAINPARAME               99
D6  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    CAN2
F6  C                     END
X5  C                     ELSE
     C                     MOVE COLOSF    V084I
     C                     MOVE CNDD1     PXVALE
     C           KPARAM    CHAINPARAME               99
D6  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    CAN2
F6  C                     END
F5  C                     END
D5  C           YCOL      IFEQ 9
    C           PAPI6     ANDEQ'XXX'
    C           GRAM6     ANDEQ999
    C           RTPOND    ANDEQ' '
     C                     MOVE 'TAB.'    CAN1
F5  C                     END
     C                     MOVELCANDD     V084G
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 6
     C                     MOVEL*BLANKS   V084G
     C                     MOVEL'INTER.  'V084G
D5  C           RTPOND    IFEQ ' '
     C                     MOVE '     '   V084H
X5  C                     ELSE
     C                     MOVE 'TABLE'   V084H
F5  C                     END
D5  C           RTPOND    IFEQ ' '
     C                     MOVE COLDD1    V084I
X5  C                     ELSE
     C                     MOVE COLDD2    V084I
F5  C                     END
F4  C                     END
     *
X3  C                     ELSE
     *
D4  C           SUPPOR    IFEQ 3
     C                     MOVEL'EXT     'V084G
D5  C           YNDUL     IFNE 0
D6  C           RTPOND    IFEQ ' '
     C                     MOVE '     '   V084H
     C                     MOVE COLODF    V084I
X6  C                     ELSE
     C                     MOVE '     '   V084H
     C                     MOVE COLOSF    V084I
F6  C                     END
F5  C                     END
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 4
     C                     MOVEL'CAN     'V084G
F4  C                     END
     *
D4  C           SUPPOR    IFEQ 5
     C                     MOVEL'INTER.  'V084G
     C                     MOVE '     '   V084H
D5  C           YNDUL     IFNE 0
D6  C           RTPOND    IFEQ ' '
     C                     MOVE COLOSF    V084I
X6  C                     ELSE
     C                     MOVE 'TABLE'   V084H
     C                     MOVE COLODF    V084I
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
     *
D3  C           TIMP      IFEQ 4
     C                     MOVE 'P'       UNITE
X3  C                     ELSE
     C                     MOVE 'B'       UNITE
F3  C                     END
     *
     *  CAS SUPPORT IMPRIME
D3  C           TIMP      IFNE 0
    C           TRE,SUPPORORNE 0
     C                     Z-ADDSUPPOR    SU      10
D4  C           TRE,SU    IFNE 0
     C                     MOVE TRE,SU    TIMP
F4  C                     END
     *
     C           KMVTLF    CHAINMVTIMPLF             82
     C                     SETOF                     89
D4  C           *IN82     IFEQ '0'
D5  C           *IN82     DOWEQ'0'
D6  C           STD,SUPPORIFNE LAIZE
     C                     SETON                     89
F6  C                     END
     C           KMVTLF    READEMVTIMPLF                 82
F5  C  N82                END
     C                     Z-ADDSTD,SUPPORLAIZE
D5  C           *IN89     IFEQ '1'
     C                     MOVE '**'      LM84
     C                     SETON                     95
F5  C                     END
D5  C           WECT      IFEQ '3'
    C           TIMP      ANDEQ4
     C                     Z-ADDFORL      W0411   40
     C                     Z-ADDFORH      W0414   40
F5  C                     END
     C                     MOVE PCLI      V084D
D5  C           TRE,SUPPORIFNE 0
     C                     MOVE RCLI      V084D
F5  C                     END
X4  C                     ELSE
     C           KRESP2    SETLLRESPAPL2
     C           TAGR1     TAG
     C           KRESP2    READERESPAPL2                 83
D5  C           *IN83     IFEQ '0'
     C           STD,SUPPORCOMP LAIZE                    89
    C           *IN89     CABEQ'0'       TAGR1
D6  C           WECT      IFEQ '3'
    C           TIM,SU    ANDEQ4
D7  C           LAIZE     IFEQ *ZEROS
     C                     Z-ADDFORL      W0411
     C                     Z-ADDFORH      W0414
X7  C                     ELSE
     C                     Z-ADDFORLC     W0411
     C                     Z-ADDFORHC     W0414
F7  C                     END
F6  C                     END
F5  C                     END
D5  C           SUPPOR    IFLT 4
     C                     Z-ADDUSEXT     USFA
     C                     MOVE REFEX     V084D
D6  C           TRE,SUPPORIFNE 0
     C                     MOVE REREP     V084D
F6  C                     END
     C                     MOVE 'E'       SUPOR
X5  C                     ELSE
     C                     Z-ADDUSINT     USFA
     C                     MOVE REFIN     V084D
D6  C           TRE,SUPPORIFNE 0
     C                     MOVE RIREP     V084D
F6  C                     END
     C                     MOVE 'I'       SUPOR
F5  C                     END
D5  C           TIMP      IFEQ 4
D6  C           FORLBM    IFNE *ZEROS
     C                     Z-ADDFORLBM    FORL
     C                     Z-ADDFORHBM    FORH
X6  C                     ELSE
     C                     Z-ADDFOL,SU    FORL
     C                     Z-ADDFOH,SU    FORH
F6  C                     END
X5  C                     ELSE
     C                     Z-ADDSTD,SU    LAIZE
F5  C                     END
F4  C                     END
     *
     C                     MOVE PAPI      V0842
     C                     MOVE GRAMM     V0843
     C                     MOVE REFOUR    CCC     3
D4  C           CCC       IFEQ 'CXH'
    C           CCC       OREQ 'SOF'
    C           CCC       OREQ 'PEL'
     C                     MOVE REFOUR    V0844
X4  C                     ELSE
     C                     MOVELREFOUR    V0844
F4  C                     END
     C                     MOVELREFOUR    V08442
     C                     MOVE GRAREL    V0845
D4  C           TIMP      IFEQ 4
     C                     Z-ADDFORL      V0847
     C                     MOVE 'x'       V0848
     C                     Z-ADDFORH      V0849
X4  C                     ELSE
     C                     Z-ADDLAIZE     V084A
     C                     Z-ADD1         V084IN
F4  C                     END
     C                     Z-ADD1         J
     C           TIMP      LOKUPTI,J                     99
     C   99                MOVELLIM,J     V084B
D4  C           TRE,SU    IFNE 0
     C                     MOVE 'REP'     V084B
F4  C                     END
     *
     *
X3  C                     ELSE
     *
     *  CAS PREIMPRIME STOCKE
D4  C           SIPREI    IFEQ '*'
     C                     SETON                     50
D5  C           SUPPOR    IFLT 4
     C                     MOVE NIMPE1    NIMP2
     C                     MOVE NIMPE2    NIMP3
     C                     MOVE NIMPE1    WIMP1   40
     C                     MOVE NIMPE2    WIMP2   40
     C           KPREI1    CHAINPREIMPL              84
     C           KMVTPR    CHAINMVTIMPLF             82
     C                     SETOF                     89
D6  C           *IN82     DOWEQ'0'
D7  C           LAIZE     IFNE LMINIS
     C                     SETON                     89
F7  C                     END
     C           KMVTPR    READEMVTIMPLF                 82
F6  C  N82                END
D6  C           *IN84     IFEQ '0'
     C                     MOVE PAPIS     PAPI
     C                     Z-ADDGRAMS     GRAMM
     C                     MOVELADPAPS    REFOUR
     C                     Z-ADDADGRAS    GRAREL
D7  C           TIMPS     IFEQ 4
     C                     Z-ADDFORLS     V0847
     C                     Z-ADDFORLS     W0411
     C                     MOVE 'x'       V0848
     C                     Z-ADDFORHS     V0849
     C                     Z-ADDFORHS     W0414
X7  C                     ELSE
     C                     MOVELLMINIS    V084A
     C                     Z-ADD1         V084IN
F7  C                     END
     C                     MOVE REFEXS    V084D
     C                     MOVE REREP     V084D2
     C                     MOVE REFEXS    REFEX
F6  C                     END
D6  C           V0502     IFNE *ZEROS
D7  C           V0502     IFGT LMINIS
     C                     Z-ADDLMINIS    V0502   41
F7  C                     END
X6  C                     ELSE
     C                     Z-ADDLMINIS    V0502   41
F6  C                     END
     *
     C                     MOVE TIMP      CIMP
     C                     Z-ADDPREIMP    PRE,I
X5  C                     ELSE
     *
     C                     MOVE NIMPI1    NIMP2
     C                     MOVE NIMPI2    NIMP3
     C                     MOVE NIMPI1    WIMP1
     C                     MOVE NIMPI2    WIMP2
     C           KPREI1    CHAINPREIMPL              84
     C           KMVTPR    CHAINMVTIMPLF             82
     C                     SETOF                     89
D6  C           *IN82     DOWEQ'0'
D7  C           LAIZE     IFNE LMINIS
     C                     SETON                     89
F7  C                     END
     C           KMVTPR    READEMVTIMPLF                 82
F6  C  N82                END
D6  C           *IN84     IFEQ '0'
     C                     MOVE PAPIS     PAPI
     C                     Z-ADDGRAMS     GRAMM
     C                     MOVELADPAPS    REFOUR
     C                     Z-ADDADGRAS    GRAREL
D7  C           TIMPS     IFEQ 4
     C                     Z-ADDFORLS     V0847
     C                     Z-ADDFORLS     W0411
     C                     MOVE 'x'       V0848
     C                     Z-ADDFORHS     V0849
     C                     Z-ADDFORHS     W0414
X7  C                     ELSE
     C                     MOVELLMINIS    V084A
     C                     Z-ADD1         V084IN
F7  C                     END
     C                     MOVE REFEXS    V084D
     C                     MOVE RIREP     V084D2
     C                     MOVE REFEXS    REFIN
F6  C                     END
D6  C           V0502     IFNE *ZEROS
D7  C           V0502     IFGT LMINIS
     C                     Z-ADDLMINIS    V0502
F7  C                     END
X6  C                     ELSE
     C                     Z-ADDLMINIS    V0502
F6  C                     END
     C                     MOVE TIMP      CIMP
     C                     Z-ADDPREIMP    PRE,I
F5  C                     END
     *
     C   89                MOVE '**'      LM84
     C   89                SETON                     95
     C                     MOVE PAPI      V0842
     C                     MOVE GRAMM     V0843
     C                     MOVE REFOUR    CCC     3
D5  C           CCC       IFEQ 'CXH'
    C           CCC       OREQ 'SOF'
    C           CCC       OREQ 'PEL'
     C                     MOVE REFOUR    V0844
X5  C                     ELSE
     C                     MOVELREFOUR    V0844
F5  C                     END
     C                     MOVELREFOUR    V08442
     C                     MOVE GRAREL    V0845
     C                     MOVELLIM,7     V084B
     C                     MOVE *BLANKS   WAR
     C                     MOVE WIMP1     WC4     4
     C                     MOVEAWC4       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     W084B   4
     C                     MOVELW084B     V084B
     C                     MOVE WIMP2     WC4
     C                     MOVEAWC4       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     W084B
     C                     MOVE W084B     V084B
     *
X4  C                     ELSE
     *  NEUTRE
     C                     MOVE REFOUR    CCC
     C           CCC       COMP 'CXH'                    88
     C  N88      KRESP2    SETLLRESPAPL2
     C   88      KCXHL3    SETLLRESCXHL3
     C           TAGR2     TAG
     C  N88      KRESP2    READERESPAPL2                 83
     C   88      KCXHL3    READERESCXHL3                 83
D5  C           *IN83     IFEQ '0'
     C           STD,SUPPORCOMP LAIZE                    89
    C   87      *IN89     CABEQ'0'       TAGR2
D6  C           LAIZE     IFEQ *ZERO
     C                     Z-ADDFORL      V0847
     C                     Z-ADDFORL      W0411
     C                     MOVE 'x'       V0848
     C                     Z-ADDFORH      V0849
     C                     Z-ADDFORH      W0414
X6  C                     ELSE
     C                     Z-ADDLAIZE     V084A
     C                     Z-ADD1         V084IN
     C  N89N87             MOVE ' *'      LM84
F6  C                     END
X5  C                     ELSE
     C                     Z-ADDSUPPOR    SU      10
     C                     Z-ADDSTD,SU    V084A
     C                     Z-ADD1         V084IN
     C                     MOVE ' *'      LM84
F5  C                     END
     *
     C                     MOVE PAPI      V0842
     C                     MOVE GRAMM     V0843
     C                     MOVE REFOUR    CCC     3
D5  C           CCC       IFEQ 'CXH'
    C           CCC       OREQ 'SOF'
    C           CCC       OREQ 'PEL'
     C                     MOVE REFOUR    V0844
X5  C                     ELSE
     C                     MOVELREFOUR    V0844
F5  C                     END
     C                     MOVELREFOUR    V08442
     C                     MOVE GRAREL    V0845
     *
F4  C                     END
F3  C                     END
     *
     *  QTE A APPROVISIONNER PAR SUPPORT
     *  --------------------------------
D3  C           WECT      IFEQ '2'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
    C           WECT      OREQ '3'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
     C                     SETON                     91
    C                     GOTO SUIAPP
F3  C                     END
     C           SUFNET    MULT MOYDEC    W1
     C           W1        MULT 0,01      SUROUL 100H
     *
D3  C           SUFNET    IFNE 0
     C                     Z-ADDSFMAX     SUFTH
     C                     ADD  SUROUL    SUFTH
     C                     ADD  REDEC     SUFTH
X3  C                     ELSE
     C                     Z-ADD0         SUFTH
F3  C                     END
     *
D3  C           V084IN    IFEQ 1
D4  C           BMINI     IFNE *ZEROS
     C           V084A     DIV  BMINI     W3      54H
F4  C                     END
     C           SUFTH     MULT W3        SUFTH     H
     *
D4  C           YCOL      IFEQ 9
D5  C           SUPPOR    IFEQ 3
     C           SUFTH     MULT TAL,3     SUFTH     H
F5  C                     END
D5  C           SUPPOR    IFEQ 5
     C           SUFTH     MULT TAL,5     SUFTH     H
F5  C                     END
X4  C                     ELSE
D5  C           SUPPOR    IFEQ 4
     C           SUFTH     MULT TAL,4     SUFTH     H
F5  C                     END
F4  C                     END
     *
D4  C           CCC       IFNE 'CXH'
     C                     MOVE 'B'       FOUB
     C           KUSIL1    CHAINQUAUSI               81
X4  C                     ELSE
     C                     MOVELGRAREL    GRAMOY
     C                     SETOF                     81
F4  C                     END
D4  C           *IN81     IFEQ '0'
     C           SUFTH     MULT GRAMOY    W1     155
     C           W1        DIV  1000      V084E     H
     C           V084E     DIV  0,97      V084E     H
     C                     MOVE 'KG'      V084F
F4  C                     END
X3  C                     ELSE
     *
D4  C           SBFE      IFNE *ZEROS
     C           SUFTH     DIV  SBFE      V084E     H
F4  C                     END
     C                     MOVE 'FE'      V084F
F3  C                     END
     *
D3  C           TIMP      IFEQ 3
     C                     MOVELV084G     V061    3
     C                     MOVELV084D     V062    60
F3  C                     END
     *
     C           SUIAPP    TAG
     *
     C                     MOVE W084      SUP,I
     *
     C           KQUAL1    READECDEQUAL1                 81
F2  C  N81                END
     *
     C           FINSUP    TAG
     *
     C                     MOVE SUP,1     W084
     C                     Z-ADDI         NBSUP   10
     C           V084IN    COMP 1                        30
     C           V084D2    COMP 0                    74
     C                     MOVE SUP,2     W085
     C           V085IN    COMP 1                        31
     C           V085D2    COMP 0                    75
     C                     MOVE SUP,3     W086
     C           V086IN    COMP 1                        32
     C           V086D2    COMP 0                    76
     C                     MOVE SUP,4     W087
     C           V087IN    COMP 1                        33
     C           V087D2    COMP 0                    77
     C                     MOVE SUP,5     W088
     C           V088IN    COMP 1                        34
     C           V088D2    COMP 0                    78
     C   95                MOVELCON,17    V035   40
     *
     *
     *       /////     ONDULATION     /////
D2  C           WECT      IFEQ '2'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
    C           WECT      OREQ '3'
    C           *IN97     ANDEQ'1'
    C           WUSFAB    ANDNE3
     C                     MOVE *BLANKS   V0491  17
     C                     MOVE *BLANKS   V0492  17
     C                     MOVE *BLANKS   V0493  17
     C                     MOVE *BLANKS   V0494  17
     C                     MOVE *BLANKS   V0495  17
     C                     Z-ADD0         V0501
     C                     Z-ADD0         V0502
    C                     GOTO SUIDEC
F2  C                     END
     *  ---> MACHINES
     *  -------------
     *
     C                     MOVE *BLANKS   V0391   2
     C                     MOVE *BLANKS   V0392   2
     C                     MOVE *BLANKS   V0393   2
     C                     MOVELCON,26    STAB
     C                     MOVELHAUT1     STAB2
     C                     MOVELHAUT2     STAB3
     *
D2  C           WECT      IFEQ '2'
D3  C           YCOL      IFEQ 0
    C           YCOL      OREQ 2
    C           YCOL      OREQ 3
    C           YCOL      OREQ 8
    C           YCOL      OREQ 9
    C*          YCOL      OREQ 6
     C           MAOND1    COMP *ZEROS                   99
     C  N99                MOVE MAOND1    V0391
     C           MAOND2    COMP *ZEROS                   99
     C  N99                MOVE MAOND2    V0392
     C           MAOND3    COMP *ZEROS                   99
     C  N99                MOVE MAOND3    V0393
F3  C                     END
F2  C                     END
     *
     *  ---> TYPE D'ONDULE
     *  ------------------
     *
     C                     MOVE *BLANKS   V0491  17
     C                     MOVE *BLANKS   V0492  17
     C                     MOVE *BLANKS   V0493  17
     C                     MOVE *BLANKS   V0494  17
     C                     MOVE *BLANKS   V0495  17
D2  C*          YCOL      IFEQ 6
     C*                    MOVELCVEI3     YNDUL   10
     C*          KONDUL    CHAINONDULEL1             81
D3  C*          *IN81     IFEQ '0'
     C*                    MOVE WONE1     V0491
     C*                    MOVE WONE2     V0492
     C*                    MOVE WONE3     V0493
     C*                    MOVE WONE4     V0494
     C*                    MOVE WONE5     V0495
F3  C*                    END
     C*                    Z-ADD0         YNDUL
X2  C*                    ELSE
     C           KONDUL    CHAINONDULEL1             81
D3  C           *IN81     IFEQ '0'
     C                     MOVE WONE1     V0491
     C                     MOVE WONE2     V0492
     C                     MOVE WONE3     V0493
     C                     MOVE WONE4     V0494
     C                     MOVE WONE5     V0495
F3  C                     END
D3  C           YCOL      IFEQ 9
D4  C           PAPI2     IFEQ 'XXX'
    C           GRAM2     ANDEQ999
    C           PAPI6     OREQ 'XXX'
    C           GRAM6     ANDEQ999
     C                     MOVEL'S'       V0493
F4  C                     END
     C                     MOVEL*BLANKS   V0494
     C                     MOVEL'  /  '   W0494   5
     C                     MOVE CVEI3     CNDD
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE CNDD1     PXVALE
     C           KPARAM    CHAINPARAME               73
D4  C           *IN73     IFEQ '0'
     C                     MOVELPXABRG    X2      2
     C                     MOVELX2        W0494
F4  C                     END
     C                     MOVE CNDD2     PXVALE
     C           KPARAM    CHAINPARAME               73
D4  C           *IN73     IFEQ '0'
     C                     MOVELPXABRG    X2
     C                     MOVE X2        W0494
F4  C                     END
     C                     MOVELW0494     V0494
F3  C                     END
F2  C*                    END
     *
     *
     *  ---> DIMENSIONS FEUILLES
     *  ------------------------
     *
     C                     MOVE *BLANKS   V041
     C                     Z-ADD*ZEROS    V0411
     C                     Z-ADD*ZEROS    V0414
     C                     Z-ADD*ZEROS    V0416
     C                     MOVE *BLANKS   V043
     C                     Z-ADD*ZEROS    V0431
     C                     Z-ADD*ZEROS    V0434
     C                     Z-ADD*ZEROS    V0436
D2  C           YACON     IFEQ 1
    C           YACON     OREQ 2
     C                     Z-ADDDECL      V0411
     C                     MOVE 'MM'      V0412
     C                     MOVE 'X'       V0413
     C                     Z-ADDDECH      V0414
     C                     MOVE 'ML'      V0415
F2  C                     END
     *
D2  C           YACON     IFEQ 9
     C                     MOVELBMINI     BMINIM                          LANC22
D3  C           YNDL      IFNE *ZEROS
     C           BMINIM    DIV  YNDL      W0434                           LANC22
F3  C                     END
     C           YNDL      MULT W0434     W0436                           LANC22
     C                     Z-ADDYNDL      W0432
     C                     MOVEL'x'       W0433                           LANC22
     C                     MOVEL'='       W0435                           LANC22
     C                     MOVEL'RLX'     W0431                           LANC22
     C                     SETON                     13
F2  C                     END
     *
D2  C           YACON     IFEQ 4
     C                     Z-ADDDECL      V0411
     C                     MOVE 'X'       V0413
     C                     Z-ADDDECH      V0414
F2  C                     END
     *
D2  C           YACON     IFEQ 5
     C                     Z-ADDYNDL      V0411
     C                     MOVE 'X'       V0413
     C                     Z-ADDYNDH      V0414
     C                     Z-ADDYOSF1     V0416
F2  C                     END
     *
     *
D2  C           YACON     IFEQ 0
    C           YACON     OREQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     C                     Z-ADDYNDL      V0411
     C                     MOVE 'X'       V0413
     C                     Z-ADDYNDH      V0414
     C                     Z-ADDYOSF1     V0416
D3  C           YCOTE     IFNE *ZEROS
     C                     Z-ADDYCOTE     V0431
     C                     MOVE 'X'       V0433
     C                     Z-ADDYNDH      V0434
     C                     Z-ADDYOSF2     V0436
F3  C                     END
F2  C                     END
     *
D2  C*          WECT      IFEQ '2'
    C*          YCOL      ANDEQ6
    C*          ICEI3     ANDEQ'O'
     C*                    MOVE V0434     MF002   4
     C*                    MOVE V0431     V0434
     C*                    MOVE MF002     V0431
     C*                    MOVE 'X'       V0433
F2  C*                    END
     *  ---> COUPE REPEREE
     *  ------------------
     *
     C                     MOVE '   '     V045    3
D2  C           USEXT     IFNE *ZEROS
    C           USINT     ORNE *ZEROS
    C           NIMPE1    ORNE *BLANKS
    C           NIMPI1    ORNE *BLANKS
     C                     Z-ADD1         I
     C                     MOVE 'NON'     V045
     C           'R'       LOKUPCOP,I                    99
D3  C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
X3  C                     ELSE
     C                     Z-ADD1         I
     C           'V'       LOKUPCOP,I                    99
D4  C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
X4  C                     ELSE
D5  C           NIMPE1    IFNE *BLANKS
     C                     MOVE NIMPE1    WIMP1
     C                     MOVE NIMPE2    WIMP2
     C           KPREI1    CHAINPREIMPL              81
     C           COUPS     COMP 'R'                      99
D6  C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
X6  C                     ELSE
     C           COUPS     COMP 'V'                      99
D7  C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
X7  C                     ELSE
D8  C           NIMPI1    IFNE *BLANKS
     C                     MOVE NIMPI1    WIMP1
     C                     MOVE NIMPI2    WIMP2
     C           KPREI1    CHAINPREIMPL              81
     C           COUPS     COMP 'R'                      99
D9  C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
X9  C                     ELSE
     C           COUPS     COMP 'V'                      99
D10 C           *IN99     IFEQ '1'
     C                     MOVE 'OUI'     V045
F10 C                     END
F9  C                     END
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           V045      IFEQ *BLANKS
    C           V045      OREQ 'NON'
D3  C           REREP     IFNE *BLANKS
    C           RIREP     ORNE *BLANKS
     C                     MOVE 'OUI'     V045
F3  C                     END
F2  C                     END
     *
     *  ---> EPAISSEUR ONDULE
     *  ---------------------
     C                     MOVE *BLANKS   V042   40
     C                     MOVEL'EPAIS '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V042
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
F2  C                     END
     *
     *  ---> HUMIDITE ONDULE
     *  --------------------
     *
     C                     Z-ADDHUMOMN    V0511   31
     C                     Z-ADDHUMOMX    V0512   31
     C                     MOVE *BLANKS   V0513  40
     C                     MOVEL'HUMIDI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V0513
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
F2  C                     END
     *
     *
     *  ---> EBARBAGE JUPE
     *  ------------------
     *
     C                     MOVE *BLANKS   V044   40
     C                     MOVE *BLANKS   V053   40
     C                     MOVEL'EBARBA'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V044
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
D3  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V053
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *  ---> OBSERVATION ONDULATION
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     *
     C                     Z-ADD0         I
     *
D2  C           YACON     IFEQ 1
    C           ZB861     ANDNE'0000'
    C           YACON     OREQ 2
    C           ZB861     ANDNE'0000'
     C                     ADD  1         I
     C                     MOVE *BLANKS   CAR
     C                     MOVEACON,21    CON21  40
     C                     MOVEACON21     CAR,1
     C                     MOVEAZB861     CAR,19
     C                     MOVEAZB862     CAR,31
     C                     MOVEACAR,1     VAR,I
F2  C                     END
     *
D2  C           COTAPE    IFNE *BLANKS
     C                     ADD  1         I
     C                     MOVE *BLANKS   CAR
     C                     MOVEACON,30    VAR,I
F2  C                     END
     *
     *
     C                     MOVE 'ONDUL '  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     C                     MOVE 'ONDREP'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE OBSLIB    OREC   40
     C                     MOVE DTCRE     VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C                     SETON                     79
F2  C                     END
     *
     *
D2  C           YACON     IFEQ 1
    C           YACON     OREQ 2
    C           YACON     OREQ 4
     C                     MOVE 'EMBSEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
F2  C                     END
     *
     C                     MOVE 'QUAOND  'WCOD
     *
     C           KCLIOB    CHAINCLIOBIL2             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
D3  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D4  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X4  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F4  C                     END
F3  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F2  C  N81                END
     *
     C           OBSOND    TAG
     C                     MOVEAVAR,1     VIMPL1
     C                     MOVEAVAR,7     VIMPL2
     C                     MOVEAVDT,1     VIMPD
     *
     *  ---> SUPPORT TYPO
     *  -----------------
     *  V061 ET V062 VOIR SUPPORT
     C                     MOVE *BLANKS   V063   40
     C                     MOVE *BLANKS   V064   40
D2  C           FATYE     IFNE 0
D3  C           V061      IFEQ *BLANKS
     C                     MOVEL'EXTER.  'V061
F3  C                     END
D3  C           V062      IFEQ *ZEROS
     C                     MOVELYEFEX     V062
F3  C                     END
F2  C                     END
     *
D2  C           FATYI     IFNE 0
D3  C           V061      IFEQ *BLANKS
     C                     MOVEL'INTER.  'V061
F3  C                     END
D3  C           V062      IFEQ *ZEROS
     C                     MOVELYEFIN     V062
F3  C                     END
F2  C                     END
     *
     C                     MOVEL'TYPO  '  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V063
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
D3  C           *IN81     IFEQ '0'
     C                     MOVE OBSLIB    V064
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
     *
     *     /////     DECOUPAGE     /////
     C           SUIDEC    TAG
D2  C           WECT      IFNE '5'
    C           *IN97     ANDEQ'1'
     C                     MOVE '5'       WECT
     C           KPLAL2    CHAINPLANIFL1             82
D3  C           *IN82     IFEQ '0'
    C   97      WUSFAB    CABNE3         SUIASS     9292
F3  C                     END
F2  C                     END
     *
D2  C           YACON     IFEQ 6
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     *
     *  ---> NUMERO DE FORME
     *  --------------------
     C                     MOVE YOFOR     V082    50
     *
     *  ---> NOMBRE DE POSES
     *  --------------------
     *
D3  C           YOSFO     IFNE *ZEROS
     C                     Z-ADDYOSFO     V065    30
X3  C                     ELSE
     C                     Z-ADDYOSF1     V065
F3  C                     END
     *
     *  ---> FORME EN
     *  -------------
     *
     C                     MOVE *ZEROS    V0661   20
     C                     MOVE *ZEROS    V0671   20
     C                     MOVE *ZEROS    V0681   20
     C                     MOVE *ZEROS    IMPO1   20
     C                     MOVE *ZEROS    IMPO2   20
     C                     MOVE *BLANKS   V0662   3
     C                     MOVE *BLANKS   V0672   3
     C                     MOVE *BLANKS   V0682   3
     C                     MOVE *BLANKS   V069
     C                     MOVE *BLANKS   V070
     C                     MOVE *BLANKS   CAR
     C                     MOVEL*BLANKS   OBSINT 40
     C                     MOVEL*BLANKS   OBSIN  40
     *
     C                     MOVE *BLANKS   CASIER
     C           YOFOR     CHAINFORDECL1             81
     C           YOFOR     CHAINFORMAG               82
D3  C           *IN81     IFEQ '0'
     *
     C  N82                MOVEL'CAS:    'CASI    9
     C  N82                MOVE CASIER    CASI
     C                     MOVE 'PR'      CODINT
     C           KFORIN    SETLLFORINTL3                 81
D4  C           *IN81     IFEQ '1'
     C                     MOVELCON,27    OBSIN
F4  C                     END
     *
     C                     MOVE PRES1T    V0661
     C                     MOVE PRES2T    V0671
     C                     MOVE PRES3T    V0681
D4  C           CONF1T    IFEQ 'S'
     C                     MOVE 'STD'     V0662
F4  C                     END
D4  C           CONF1T    IFEQ 'N'
     C                     MOVE 'NON'     V0662
F4  C                     END
D4  C           CONF1T    IFEQ 'D'
     C                     MOVE 'DYN'     V0662
F4  C                     END
D4  C           CONF1T    IFEQ 'M'
     C                     MOVE 'SDY'     V0662
F4  C                     END
D4  C           CONF1T    IFEQ 'B'
     C                     MOVE 'SPP'     V0662
F4  C                     END
D4  C           CONF2T    IFEQ 'S'
     C                     MOVE 'STD'     V0672
F4  C                     END
D4  C           CONF2T    IFEQ 'N'
     C                     MOVE 'NON'     V0672
F4  C                     END
D4  C           CONF2T    IFEQ 'D'
     C                     MOVE 'DYN'     V0672
F4  C                     END
D4  C           CONF2T    IFEQ 'M'
     C                     MOVE 'SDY'     V0662
F4  C                     END
D4  C           CONF2T    IFEQ 'B'
     C                     MOVE 'SPP'     V0662
F4  C                     END
D4  C           CONF3T    IFEQ 'S'
     C                     MOVE 'STD'     V0682
F4  C                     END
D4  C           CONF3T    IFEQ 'N'
     C                     MOVE 'NON'     V0682
F4  C                     END
D4  C           CONF3T    IFEQ 'D'
     C                     MOVE 'DYN'     V0682
F4  C                     END
D4  C           CONF3T    IFEQ 'M'
     C                     MOVE 'SDY'     V0662
F4  C                     END
D4  C           CONF3T    IFEQ 'B'
     C                     MOVE 'SPP'     V0662
F4  C                     END
     C                     MOVE PREI1T    IMPO1
     C                     MOVE PREI2T    IMPO2
     C                     MOVE PLAF1T    V0663   1
     C                     MOVE PLAF2T    V0673   1
     C                     MOVE PLAF3T    V0683   1
     *
D4  C           DECMAN    IFNE ' '
D5  C           DECMAN    IFEQ 'N'
    C           CONF1T    ANDNE'S'
    C           CONF2T    ANDNE'S'
    C           CONF3T    ANDNE'S'
    C           CONF1T    ANDNE'D'
    C           CONF2T    ANDNE'D'
    C           CONF3T    ANDNE'D'
    C           CONF1T    ANDNE'M'
    C           CONF2T    ANDNE'M'
    C           CONF3T    ANDNE'M'
    C           CONF1T    ANDNE'B'
    C           CONF2T    ANDNE'B'
    C           CONF3T    ANDNE'B'
    C           DECMAN    OREQ 'O'
     C                     MOVE 'OUI'     V069    3
X5  C                     ELSE
     C                     MOVE 'NON'     V069
F5  C                     END
F4  C                     END
     *
D4  C           DECSEI    IFNE ' '
     C                     Z-ADD1         I
     C                     Z-ADD0         N
     C                     MOVE *BLANKS   CAR
     C                     MOVEA'DECOUPAG'CAR,I
     C                     MOVEA'E sur'   CAR,9
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     *  RECHERCHE IMPRESSION EXT. INT.
D5  C           DECSEI    IFEQ 'E'
D6  C           V084B     IFNE *BLANKS
D7  C           YCOL      IFEQ 9
D8  C           V084B     IFNE V088B
     C                     MOVEAV084B     CAR,I
X8  C                     ELSE
     C                     MOVEA'EXT'     CAR,I
F8  C                     END
X7  C                     ELSE
D8  C           V084B     IFNE V086B
     C                     MOVEAV084B     CAR,I
X8  C                     ELSE
     C                     MOVEA'EXT'     CAR,I
F8  C                     END
F7  C                     END
X6  C                     ELSE
     C                     MOVEAV0842     CAR,I
     C                     ADD  4         I
     C                     MOVE V0843     W0843   3
     C                     MOVEAW0843     CAR,I
F6  C                     END
     C                     EXSR SPCAR
     C                     ADD  2         I
F5  C                     END
     *
D5  C           DECSEI    IFEQ 'I'
D6  C           YCOL      IFEQ 9
D7  C           V088B     IFNE *BLANKS
D8  C           V084B     IFNE V088B
     C                     MOVEAV088B     CAR,I
X8  C                     ELSE
     C                     MOVEA'INT'     CAR,I
F8  C                     END
X7  C                     ELSE
     C                     MOVEAV0882     CAR,I
     C                     ADD  4         I
     C                     MOVE V0883     W0883   3
     C                     MOVEAW0883     CAR,I
F7  C                     END
X6  C                     ELSE
D7  C           V086B     IFNE *BLANKS
D8  C           V084B     IFNE V086B
     C                     MOVEAV086B     CAR,I
X8  C                     ELSE
     C                     MOVEA'INT'     CAR,I
F8  C                     END
X7  C                     ELSE
     C                     MOVEAV0862     CAR,I
     C                     ADD  4         I
     C                     MOVE V0863     W0863   3
     C                     MOVEAW0863     CAR,I
F7  C                     END
F6  C                     END
     C                     EXSR SPCAR
     C                     ADD  2         I
F5  C                     END
     *
     *
D5  C           SEPO1T    IFEQ 'O'
    C           SEPO2T    OREQ 'O'
    C           SEPO3T    OREQ 'O'
     C                     MOVEL'+ SEPARA'WFORM
     C                     MOVE 'TEUR'    WFORM  12
     C                     MOVEAWFORM     CAR,I
F5  C                     END
     C                     MOVEACAR       V070   40
F4  C                     END
     *
D4  C           PERTIN    IFEQ 'O'
     C                     MOVE 'PERTINAX'PERTI   8
F4  C                     END
     *
F3  C                     END
     *
     *  ---> OBSERVATION DECOUPAGE
     *  --------------------------
     *
     C                     MOVE *BLANKS   VMAS    8
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     *
     C                     Z-ADD0         I
     *
     *  DECALAGE CHANGEUR DE PALETTE
     C                     MOVE 'DE'      CODINT
     C           KFORIN    CHAINFORINTL3             81
     C                     ADD  1         I
     C                     MOVELCON,29    DECAL1
D3  C           *IN81     IFEQ '0'
     C                     MOVELOBSINT    DECAL2
X3  C                     ELSE
     C                     MOVEL'0 mm'    DECAL2
F3  C                     END
     C                     MOVELDECAL     VAR,I
     *
     *
     C                     MOVE '5'       WECT
     C           KPLAL2    SETLLPLANIFL1
     C           KPLAM1    READEPLANIFL1                 82
D3  C           *IN82     IFEQ '0'
    C           SECT      ANDEQ'5'
    C           SSECT     ANDEQ'2'
     C                     MOVE SECT      WECT
     C                     MOVE SSECT     WSECT
     C           KMAC01    CHAINMACHIN               81
D4  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELTITETE    VAR,I
F4  C                     END
F3  C                     END
     *
D3  C           YNDUL     IFEQ 7
    C           YCOL      ANDNE8
     C                     MOVE *BLANKS   WAR
     C                     ADD  22        FMINL
     C                     MOVELFMINL     WDEC2
     C                     MOVEAWDEC2     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC2
     C                     MOVE *BLANKS   WAR
     C           ONDH      SUB  30        W2      40
     C           W2        DIV  FMINH     W2
D4  C           W2        IFEQ 1
     C           FMINH     ADD  30        FMINH
X4  C                     ELSE
F4  C                     END
     C                     MOVELFMINH     WDEC4
     C                     MOVEAWDEC4     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC4
     C                     MOVE *BLANKS   WAR
     C                     MOVELYOSF1     WOSF1   3
     C                     MOVEAWOSF1     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WOSF1
     C                     MOVEACON,12    WAR
     C                     MOVEAWDEC2     WAR,9
     C                     MOVEAWDEC4     WAR,14
     C                     MOVEAWOSF1     WAR,19
     C                     ADD  1         I
     C                     ADD  1         I
     C                     MOVE 'MASSICOT'VMAS
F3  C                     END
     *
     C                     MOVE 'DECOUP'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSDEC
     *
     C                     MOVE 'MARQUA'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSDEC
     *
     C                     MOVE 'SUPDEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
F3  C                     END
     *
     C                     MOVE 'QUADEC  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
D4  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D5  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X5  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F5  C                     END
F4  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F3  C  N81                END
     *
     C           OBSDEC    TAG
     C                     MOVEAVAR,1     VDECL1
     C                     MOVEAVAR,7     VDECL2
     C                     MOVEAVDT,1     VDECD
F2  C                     END
     *
     *
     *  ---> OBSERVATION DECOUPAGE
     *  --------------------------
     *
D2  C           YACON     IFEQ 5
    C           YACON     OREQ 9
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     *
     C                     Z-ADD0         I
     *
     C                     MOVE '5'       WECT
     C           KPLAL2    SETLLPLANIFL1
     C           KPLAM1    READEPLANIFL1                 82
D3  C           *IN82     IFEQ '0'
     C                     MOVE SECT      WECT
     C                     MOVE SSECT     WSECT
     C           KMAC01    CHAINMACHIN               81
D4  C           *IN81     IFEQ '0'
     C                     ADD  1         I
     C                     MOVELTITETE    VAR,I
F4  C                     END
F3  C                     END
     *
D3  C           YACON     IFEQ 5
     C                     MOVE MAAUT1    V0661
     C                     MOVE MAAUT2    V0671
     C                     MOVE MAAUT3    V0681
F3  C                     END
     *
     *
D3  C           YACON     IFEQ 5
    C           YNDUL     ANDEQ7
    C           YCOL      ANDNE8
     C                     MOVE *BLANKS   WAR
     C                     MOVELYNDL      WDEC2
     C                     MOVEAWDEC2     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC2
     C                     MOVE *BLANKS   WAR
     C           YNDH      SUB  30        WNDH    40
     C                     MOVELWNDH      WDEC4
     C                     MOVEAWDEC4     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC4
     C                     MOVELYOSF1     WOSF1
     C                     MOVEAWOSF1     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WOSF1
     C                     MOVE *BLANKS   WAR
     C                     MOVEACON,12    WAR
     C                     MOVEAWDEC2     WAR,9
     C                     MOVEAWDEC4     WAR,14
     C                     MOVEAWOSF1     WAR,19
     C                     ADD  1         I
     C                     MOVEAWAR,1     VAR,I
     C                     ADD  1         I
     C                     MOVE 'MASSICOT'VMAS
F3  C                     END
     *
D3  C           YACON     IFEQ 5
    C           YNDUL     ANDNE7
     C                     MOVE *BLANKS   WAR
     C                     MOVELDECL      WDEC2
     C                     MOVEAWDEC2     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC2
     C                     MOVE *BLANKS   WAR
     C           YNDH      SUB  30        WNDH    40
     C                     MOVELDECH      WDEC4
     C                     MOVEAWDEC4     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC4
     C                     MOVELYOSF1     WOSF1
     C                     MOVEAWOSF1     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WOSF1
     C                     MOVE *BLANKS   WAR
     C                     MOVEACON,15    WAR
     C                     MOVEAWDEC2     WAR,9
     C                     MOVEAWDEC4     WAR,14
     C                     MOVEAWOSF1     WAR,19
     C                     ADD  1         I
     C                     MOVEAWAR,1     VAR,I
     C                     ADD  1         I
     C                     MOVE '        'VMAS
F3  C                     END
     *
D3  C           YACON     IFEQ 9
     C                     MOVE *BLANKS   WAR
     C                     MOVELDECL      WDEC2
     C                     MOVEAWDEC2     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC2
     C                     MOVE *BLANKS   WAR
     C                     MOVELDECH      WDEC4
     C                     MOVEAWDEC4     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WDEC4
     C                     MOVELYOSF1     WOSF1
     C                     MOVEAWOSF1     WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     WOSF1
     C                     MOVE *BLANKS   WAR
     C                     MOVEACON,11    WAR
     C                     MOVEAWDEC2     WAR,9
     C                     MOVEAWDEC4     WAR,14
     C                     MOVEAWOSF1     WAR,19
     C                     ADD  1         I
     C                     MOVEAWAR,1     VAR,I
     C                     ADD  1         I
     C                     MOVE 'LUGANO  'VMAS
F3  C                     END
     *
     C                     MOVE 'DECOUP'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROL1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSDC1
     *
     C                     MOVE 'MARQUA'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSDC1
     *
     C                     MOVE 'SUPDEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
F3  C                     END
    C           I         CABEQ7         OBSDC1
     *
     C                     MOVE 'EMBSEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     IFEQ '0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
F3  C                     END
     *
     C                     MOVE 'QUADEC  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
D4  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D5  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X5  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F5  C                     END
F4  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F3  C  N81                END
     *
     C           OBSDC1    TAG
     C                     MOVEAVAR,1     VDECL1
     C                     MOVEAVAR,7     VDECL2
     C                     MOVEAVDT,1     VDECD
F2  C                     END
     *
     *
     *
     *     /////     ASSEMBLAGE     /////
     C           SUIASS    TAG
D2  C           WECT      IFNE '8'
    C           *IN97     ANDEQ'1'
     C                     MOVE '8'       WECT
     C           KPLAL2    CHAINPLANIFL1             82
D3  C           *IN82     IFEQ '0'
    C           WUSFAB    CABNE3         EDIT       9393
F3  C                     END
F2  C                     END
     *
D2  C           YACON     IFEQ 6
    C           COFEN     ANDEQ21
    C           YACON     OREQ 7
    C           YACON     OREQ 8
     *
     *   TITRE SECTION
     C                     MOVEL'ASSEMBLA'LIBSEC 11
     C                     MOVE 'GE '     LIBSEC
     *
     C                     MOVE 'X'       SUIV2
     *
D3  C           COFEN     IFEQ 21
     *
     *  ---> TYPE D'ASSEMBLAGE
     *  ----------------------
     C                     MOVELCOFEN     V0781   20
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE COFEN     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE PXABRG    V0783  10
F4  C                     END
     *
     *  ---> TYPE FENETRE
     *  -----------------
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'RHOD'    PXARGU
     C                     MOVE RHODO     PXVALE
D4  C           RHODO     IFEQ -1
     C                     MOVE 'A'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -2
     C                     MOVE 'B'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -3
     C                     MOVE 'C'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -4
     C                     MOVE 'D'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -5
     C                     MOVE 'E'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -6
     C                     MOVE 'F'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -7
     C                     MOVE 'G'       PXVALE
F4  C                     END
D4  C           RHODO     IFEQ -8
     C                     MOVE 'H'       PXVALE
F4  C                     END
    C           COFEN     IFEQ 22
     C                     MOVE ' BIB'    PXARGU
     C                     END
    C           COFEN     IFEQ 20
     C                     MOVE 'LANG'    PXARGU
     C                     END
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVELPXLIBE    V0782
F4  C                     END
     *
     *  ---> NUMERO DE CLICHE
     *  ---------------------
     *
     C                     MOVELCON,16    V0831  26
     C                     MOVELCLIPF     V0832   50
     *
     *  ---> NOMBRE DE FENETRES
     *  -----------------------
     *
     C                     Z-ADDNBRFE     V0833   10
     *
     *
     *  ---> OBSERVATIONS
     *  -----------------
     *
     C                     MOVEL'FENETR'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D4  C           *IN81     IFEQ '0'
     C                     MOVELOBSLIB    COLF
D5  C           COLF1     IFEQ 'VY'
     C                     MOVE COLF2     V0801
F5  C                     END
D5  C           COLF2     IFEQ 'HT'
     C                     MOVE COLF2     V0812
F5  C                     END
F4  C                     END
     *
     *  ---> MACHINES FENETRES
     *  ----------------------
     *
     C                     Z-ADDMAFEN1    V0791   20
     C                     Z-ADDMAFEN2    V0792   20
     C                     Z-ADDMAFEN3    V0793   20
F3  C                     END
     *
     *
D3  C           COAS1     IFNE 0
     *  ---> TYPE D'ASSEMBLAGE
     *  ----------------------
     C                     MOVELCOAS1     V0781   20
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE COAS1     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE PXLIBE    V0782  40
F4  C                     END
     *
     *  ---> MACHINES ASSEMBLAGE
     *  ------------------------
     *
     C                     Z-ADDMAAS11    V0791   20
     C                     Z-ADDMAAS12    V0792   20
     C                     Z-ADDMAAS13    V0793   20
     *
     *
     *  ---> COLLE VINYLIQUE ET HOLT MELT
     *  ---------------------------------
     *
D4  C           COLA1     IFEQ 'V'
    C           COLA1     OREQ 'M'
     C                     MOVE RCPVI1    V0801   5
     C                     MOVE PISVI1    V0802   10
F4  C                     END
     *
D4  C           COLA1     IFEQ 'H'
    C           COLA1     OREQ 'M'
    C*                    MOVE RCPHM1    V0811   5
     C                     MOVE PIST1     V0812   10
F4  C                     END
     *
F3  C                     END
     *
     *  ---> OBSERVATION ASSEMBLAGE
     *  ---------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     *
     C                     Z-ADD0         I
     *
     C                     MOVE 'DECORT'  DEST
    C*                    MOVE 'BM    '  EMET
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSASS
     *
     C                     MOVE 'ASSEMB'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSASS
     *
     C                     SETOF                     8182
     C                     MOVE *BLANKS   PATFON
     C           ETIQ1     COMP 'A'                      81
     C  N81      ETIQ1     COMP 'B'                      81
     C  N81      ETIQ1     COMP 'C'                      81
     C  N81      ETIQ2     COMP 'A'                      82
     C  N81N82   ETIQ2     COMP 'B'                      82
     C  N81N82   ETIQ2     COMP 'C'                      82
D3  C           *IN81     IFEQ '1'
    C           I         ANDLT7
    C           *IN82     OREQ '1'
    C           I         ANDLT7
     C                     MOVE *BLANKS   CAR
     C                     MOVEACON,23    CAR
     C   81                MOVEAETIQ1     CAR,19
     C   82                MOVEAETIQ2     CAR,19
     C                     MOVEACAR,1     PATFON 40
F3  C                     END
     *
     C                     MOVE 'ETIQUE'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSASS
     *
     C                     MOVE 'EMBSEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D4  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F4  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F3  C  N81                END
    C           I         CABEQ7         OBSASS
     *
     C                     MOVE 'QUAASS  'WCOD
     C           KCLIOB    CHAINCLIOBIL2             81
D3  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
D4  C           RGFAC     IFEQ *ZEROS
    C           RGFAC     OREQ WGFAC
    C           RGLIV     OREQ *ZEROS
    C           RGLIV     OREQ WGLIV
     C                     ADD  1         I
     C                     MOVE LIBOBI    VAR,I
D5  C           DTMAJ     IFEQ 0
     C                     MOVE DTCRE     VDT,I
X5  C                     ELSE
     C                     MOVE DTMAJ     VDT,I
F5  C                     END
F4  C                     END
     C           KCLIOB    READECLIOBIL2                 81
F3  C  N81                END
     *
    C*                    MOVE 'QUALIT'  EMET
    C*                    MOVE 'DECORT'  DEST
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          *IN81     DOWEQ'0'
    C*          I         ANDLT7
    C*                    ADD  1         I
    C*                    MOVE OBSLIB    VAR,I
    C*                    MOVE DTCRE     VDT,I
    C*          NATOBS    IFEQ 'T'
    C*                    DELETOBSPROF1
    C*                    END
    C*          KOBSP2    READEOBSPROL1                 81
    C*                    END
     *
     C           OBSASS    TAG
     C                     MOVEAVAR,1     VASSL1
     C                     MOVEAVAR,7     VASSL2
     C                     MOVEAVDT,1     VASSD
     *
X2  C                     ELSE
D3  C           YACON     IFEQ 6
    C           TDECO3    ANDGE'1'
    C           TDECO3    ANDLE'5'
    C           YACON     OREQ 6
    C           TDECO3    ANDEQ'9'
     C                     MOVEL'DECORTIC'LIBSEC
     C                     MOVE 'AGE'     LIBSEC
     C                     MOVE *BLANKS   VAR
     C                     MOVE *ZEROS    VDT
     *
     C                     MOVE 'X'       SUIV1
     *
     C                     Z-ADD0         I
     *
     * PRET POUR REACTEUR
D4  C           OBSIN     IFNE *BLANKS
     C                     ADD  1         I
     C                     MOVE OBSIN     VAR,I
F4  C                     END
     *
     *
     C                     MOVE 'DECORT'  DEST
     C                     MOVE 'BM    '  EMET
     *
     C           KOBSP2    CHAINOBSPROL1             81
D4  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D5  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F5  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F4  C  N81                END
     *
     C                     MOVE 'EMBSEC'  DEST
     *
     C           KOBSP1    CHAINOBSPROL1             81
D4  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D5  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F5  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F4  C  N81                END
     *
     C                     MOVE 'DECORT'  DEST
     C                     MOVE 'QUALIT'  EMET
     *
     C           KOBSP2    CHAINOBSPROL1             81
D4  C           *IN81     DOWEQ'0'
    C           I         ANDLT7
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DTCRE     VDT,I
D5  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F5  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F4  C  N81                END
     *
     C                     MOVEAVAR,1     VASSL1
     C                     MOVEAVAR,7     VASSL2
     C                     MOVEAVDT,1     VASSD
F3  C                     END
     *
F2  C                     END
     *  /////     BON  SORTIE  EMBALLAGE     /////
     *
     *  ---> CONDITIONNEMENT
     *  --------------------
     *
     C                     MOVE *BLANKS   V100
     C                     MOVE *ZEROS    V1002
     C                     MOVE *ZEROS    V1003
     C                     MOVE *ZEROS    V1004
     C                     MOVE V100      V101
     C                     MOVE V100      V102
     C                     MOVE V100      V103
     C                     MOVE V100      V104
     C                     MOVE V100      V105
     C                     MOVE V100      V106
     C                     MOVE V100      V107
     C                     MOVE V100      V108
     C                     MOVE V100      V109
     C                     MOVE V100      V110
     C                     MOVE *BLANKS   CAR
     C                     MOVE V100      DIT
     C                     Z-ADD0         Y       30
     C                     Z-ADD0         CPT
     C                     Z-ADD0         WQTE
     C                     SETOF                     44
D2  C           QTLANC    IFEQ *ZEROS
     C                     Z-ADDV021      QTLANC
F2  C                     END
     *
     * Ce traitement ne concerne que les cas de Bobinettes de TOURY:
     * ces dernières sont fabriquées en Kg, Ml, M2, et il faut traduir
     * cette quantité en nombre d'unité car le conditionnement est
     * ainsi renseigné. (Nbre de bobinettes /caisse ou palette).
     *
D2  C           YACON     IFEQ 1
    C           YACON     OREQ 2
     *
     *
     * Expression aux Milles, on conserva la quantité :
D3  C           UVENT     IFEQ 1
    C           UVENT     OREQ 5
     C                     Z-ADDQTLANC    WQTE
F3  C                     END
     *
     * Expression en M2
     * WQTE = QTLANC/(DECL/1000)/DECH (arrondi + 1)
D3  C           UVENT     IFEQ 2
D4  C           DECH      IFNE 0
     C           QTLANC    DIV  DECL      WRESUL 168
     C           WRESUL    MULT 1000      WRESUL
     C           WRESUL    DIV  DECH      WRESUL
     C                     Z-ADDWRESUL    WQTE    70
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     * Expression en Ml
     * WQTE = QTLANC/DECH (arrondi + 1)
D3  C           UVENT     IFEQ 3
D4  C           DECH      IFNE 0
     C           QTLANC    DIV  DECH      WRESUL
     C                     Z-ADDWRESUL    WQTE
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     * Expression en Kg
     * Recherche du poids du papier et calcul.
D3  C           UVENT     IFEQ 4
D4  C           DECH      IFNE *ZEROS
D5  C           NIMPE1    IFNE *BLANKS
     C                     MOVE NIMPE1    WIMP1
     C                     MOVE NIMPE2    WIMP2
     C           KPREI1    CHAINPREIMPL              83
     C  N83                Z-ADDGRAMS     GRAM3
F5  C                     END
     C                     MOVELDECL      DECLM   43
     C           DECLM     MULT DECH      SURBOB  73
     C           SURBOB    MULT GRAM3     PDG3    50
     C           SURBOB    MULT GRAM4     PDG4    50
     * Application des Coef d'allongement suite ondulation
    C*          YNDUL     IFEQ 1
    C*          PDG4      MULT 1,32      PDG4      H
    C*                    END
    C*          YNDUL     IFEQ 2
    C*          PDG4      MULT 1,45      PDG4      H
    C*                    END
    C*          YNDUL     IFEQ 3
    C*          PDG4      MULT 1,50      PDG4      H
    C*                    END
D5  C           CCOL      IFNE 8
    C           CCOL      ANDNE3
     C                     MOVE 'ONDU'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE YNDUL     PXVALE
     C           KPARAM    CHAINPARAME               73
     C  N73      PDG4      MULT PXMONT    PDG4      H
F5  C                     ENDIF
     C           PDG4      ADD  PDG3      PDTOT   50
     C           PDTOT     DIV  1000      BOBPDS  31H
X4  C                     ELSE
     C                     Z-ADD*ZEROS    BOBPDS
F4  C                     END
     * Calcul du nombre de bobines :
D4  C           BOBPDS    IFNE 0
     C           QTLANC    DIV  BOBPDS    WRESUL
     C                     Z-ADDWRESUL    WQTE
D5  C           WRESUL    IFGT WQTE
     C                     ADD  1         WQTE
F5  C                     END
X4  C                     ELSE
     C                     Z-ADD0         WQTE
F4  C                     END
F3  C                     END
     *
F2  C                     END
     *
     C           KCAIL1    CHAINCAIPALL1             81
     *
D2  C           *IN81     IFEQ '1'
    C           EMBNAT    OREQ 'S'
    C           EMBNO     OREQ 9
     C                     MOVEACON,13    V1001
     C                     SETON                     81
F2  C                     END
     *
D2  C           *IN81     IFEQ '0'
    C           SUIVAN    ANDEQ*BLANKS
     C                     MOVE 'X'       SUIV3
F2  C                     END
     C                     MOVE ' '       COMPLT  1
     *
D2  C           *IN81     DOWEQ'0'
     C                     ADD  1         CPT
     C           CPT       COMP 1                        51
     C           CPT       COMP 2                        52
     C           CPT       COMP 3                        53
     *
     * //////////////  PAQUET
D3  C           EMBNAT    IFEQ 'Q'
D4  C           EMBTYP    IFEQ 'F'
    C           EMBTYP    OREQ 'L'
     C                     MOVE *BLANKS   LIBSEC
     C                     MOVE 'FICELAGE'LIBSEC
F4  C                     END
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVELEMBNAT    DSNAT
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           EMBLA     IFNE *ZEROS
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     ADD  1         Y
     C                     Z-ADDNBRUNI    V1002
     C                     MOVEACAR       V1001
     C                     Z-ADD*ZEROS    V1003
D4  C           NBRUNI    IFNE *ZEROS
     C           QTLANC    DIV  NBRUNI    W1        H
F4  C                     END
     C                     MOVE W1        REST
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        V1004
     C                     MOVEAV100      DIT,Y
     *
     C                     ADD  1         Y
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     MOVEAOBSLIB    DIT,Y
F4  C                     END
F3  C                     END
     *
     * //////////   CAISSE
D3  C           EMBNAT    IFEQ 'C'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVELEMBNAT    DSNAT
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVELEMBNAT    DSCON
     C                     MOVE EMBCON    DSCON
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMCE'    PXARGU
     C                     MOVE DSCON     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           EMBCON    IFEQ 'H'
     C                     MOVEA'N° '     CAR,I
     C                     ADD  2         I
     C                     MOVEAEMBQUA    CAR,I
     C                     ADD  4         I
     *
X4  C                     ELSE
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMQU'    PXARGU
     C                     MOVE EMBQUA    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVEAPXABRG    CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
F4  C                     END
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  4         I
     *
     C                     MOVEAPILCA1    CAR,I
     C                     ADD  7         I
     *
     C                     MOVEAPILCA2    CAR,I
     *
     C                     ADD  1         Y
     C                     Z-ADDNBRUNI    V1002
     C                     MOVEACAR       V1001
     C                     Z-ADD*ZEROS    V1003
     *
D4  C           NBRUNI    IFNE *ZEROS
     *  WQTE EST LE CALCUL PRECEDENT DU NOMBRE DE BOBINES
D5  C           WQTE      IFNE *ZEROS
     C           WQTE      DIV  NBRUNI    W1
X5  C                     ELSE
     C           QTLANC    DIV  NBRUNI    W1        H
F5  C                     END
F4  C                     END
     C                     MOVE W1        REST    55
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        V1004
     C                     MOVEAV100      DIT,Y
     *
     C                     ADD  1         Y
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     MOVEAOBSLIB    DIT,Y
F4  C                     END
F3  C                     END
     *
     * //////////////  PALETTE
D3  C           EMBNAT    IFEQ 'P'
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     * CONSTITUTION DE LA PREMIERE LIGNE
     *
     C                     MOVELEMBNAT    DSNAT   2
     C                     MOVE EMBTYP    DSNAT
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE DSNAT     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVELEMBNAT    DSCON   2
     C                     MOVE EMBCON    DSCON
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMCE'    PXARGU
     C                     MOVE DSCON     PXVALE
     C           KPARAM    CHAINPARAME               90
D4  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F4  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
D4  C           PALTRA    IFEQ '*'
     C                     MOVEA'Traitées'CAR,I
     C                     ADD  9         I
F4  C                     END
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         Y
     C                     Z-ADDNBDECP    V1002
     C                     MOVEACAR       V1001
     C                     Z-ADDNBCAIP    V1003
     C                     Z-ADD0         W1
D4  C           NBDECP    IFNE *ZEROS
D5  C           YACON     IFEQ 1
    C           YACON     OREQ 2
D6  C           WQTE      IFNE 0
     C           WQTE      DIV  NBDECP    W1        H
X6  C                     ELSE
     C                     Z-ADD0         W1        H
F6  C                     END
X5  C                     ELSE
     C           QTLANC    DIV  NBDECP    W1        H
F5  C                     END
F4  C                     END
     C                     MOVE W1        REST    55
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        V1004
     C                     MOVEAV100      DIT,Y
     *
     *
     * CONSTITUTION DE LA DEUXIEME LIGNE
     *
D4  C           PLANBR    IFNE *ZEROS
    C           DZPNBR    ORNE '0'
     C                     MOVELDZPNBR    WC3N    20
     C                     MOVE PLANBR    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELWC3N      WC3     2
     C                     MOVEAWC3       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPL'    PXARGU
     C                     MOVE PLATYP    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALON    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALAR    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         Y
     C                     Z-ADD0         V1002
     C                     MOVEACAR       V1001
     C                     Z-ADD0         V1003
     C           V1004     MULT WC3N      V1004
     C                     MOVEAV100      DIT,Y
F4  C                     END
     *
     *
     * CONSTITUTION DE LA DEUXIEME LIGNE BIS
     *
D4  C           PLANB2    IFNE *ZEROS
    C           DZPNB2    ORNE *ZEROS
     C                     MOVELDZPNB2    WC3N
     C                     MOVE PLANB2    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELWC3N      WC3
     C                     MOVEAWC3       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPL'    PXARGU
     C                     MOVE PLATY2    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALO2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALA2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  1         Y
     C                     Z-ADD0         V1002
     C                     MOVEACAR       V1001
     C                     Z-ADD0         V1003
     C           V1004     MULT WC3N      V1004
     C                     MOVEAV100      DIT,Y
F4  C                     END
     *
     *
     * CONSTITUTION DE LA TROISIEME LIGNE
     *
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
    C*                    MOVEA'FINITION'CAR,I
    C*                    ADD  9         I
     *
D4  C           HABIL1    IFNE *BLANKS
D5  C           HABI11    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL1    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C  N44      HABI11    COMP 'H'                      44
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI11    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVE HABI12    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL2    IFNE *BLANKS
D5  C           HABI21    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL2    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C  N44      HABI21    COMP 'H'                      44
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI21    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI22    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           HABIL3    IFNE *BLANKS
D5  C           HABI31    IFEQ 'C'
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'CERC'    PXARGU
     C                     MOVE HABIL3    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXLIBE    WAR
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  24        I
F6  C                     END
X5  C                     ELSE
     C  N44      HABI31    COMP 'H'                      44
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HABI31    PXVALE
     C           KPARAM    CHAINPARAME               90
D6  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F6  C                     END
     *
     C                     EXSR SPCAR
     C                     ADD  2         I
     *
     C                     MOVEA'par'     CAR,I
     C                     ADD  4         I
     C                     MOVELHABI32    CAR,I
F5  C                     END
     C                     ADD  2         I
F4  C                     END
     *
D4  C           PROTEC    IFNE *BLANKS
    C           I         ANDLT64
     C                     MOVEA'PROTECTI'CAR,I
     C                     ADD  8         I
     C                     MOVEA'ON'      CAR,I
     C                     ADD  3         I
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'EMPR'    PXARGU
     C                     MOVE PROTEC    PXVALE
     C           KPARAM    CHAINPARAME               90
D5  C           *IN90     IFEQ '0'
     C                     MOVE *BLANKS   WAR
     C                     MOVEAPXABRG    WAR
     C                     MOVEAWAR,1     CAR,I
F5  C                     END
F4  C                     END
     *
     C                     ADD  1         Y
     C                     MOVEACAR,1     DIT,Y
     *
     *
     * CONSTITUTION DE LA QUATRIEME LIGNE BIS
D4  C           PLALIB    IFNE *BLANKS
     C                     ADD  1         Y
     C                     MOVEAPLALIB    DIT,Y
F4  C                     END
     *
     *
     * CONSTITUTION DE LA QUATRIEME LIGNE
     *
     C                     MOVEL'      '  DEST
     C   51                MOVEL'EMBAL1'  DEST
     C   52                MOVEL'EMBAL2'  DEST
     C   53                MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D4  C           *IN82     IFEQ '0'
     C                     ADD  1         Y
     C                     MOVEAOBSLIB    DIT,Y
F4  C                     END
F3  C                     END
     C           KCAIL1    READECAIPALL1                 81
     C  N81      EMBNO     COMP 9                        81
D3  C  N81      EMBNO     IFGT 2
     C                     MOVE '*'       COMPLT
F3  C                     END
F2  C  N81                END
     *
D2  C           CPT       IFEQ 1
     C                     MOVEL'EMBAL2'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         Y
     C                     MOVEAOBSLIB    DIT,Y
F3  C                     END
F2  C                     END
     *
D2  C           CPT       IFLT 3
     C                     MOVEL'EMBAL3'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         Y
     C                     MOVEAOBSLIB    DIT,Y
F3  C                     END
F2  C                     END
     *
D2  C           Y         IFLT 11
     C                     MOVEL'EMBETI'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     DOWEQ'0'
     C                     ADD  1         Y
     C                     MOVEAOBSLIB    DIT,Y
     C           KOBSP1    READEOBSPROL1                 82
F3  C                     END
F2  C                     END
     *
D2  C           Y         IFLT 11
     C                     MOVEL'EMBSEC'  DEST
     C           KOBSP1    CHAINOBSPROL1             82
D3  C           *IN82     IFEQ '0'
     C                     ADD  1         Y
     C                     MOVEAOBSLIB    DIT,Y
F3  C                     END
F2  C                     END
     *
     C                     MOVE DIT,1     V100
     C                     MOVE DIT,2     V101
     C                     MOVE DIT,3     V102
     C                     MOVE DIT,4     V103
     C                     MOVE DIT,5     V104
     C                     MOVE DIT,6     V105
     C                     MOVE DIT,7     V106
     C                     MOVE DIT,8     V107
     C                     MOVE DIT,9     V108
     C                     MOVE DIT,10    V109
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'EXPED '  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     IFEQ '0'
     C                     MOVELOBSLIB    V110
F2  C                     END
     *
     *  ---> BON EMBALLAGE COMPLEMENTAIRE SI + DE 2 EMBALLAGES
     *  ------------------------------------------------------
     *
D2  C           COMPLT    IFNE ' '
     C                     Z-ADDPUS       EUS
     C                     Z-ADDWTE       ETE
     C                     Z-ADDWOCLI     EOCLI
     C                     Z-ADDWOPRO     EOPRO
     C                     Z-ADDWCONF     ECONF
     C                     Z-ADDWEQFAB    EEQFAB
     C                     Z-ADDQTLANC    ETLANC
     C                     CALL 'EMB017£'
     C                     PARM           DSEMBP
F2  C                     END
     *
     *  ---> MODE D'EXPEDITION
     *  ----------------------
     *
D2  C           MOPOR     IFEQ '1'
     C                     MOVE 'FER'     V111
X2  C                     ELSE
D3  C           MOPOR     IFNE ' '
     C                     MOVE 'ROUTE'   V111    5
F3  C                     END
F2  C                     END
     *
     *  ---> NOM ABREGE CLIENT
     *  --------------------
     *
     C                     MOVE ABRCLI    V115   20
     *
     * EMBALLAGE
     * ---------
     *
     *  QTE A PRENDRE EN COMPTE POUR LE CALCUL
     *
     C                     MOVE *BLANKS   EMB
     C                     MOVE *BLANKS   Z001   25
     C                     MOVE *BLANKS   Z002   25
     C                     MOVE *BLANKS   Z003   25
     C                     MOVE *BLANKS   Z004   25
     C                     MOVE *BLANKS   Z005   25
     C                     MOVE *BLANKS   Z006   25
     C                     Z-ADD0         MAE
     C                     Z-ADD0         Z031    50
     C                     Z-ADD0         Z032    50
     C                     Z-ADD0         Z033    50
     C                     Z-ADD0         Z034    50
     C                     Z-ADD0         Z035    50
     C                     Z-ADD0         Z036    50
     C                     Z-ADD0         DC
     C                     Z-ADD0         Z011    60
     C                     Z-ADD0         Z012    60
     C                     Z-ADD0         Z013    60
     C                     Z-ADD0         Z014    60
     C                     Z-ADD0         Z015    60
     C                     Z-ADD0         Z016    60
     C                     Z-ADD0         CAI
     C                     Z-ADD0         Z021    30
     C                     Z-ADD0         Z022    30
     C                     Z-ADD0         Z023    30
     C                     Z-ADD0         Z024    30
     C                     Z-ADD0         Z025    30
     C                     Z-ADD0         Z026    30
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD0         N       20
     *
     C           KCAIL1    CHAINCAIPALL1             81
     *
D2  C           *IN81     IFEQ '1'
    C           EMBNAT    OREQ 'S'
    C           EMBNO     OREQ 9
     C                     MOVE *BLANKS   WAR
     C                     MOVELCON,13    WAR
     C                     MOVEAWAR,1     EMB,1
     C                     SETON                     81
F2  C                     END
     *
D2  C           *IN81     DOWEQ'0'
     *
     * //////////////  PAQUET
    C           EMBNAT    CABEQ'Q'       SUITSP
     C                     ADD  1         N
     * //////////   CAISSE
D3  C           EMBNAT    IFEQ 'C'
     C                     MOVE *BLANKS   CAR
     *
     C                     MOVEA'CAIS.'   CAR,1
     C                     Z-ADD6         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  1         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  1         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     ADD  4         I
     C                     MOVELPILCA1    WC1
     C                     MOVEAWC1       CAR,I
     *
D4  C           PILCA2    IFNE ' '
     C                     ADD  3         I
     C                     MOVEL'/'       CAR,I
     C                     ADD  1         I
     C                     MOVELPILCA2    WC1
     C                     MOVEAWC1       CAR,I
F4  C                     END
     *
     C                     MOVEACAR,1     EMB,N
     C                     Z-ADDNBRUNI    DC,N
D4  C           NBRUNI    IFNE *ZEROS
     *  WQTE EST LE CALCUL PRECEDENT DU NOMBRE DE BOBINES
D5  C           WQTE      IFNE *ZEROS
     C           WQTE      DIV  NBRUNI    W1
X5  C                     ELSE
     C           QTLANC    DIV  NBRUNI    W1        H
F5  C                     END
F4  C                     END
     C                     MOVE W1        REST    55
D4  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F4  C                     END
     C                     Z-ADDW1        MAE,N
F3  C                     END
     *
     * //////////////  PALETTE ET PLAQUES ///////////
D3  C           EMBNAT    IFEQ 'P'
     C                     MOVE *BLANKS   CAR
     * //////////////  PALETTE
     *
     C                     MOVEA'PALETTES'CAR,1
     C                     Z-ADD10        I
     *
D4  C           PALTRA    IFEQ '*'
     C                     MOVEA'Trait'   CAR,I
     C                     ADD  6         I
F4  C                     END
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLA     WC1     3
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  1         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBLO     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  3         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  1         I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELEMBHT     WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D4  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F4  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     MOVEACAR,1     EMB,N
     C                     Z-ADDNBDECP    DC,N
     C                     Z-ADDNBCAIP    CAI,N
D4  C           NBDECP    IFNE *ZEROS
     *  WQTE EST LE CALCUL PRECEDENT DU NOMBRE DE BOBINES
D5  C           WQTE      IFNE *ZEROS
     C           WQTE      DIV  NBDECP    W1        H
X5  C                     ELSE
     C           QTLANC    DIV  NBDECP    W1        H
F5  C                     END
     C                     MOVE W1        REST    55
D5  C           REST      IFGT *ZERO
     C                     ADD  1         W1
F5  C                     END
     C                     Z-ADDW1        MAE,N
F4  C                     END
     *
     *
     * //////////////  PLAQUES
D4  C           PLANBR    IFNE *ZEROS
    C           DZPNBR    ORNE '0'
     C                     MOVELDZPNBR    WC3N    20
     C                     MOVE PLANBR    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVEA'PLAQUES' CAR,1
     C                     Z-ADD10        I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALON    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALAR    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     Z-ADDN         M       20
     C                     ADD  1         N
     C                     MOVEACAR,1     EMB,N
     C           MAE,M     MULT WC3N      MAE,N
F4  C                     END
     *
     * //////////////  PLAQUES BIS
D4  C           PLANB2    IFNE *ZEROS
    C           DZPNB2    ORNE *ZEROS
     C                     MOVELDZPNB2    WC3N
     C                     MOVE PLANB2    WC3N
     C                     MOVE *BLANKS   CAR
     C                     Z-ADD1         I
     *
     C                     MOVEA'PLAQUES' CAR,1
     C                     Z-ADD10        I
     *
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALO2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     C                     ADD  4         I
     C                     MOVEL'x'       CAR,I
     C                     ADD  2         I
     C                     MOVE *BLANKS   WAR
     C                     MOVELPLALA2    WC1
     C                     MOVEAWC1       WAR
     C                     Z-ADD1         J
D5  C           WAR,J     DOWEQ'0'
     C                     MOVE ' '       WAR,J
     C                     ADD  1         J
F5  C                     END
     C                     MOVEAWAR,1     CAR,I
     *
     C                     Z-ADDN         M       20
     C                     ADD  1         N
     C                     MOVEACAR,1     EMB,N
     C           MAE,M     MULT WC3N      MAE,N
F4  C                     END
F3  C                     END
     *
     C           SUITSP    TAG
     C           KCAIL1    READECAIPALL1                 81
F2  C  N81                END
     *
     C                     MOVEAEMB,1     Z001
     C                     MOVEAEMB,2     Z002
     C                     MOVEAEMB,3     Z003
     C                     MOVEAEMB,4     Z004
     C                     MOVEAEMB,5     Z005
     C                     MOVEAEMB,6     Z006
     C                     MOVEADC,1      Z011
     C                     MOVEADC,2      Z012
     C                     MOVEADC,3      Z013
     C                     MOVEADC,4      Z014
     C                     MOVEADC,5      Z015
     C                     MOVEADC,6      Z016
     C                     MOVEACAI,1     Z021
     C                     MOVEACAI,2     Z022
     C                     MOVEACAI,3     Z023
     C                     MOVEACAI,4     Z024
     C                     MOVEACAI,5     Z025
     C                     MOVEACAI,6     Z026
     C                     Z-ADDMAE,1     Z031
     C                     Z-ADDMAE,2     Z032
     C                     Z-ADDMAE,3     Z033
     C                     Z-ADDMAE,4     Z034
     C                     Z-ADDMAE,5     Z035
     C                     Z-ADDMAE,6     Z036
     *
     * ---> PDS ET QTE MINI MAXI EXPEDITION
     *      ===============================
     C                     Z-ADD1         SF
     C                     Z-ADD*ZERO     MIN
     C                     Z-ADD*ZERO     MAX
     C                     Z-ADDV021      SURF
     C                     Z-ADDWURFF     SURFF
     C                     MOVE 'E'       DS1
D2  C           V021      IFNE *ZEROS
     C                     CALL 'CDEC92£'
     C                     PARM           DSPARA
F2  C                     END
     C                     Z-ADDMIN       V113    80
     C                     Z-ADDMAX       V114    80
     *                                                                   LANC22
     C           YDUNI     MULT V021      PDBRUT 100                      LANC22
D2  C           WVENT     IFEQ 1                                         LANC22
     C           PDBRUT    MULT 0,001     V112    80H
X2  C                     ELSE
     C           PDBRUT    MULT 0,01      V112      H
F2  C                     END
     *
     *  ---> OBSERVATION CONTROLE
     *  -------------------------
     *
     C                     MOVE *BLANKS   VAR
     C                     MOVE *BLANKS   VDT
     C                     MOVE *BLANKS   VDTL1
     C                     MOVE *BLANKS   VDTL2
     C                     MOVE *BLANKS   VCTL1
     C                     MOVE *BLANKS   VCTL2
     C                     Z-ADD0         I
     *
D2  C           CONFIN    IFEQ 'O'
     C                     ADD  1         I
     C                     MOVE CON,19    VAR,I
F2  C                     END
     *
     C                     MOVE 'QUALIT'  EMET
    C*                    MOVE 'FICLAB'  DEST
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          *IN81     DOWEQ'0'
    C*          I         ANDLT12
    C*                    ADD  1         I
    C*                    MOVE OBSLIB    VAR,I
    C*                    MOVE DEST      VDT,I
    C*          NATOBS    IFEQ 'T'
    C*                    DELETOBSPROF1
    C*                    END
    C*          KOBSP2    READEOBSPROL1                 81
    C* N81                END
     *
     C                     MOVE 'PRODUI'  DEST
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'ONDUL '  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'TYPO  '  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'DECOUP'  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'ASSEMB'  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'DECORT'  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT4
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'EXPED '  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'CONTRO'  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
    C           I         CABEQ12        OBSCTL
     *
     C                     MOVE 'QUALIT'  EMET
     C                     MOVE 'DAC   '  DEST
     *
     C           KOBSP2    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           I         ANDLT12
     C                     ADD  1         I
     C                     MOVE OBSLIB    VAR,I
     C                     MOVE DEST      VDT,I
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP2    READEOBSPROL1                 81
F2  C  N81                END
     *
     *  ---> PRELEVEMENT
     *  ----------------
     * PREMIERE COMMANDE
    C*          I         CABEQ12        OBSCTL
     *
    C*          KOBSP2    CHAINOBSPROL1             81
    C*          PREM      IFEQ 'P'
    C*          I         ANDLT12
    C*                    ADD  1         I
    C*                    MOVELCON,24    VAR,I
    C*                    END
     *
     *
     C           OBSCTL    TAG
     C                     MOVEAVAR,1     VCTL1
     C                     MOVEAVAR,7     VCTL2
     C                     MOVEAVDT,1     VDTL1
     C                     MOVEAVDT,7     VDTL2
     *
     *  ---> ETIQUETTE
     *  --------------
     *
     C                     MOVE *BLANKS   V1201  40
     C                     MOVE *BLANKS   V1211  40
     C                     MOVE *BLANKS   V1221  40
     C                     MOVE *ZEROS    V1202   60
     C                     MOVE *ZEROS    V1212   60
     C                     MOVE *ZEROS    V1222   60
     C                     Z-ADD*ZEROS    T       10
     C                     MOVEL'EMBETI'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V1201
     C   21                Z-ADDDTCRE     V1202
     C   22                MOVE OBSLIB    V1211
     C   22                Z-ADDDTCRE     V1212
     C   23                MOVE OBSLIB    V1221
     C   23                Z-ADDDTCRE     V1222
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *  ---> PRELEVEMENT
     *  ----------------
     *
     C                     MOVEL'PRELEV'  DEST
     C           KOBSP1    CHAINOBSPROL1             81
D2  C           *IN81     DOWEQ'0'
    C           T         ANDLT3
     C                     ADD  1         T
     C           T         COMP 2                    232122
     C   21                MOVE OBSLIB    V1201
     C   21                Z-ADDDTCRE     V1202
     C   22                MOVE OBSLIB    V1211
     C   22                Z-ADDDTCRE     V1212
     C   23                MOVE OBSLIB    V1221
     C   23                Z-ADDDTCRE     V1222
D3  C           NATOBS    IFEQ 'T'
     C                     DELETOBSPROF1
F3  C                     END
     C           KOBSP1    READEOBSPROL1                 81
F2  C  N81                END
     *
     *  ---> PRELEVEMENT SED QTE
     *  ------------------------
     *
     C                     MOVE *BLANKS   V125    4
     C                     Z-ADD0         DSETAT
     C                     Z-ADD1         I
     C           V017      LOKUPLET,I                    55
D2  C           *IN55     IFEQ '1'
     C                     Z-ADDI         ETATE
F2  C                     END
     *
     C                     Z-ADD1         I
     C           V018      LOKUPLET,I                    55
D2  C           *IN55     IFEQ '1'
     C                     Z-ADDI         ETATI
F2  C                     END
     *
     C                     Z-ADD1         I
     C           V019      LOKUPLET,I                    55
D2  C           *IN55     IFEQ '1'
     C                     Z-ADDI         ETATD
F2  C                     END
     *
D2  C           ETATD     IFEQ 2
     C                     MOVE '   5'    V125
F2  C                     END
     *
D2  C           ETATD     IFEQ 1
     C                     MOVE '   5'    V125
D3  C           ETATE     IFEQ 1
    C           ETATI     OREQ 1
     C                     MOVE '  20'    V125
F3  C                     END
F2  C                     END
     *
D2  C           ETATD     IFEQ 4
D3  C           ETATE     IFEQ 1
    C           ETATE     OREQ 2
    C           ETATI     OREQ 1
    C           ETATI     OREQ 2
     C                     MOVE '   5'    V125
F3  C                     END
F2  C                     END
     *
     *
     * EDITION DES TPS EXPRIMES EN HEURES DECIMALS ARRONDIS A LA
     * DECIMALE SUPERIEUR
     C                     Z-ADD99        RANG
     C           KPLAL3    SETLLPLANIFL3
     C           KCDES1    READEPLANIFL3                 81
     *
D2  C           *IN81     DOWEQ'0'
    C           *IN81     ANDEQ'1'
D3  C           WUSFAB    IFEQ PUS
     C                     Z-ADDRETPS     WETPS   31
D4  C           RETPS     IFGT WETPS
     C                     ADD  0,1       WETPS
F4  C                     END
     *
D4  C           QTFAB     IFNE V023
     C           V023      DIV  QTFAB     W5      85
     C           TPSTOT    MULT W5        W6      62
     C                     Z-ADDW6        WOTPS   31
D5  C           W6        IFGT WOTPS
     C                     ADD  0,1       WOTPS
F5  C                     END
X4  C                     ELSE
     C                     Z-ADDTPSTOT    WOTPS
D5  C           TPSTOT    IFGT WOTPS
     C                     ADD  0,1       WOTPS
F5  C                     END
F4  C                     END
     *
D4  C           SECT      IFEQ '2'
    C           SECT      OREQ '3'
     C                     Z-ADDWETPS     WETPSO  31
     C                     Z-ADDWOTPS     WOTPSO  31
F4  C                     END
     *
D4  C           SECT      IFEQ '5'
    C           SECT      OREQ '6'
     C                     Z-ADDWETPS     WETPSD  31
     C                     Z-ADDWOTPS     WOTPSD  31
F4  C                     END
     *
D4  C           SECT      IFEQ '7'
     C                     Z-ADDWETPS     WETPST  31
     C                     Z-ADDWOTPS     WOTPST  31
F4  C                     END
     *
D4  C           SECT      IFEQ '8'
     C                     Z-ADDWETPS     WETPSA  31
     C                     Z-ADDWOTPS     WOTPSA  31
F4  C                     END
F3  C                     END
     *
     C           KCDES1    READEPLANIFL3                 81
F2  C  N81                END
     *
     C           EDIT      TAG
     C           KPRO10    CHAINCODBARL2             56
     C                     Z-ADD0         X       10
D2  C           *IN56     DOWEQ'0'
    C           X         ANDLT7
     C                     ADD  1         X
     C                     MOVELNOEMB     NOE,X
     C                     MOVELPOSCO     POS,X
     C                     MOVELREFPRO    REF,X
     C           KPRO10    READECODBARL2                 56
F2  C  N56                END
     *
     C                     Z-ADDPUS       USINE
     C                     Z-ADDWTE       STE
     C                     Z-ADDWCONF     NCONF
     C                     Z-ADDWEQFAB    SEQFAB
     C                     Z-ADDWOCLI     NOCLI
     C                     Z-ADDWOPRO     NOPRO
     C                     MOVE *BLANKS   TITETE
     C           KMAC02    CHAINMACHIN               81
D2  C           *IN81     IFEQ '0'
     C                     MOVE '    '    TITETE
     C                     MOVE COMAC     TITETE
F2  C                     END
     *
D2  C           NBSUP     IFGE 1
    C           V084G     ANDNE*BLANKS
     C                     Z-ADD0         PREIMP
     C                     MOVEL*BLANKS   PCLI
     C                     Z-ADDSCX,1     CXHSPE
     C                     Z-ADD1         SUPPOR
     C                     MOVEL*BLANKS   LIBSUP
     C                     MOVELV084G     LIBSUP
     C                     Z-ADDV0847     FORL
     C                     Z-ADDV0849     FORH
     C                     Z-ADDV084A     LAIZE
     C                     Z-ADDV084E     KGPRE
     C                     Z-ADD0         FEPRE
     C                     MOVE 'B'       FOUB
     C                     MOVELV0842     PAPI
     C                     MOVELV0843     GRAMM
     C                     MOVELV08442    REFOUR
     C                     MOVELREFOUR    CXH     3
     C                     MOVELV0845     GRAREL
D3  C           V084D     IFNE *ZEROS
     C                     MOVELV084D     PCLI
F3  C                     END
D3  C           V084D2    IFNE *ZEROS
     C                     MOVELV084D2    PCLI
F3  C                     END
D3  C           PRE,1     IFNE *ZEROS
     C                     Z-ADDPRE,1     PREIMP
F3  C                     END
     C                     MOVELV084B     LIBIMP
     C                     Z-ADD1         J
     C           LIBIMP    LOKUPLIM,J                    99
     C   99                MOVELTI,J      CIMP
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     MOVE '  '      CODMAT
D3  C           CIMP      IFEQ 3
     C                     MOVEL*BLANKS   PCLI
     C                     MOVEL*BLANKS   LIBIMP
     C                     Z-ADD0         CIMP
F3  C                     END
     C                     WRITECAROFF1
     C                     Z-ADD0         PREIMP  90
F2  C                     END
     *
D2  C           NBSUP     IFGE 2
    C           V085G     ANDNE*BLANKS
     C                     MOVEL*BLANKS   PCLI
     C                     Z-ADDSCX,2     CXHSPE
     C                     Z-ADD2         SUPPOR
     C                     MOVEL*BLANKS   LIBSUP
     C                     MOVELV085G     LIBSUP
     C                     Z-ADDV0857     FORL
     C                     Z-ADDV0859     FORH
     C                     Z-ADDV085A     LAIZE
     C                     Z-ADDV085E     KGPRE
     C                     Z-ADD0         FEPRE
     C                     MOVE 'B'       FOUB
     C                     MOVELV0852     PAPI
     C                     MOVELV0853     GRAMM
     C                     MOVELV08542    REFOUR
     C                     MOVELREFOUR    CXH
     C                     MOVELV0855     GRAREL
D3  C           V085D     IFNE *ZEROS
     C                     MOVELV085D     PCLI
F3  C                     END
D3  C           V085D2    IFNE *ZEROS
     C                     MOVELV085D2    PCLI
F3  C                     END
D3  C           PRE,2     IFNE *ZEROS
     C                     Z-ADDPRE,2     PREIMP
F3  C                     END
     C                     MOVELV085B     LIBIMP
     C                     Z-ADD1         J
     C           LIBIMP    LOKUPLIM,J                    99
     C   99                MOVELTI,J      CIMP
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     MOVE '  '      CODMAT
D3  C           CIMP      IFEQ 3
     C                     MOVEL*BLANKS   PCLI
     C                     MOVEL*BLANKS   LIBIMP
     C                     Z-ADD0         CIMP
F3  C                     END
     C                     WRITECAROFF1
     C                     Z-ADD0         PREIMP
F2  C                     END
     *
D2  C           NBSUP     IFGE 3
    C           V086G     ANDNE*BLANKS
     C                     MOVEL*BLANKS   PCLI
     C                     Z-ADDSCX,3     CXHSPE
     C                     Z-ADD3         SUPPOR
     C                     MOVEL*BLANKS   LIBSUP
     C                     MOVELV086G     LIBSUP
     C                     Z-ADDV0867     FORL
     C                     Z-ADDV0869     FORH
     C                     Z-ADDV086A     LAIZE
     C                     Z-ADDV086E     KGPRE
     C                     Z-ADD0         FEPRE
     C                     MOVE 'B'       FOUB
     C                     MOVELV0862     PAPI
     C                     MOVELV0863     GRAMM
     C                     MOVELV08642    REFOUR
     C                     MOVELREFOUR    CXH
     C                     MOVELV0865     GRAREL
D3  C           V086D     IFNE *ZEROS
     C                     MOVELV086D     PCLI
F3  C                     END
D3  C           V086D2    IFNE *ZEROS
     C                     MOVELV086D2    PCLI
F3  C                     END
D3  C           PRE,3     IFNE *ZEROS
     C                     Z-ADDPRE,3     PREIMP
F3  C                     END
     C                     MOVELV086B     LIBIMP
     C                     Z-ADD1         J
     C           LIBIMP    LOKUPLIM,J                    99
     C   99                MOVELTI,J      CIMP
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     MOVE '  '      CODMAT
D3  C           CIMP      IFEQ 3
     C                     MOVEL*BLANKS   PCLI
     C                     MOVEL*BLANKS   LIBIMP
     C                     Z-ADD0         CIMP
F3  C                     END
     C                     WRITECAROFF1
     C                     Z-ADD0         PREIMP
F2  C                     END
     *
     *
D2  C           NBSUP     IFGE 4
    C           V087G     ANDNE*BLANKS
     C                     MOVEL*BLANKS   PCLI
     C                     Z-ADDSCX,4     CXHSPE
     C                     Z-ADD4         SUPPOR
     C                     MOVEL*BLANKS   LIBSUP
     C                     MOVELV087G     LIBSUP
     C                     Z-ADDV0877     FORL
     C                     Z-ADDV0879     FORH
     C                     Z-ADDV087A     LAIZE
     C                     Z-ADDV087E     KGPRE
     C                     Z-ADD0         FEPRE
     C                     MOVE 'B'       FOUB
     C                     MOVELV0872     PAPI
     C                     MOVELV0873     GRAMM
     C                     MOVELV08742    REFOUR
     C                     MOVELREFOUR    CXH
     C                     MOVELV0875     GRAREL
D3  C           V087D     IFNE *ZEROS
     C                     MOVELV087D     PCLI
F3  C                     END
D3  C           V087D2    IFNE *ZEROS
     C                     MOVELV087D2    PCLI
F3  C                     END
D3  C           PRE,4     IFNE *ZEROS
     C                     Z-ADDPRE,4     PREIMP
F3  C                     END
     C                     MOVELV087B     LIBIMP
     C                     Z-ADD1         J
     C           LIBIMP    LOKUPLIM,J                    99
     C   99                MOVELTI,J      CIMP
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     MOVE '  '      CODMAT
D3  C           CIMP      IFEQ 3
     C                     MOVEL*BLANKS   PCLI
     C                     MOVEL*BLANKS   LIBIMP
     C                     Z-ADD0         CIMP
F3  C                     END
     C                     WRITECAROFF1
     C                     Z-ADD0         PREIMP
F2  C                     END
     *
     *
D2  C           NBSUP     IFGE 5
    C           V088G     ANDNE*BLANKS
     C                     MOVEL*BLANKS   PCLI
     C                     Z-ADDSCX,5     CXHSPE
     C                     Z-ADD5         SUPPOR
     C                     MOVEL*BLANKS   LIBSUP
     C                     MOVELV088G     LIBSUP
     C                     Z-ADDV0887     FORL
     C                     Z-ADDV0889     FORH
     C                     Z-ADDV088A     LAIZE
     C                     Z-ADDV088E     KGPRE
     C                     Z-ADD0         FEPRE
     C                     MOVE 'B'       FOUB
     C                     MOVELV0882     PAPI
     C                     MOVELV0883     GRAMM
     C                     MOVELV08842    REFOUR
     C                     MOVELREFOUR    CXH
     C                     MOVELV0885     GRAREL
D3  C           V088D     IFNE *ZEROS
     C                     MOVELV088D     PCLI
F3  C                     END
D3  C           V088D2    IFNE *ZEROS
     C                     MOVELV088D2    PCLI
F3  C                     END
D3  C           PRE,5     IFNE *ZEROS
     C                     Z-ADDPRE,5     PREIMP
F3  C                     END
     C                     MOVELV088B     LIBIMP
     C                     Z-ADD1         J
     C           LIBIMP    LOKUPLIM,J                    99
     C   99                MOVELTI,J      CIMP
D3  C           SUPPOR    IFEQ 0
     C                     MOVE OBS,1     OBSERV
X3  C                     ELSE
     C                     MOVE OBS,SUPPOROBSERV
F3  C                     END
     C                     MOVE '  '      CODMAT
D3  C           CIMP      IFEQ 3
     C                     MOVEL*BLANKS   PCLI
     C                     MOVEL*BLANKS   LIBIMP
     C                     Z-ADD0         CIMP
F3  C                     END
     C                     WRITECAROFF1
     C                     Z-ADD0         PREIMP
F2  C                     END
     *
     C                     EXCPTBONSF
     *
     C                     MOVEL*YEAR     SSFABD
     C                     MOVE *YEAR     AAFABD
     C                     Z-ADDMONTH     MMFABD
     C                     Z-ADDDAY       JJFABD
     C  N18N19             EXCPTPRLAF9
     C   18N19             EXCPTPRLAF4
     C   19                EXCPTPRLAFU
     *
     C           SUITE     TAG
D2  C           *IN18     IFEQ '0'
     C           KPRLA2    READEPRLANCXG                 80
X2  C                     ELSE
D3  C           *IN19     IFEQ '0'
     C           KPRLA2    READEPRLANCX4                 80
X3  C                     ELSE
     C           KPRLA2    READEPRLANCLU                 80
F3  C                     END
F2  C                     END
F1  C  N80                END
     C           FIN       TAG
D1  C           *INU8     IFEQ '0'
    C  N25N18   *IN18     CABEQ'0'       DEBUT          18
    C  N24N19   *IN19     CABEQ'0'       DEBUT          19
F1  C                     END
     C                     CLOSEETATFABT
     C           FINNUL    TAG
     C                     SETON                     LR
     *
     ***************************************************************
    C           SPCAR     BEGSR
     C                     Z-ADD75        I
D1  C           CAR,I     DOWEQ' '
     C                     SUB  1         I
     C           I         COMP 1                        82
F1  C  N82                END
    C                     ENDSR
     *
     ***************************************************************
     *
    C           RECAL     BEGSR
     C           KCARCD    CHAINCARCDEL1             81
D1  C           *IN81     IFEQ '0'
     C                     MOVE '*'       MAJFAB
     C                     MOVE 'M'       CODMAJ
     C                     TIME           HEURE   60
     C                     MOVELHEURE     HHMM
     C                     MOVE PUS       ETMAJ
     C                     MOVE *YEAR     ANMAJ
     C                     MOVEL*YEAR     SSMAJ
     C                     Z-ADDUMONTH    MMMAJ
     C                     Z-ADDUDAY      JJMAJ
     C                     MOVEL'ORD'     INIMAJ
     C                     WRITEMAJPROF1
F1  C                     END
    C                     ENDSR
     *
     ***************************************************************
     *
     OPRLANCF1E                PRLAF9
     O                         SSFABD                                     PROD13
     O                         AAFABD                                     PROD13
     O                         MMFABD                                     PROD13
     O                         JJFABD                                     PROD13
     OPRLANC4 E                PRLAF4
     O                         SSFABD                                     PROD13
     O                         AAFABD                                     PROD13
     O                         MMFABD                                     PROD13
     O                         JJFABD                                     PROD13
     OPRLANCU E                PRLAFU
     O                         SSFABD                                     PROD13
     O                         AAFABD                                     PROD13
     O                         MMFABD                                     PROD13
     O                         JJFABD                                     PROD13
     OETATFABTE    2  N91      BONSF                                      PROD20
     O                         V007  4   32                               PROD02
     O                         V001      76                               PROD02
     O                         V0041 2   86                               PROD02
     O                         V0042     90                               PROD02
     O        E    3  N91      BONSF                                      PROD20
     O                         V002  4   40                               PROD02
     O        E    5  N91      BONSF                                      PROD20
     O                         V024      76                               PROD02
     O                         V0501 4   88                               PROD02
     O        E    6  N91      BONSF                                      PROD20
     O                         V0391     31                               PROD02
     O                         V025      76                               PROD02
     O        E    7  N91      BONSF                                      PROD20
     O                         V0392     31                               PROD02
     O                         V027      76                               PROD02
     O        E    8  N91      BONSF                                      PROD20
     O                         V0393     31                               PROD02
     O                         V028      76                               PROD02
     O                         V0411 4   83                               PROD02
     O                                   85 'X'
     O                         V0414 4   90                               PROD02
     O        E    9  N91      BONSF                                      PROD20
     O                N79      V029      76                               PROD02
     O                 79      OREC      76                               PROD02
     O        E   10  N91      BONSF                                      PROD20
     O                         V084G     22                               PROD02
     O                         V084H     28                               PROD02
     O                         V085G     38                               PROD02
     O                         V085H     44                               PROD02
     O                         V086G     54                               PROD02
     O                         V086H     60                               PROD02
     O                         V087G     70                               PROD02
     O                         V087H     76                               PROD02
     O                         V088G     86                               PROD02
     O                         V088H     92                               PROD02
     O        E   11  N91      BONSF                                      PROD20
     O                         V0842     18                               PROD02
     O                         V0843 4   26                               PROD02
     O                         V0852     34                               PROD02
     O                         V0853 4   42                               PROD02
     O                         V0862     50                               PROD02
     O                         V0863 4   58                               PROD02
     O                         V0872     66                               PROD02
     O                         V0873 4   74                               PROD02
     O                         V0882     82                               PROD02
     O                         V0883 4   90                               PROD02
     O        E   12  N91      BONSF                                      PROD20
     O                         V08442    21                               PROD02
     O                         V0845 4   26                               PROD02
     O                         V08542    37                               PROD02
     O                         V0855 4   42                               PROD02
     O                         V08642    53                               PROD02
     O                         V0865 4   58                               PROD02
     O                         V08742    69                               PROD02
     O                         V0875 4   74                               PROD02
     O                         V08842    85                               PROD02
     O                         V0885 4   90                               PROD02
     O        E   14  N91      BONSF                                      PROD20
     O                N74      V084B     24                               PROD02
     O                N75      V085B     40                               PROD02
     O                N76      V086B     56                               PROD02
     O                N77      V087B     72                               PROD02
     O                N78      V088B     88                               PROD02
     O        E   15  N91      BONSF                                      PROD20
     O                N74      V084D 4   23                               PROD02
     O                 74                19 'FLEXO '                      PROD02
     O                 74                20 '/'                           PROD02
     O                 74      V084D24   26                               PROD02
     O                N75      V085D 4   39                               PROD02
     O                 75                35 'FLEXO '                      PROD02
     O                 75                36 '/'                           PROD02
     O                 75      V085D24   43                               PROD02
     O                N76      V086D 4   55                               PROD02
     O                 76                51 'FLEXO '                      PROD02
     O                 76                52 '/'                           PROD02
     O                 76      V086D24   59                               PROD02
     O                N77      V087D 4   71                               PROD02
     O                 77                67 'FLEXO'                       PROD02
     O                 77                68 '/'                           PROD02
     O                 77      V087D24   75                               PROD02
     O                N78      V088D 4   87                               PROD02
     O                 78                83 'FLEXO '                      PROD02
     O                 78                84 '/'                           PROD02
     O                 78      V088D24   91                               PROD02
     O        E   16  N91      BONSF                                      PROD20
     O                         V084E 2   21                               PROD02
     O                         V084F     25                               PROD02
     O                         V085E 2   37                               PROD02
     O                         V085F     41                               PROD02
     O                         V086E 2   53                               PROD02
     O                         V086F     57                               PROD02
     O                         V087E 2   69                               PROD02
     O                         V087F     73                               PROD02
     O                         V088E 2   85                               PROD02
     O                         V088F     89                               PROD02
     O        E   17  N91      BONSF                                      PROD20
     O                N30      V0847 4   19                               PROD02
     O                N30      V0848     20                               PROD02
     O                N30      V0849 4   24                               PROD02
     O                 30      LM84      17                               PROD02
     O                 30      V084A 4   22                               PROD02
     O                N31      V0857 4   35                               PROD02
     O                N31      V0858     36                               PROD02
     O                N31      V0859 4   40                               PROD02
     O                 31      LM85      33                               PROD02
     O                 31      V085A 4   38                               PROD02
     O                N32      V0867 4   51                               PROD02
     O                N32      V0868     52                               PROD02
     O                N32      V0869 4   56                               PROD02
     O                 32      LM86      49                               PROD02
     O                 32      V086A 4   54                               PROD02
     O                N33      V0877 4   67                               PROD02
     O                N33      V0878     68                               PROD02
     O                N33      V0879 4   72                               PROD02
     O                 33      LM87      65                               PROD02
     O                 33      V087A 4   70                               PROD02
     O                N34      V0887 4   83                               PROD02
     O                N34      V0888     84                               PROD02
     O                N34      V0889 4   88                               PROD02
     O                 34      LM88      81                               PROD02
     O                 34      V088A 4   86                               PROD02
     O        E   29           BONSF                                      PROD20
     O                         VCT01     84                               PROD02
     O                         VDT01     92                               PROD02
     O        E   30           BONSF                                      PROD20
     O                         V002  4    6                               PROD02
     O                         V007  4   14                               PROD02
     O                         V0041 2   24                               PROD02
     O                         V0042     28                               PROD02
     O                N29      V023  2   41                               PROD02
     O                 29                41 '*******'                     PROD02
     O                         VCT02     84                               PROD02
     O                         VDT02     92                               PROD02
     O        E   31           BONSF                                      PROD20
     O                         V0011     42                               PROD02
     O                         VCT03     84                               PROD02
     O                         VDT03     92                               PROD02
     O        E   32           BONSF                                      PROD20
     O                         V005      34                               PROD02
     O                         VCT04     84                               PROD02
     O                         VDT04     92                               PROD02
     O        E   33           BONSF                                      PROD20
     O                         V024      41                               PROD02
     O                         VCT05     84                               PROD02
     O                         VDT05     92                               PROD02
     O        E   34           BONSF                                      PROD20
     O                         V025      41                               PROD02
     O                         VCT06     84                               PROD02
     O                         VDT06     92                               PROD02
     O        E   35           BONSF                                      PROD20
     O                         V026      41                               PROD02
     O                         TIRPMS    92                               PROD02
     O        E   36           BONSF                                      PROD20
     O                         V027      41                               PROD02
     O        E   37           BONSF                                      PROD20
     O                         V028      41                               PROD02
     O                         V1201     83                               PROD02
     O                         V1202     92 '  /  / 0'                    PROD02
     O        E   38           BONSF                                      PROD20
     O                         V029      41                               PROD02
     O                         V1211     83                               PROD02
     O                         V1212     92 '  /  / 0'                    PROD02
     O        E   39           BONSF                                      PROD20
     O                         CQU       41                               PROD02
     O                         V1221     83                               PROD02
     O                         V1222     92 '  /  / 0'                    PROD02
     O        E   41           BONSF                                      PROD20
     O                         V010      85                               PROD02
     O        E   42           BONSF                                      PROD20
     O                         Z001      26                               PROD02
     O                         Z011  2   31                               PROD02
     O                         Z021  4   35                               PROD02
     O                         Z031  2   42                               PROD02
     O                         V011      85                               PROD02
     O        E   43           BONSF                                      PROD20
     O                         Z002      26                               PROD02
     O                         Z012  2   31                               PROD02
     O                         Z022  4   35                               PROD02
     O                         Z032  2   42                               PROD02
     O                         V012      47                               PROD02
     O                         V013      85                               PROD02
     O        E   44           BONSF                                      PROD20
     O                         Z003      26                               PROD02
     O                         Z013  2   31                               PROD02
     O                         Z023  4   35                               PROD02
     O                         Z033  2   42                               PROD02
     O        E   45           BONSF                                      PROD20
     O                         Z004      26                               PROD02
     O                         Z014  2   31                               PROD02
     O                         Z024  4   35                               PROD02
     O                         Z034  2   42                               PROD02
     O                         SUIVAN B  61                               PROD02
     O        E   46           BONSF                                      PROD20
    O*                        Z005      25                               PROD02
    O*                        Z015  2   31                               PROD02
    O*                        Z025  4   35                               PROD02
    O*                        Z035  2   42                               PROD02
    O*       E   47           BONSF                                      PROD20
    O*                        Z006      25                               PROD02
    O*                        Z016  2   31                               PROD02
    O*                        Z026  4   35                               PROD02
    O*                        Z036  2   42                               PROD02
     O        E   48           BONSF                                      PROD20
     O                         V002  4    6                               PROD02
     O                         V007  4   14                               PROD02
     O                         V0041 2   24                               PROD02
     O                         V0042     28                               PROD02
     O                         V0012     68                               PROD02
     O        E   49           BONSF                                      PROD20
     O                         V1001     76                               PROD02
     O                         V1002 2   82                               PROD02
     O                         V1003 4   85                               PROD02
     O                         V1004 2   92                               PROD02
     O        E   50           BONSF                                      PROD20
     O                         V1011     76                               PROD02
     O                         V1012 2   82                               PROD02
     O                         V1013 4   85                               PROD02
     O                         V1014 2   92                               PROD02
     O        E   51           BONSF                                      PROD20
     O                         V1021     76                               PROD02
     O                         V1022 2   82                               PROD02
     O                         V1023 4   85                               PROD02
     O                         V1024 2   92                               PROD02
     O        E   52           BONSF                                      PROD20
     O                         V1031     76                               PROD02
     O                         V1032 2   82                               PROD02
     O                         V1033 4   85                               PROD02
     O                         V1034 2   92                               PROD02
     O        E   53           BONSF                                      PROD20
     O                         V1041     76                               PROD02
     O                         V1042 2   82                               PROD02
     O                         V1043 4   85                               PROD02
     O                         V1044 2   92                               PROD02
     O        E   54           BONSF                                      PROD20
     O                         V1051     76                               PROD02
     O                         V1052 2   82                               PROD02
     O                         V1053 4   85                               PROD02
     O                         V1054 2   92                               PROD02
     O        E   55           BONSF                                      PROD20
     O                         V1061     76                               PROD02
     O                         V1062 2   82                               PROD02
     O                         V1063 4   85                               PROD02
     O                         V1064 2   92                               PROD02
     O        E   56           BONSF                                      PROD20
     O                         V1071     76                               PROD02
     O                         V1072 2   82                               PROD02
     O                         V1073 4   85                               PROD02
     O                         V1074 2   92                               PROD02
     O        E   57           BONSF                                      PROD20
     O                         V1081     76                               PROD02
     O                         V1082 2   82                               PROD02
     O                         V1083 4   85                               PROD02
     O                         V1084 2   92                               PROD02
     O        E   58           BONSF                                      PROD20
     O                         V1091     76                               PROD02
     O                         V1092 2   82                               PROD02
     O                         V1093 4   85                               PROD02
     O                         V1094 2   92                               PROD02
     O        E   59           BONSF                                      PROD20
     O                         V1101     76                               PROD02
     O                         V1102 2   82                               PROD02
     O                         V1103 4   85                               PROD02
     O                         V1104 2   92                               PROD02
     O        E   62           BONSF                                      PROD20
     O                         V1001     76                               PROD02
     O                         V1002 2   82                               PROD02
     O                         V1003 4   85                               PROD02
     O                         V1004 2   92                               PROD02
     O        E   63           BONSF                                      PROD20
     O                         V1011     76                               PROD02
     O                         V1012 2   82                               PROD02
     O                         V1013 4   85                               PROD02
     O                         V1014 2   92                               PROD02
     O        E   64           BONSF                                      PROD20
     O                         V1021     76                               PROD02
     O                         V1022 2   82                               PROD02
     O                         V1023 4   85                               PROD02
     O                         V1024 2   92                               PROD02
     O        E   65           BONSF                                      PROD20
     O                         V1031     76                               PROD02
     O                         V1032 2   82                               PROD02
     O                         V1033 4   85                               PROD02
     O                         V1034 2   92                               PROD02
     O        E   66           BONSF                                      PROD20
     O                         V1041     76                               PROD02
     O                         V1042 2   82                               PROD02
     O                         V1043 4   85                               PROD02
     O                         V1044 2   92                               PROD02
     O        E   67           BONSF                                      PROD20
     O                         V1051     76                               PROD02
     O                         V1052 2   82                               PROD02
     O                         V1053 4   85                               PROD02
     O                         V1054 2   92                               PROD02
     O        E   68           BONSF                                      PROD20
     O                         V1061     76                               PROD02
     O                         V1062 2   82                               PROD02
     O                         V1063 4   85                               PROD02
     O                         V1064 2   92                               PROD02
     O        E   69           BONSF                                      PROD20
     O                         V1071     76                               PROD02
     O                         V1072 2   82                               PROD02
     O                         V1073 4   85                               PROD02
     O                         V1074 2   92                               PROD02
     O        E   70           BONSF                                      PROD20
     O                         V1081     76                               PROD02
     O                         V1082 2   82                               PROD02
     O                         V1083 4   85                               PROD02
     O                         V1084 2   92                               PROD02
     O        E   71           BONSF                                      PROD20
     O                         V1091     76                               PROD02
     O                         V1092 2   82                               PROD02
     O                         V1093 4   85                               PROD02
     O                         V1094 2   92                               PROD02
     O        E   72           BONSF                                      PROD20
     O                         V1101     76                               PROD02
     O                         V1102 2   82                               PROD02
     O                         V1103 4   85                               PROD02
     O                         V1104 2   92                               PROD02
     *   //////
     *   //////  2EME PAGE
     O        E    3           BONSF                                      PROD20
     O                         V001   B  42                               PROD02
     O                         V002  4   51                               PROD02
     O                         V003      66 '  /  / 0'                    PROD02
     O                         V0041 2   80                               PROD02
     O                         V0042     84                               PROD02
     O        E    6           BONSF                                      PROD20
     O                         V005      22                               PROD02
     O                                   26 'DU'
     O                         V006      36 '  /  / 0'                    PROD02
     O                         V007  4   51                               PROD02
     O                         DEVIS     67 '  .    .   0'                PROD02
     O                         V008      77                               PROD02
     O                         V009  2   90                               PROD02
     O        E    8           BONSF                                      PROD20
     O                         V010      42                               PROD02
     O        E    9           BONSF                                      PROD20
     O                         V011      42                               PROD02
     O        E   10           BONSF                                      PROD20
     O                         V012       4                               PROD02
     O                         V013      38                               PROD02
     O                         V014      54 '  .  .0'                     PROD02
     O                         V015      65 '  .  .0'                     PROD02
     O                         V016      70                               PROD02
     O                         DAPRDE    81 '  .  .0'                     PROD02
     O        E   13           BONSF                                      PROD20
     O                         V017      14                               PROD02
     O        E   14           BONSF                                      PROD20
     O                         V018      14                               PROD02
     O                         V020  2   29                               PROD02
     O                         V021  2   45                               PROD02
     O                         V024      90                               PROD02
     O        E   15           BONSF                                      PROD20
     O                         V025      90                               PROD02
     O        E   16           BONSF                                      PROD20
     O                         V026      90                               PROD02
     O        E   17           BONSF                                      PROD20
     O                         V027      90                               PROD02
     O        E   18           BONSF                                      PROD20
     O                         V019      14                               PROD02
     O                         V023  2   29                               PROD02
     O                         V022  2   45                               PROD02
     O                         V028      90                               PROD02
     O        E   19           BONSF                                      PROD20
     O                         V029      90                               PROD02
     O        E   20           BONSF                                      PROD20
     O                         V030      90                               PROD02
     O        E   21           BONSF                                      PROD20
     O                         V031  4    6                               PROD02
     O                         V032      48                               PROD02
     O        E   22           BONSF                                      PROD20
     O                         V036      90                               PROD02
     O        E   23           BONSF                                      PROD20
     O                         V033      44                               PROD02
     O                         V037      90                               PROD02
     O        E   24           BONSF                                      PROD20
     O                         V034      44                               PROD02
     O                         V038      90                               PROD02
     O        E   25           BONSF                                      PROD20
     O                         V035      44                               PROD02
     O                 28      USFO      31
     O                 28                32 '-'
     O                 28      USFO1 3   36
     O                 28                37 '%'
     O                 28      PLUS      39
     O                 28      USFO2 3   43
     O                 28                44 '%'
     O        E   28           BONSF                                      PROD20
     O                         V084G     10                               PROD02
     O                         V0842     14                               PROD02
     O                         V0843 4   18                               PROD02
     O                         V0844     25                               PROD02
     O                         V0845 4   29                               PROD02
     O                         LM84      31                               PROD02
    O*                        V0846     31                               PROD02
     O                N30      V0847 4   35                               PROD02
     O                N30      V0848     36                               PROD02
     O                N30      V0849 4   40                               PROD02
     O                 30      V084A 4   38                               PROD02
     O                         V084E 4   47                               PROD02
     O                         V084F     50                               PROD02
     O                         V084B     61                               PROD02
     O                         V0841     66                               PROD02
     O                N74      V084D 4   75                               PROD02
     O                 74      V084D 4   69                               PROD02
     O                 74                70 '/'                           PROD02
     O                 74      V084D24   76                               PROD02
     O                         V084H     82                               PROD02
     O                         V084I     90                               PROD02
     O        E   29           BONSF                                      PROD20
     O                         V085G     10                               PROD02
     O                         V0852     14                               PROD02
     O                         V0853 4   18                               PROD02
     O                         V0854     25                               PROD02
     O                         V0855 4   29                               PROD02
     O                         LM85      31                               PROD02
    O*                        V0856     31                               PROD02
     O                N31      V0857 4   35                               PROD02
     O                N31      V0858     36                               PROD02
     O                N31      V0859 4   40                               PROD02
     O                 31      V085A 4   38                               PROD02
     O                         V085E 4   47                               PROD02
     O                         V085F     50                               PROD02
     O                         V085B     61                               PROD02
     O                         V0851     66                               PROD02
     O                N75      V085D 4   75                               PROD02
     O                 75      V085D 4   69                               PROD02
     O                 75                70 '/'                           PROD02
     O                 75      V085D24   76                               PROD02
     O                         V085H     82                               PROD02
     O                         V085I     90                               PROD02
     O        E   30           BONSF                                      PROD20
     O                         V086G     10                               PROD02
     O                         V0862     14                               PROD02
     O                         V0863 4   18                               PROD02
     O                         V0864     25                               PROD02
     O                         V0865 4   29                               PROD02
     O                         LM86      31                               PROD02
    O*                        V0866     31                               PROD02
     O                N32      V0867 4   35                               PROD02
     O                N32      V0868     36                               PROD02
     O                N32      V0869 4   40                               PROD02
     O                 32      V086A 4   38                               PROD02
     O                         V086E 4   47                               PROD02
     O                         V086F     50                               PROD02
     O                         V086B     61                               PROD02
     O                         V0861     66                               PROD02
     O                N76      V086D 4   75                               PROD02
     O                 76      V086D 4   69                               PROD02
     O                 76                70 '/'                           PROD02
     O                 76      V086D24   76                               PROD02
     O                         V086H     82                               PROD02
     O                         V086I     90                               PROD02
     O        E   31           BONSF                                      PROD20
     O                         V087G     10                               PROD02
     O                         V0872     14                               PROD02
     O                         V0873 4   18                               PROD02
     O                         V0874     25                               PROD02
     O                         V0875 4   29                               PROD02
     O                         LM87      31                               PROD02
    O*                        V0876     31                               PROD02
     O                N33      V0877 4   35                               PROD02
     O                N33      V0878     36                               PROD02
     O                N33      V0879 4   40                               PROD02
     O                 33      V087A 4   38                               PROD02
     O                         V087E 4   47                               PROD02
     O                         V087F     50                               PROD02
     O                         V087B     61                               PROD02
     O                         V0871     66                               PROD02
     O                N77      V087D 4   75                               PROD02
     O                 77      V087D 4   69                               PROD02
     O                 77                70 '/'                           PROD02
     O                 77      V087D24   76                               PROD02
     O                         V087H     82                               PROD02
     O                         V087I     90                               PROD02
     O        E   32           BONSF                                      PROD20
     O                         V088G     10                               PROD02
     O                         V0882     14                               PROD02
     O                         V0883 4   18                               PROD02
     O                         V0884     25                               PROD02
     O                         V0885 4   29                               PROD02
     O                         LM88      31                               PROD02
    O*                        V0886     31                               PROD02
     O                N34      V0887 4   35                               PROD02
     O                N34      V0888     36                               PROD02
     O                N34      V0889 4   40                               PROD02
     O                 34      V088A 4   38                               PROD02
     O                         V088E 4   47                               PROD02
     O                         V088F     50                               PROD02
     O                         V088B     61                               PROD02
     O                         V0881     66                               PROD02
     O                N78      V088D 4   75                               PROD02
     O                 78      V087D 4   69                               PROD02
     O                 78                70 '/'                           PROD02
     O                 78      V087D24   76                               PROD02
     O                         V088H     82                               PROD02
     O                         V088I     90                               PROD02
     *  ---> ONDULATION
     O        E   33  N91      BONSF                                      PROD20
     O                                   79 'XXXXXXXXXXXX'                PROD02
     O                                   92 'XXXXXXXXXXXX'                PROD02
     O        E   34  N91      BONSF                                      PROD20
     O                         V0491     36                               PROD02
     O                                   79 ' QUANTITE A '                PROD02
     O                                   92 ' REALISER   '                PROD02
     O        E   35  N91      BONSF                                      PROD20
     O                         V0492     36                               PROD02
     O                         V0411 4   42                               PROD02
     O                         V0412     45                               PROD02
     O                         V0413     46                               PROD02
     O                         V0414 4   51                               PROD02
     O                         V0415     54                               PROD02
     O                         V0416 4   59                               PROD02
     O                         V0461 2   75                               PROD02
     O                         V0462     78                               PROD02
     O                         V0471 2   87                               PROD02
     O                         V0472     91                               PROD02
     O        E   36  N91      BONSF                                      PROD20
     O                         V0391      5                               PROD02
     O                         V0392     10                               PROD02
     O                         V0393     15                               PROD02
     O                         V0493     36                               PROD02
     O                         V045      65                               PROD02
     O                         LIBSTO B  91                               PROD02
     O        E   37  N91      BONSF                                      PROD20
     O                         V0494     36                               PROD02
     O                N13      V0431 4   42                               PROD02
     O                N13      V0432     45                               PROD02
     O                N13      V0433     46                               PROD02
     O                N13      V0434 4   51                               PROD02
     O                N13      V0435     54                               PROD02
     O                N13      V0436 4   59                               PROD02
     O                 13      W0431     41                               PROD02
     O                 13      W0432 4   46                               PROD02
     O                 13      W0433     48                               PROD02
     O                 13      W0434 4   51                               PROD02
     O                 13      W0435     53                               PROD02
     O                 13      W0436 2   59                               PROD02
     O                         W0461 2   75                               PROD02
     O                         W0462     78                               PROD02
    O*                        W0471 2   87                               PROD02
    O*                        W0472     91                               PROD02
     O        E   38  N91      BONSF                                      PROD20
     O                         V0501 4B  13                               PROD02
     O                                   14 '/'
     O                         V0502 4B  19                               PROD02
     O                         V0495     36                               PROD02
     O                         V0481 4   71                               PROD02
     O                         V0482     78                               PROD02
     O        E   40  N91      BONSF                                      PROD20
     O                         V042      41                               PROD02
     O                         V0541     83                               PROD02
     O                         V0542     92 '  /  / 0'                    PROD02
     O        E   41  N91      BONSF                                      PROD20
     O                         STAB   B  41                               PROD02
     O                         V0551     83                               PROD02
     O                         V0552     92 '  /  / 0'                    PROD02
     O        E   42  N91      BONSF                                      PROD20
     O                         V0511 4   25                               PROD02
     O                         V0512 4   35                               PROD02
     O                         V0561     83                               PROD02
     O                         V0562     92 '  /  / 0'                    PROD02
     O        E   43  N91      BONSF                                      PROD20
     O                         V0513     41                               PROD02
     O                         V0571     83                               PROD02
     O                         V0572     92 '  /  / 0'                    PROD02
     O        E   44  N91      BONSF                                      PROD20
     O                         V0581     83                               PROD02
     O                         V0582     92 '  /  / 0'                    PROD02
     O        E   45  N91      BONSF                                      PROD20
     O                         V044      41                               PROD02
     O                         V0591     83                               PROD02
     O                         V0592     92 '  /  / 0'                    PROD02
     O        E   46  N91      BONSF                                      PROD20
     O                         V053      41                               PROD02
     O                         V0601     83                               PROD02
     O                         V0602     92 '  /  / 0'                    PROD02
     O        E   48  N92      BONSF                                      PROD20
     O                         VMAS   B  28                               PROD02
     O                         V0711  B  83                               PROD02
     O                         V0712  B  92 '  /  / 0'                    PROD02
     O        E   49  N92      BONSF                                      PROD20
     O                         V0661 4B  25                               PROD02
     O                         V0663  B  27                               PROD02
     O                         V0662  B  33                               PROD02
     O                         V069   B  39                               PROD02
     O                         V0721  B  83                               PROD02
     O                         V0722  B  92 '  /  / 0'                    PROD02
     O        E   50  N92      BONSF                                      PROD20
     O                         V082  2B   8                               PROD02
     O                         V0731  B  83                               PROD02
     O                         V0732  B  92 '  /  / 0'                    PROD02
     O        E   51  N92      BONSF                                      PROD20
     O                         CASI   B   9                               PROD02
     O                         V065  4B  16                               PROD02
     O                         V0671 4B  25                               PROD02
     O                         V0673  B  27                               PROD02
     O                         V0672  B  33                               PROD02
     O                         V0741  B  83                               PROD02
     O                         V0742  B  92 '  /  / 0'                    PROD02
     O        E   52  N92      BONSF                                      PROD20
     O                         PERTI  B   9                               PROD02
     O                         V0751  B  83                               PROD02
     O                         V0752  B  92 '  /  / 0'                    PROD02
     O        E   53  N92      BONSF                                      PROD20
     O                         V0681 4B  25                               PROD02
     O                         V0683  B  27                               PROD02
     O                         V0682  B  33                               PROD02
     O                         IMPO1 4B  37                               PROD02
     O                         IMPO2 4B  41                               PROD02
     O                         V0761  B  83                               PROD02
     O                         V0762  B  92 '  /  / 0'                    PROD02
     O        E   54  N92      BONSF                                      PROD20
     O                         V070   B  41                               PROD02
     O                         V0771  B  83                               PROD02
     O                         V0772  B  92 '  /  / 0'                    PROD02
     O        E   55  N93      BONSF                                      PROD20
     O                         LIBSEC B  15                               PROD02
     O        E   56  N93      BONSF                                      PROD20
     O                         V0783  B  33                               PROD02
     O                         V0911  B  83                               PROD02
     O                         V0912  B  92 '  /  / 0'                    PROD02
     O        E   57  N93      BONSF                                      PROD20
     O                         V0781 4B   3                               PROD02
     O                         V0782  B  44                               PROD02
     O                         V0921  B  83                               PROD02
     O                         V0922  B  92 '  /  / 0'                    PROD02
     O        E   58  N93      BONSF                                      PROD20
     O                         V0931  B  83                               PROD02
     O                         V0932  B  92 '  /  / 0'                    PROD02
     O        E   59  N93      BONSF                                      PROD20
     O                         V0801  B  32                               PROD02
     O                         V0802 4B  39                               PROD02
     O                         V0941  B  83                               PROD02
     O                         V0942  B  92 '  /  / 0'                    PROD02
     O        E   60  N93      BONSF                                      PROD20
     O                         V0791 4B   4                               PROD02
     O                         V0792 4B   8                               PROD02
     O                         V0793 4B  12                               PROD02
    O*                        V0811  B  32                               PROD02
     O                         V0812 4B  39                               PROD02
     O                         V0951  B  83                               PROD02
     O                         V0952  B  92 '  /  / 0'                    PROD02
     O        E   61  N93      BONSF                                      PROD20
     O                         V0831  B  41                               PROD02
     O                         V0832 4B  27                               PROD02
     O                         V0833 4B  30                               PROD02
     O                         V0961  B  83                               PROD02
     O                         V0962  B  92 '  /  / 0'                    PROD02
     O        E   62  N93      BONSF                                      PROD20
     O                         V0971  B  83                               PROD02
     O                         V0972  B  92 '  /  / 0'                    PROD02
     O        E   63           BONSF                                      PROD20
     O                                    5 'O :'
     O                         WETPSO4B  10                               PROD02
     O                                   12 '/'
     O                         WOTPSO4B  17                               PROD02
     O                                   20 '-'
     O                                   25 'D :'
     O                         WETPSD4B  30                               PROD02
     O                                   32 '/'
     O                         WOTPSD4B  37                               PROD02
     O                                   40 '-'
     O                                   45 'D :'
     O                         WETPST4B  50                               PROD02
     O                                   52 '/'
     O                         WOTPST4B  57                               PROD02
     O                                   60 '-'
     O                                   65 'A :'
     O                         WETPSA4B  70                               PROD02
     O                                   72 '/'
     O                         WOTPSA4B  77                               PROD02
     O        E   64           BONSF                                      PROD20
     O                                   15 'FAF :'
     O                         FMINL 4   20                               PROD02
     O                                   22 'X'
     O                         FMINH 4   27                               PROD02
     O                         PATFON B+ 10                               PROD02
     O        E   66           BONSF                                      PROD20
     O                         NOE,1 4B  27
     O                         POS,1 4B  38
     O                         REF,1  B  86
     O        E   67           BONSF                                      PROD20
     O                         NOE,2 4B  27
     O                         POS,2 4B  38
     O                         REF,2  B  86
     O        E   68           BONSF                                      PROD20
     O                         NOE,3 4B  27
     O                         POS,3 4B  38
     O                         REF,3  B  86
     O        E   69           BONSF                                      PROD20
     O                         NOE,4 4B  27
     O                         POS,4 4B  38
     O                         REF,4  B  86
     O        E   70           BONSF                                      PROD20
     O                         NOE,5 4B  27
     O                         POS,5 4B  38
     O                         REF,5  B  86
     O        E   71           BONSF                                      PROD20
     O                         NOE,6 4B  27
     O                         POS,6 4B  38
     O                         REF,6  B  86
     O        E   72           BONSF                                      PROD20
     O                         NOE,7 4B  27
     O                         POS,7 4B  38
     O                         REF,7  B  86
**  TABLE DES LIBELLES IMPRESSION
0 STOCKE
1HELIO
2FLEXO
4OFFSET
5XXXXXX
3POST-P
6    -
**  TABLE DES CONSTANTES
PRE-IMPRIME STOCKE
EXTERIEUR
INTERIEUR
GROUPAGE
GARNITURE
COMMANDE D'ESSAIS
COMMANDE D'HOMOLOGATION
IMPRESSION EXT. INT.
SOUS-TRAITANCE
PRODUIT DE LUXE
DECOUPE     X         POSES DANS ROULEAU
FEUILLE     X         POSES DANS FEUILLE
SANS EMBALLAGE
AMALGAME
DECOUPE     X         POSES DANS FEUILLE
CLICHE .....  . FENETRE(S)
..** LAIZE MODIFIEE
PREMIERE COMMANDE
AVEC FICHE DE CONTROLE
TOLERANCE QUANTITE
MANDRINS LONGUEUR      NOMBRE
. ATTENTION :  SCARSET
.. Pattes de fond   ..
Prélever 2 découpes pour le BM
CONTACT ALIMENTAIRE
Stabilis. IMPERATIVE: Mini:    Maxi:
PRET POUR REACTEUR
FE ONDULÉS
Décalage filet à filet :
POSE DE BANDE TEAR TAPE SUR ONDULEUSE
**  TABLE DES ETAT MATERIEL
CCREATION
MMODIFICATION
RREFECTION
EEXISTANT
 EXISTANT
NENTRETIEN
TTRANSFERT
