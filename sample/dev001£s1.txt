     **********************************************************
     *                                                        *
     *    SAISIE DES DEVIS  -  NOUVELLE VERSION               *
     *    -----------------------------------------           *
     **********************************************************
     *    INDICATEURS:                                        *
     *    ------------                                        *
     *     01 A 24 --> TOUCHES DE FONCTION                    *         CO
     * *   01 --> SAISIE COMMERCIAL                           *
     * *   02 --> DEVIS DE PRE-IMPRIME STOCKE                 *
     * *   05 --> COMPACT OU COMPEXE EN ENDUIT                *
     * *   06 --> SAISIE PRE-IMPRIME                          *
     * *   08 --> SI DOUBLE DOUBLE                            *
     * *   09 --> SI ENDUCTION OU COMPLEXAGE                  *
     * *   23 --> ATTENTION: ANNULATION, COAS2=31/33, ERREUR  *
     *     25 --> APPEL PROGRAMMES DEV002£                    *
     *     26 --> PROTECTION N° ETUDE                         *
     *     27 --> DEMANDE STOCKAGE SI SIMUL                   *
     *     28 --> PROTECTION N° ETUDE ET TYPE DEVIS           *
     *     29 --> EXISTANCE IMPRESSION                        *
     *     30 --> IMPRESSION EXTERIEURE                       *
     *     31 --> IMPRESSION INTERIEURE                       *
     *     32 --> EXISTANCE FACONNAGE                         *
     *     33 --> FENETRE                                     *
     *     34 --> 1° ASSEMBLAGE                               *
     *     35 --> 2° ASSEMBLAGE                               *
     *     36 --> PRE-IMPRIME STOCKE EXTERIEUR                *
     *     37 --> PRE-IMPRIME STOCKE INTERIEUR                *
     *     38 --> VARIANTE OU MODIFICATION DEVIS              *
     *     39 --> CONTRECOLLAGE OU COMPACT                    *         ''
     *     40 --> FACONNAGE 0                                 *
     *     41 --> FACONNAGE 1                                 *
     *     42 --> FACONNAGE 2                                 *
     *     43 --> DFMC OU DFPC POUR JUPE                      *
     *     44 --> FACONNAGE 4                                 *
     *     45 --> FACONNAGE 5                                 *
     *     46 --> FACONNAGE 6                                 *
     *     47 --> FACONNAGE 7                                 *
     *     48 --> FACONNAGE 8                                 *
     *     49 --> FACONNAGE 9                                 *
     *     50 --> RESULTAT CHAINAGE - SETLL                   *
     *     51 A 98 --> ERREURS                                *
     *     99 --> DEVIS ET SIMUL                              *
     **********************************************************
     *  05/02/2014 : AJOUT TABLE DPLI                         *
     **********************************************************
     *  TMAFBU 23/10/2014 INC0190906 ONDH = FMINH+22 POUR     *
     *  ONDULE ACHETE                                         *
     **********************************************************
     *  NZS    22/04/2015 AJOUT F4 POUR ACCÉS LAIZE           *
     *                    AJOUT F4 POUR ACCÉS PRÉ-IMPRIMÉ     *
     **********************************************************
     *  NZS 15/07/15 MESSAGE POUR MINI MAXI DE LA COMPLEXEUSE *
     **********************************************************
     * Modifier Le : 02/11/2015 Par Philippe                  *
     * But : Ajout de l'appel du programmes de saisie des     *
     *       informations relatives à la pose d'un accessoire *
     *       si "POSE" = "*"                                  *
     **********************************************************
     H             /J
     FDEV001D CF  E                    WORKSTN
     F                                              KINFDS àINFDS
    FDEVIS   UF  E                    DISK                      A    UC
    FDEVIS2  UF  E           K        DISK                           UC
    FDEVAMLL1UF  E           K        DISK                      A    UC
    FETIQUET UF  E           K        DISK                      A
     FXTBASE01IF  E           K        DISK
     FPARAME  IF  E           K        DISK
     FOFFRES  IF  E           K        DISK
     FDEVISL4 IF  E           K        DISK
     FCLIACHL1IF  E           K        DISK
     FCLISTAL1IF  E           K        DISK
     FCLIOBIL4IF  E           K        DISK
     FCLILIVL1IF  E           K        DISK
     FMATPREL1IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
     FPRODUL18IF  E           K        DISK
     FMNUDIRL1IF  E           K        DISK
     FCXHENTL1IF  E           K        DISK
     FCXHLIGL1IF  E           K        DISK
     FTRANSP  IF  E           K        DISK
     FTTREXP  IF  E           K        DISK
     FPOIGNEL1IF  E           K        DISK
     FFTYPOPL1IF  E           K        DISK
     E                    TABFOC  1  48  2   TABNP   1 0
     *--- Début --- Philippe --- 12/11/2015 --- Pose Accssoires  *
     E**                  TABCS   1  28  2 0 TABLS  14
     E                    TABCS   1  30  2 0 TABLS  14
     *--- FIN   --- Philippe --- 12/11/2015 --- Pose Accssoires  *
     E                    TN         14  2 0
     E                    SPRD       14  3 2
     E                    SPRG       14  3 2
     E                    SPRO       14  3 2
     E                    SPEF       14  1 0
     E                    SPDE       14  3 1
     E                    SROC       14  5 0
     E                    SRET       14  4 2
     E                    LSS        14 20
     E                    TSS        14  2 0
     E                    PRD        14  3 2
     E                    PRG        14  3 2
     E                    PRO        14  3 2
     E                    PEF        14  1 0
     E                    PDE        14  3 1
     E                    ROC        14  5 0
     E                    RET        14  4 2
     E                    TPS         5  1
     E                    DAML        9 40
     E                    SAML        9  2 0
     E                    PAML        9  2 0
     E                    NAML        9  2 0
     E                    OVR     1  38 60
     E                    TABCTR  1  31  2   TABLTR 25
     IFMT6
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRDI1                           PRD,1
     I              PRDI2                           PRD,2
     I              PRDI3                           PRD,3
     I              PRDI4                           PRD,4
     I              PRDI5                           PRD,5
     I              PRDI6                           PRD,6
     I              PRDI7                           PRD,7
     I              PRDI8                           PRD,8
     I              PRDI9                           PRD,9
     I              PRDI10                          PRD,10
     I              PRDI11                          PRD,11
     I              PRDI12                          PRD,12
     I              PRDI13                          PRD,13
     I              PRDI14                          PRD,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     I              PROU1                           PRO,1
     I              PROU2                           PRO,2
     I              PROU3                           PRO,3
     I              PROU4                           PRO,4
     I              PROU5                           PRO,5
     I              PROU6                           PRO,6
     I              PROU7                           PRO,7
     I              PROU8                           PRO,8
     I              PROU9                           PRO,9
     I              PROU10                          PRO,10
     I              PROU11                          PRO,11
     I              PROU12                          PRO,12
     I              PROU13                          PRO,13
     I              PROU14                          PRO,14
     I              PEFF1                           PEF,1
     I              PEFF2                           PEF,2
     I              PEFF3                           PEF,3
     I              PEFF4                           PEF,4
     I              PEFF5                           PEF,5
     I              PEFF6                           PEF,6
     I              PEFF7                           PEF,7
     I              PEFF8                           PEF,8
     I              PEFF9                           PEF,9
     I              PEFF10                          PEF,10
     I              PEFF11                          PEF,11
     I              PEFF12                          PEF,12
     I              PEFF13                          PEF,13
     I              PEFF14                          PEF,14
     I              PDEC1                           PDE,1
     I              PDEC2                           PDE,2
     I              PDEC3                           PDE,3
     I              PDEC4                           PDE,4
     I              PDEC5                           PDE,5
     I              PDEC6                           PDE,6
     I              PDEC7                           PDE,7
     I              PDEC8                           PDE,8
     I              PDEC9                           PDE,9
     I              PDEC10                          PDE,10
     I              PDEC11                          PDE,11
     I              PDEC12                          PDE,12
     I              PDEC13                          PDE,13
     I              PDEC14                          PDE,14
     I              ROCA1                           ROC,1
     I              ROCA2                           ROC,2
     I              ROCA3                           ROC,3
     I              ROCA4                           ROC,4
     I              ROCA5                           ROC,5
     I              ROCA6                           ROC,6
     I              ROCA7                           ROC,7
     I              ROCA8                           ROC,8
     I              ROCA9                           ROC,9
     I              ROCA10                          ROC,10
     I              ROCA11                          ROC,11
     I              ROCA12                          ROC,12
     I              ROCA13                          ROC,13
     I              ROCA14                          ROC,14
     I              RETP1                           RET,1
     I              RETP2                           RET,2
     I              RETP3                           RET,3
     I              RETP4                           RET,4
     I              RETP5                           RET,5
     I              RETP6                           RET,6
     I              RETP7                           RET,7
     I              RETP8                           RET,8
     I              RETP9                           RET,9
     I              RETP10                          RET,10
     I              RETP11                          RET,11
     I              RETP12                          RET,12
     I              RETP13                          RET,13
     I              RETP14                          RET,14
     IFMT15
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     IWAML
     I              DEAML1                          DAML,1
     I              DEAML2                          DAML,2
     I              DEAML3                          DAML,3
     I              DEAML4                          DAML,4
     I              DEAML5                          DAML,5
     I              DEAML6                          DAML,6
     I              DEAML7                          DAML,7
     I              DEAML8                          DAML,8
     I              DEAML9                          DAML,9
     I              SSAML1                          SAML,1
     I              SSAML2                          SAML,2
     I              SSAML3                          SAML,3
     I              SSAML4                          SAML,4
     I              SSAML5                          SAML,5
     I              SSAML6                          SAML,6
     I              SSAML7                          SAML,7
     I              SSAML8                          SAML,8
     I              SSAML9                          SAML,9
     I              PPAML1                          PAML,1
     I              PPAML2                          PAML,2
     I              PPAML3                          PAML,3
     I              PPAML4                          PAML,4
     I              PPAML5                          PAML,5
     I              PPAML6                          PAML,6
     I              PPAML7                          PAML,7
     I              PPAML8                          PAML,8
     I              PPAML9                          PAML,9
     I              POSCO1                          NAML,1
     I              POSCO2                          NAML,2
     I              POSCO3                          NAML,3
     I              POSCO4                          NAML,4
     I              POSCO5                          NAML,5
     I              POSCO6                          NAML,6
     I              POSCO7                          NAML,7
     I              POSCO8                          NAML,8
     I              POSCO9                          NAML,9
     IDEVISF1
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRDI1                           PRD,1
     I              PRDI2                           PRD,2
     I              PRDI3                           PRD,3
     I              PRDI4                           PRD,4
     I              PRDI5                           PRD,5
     I              PRDI6                           PRD,6
     I              PRDI7                           PRD,7
     I              PRDI8                           PRD,8
     I              PRDI9                           PRD,9
     I              PRDI10                          PRD,10
     I              PRDI11                          PRD,11
     I              PRDI12                          PRD,12
     I              PRDI13                          PRD,13
     I              PRDI14                          PRD,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     I              PROU1                           PRO,1
     I              PROU2                           PRO,2
     I              PROU3                           PRO,3
     I              PROU4                           PRO,4
     I              PROU5                           PRO,5
     I              PROU6                           PRO,6
     I              PROU7                           PRO,7
     I              PROU8                           PRO,8
     I              PROU9                           PRO,9
     I              PROU10                          PRO,10
     I              PROU11                          PRO,11
     I              PROU12                          PRO,12
     I              PROU13                          PRO,13
     I              PROU14                          PRO,14
     I              PEFF1                           PEF,1
     I              PEFF2                           PEF,2
     I              PEFF3                           PEF,3
     I              PEFF4                           PEF,4
     I              PEFF5                           PEF,5
     I              PEFF6                           PEF,6
     I              PEFF7                           PEF,7
     I              PEFF8                           PEF,8
     I              PEFF9                           PEF,9
     I              PEFF10                          PEF,10
     I              PEFF11                          PEF,11
     I              PEFF12                          PEF,12
     I              PEFF13                          PEF,13
     I              PEFF14                          PEF,14
     I              PDEC1                           PDE,1
     I              PDEC2                           PDE,2
     I              PDEC3                           PDE,3
     I              PDEC4                           PDE,4
     I              PDEC5                           PDE,5
     I              PDEC6                           PDE,6
     I              PDEC7                           PDE,7
     I              PDEC8                           PDE,8
     I              PDEC9                           PDE,9
     I              PDEC10                          PDE,10
     I              PDEC11                          PDE,11
     I              PDEC12                          PDE,12
     I              PDEC13                          PDE,13
     I              PDEC14                          PDE,14
     I              ROCA1                           ROC,1
     I              ROCA2                           ROC,2
     I              ROCA3                           ROC,3
     I              ROCA4                           ROC,4
     I              ROCA5                           ROC,5
     I              ROCA6                           ROC,6
     I              ROCA7                           ROC,7
     I              ROCA8                           ROC,8
     I              ROCA9                           ROC,9
     I              ROCA10                          ROC,10
     I              ROCA11                          ROC,11
     I              ROCA12                          ROC,12
     I              ROCA13                          ROC,13
     I              ROCA14                          ROC,14
     I              RETP1                           RET,1
     I              RETP2                           RET,2
     I              RETP3                           RET,3
     I              RETP4                           RET,4
     I              RETP5                           RET,5
     I              RETP6                           RET,6
     I              RETP7                           RET,7
     I              RETP8                           RET,8
     I              RETP9                           RET,9
     I              RETP10                          RET,10
     I              RETP11                          RET,11
     I              RETP12                          RET,12
     I              RETP13                          RET,13
     I              RETP14                          RET,14
     I              ICEE3                           PTDIF
     I              IAEE3                           PTENC
     IDEVIS2F1
     I              QTTOT1                          WTTOT1
     I              NBIMP1                          WBIMP1
     I              NBIRE1                          WBIRE1
     I              NBFAC1                          WBFAC1
     I              QTTOT2                          WTTOT2
     I              NBIMP2                          WBIMP2
     I              NBIRE2                          WBIRE2
     I              NBFAC2                          WBFAC2
     I              QTTOT3                          WTTOT3
     I              NBIMP3                          WBIMP3
     I              NBIRE3                          WBIRE3
     I              NBFAC3                          WBFAC3
     I              QTTOT4                          WTTOT4
     I              NBIMP4                          WBIMP4
     I              NBIRE4                          WBIRE4
     I              NBFAC4                          WBFAC4
     IPRODUIF1
     I              AGENT                           WW1
     IPREIMPF1
     I              ETUDE                           WW2
     I              SEQDE                           WW3
     I              TSS                             TSSX
     ICLISTAF1
     I              AGENT                           AGSTA
     ICLIOBIF1
     I              SEQACH                          SACLIO
     ICXHENTF1
     I              GRAMM                           GRAM
     ICXHLIGF1
     I              GRAMM                           GRAM
     I/COPY QRPGSRC,XVERDS
     I/COPY QRPGSRC,XTRADS
     I/COPY QRPGSRC,XENCDS
     I/COPY QRPGSRC,XORCDS
     I/COPY QRPGSRC,XFLUDS
     I/COPY QRPGSRC,XCOLDS
     I/COPY QRPGSRC,XDECDS
     I/COPY QRPGSRC,XTIMDS
     I/COPY QRPGSRC,XPTEDS
     * DS Pour récupération des infos écran
     IàINFDS      DS
     I                                    B 370 3710£CURSO
     *DS externe pour récupération du nom de l'utilisateur
     I           SDS
     I                                      254 263 £USER
     I                                      244 253 POSTE
     *  POUR APPEL DEV002£
     IAPPEL       DS
     I                                        1   90RANG
     I                                       10  10 TRAV1
     I                                       11  11 TRAV2
     I                                       10  11 TRAV12
     I                                       12  13 NO1
     I                                       14  17 NO2
     I                                       18  21 NO3
     *  POUR APPEL POIG01£
     IAPOIG       DS
     I                                        1   1 PII
     I                                        2   3 TYPCHA
     *  POUR APPEL TYPO01£
     IATYPP       DS
     I                                        1   1 PIP
     I                                        2   2 TYPPR
     IDSPARM      DS
     I                                        1   8 TBLNOM
     I                                        9  18 TBVAR
     I                                       19  200LG
     I                                       21  30 CODE
     I                                       31  80 LIBEL
     I                                       81  81 FICH
     IINTCXH      DS
     I                                        1   1 PARM0
     I                                        2   4 PAPCX
     I                                        5   70GRACX
     I                                        8  13 ADPCX
     I                                       14  160ADGCX
     *  POUR APPEL CLIE10£
     I            DS
     I                                        1   8 DSSC
     I I            0                         1   10STE
     I I            0                         2   50NOCLI
     I I            0                         6   70SEQACH
     I                                        8   8 INTOBS
     *
     I            DS
     I                                        1   2 GARNT
     I                                        1   1 GARNT1
     I                                        2   2 GARNT2
     *
     I            DS
     I                                        1   6 CLII1
     I                                        1   1 FIOND
     I                                        2   3 GFRA2
     I                                        4   5 TYPPCH
     I I            '0'                       6   6 NBPCHA
     *
     I            DS
     I                                        1  40 NOMCLI
     I                                        1  30 NOMCL
     *
     I            DS
     I                                        1  25 LIBFEN
     I                                        1  15 LIBFE
     *
     I            DS
     I                                        1   3 TDECO
     I                                        1   1 TDEC1
     I                                        2   2 TDEC2
     I                                        3   3 TDEC3
     *
     I            DS
     I I            0                         1   10FACON
     I I            0                         2   20CCL
     I                                        1   2 FCCO
     I            DS
     I I            0                         1   10ONDUL
     I I            0                         2   20CCOL
     I I            0                         3   40CNDD
     I                                        1   20CCOND
     I                                        1   40SIDD
     *
     I            DS
     I                                        1 280 LSS
     I                                        1  20 LSS1
     I                                       21  40 LSS2
     I                                       41  60 LSS3
     I                                       61  80 LSS4
     I                                       81 100 LSS5
     I                                      101 120 LSS6
     I                                      121 140 LSS7
     I                                      141 160 LSS8
     I                                      161 180 LSS9
     I                                      181 200 LSS10
     I                                      201 220 LSS11
     I                                      221 240 LSS12
     I                                      241 260 LSS13
     I                                      261 280 LSS14
     *
     I            DS
     I                                        1  28 TN
     I                                        1   20TSS1
     I                                        3   40TSS2
     I                                        5   60TSS3
     I                                        7   80TSS4
     I                                        9  100TSS5
     I                                       11  120TSS6
     I                                       13  140TSS7
     I                                       15  160TSS8
     I                                       17  180TSS9
     I                                       19  200TSS10
     I                                       21  220TSS11
     I                                       23  240TSS12
     I                                       25  260TSS13
     I                                       27  280TSS14
     *
     IPXVALE      DS
     I                                        7   7 SEPT
     I                                        8   8 HUIT
     *
     IHABIL1      DS
     I                                        1   1 HAB11
     I                                        2   2 HAB12
     *
     IHABIL2      DS
     I                                        1   1 HAB21
     I                                        2   2 HAB22
     *
     IHABIL3      DS
     I                                        1   1 HAB31
     I                                        2   2 HAB32
     *
     ITYPPOI      DS
     I                                        1   1 TYPPO1
     I                                        2   2 TYPPO2
     *
     ITYPFEN      DS
     I                                        1   1 TYPFE1
     I                                        2   2 TYPFE2
     *
     I            DS
     I I            0                         1   52POSF1
     I                                        1   30POSF1A
     I                                        4   40POSF1B
     *
     I            DS
     I I            0                         1   52POSF2
     I                                        1   30POSF2A
     *
     I            DS
     I                                        1   6 REFOUR
     I                                        4   6 CXH
     I            DS
     I                                        1   4 LGBAX
     I                                        5   5 PSBAX
     I                                        6   6 CODPEL
     I                                        7   7 AFFI
     I                                        1  10 CALLIB
     I            DS
     I                                        1   20ANDEV
     I                                        3   60ETUDE
     I                                        7  100SEQDE
     I I            0                         1  100NOETU
    I*
     I            DS
     I                                        1  10 RES10
     I                                        1  40 DIRRES
    I*
     I            DS
     I                                        1  16 QUAPP1
     I                                        1   3 PAFIL1
     I                                        4   60GRFIL1
     I                                        7  12 REFIL1
     I                                       13  150GFFIL1
     I                                       16  16 INVPP1
     I            DS
     I                                        1  16 QUAPP2
     I                                        1   3 PAFIL2
     I                                        4   60GRFIL2
     I                                        7  12 REFIL2
     I                                       13  150GFFIL2
     I                                       16  16 INVPP2
     I            DS
     I I            0                         1   21ENCI3
     I                                        1   10DECPP1
     I                                        2   20DECPP2
     I            DS
     I I            0                         1   10COUI1
     I I            0                         2   31ENCI1
     I                                        1   30PTNBR
    I*
     IDEV013      DS
     I I            'DM'                      1   2 DMX
     I I            0                         3  120SVNOEX
     I                                       13  13 PELLIX
     I                                       14  14 AFFIX
     I                                       15  15 AFFIC
     I                                       16  16 AUTCO
     I                                        1  12 DEV035
     IDE0131      DS
     I I            'DM'                      1   2 DMX1
     I                                        3  300£ZERO
     I                                       31  490£ZERO1
     I                                        3  120SVNOE1
     I                                       13  200XTTOT1
     I                                       21  280XTTOT2
     I                                       29  360XTTOT3
     I                                       37  440XTTOT4
     I                                       45  492POSF1X
      *
     IPIPARM      DS                             10
     I                                        1   1 PARPI
     I I            0                         2   20STEPI
     I I            0                         3   60ETUPI
     I I            0                         7  100SEQPI
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accssoires  *
     * - Définition de DS pour appel du programme de gestion de la saisie
     * des instructions Accessoires  (ACC002£)
     IACC002      DS
     I                                        1  41 DEBACC
     I                                        1   3 TYPAFF
     I I                                      4  13 WCOD01
     I I                                     14  14 WMOD01
     I I            0                        15  160WNB01
     I I                                     17  26 WCOD02
     I I            0                        27  280WNB02
     I I                                     29  38 WCOD03
     I I                                     39  39 WMOD03
     I I            0                        40  410WNB03
     I                                       42  43 WCDRET
     I                                       44  53 WFROM
     *
     * - Déclaration d'une DS pour gérer la désaffectation d'une pose
     IDSPOSE      DS
     I I                                      1  10 EYECOD
     I I                                     11  11 EYEMOD
     I I            0                        12  130EYENB
     I I                                     14  23 CORCOD
     I I            0                        24  250CORDNB
     I I                                     26  35 BTPCOD
     I I                                     36  36 BTPMOD
     I I            0                        37  380BTPNB
     * accessoire si EPOSE passe de "*" à Blanc
     *
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
     *  AFFIC: 1 = EXT , 2 = INT, 3 = EXT + INT, 4 = INT + EXT
     *  CLE D'ACCES FICHIER XTBASE01
     C           KTBA01    KLIST
     C                     KFLD           TBLNOM
     C                     KFLD           TBVARG
     C                     KFLD           TBNSEG
     *  CLE D'ACCES FICHIER CLIENTS
     C           CLE1      KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEQACH
     C           CLE7      KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           SEQSTA
     C           CLE8      KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           CODOBI
     C           CLE9      KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           RGLIV
     *  CLE D'ACCES FICHIER PREIMP2
     C           CLE2      KLIST
     C                     KFLD           NIMP1   40
     C                     KFLD           NIMP2   40
     *  CLE D'ACCES FICHIER PARAME
     C           CLE3      KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
     *  CLE D'ACCES FICHIER MATPRE
     C           CLE4      KLIST
     C                     KFLD           PAPI    3
     C                     KFLD           GRAM    30
     C                     KFLD           REFOUR  6
     C                     KFLD           GRAREL  30
     *  CLE D'ACCES FICHIER CXHLIG
     C           CLE4B     KLIST
     C                     KFLD           QUACXH
     C                     KFLD           GRACXH
     C                     KFLD           ADPCXH
     C                     KFLD           ADGCXH
     *  CLE D'ACCES FICHIER OFFRES ET DEVIS EN COURS
     C           CLE5      KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
     C           CLE6      KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
     C                     KFLD           SEQD    40
     C           CLE11     KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
     C                     KFLD           ORD
     C           CLE10     KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
     *  CLE D'ACCES FICHIER TTREXP
     C           CLETTR    KLIST
     C                     KFLD           CPAYFO
     C                     KFLD           RPAYS
     *
     C           *ENTRY    PLIST
     C                     PARM           APPEL
     *
     C                     Z-ADD*ZEROS    £ZERO
     C                     Z-ADD*ZEROS    £ZERO1
     C                     SETOF                     99
     C           £USER     CHAINMNUDIRL1             50
     C           DIRSER    COMP OVR,6                    01
     C  N01      DIRSER    COMP OVR,10                   01
     C  N01      RES10     COMP OVR,18                   01
D1  C                     SELEC
     C           DIRUSI    WHEQ '1'
     C                     MOVEL'S'       POSTE
     C           DIRUSI    WHEQ '2'
     C                     MOVEL'R'       POSTE
     C           DIRUSI    WHEQ '3'
     C                     MOVEL'DENEUFEG'TUSER  10
     C                     MOVE '_C'      TUSER
D2  C           £USER     IFNE TUSER
     C                     MOVEL'T'       POSTE
F2  C                     END
     C           DIRUSI    WHEQ '4'
     C                     MOVEL'N'       POSTE
     C           DIRUSI    WHEQ '7'
     C                     MOVEL'F'       POSTE
F1  C                     ENDSL
     *  OVR SUIVANT CHOIX
    C*
     C                     Z-ADD60        LONG
D1  C           TRAV1     IFEQ 'D'                        DEVIS
     C                     SETON                     99
     C                     MOVELOVR,2     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,11    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,30    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'I'                        DEVIS PREIMP
     C                     MOVELOVR,9     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     SETON                     06
     C                     MOVELOVR,17    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVE 'O'       STOCKE
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'P'                        PANEL
     C                     MOVELOVR,3     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,12    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'B'                        SIMUL BE
     C                     SETON                     99
     C                     MOVELOVR,4     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,13    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,31    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'S'                        SIMUL AUTRES
     C                     SETON                     99
     C                     MOVELOVR,5     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,14    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,32    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'E'                        ENQUETE
     C                     MOVELOVR,7     OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,15    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     SETOF                     01
F1  C                     END
    C*
D1  C           TRAV1     IFEQ 'C'                        PANEL
     C                     MOVELOVR,8     OVRDB             SOFHUNIC
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     MOVELOVR,16    OVRDB
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG
F1  C                     END
     C           TRAV12    LOKUPTABCTR    TABLTR         50
     C   50                MOVELTABLTR    LIBTRA
    C*
     C                     OPEN DEVIS
     C                     OPEN DEVIS2
     C                     OPEN DEVAMLL1
    C*
     C                     SETOF                     38
D1  C           TRAV2     IFNE 'S'                        MODIF OU VARIA
D2  C           TRAV2     IFEQ 'M'                        MODIF
     C                     SETON                     38
F2  C                     END
     C           RANG      CHAINDEVIS                50
     C                     Z-ADDNOETU     SVNOE  100
     C                     MOVE ' '       UNFOIS  1
     C                     MOVE AFFI      AFFIAV  1
     C                     MOVELDSSC      SVNC
     C                     MOVE NIMPE1    SIMPE1
     C                     MOVE NIMPE2    SIMPE2
     C                     MOVEL'TVRP'    PXARGU
     C                     MOVE AGENT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    NOMAG
     C                     MOVEL'ETUD'    PXARGU
     C                     MOVE ETUPAR    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    NOMETU
     C                     MOVEL'UVEN'    PXARGU
     C                     MOVE UVENT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUV
     C                     MOVEL'FACO'    PXARGU
     C                     MOVE FACON     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBFAC
     C                     MOVEL'ONDU'    PXARGU
     C                     MOVE ONDUL     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXABRG    LIBOND
     C                     MOVEL'CCOL'    PXARGU
     C                     MOVE CCOL      PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXABRG    LIBCC
     C                     MOVEL'TOND'    PXARGU
     C                     MOVE CVEI3     CNDD
     C                     MOVELSIDD      PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXABRG    LIBTP
     C   50                MOVELLIBCC     LIBTP
D2  C           PAP1      IFEQ 'XXX'
    C           GRA1      ANDEQ999
    C           PAP5      OREQ 'XXX'
    C           GRA5      ANDEQ999
     C                     MOVEL'SD'      LIBTP
F2  C                     END
D2  C           PAP4      IFEQ 'XXX'
    C           GRA4      ANDEQ999
    C           NIMPI1    ANDNE'   '
     C                     MOVEL'SD'      LIBTP
F2  C                     END
D2  C           TSOND     IFEQ 'SC'
     C                     MOVE *BLANK    TSOND
     C                     MOVE 'O'       SCARS
X2  C                     ELSE
     C                     MOVE *BLANK    SCARS
F2  C                     END
D2  C           TYPPO1    IFNE ' '
D3  C           TYPPO1    IFEQ 'R'
     C                     MOVEL'RINA'    PXARGU
X3  C                     ELSE
     C                     MOVEL'PLAS'    PXARGU
F3  C                     END
     C                     MOVE TYPPO2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBPOI
F2  C                     END
D2  C           TYPFE1    IFEQ 'F'
    C           TYPFE1    OREQ 'M'
     C                     MOVEL'RHOD'    PXARGU
X2  C                     ELSE
D3  C           TYPFE1    IFEQ 'L'
     C                     MOVEL'LANG'    PXARGU
X3  C                     ELSE
     C                     MOVEL' BIB'    PXARGU
F3  C                     END
F2  C                     END
     C                     MOVE TYPFE2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBFEN
     C                     Z-ADD1         TBNSEG
     C                     MOVE TDEC1     XDECA1
     C                     MOVE '0'       XDECA2
     C                     MOVE TDEC3     XDECA3
     C                     MOVELXDECKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XDECOUPS'TBLNOM
     C           KTBA01    CHAINXTBASE01             50
     C  N50                MOVELTBVRES    XDECS1
     C  N50                MOVELXDEC01    LIBDEC
     C                     MOVEL'ASSB'    PXARGU
     C                     MOVE COAS1     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBAS1
     C                     MOVEL'ASSB'    PXARGU
     C                     MOVE COAS2     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBAS2
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIME
     C                     SETON                     2930
D2  C           TIMPEX    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPEX    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIME
F2  C                     END
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIMI
     C                     SETON                     2931
D2  C           TIMPIN    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPIN    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIMI
F2  C                     END
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIER
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIIR
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUIE
     C                     MOVE USINT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUII
     C                     MOVEL'TYPD'    PXARGU
     C                     MOVE TYPDEV    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBDEV
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATFC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMF
     C                     MOVE MATSC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMS     P
     C                     MOVE MATGC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMG
     C                     MOVE MATDC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMD
     C                     MOVE MATBC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBBM
     C                     MOVE MATEC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBME
     C                     MOVE MATIC     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMI
     C                     MOVE MATERC    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMER
     C                     MOVE MATIRC    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBMIR
     C                     MOVEL'TDST'    PXARGU
     C                     MOVE STCOD1    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBST1
     C                     MOVE STCOD2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBST2
     C                     MOVE STCOD3    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBST3
     C                     MOVE STCOD4    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBST4
D2  C           OREX      IFNE *BLANKS
     C                     MOVE OREX      X1
     C                     MOVELOREX      ORALEX
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALE
X3  C                     ELSE
     C                     MOVE X1        CORALE
F3  C                     END
F2  C                     END
D2  C           ORIN      IFNE *BLANKS
     C                     MOVE ORIN      X1
     C                     MOVELORIN      ORALIN
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALI
X3  C                     ELSE
     C                     MOVE X1        CORALI
F3  C                     END
F2  C                     END
D2  C           OREXR     IFNE *BLANKS
     C                     MOVE OREXR     X1
     C                     MOVELOREXR     ORAEXR
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORAER
X3  C                     ELSE
     C                     MOVE X1        CORAER
F3  C                     END
F2  C                     END
D2  C           ORINR     IFNE *BLANKS
     C                     MOVE ORINR     X1
     C                     MOVELORINR     ORAINR
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORAIR
X3  C                     ELSE
     C                     MOVE X1        CORAIR
F3  C                     END
F2  C                     END
D2  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X2  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F2  C                     END
     C                     MOVE ' '       ALMF
D2  C           NOCLI     IFNE 8928
     C                     Z-ADDSEQDE     SVSQ    40
     C                     Z-ADD*ZEROS    SEQDE
     C           CLE5      SETLLDEVAMLL1                 50
D3  C           *IN50     IFEQ '0'
     C                     Z-ADDSVSQ      SEQDE
     C           CLE5      SETLLDEVAMLL1                 50
F3  C                     END
     C   50                MOVE '*'       ALMF
     C                     Z-ADDSVSQ      SEQDE
F2  C                     END
X1  C                     ELSE
     C                     Z-ADD1         STE
     C                     Z-ADD1         SEQACH
     C                     SETON                     20
D2  C           TRAV1     IFEQ 'I'
     C                     Z-ADD1         TYPDEV
X2  C                     ELSE
     C                     Z-ADD5         TYPDEV
F2  C                     END
F1  C                     END
     C                     MOVE CLIE3     AFFL1
     C                     MOVE CLII3     AFFD1
     C                     MOVE CLIE2     AFFL2
     C                     MOVE CLII2     AFFD2
     C                     MOVE TVEI3     CFINIT
     *
D1  C           TPOSTE    IFEQ *BLANKS
    C           TRAV2     OREQ 'V'                        VARIANTE
    C           TYPDEV    ANDEQ1
     C                     MOVE POSTE     TPOSTE
F1  C                     END
D1  C           DIRPRF    IFEQ *BLANKS
    C           TRAV2     OREQ 'V'                        VARIANTE
    C           TYPDEV    ANDEQ1
     C                     MOVE £USER     DIRPRF
F1  C                     END
     *
D1  C           TYPDEV    IFEQ 2
     C                     MOVE DAPEX     XAPEX
     C                     MOVE DAPEXR    XAPEXR
     C                     MOVE DAPIN     XAPIN
     C                     MOVE DAPINR    XAPINR
     C                     MOVE *BLANKS   DAPEX
     C                     MOVE *BLANKS   DAPEXR
     C                     MOVE *BLANKS   DAPIN
     C                     MOVE *BLANKS   DAPINR
F1  C                     END
    C*  APPEL PAR SAISIE MODELE
D1  C           TRAV1     IFEQ 'D'
    C           TRAV2     ANDEQ'S'
    C           NO1       ANDNE*BLANK
     C                     SETON                     2628
     C                     Z-ADD3         TYPDEV
     C                     MOVE NO1       ANDEV
     C                     MOVE NO2       ETUDE
     C                     MOVE NO3       SEQDE
F1  C                     END
    C*
D1  C           TRAV2     IFEQ 'V'                        VARIANTE
     C                     Z-ADDSEQDE     SEQDX   40
D2  C           TRAV1     IFEQ 'S'
    C           TRAV1     OREQ 'B'                          AVEC
     C                     SETON                     27    STOCKAGE ?
F2  C                     END
F1  C                     END
    C*
D1  C           TRAV2     IFEQ 'M'
     C                     SETON                     2628  PROTECT N°/TYPE
D2  C           TRAV1     IFEQ 'S'
    C           TRAV1     OREQ 'B'                          AVEC
     C                     SETON                     27    STOCKAGE ?
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   TAG1
     C                     MOVE *BLANKS   TAG2
F1  C                     END
D1  C           TRAV2     IFEQ 'E'
     C                     SETON                     26    PROTECT N°
F1  C                     END
D1  C           TRAV2     IFEQ 'C'
     C                     SETON                     2628  PROTECT N°/TYPE
     C                     Z-ADD1         TYPDEV
     C                     MOVE *BLANKS   DAPEX
     C                     MOVE *BLANKS   DAPEXR
     C                     MOVE *BLANKS   DAPIN
     C                     MOVE *BLANKS   DAPINR
D2  C           FMINLA    IFNE *ZEROS
     C           FMINLA    ADD  22        ACOTE
F2  C                     END
     C                     Z-ADD*ZEROS    FMINLA
     C                     MOVEL'TYPD'    PXARGU
     C                     MOVE TYPDEV    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBDEV
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   1° FORMAT - TOUS DEVIS                               *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG11     TAG
     *          ---------------
D1  C           *IN78     IFEQ '1'
    C           *IN79     OREQ '1'
    C           *IN80     OREQ '1'
    C           *IN81     OREQ '1'
    C           *IN82     OREQ '1'
    C           *IN90     OREQ '1'
    C           *IN91     OREQ '1'
    C           *IN92     OREQ '1'
    C           *IN93     OREQ '1'
    C           *IN94     OREQ '1'
     C                     SETOF                     96
F1  C                     END
D1  C           *IN38     IFEQ '1'
D2  C           NNF       IFEQ 1
     C                     Z-ADDSNF       NF
X2  C                     ELSE
     C                     Z-ADD2         NF
F2  C                     END
F1  C                     END
    C*
     *--- Début --- Philippe --- 03/11/2015 --- Pose Accessoires *
     * - Tester si présence d'une pose accessoire
    C           EYECOD    IFNE *BLANK
    C           BTPCOD    ORNE *BLANK
     C                     MOVEL'*'       EPOSE
     C                     SETON                     40
    C                     ENDIF
     *--- Fin   --- Philippe --- 03/11/2015 --- Pose Accessoires *
     C                     EXFMTFMT1
     C                     SETOF                     20
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG11
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C   40      *IN07     CASEQ'1'       FNC07          25
    C                     END
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C           *IN25     CABEQ'1'       TAG11
D1  C           *IN23     IFEQ '1'                         DEMANDE
    C           *IN38     ANDEQ'1'                           SUPPRESSION
     C                     WRITEWSUP1
     C                     EXFMTWSUP2
D2  C           *IN23     IFEQ '1'
     C                     DELETDEVISF1
     C           CLE5      CHAINDEVIS2               50
     C  N50                DELETDEVIS2F1
     C           CLE5      CHAINDEVAMLL1             50
D3  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C           CLE5      READEDEVAMLL1                 50
F3  C                     END
     C                     Z-ADDSVNOE     NOETU
     C                     MOVE '0000'    NOETU
     C           CLE5      CHAINDEVAMLL1             50
D3  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C           CLE5      READEDEVAMLL1                 50
F3  C                     END
    C                     GOTO FINPG
X2  C                     ELSE
    C                     GOTO TAG11
F2  C                     END
F1  C                     END
D1  C           *IN16     IFEQ '1'                         DEMANDE  INTERRO
    C           *IN01     ANDEQ'0'                           OBERVATIONS
    C           NOCLI     ANDNE*ZEROS
     C                     MOVE 'O'       INTOBS
     C                     CALL 'CLIE10£'
     C                     PARM           DSSC
F1  C                     END
     C/SPACE 3
     C                     Z-ADD*ZEROS    NBPAP   10
     C                     Z-ADD*ZEROS    NCXH    10
     C                     Z-ADD*ZEROS    IREPE   10
     C                     MOVE *BLANKS   TPS
     C                     MOVE *BLANKS   PAPECX  3
     C                     Z-ADD*ZEROS    GRAECX  30
     C                     MOVE *BLANKS   REFECX  6
     C                     Z-ADD*ZEROS    RELECX  30
     C                     Z-ADD*ZEROS    PASECX  10
     C                     MOVE *BLANKS   PAPICX  3
     C                     Z-ADD*ZEROS    GRAICX  30
     C                     MOVE *BLANKS   REFICX  6
     C                     Z-ADD*ZEROS    RELICX  30
     C                     Z-ADD*ZEROS    PASICX  10
     C                     MOVE *BLANK    TCXHE   1
     C                     MOVE *BLANK    TCXHI   1
     C                     SETOF                     3736
     * VERIFICATION ZONES
     *=========================
    C* TYPE DEVIS
    C*-------------------------
     C                     MOVEL'TYPD'    PXARGU
     C                     MOVE TYPDEV    PXVALE    P
     C           CLE3      CHAINPARAME               85
    C   85                GOTO TAG11                      MESSAGE 35
    C  N85      TYPDEV    CABEQ4                        85MESSAGE 35
    C  N85 06   TYPDEV    CABNE1                    8585  MESSAGE 35
     C                     MOVELPXLIBE    LIBDEV
    C*
D1  C           TRAV2     IFNE 'S'
    C           TYPDEV    ANDEQ3
     C                     SETON                     85
    C                     GOTO TAG11                      MESSAGE 35
F1  C                     END
    C*
D1  C           *IN27     IFEQ '1'
    C           TAG3      ANDEQ'O'
    C           TYPDEV    ANDNE1
     C                     SETON                     95
    C                     GOTO TAG11                      MESSAGE 31
F1  C                     END
D1  C           *IN01     IFEQ '1'
    C           TAG3      ANDEQ'O'
     C                     SETON                     32
    C                     GOTO TAG11                      MESSAGE 178
F1  C                     END
    C* N° DEVIS
    C*-------------------------
     C                     SETOF                     50
    C*
D1  C           *IN27     IFEQ '1'
    C           TAG3      ANDEQ'O'
    C           TRAV1     OREQ 'D'
    C           TRAV1     OREQ 'I'
D2  C           STOCKE    IFNE *BLANK                     PRE IMPRIME
     C                     Z-ADDETUDE     NIMP1               STOCKE
     C                     Z-ADDSEQDE     NIMP2
     C           CLE2      SETLLPREIMP2                  50
X2  C                     ELSE
     C           CLE5      SETLLOFFRES                   50
F2  C                     END
F1  C                     END
D1  C           *IN50     IFEQ '1'
    C           ETUDE     OREQ *ZEROS
    C           SEQDE     OREQ *ZEROS
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F1  C                     END
    C*
D1  C           *IN26     IFEQ '0'
     C                     Z-ADDETUDE     ETUDS   40
     C                     Z-ADDANDEV     ANDES   40
     C                     Z-ADDSEQDE     SEQDS   40
     C                     Z-ADDSEQDE     SEQD
D2  C           TYPDEV    IFNE 3
     C           CLE6      CHAINDEVISL4              50
D3  C           *IN50     IFEQ '0'
D4  C           TRAV2     IFEQ 'S'
    C           SEQD      ORNE SEQDX
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
X4  C                     ELSE
     C           CLE6      READEDEVISL4                  50
D5  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           STOCKE    IFEQ *BLANK                     PRE IMPRIME
     C                     SUB  1         SEQD             4 AVANT
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     SUB  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     SUB  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     SUB  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     Z-ADDSEQDS     SEQD
     C                     ADD  1         SEQD             4 APRES
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     ADD  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     ADD  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
     C                     ADD  1         SEQD
     C           CLE6      CHAINDEVISL4              50
D4  C           *IN50     IFEQ '0'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F4  C                     END
F3  C                     END
X2  C                     ELSE
     C           CLE6      SETLLETIQUET                  50
D3  C           *IN50     IFEQ '1'
     C                     SETON                     51
    C                     GOTO TAG11                      MESSAGE 1
F3  C                     END
F2  C                     END
     C                     Z-ADDETUDS     ETUDE
     C                     Z-ADDANDES     ANDEV
     C                     Z-ADDSEQDS     SEQDE
F1  C                     END
    C* N° CLIENT
    C*-------------------------
     C                     MOVELDSSC      DSSCS   7
D1  C           DSSCS     IFNE SVNC
     C           CLE1      CHAINCLIACHL1             52
    C   52                GOTO TAG11
     C                     MOVELNOMACH    NOMCLI
D2  C           IN99      IFEQ '0'
D3  C           NOCLI     IFEQ 7777
    C           NOCLI     OREQ 8888
     C                     WRITEWCLI1
     C                     EXFMTWCLI2
X3  C                     ELSE
     C                     Z-ADD1         RGLIV
     C           CLE9      CHAINCLILIVL1             50
     C                     MOVELDEPLIV    LIEU
D4  C           CPAYLV    IFGT 1
     C                     Z-ADDCPAYLV    CPAYFO
X4  C                     ELSE
     C                     Z-ADD*ZEROS    CPAYFO
F4  C                     END
F3  C                     END
     C                     MOVEL'TOLERE'  CODOBI
     C           CLE8      SETLLCLIOBIL4
     C           CLE8      READECLIOBIL4                 50
D3  C           *IN50     IFEQ '0'
     C                     MOVELLIBOBI    OBST1
     C           CLE8      READECLIOBIL4                 50
D4  C           *IN50     IFEQ '0'
     C                     MOVELLIBOBI    OBST2
F4  C                     END
     C           CLE8      READECLIOBIL4                 50
D4  C           *IN50     IFEQ '0'
     C                     MOVELLIBOBI    OBST3
F4  C                     END
     C                     WRITEWOBS1
     C                     EXFMTWOBS2
F3  C                     END
F2  C                     END
     C                     MOVELDSSC      SVNC    7
F1  C                     END
    C*
    C* GROUPE
    C*-------------------------
     C                     MOVEL'GRPS'    PXARGU
     C                     MOVE GROUP     PXVALE    P
     C           CLE3      CHAINPARAME               53
    C   53                GOTO TAG11                      MESSAGE 3
    C* AGENT
    C*-------------------------
D1  C           AGENT     IFEQ *ZEROS
    C           DSSCS     ORNE SVNC
     C                     Z-ADD1         SEQSTA
     C           CLE7      CHAINCLISTAL1             50
D2  C           *IN50     IFEQ '0'
     C                     MOVE AGSTA     AGENT
F2  C                     END
F1  C                     END
     C                     MOVEL'TVRP'    PXARGU
     C                     MOVE AGENT     PXVALE    P
     C           CLE3      CHAINPARAME               54
    C   54                GOTO TAG11
     C                     MOVELPXLIBE    NOMAG            MESSAGE 4
    C* ETUDIE PAR
    C*-------------------------
D1  C           ETUPAR    IFNE *BLANKS
     C                     MOVEL'ETUD'    PXARGU
     C                     MOVE ETUPAR    PXVALE    P
     C           CLE3      CHAINPARAME               55
    C   55                GOTO TAG11                      MESSAGE 5
     C                     MOVELPXLIBE    NOMETU
F1  C                     END
    C* GARNITURE
    C*-------------------------
D1  C           GARNT     IFNE *BLANKS
D2  C           GARNT2    IFLT 'A'
    C           GARNT2    ORGT 'O'
    C           GARNT1    ORGT GARNT2
    C           GARNT1    OREQ *BLANK
     C                     SETON                     56
    C   56                GOTO TAG11                      MESSAGE 6
F2  C                     END
D2  C           HOMOL     IFNE *BLANKS                    PROVISOIRE
    C           GARNT1    ANDEQ'M'
    C           GROUPA    ORNE *ZEROS
     C                     SETON                     56
    C   56                GOTO TAG11                      MESSAGE 6
F2  C                     END
F1  C                     END
    C* AMALGAME FORME
    C*-------------------------
D1  C           ALMF      IFEQ '*'
    C           NOCLI     ANDEQ8928
     C                     SETON                     33
    C   33                GOTO TAG11                      MESSAGE 205
F1  C                     END
    C* DESIGNATION PRODUIT
    C*-------------------------
D1  C           BLOC1     IFEQ *BLANKS
     C                     SETON                     57
    C   57                GOTO TAG11                      MESSAGE 7
F1  C                     END
    C* UNITE VENTE
    C*-------------------------
     C                     MOVEL'UVEN'    PXARGU
     C                     MOVE UVENT     PXVALE    P
     C           CLE3      CHAINPARAME               58
    C   58                GOTO TAG11                      MESSAGE 8
     C                     MOVELPXLIBE    LIBUV
    C* TYPOLOGIE PRODUIT
    C*-------------------------
D1  C           TYPOPR    IFNE *BLANKS
     C           TYPOPR    CHAINFTYPOPL1             19
    C   19                GOTO TAG11                      MESSAGE 202
F1  C                     END
    C* TYPE PRODUIT 1
    C*-------------------------
D1  C           TYPP1     IFNE *BLANKS
     C                     MOVEL'PRTY'    PXARGU
     C                     MOVE TYPP1     PXVALE    P
     C           CLE3      CHAINPARAME               59
    C   59                GOTO TAG11                      MESSAGE 9
D2  C           LIBPR1    IFEQ *BLANKS
     C                     MOVELPXLIBE    LIBPR1
F2  C                     END
X1  C                     ELSE
D2  C           LIBPR1    IFEQ *BLANKS
     C                     SETON                     60
    C   60                GOTO TAG11                      MESSAGE 10
F2  C                     END
F1  C                     END
D1  C           DAPP11    IFEQ *ZEROS
    C           DAPP21    ANDNE*ZEROS
    C           DAPP11    ORNE *ZEROS
    C           DAPP21    ANDEQ*ZEROS
    C           FACON     ANDGT2
     C                     SETON                     61    MESSAGE 11
    C   61                GOTO TAG11
F1  C                     END
    C*
D1  C           DAPP11    IFNE *ZEROS
     C                     Z-ADDDAPP11    DECL
X1  C                     ELSE
D2  C           DAPP12    IFNE *ZEROS
     C                     Z-ADDDAPP12    DECL
X2  C                     ELSE
D3  C           DAPP13    IFNE *ZEROS
     C                     Z-ADDDAPP13    DECL
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           DAPP21    IFNE *ZEROS
     C                     Z-ADDDAPP21    DECH
X1  C                     ELSE
D2  C           DAPP22    IFNE *ZEROS
     C                     Z-ADDDAPP22    DECH
X2  C                     ELSE
D3  C           DAPP23    IFNE *ZEROS
     C                     Z-ADDDAPP23    DECH
F3  C                     END
F2  C                     END
F1  C                     END
    C* TYPE PRODUIT 2
    C*-------------------------
D1  C           TYPP2     IFNE *BLANKS
     C                     MOVEL'PRTY'    PXARGU
     C                     MOVE TYPP2     PXVALE    P
     C           CLE3      CHAINPARAME               62    MESSAGE 9
    C   62                GOTO TAG11
D2  C           LIBPR2    IFEQ *BLANKS
     C                     MOVELPXLIBE    LIBPR2
F2  C                     END
D2  C           DAPP12    IFEQ *ZEROS
    C           DAPP22    ANDNE*ZEROS
    C           DAPP12    ORNE *ZEROS
    C           DAPP22    ANDEQ*ZEROS
     C                     SETON                     64    MESSAGE 11
    C   64                GOTO TAG11
F2  C                     END
F1  C                     END
    C* TYPE PRODUIT 3
    C*-------------------------
D1  C           TYPP3     IFNE *BLANKS
     C                     MOVEL'PRTY'    PXARGU
     C                     MOVE TYPP3     PXVALE    P
     C           CLE3      CHAINPARAME               65    MESSAGE 9
    C   65                GOTO TAG11
D2  C           LIBPR3    IFEQ *BLANKS
     C                     MOVELPXLIBE    LIBPR3
F2  C                     END
D2  C           DAPP13    IFEQ *ZEROS
    C           DAPP23    ANDNE*ZEROS
    C           DAPP13    ORNE *ZEROS
    C           DAPP23    ANDEQ*ZEROS
     C                     SETON                     67    MESSAGE 11
    C   67                GOTO TAG11
F2  C                     END
F1  C                     END
    C* DIMENSION EN VOLUME
    C*-------------------------
D1  C           DIMVOL    IFNE *BLANKS
     C                     MOVEL'DEVO'    PXARGU
     C                     MOVE DIMVOL    PXVALE    P
     C           CLE3      CHAINPARAME               68    MESSAGE 18
    C   68                GOTO TAG11
D2  C           DEMLON    IFEQ *ZEROS
    C           DEMLAR    OREQ *ZEROS
    C           DEMHAU    OREQ *ZEROS
     C                     SETON                     68
    C                     GOTO TAG11
F2  C                     END
X1  C                     ELSE
D2  C           DEMLON    IFNE *ZEROS
    C           DEMLAR    ORNE *ZEROS
    C           DEMHAU    ORNE *ZEROS
     C                     SETON                     68
    C                     GOTO TAG11
F2  C                     END
F1  C                     END
    C* FACONNAGE
    C*-------------------------
     C                     MOVEL'FACO'    PXARGU
     C                     MOVE FACON     PXVALE    P
     C           CLE3      CHAINPARAME               69    MESSAGE 19
    C   69                GOTO TAG11
     C                     MOVELPXLIBE    LIBFAC
D1  C           FACON     IFLT 7                          REMISE A BLANKS
    C           FACON     ORGT 8                          SI VARIANTE AVEC
D2  C           COAS1     IFNE 44
     C                     Z-ADD*ZEROS    COAS1             MODIF FACON
     C                     MOVE *BLANK    PLIA1
     C                     Z-ADD*ZEROS    PASS1
     C                     Z-ADD*ZEROS    AXES1
     C                     Z-ADD*ZEROS    LPAT1
     C                     Z-ADD*ZEROS    PIST1
     C                     MOVE *BLANK    COLA1
     C                     MOVE *BLANK    ETIQ1
F2  C                     END
     C                     MOVE *BLANK    JUMEL
     C                     Z-ADD*ZEROS    COAS2
     C                     MOVE *BLANK    PLIA2
     C                     Z-ADD*ZEROS    PASS2
     C                     Z-ADD*ZEROS    AXES2
     C                     Z-ADD*ZEROS    LPAT2
     C                     Z-ADD*ZEROS    PIST2
     C                     MOVE *BLANK    COLA2
     C                     MOVE *BLANK    ETIQ2
F1  C                     END
D1  C           FACON     IFLT 6                          REMISE A BLANKS
    C           FACON     ORGT 8
     C                     MOVE *BLANKS   TDECO
     C                     MOVE *BLANKS   MATFC
     C                     MOVE *BLANKS   LIBMF
     C                     Z-ADD*ZEROS    MATFM
     C                     MOVE *BLANKS   MATSC
     C                     MOVE *BLANKS   LIBMS
     C                     Z-ADD*ZEROS    MATSM
     C                     MOVE *BLANKS   MATGC
     C                     MOVE *BLANKS   LIBMG
     C                     Z-ADD*ZEROS    MATGM
     C                     MOVE *BLANKS   MATDC
     C                     MOVE *BLANKS   LIBMD
     C                     Z-ADD*ZEROS    MATDM
     C                     MOVE *BLANKS   MATBC
     C                     MOVE *BLANKS   LIBBM
     C                     Z-ADD*ZEROS    MATBM
D2  C           FACON     IFNE 5
    C           FACON     ANDNE9
     C                     Z-ADD*ZEROS    POSF2
     C                     Z-ADD*ZEROS    POSF1
F2  C                     END
     C                     Z-ADD*ZEROS    POSFO
     C                     Z-ADD*ZEROS    FMINL
     C                     Z-ADD*ZEROS    FMINH
F1  C                     END
D1  C           FACON     IFLT 5                          REMISE A BLANKS
     C                     Z-ADD*ZEROS    ONDL
     C                     Z-ADD*ZEROS    ONDH
F1  C                     END
D1  C           FACON     IFLT 5                          REMISE A BLANKS
    C           FACON     ANDNE0
    C           FACON     OREQ 9
     C                     Z-ADD*ZEROS    FORL
     C                     Z-ADD*ZEROS    FORH
     C                     Z-ADD*ZEROS    ACOTE
F1  C                     END
D1  C           FACON     IFGT 2                          REMISE A BLANKS
    C           FACON     ORLT 1
     C                     Z-ADD*ZEROS    LONBOB
F1  C                     END
    C* ONDULATION
    C*-------------------------
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 8
    C           ONDUL     ANDNE9
     C                     MOVEL'ONDU'    PXARGU
     C                     MOVE ONDUL     PXVALE    P
     C           CLE3      CHAINPARAME               70    MESSAGE 20
    C   70                GOTO TAG11
     C                     MOVELPXABRG    LIBOND
X1  C                     ELSE
D2  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     MOVEL'DD'      LIBOND    P
X2  C                     ELSE
D3  C           CCOL      IFEQ 0
D4  C           ONDUL     IFEQ 7
     C                     MOVEL'ONDU'    PXARGU
     C                     MOVE ONDUL     PXVALE    P
     C           CLE3      CHAINPARAME               70    MESSAGE 20
     C                     MOVELPXABRG    LIBOND
X4  C                     ELSE
    C           ONDUL     CABNE*ZEROS    TAG11      7070
F4  C                     END
X3  C                     ELSE
    C           ONDUL     CABNE*ZEROS    TAG11      7070
F3  C                     END
F2  C                     END
F1  C                     END
    C* CONTRE COLLAGE
    C*-------------------------
     C                     MOVEL'CCOL'    PXARGU
     C                     MOVE CCOL      PXVALE    P
     C           CLE3      CHAINPARAME               71    MESSAGE 21
    C   71                GOTO TAG11
     C                     MOVELPXABRG    LIBCC
     C                     SETOF                     08
D1  C           CCOL      IFEQ 9
    C           CCOL      OREQ 6
    C           CCOL      OREQ 8
    C           ONDUL     ANDEQ9
     C                     SETON                     08
X1  C                     ELSE
     C                     Z-ADD0         CNDD
F1  C                     END
     C                     MOVEL'TOND'    PXARGU
     C   08                MOVELSIDD      PXVALE    P
     C  N08                MOVELCCOND     PXVALE    P
     C           CLE3      CHAINPARAME               71
D1  C           *IN71     IFEQ '1'
D2  C           CCOL      IFEQ 9
    C           CCOL      OREQ 6
    C           CCOL      OREQ 8
    C           ONDUL     ANDEQ9
     C                     SETOF                     71
     C                     MOVELLIBCC     LIBTP
X2  C                     ELSE
    C                     GOTO TAG11
F2  C                     END
X1  C                     ELSE
     C                     MOVELPXABRG    LIBTP
F1  C                     END
D1  C           PAP1      IFEQ 'XXX'
    C           GRA1      ANDEQ999
    C           PAP5      OREQ 'XXX'
    C           GRA5      ANDEQ999
     C                     MOVEL'SD'      LIBTP
F1  C                     END
D1  C           PAP4      IFEQ 'XXX'
    C           GRA4      ANDEQ999
    C           NIMPI1    ANDNE'   '
     C                     MOVEL'SD'      LIBTP
F1  C                     END
    C* FENETRE
    C*-------------------------
D1  C           TYPFEN    IFNE *BLANKS
     C                     MOVE *BLANKS   PXARGU
D2  C           TYPFE1    IFEQ 'B'
     C                     MOVEL' BIB'    PXARGU
F2  C                     END
D2  C           TYPFE1    IFEQ 'L'
     C                     MOVEL'LANG'    PXARGU
F2  C                     END
D2  C           TYPFE1    IFEQ 'F'
    C           TYPFE1    OREQ 'M'
     C                     MOVEL'RHOD'    PXARGU
F2  C                     END
     C                     MOVE TYPFE2    PXVALE    P
     C           CLE3      CHAINPARAME               72    MESSAGE 22
    C   72                GOTO TAG11
     C                     MOVELPXLIBE    LIBFEN
D2  C           FACON     IFLT 6
    C           FACON     ORGT 8
     C                     SETON                     88    MESSAGE 38
    C   88                GOTO TAG11
F2  C                     END
     C                     SETON                     33
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBFEN
     C                     SETOF                     33
F1  C                     END
    C* SESAME
    C*-------------------------
D1  C           COSESA    IFNE *BLANKS
     C                     MOVEL'SESA'    PXARGU
     C                     MOVE COSESA    PXVALE    P
     C           CLE3      CHAINPARAME               74    MESSAGE 24
    C   74                GOTO TAG11
D2  C           NBSESA    IFEQ *ZEROS
     C                     SETON                     74    MESSAGE 24
    C   74                GOTO TAG11
F2  C                     END
X1  C                     ELSE
D2  C           NBSESA    IFNE *ZEROS
     C                     SETON                     74
    C   74                GOTO TAG11                      MESSAGE 24
F2  C                     END
F1  C                     END
    C* TRACEUR ANTIVOL
    C*-------------------------
D1  C           TTRACE    IFNE *BLANKS
     C                     MOVEL'TTRA'    PXARGU
     C                     MOVE TTRACE    PXVALE    P
     C           CLE3      CHAINPARAME               63    MESSAGE 171
    C   63                GOTO TAG11
F1  C                     END
    C* TEAR TAPE
    C*-------------------------
D1  C           COTAPE    IFNE *BLANKS
     C                     MOVEL'TAPE'    PXARGU
     C                     MOVE COTAPE    PXVALE    P
     C           CLE3      CHAINPARAME               75    MESSAGE 25
    C   75                GOTO TAG11
D2  C           NBTAPE    IFEQ *ZEROS
     C                     SETON                     75    MESSAGE 25
    C   75                GOTO TAG11
F2  C                     END
X1  C                     ELSE
D2  C           NBTAPE    IFNE *ZEROS
     C                     SETON                     75    MESSAGE 25
    C   75                GOTO TAG11
F2  C                     END
F1  C                     END
    C* POIGNEE PLASTIQUE
    C*-------------------------
D1  C           TYPPOI    IFNE *BLANKS
     C                     MOVE *BLANKS   PXARGU
D2  C           TYPPO1    IFEQ 'R'
     C                     MOVEL'RINA'    PXARGU
F2  C                     END
D2  C           TYPPO1    IFEQ 'P'
    C           TYPPO1    OREQ 'C'
     C                     MOVEL'PLAS'    PXARGU
F2  C                     END
     C                     MOVE TYPPO2    PXVALE    P
     C           CLE3      CHAINPARAME               76
    C   76                GOTO TAG11                      MESSAGE 26
     C                     MOVELPXLIBE    LIBPOI
D2  C           LONPOI    IFEQ *ZEROS
    C           TYPPO1    ANDEQ'P'
     C                     SETON                     77
    C   77                GOTO TAG11                      MESSAGE 27
F2  C                     END
D2  C           LONPOI    IFNE *ZEROS
    C           TYPPO1    ANDEQ'R'
    C           LONPOI    ORNE *ZEROS
    C           TYPPO1    ANDEQ'C'
     C                     SETON                     77
    C   77                GOTO TAG11                      MESSAGE 27
F2  C                     END
X1  C                     ELSE
D2  C           LONPOI    IFNE *ZEROS
     C                     SETON                     77
    C   77                GOTO TAG11                      MESSAGE 27
F2  C                     END
     C                     MOVE *BLANKS   LIBPOI
F1  C                     END
    C* 1° PAPIER
    C*-------------------------
D1  C           PAP1      IFNE *BLANKS
    C           GRA1      ORNE *ZEROS
    C           ADPA1     ORNE *BLANKS
    C           ADGR1     ORNE *ZEROS
     C                     SETON                     96
     C                     MOVELPAP1      PAPI
     C                     Z-ADDGRA1      GRAM
     C                     MOVELADPA1     REFOUR
     C                     Z-ADDADGR1     GRAREL
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHE
F2  C                     END
D2  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             78
    C   78                GOTO TAG11                      MESSAGE 28
    C*
D3  C           PAP1      IFEQ 'XXX'
    C           GRA1      ANDEQ999
    C           CCOL      CABNE9         TAG11      7878
D4  C           PAP5      IFEQ 'XXX'
    C           GRA5      ANDEQ999
     C                     SETON                     78
    C                     GOTO TAG11
F4  C                     END
F3  C                     END
    C*
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     90
    C                     GOTO TAG11                      MESSAGE 29
F4  C                     END
     C                     MOVE '*'       TPS,1
F3  C                     END
    C*
X2  C                     ELSE
     C           CLE4      CHAINCXHENTL1             78
     C  N78      CXHUTI    COMP 'N'                      78
    C   78                GOTO TAG11                      MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     78
    C   78                GOTO TAG11                      MESSAGE 28
     C                     ADD  1         NCXH
     C                     MOVELPAP1      PAPECX
     C                     Z-ADDGRA1      GRAECX
     C                     MOVELADPA1     REFECX
     C                     Z-ADDADGR1     RELECX
     C                     Z-ADDNBRPAS    PASECX
     C                     MOVE '*'       TPS,1
F2  C                     END
     *
     C                     ADD  1         NBPAP
D2  C           PAP1      IFNE 'XXX'
    C           GRA1      ANDNE9999
     C                     MOVELPAP1      PAPIE
     C                     Z-ADDGRA1      GRAME
     C                     MOVELADPA1     REFOUE
     C                     Z-ADDADGR1     GRAREE
F2  C                     END
X1  C                     ELSE
     C                     SETOF                     96
F1  C                     END
    C* 2° PAPIER
    C*-------------------------
D1  C           PAP2      IFNE *BLANKS
    C           GRA2      ORNE *ZEROS
    C           ADPA2     ORNE *BLANKS
    C           ADGR2     ORNE *ZEROS
    C           *IN96     CABEQ'0'       TAG11          87MESSAGE 37
     C                     MOVELPAP2      PAPI
     C                     Z-ADDGRA2      GRAM
     C                     MOVELADPA2     REFOUR
     C                     Z-ADDADGR2     GRAREL
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F2  C                     END
D2  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             79
    C   79                GOTO TAG11                      MESSAGE 28
    C*
D3  C           PAP2      IFEQ 'XXX'
    C           GRA2      ANDEQ999
     C                     SETON                     78
    C                     GOTO TAG11
F3  C                     END
    C*
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     91
    C                     GOTO TAG11                      MESSAGE 29
F4  C                     END
     C                     MOVE '*'       TPS,2
F3  C                     END
    C*
X2  C                     ELSE
     C           CLE4      CHAINCXHENTL1             79
     C  N79      CXHUTI    COMP 'N'                      79
    C   79                GOTO TAG11                      MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     79
    C   79                GOTO TAG11                      MESSAGE 28
     C                     ADD  1         NCXH
     C                     MOVELPAP2      PAPICX
     C                     Z-ADDGRA2      GRAICX
     C                     MOVELADPA2     REFICX
     C                     Z-ADDADGR2     RELICX
     C                     Z-ADDNBRPAS    PASICX
     C                     MOVE '*'       TPS,2
F2  C                     END
     *
     C                     ADD  1         NBPAP
D2  C           PAP1      IFEQ 'XXX'
    C           GRA1      ANDEQ9999
     C                     MOVELPAP2      PAPIE
     C                     Z-ADDGRA2      GRAME
     C                     MOVELADPA2     REFOUE
     C                     Z-ADDADGR2     GRAREE
F2  C                     END
     C                     MOVELPAP2      PAPII
     C                     Z-ADDGRA2      GRAMI
     C                     MOVELADPA2     REFOUI
     C                     Z-ADDADGR2     GRAREI
X1  C                     ELSE
     C                     SETOF                     96
F1  C                     END
    C* 3° PAPIER
    C*-------------------------
D1  C           PAP3      IFNE *BLANKS
    C           GRA3      ORNE *ZEROS
    C           ADPA3     ORNE *BLANKS
    C           ADGR3     ORNE *ZEROS
    C           *IN96     CABEQ'0'       TAG11          87MESSAGE 37
     C                     MOVELPAP3      PAPI
     C                     Z-ADDGRA3      GRAM
     C                     MOVELADPA3     REFOUR
     C                     Z-ADDADGR3     GRAREL
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F2  C                     END
D2  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             80
    C   80                GOTO TAG11                      MESSAGE 28
    C*
D3  C           PAP3      IFEQ 'XXX'
    C           GRA3      ANDEQ999
     C                     SETON                     78
    C                     GOTO TAG11
F3  C                     END
    C*
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     92
    C                     GOTO TAG11                      MESSAGE 29
F4  C                     END
     C                     MOVE '*'       TPS,3
F3  C                     END
    C*
X2  C                     ELSE
     C           CLE4      CHAINCXHENTL1             80
     C  N80      CXHUTI    COMP 'N'                      80
    C   80                GOTO TAG11                      MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     80
    C   80                GOTO TAG11                      MESSAGE 28
     C                     ADD  1         NCXH
     C                     MOVELPAP3      PAPICX
     C                     Z-ADDGRA3      GRAICX
     C                     MOVELADPA3     REFICX
     C                     Z-ADDADGR3     RELICX
     C                     Z-ADDNBRPAS    PASICX
     C                     MOVE '*'       TPS,3
F2  C                     END
     *
     C                     ADD  1         NBPAP
     C                     MOVELPAP3      PAPII
     C                     Z-ADDGRA3      GRAMI
     C                     MOVELADPA3     REFOUI
     C                     Z-ADDADGR3     GRAREI
X1  C                     ELSE
     C                     SETOF                     96
F1  C                     END
    C* 4° PAPIER
    C*-------------------------
D1  C           PAP4      IFNE *BLANKS
    C           GRA4      ORNE *ZEROS
    C           ADPA4     ORNE *BLANKS
    C           ADGR4     ORNE *ZEROS
    C           *IN96     CABEQ'0'       TAG11          87MESSAGE 37
     C                     MOVELPAP4      PAPI
     C                     Z-ADDGRA4      GRAM
     C                     MOVELADPA4     REFOUR
     C                     Z-ADDADGR4     GRAREL
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F2  C                     END
D2  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             81
    C   81                GOTO TAG11                      MESSAGE 28
    C*
D3  C           PAP4      IFEQ 'XXX'
    C           GRA4      ANDEQ999
    C           NIMPI1    ANDEQ'    '
     C                     SETON                     78
    C                     GOTO TAG11
F3  C                     END
    C*
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     93
    C                     GOTO TAG11                      MESSAGE 29
F4  C                     END
     C                     MOVE '*'       TPS,4
F3  C                     END
    C*
X2  C                     ELSE
     C           CLE4      CHAINCXHENTL1             81
     C  N81      CXHUTI    COMP 'N'                      81
    C   81                GOTO TAG11                      MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     81
    C   81                GOTO TAG11                      MESSAGE 28
     C                     ADD  1         NCXH
     C                     MOVELPAP4      PAPICX
     C                     Z-ADDGRA4      GRAICX
     C                     MOVELADPA4     REFICX
     C                     Z-ADDADGR4     RELICX
     C                     Z-ADDNBRPAS    PASICX
     C                     MOVE '*'       TPS,4
F2  C                     END
     *
     C                     ADD  1         NBPAP
     C                     MOVELPAP4      PAPII
     C                     Z-ADDGRA4      GRAMI
     C                     MOVELADPA4     REFOUI
     C                     Z-ADDADGR4     GRAREI
X1  C                     ELSE
     C                     SETOF                     96
F1  C                     END
    C* 5° PAPIER
    C*-------------------------
D1  C           PAP5      IFNE *BLANKS
    C           GRA5      ORNE *ZEROS
    C           ADPA5     ORNE *BLANKS
    C           ADGR5     ORNE *ZEROS
    C           *IN96     CABEQ'0'       TAG11          87MESSAGE 37
     C                     MOVELPAP5      PAPI
     C                     Z-ADDGRA5      GRAM
     C                     MOVELADPA5     REFOUR
     C                     Z-ADDADGR5     GRAREL
D2  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F2  C                     END
D2  C           CXH       IFNE 'CXH'
     C           CLE4      CHAINMATPREL1             82
    C   82                GOTO TAG11                      MESSAGE 28
    C*
D3  C           PAP5      IFEQ 'XXX'
    C           GRA5      ANDEQ999
    C           CCOL      CABNE9         TAG11      7878
D4  C           PAP1      IFEQ 'XXX'
    C           GRA1      ANDEQ999
     C                     SETON                     78
    C                     GOTO TAG11
F4  C                     END
F3  C                     END
    C*
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     94
    C                     GOTO TAG11                      MESSAGE 29
F4  C                     END
     C                     MOVE '*'       TPS,5
F3  C                     END
    C*
X2  C                     ELSE
     C           CLE4      CHAINCXHENTL1             82
     C  N82      CXHUTI    COMP 'N'                      82
    C   82                GOTO TAG11                      MESSAGE 28
     C                     EXSR COMCXH
     C   98                SETON                     81
    C   81                GOTO TAG11                      MESSAGE 28
     C                     ADD  1         NCXH
     C                     MOVELPAP5      PAPICX
     C                     Z-ADDGRA5      GRAICX
     C                     MOVELADPA5     REFICX
     C                     Z-ADDADGR5     RELICX
     C                     Z-ADDNBRPAS    PASICX
     C                     MOVE '*'       TPS,5
F2  C                     END
     *
     C                     ADD  1         NBPAP
D2  C           PAP5      IFNE 'XXX'
    C           GRA5      ANDNE999
     C                     MOVELPAP5      PAPII
     C                     Z-ADDGRA5      GRAMI
     C                     MOVELADPA5     REFOUI
     C                     Z-ADDADGR5     GRAREI
F2  C                     END
X1  C                     ELSE
     C                     SETOF                     96
F1  C                     END
    C* 1° PRE-IMPRIME STOCKE
    C*-------------------------
     C                     Z-ADD*ZEROS    TREPSE  10
     C                     Z-ADD*ZEROS    TREPSI  10
D1  C           NIMPE1    IFNE *BLANKS
    C           NIMPE2    ORNE *BLANKS
    C           NIMPI1    ORNE *BLANKS
    C           NIMPI2    ORNE *BLANKS
     C                     Z-ADD*ZEROS    LUTIL
F1  C                     END
D1  C           NIMPE1    IFNE *BLANKS
    C           NIMPE2    ORNE *BLANKS
     C                     MOVELNIMPE1    NIMP1
     C                     MOVELNIMPE2    NIMP2
     C           CLE2      CHAINPREIMP2              83
    C   83                GOTO TAG11                      MESSAGE 33
     C                     ADD  1         NBPAP
     C                     MOVE TPS,4     TPS,5
     C                     MOVE TPS,3     TPS,4
     C                     MOVE TPS,2     TPS,3
     C                     MOVE TPS,1     TPS,2
     C                     SETON                     362930
     C                     Z-ADDTIMPS     TIMPEX
D2  C           TRAV2     IFEQ 'S'
     C                     MOVE 'C'       COUPEX
F2  C                     END
D2  C           LMINIS    IFGT LUTIL
     C                     Z-ADDLMINIS    LUTIL
F2  C                     END
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIME
     C                     MOVE PAPIS     PAPIE
     C                     Z-ADDGRAMS     GRAME
     C                     MOVE ADPAPS    REFOUE
     C                     Z-ADDADGRAS    GRAREE
     C                     MOVELCOULDS    COUEX
     C                     MOVE COULS     COUEX
     C                     Z-ADD*ZEROS    GRPEX
     C                     Z-ADD*ZEROS    GRPEXR
     C                     MOVE TSSX      TSEXT
     C                     Z-ADDENCRS     ENCEX
     C                     MOVE UVS       UVEXT
     C                     MOVE TVERS     TVEEX
     C                     Z-ADDCVERS     CVEEX
     C                     MOVELORCUS     ORALEX
D2  C           ORCUS     IFNE *BLANKS
     C                     MOVE ORCUS     X1
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALE
X3  C                     ELSE
     C                     MOVE X1        CORALE
F3  C                     END
F2  C                     END
     C                     MOVE ESPES     FLUEX
     C                     Z-ADDCESPES    CFLEX
     C                     Z-ADDENSPS     ESPEX
     C                     MOVE GRAPS     DDEEX
     C                     MOVE APLAS     DAPEX
     C                     Z-ADDOFPA1S    GP1EX
     C                     Z-ADDOFPA2S    GP2EX
D2  C           TREPS     IFNE *ZEROS
     C                     Z-ADDTREPS     RIMPEX
     C                     Z-ADDTREPS     TREPSE
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIER
     C                     Z-ADDRCOUS     COUEXR
     C                     Z-ADDRENCS     ENCEXR
     C                     MOVE RVERS     TVEEXR
     C                     MOVE RETSS     TSEXTR
     C                     Z-ADDRCVES     CVEEXR
     C                     MOVE RESPES    FLUEXR
     C                     Z-ADDRCESPS    CFLEXR
     C                     MOVE RGRAS     DDEEXR
     C                     MOVE RAPLAS    DAPEXR
     C                     Z-ADDROFP1S    GP1EXR
     C                     Z-ADDROFP2S    GP2EXR
X2  C                     ELSE
D3  C           RIMPEX    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    RIMPEX
     C                     Z-ADD*ZEROS    TREPSE
     C                     MOVEL*BLANKS   LIBIER
     C                     Z-ADD*ZEROS    COUEXR
     C                     Z-ADD*ZEROS    ENCEXR
     C                     MOVE *BLANKS   TVEEXR
     C                     MOVE *BLANKS   TSEXTR
     C                     Z-ADD*ZEROS    CVEEXR
     C                     MOVE *BLANKS   FLUEXR
     C                     Z-ADD*ZEROS    CFLEXR
     C                     MOVE *BLANKS   DDEEXR
     C                     MOVE *BLANKS   DAPEXR
     C                     Z-ADD*ZEROS    GP1EXR
     C                     Z-ADD*ZEROS    GP2EXR
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C                     SETOF                     362930
F1  C                     END
    C* 2° PRE-IMPRIME STOCKE
    C*-------------------------
D1  C           NIMPI1    IFNE *BLANKS
    C           NIMPI2    ORNE *BLANKS
     C                     MOVELNIMPI1    NIMP1
     C                     MOVELNIMPI2    NIMP2
     C           CLE2      CHAINPREIMP2              84    MESSAGE 33
    C   84                GOTO TAG11
     C                     ADD  1         NBPAP
     C                     SETON                     373129
     C                     Z-ADDTIMPS     TIMPIN
D2  C           TRAV2     IFEQ 'S'
     C                     MOVE 'C'       COUPIN
F2  C                     END
D2  C           LMINIS    IFGT LUTIL
     C                     Z-ADDLMINIS    LUTIL
F2  C                     END
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIMI
     C                     MOVE PAPIS     PAPII
     C                     Z-ADDGRAMS     GRAMI
     C                     MOVE ADPAPS    REFOUI
     C                     Z-ADDADGRAS    GRAREI
     C                     MOVELCOULDS    COUIN
     C                     MOVE COULS     COUIN
     C                     Z-ADD*ZEROS    GRPIN
     C                     Z-ADD*ZEROS    GRPINR
     C                     MOVE TSSX      TSINT
     C                     Z-ADDENCRS     ENCIN
     C                     MOVE UVS       UVINT
     C                     MOVE TVERS     TVEIN
     C                     Z-ADDCVERS     CVEIN
     C                     MOVELORCUS     ORALIN
D2  C           ORCUS     IFNE *BLANKS
     C                     MOVE ORCUS     X1
D3  C           X1        IFEQ 0
     C                     Z-ADD1         CORALI
X3  C                     ELSE
     C                     MOVE X1        CORALI
F3  C                     END
F2  C                     END
     C                     MOVE ESPES     FLUIN
     C                     Z-ADDCESPES    CFLIN
     C                     Z-ADDENSPS     ESPIN
     C                     MOVE GRAPS     DDEIN
     C                     MOVE APLAS     DAPIN
     C                     Z-ADDOFPA1S    GP1IN
     C                     Z-ADDOFPA2S    GP2IN
D2  C           TREPS     IFNE *ZEROS
     C                     Z-ADDTREPS     RIMPIN
     C                     Z-ADDTREPS     TREPSI
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBIIR
     C                     Z-ADDRCOUS     COUINR
     C                     Z-ADDRENCS     ENCINR
     C                     MOVE RVERS     TVEINR
     C                     MOVE RETSS     TSINTR
     C                     Z-ADDRCVES     CVEINR
     C                     MOVE RESPES    FLUINR
     C                     Z-ADDRCESPS    CFLINR
     C                     MOVE RGRAS     DDEINR
     C                     MOVE RAPLAS    DAPINR
     C                     Z-ADDROFP1S    GP1INR
     C                     Z-ADDROFP2S    GP2INR
X2  C                     ELSE
D3  C           RIMPIN    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    RIMPIN
     C                     Z-ADD*ZEROS    TREPSI
     C                     MOVEL*BLANKS   LIBIIR
     C                     Z-ADD*ZEROS    COUINR
     C                     Z-ADD*ZEROS    ENCINR
     C                     MOVE *BLANKS   TVEINR
     C                     MOVE *BLANKS   TSINTR
     C                     Z-ADD*ZEROS    CVEINR
     C                     MOVE *BLANKS   FLUINR
     C                     Z-ADD*ZEROS    CFLINR
     C                     MOVE *BLANKS   DDEINR
     C                     MOVE *BLANKS   DAPINR
     C                     Z-ADD*ZEROS    GP1INR
     C                     Z-ADD*ZEROS    GP2INR
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C                     SETOF                     373129
F1  C                     END
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     *------------------------------------
     * Pose Accessoires
     *------------------------------------
     * - Contrôler qu'une Pose Accessoires  est demandée
     C                     SETOF                     98
     C                     SETOF                     22
     C           EPOSE     IFNE '*'
     C           EPOSE     ANDNE*BLANK
     C                     SETON                     98
    C                     GOTO TAG11
     C                     ENDIF
     *
     * - Si on ne veut plus de spécificités "POSE", on efface la touche
     * de fonction "F7" et on remet les zones fichier DEVIS à blanc/0
     C           EPOSE     IFEQ *BLANK
     C           *IN40     ANDEQ'1'
     C                     CLEARDSPOSE
     C                     SETOF                     40
    C                     GOTO TAG11
     C                     ENDIF
     *
     C           EPOSE     IFEQ '*'
     * - On ne peut avoir de pose d'accessoire que si le code façonnage est
     * compris entre 6 & 8
     C           FACON     IFLT 6
     C           FACON     ORGT 8
     * - Affichage de la fenêtre d'information comme quoi c'est pas possible
     * en l'état
     C                     SETON                     22
     C                     GOTO TAG11
     C                     ELSE
     * - Permet d'afficher la touche de fonction permettant d'accéder à la
     * gestion des spécificité des "POSE"
     C                     SETON                     40
     * - On passe par cet écran que les caractéristiques d'un accessoire
     * sont vides ou pas; on signale juste qu'on n'est plus premier passage
     C                     MOVEL*BLANK    WCDRET
     C                     EXSR TRTPOS
    C           WCDRET    IFEQ 'PR'
     C                     SETOF                     40
     C                     GOTO TAG11
     C                     ENDIF
     C                     ENDIF
     *
     C                     ENDIF
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C* RAPPORT PAPIER SPECIAUX
    C*-------------------------
     C                     EXSR AVANT2
D1  C           *IN43     IFEQ '0'
     C                     Z-ADD*ZEROS    RASP11
     C                     Z-ADD*ZEROS    RASP21
     C                     Z-ADD*ZEROS    RASP31
     C                     Z-ADD*ZEROS    RASP41
F1  C                     END
D1  C           *IN44     IFEQ '0'
     C                     Z-ADD*ZEROS    RASP12
     C                     Z-ADD*ZEROS    RASP22
     C                     Z-ADD*ZEROS    RASP32
     C                     Z-ADD*ZEROS    RASP42
F1  C                     END
D1  C           *IN45     IFEQ '0'
     C                     Z-ADD*ZEROS    RASP13
     C                     Z-ADD*ZEROS    RASP23
     C                     Z-ADD*ZEROS    RASP33
     C                     Z-ADD*ZEROS    RASP43
F1  C                     END
D1  C           *IN46     IFEQ '0'
     C                     Z-ADD*ZEROS    RASP14
     C                     Z-ADD*ZEROS    RASP24
     C                     Z-ADD*ZEROS    RASP34
     C                     Z-ADD*ZEROS    RASP44
F1  C                     END
D1  C           *IN47     IFEQ '0'
     C                     Z-ADD*ZEROS    RASP15
     C                     Z-ADD*ZEROS    RASP25
     C                     Z-ADD*ZEROS    RASP35
     C                     Z-ADD*ZEROS    RASP45
F1  C                     END
     C                     MOVEA'0000000' *IN,41
    C*-------------------------
D1  C           TIMPEX    IFEQ 1
    C           COUPEX    ANDEQ'R'
    C           TIMPEX    OREQ 2
    C           COUPEX    ANDEQ'R'
    C           TIMPIN    OREQ 1
    C           COUPIN    ANDEQ'R'
    C           TIMPIN    OREQ 2
    C           COUPIN    ANDEQ'R'
     C                     Z-ADD1         IREPE
F1  C                     END
    C*-------------------------
     C                     SETOF                     390905
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
    C           CCOL      OREQ 0                          OU COMPACT
    C           ONDUL     ANDEQ0
    C*          CCOL      OREQ 8         SD: 1419360      OU ACHETE
    C           ONDUL     OREQ 4                          OU NANO
    C           CCOL      OREQ 6                          OU CROISSEES
    C           ICEI3     ANDEQ'O'                        ET : CC + CC
     C                     SETON                     39
     C                     MOVE *BLANKS   TSOND
D2  C           CCOL      IFEQ 0                          COMPACT
    C           ONDUL     ANDEQ0
    C           NCXH      ANDEQ0
    C           IREPE     ANDEQ0
    C           TRAV2     ANDNE'V'
     C                     Z-ADD*ZEROS    LMINI
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     SETON                     0905
     C                     MOVE ' '       PLLOIN  1
D2  C           CCOL      IFEQ 7
D3  C           GRA1      IFLT GRA2
     C                     MOVE '*'       PLLOIN
F3  C                     END
F2  C                     END
D2  C           APPEX     IFEQ 'F'
     C                     MOVE *BLANK    APPEX
F2  C                     END
D2  C           APPIN     IFEQ 'F'
     C                     MOVE *BLANK    APPIN
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 0                          COMPACT
    C           ONDUL     ANDEQ0
     C                     SETON                       05
F1  C                     END
    C*
D1  C           *IN39     IFEQ '1'                        VARIANTE ET
     C                     Z-ADD*ZEROS    POSF2A           MODIF CCOL
     C                     Z-ADD*ZEROS    ACOTE
X1  C                     ELSE
     C                     Z-ADD*ZEROS    FORL
     C                     Z-ADD*ZEROS    FORH
F1  C                     END
    C* AUTRES CONTROLES
    C*-------------------------
     C                     Z-ADDCCOL      CCL
     C           FCCO      LOKUPTABFOC    TABNP          50
D1  C           *IN50     IFEQ '0'
     C                     SETON                     86
    C                     GOTO TAG11                      MESSAGE 34
F1  C                     END
    C*
    C           TABNP     CABNENBPAP     TAG11      8787  MESSAGE 37
    C           NCXH      CABGT2         TAG11      96    MESSAGE 164
D1  C           CCOL      IFEQ 4
    C           NCXH      ANDNE0
    C           CCOL      OREQ 7
    C           NCXH      ANDNE0
     C                     SETON                     96
    C   96                GOTO TAG11                      MESSAGE 164
F1  C                     END
     C           NBPAP     COMP 1                    0707
     C  N07                EXSR BLK3
    C*
D1  C                     SELEC
     C           UVENT     WHEQ 1
    C           UVENT     OREQ 5
D2  C           FACON     IFEQ 1
    C           FACON     OREQ 2
     C                     SETON                     89    MESSAGE 49
    C                     GOTO TAG11
F2  C                     END
     C           UVENT     WHEQ 2
    C           UVENT     OREQ 3
D2  C           FACON     IFGT 2
     C                     SETON                     89    MESSAGE 49
    C                     GOTO TAG11
F2  C                     END
     C           UVENT     WHEQ 4
D2  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
D3  C           FACON     IFGT 4
     C                     SETON                     89    MESSAGE 49
    C                     GOTO TAG11
F3  C                     END
X2  C                     ELSE
D3  C           FACON     IFGT 2
     C                     SETON                     89    MESSAGE 49
    C                     GOTO TAG11
F3  C                     END
F2  C                     END
F1  C                     ENDSL
     C/SPACE 1
    C* SI DEVIS DE PRE-IMPRIME
    C*-------------------------
     C                     SETOF                     02
D1  C           STOCKE    IFNE *BLANK
D2  C           NBPAP     IFNE 1
    C           NIMPE1    ORNE *BLANK
    C           NIMPI1    ORNE *BLANK
    C           ONDUL     ORNE 0
    C           CCOL      ORNE 0
    C           TYPDEV    ORNE 1
     C                     SETON                     97    MESSAGE 14
    C                     GOTO TAG11
F2  C                     END
     C                     SETON                     02
F1  C                     END
    C* SI FSC
    C*-------------------------
     C                     MOVE LIBPR1    Z13AV  13
D1  C           ICEI2     IFEQ '*'
     C                     MOVELOVR,29    Z13    13
     C                     MOVE Z13       LIBPR1
X1  C                     ELSE
D2  C           Z13AV     IFEQ OVR,29
     C                     MOVE *BLANKS   Z13
     C                     MOVE Z13       LIBPR1
F2  C                     END
F1  C                     END
     C/SPACE 3
D1  C           *IN11     IFEQ '1'                        COMMERCIAL
     C                     WRITEFMT2
D2  C           TYPDEV    IFEQ 1
    C           TYPDEV    OREQ 5
    C                     GOTO TAG7
X2  C                     ELSE
    C                     GOTO TAG150
F2  C                     END
F1  C                     END
    C*
D1  C           IN99      IFEQ '0'
     C                     MOVE '1'       IN99
     C                     Z-ADDNF        SNF     10
     C                     Z-ADD1         NNF     10
     C                     MOVELDSSC      SVNC
     C                     MOVE NIMPE1    SIMPE1  4
     C                     MOVE NIMPE2    SIMPE2  4
    C                     GOTO TAG11
F1  C                     END
    C* SI CANNELURES CROISSEES
    C*-------------------------
D1  C           CCOL      IFEQ 6
     C                     EXFMTWCC
D2  C           COUI3     IFEQ 1                          SI: CC + CC
     C                     SETON                     39
X2  C                     ELSE                            SI: OND + CC
     C                     SETOF                     39
     C                     Z-ADD*ZEROS    FORL
     C                     Z-ADD*ZEROS    FORH
F2  C                     END
F1  C                     END
    C* SI BANDE ADHESIVE
    C*-------------------------
D1  C           COSESA    IFEQ 'A'
    C           COSESA    OREQ 'B'
    C           COSESA    OREQ 'C'
    C           COSESA    OREQ 'D'
D2  C           PSBAX     IFEQ *BLANK
     C                     MOVE 'N'       PSBA    1
X2  C                     ELSE
     C                     MOVE PSBAX     PSBA
     C                     MOVE LGBAX     LGBA
F2  C                     END
    C*
     C           SWBA      TAG
     C                     EXFMTWBA
D2  C           LGBA      IFNE *ZEROS
     C                     MOVE PSBA      PSBAX
     C                     MOVE LGBA      LGBAX
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   LGBAX
F1  C                     END
    C* PELLICULAGE/AFFICHAGE
    C*-------------------------
D1  C           UNFOIS    IFEQ ' '
     C                     MOVE '*'       UNFOIS
     C                     Z-ADDNOETU     SVNOEX 100
     C                     Z-ADDSVNOE     NOETU
     C           CLE5      CHAINDEVIS2               50
     C                     Z-ADDSVNOEX    NOETU
D2  C           *IN50     IFEQ '0'
     C                     UPDATDEVIS2F1
F2  C                     END
     C                     Z-ADDSVNOE     NOETU
     C                     MOVE '0000'    NOETU
     C           CLE5      CHAINDEVAMLL1             50
D2  C           *IN50     DOWEQ'0'
     C                     Z-ADDSVNOEX    NOETU
     C                     UPDATDEVAMLF
     C                     Z-ADDSVNOE     NOETU
     C                     MOVE '0000'    NOETU
     C           CLE5      READEDEVAMLL1                 50
F2  C                     END
     C                     Z-ADDSVNOEX    NOETU
F1  C                     END
    C* SI AMALGAMES
    C*-------------------------
     C                     Z-ADD*ZEROS    SOMPOS  30
D1  C           ALMF      IFEQ '*'
     C           CLE5      CHAINDEVAMLL1             50
D2  C           *IN50     DOWEQ'0'
     C                     Z-ADDORD       W       20
     C                     MOVELDESAML    DAML,W
     C                     Z-ADDSSAML     SAML,W
     C                     Z-ADDPPEAML    PAML,W
     C                     Z-ADDPOSCO     NAML,W
     C           CLE5      READEDEVAMLL1                 50
F2  C                     END
     C                     MOVE *BLANKS   ERRAML
     C           SWAML     TAG
     C                     EXFMTWAML
    C           *IN12     CABEQ'1'       TAG11
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       SWAML
     *
D2  C           1         DO   9         W
D3  C           DAML,W    IFEQ *BLANKS
    C           PAML,W    ANDNE*ZEROS
    C           DAML,W    ORNE *BLANKS
    C           PAML,W    ANDEQ*ZEROS
    C           DAML,W    ORNE *BLANKS
    C           NAML,W    ANDEQ*ZEROS
    C           DAML,W    OREQ *BLANKS
    C           NAML,W    ANDNE*ZEROS
     C                     MOVELOVR,33    ERRAML
    C                     GOTO SWAML
F3  C                     END
D3  C           DAML,W    IFEQ *BLANKS
    C           SAML,W    ANDNE*ZEROS
     C                     MOVELOVR,34    ERRAML
    C                     GOTO SWAML
F3  C                     END
F2  C                     END
D2  C           DAML,1    IFEQ *BLANKS
    C           DAML,2    OREQ *BLANKS
     C                     MOVELOVR,35    ERRAML
    C                     GOTO SWAML
F2  C                     END
D2  C           DAML,4    IFNE *BLANKS                    PAS BEAU MAIS..
    C           DAML,3    ANDEQ*BLANKS
    C           DAML,5    ORNE *BLANKS
    C           DAML,4    ANDEQ*BLANKS
    C           DAML,5    ORNE *BLANKS
    C           DAML,3    ANDEQ*BLANKS
    C           DAML,6    ORNE *BLANKS
    C           DAML,5    ANDEQ*BLANKS
    C           DAML,6    ORNE *BLANKS
    C           DAML,4    ANDEQ*BLANKS
    C           DAML,6    ORNE *BLANKS
    C           DAML,3    ANDEQ*BLANKS
    C           DAML,7    ORNE *BLANKS
    C           DAML,6    ANDEQ*BLANKS
    C           DAML,7    ORNE *BLANKS
    C           DAML,5    ANDEQ*BLANKS
    C           DAML,7    ORNE *BLANKS
    C           DAML,4    ANDEQ*BLANKS
    C           DAML,7    ORNE *BLANKS
    C           DAML,3    ANDEQ*BLANKS
    C           DAML,8    ORNE *BLANKS
    C           DAML,7    ANDEQ*BLANKS
    C           DAML,8    ORNE *BLANKS
    C           DAML,6    ANDEQ*BLANKS
    C           DAML,8    ORNE *BLANKS
    C           DAML,5    ANDEQ*BLANKS
    C           DAML,8    ORNE *BLANKS
    C           DAML,4    ANDEQ*BLANKS
    C           DAML,8    ORNE *BLANKS
    C           DAML,3    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,8    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,7    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,6    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,5    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,4    ANDEQ*BLANKS
    C           DAML,9    ORNE *BLANKS
    C           DAML,3    ANDEQ*BLANKS
     C                     MOVELOVR,36    ERRAML
    C                     GOTO SWAML
F2  C                     END
     C                     Z-ADD*ZEROS    SOMPPE  30
D2  C           1         DO   9         W
     C                     ADD  PAML,W    SOMPPE
     C                     ADD  NAML,W    SOMPOS
F2  C                     END
D2  C           SOMPPE    IFNE 100
     C                     MOVELOVR,37    ERRAML
    C                     GOTO SWAML
F2  C                     END
     *
D2  C           1         DO   9         W
     C                     Z-ADDW         ORD
     C           CLE11     CHAINDEVAMLL1             50
D3  C           DAML,W    IFNE *BLANKS
     C                     MOVELDAML,W    DESAML
     C                     Z-ADDSAML,W    SSAML
     C                     Z-ADDPAML,W    PPEAML
     C                     Z-ADDNAML,W    POSCO
     C   50                WRITEDEVAMLF
     C  N50                UPDATDEVAMLF
X3  C                     ELSE
     C  N50                DELETDEVAMLF
F3  C                     END
F2  C                     END
     *
X1  C                     ELSE
     C           CLE5      CHAINDEVAMLL1             50
D2  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C           CLE5      READEDEVAMLL1                 50
F2  C                     END
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   TYPE DE DEVIS                                        *
     *--------------------------------------------------------*
    C* ETIQUETTES
    C*-------------------------
D1  C           TYPDEV    IFEQ 3
D2  C           TRAV2     IFEQ 'S'
    C           TRAV2     OREQ 'V'
     C                     WRITEETIQUET1
X2  C                     ELSE
     C           CLE5      CHAINETIQUET              50
     C  N50                UPDATETIQUET1
F2  C                     END
    C*
D2  C           TRAV2     IFEQ 'S'
     C                     CLEARETIQUET1
     C                     EXSR BLK1
D3  C           TRAV1     IFEQ 'D'                        SAISIE
    C           NO1       ANDNE*BLANK                     MODELE
    C                     GOTO FINPG
X3  C                     ELSE
    C                     GOTO TAG11
F3  C                     END
X2  C                     ELSE
     C                     DELETDEVISF1
     C           CLE5      CHAINDEVIS2               50
     C  N50                DELETDEVIS2F1
     C           CLE5      CHAINDEVAMLL1             50
D3  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C           CLE5      READEDEVAMLL1                 50
F3  C                     END
    C                     GOTO FINPG
F2  C                     END
F1  C                     END
     *
     C                     WRITEFMT2
     C/SPACE 2
D1  C           SIMPE1    IFNE *ZEROS
    C           NIMPE1    ANDEQ*ZEROS
     C                     EXSR BLK2
F1  C                     END
D1  C           SIMPE2    IFNE *ZEROS
    C           NIMPE2    ANDEQ*ZEROS
     C                     EXSR BLK3
F1  C                     END
     C  N30N31             SETOF                     29
    C* SIMPLIFIE
    C*-------------------------
D1  C           TYPDEV    IFEQ 2
D2  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
     C                     Z-ADD0         NNF
    C           NF        CABEQ3         TAG140
    C           NF        CABEQ4         TAG150
F2  C                     END
    C                     GOTO TAG13
F1  C                     END
    C* STANDARD
    C*-------------------------
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
     C                     Z-ADD0         NNF
D2  C           NF        IFEQ 3
D3  C           *IN29     IFEQ '0'
    C                     GOTO TAG5
X3  C                     ELSE
    C                     GOTO TAG40
F3  C                     END
F2  C                     END
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ5         TAG6
    C           NF        CABEQ6         TAG7
F1  C                     END
     C/EJECT
     **********************************************************
     *   DEVIS STANDARD                                       *
     **********************************************************
     C/SPACE 5
     *--------------------------------------------------------*
     *   3° FORMAT - STANDARD                                 *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
    C* DECOUPE NON ASSEMBLÉ ET POIGNEE CHAMPION
D1  C           TYPPOI    IFEQ 'C '
    C           FACON     ANDEQ6
     C                     Z-ADD44        COAS1
F1  C                     END
D1  C           COAS1     IFEQ 44
    C           TYPPOI    ANDNE'C '
    C           FACON     ANDEQ6
     C                     Z-ADD0         COAS1
     C                     MOVE *BLANKS   TYPPCH
F1  C                     END
D1  C           TYPPOI    IFNE 'C '
     C                     MOVE *BLANKS   TYPPCH
F1  C                     END
    C*
     C                     MOVE *BLANKS   CODPT
D1  C           PTDIF     IFNE *BLANKS
     C                     MOVE '*'       CODPT
F1  C                     END
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     * - Mémorisation état indicateur Pose Accessoire "40" du format "FMT1"
     * avant affichage de ce format; l'état sera restauré à l'identique
     * lors du retour au format "FMT1"
     C                     MOVEL'0'       SV40    1
     C   40                MOVEL'1'       SV40
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C*
     C           TAG31     TAG
     *          ---------------
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00'      *IN,48
     C           40        ADD  FACON     IN      20
     C                     MOVEA'1'       *IN,IN
D1  C           ONDUL     IFEQ 3
     C                     SETON                         43
F1  C                     END
     C   38                Z-ADD3         NF
     *
     C                     EXFMTFMT3
    C           *IN03     CABEQ'1'       FINPG
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     * - Restauration de l'état avant en cas de retour écran précédent
     C           *IN12     IFEQ '1'
     C                     MOVELSV40      *IN40
     C                     ENDIF
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C           *IN12     CABEQ'1'       TAG11
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG31
F1  C                     END
     C/SPACE 3
     * VERIFICATION ZONES
     *=========================
D1  C           *IN01     IFEQ '0'                        PAS COMMERCIAL
    C* 1° CONTROLE COMMUN TOUS DEVIS
    C*------------------------------
     C                     EXSR CTLC01
    C   98                GOTO TAG31
    C* COUPE
    C*-------------------------
D2  C           TIMPEX    IFEQ 1
    C           TIMPEX    OREQ 2
    C           TIMPEX    OREQ 3
    C           CCOL      ANDEQ4
    C           TIMPEX    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'COUP'    PXARGU
     C                     MOVE COUPEX    PXVALE    P
     C           CLE3      CHAINPARAME               85    MESSAGE 12
    C   85                GOTO TAG31
X2  C                     ELSE
    C           COUPEX    CABNE*BLANKS   TAG31      8585
F2  C                     END
D2  C           ONDUL     IFEQ 7
    C           TIMPEX    ANDEQ2
    C           COUPEX    ANDNE'C'
     C                     SETON                     85    MESSAGE 12
    C                     GOTO TAG31
F2  C                     END
D2  C           TIMPIN    IFEQ 1
    C           TIMPIN    OREQ 2
    C           TIMPIN    OREQ 3
    C           CCOL      ANDEQ4
    C           TIMPIN    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'COUP'    PXARGU
     C                     MOVE COUPIN    PXVALE    P
     C           CLE3      CHAINPARAME               85    MESSAGE 12
    C   85                GOTO TAG31
X2  C                     ELSE
    C           COUPIN    CABNE*BLANKS   TAG31      8585
F2  C                     END
D2  C           ONDUL     IFEQ 7
    C           TIMPIN    ANDEQ2
    C           COUPIN    ANDNE'C'
     C                     SETON                     85    MESSAGE 12
    C                     GOTO TAG31
F2  C                     END
    C* APPRO EXT. ET INT.
    C*-------------------------
     C                     SETOF                     50
D2  C           CCOL      IFEQ 0                          COMPACT
    C           ONDUL     ANDEQ0                             NEUTRE OU OFFSET
    C           STOCKE    ANDEQ*BLANKS
D3  C           TIMPEX    IFEQ 0
    C           TIMPIN    ANDEQ0
    C           TIMPEX    OREQ 4
    C           TIMPIN    ANDEQ4
    C           TIMPEX    OREQ 4
    C           TIMPIN    ANDEQ0
    C           TIMPEX    OREQ 0
    C           TIMPIN    ANDEQ4
     C                     SETON                     50
F3  C                     END
F2  C                     END
    C*
D2  C           CCOL      IFEQ 1                          CONTRECOLLAGE
    C           CCOL      OREQ 5                          FORMAT/BOBINE
    C           *IN50     OREQ '1'                        COMPACT
    C           NCXH      ANDEQ*ZEROS                     NON CXH
    C           CCOL      OREQ 6                          CAN. CROISSEES
    C           COUI3     ANDEQ1                          CC / CC
D3  C           APPEX     IFEQ *BLANK
    C           APPIN     ANDEQ*BLANK
    C           APPEX     ORNE *BLANK
    C           APPIN     ANDNE*BLANK
    C           CCOL      ANDNE5                          FORMAT/BOBINE
    C           APPEX     OREQ *BLANK
    C           TIMPEX    ANDEQ4
    C           APPIN     OREQ *BLANK
    C           TIMPIN    ANDEQ4
    C           TIMPEX    ANDNE4
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F3  C                     END
X2  C                     ELSE
D3  C           CCOL      IFEQ 4                          PELLICULAGE
    C           FLPEAP    ANDNE*ZEROS
    C           CCOL      OREQ 7
    C           FLPEAP    ANDNE*ZEROS
D4  C           APPEX     IFNE ' '
    C           APPEX     ANDNE'B'
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F4  C                     END
D4  C           CCOL      IFEQ 4                          PELLICULAGE
D5  C           APPIN     IFNE ' '
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F5  C                     END
X4  C                     ELSE
D5  C           APPIN     IFNE ' '
    C           APPIN     ANDNE'B'
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F5  C                     END
F4  C                     END
D4  C           APPEX     IFEQ 'B'
    C           APPIN     ANDEQ'B'
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F4  C                     END
D4  C           APPEX     IFEQ 'B'
    C           PLLOIN    ANDEQ'*'
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F4  C                     END
X3  C                     ELSE
D4  C           APPEX     IFEQ 'F'
    C           APPIN     OREQ 'F'
    C           APPEX     OREQ 'B'
    C           APPIN     OREQ 'B'
     C                     SETON                     8687  MESSAGE 13
    C                     GOTO TAG31
F4  C                     END
F3  C                     END
D3  C           APPEX     IFEQ 'O'
D4  C           TIMPEX    IFNE 4
D5  C           CCOL      IFNE 3
    C           CCOL      ORNE 5
     C                     SETON                     94    MESSAGE 179
    C                     GOTO TAG31
F5  C                     END
F4  C                     END
F3  C                     END
D3  C           APPIN     IFEQ 'O'
D4  C           TIMPIN    IFNE 4
D5  C           CCOL      IFNE 3
    C           CCOL      ORNE 5
     C                     SETON                     94    MESSAGE 179
    C                     GOTO TAG31
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
    C* DIMENSIONS
    C*-------------------------
     C                     SETOF                     98
     C                     MOVELLMINI     LMICM   30       LMINI EN CM
     C           LMINI     MULT 10        LMIMI   40       LMINI EN MM
D2  C           DECL      IFNE *ZEROS
     C           LMIMI     DIV  DECL      NBDL    20       NBR DEC./LAIZE
F2  C                     END
     C           DECL      MULT NBDL      LAIZUT  40       LAIZE UTILE
    C*
D2  C           CCOL      IFEQ 6
D3  C           *IN44     IFEQ '1'
     C                     EXSR DIM4
X3  C                     ELSE
     C                     EXSR CANCRO
F3  C                     END
    C   98                GOTO TAG31
X2  C                     ELSE
     *
D3  C           USINE     IFEQ 5
     C                     EXSR CCHA
    C   98                GOTO TAG31
X3  C                     ELSE
     *
D4  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     EXSR CPLX
    C   98                GOTO TAG31
    C* SI APPRO EN FORMAT : PELLICULEUSE ET NON COMPLEXEUSE
D5  C           FLPEAP    IFNE *ZEROS
     C           TWLP      TAG
     C                     EXFMTWLP
    C           *IN12     CABEQ'1'       TAG31
D6  C           IAEI2     IFEQ ' '
     C           FLPEAP    DIV  10        FLPECM  41
    C           LZPEUT    CABGTLZPEAP    TWLP       51
    C*          LZPEAP    CABLTFLPECM    TWLP         52
X6  C                     ELSE
     C           FHPEAP    DIV  10        FLPECM  41
    C           LZPEUT    CABGTLZPEAP    TWLP       51
    C*          LZPEAP    CABLTFLPECM    TWLP         52
F6  C                     END
F5  C                     END
    C*
X4  C                     ELSE
    C           *IN40     CASEQ'1'       DIM0
    C           *IN41     CASEQ'1'       DIM12
    C           *IN42     CASEQ'1'       DIM12
    C           *IN44     CASEQ'1'       DIM4
    C           *IN46     CASEQ'1'       DIM678
    C           *IN47     CASEQ'1'       DIM678
    C           *IN48     CASEQ'1'       DIM678
    C           *IN49     CASEQ'1'       DIM9
    C                     END
D5  C           *IN45     IFEQ '1'
    C           CCOL      CASEQ2         DIM9
    C           ONDUL     CASEQ7         DIM5A
    C                     CAS            DIM5B
    C                     END
F5  C                     END
    C*
    C   98                GOTO TAG31
F4  C                     END
F3  C                     END
F2  C                     END
    C*
D2  C           DEVIMP    IFGT *ZEROS
    C           DEVIMP    ANDGEONDH
     C                     SETON                     91    MESSAGE 158
    C                     GOTO TAG31
F2  C                     END
    C*
D2  C           LUTIL     IFGT *ZEROS
D3  C           LUTIL     IFLT LMINI
    C           NBPAP     OREQ 1
    C           NCXH      ANDEQ1
     C                     SETON                     92    MESSAGE 157
    C                     GOTO TAG31
F3  C                     END
F2  C                     END
    C* 2° CONTROLE COMMUN TOUS DEVIS
    C*------------------------------
     C                     EXSR CTLC02
    C   98                GOTO TAG31
F1  C                     END
     C/SPACE 3
    C* SI COMPLEXE CXH
    C*------------------------------
D1  C           PAPECX    IFNE *BLANKS
    C           PAPICX    ORNE *BLANKS
    C*
D2  C           PAPECX    IFNE *BLANKS
     C                     EXSR SPCXH1
     C           TAG81     TAG
     C                     EXFMTFMT8
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG31
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARM0
     C                     CALL 'PRODU23£'
     C                     PARM           INTCXH
     C                     WRITEFMT2
    C                     GOTO TAG81
F3  C                     END
     C                     EXSR CTLF8
    C   61                GOTO TAG81
     C                     EXSR SPCXH2
X2  C                     ELSE
     C                     EXSR SPCXH5
F2  C                     END
    C*
D2  C           PAPICX    IFNE *BLANKS
     C                     EXSR SPCXH3
     C           TAG82     TAG
     C                     EXFMTFMT8
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG31
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARM0
     C                     CALL 'PRODU23£'
     C                     PARM           INTCXH
     C                     WRITEFMT2
    C                     GOTO TAG82
F3  C                     END
     C                     EXSR CTLF8
    C   61                GOTO TAG82
     C                     EXSR SPCXH4
X2  C                     ELSE
     C                     EXSR SPCXH6
F2  C                     END
    C*
X1  C                     ELSE
     C                     EXSR SPCXH5
     C                     EXSR SPCXH6
F1  C                     END
     C/SPACE 3
    C* SI DORURE
    C*------------------------------
D1  C           CODDOR    IFEQ '*'
     C                     MOVE *BLANKS   DLIBP1
     C                     MOVE *BLANKS   DLIBP2
     C                     MOVE *BLANKS   LTFF1
     C                     MOVE *BLANKS   LTFF2
     C                     MOVE *BLANKS   LTFF3
     C                     MOVE *BLANKS   LTFF4
     C                     MOVE *BLANKS   LTFF5
     C                     MOVE *BLANKS   LTFF6
     C                     MOVE *BLANKS   LTFF7
     C                     MOVE *BLANKS   LTFF8
     C                     MOVE *BLANKS   LTFF9
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP1
     C                     MOVE DNATP2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP2
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF1
     C                     MOVE DFPXF2    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF2
     C                     MOVE DFPXF3    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF3
     C                     MOVE DFPXF4    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF4
     C                     MOVE DFPXF5    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF5
     C                     MOVE DFPXF6    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF6
     C                     MOVE DFPXF7    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF7
     C                     MOVE DFPXF8    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF8
     C                     MOVE DFPXF9    PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF9
     *
     C                     MOVE *BLANKS   ERRDOR
     C           SWDOR     TAG
     C                     EXFMTWDOR
    C           *IN12     CABEQ'1'       TAG31
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       SWDOR
     *
D2  C           DNATP1    IFNE *BLANKS
D3  C           DDIFP1    IFEQ *BLANKS
     C                     MOVELOVR,23    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,24    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP1
     C                     MOVE '1'       NPDOR   1
X2  C                     ELSE
     C                     MOVELOVR,22    ERRDOR
    C                     GOTO SWDOR
F2  C                     END
    C*
D2  C           DNATP2    IFNE *BLANKS
D3  C           DDIFP2    IFEQ *BLANKS
     C                     MOVELOVR,23    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP2    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,24    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP2
     C                     MOVE '2'       NPDOR
X2  C                     ELSE
D3  C           DDIFP2    IFNE *BLANKS
     C                     MOVELOVR,23    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   DLIBP2
F2  C                     END
     *
D2  C           DFPXF1    IFNE *BLANKS
D3  C           DSFF1     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF1
D3  C           DNPAF1    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
     C                     MOVELOVR,27    ERRDOR
    C                     GOTO SWDOR
F2  C                     END
    C*
D2  C           DFPXF2    IFNE *BLANKS
D3  C           DSFF2     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF2    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF2
D3  C           DNPAF2    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF2     IFNE *ZEROS
    C           DNPAF2    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF2
F2  C                     END
    C*
D2  C           DFPXF3    IFNE *BLANKS
D3  C           DSFF3     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF3    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF3
D3  C           DNPAF3    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF3     IFNE *ZEROS
    C           DNPAF3    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF3
F2  C                     END
    C*
D2  C           DFPXF4    IFNE *BLANKS
D3  C           DSFF4     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF4    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF4
D3  C           DNPAF4    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF4     IFNE *ZEROS
    C           DNPAF4    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF4
F2  C                     END
    C*
D2  C           DFPXF5    IFNE *BLANKS
D3  C           DSFF5     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF5    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF5
D3  C           DNPAF5    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF5     IFNE *ZEROS
    C           DNPAF5    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF5
F2  C                     END
    C*
D2  C           DFPXF6    IFNE *BLANKS
D3  C           DSFF6     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF6    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF6
D3  C           DNPAF6    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF6     IFNE *ZEROS
    C           DNPAF6    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF6
F2  C                     END
    C*
D2  C           DFPXF7    IFNE *BLANKS
D3  C           DSFF7     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF7    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF7
D3  C           DNPAF7    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF7     IFNE *ZEROS
    C           DNPAF7    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF7
F2  C                     END
    C*
D2  C           DFPXF8    IFNE *BLANKS
D3  C           DSFF8     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF8    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF8
D3  C           DNPAF8    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF8     IFNE *ZEROS
    C           DNPAF8    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF8
F2  C                     END
    C*
D2  C           DFPXF9    IFNE *BLANKS
D3  C           DSFF9     IFEQ *ZEROS
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF9    PXVALE    P
     C           CLE3      CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,26    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF9
D3  C           DNPAF9    IFGT NPDOR
     C                     MOVELOVR,28    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF9     IFNE *ZEROS
    C           DNPAF9    ORNE *BLANK
     C                     MOVELOVR,25    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF9
F2  C                     END
     *
F1  C                     END
     C/SPACE 3
    C* SI PEINTURE SUR TRANCHE
    C*------------------------------
D1  C           CODPT     IFEQ '*'
     C                     MOVE *BLANKS   PTERR
     C           SWPT      TAG
     *          ---------------
     C                     EXFMTWPT
    C           *IN12     CABEQ'1'       TAG31
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       SWPT
     *
     C                     MOVE PTENC     XPTEA1
     C                     MOVELXPTEKE    TBVARG
     C                     MOVEL'XPTENCRE'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             50
D2  C           *IN50     IFEQ '1'
     C                     MOVELOVR,38    PTERR
    C                     GOTO SWPT
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   PTDIF
     C                     MOVE *BLANKS   PTENC
     C                     Z-ADD*ZEROS    PTNBR
F1  C                     END
     C/SPACE 3
    C* SI PELLICULAGE
    C*------------------------------
D1  C           CODPEL    IFEQ '*'
D2  C           PAFIL1    IFEQ *BLANKS
     C                     Z-ADD*ZEROS    GRFIL1
     C                     Z-ADD*ZEROS    GFFIL1
F2  C                     END
D2  C           PAFIL2    IFEQ *BLANKS
     C                     Z-ADD*ZEROS    GRFIL2
     C                     Z-ADD*ZEROS    GFFIL2
F2  C                     END
D2  C           CODPP1    IFEQ 'A'
     C                     MOVE 'PL'      COD2P1
F2  C                     END
D2  C           CODPP2    IFEQ 'A'
     C                     MOVE 'PL'      COD2P2
F2  C                     END
     C                     MOVE *BLANKS   ERRPEL
     C           SWPEL     TAG
     *          ---------------
     C                     EXFMTWPEL
    C           *IN12     CABEQ'1'       TAG31
     *
     C                     MOVELPAFIL1    PAPI
     C                     Z-ADDGRFIL1    GRAM
     C                     MOVELREFIL1    REFOUR
     C                     Z-ADDGFFIL1    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C           *IN50     IFEQ '1'
     C                     MOVELOVR,19    ERRPEL
    C                     GOTO SWPEL
F2  C                     END
D2  C           PAFIL2    IFNE *BLANKS
     C                     MOVELPAFIL2    PAPI
     C                     Z-ADDGRFIL2    GRAM
     C                     MOVELREFIL2    REFOUR
     C                     Z-ADDGFFIL1    GRAREL
     C           CLE4      CHAINMATPREL1             50
D3  C           *IN50     IFEQ '1'
     C                     MOVELOVR,20    ERRPEL
    C                     GOTO SWPEL
F3  C                     END
D3  C           LZPUP2    IFEQ *ZEROS
    C           COD2P2    OREQ *BLANKS
    C           DECPP2    OREQ *ZEROS
     C                     MOVELOVR,21    ERRPEL
    C                     GOTO SWPEL
F3  C                     END
X2  C                     ELSE
D3  C           LZPUP2    IFNE *ZEROS
    C           COD2P2    ORNE *BLANKS
    C           DECPP2    ORNE *ZEROS
     C                     MOVELOVR,21    ERRPEL
    C                     GOTO SWPEL
F3  C                     END
F2  C                     END
     *
D2  C           COD2P1    IFEQ 'PL'
     C                     MOVE 'A'       CODPP1
F2  C                     END
D2  C           COD2P2    IFEQ 'PL'
     C                     MOVE 'A'       CODPP2
F2  C                     END
F1  C                     END
     C/SPACE 3
    C* SI AFFICHAGE
    C*------------------------------
D1  C           AFFI      IFEQ '*'
     C                     MOVE *BLANK    PELLIX
     C                     MOVE AFFI      AFFIX
     C                     CALL 'DEV013£'
     C                     PARM           DEV013
F1  C                     END
     C/SPACE 3
    C           TIMPEX    CASEQ*ZERO     BLK2
    C                     END
    C           TIMPIN    CASEQ*ZERO     BLK3
    C                     END
     C  N30N31             SETOF                     29
    C*
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
     C                     MOVE 'O'       PARM0
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG31
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ5         TAG6
    C           NF        CABEQ6         TAG7
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   4° FORMAT - STANDARD - IMPRESSION                    *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG40     TAG
    C*          ---------------
     C                     SETOF                     293031
     C                     SETOF                     1718
D1  C           TIMPEX    IFNE *ZERO
    C           TIMPIN    ORNE *ZEROS
     *
D2  C           *IN01     IFEQ '1'                        COMMERCIAL
     C                     MOVE TVEEX     TVERES  1
     C                     MOVE TVEEXR    RVERES  1
     C                     MOVE TVEIN     TVERIS  1
     C                     MOVE TVEINR    RVERIS  1
     C                     Z-ADDCOUEX     SCOUEX  20
     C                     Z-ADDCOUIN     SCOUIN  20
     C                     Z-ADDCOUEXR    SCOUER  20
     C                     Z-ADDCOUINR    SCOUIR  20
     C           RIMPEX    COMP 0                        17
     C           RIMPIN    COMP 0                        18
F2  C                     END
     C           TREPSE    COMP 0                    1717
     C           TREPSI    COMP 0                    1818
    C* IMPRIME EXTERIEUR
    C*-------------------------
     C                     SETON                     29
D2  C           TIMPEX    IFNE *ZEROS
     C                     SETON                     30
D3  C           TIMPEX    IFEQ 3
    C           TIMPEX    OREQ 2
     C                     Z-ADD3         USEXT
F3  C                     END
F2  C                     END
    C* IMPRIME INTERIEUR
    C*-------------------------
D2  C           TIMPIN    IFNE *ZEROS
     C                     SETON                     31
D3  C           TIMPIN    IFEQ 3
    C           TIMPIN    OREQ 2
     C                     Z-ADD3         USINT
F3  C                     END
F2  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUIE
     C                     MOVE USINT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUII
     *
     C           TAG41     TAG
    C*          ---------------
     C   38                Z-ADD4         NF
     C                     EXFMTFMT4
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG31
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D2  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG41
F2  C                     END
     C/SPACE 5
    C*          *IN01     IFEQ '1'                        COMMERCIAL
    C*                    EXSR CTLIC
    C*  98                GOTO TAG41
    C*                    ELSE
     *--------------------------------------------------------*
     *   IMPRESSION EXTERIEUR PRINCIPALE                      *
     *--------------------------------------------------------*
D2  C           TIMPEX    IFNE *ZEROS
    C           *IN36     ANDNE'1'
    C* USINE
    C*-------------------------
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               51
     C  N51      PXMONT    COMP 999                      51
    C   51                GOTO TAG41                      MESSAGE 70
     C                     MOVELPXLIBE    LIBUIE
    C*
     C                     MOVE TIMPEX    XTIMA1
     C                     MOVE USEXT     XTIMA2
     C                     MOVELXTIMKE    TBVARG
     C                     MOVEL'XTIMPUSI'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             51
    C   51                GOTO TAG41                      MESSAGE 70
    C*
D3  C           TIMPEX    IFEQ 3
D4  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
D5  C           USEXT     IFNE 2
     C                     SETON                     51    MESSAGE 70
    C                     GOTO TAG41
F5  C                     END
F4  C                     END
F3  C                     END
    C*
D3  C           TIMPEX    IFEQ 4
D4  C           FACON     IFEQ 1
    C           FACON     OREQ 2
    C           FACON     OREQ 9
     C                     SETON                     51    MESSAGE 70
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D3  C           COUEX     IFEQ *ZEROS
    C           ENCEX     ANDNE*ZEROS
    C           COUEX     ORNE *ZEROS
    C           ENCEX     ANDEQ*ZEROS
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG41
F3  C                     END
D3  C           TIMPEX    IFEQ 3
D4  C           COUEX     IFEQ *ZERO
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG41
F4  C                     END
D4  C           CCOL      IFEQ 4
    C           COUEX     ANDGT2
    C           CCOL      OREQ 7
    C           COUEX     ANDGT2
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
    C*          TIMPEX    IFEQ 5
    C*          COUEX     IFGT 3
    C*                    SETON                     53    MESSAGE 72
    C*                    GOTO TAG41
    C*                    END
    C*                    END
     C/SPACE 2
    C* ENCRE OU VERNIS OU OR/ALU OBLIGATOIRE
    C*--------------------------------------
D3  C           COUEX     IFEQ *ZEROS
    C           TVEEX     ANDEQ*BLANKS
    C           ORALEX    ANDEQ*BLANKS
     C                     SETON                     91    MESSAGE 149
    C                     GOTO TAG41
F3  C                     END
     C                     Z-ADDCOUEX     GPEX    20
     C/SPACE 2
    C* TRAIT OU SELECTION EXT
    C*-------------------------
D3  C           TSEXT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XTRAA1
     C                     MOVE TSEXT     XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             55    MESSAGE 74
    C           *IN55     CABEQ'1'       TAG41
X3  C                     ELSE
    C           TIMPEX    CABEQ1         TAG41          55MESSAGE 74
F3  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D3  C           GRPEX     IFNE *ZEROS
    C           GRPEX     ANDLTCOUEX
     C                     SETON                     23    MESSAGE 150
    C                     GOTO TAG41
F3  C                     END
D3  C           GRPEX     IFNE *ZEROS
     C                     Z-ADDGRPEX     GPEX    20
X3  C                     ELSE
     C                     Z-ADDCOUEX     GPEX    20
F3  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D3  C           UVEXT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XENCA1
     C                     MOVE UVEXT     XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             57    MESSAGE 76
    C           *IN57     CABEQ'1'       TAG41
F3  C                     END
     C/SPACE 2
    C* NATURE ENCRE
    C*-------------------------
D3  C           NATEX     IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATEX     PXVALE    P
     C           CLE3      CHAINPARAME               57    MESSAGE 76
    C           *IN57     CABEQ'1'       TAG41
F3  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D3  C           TVEEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             59    MESSAGE 78
    C           *IN59     CABEQ'1'       TAG41
    C           CVEEX     CABEQ*ZEROS    TAG41          59MESSAGE 78
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPEX
X3  C                     ELSE
    C           CVEEX     CABNE*ZEROS    TAG41      5959  MESSAGE 78
F3  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D3  C           ORALEX    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XORCA1
     C                     MOVE ORALEX    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             61    MESSAGE 80
    C           *IN61     CABEQ'1'       TAG41
    C           CORALE    CABEQ*ZEROS    TAG41          61MESSAGE 80
    C           CORALE    CABGT1         TAG41      61  61MESSAGE 80
     C                     ADD  1         GPEX
X3  C                     ELSE
    C           CORALE    CABNE*ZEROS    TAG41      6161  MESSAGE 80
F3  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D3  C           FLUEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XFLUA1
     C                     MOVE FLUEX     XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             63    MESSAGE 82
    C           *IN63     CABEQ'1'       TAG41
    C           CFLEX     CABEQ*ZEROS    TAG41          63MESSAGE 82
X3  C                     ELSE
    C           CFLEX     CABNE*ZEROS    TAG41      6363  MESSAGE 82
F3  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D3  C           VSPEX     IFNE *ZEROS
    C           TVEEX     ANDEQ*BLANKS
     C                     SETON                     95
    C                     GOTO TAG41                      MESSAGE 151
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D3  C           DDEEX     IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEEX     PXVALE    P
     C           CLE3      CHAINPARAME               65
    C   65                GOTO TAG41                      MESSAGE 84
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D3  C           DAPEX     IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPEX     PXVALE    P
     C           CLE3      CHAINPARAME               67
    C   67                GOTO TAG41                      MESSAGE 86
    C           TIMPEX    CABNE4         TAG41      6767  MESSAGE 86
F3  C                     END
     C/SPACE 2
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*---------------------------------------
D3  C           TIMPEX    IFEQ 4
    C           TIMPEX    OREQ 2
D4  C           GP1EX     IFEQ *ZEROS
    C           GP2EX     ANDNE*ZEROS
    C           GP1EX     OREQ *ZEROS
    C           GP3EX     ANDNE*ZEROS
    C           GP2EX     OREQ *ZEROS
    C           GP3EX     ANDNE*ZEROS
     C                     SETON                     71    MESSAGE 90
    C                     GOTO TAG41
F4  C                     END
     C           GP1EX     ADD  GP2EX     GPT     20
     C                     ADD  GP3EX     GPT
D4  C           GPT       IFGT GPEX
     C                     SETON                     71    MESSAGE 90
    C                     GOTO TAG41
F4  C                     END
X3  C                     ELSE
D4  C           GP1EX     IFNE *ZEROS
    C           GP2EX     ORNE *ZEROS
    C           GP3EX     ORNE *ZEROS
     C                     SETON                     71    MESSAGE 90
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D3  C           MATEC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATEC     PXVALE    P
     C           CLE3      CHAINPARAME               69
    C   69                GOTO TAG41                      MESSAGE 88
     C                     MOVELPXLIBE    LIBME
F3  C                     END
     C/SPACE 1
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION EXTERIEUR REPIQUAGE                       *
     *--------------------------------------------------------*
D2  C           TIMPEX    IFNE *ZEROS
    C* TYPE IMPRESSION
    C*-------------------------
D3  C           RIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               73    MESSAGE 92
    C   73                GOTO TAG41
     C                     MOVELPXLIBE    LIBIER
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D4  C           COUEXR    IFEQ *ZEROS
    C           ENCEXR    ANDNE*ZEROS
    C           COUEXR    ORNE *ZEROS
    C           ENCEXR    ANDEQ*ZEROS
     C                     SETON                     74    MESSAGE 93
    C                     GOTO TAG41
F4  C                     END
D4  C           COUEXR    IFEQ *ZERO
    C           RIMPEX    ANDEQ3
     C                     SETON                     74    MESSAGE 93
    C                     GOTO TAG41
F4  C                     END
    C*          RIMPEX    IFEQ 5
    C*          COUEXR    IFGT 3
    C*                    SETON                     74    MESSAGE 93
    C*                    GOTO TAG41
    C*                    END
    C*                    END
     C/SPACE 2
    C* ENCRE OU VERNIS OBIGATOIRE
    C*----------------------------
D4  C           COUEXR    IFEQ *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     92    MESSAGE 149
    C                     GOTO TAG41
F4  C                     END
     C/SPACE 2
    C* TRAIT OU SELECTION
    C*-------------------------
D4  C           TSEXTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XTRAA1
     C                     MOVE TSEXTR    XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             75    MESSAGE 93
    C           *IN75     CABEQ'1'       TAG41
X4  C                     ELSE
    C           RIMPEX    CABEQ1         TAG41          75MESSAGE 93
F4  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D4  C           GRPEXR    IFNE *ZEROS
    C           GRPEXR    ANDLTCOUEXR
     C                     SETON                     24    MESSAGE 150
    C                     GOTO TAG41
F4  C                     END
D4  C           GRPEXR    IFNE *ZEROS
     C                     Z-ADDGRPEXR    GPEXR   20
X4  C                     ELSE
     C                     Z-ADDCOUEXR    GPEXR
F4  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D4  C           UVEXTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XENCA1
     C                     MOVE UVEXTR    XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             76    MESSAGE 95
    C           *IN76     CABEQ'1'       TAG41
F4  C                     END
    C* NATURE ENCRE
    C*-------------------------
D4  C           NATEXR    IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATEXR    PXVALE    P
     C           CLE3      CHAINPARAME               76    MESSAGE 95
    C           *IN76     CABEQ'1'       TAG41
F4  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D4  C           TVEEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             77    MESSAGE 96
    C           *IN77     CABEQ'1'       TAG41
    C           CVEEXR    CABEQ*ZEROS    TAG41          77MESSAGE 96
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPEXR
X4  C                     ELSE
    C           CVEEXR    CABNE*ZEROS    TAG41      7777  MESSAGE 96
F4  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D4  C           ORAEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XORCA1
     C                     MOVE ORAEXR    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             19    MESSAGE 152
    C           *IN19     CABEQ'1'       TAG41
    C           CORAER    CABEQ*ZEROS    TAG41          19MESSAGE 152
    C           CORAER    CABGT1         TAG41      19  19MESSAGE 152
     C                     ADD  1         GPEXR
X4  C                     ELSE
    C           CORAER    CABNE*ZEROS    TAG41      1919  MESSAGE 152
F4  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D4  C           FLUEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XFLUA1
     C                     MOVE FLUEXR    XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             21    MESSAGE 154
    C           *IN21     CABEQ'1'       TAG41
    C           CFLEXR    CABEQ*ZEROS    TAG41          21MESSAGE 154
X4  C                     ELSE
    C           CFLEXR    CABNE*ZEROS    TAG41      2121  MESSAGE 154
F4  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D4  C           VSPEXR    IFNE *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     23
    C                     GOTO TAG41                      MESSAGE 151
F4  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D4  C           DDEEXR    IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEEXR    PXVALE    P
     C           CLE3      CHAINPARAME               78
    C   78                GOTO TAG41                      MESSAGE 97
F4  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D4  C           DAPEXR    IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPEXR    PXVALE    P
     C           CLE3      CHAINPARAME               79
    C   79                GOTO TAG41                      MESSAGE 98
    C           RIMPEX    CABNE4         TAG41      7979  MESSAGE 98
F4  C                     END
     C/SPACE 2
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*---------------------------------------
D4  C           RIMPEX    IFEQ 4
    C           RIMPEX    OREQ 2
D5  C           GP1EXR    IFEQ *ZEROS
    C           GP2EXR    ANDNE*ZEROS
     C                     SETON                     80    MESSAGE 99
    C                     GOTO TAG41
F5  C                     END
     C           GP1EXR    ADD  GP2EXR    GPT     20
D5  C           GPT       IFGT GPEXR
     C                     SETON                     80    MESSAGE 99
    C                     GOTO TAG41
F5  C                     END
X4  C                     ELSE
D5  C           GP1EXR    IFNE *ZEROS
    C           GP2EXR    ORNE *ZEROS
     C                     SETON                     80    MESSAGE 99
    C                     GOTO TAG41
F5  C                     END
F4  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D4  C           MATERC    IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATERC    PXVALE    P
     C           CLE3      CHAINPARAME               81
    C   81                GOTO TAG41                      MESSAGE 100
     C                     MOVELPXLIBE    LIBMER
F4  C                     END
     C/SPACE 1
X3  C                     ELSE
D4  C           COUEXR    IFNE *ZEROS
    C           TVEEXR    ORNE *BLANKS
     C                     SETON                     92    MESSAGE 149
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION INTERIEURE PRINCIPALE                     *
     *--------------------------------------------------------*
D2  C           TIMPIN    IFNE *ZEROS
    C           *IN37     ANDNE'1'
    C* USINE
    C*-------------------------
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USINT     PXVALE    P
     C           CLE3      CHAINPARAME               52
     C  N52      PXMONT    COMP 999                      52
    C   52                GOTO TAG41                      MESSAGE 71
     C                     MOVELPXLIBE    LIBUII
    C*
     C                     MOVE TIMPIN    XTIMA1
     C                     MOVE USINT     XTIMA2
     C                     MOVELXTIMKE    TBVARG
     C                     MOVEL'XTIMPUSI'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             52
    C   52                GOTO TAG41                      MESSAGE 71
    C*
D3  C           TIMPIN    IFEQ 3
D4  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
D5  C           USINT     IFNE 2
     C                     SETON                     52    MESSAGE 71
    C                     GOTO TAG41
F5  C                     END
F4  C                     END
F3  C                     END
    C*
D3  C           TIMPIN    IFEQ 4
D4  C           FACON     IFEQ 1
    C           FACON     OREQ 2
    C           FACON     OREQ 9
     C                     SETON                     52    MESSAGE 71
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D3  C           COUIN     IFEQ *ZEROS
    C           ENCIN     ANDNE*ZEROS
    C           COUIN     ORNE *ZEROS
    C           ENCIN     ANDEQ*ZEROS
     C                     SETON                     54    MESSAGE 73
    C                     GOTO TAG41
F3  C                     END
D3  C           TIMPIN    IFEQ 3
D4  C           COUIN     IFEQ *ZERO
     C                     SETON                     54    MESSAGE 73
    C                     GOTO TAG41
F4  C                     END
D4  C           CCOL      IFEQ 4
    C           COUIN     ANDGT2
    C           CCOL      OREQ 7
    C           COUIN     ANDGT2
     C                     SETON                     54    MESSAGE 73
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
    C*          TIMPIN    IFEQ 5
    C*          COUIN     IFGT 3
    C*                    SETON                     54    MESSAGE 73
    C*                    GOTO TAG41
    C*                    END
    C*                    END
     C/SPACE 2
    C* ENCRE OU VERNIS OU OR/ALU OBLIGATOIRE
    C*----------------------------
D3  C           COUIN     IFEQ *ZEROS
    C           TVEIN     ANDEQ*BLANKS
    C           ORALIN    ANDEQ*BLANKS
     C                     SETON                     93    MESSAGE 149
    C                     GOTO TAG41
F3  C                     END
     C/SPACE 2
    C* TRAIT OU SELECTION
    C*-------------------------
D3  C           TSINT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XTRAA1
     C                     MOVE TSINT     XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             56
    C           *IN56     CABEQ'1'       TAG41            MESSAGE 75
X3  C                     ELSE
    C           TIMPIN    CABEQ1         TAG41          56MESSAGE 75
F3  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D3  C           GRPIN     IFNE *ZEROS
    C           GRPIN     ANDLTCOUIN
     C                     SETON                     97    MESSAGE 150
    C                     GOTO TAG41
F3  C                     END
D3  C           GRPIN     IFNE *ZEROS
     C                     Z-ADDGRPIN     GPIN    20
X3  C                     ELSE
     C                     Z-ADDCOUEX     GPEX    20
F3  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D3  C           UVINT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XENCA1
     C                     MOVE UVINT     XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             58    MESSAGE 77
    C           *IN58     CABEQ'1'       TAG41
F3  C                     END
    C* NATURE ENCRE
    C*-------------------------
D3  C           NATIN     IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATIN     PXVALE    P
     C           CLE3      CHAINPARAME               58    MESSAGE 77
    C           *IN58     CABEQ'1'       TAG41
F3  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D3  C           TVEIN     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XVERA1
     C                     MOVE TVEIN     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             60    MESSAGE 79
    C           *IN60     CABEQ'1'       TAG41
    C           CVEIN     CABEQ*ZEROS    TAG41          60MESSAGE 79
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPIN
X3  C                     ELSE
    C           CVEIN     CABNE*ZEROS    TAG41      6060  MESSAGE 79
F3  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D3  C           ORALIN    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XORCA1
     C                     MOVE ORALIN    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             62    MESSAGE 81
    C           *IN62     CABEQ'1'       TAG41
    C           CORALI    CABEQ*ZEROS    TAG41          62MESSAGE 81
    C           CORALI    CABGT1         TAG41      62  62MESSAGE 81
     C                     ADD  1         GPIN
X3  C                     ELSE
    C           CORALI    CABNE*ZEROS    TAG41      6262  MESSAGE 81
F3  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D3  C           FLUIN     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XFLUA1
     C                     MOVE FLUIN     XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             64    MESSAGE 83
    C           *IN64     CABEQ'1'       TAG41
    C           CFLIN     CABEQ*ZEROS    TAG41          64MESSAGE 83
X3  C                     ELSE
    C           CFLIN     CABNE*ZEROS    TAG41      6464  MESSAGE 83
F3  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D3  C           VSPIN     IFNE *ZEROS
    C           TVEIN     ANDEQ*BLANKS
     C                     SETON                     96
    C                     GOTO TAG41                      MESSAGE 151
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D3  C           DDEIN     IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEIN     PXVALE    P
     C           CLE3      CHAINPARAME               66
    C   66                GOTO TAG41                      MESSAGE 85
F3  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D3  C           DAPIN     IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPIN     PXVALE    P
     C           CLE3      CHAINPARAME               68
    C   68                GOTO TAG41                      MESSAGE 87
    C           TIMPIN    CABNE4         TAG41      6868  MESSAGE 87
F3  C                     END
     C/SPACE 2
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*--------------------------------------
D3  C           TIMPIN    IFEQ 4
    C           TIMPIN    OREQ 2
D4  C           GP1IN     IFEQ *ZEROS
    C           GP2IN     ANDNE*ZEROS
    C           GP1IN     OREQ *ZEROS
    C           GP3IN     ANDNE*ZEROS
    C           GP2IN     OREQ *ZEROS
    C           GP3IN     ANDNE*ZEROS
     C                     SETON                     72    MESSAGE 91
    C                     GOTO TAG41
F4  C                     END
     C           GP1IN     ADD  GP2IN     GPT     20
     C                     ADD  GP2IN     GPT
D4  C           GPT       IFGT GPIN
     C                     SETON                     72    MESSAGE 91
    C                     GOTO TAG41
F4  C                     END
X3  C                     ELSE
D4  C           GP1IN     IFNE *ZEROS
    C           GP2IN     ORNE *ZEROS
    C           GP3IN     ORNE *ZEROS
     C                     SETON                     72    MESSAGE 91
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D3  C           MATIC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATIC     PXVALE    P
     C           CLE3      CHAINPARAME               70
    C   70                GOTO TAG31                      MESSAGE 89
     C                     MOVELPXLIBE    LIBMI
F3  C                     END
     C/SPACE 1
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION INTERIEUR REPIQUAGE                       *
     *--------------------------------------------------------*
D2  C           TIMPIN    IFNE *ZEROS
    C* TYPE IMPRESSION
    C*-------------------------
D3  C           RIMPIN    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               82    MESSAGE 101
    C   82                GOTO TAG41
     C                     MOVELPXLIBE    LIBIIR
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D4  C           COUINR    IFEQ *ZEROS
    C           ENCINR    ANDNE*ZEROS
    C           COUINR    ORNE *ZEROS
    C           ENCINR    ANDEQ*ZEROS
     C                     SETON                     83    MESSAGE 102
    C                     GOTO TAG41
F4  C                     END
D4  C           COUINR    IFEQ *ZERO
    C           RIMPIN    ANDEQ3
     C                     SETON                     83    MESSAGE 102
    C                     GOTO TAG41
F4  C                     END
    C*          RIMPIN    IFEQ 5
    C*          COUINR    IFGT 3
    C*                    SETON                     83    MESSAGE 102
    C*                    GOTO TAG41
    C*                    END
    C*                    END
     C/SPACE 2
    C* ENCRE OU VERNIS OBIGATOIRE
    C*----------------------------
D4  C           COUINR    IFEQ *ZEROS
    C           TVEINR    ANDEQ*BLANKS
     C                     SETON                     94    MESSAGE 149
    C                     GOTO TAG41
F4  C                     END
     C/SPACE 2
    C* TRAIT OU SELECTION
    C*-------------------------
D4  C           TSINTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XTRAA1
     C                     MOVE TSINTR    XTRAA2
     C                     MOVELXTRAKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XTRAISEL'TBLNOM
     C           KTBA01    CHAINXTBASE01             84    MESSAGE 103
    C           *IN84     CABEQ'1'       TAG41
X4  C                     ELSE
    C           RIMPIN    CABEQ1         TAG41          84MESSAGE 103
F4  C                     END
     C/SPACE 2
    C* NOMBRE DE GROUPE
    C*-------------------------
D4  C           GRPINR    IFNE *ZEROS
    C           GRPINR    ANDLTCOUINR
     C                     SETON                     98    MESSAGE 150
    C                     GOTO TAG41
F4  C                     END
D4  C           GRPINR    IFNE *ZEROS
     C                     Z-ADDGRPINR    GPINR   20
X4  C                     ELSE
     C                     Z-ADDCOUINR    GPINR   20
F4  C                     END
     C/SPACE 2
    C* TYPE ENCRE
    C*-------------------------
D4  C           UVINTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XENCA1
     C                     MOVE UVINTR    XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             85    MESSAGE 104
    C           *IN85     CABEQ'1'       TAG41
F4  C                     END
    C* NATURE ENCRE
    C*-------------------------
D4  C           NATINR    IFNE *BLANKS
     C                     MOVEL'ENCR'    PXARGU
     C                     MOVE NATINR    PXVALE    P
     C           CLE3      CHAINPARAME               85    MESSAGE 104
    C           *IN85     CABEQ'1'       TAG41
F4  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D4  C           TVEINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE TVEINR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             86    MESSAGE 105
    C           *IN86     CABEQ'1'       TAG41
    C           CVEINR    CABEQ*ZEROS    TAG41          86MESSAGE 105
     C                     MOVELTBVRES    XVER00
     C                     ADD  XVER05    GPINR
X4  C                     ELSE
    C           CVEINR    CABNE*ZEROS    TAG41      8686  MESSAGE 105
F4  C                     END
     C/SPACE 2
    C* OR CUIVRE ALU
    C*-------------------------
D4  C           ORAINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XORCA1
     C                     MOVE ORAINR    XORCA2
     C                     MOVELXORCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XORCUALU'TBLNOM
     C           KTBA01    CHAINXTBASE01             20    MESSAGE 153
    C           *IN20     CABEQ'1'       TAG41
    C           CORAIR    CABEQ*ZEROS    TAG41          20MESSAGE 153
    C           CORAIR    CABGT1         TAG41      20  20MESSAGE 153
     C                     ADD  1         GPEXR
X4  C                     ELSE
    C           CORAIR    CABNE*ZEROS    TAG41      2020  MESSAGE 153
F4  C                     END
     C/SPACE 2
    C* FLUO
    C*-------------------------
D4  C           FLUINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XFLUA1
     C                     MOVE FLUINR    XFLUA2
     C                     MOVELXFLUKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XFLUOSSS'TBLNOM
     C           KTBA01    CHAINXTBASE01             22    MESSAGE 155
    C           *IN22     CABEQ'1'       TAG41
    C           CFLINR    CABEQ*ZEROS    TAG41          22MESSAGE 155
X4  C                     ELSE
    C           CFLINR    CABNE*ZEROS    TAG41      2222  MESSAGE 155
F4  C                     END
     C/SPACE 2
    C* MAJORATION VERNIS
    C*-------------------------
D4  C           VSPINR    IFNE *ZEROS
    C           TVEINR    ANDEQ*BLANKS
     C                     SETON                     24
    C                     GOTO TAG41                      MESSAGE 151
F4  C                     END
     C/SPACE 2
    C* DIFFICULTE DECOR
    C*-------------------------
D4  C           DDEINR    IFNE *BLANKS
     C                     MOVEL'DDEC'    PXARGU
     C                     MOVE DDEINR    PXVALE    P
     C           CLE3      CHAINPARAME               87
    C   87                GOTO TAG41                      MESSAGE 106
F4  C                     END
     C/SPACE 2
    C* DIFFICULTE APLAT
    C*-------------------------
D4  C           DAPINR    IFNE *BLANKS
     C                     MOVEL'APLA'    PXARGU
     C                     MOVE DAPINR    PXVALE    P
     C           CLE3      CHAINPARAME               88
    C   88                GOTO TAG41                      MESSAGE 107
    C           RIMPIN    CABNE4         TAG41      8888  MESSAGE 107
F4  C                     END
     C/SPACE 2
    C* GROUPE PASSAGE OFFSET OU VERNIS FLEXO
    C*--------------------------------------
D4  C           RIMPIN    IFEQ 4
    C           RIMPIN    OREQ 2
D5  C           GP1INR    IFEQ *ZEROS
    C           GP2INR    ANDNE*ZEROS
     C                     SETON                     89    MESSAGE 108
    C                     GOTO TAG41
F5  C                     END
     C           GP1INR    ADD  GP2INR    GPT     20
D5  C           GPT       IFGT GPINR
     C                     SETON                     89    MESSAGE 108
    C                     GOTO TAG41
F5  C                     END
X4  C                     ELSE
D5  C           GP1INR    IFNE *ZEROS
    C           GP2INR    ORNE *ZEROS
     C                     SETON                     89    MESSAGE 108
    C                     GOTO TAG41
F5  C                     END
F4  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D4  C           MATIRC    IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATIRC    PXVALE    P
     C           CLE3      CHAINPARAME               90
    C   90                GOTO TAG41                      MESSAGE 108
     C                     MOVELPXLIBE    LIBMIR
F4  C                     END
     C/SPACE 1
X3  C                     ELSE
D4  C           COUINR    IFNE *ZEROS
    C           TVEINR    ORNE *BLANKS
     C                     SETON                     94    MESSAGE 149
    C                     GOTO TAG41
F4  C                     END
F3  C                     END
F2  C                     END
     *
F1  C                     END
    C*
    C* Affichage d'une fenetre si format Offset non standard
     C                     EXSR CTLOFF
    C*                    END
     C/SPACE 3
    C*
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG31
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ5         TAG6
    C           NF        CABEQ6         TAG7
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   5° FORMAT - STANDARD                                 *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG5      TAG
    C*          ---------------
     C                     SETOF                     323334
     C                     SETOF                     352349
    C* FENETRE
    C*-------------------------
D1  C           TYPFEN    IFNE *BLANKS
     C                     SETON                     3233
F1  C                     END
    C* 1° ASSEMBLAGE
    C*-------------------------
D1  C           COAS1     IFNE *ZEROS
     C                     SETON                     3234
D2  C           COAS1     IFEQ 44
     C                     SETON                     49
F2  C                     END
F1  C                     END
    C* 2° ASSEMBLAGE
    C*-------------------------
D1  C           COAS2     IFNE *ZEROS
     C                     SETON                     3235
D2  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     C                     SETON                     23
F2  C                     END
F1  C                     END
    C* POIGNEE CHAMPION
    C*-------------------------
D1  C           TYPPO1    IFEQ 'C'
     C                     MOVE NBPCHA    NBRPCH
     C                     SETON                     49
     C           TYPPCH    CHAINPOIGNEL1             50
     C  N50                MOVELDESIG     LIBPCH
F1  C                     END
     *
     C           TAG51     TAG
    C*          ---------------
     C           TYPFE1    COMP 'L'                      18
     C   38                Z-ADD5         NF
     C                     EXFMTFMT5
    C           *IN03     CABEQ'1'       FINPG
D1  C           *IN12     IFEQ '1'
    C           *IN29     CABEQ'1'       TAG40
    C                     GOTO TAG31
F1  C                     END
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG51
F1  C                     END
     C/SPACE 5
D1  C           *IN01     IFEQ '0'                        PAS COMMERCIAL
     *--------------------------------------------------------*
     *   CONTROLE FENETRE                                     *
     *--------------------------------------------------------*
D2  C           *IN33     IFEQ '1'
     *
D3  C           TYPFE1    IFEQ 'L'
     C                     Z-ADD0         LONFEN
     C                     Z-ADD0         LARFEN
D4  C           PASFE     IFEQ *ZEROS
     C                     SETON                     51    MESSAGE 110
    C   51                GOTO TAG51
F4  C                     END
X3  C                     ELSE
D4  C           LONFEN    IFEQ *ZEROS
    C           LARFEN    OREQ *ZEROS
    C           PASFE     OREQ *ZEROS
     C                     SETON                     51    MESSAGE 110
    C   51                GOTO TAG51
F4  C                     END
     *
F3  C                     END
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE 1° ASSEMBLAGE                               *
     *--------------------------------------------------------*
D2  C           *IN34     IFEQ '1'
     *
D3  C           PLIA1     IFNE *BLANKS
     C                     MOVEL'DPLI'    PXARGU
     C                     MOVE PLIA1     PXVALE    P
     C           CLE3      CHAINPARAME               58
    C   58                GOTO TAG51                      MESSAGE 15
F3  C                     END
    C*
D3  C           COAS1     IFEQ 31
    C           COAS1     OREQ 33
    C           COAS1     OREQ 44
D4  C           LPAT1     IFNE *ZEROS
    C           COLA1     ORNE *BLANK
     C                     SETON                     52    MESSAGE 111
    C                     GOTO TAG51
F4  C                     END
    C*
X3  C                     ELSE
D4  C           LPAT1     IFEQ *ZEROS
    C           COLA1     OREQ *BLANK
    C           PASS1     OREQ *ZEROS
     C                     SETON                     52    MESSAGE 111
    C                     GOTO TAG51
F4  C                     END
     C                     Z-ADD1         TBNSEG
     C                     MOVE 'A1'      XCOLA1
     C                     MOVE COLA1     XCOLA2
     C                     MOVELXCOLKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XCOLLESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             52    MESSAGE 111
    C           *IN52     CABEQ'1'       TAG51
F3  C                     END
    C*
D3  C           COAS1     IFEQ 23
    C           PASS1     ANDGT400
     C                     SETON                     52    MESSAGE 111
    C                     GOTO TAG51
F3  C                     END
     *
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE 2° ASSEMBLAGE                               *
     *--------------------------------------------------------*
D2  C           *IN35     IFEQ '1'
     *
D3  C           PLIA2     IFNE *BLANKS
     C                     MOVEL'DPLI'    PXARGU
     C                     MOVE PLIA2     PXVALE    P
     C           CLE3      CHAINPARAME               59
    C   59                GOTO TAG51                      MESSAGE 16
F3  C                     END
     *
D3  C           COAS2     IFNE 31
    C           COAS2     ANDNE33
D4  C           LPAT2     IFEQ *ZEROS
    C           COLA2     OREQ *BLANK
    C           PASS2     OREQ *ZEROS
     C                     SETON                     53    MESSAGE 112
    C                     GOTO TAG51
F4  C                     END
     C                     Z-ADD1         TBNSEG
     C                     MOVE 'A2'      XCOLA1
     C                     MOVE COLA2     XCOLA2
     C                     MOVELXCOLKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XCOLLESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             53    MESSAGE 112
    C           *IN53     CABEQ'1'       TAG51
F3  C                     END
    C*
D3  C           COAS2     IFEQ 23
    C           PASS2     ANDGT400
     C                     SETON                     53    MESSAGE 112
    C                     GOTO TAG51
F3  C                     END
     *
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   POIGNEE CHAMPION                                     *
     *--------------------------------------------------------*
D2  C           *IN49     IFEQ '1'
     C           TYPPCH    CHAINPOIGNEL1             65
D3  C           *IN65     IFEQ '1'
    C                     GOTO TAG51
F3  C                     END
     C  N65                MOVELDESIG     LIBPCH
X2  C                     ELSE
D3  C           TYPPCH    IFNE *BLANKS
     C                     SETON                     65    MESSAGE 112
    C                     GOTO TAG51
F3  C                     END
F2  C                     END
     *
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE SOUS TRAITANCE                              *
     *--------------------------------------------------------*
     C                     EXSR CTLC03
    C   98                GOTO TAG51
F1  C                     END
     C/SPACE 3
    C*
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG31
D2  C           NF        IFEQ 3
D3  C           *IN29     IFEQ '0'
    C                     GOTO TAG5
X3  C                     ELSE
    C                     GOTO TAG40
F3  C                     END
F2  C                     END
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ6         TAG7
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   6° FORMAT - STANDARD                                 *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG6      TAG
    C*          ---------------
    C* PREPARATION AFFICHAGE
    C*-------------------------
     C                     EXSR AVANT1
     *
     C/SPACE 5
    C* AFFICHAGE
    C*-------------------------
     C           TAG61     TAG
    C*          ---------------
     C   38                Z-ADD6         NF
     C                     EXFMTFMT6
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG51
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG61
F1  C                     END
     C/SPACE 5
    C*          *IN01     IFEQ '0'                        PAS COMMERCIAL
    C* CONTROLE
    C*-------------------------
D1  C           SUDEC     IFGT 20
     C                     SETON                     65    MESSAGE 117
    C                     GOTO TAG61
F1  C                     END
    C*
D1  C           SUDEC     IFEQ *ZEROS
    C           LIBCDC    ANDNE*BLANKS
    C           SUDEC     ORNE *ZEROS
    C           LIBCDC    ANDEQ*BLANKS
     C                     SETON                     66    MESSAGE 118
    C                     GOTO TAG61
F1  C                     END
    C*
D1  C           RELAT     IFEQ *ZEROS
    C           LIBCVR    ANDNE*BLANKS
    C           RELAT     ORNE *ZEROS
    C           LIBCVR    ANDEQ*BLANKS
     C                     SETON                     67    MESSAGE 119
    C                     GOTO TAG61
F1  C                     END
    C*
D1  C           AUTFRB    IFEQ *ZEROS
    C           LIBCAF    ANDNE*BLANKS
    C           AUTFRB    ORNE *ZEROS
    C           LIBCAF    ANDEQ*BLANKS
     C                     SETON                     68    MESSAGE 120
    C                     GOTO TAG61
F1  C                     END
    C*                    END
     C/SPACE 3
    C*
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG31
D2  C           NF        IFEQ 3
D3  C           *IN29     IFEQ '0'
    C                     GOTO TAG5
X3  C                     ELSE
    C                     GOTO TAG40
F3  C                     END
F2  C                     END
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ5         TAG6
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   7° FORMAT - STANDARD                                 *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG7      TAG
    C*          ---------------
    C* PREPARATION AFFICHAGE
    C*-------------------------
     C                     EXSR AVANT2
     C/SPACE 2
    C* AFFICHAGE
    C*-------------------------
     C                     MOVE 'P'       PALNAT  1
D1  C           SUPHA2    IFEQ *BLANK
     C                     MOVE '00'      SUPHA2
F1  C                     END
     C           TAG71     TAG
    C*          ---------------
     C   38                Z-ADD6         NF
     C  N02                EXFMTFMT7
     C   02                EXFMTFMT7B
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG6
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG71
F1  C                     END
     C/SPACE 2
     * SI DEVIS PREIMPRIME
     *-------------------------
D1  C           *IN02     IFEQ '1'
     C                     MOVE 'S'       EMBNAT
     C                     EXSR CTLC04
    C   98                GOTO TAG71
    C                     GOTO TAG72
F1  C                     END
     C/SPACE 2
     * CAISSES OU PAQUETS
     *-------------------------
D1  C           EMBNAT    IFNE 'S'
     *
D2  C           EMBNAT    IFNE *BLANK
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE *BLANK    PXVALE
     C                     MOVE EMBNAT    SEPT
     C                     MOVE EMBTYP    HUIT
     C           CLE3      CHAINPARAME               51
    C           *IN51     CABEQ'1'       TAG71            MESSAGE 121
     *
     * SI CAISSES
D3  C           EMBNAT    IFEQ 'C'
     C                     MOVE *BLANK    PXVALE
     C                     MOVE EMBNAT    SEPT
D4  C           EMBCON    IFNE *BLANK
     C                     MOVE EMBCON    HUIT
     C                     MOVE 'EMCE'    PXARGU
     C           CLE3      CHAINPARAME               52
    C           *IN52     CABEQ'1'       TAG71            MESSAGE 122
F4  C                     END
     *
D4  C           EMBQUA    IFNE *BLANK
     C                     MOVE EMBQUA    PXVALE    P
     C                     MOVE 'EMQU'    PXARGU
     C           CLE3      CHAINPARAME               53    MESSAGE 123
    C           *IN53     CABEQ'1'       TAG71
F4  C                     END
     *
     * SI PAQUETS
X3  C                     ELSE
     C                     MOVE *BLANK    EMBCON
     C                     MOVE *BLANK    EMBQUA
F3  C                     END
     *
X2  C                     ELSE
D3  C           STOCKE    IFNE 'O'
    C           PMBTYP    CABEQ*BLANK    TAG71          55MESSAGE 125
F3  C                     END
     C                     Z-ADD*ZEROS    EMBLO
     C                     Z-ADD*ZEROS    EMBLA
     C                     Z-ADD*ZEROS    EMBHT
     C                     Z-ADD*ZEROS    NBRUNI
F2  C                     END
     C/SPACE 1
     * PALETTES
     *------------------------
D2  C           PMBTYP    IFNE *BLANK
     C                     MOVE *BLANK    PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE PALNAT    SEPT
     C                     MOVE PMBTYP    HUIT
     C           CLE3      CHAINPARAME               56     MESSAGE 126
    C           *IN56     CABEQ'1'       TAG71
     *
     C                     MOVE *BLANK    PXVALE
     C                     MOVE PALNAT    SEPT
D3  C           PMBCON    IFNE *BLANK
     C                     MOVE PMBCON    HUIT
     C                     MOVE 'EMCE'    PXARGU
     C           CLE3      CHAINPARAME               57     MESSAGE 127
    C           *IN57     CABEQ'1'       TAG71
F3  C                     END
     * PLAQUES
     *------------------------
D3  C           PLATYP    IFNE *BLANK
     C                     MOVE PLATYP    PXVALE    P
     C                     MOVE 'EMPL'    PXARGU
     C           CLE3      CHAINPARAME               59    MESSAGE 129
    C           *IN59     CABEQ'1'       TAG71
    C           PLANBR    CABLE0         TAG71        5959MESSAGE 129
X3  C                     ELSE
    C           PLANBR    CABGT0         TAG71      59    MESSAGE 129
F3  C                     END
     * HABILLAGE
     *------------------------
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HAB11     PXVALE    P
     C           CLE3      CHAINPARAME               61
    C           *IN61     CABEQ'1'       TAG71
    C           HAB12     CABLE'0'       TAG71        6161MESSAGE 131
     *
D3  C           HABIL2    IFNE *BLANK
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HAB21     PXVALE    P
     C           CLE3      CHAINPARAME               62
    C           *IN62     CABEQ'1'       TAG71
    C           HAB22     CABLE'0'       TAG71        6262MESSAGE 132
     *
D4  C           HABIL3    IFNE *BLANK
     C                     MOVE 'EMHA'    PXARGU
     C                     MOVE HAB31     PXVALE    P
     C           CLE3      CHAINPARAME               63
    C           *IN63     CABEQ'1'       TAG71
    C           HAB32     CABLE'0'       TAG71        6363MESSAGE 133
F4  C                     END
X3  C                     ELSE
     C                     MOVE *BLANK    HABIL3
F3  C                     END
     * PROTECTION
     *------------------------
D3  C           PROTEC    IFNE *BLANK
     C                     MOVE 'EMPR'    PXARGU
     C                     MOVE PROTEC    PXVALE    P
     C           CLE3      CHAINPARAME               64    MESSAGE 134
    C           *IN64     CABEQ'1'       TAG71
F3  C                     END
     *
X2  C                     ELSE
     C                     Z-ADD*ZEROS    EMBLO
     C                     Z-ADD*ZEROS    EMBLA
     C                     Z-ADD*ZEROS    EMBHT
     C                     Z-ADD*ZEROS    NBDECP
     C                     Z-ADD*ZEROS    NBCAIP
F2  C                     END
F1  C                     END
     *
D1  C           NBRUNI    IFNE *ZEROS
    C           NBCAIP    ANDNE*ZEROS
     C           NBRUNI    MULT NBCAIP    NBDECT  60
D2  C           NBDECP    IFEQ *ZEROS
     C                     Z-ADDNBDECT    NBDECT
X2  C                     ELSE
    C           NBDECT    CABNENBDECP    TAG71      7979  MESSAGE 159
F2  C                     END
F1  C                     END
     C/SPACE 2
     * VEHICULE
     *------------------------
D1  C           TYPVEH    IFNE *BLANK
     C                     MOVE 'EXVE'    PXARGU
     C                     MOVE TYPVEH    PXVALE    P
     C           CLE3      CHAINPARAME               60    MESSAGE 130
    C           *IN60     CABEQ'1'       TAG71
F1  C                     END
     C/SPACE 2
     * TRANSPORT
     *------------------------
D1  C           PDUNI     IFEQ *ZEROS
     C                     SETON                     65    MESSAGE 135
    C                     GOTO TAG71
F1  C                     END
     *
D1  C           GARNT1    IFEQ 'A'
    C           PDSGAR    ANDLEPDUNI
     C                     SETON                     66    MESSAGE 136
    C                     GOTO TAG71
F1  C                     END
     *
     C                     MOVE 'TPOR'    PXARGU
     C                     MOVE TYPOR     PXVALE    P
     C           CLE3      CHAINPARAME               67    MESSAGE 137
    C           *IN67     CABEQ'1'       TAG71
     *
D1  C           TYPOR     IFLE 2
D2  C           LIEU      IFNE *ZEROS
     C                     MOVE 'DPTS'    PXARGU
     C                     MOVE LIEU      PXVALE    P
     C           CLE3      CHAINPARAME               68    MESSAGE 138
     C                     MOVE LIEU      LIEUA   2
     C  N68      LIEUA     CHAINTRANSP               68
    C           *IN68     CABEQ'1'       TAG71
    C           CPAYFO    CABNE*ZEROS    TAG71      6868
X2  C                     ELSE
D3  C           CPAYFO    IFNE *ZEROS
    C           RPAYS     ORNE *BLANKS
     C                     MOVE 'TPAY'    PXARGU
     C                     MOVE CPAYFO    PXVALE    P
     C           CLE3      CHAINPARAME               69    MESSAGE 139
     C  N69      CLETTR    CHAINTTREXP               69
    C           *IN69     CABEQ'1'       TAG71
F3  C                     END
F2  C                     END
     *
D2  C           PORKG     IFEQ *ZEROS
    C           LIEU      ANDEQ*ZEROS
    C           CPAYFO    ANDEQ*ZEROS
     C                     SETON                     70    MESSAGE 140
    C                     GOTO TAG71
F2  C                     END
    C*
X1  C                     ELSE
    C           LIEU      CABNE*ZEROS    TAG71      6868
    C           CPAYFO    CABNE*ZEROS    TAG71      6868
    C           PORKG     CABNE*ZEROS    TAG71      7070
F1  C                     END
     C/SPACE 2
     * QUANTITES
     *------------------------
     C                     EXSR CTLC04
    C   98                GOTO TAG71
     C/SPACE 3
     C           TAG72     TAG
    C*          ---------------
    C* SI AFFICHAGE
    C*------------------------------
D1  C           AFFI      IFNE ' '
     C                     MOVE *IN38     I38     1
     C                     MOVE *IN10     I10     1
     C                     MOVE *IN29     I29     1
     C                     Z-ADDNF        SVNF    10
     C                     Z-ADDSVNOEX    SVNOE1
     C                     Z-ADDPOSF1     POSF1X
     C                     Z-ADDQTTOT1    XTTOT1
     C                     Z-ADDQTTOT2    XTTOT2
     C                     Z-ADDQTTOT3    XTTOT3
     C                     Z-ADDQTTOT4    XTTOT4
     C                     CALL 'DEV013£1'
     C                     PARM           DE0131
     C                     MOVE I38       *IN38
     C                     MOVE I10       *IN10
     C                     MOVE I29       *IN29
     C                     Z-ADDSVNF      NF
F1  C                     END
     C/SPACE 3
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSTD
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG31
D2  C           NF        IFEQ 3
D3  C           *IN29     IFEQ '0'
    C                     GOTO TAG5
X3  C                     ELSE
    C                     GOTO TAG40
F3  C                     END
F2  C                     END
    C           NF        CABEQ4         TAG5
    C           NF        CABEQ5         TAG6
F1  C                     END
     *
     C/SPACE 5
     *--------------------------------------------------------*
     *   ECRITURE FICHIER                                      *
     *--------------------------------------------------------*
     C           MAJSTD    TAG
    C*          ---------------
D1  C           SCARS     IFEQ 'O'
     C                     MOVEL'SC'      TSOND
F1  C                     END
     C                     MOVE CNDD      CVEI3
D1  C           ORALEX    IFNE *BLANKS
D2  C           CORALE    IFEQ 1
     C                     MOVE '0'       OREX
X2  C                     ELSE
     C                     MOVE CORALE    X1
     C                     MOVE X1        OREX
F2  C                     END
     C                     MOVELORALEX    OREX
X1  C                     ELSE
     C                     MOVE *BLANKS   OREX
F1  C                     END
D1  C           ORALIN    IFNE *BLANKS
D2  C           CORALI    IFEQ 1
     C                     MOVE '0'       ORIN
X2  C                     ELSE
     C                     MOVE CORALI    X1
     C                     MOVE X1        ORIN
F2  C                     END
     C                     MOVELORALIN    ORIN
X1  C                     ELSE
     C                     MOVE *BLANKS   ORIN
F1  C                     END
D1  C           ORAEXR    IFNE *BLANKS
D2  C           CORAER    IFEQ 1
     C                     MOVE '0'       OREXR
X2  C                     ELSE
     C                     MOVE CORAER    X1
     C                     MOVE X1        OREXR
F2  C                     END
     C                     MOVELORAEXR    OREXR
X1  C                     ELSE
     C                     MOVE *BLANKS   OREXR
F1  C                     END
D1  C           ORAINR    IFNE *BLANKS
D2  C           CORAIR    IFEQ 1
     C                     MOVE '0'       ORINR
X2  C                     ELSE
     C                     MOVE CORAIR    X1
     C                     MOVE X1        ORINR
F2  C                     END
     C                     MOVELORAINR    ORINR
X1  C                     ELSE
     C                     MOVE *BLANKS   ORINR
F1  C                     END
D1  C           SIGAF     IFEQ '-'
     C                     Z-SUBAUTFRB    AUTFRB
F1  C                     END
D1  C           TIMPEX    IFEQ 4
    C           TIMPIN    OREQ 4
D2  C           FACON     IFEQ 4
    C           CCOL      ANDEQ1
    C           FORL      ANDEQ*ZEROS
     C                     Z-ADDDECL      FORL
     C                     Z-ADDDECH      FORH
F2  C                     END
F1  C                     END
     C                     MOVE AFFL1     CLIE3
     C                     MOVE AFFD1     CLII3
     C                     MOVE AFFL2     CLIE2
     C                     MOVE AFFD2     CLII2
     C                     MOVE CFINIT    TVEI3
D1  C           CCOL      IFEQ 7                          PELLICULAGE
    C           FLPEAP    ANDGT*ZEROS
D2  C           PLLOIN    IFEQ '*'
D3  C           APPIN     IFEQ *BLANK
     C                     MOVE 'F'       APPIN
F3  C                     END
X2  C                     ELSE
D3  C           APPEX     IFEQ *BLANK
     C                     MOVE 'F'       APPEX
F3  C                     END
F2  C                     END
F1  C                     END
     * SI PAS PELLICULAGE
D1  C           CODPEL    IFEQ ' '
     C                     MOVE *BLANK    CODPP1
     C                     MOVE *BLANKS   QUAPP1
     C                     Z-ADD*ZEROS    LZPUP1
     C                     MOVE *BLANK    COUPP1
     C                     MOVE *BLANK    CODPP2
     C                     MOVE *BLANKS   QUAPP2
     C                     Z-ADD*ZEROS    LZPUP2
     C                     MOVE *BLANK    COUPP2
     C                     Z-ADD*ZEROS    ENCI3
F1  C                     END
     * SI SUPPRESSION AFFICHE
D1  C           AFFI      IFEQ ' '
    C           AFFIAV    ANDEQ'*'
     C                     Z-ADDNOETU     SVNOEX
     C                     CALL 'DEV035£'
     C                     PARM           DEV035
F1  C                     END
     *
D1  C           TRAV2     IFEQ 'S'                        SAISIE
     C                     WRITEDEVISF1
D2  C           *IN13     IFEQ '1'                        VARIANTE
     C                     Z-ADD*ZEROS    SEQDE
     C                     MOVE *BLANKS   OREX
     C                     MOVE *BLANKS   OREXR
     C                     MOVE *BLANKS   ORIN
     C                     MOVE *BLANKS   ORINR
     C                     Z-ADD0         CNDD
D3  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X3  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F3  C                     END
    C                     GOTO TAG11
F2  C                     END
     C                     CLEARDEVISF1
     C                     EXSR BLK1
D2  C           RETV      IFEQ *BLANK
    C                     GOTO TAG11
X2  C                     ELSE
    C                     GOTO FINPG
F2  C                     END
X1  C                     ELSE
     C                     UPDATDEVISF1
D2  C           TRAV2     IFEQ 'E'                        SAISIE A PARTIR
     C           CLE5      CHAINETIQUET              50    ETIQUETTE
     C  N50                DELETETIQUET1
F2  C                     END
D2  C           *IN13     IFEQ '1'                        VARIANTE
     C                     Z-ADD*ZEROS    SEQDE
     C                     MOVE *BLANKS   OREX
     C                     MOVE *BLANKS   OREXR
     C                     MOVE *BLANKS   ORIN
     C                     MOVE *BLANKS   ORINR
    C*                    Z-ADD0         CNDD
     C                     MOVE 'S'       TRAV2
     C                     MOVE '*'       RETV    1
D3  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X3  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F3  C                     END
    C                     GOTO TAG11
F2  C                     END
    C                     GOTO FINPG
F1  C                     END
     C/EJECT
     **********************************************************
     *   DEVIS SIMPLIFIE                                      *
     **********************************************************
     C/SPACE 5
     *--------------------------------------------------------*
     *   13° FORMAT - SIMPLIFIE                               *
     *--------------------------------------------------------*
     C           TAG13     TAG
     *          ---------------
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
D1  C           CNDD      IFEQ *ZEROS
D2  C           CCOL      IFEQ 9
     C                     Z-ADD12        CNDD
F2  C                     END
D2  C           CCOL      IFEQ 6
     C                     Z-ADD62        CNDD
F2  C                     END
D2  C           CCOL      IFEQ 8
    C           ONDUL     ANDEQ9
     C                     Z-ADD12        CNDD
F2  C                     END
F1  C                     END
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     * - Mémorisation état indicateur Pose Accessoire "40" du format "FMT1"
     * avant affichage de ce format; l'état sera restauré à l'identique
     * lors du retour au format "FMT1"
     C                     MOVEL'0'       SV40
     C   40                MOVEL'1'       SV40
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C*
     C           TAG131    TAG
     *          ---------------
     C                     MOVEA'00000000'*IN,40
     C                     MOVEA'00'      *IN,48
     C           40        ADD  FACON     IN      20
     C                     MOVEA'1'       *IN,IN
D1  C           CCOL      IFEQ 3
     C                     SETON                         43
F1  C                     END
     C   38                Z-ADD3         NF
    C*
     C                     EXFMTFMT13
    C           *IN03     CABEQ'1'       FINPG
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     * - Restauration de l'état avant en cas de retour écran précédent
     C           *IN12     IFEQ '1'
     C                     MOVELSV40      *IN40
     C                     ENDIF
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
    C           *IN12     CABEQ'1'       TAG11
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG131
F1  C                     END
     C/SPACE 3
     * VERIFICATION ZONES
     *=========================
    C* CONTROLE COMMUN TOUS DEVIS
    C*---------------------------
     C                     EXSR CTLC01
    C   98                GOTO TAG131
     *
    C* DIMENSIONS
    C*-------------------------
     C                     SETOF                     98
D1  C           NBFEUL    IFNE *ZEROS
     C           DECL      MULT NBFEUL    LAIZUT  40       LAIZE UTILE
F1  C                     END
     *
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     EXSR CPLXS
    C   98                GOTO TAG131
X1  C                     ELSE
    C*
    C           *IN40     CASEQ'1'       DIS0
    C           *IN41     CASEQ'1'       DIS12
    C           *IN42     CASEQ'1'       DIS12
    C           *IN44     CASEQ'1'       DIS45
    C           *IN46     CASEQ'1'       DIS678
    C           *IN47     CASEQ'1'       DIS678
    C           *IN48     CASEQ'1'       DIS678
    C           *IN49     CASEQ'1'       DIS9
    C                     END
D2  C           *IN45     IFEQ '1'
    C           CCOL      CASEQ2         DIS9
    C                     CAS            DIS45
    C                     END
F2  C                     END
    C*
    C   98                GOTO TAG131
F1  C                     END
    C*          ---------------
    C* 2° CONTROLE COMMUN TOUS DEVIS
    C*------------------------------
     C                     EXSR CTLC02
    C   98                GOTO TAG131
     C/SPACE 3
    C* SI COMPLEXE CXH
    C*------------------------------
D1  C           PAPECX    IFNE *BLANKS
    C           PAPICX    ORNE *BLANKS
    C*
D2  C           PAPECX    IFNE *BLANKS
     C                     EXSR SPCXH1
     C           TAG83     TAG
     C                     EXFMTFMT8
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG11
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARM0
     C                     CALL 'PRODU23£'
     C                     PARM           INTCXH
     C                     WRITEFMT2
    C                     GOTO TAG81
F3  C                     END
     C                     EXSR CTLF8
    C   61                GOTO TAG83
     C                     EXSR SPCXH2
X2  C                     ELSE
     C                     EXSR SPCXH5
F2  C                     END
    C*
D2  C           PAPICX    IFNE *BLANKS
     C                     EXSR SPCXH3
     C           TAG84     TAG
     C                     EXFMTFMT8
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG11
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARM0
     C                     CALL 'PRODU23£'
     C                     PARM           INTCXH
     C                     WRITEFMT2
    C                     GOTO TAG82
F3  C                     END
     C                     EXSR CTLF8
    C   61                GOTO TAG84
     C                     EXSR SPCXH4
X2  C                     ELSE
     C                     EXSR SPCXH6
F2  C                     END
    C*
X1  C                     ELSE
     C                     EXSR SPCXH5
     C                     EXSR SPCXH6
F1  C                     END
     C/SPACE 3
    C           TIMPEX    CASEQ*ZERO     BLK2
    C                     END
    C           TIMPIN    CASEQ*ZERO     BLK3
    C                     END
     C  N30N31             SETOF                     29
     *
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSIM
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG131
    C           NF        CABEQ4         TAG150
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   14° FORMAT - SIMPLIFIE                               *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG140    TAG
    C*          ---------------
     C                     SETOF                     323334
     C                     SETOF                     352930
     C                     SETOF                     3123
     C                     SETOF                     1718
     *
D1  C           *IN01     IFEQ '1'                        COMMERCIAL
     C                     MOVE TVEEX     TVERES
     C                     MOVE TVEEXR    RVERES
     C                     MOVE TVEIN     TVERIS
     C                     MOVE TVEINR    RVERIS
     C                     Z-ADDCOUEX     SCOUEX
     C                     Z-ADDCOUIN     SCOUIN
     C                     Z-ADDCOUEXR    SCOUER
     C                     Z-ADDCOUINR    SCOUIR
     C           RIMPEX    COMP 0                        17
     C           RIMPIN    COMP 0                        18
F1  C                     END
     C           TREPSE    COMP 0                    1717
     C           TREPSI    COMP 0                    1818
    C* IMPRIME EXTERIEUR
    C*-------------------------
D1  C           TIMPEX    IFNE *ZEROS
     C                     SETON                     3029
D2  C           TIMPEX    IFEQ 3
    C           USINE     ANDNE2
    C           TIMPEX    OREQ 2
     C                     Z-ADD3         USEXT
F2  C                     END
    C*          TIMPEX    IFEQ 5
D2  C           TIMPEX    IFEQ 3
    C           USINE     ANDEQ2
     C                     Z-ADD2         USEXT
     C                     SETON                     17
F2  C                     END
F1  C                     END
    C* IMPRIME INTERIEUR
    C*-------------------------
D1  C           TIMPIN    IFNE *ZEROS
     C                     SETON                     3129
D2  C           TIMPIN    IFEQ 3
    C           USINE     ANDNE2
    C           TIMPIN    OREQ 2
     C                     Z-ADD3         USINT
F2  C                     END
    C*          TIMPIN    IFEQ 5
D2  C           TIMPIN    IFEQ 3
    C           USINE     ANDEQ2
     C                     Z-ADD2         USINT
     C                     SETON                     18
F2  C                     END
F1  C                     END
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USEXT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUIE
     C                     MOVE USINT     PXVALE    P
     C           CLE3      CHAINPARAME               50
     C  N50                MOVELPXLIBE    LIBUII
     *
    C* FENETRE
    C*-------------------------
D1  C           TYPFEN    IFNE *BLANKS
     C                     SETON                     3233
F1  C                     END
    C* 1° ASSEMBLAGE
    C*-------------------------
D1  C           COAS1     IFNE *ZEROS
     C                     SETON                     3234
F1  C                     END
    C* 2° ASSEMBLAGE
    C*-------------------------
D1  C           COAS2     IFNE *ZEROS
     C                     SETON                     3235
D2  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     C                     SETON                     23
F2  C                     END
F1  C                     END
     *
     C           TAG141    TAG
     *          ---------------
     C   38                Z-ADD4         NF
     C                     EXFMTFMT14
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG131
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG141
F1  C                     END
     C/SPACE 5
    C*          *IN01     IFEQ '1'                        COMMERCIAL
    C*                    EXSR CTLIS
    C*  98                GOTO TAG141
    C*                    ELSE
     *--------------------------------------------------------*
     *   IMPRESSION EXTERIEUR PRINCIPALE                      *
     *--------------------------------------------------------*
D1  C           TIMPEX    IFNE *ZEROS
    C           *IN36     ANDNE'1'
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D2  C           COUEX     IFEQ *ZEROS
     C                     SETON                     53    MESSAGE 72
    C                     GOTO TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D2  C           TVEEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             59    MESSAGE 78
    C           *IN59     CABEQ'1'       TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D2  C           MATEC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATEC     PXVALE    P
     C           CLE3      CHAINPARAME               69
    C   69                GOTO TAG141                     MESSAGE 88
     C                     MOVELPXLIBE    LIBME
F2  C                     END
     C/SPACE 1
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION EXTERIEUR REPIQUAGE                       *
     *--------------------------------------------------------*
D1  C           RIMPEX    IFNE *ZEROS
    C* TYPE IMPRESSION
    C*-------------------------
D2  C           RIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               73    MESSAGE 92
    C   73                GOTO TAG141
     C                     MOVELPXLIBE    LIBIER
F2  C                     END
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D2  C           COUEXR    IFEQ *ZEROS
     C                     SETON                     74    MESSAGE 93
    C                     GOTO TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D2  C           TVEEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             77    MESSAGE 96
    C           *IN77     CABEQ'1'       TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D2  C           MATERC    IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATERC    PXVALE    P
     C           CLE3      CHAINPARAME               81
    C   81                GOTO TAG141                     MESSAGE 100
     C                     MOVELPXLIBE    LIBMER
F2  C                     END
     C/SPACE 1
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION INTERIEURE PRINCIPALE                     *
     *--------------------------------------------------------*
D1  C           TIMPIN    IFNE *ZEROS
    C           *IN37     ANDNE'1'
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D2  C           COUIN     IFEQ *ZEROS
     C                     SETON                     61    MESSAGE 73
    C                     GOTO TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D2  C           TVEIN     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XVERA1
     C                     MOVE TVEIN     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             60    MESSAGE 79
    C           *IN60     CABEQ'1'       TAG141
F2  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D2  C           MATIC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATIC     PXVALE    P
     C           CLE3      CHAINPARAME               70
    C   70                GOTO TAG141                     MESSAGE 89
     C                     MOVELPXLIBE    LIBMI
F2  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   IMPRESSION INTERIEUR REPIQUAGE                       *
     *--------------------------------------------------------*
D2  C           RIMPIN    IFNE *ZEROS
    C* TYPE IMPRESSION
    C*-------------------------
D3  C           RIMPIN    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE RIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               82    MESSAGE 101
    C   82                GOTO TAG141
     C                     MOVELPXLIBE    LIBIIR
F3  C                     END
     C/SPACE 2
    C* NOMBRE COULEUR ET %
    C*-------------------------
D3  C           COUINR    IFEQ *ZEROS
     C                     SETON                     83    MESSAGE 102
    C                     GOTO TAG141
F3  C                     END
     C/SPACE 2
    C* TYPE VERNIS
    C*-------------------------
D3  C           TVEINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE TVEINR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             86    MESSAGE 105
    C           *IN86     CABEQ'1'       TAG141
F3  C                     END
     C/SPACE 2
    C* TYPE MATERIEL
    C*-------------------------
D3  C           MATIRC    IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATIRC    PXVALE    P
     C           CLE3      CHAINPARAME               90
    C   90                GOTO TAG141                     MESSAGE 108
     C                     MOVELPXLIBE    LIBMIR
F3  C                     END
     C/SPACE 1
F2  C                     END
     C/SPACE 1
F1  C                     END
    C*                    END
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE FENETRE                                     *
     *--------------------------------------------------------*
D1  C           *IN33     IFEQ '1'
     *
D2  C           LONFEN    IFEQ *ZEROS
    C           LARFEN    OREQ *ZEROS
    C           PASFE     OREQ *ZEROS
     C                     SETON                     51    MESSAGE 110
    C                     GOTO TAG141
F2  C                     END
     *
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE 1° ASSEMBLAGE                               *
     *--------------------------------------------------------*
D1  C           *IN34     IFEQ '1'
     *
D2  C           PASS1     IFEQ *ZEROS
     C                     SETON                     52    MESSAGE 111
    C                     GOTO TAG141
F2  C                     END
    C*
D2  C           COAS1     IFEQ 23
    C           PASS1     ANDGT400
     C                     SETON                     52    MESSAGE 111
    C                     GOTO TAG141
F2  C                     END
     *
F1  C                     END
     C/SPACE 5
     *--------------------------------------------------------*
     *   CONTROLE 2° ASSEMEBLAGE                              *
     *--------------------------------------------------------*
D1  C           *IN35     IFEQ '1'
     *
D2  C           COAS2     IFNE 31
    C           COAS2     ANDNE33
D3  C           PASS2     IFEQ *ZEROS
     C                     SETON                     58    MESSAGE 112
    C                     GOTO TAG141
F3  C                     END
F2  C                     END
    C*
D2  C           COAS2     IFEQ 23
    C           PASS2     ANDGT400
     C                     SETON                     58    MESSAGE 112
    C                     GOTO TAG141
F2  C                     END
     *
F1  C                     END
     *--------------------------------------------------------*
     *   CONTROLE SOUS TRAITANCE                              *
     *--------------------------------------------------------*
     C                     EXSR CTLC03
    C   98                GOTO TAG141
     C/SPACE 3
     *
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSIM
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG131
    C           NF        CABEQ3         TAG140
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   15° FORMAT - SIMPLIFIE                               *
     *--------------------------------------------------------*
     C                     Z-ADD*ZEROS    HLIG
     C                     Z-ADD*ZEROS    HCOL
    C*
     C           TAG150    TAG
    C*          ---------------
    C* PREPARATION AFFICHAGE
    C*-------------------------
     C                     EXSR AVANT1
     C                     EXSR AVANT2
     C                     MOVE 'P'       PALNAT
     C           TAG151    TAG
     *          ---------------
     C   38                Z-ADD4         NF
     C                     EXFMTFMT15
    C           *IN03     CABEQ'1'       FINPG
    C           *IN12     CABEQ'1'       TAG141
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
D1  C           *IN25     IFEQ '1'
     C                     WRITEFMT2
    C                     GOTO TAG151
F1  C                     END
     C/SPACE 2
     * FRAIS SUPPLEMENTAIRES
     *-------------------------
D1  C           RELAT     IFEQ *ZEROS
    C           LIBCVR    ANDNE*BLANKS
    C           RELAT     ORNE *ZEROS
    C           LIBCVR    ANDEQ*BLANKS
     C                     SETON                     83    MESSAGE 119
    C                     GOTO TAG151
F1  C                     END
    C*
D1  C           AUTFRB    IFEQ *ZEROS
    C           LIBCAF    ANDNE*BLANKS
    C           AUTFRB    ORNE *ZEROS
    C           LIBCAF    ANDEQ*BLANKS
     C                     SETON                     65    MESSAGE 120
    C                     GOTO TAG151
F1  C                     END
     * CAISSES OU PAQUETS
     *-------------------------
D1  C           EMBNAT    IFNE 'S'
     *
D2  C           EMBNAT    IFNE *BLANK
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE *BLANK    PXVALE
     C                     MOVE EMBNAT    SEPT
     C                     MOVE EMBTYP    HUIT
     C           CLE3      CHAINPARAME               66
    C           *IN66     CABEQ'1'       TAG151           MESSAGE 121
X2  C                     ELSE
D3  C           STOCKE    IFNE 'O'
    C           PMBTYP    CABEQ*BLANK    TAG151         67MESSAGE 125
F3  C                     END
F2  C                     END
     C/SPACE 1
     * PALETTES
     *------------------------
D2  C           PMBTYP    IFNE *BLANK
     C                     MOVE *BLANK    PXVALE
     C                     MOVE 'EMNT'    PXARGU
     C                     MOVE PALNAT    SEPT
     C                     MOVE PMBTYP    HUIT
     C           CLE3      CHAINPARAME               69     MESSAGE 126
    C           *IN69     CABEQ'1'       TAG151
F2  C                     END
     *
F1  C                     END
     C/SPACE 2
     * TRANSPORT
     *------------------------
D1  C           PDUNI     IFEQ *ZEROS
     C                     SETON                     70    MESSAGE 135
    C                     GOTO TAG151
F1  C                     END
     *
D1  C           GARNT1    IFEQ 'A'
    C           PDSGAR    ANDLEPDUNI
     C                     SETON                     79    MESSAGE 136
    C                     GOTO TAG151
F1  C                     END
     *
     C                     MOVE 'TPOR'    PXARGU
     C                     MOVE TYPOR     PXVALE    P
     C           CLE3      CHAINPARAME               80    MESSAGE 137
    C           *IN80     CABEQ'1'       TAG151
     *
D1  C           TYPOR     IFLE 2
D2  C           LIEU      IFNE *ZEROS
     C                     MOVE 'DPTS'    PXARGU
     C                     MOVE LIEU      PXVALE    P
     C           CLE3      CHAINPARAME               81    MESSAGE 138
    C           *IN81     CABEQ'1'       TAG151
    C           CPAYFO    CABNE*ZEROS    TAG151     8181
X2  C                     ELSE
D3  C           CPAYFO    IFNE *ZEROS
     C                     MOVE 'TPAY'    PXARGU
     C                     MOVE CPAYFO    PXVALE    P
     C           CLE3      CHAINPARAME               82    MESSAGE 139
    C           *IN82     CABEQ'1'       TAG151
F3  C                     END
F2  C                     END
X1  C                     ELSE
    C           LIEU      CABNE*ZEROS    TAG151     8181
    C           CPAYFO    CABNE*ZEROS    TAG151     8282
F1  C                     END
     C/SPACE 1
     * QUANTITES
     *------------------------
     C                     EXSR CTLC04
    C   98                GOTO TAG151
     C/SPACE 3
     *
D1  C           *IN38     IFEQ '1'                        VARIANTE/MODIF
    C           *IN10     CABEQ'1'       MAJSIM
    C           NF        CABEQ1         TAG11
    C           NF        CABEQ2         TAG131
    C           NF        CABEQ3         TAG140
F1  C                     END
     *
     C/SPACE 5
     *--------------------------------------------------------*
     *   ECRITURE FICHIER                                      *
     *--------------------------------------------------------*
     C           MAJSIM    TAG
    C*          ---------------
D1  C           SCARS     IFEQ 'O'
     C                     MOVEL'SC'      TSOND
F1  C                     END
     C                     MOVE XAPEX     DAPEX
     C                     MOVE XAPEXR    DAPEXR
     C                     MOVE XAPIN     DAPIN
     C                     MOVE XAPINR    DAPINR
D1  C           SIGAF     IFEQ '-'
     C                     Z-SUBAUTFRB    AUTFRB
F1  C                     END
     C                     MOVE AFFL1     CLIE3
     C                     MOVE AFFD1     CLII3
     C                     MOVE AFFL2     CLIE2
     C                     MOVE AFFD2     CLII2
D1  C           TRAV2     IFEQ 'S'                        SAISIE
     C                     WRITEDEVISF1
D2  C           *IN13     IFEQ '1'                        VARIANTE
     C                     Z-ADD*ZEROS    SEQDE
     C                     MOVE *BLANKS   OREX
     C                     MOVE *BLANKS   OREXR
     C                     MOVE *BLANKS   ORIN
     C                     MOVE *BLANKS   ORINR
     C                     MOVE *BLANKS   DAPEX
     C                     MOVE *BLANKS   DAPEXR
     C                     MOVE *BLANKS   DAPIN
     C                     MOVE *BLANKS   DAPINR
D3  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X3  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F3  C                     END
    C                     GOTO TAG11
F2  C                     END
     C                     CLEARDEVISF1
     C                     EXSR BLK1
D2  C           RETV      IFEQ *BLANK
    C                     GOTO TAG11
X2  C                     ELSE
    C                     GOTO FINPG
F2  C                     END
X1  C                     ELSE
     C                     UPDATDEVISF1
D2  C           TRAV2     IFEQ 'E'                        SAISIE A PARTIR
     C           CLE5      CHAINETIQUET              50    ETIQUETTE
     C  N50                DELETETIQUET1
F2  C                     END
D2  C           *IN13     IFEQ '1'                        VARIANTE
     C                     Z-ADD*ZEROS    SEQDE
     C                     MOVE *BLANKS   OREX
     C                     MOVE *BLANKS   OREXR
     C                     MOVE *BLANKS   ORIN
     C                     MOVE *BLANKS   ORINR
     C                     MOVE 'S'       TRAV2
     C                     MOVE '*'       RETV    1
D3  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X3  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F3  C                     END
    C                     GOTO TAG11
F2  C                     END
    C                     GOTO FINPG
F1  C                     END
     C/EJECT
     *--------------------------------------------------------*
     *   FIN                                                  *
     *--------------------------------------------------------*
     C           FINPG     TAG
     *          ---------------
     *  dltovr *all ...
     C                     MOVELOVR,1     OVRDB  60
     C                     CALL 'QCMDEXC'
     C                     PARM           OVRDB
     C                     PARM           LONG   155
     *
D1  C           *IN03     IFEQ '1'
D2  C           TRAV2     IFEQ 'V'
    C           TRAV2     OREQ 'E'
     C                     DELETDEVISF1
     C                     Z-ADDSVNOEX    NOETU
     C           CLE5      CHAINDEVIS2               50
     C  N50                DELETDEVIS2F1
     C                     Z-ADDSVNOEX    NOETU
     C           CLE5      CHAINDEVAMLL1             50
D3  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C                     Z-ADDSVNOEX    NOETU
     C           CLE5      READEDEVAMLL1                 50
F3  C                     END
     C                     Z-ADDSVNOE     NOETU
     C                     MOVE '0000'    NOETU
     C           CLE5      CHAINDEVAMLL1             50
D3  C           *IN50     DOWEQ'0'
     C                     DELETDEVAMLF
     C           CLE5      READEDEVAMLL1                 50
F3  C                     END
F2  C                     END
D2  C           TRAV2     IFEQ 'C'
     C                     Z-ADD2         TYPDEV
     C                     MOVE '*'       TAG1
     C                     MOVE '*'       TAG2
     C                     EXCPTMAJDES
F2  C                     END
F1  C                     END
     *
     C                     SETON                     LR
     C/EJECT
     *--------------------------------------------------------*
     *   PREPARATION AFFICHAGE PONDERATION                    *
     *--------------------------------------------------------*
    C           AVANT1    BEGSR
     *          ---------------
     C                     Z-ADDPRD       SPRD
     C                     Z-ADDPRG       SPRG
     C                     Z-ADDPRO       SPRO
     C                     Z-ADDPEF       SPEF
     C                     Z-ADDPDE       SPDE
     C                     Z-ADDROC       SROC
     C                     Z-ADDRET       SRET
     C                     Z-ADD*ZEROS    PRD
     C                     Z-ADD*ZEROS    PRG
     C                     Z-ADD*ZEROS    PRO
     C                     Z-ADD*ZEROS    PEF
     C                     Z-ADD*ZEROS    PDE
     C                     Z-ADD*ZEROS    ROC
     C                     Z-ADD*ZEROS    RET
     C                     Z-ADD*ZEROS    TN
     C                     Z-ADD*ZEROS    K       20
D1  C           TIMPEX    IFNE *ZEROS
    C           TIMPEX    ANDNE3
     C                     ADD  1         K
     C                     Z-ADD1         TN,K
F1  C                     END
D1  C           RIMPEX    IFNE *ZEROS
    C           RIMPEX    ANDNE3
     C                     ADD  1         K
     C                     Z-ADD2         TN,K
F1  C                     END
D1  C           TIMPIN    IFNE *ZEROS
    C           TIMPIN    ANDNE3
     C                     ADD  1         K
     C                     Z-ADD3         TN,K
F1  C                     END
D1  C           RIMPIN    IFNE *ZEROS
    C           RIMPIN    ANDNE3
     C                     ADD  1         K
     C                     Z-ADD4         TN,K
F1  C                     END
D1  C           CODDOR    IFNE ' '
D2  C           DNATP1    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD26        TN,K
F2  C                     END
D2  C           DNATP2    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD27        TN,K
F2  C                     END
F1  C                     END
D1  C           PAFIL1    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD24        TN,K
F1  C                     END
D1  C           PAFIL2    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD25        TN,K
F1  C                     END
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     ADD  1         K
     C                     Z-ADD5         TN,K
F1  C                     END
D1  C           TCXHE     IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD15        TN,K
F1  C                     END
D1  C           TCXHI     IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD16        TN,K
F1  C                     END
D1  C           GFRA      IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD6         TN,K
F1  C                     END
D1  C           GFRA2     IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD66        TN,K
F1  C                     END
D1  C           CCOL      IFEQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
     C                     ADD  1         K
     C                     Z-ADD7         TN,K
F1  C                     END
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
     C                     ADD  1         K
     C                     Z-ADD8         TN,K
F1  C                     END
D1  C           CCOL      IFEQ 6
D2  C           COUI3     IFEQ 1
     C                     ADD  1         K
     C                     Z-ADD20        TN,K
X2  C                     ELSE
     C                     ADD  1         K
     C                     Z-ADD7         TN,K
F2  C                     END
     C                     ADD  1         K
     C                     Z-ADD8         TN,K
F1  C                     END
D1  C           TIMPEX    IFEQ 3
    C           RIMPEX    OREQ 3
    C           TIMPIN    OREQ 3
    C           RIMPIN    OREQ 3
D2  C           CCOL      IFNE 4
    C           CCOL      ANDNE7
     C                     ADD  1         K
     C                     Z-ADD9         TN,K
F2  C                     END
F1  C                     END
D1  C           GENCO1    IFEQ '*'
D2  C           K         IFEQ 0
     C                     ADD  1         K
     C                     Z-ADD9         TN,K
X2  C                     ELSE
D3  C           TN,K      IFNE 9
     C                     ADD  1         K
     C                     Z-ADD9         TN,K
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           GENCO2    IFEQ '*'
     C                     ADD  1         K
     C                     Z-ADD19        TN,K
F1  C                     END
     *
D1  C           AFFIC     IFEQ '1'
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '2'
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '3'
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '4'
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
F1  C                     END
D1  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
     C                     ADD  1         K
     C                     Z-ADD10        TN,K
D2  C           TDEC3     IFNE '0'
    C           TDEC3     ANDNE'7'
    C           TDEC3     ANDNE'8'
     C                     ADD  1         K
     C                     Z-ADD11        TN,K
F2  C                     END
D2  C           TYPFEN    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD12        TN,K
F2  C                     END
D2  C           PSBAX     IFEQ 'O'
     C                     ADD  1         K
     C                     Z-ADD23        TN,K
F2  C                     END
D2  C           COAS1     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD13        TN,K
F2  C                     END
D2  C           COAS2     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD14        TN,K
F2  C                     END
     *--- Début --- Philippe --- 12/11/2015 --- Pose Accssoires  *
     * - Gestion de la pose Accessoires en Post-Assemblage       *
D2  C           EYECOD    IFNE *BLANK
     C                     ADD  1         K
     C                     Z-ADD28        TN,K
F2  C                     END
D2  C           BTPCOD    IFNE *BLANK
     C                     ADD  1         K
     C                     Z-ADD29        TN,K
F2  C                     END
     *--- Fin   --- Philippe --- 12/11/2015 --- Pose Accssoires  *
F1  C                     END
     *
     C                     MOVEA'00000000'*IN,51
     C                     MOVEA'000000'  *IN,59
     C                     Z-ADD*ZEROS    K
D1  C                     DO   14        K
D2  C           TN,K      IFNE *ZEROS
     C           TN,K      LOKUPTABCS     TABLS          50
     C                     MOVELTABLS     LSS,K
     C           50        ADD  K         J       20
     C                     MOVEA'1'       *IN,J
     C                     Z-ADD1         Z       20
     C           TN,K      LOKUPTSS,Z                    50
D3  C           *IN50     IFEQ '1'
     C                     Z-ADDSPRD,Z    PRD,K
     C                     Z-ADDSPRG,Z    PRG,K
     C                     Z-ADDSPRO,Z    PRO,K
     C                     Z-ADDSPEF,Z    PEF,K
     C                     Z-ADDSPDE,Z    PDE,K
     C                     Z-ADDSROC,Z    ROC,K
     C                     Z-ADDSRET,Z    RET,K
F3  C                     END
F2  C                     END
F1  C                     END
     C                     Z-ADDTN        TSS
     *
    C                     ENDSR
      /EJECT
     *--------------------------------------------------------*
     *   PREPARATION AFFICHAGE QUANTITES                      *
     *--------------------------------------------------------*
    C           AVANT2    BEGSR
     *          ---------------
     C                     MOVEA'0000000' *IN,41
    C*
D1  C           GARNT1    IFEQ 'A'
     C                     SETON                     41
X1  C                     ELSE
     C                     Z-ADD*ZEROS    PDSGAR
F1  C                     END
    C*
D1  C           TIMPEX    IFNE *ZEROS
    C           TIMPEX    ANDNE3
    C*          TIMPEX    ANDNE5
    C           *IN36     ANDEQ'0'
    C           TIMPIN    ORNE *ZEROS
    C           TIMPIN    ANDNE3
    C*          TIMPIN    ANDNE5
    C           *IN37     ANDEQ'0'
    C           RIMPEX    ORNE *ZEROS
    C           RIMPEX    ANDNE3
    C*          RIMPEX    ANDNE5
    C           RIMPIN    ORNE *ZEROS
    C           RIMPIN    ANDNE3
    C*          RIMPIN    ANDNE5
     C                     SETON                     42
F1  C                     END
D1  C           *IN42     IFEQ '0'
     C                     Z-ADD*ZEROS    NBIMP1
     C                     Z-ADD*ZEROS    NBIRE1
     C                     Z-ADD*ZEROS    NBIMP2
     C                     Z-ADD*ZEROS    NBIRE2
     C                     Z-ADD*ZEROS    NBIMP3
     C                     Z-ADD*ZEROS    NBIRE3
     C                     Z-ADD*ZEROS    NBIMP4
     C                     Z-ADD*ZEROS    NBIRE4
F1  C                     END
    C*
D1  C           NBPAP     IFEQ 1
D2  C           TPS,1     IFEQ '*'
     C                     SETON                     44
F2  C                     END
F1  C                     END
D1  C           NBPAP     IFEQ 2
D2  C           TPS,1     IFEQ '*'
     C                     SETON                     44
F2  C                     END
D2  C           TPS,2     IFEQ '*'
     C                     SETON                     45
F2  C                     END
F1  C                     END
D1  C           NBPAP     IFEQ 3
D2  C           TPS,1     IFEQ '*'
     C                     SETON                     44
F2  C                     END
D2  C           TPS,2     IFEQ '*'
     C                     SETON                     45
F2  C                     END
D2  C           TPS,3     IFEQ '*'
     C                     SETON                     46
F2  C                     END
F1  C                     END
D1  C           NBPAP     IFEQ 5
D2  C           TPS,1     IFEQ '*'
     C                     SETON                     43
F2  C                     END
D2  C           TPS,2     IFEQ '*'
     C                     SETON                     44
F2  C                     END
D2  C           TPS,3     IFEQ '*'
     C                     SETON                     45
F2  C                     END
D2  C           TPS,4     IFEQ '*'
     C                     SETON                     46
F2  C                     END
D2  C           TPS,5     IFEQ '*'
     C                     SETON                     47
F2  C                     END
F1  C                     END
     *
    C                     ENDSR
      /EJECT
     ***********48*********************************************
     * S/PROGRAMME : CONTROLE COMMUN FMT03 ET FMT13  - 1° -   *
     **********************************************************
     C/SPACE 3
    C           CTLC01    BEGSR                                       E2*
     *          ---------------
    C* USINE FABRICATION
    C*-------------------------
     C                     SETOF                     98
     C/SPACE 1
     C                     MOVEL'USDE'    PXARGU
     C                     MOVE USINE     PXVALE    P
     C           CLE3      CHAINPARAME               51
     C  N51      PXMONT    COMP 999                      51
    C   51                GOTO TAGC01                     MESSAGE 47
    C*
D1  C           USINE     IFEQ 3
D2  C           CCOL      IFEQ 1
    C           CCOL      OREQ 4
    C           CCOL      OREQ 5
    C           CCOL      OREQ 6
    C           CCOL      OREQ 7
    C*                    SETON                         64
    C*                    GOTO TAGC01                     MESSAGE 49
F2  C                     END
F1  C                     END
    C*
D1  C           TDEC1     IFEQ 'I'
D2  C           USINE     IFNE 2
    C           USINE     OREQ 2
    C           TDEC3     ANDEQ'6'
     C                     SETON                         64
    C                     GOTO TAGC01                     MESSAGE 49
F2  C                     END
F1  C                     END
    C* TOLERANCE
    C*-------------------------
D1  C           PROMO     IFNE *BLANK
    C           ZERO      ANDNE*BLANK
    C           PROMO     ORNE *BLANK
    C           MICLI     ANDNE*ZEROS
    C           PROMO     ORNE *BLANK
    C           MACLI     ANDNE*ZEROS
    C           ZERO      ORNE *BLANK
    C           MICLI     ANDNE*ZEROS
    C           ZERO      ORNE *BLANK
    C           MACLI     ANDNE*ZEROS
     C                     SETON                     62
    C                     GOTO TAGC01                     MESSAGE 48
F1  C                     END
    C* DOUBLE DOUBLE OU CANNELURES CROISSÉES
    C*---------------------------------------
D1  C           *IN08     IFEQ '1'
     C                     MOVEL'TOND'    PXARGU
     C                     MOVELSIDD      PXVALE    P
     C           CLE3      CHAINPARAME               90
    C   90                GOTO TAGC01                     MESSAGE 177
F1  C                     END
    C* TYPE GAUFRAGE
    C*-------------------------
D1  C           GFRA      IFNE *BLANKS
     C                     MOVEL'GAUF'    PXARGU
     C                     MOVE GFRA      PXVALE    P
     C           CLE3      CHAINPARAME               52
    C   52                GOTO TAGC01                     MESSAGE 32
    C*          CCOL      IFEQ 9                          SD 709643
    C*          CCOL      OREQ 6
    C*                    SETON                     52
    C*                    GOTO TAGC01
    C*                    END
F1  C                     END
D1  C           GFRA2     IFNE *BLANKS
    C           GFRA      CABEQ*BLANKS   TAGC01         52
     C                     MOVEL'GAUF'    PXARGU
     C                     MOVE GFRA2     PXVALE    P
     C           CLE3      CHAINPARAME               52
    C   52                GOTO TAGC01                     MESSAGE 32
    C*          CCOL      IFEQ 9                          SD 709643
    C*          CCOL      OREQ 6
    C*                    SETON                     52
    C*                    GOTO TAGC01
    C*                    END
D2  C           GFRA      IFEQ *BLANKS
     C                     SETON                     52
    C                     GOTO TAGC01
F2  C                     END
D2  C           GFRA      IFEQ 'GD'
    C           GFRA2     ANDEQ'GD'
     C                     SETON                     52
    C                     GOTO TAGC01
F2  C                     END
     C                     MOVELGFRA      XG1     1
     C                     MOVELGFRA2     XG2     1
D2  C           XG2       IFEQ 'G'
    C           XG1       ANDEQ'X'
    C           GFRA2     ANDNE'GD'
     C                     SETON                     52
    C                     GOTO TAGC01
F2  C                     END
F1  C                     END
    C* TYPE COLLE ET DEPOT
    C*-------------------------
D1  C           COLRH     IFNE *BLANKS
     C                     MOVEL'TCOL'    PXARGU
     C                     MOVE COLRH     PXVALE    P
     C           CLE3      CHAINPARAME               53    MESSAGE 37
    C   53                GOTO TAGC01
    C*
D2  C           COLRH     IFEQ 'PE'                       COMPLEXEUSE
D3  C           DEPCOL    IFLT 8
    C           DEPCOL    ORGT 60
     C                     SETON                     63
    C                     GOTO TAGC01
F3  C                     END
X2  C                     ELSE
D3  C           COLRH     IFEQ 'PL'                       PELLICULEUSE
D4  C           DEPCOL    IFLT 2
    C           DEPCOL    ORGT 5
     C                     SETON                     63
    C                     GOTO TAGC01
F4  C                     END
X3  C                     ELSE
    C           DEPCOL    CABNE*ZEROS    TAGC01     6363  MESSAGE 200
    C           COUCOL    CABNE*BLANKS   TAGC01     6363
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           CCOL      IFEQ 8                          ACHETE
     C                     SETON                     53
    C                     GOTO TAGC01
F2  C                     END
F1  C                     END
    C* TYPE DECOUPAGE
    C*-------------------------
D1  C           TDECO     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TDEC1     XDECA1
     C                     MOVE '0'       XDECA2
     C                     MOVE TDEC3     XDECA3
     C                     MOVELXDECKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XDECOUPS'TBLNOM
     C           KTBA01    CHAINXTBASE01             54    MESSAGE 39
    C   54                GOTO TAGC01
     C                     MOVELTBVRES    XDECS1
     C                     MOVELXDEC01    LIBDEC
F1  C                     END
    C* 1° CODE ASSEMBLAGE
    C*-------------------------
D1  C           COAS1     IFNE *ZEROS
     C                     MOVEL'ASSB'    PXARGU
     C                     MOVE COAS1     PXVALE    P
     C           CLE3      CHAINPARAME               55
    C   55                GOTO TAGC01                     MESSAGE 39
D2  C           COAS1     IFEQ 21
    C           COAS1     OREQ 22
    C           COAS1     OREQ 11
     C                     SETON                     55    MESSAGE 39
    C                     GOTO TAGC01
F2  C                     END
     C                     MOVELPXLIBE    LIBAS1
D2  C           COAS1     IFEQ 45
    C           TTRACE    ANDEQ*BLANK
     C                     SETON                     55    MESSAGE 39
    C                     GOTO TAGC01
F2  C                     END
D2  C           COAS1     IFEQ 44
    C           TYPPO1    ANDNE'C'
     C                     SETON                     55    MESSAGE 39
    C                     GOTO TAGC01
F2  C                     END
    C*
D2  C           FACON     IFEQ 7
    C           COAS1     CABGT20        TAGC01     55    MESSAGE 39
F2  C                     END
D2  C           FACON     IFEQ 8
    C           COAS1     CABLT21        TAGC01       55  MESSAGE 39
F2  C                     END
X1  C                     ELSE
    C           FACON     CABEQ8         TAGC01         55MESSAGE 39
    C           FACON     CABEQ7         TAGC01         55MESSAGE 39
     C                     MOVEL*BLANKS   LIBAS1
F1  C                     END
    C* 2° CODE ASSEMBLAGE
    C*-------------------------
D1  C           COAS2     IFNE *ZEROS
     C                     MOVEL'ASSB'    PXARGU
     C                     MOVE COAS2     PXVALE    P
     C           CLE3      CHAINPARAME               56    MESSAGE 40
    C   56                GOTO TAGC01
D2  C           COAS2     IFEQ 21
    C           COAS2     OREQ 22
    C           COAS2     OREQ 11
    C           COAS2     OREQ 44
     C                     SETON                     56    MESSAGE 40
    C                     GOTO TAGC01
F2  C                     END
     C                     MOVELPXLIBE    LIBAS2
    C*
D2  C           COAS2     IFEQ 45
    C           TTRACE    ANDEQ*BLANK
     C                     SETON                     56    MESSAGE 39
    C                     GOTO TAGC01
F2  C                     END
D2  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
    C           TYPPO1    CABNE'P'       TAGC01     5656  MESSAGE 40
F2  C                     END
D2  C           COAS2     IFNE 31
    C           COAS2     ANDNE33
    C           TYPPO1    CABEQ'P'       TAGC01         56MESSAGE 40
F2  C                     END
    C*
D2  C           FACON     IFEQ 7
    C           COAS2     CABGT20        TAGC01     56    MESSAGE 40
F2  C                     END
    C*          FACON     IFEQ 8
    C*          COAS2     CABLT21        TAGC01       56  MESSAGE 40
    C*                    END
X1  C                     ELSE
    C           TYPPO1    CABEQ'P'       TAGC01         56MESSAGE 40
     C                     MOVEL*BLANKS   LIBAS2
F1  C                     END
    C*
D1  C           TYPPO1    IFEQ 'R'
D2  C           COAS2     IFEQ *ZEROS
D3  C           COAS1     IFNE 30
    C           COAS1     ANDNE41
     C                     SETON                     55
    C                     GOTO TAGC01                     MESSAGE 49
F3  C                     END
X2  C                     ELSE
D3  C           COAS2     IFNE 30
    C           COAS2     ANDNE41
    C           COAS1     ANDNE30
    C           COAS1     ANDNE41
     C                     SETON                     56
    C                     GOTO TAGC01                     MESSAGE 40
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           COAS1     IFEQ 30
    C           COAS1     OREQ 41
    C           COAS2     OREQ 30
    C           COAS2     OREQ 41
     C                     SETON                     56    MESSAGE 40
    C                     GOTO TAGC01
F2  C                     END
F1  C                     END
    C* IMPRESSION EXTERIEURE
    C*-------------------------
D1  C           TIMPEX    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPEX    PXVALE    P
     C           CLE3      CHAINPARAME               57    MESSAGE 41
    C   57                GOTO TAGC01
     C                     MOVELPXLIBE    LIBIME
D2  C           TIMPEX    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPEX    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIME
     C                     Z-ADD2         USEXT
F2  C                     END
D2  C           ONDUL     IFEQ 7
    C           TIMPEX    ANDNE2
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F2  C                     END
D2  C           TIMPEX    IFEQ 4
D3  C           ONDUL     IFNE *ZEROS
    C           CCOL      ANDEQ*ZEROS
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F3  C                     END
D3  C           COUI3     IFEQ 3
    C           CCOL      ANDEQ6
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBIME
F1  C                     END
    C* IMPRESSION INTERIEURE
    C*-------------------------
D1  C           TIMPIN    IFNE *ZEROS
     C                     MOVEL'IMPR'    PXARGU
     C                     MOVE TIMPIN    PXVALE    P
     C           CLE3      CHAINPARAME               58    MESSAGE 42
    C   58                GOTO TAGC01
     C                     MOVELPXLIBE    LIBIMI
D2  C           TIMPIN    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPIN    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIMI
     C                     Z-ADD2         USINT
F2  C                     END
D2  C           ONDUL     IFEQ 7
    C           TIMPIN    ANDNE2
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F2  C                     END
D2  C           TIMPIN    IFEQ 4
D3  C           ONDUL     IFNE *ZEROS
    C           CCOL      ANDEQ*ZEROS
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F3  C                     END
D3  C           CCOL      IFEQ 6
     C                     SETON                     88    MESSAGE 201
    C                     GOTO TAGC01
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBIMI
F1  C                     END
    C* DORURE
    C*-------------------------
D1  C           CODDOR    IFEQ '*'
D2  C           FORL      IFEQ *ZEROS
     C                     SETON                     93    MESSAGE 172
    C                     GOTO TAGC01
F2  C                     END
F1  C                     END
     *
    C                     GOTO FCTL01
     C           TAGC01    TAG
    C*          ---------------
     C                     SETON                     98
     *
    C           FCTL01    ENDSR
      /EJECT
     **********************************************************
     * S/PROGRAMME : CONTROLE COMMUN FMT03 ET FMT13 - 2° -    *
     **********************************************************
     C/SPACE 3
    C           CTLC02    BEGSR                                       E2*
     *          ---------------
     C                     SETOF                     98
     C/SPACE 1
    C* TYPE MATERIEL FORME
    C*-------------------------
D1  C           MATFC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATFC     PXVALE    P
     C           CLE3      CHAINPARAME               59
    C   59                GOTO TAGC02                     MESSAGE 43
     C                     MOVELPXLIBE    LIBMF
    C           MATFM     CABEQ*ZEROS    TAGC02         59
D2  C           MATFC     IFNE 'E'
    C           MATFM     CABEQ*ZEROS    TAGC02         59
F2  C                     END
X1  C                     ELSE
    C           MATFM     CABNE*ZEROS    TAGC02     5959
F1  C                     END
    C* TYPE MATERIEL SEPARATEUR
    C*-------------------------
D1  C           MATSC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATSC     PXVALE    P
     C           CLE3      CHAINPARAME               60
    C   60                GOTO TAGC02                     MESSAGE 44
     C                     MOVELPXLIBE    LIBMS
F1  C                     END
D1  C           MATSC     IFEQ *BLANKS
    C           MATSC     OREQ 'E'
    C           MATSM     CABNE*ZEROS    TAGC02     6060
X1  C                     ELSE
    C           MATSM     CABEQ*ZEROS    TAGC02         60
F1  C                     END
    C* TYPE MATERIEL GAUFRAGE
    C*-------------------------
D1  C           MATGC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATGC     PXVALE    P
     C           CLE3      CHAINPARAME               61
    C   61                GOTO TAGC02                     MESSAGE 45
     C                     MOVELPXLIBE    LIBMG
F1  C                     END
D1  C           MATGC     IFEQ *BLANKS
    C           MATGC     OREQ 'E'
    C           MATGM     CABNE*ZEROS    TAGC02     6161
X1  C                     ELSE
    C           MATGM     CABEQ*ZEROS    TAGC02         61
F1  C                     END
    C* TYPE MATERIEL DORURE
    C*-------------------------
D1  C           MATDC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATDC     PXVALE    P
     C           CLE3      CHAINPARAME               62
    C   62                GOTO TAGC02                     MESSAGE 46
     C                     MOVELPXLIBE    LIBMD
F1  C                     END
D1  C           MATDC     IFEQ *BLANKS
    C           MATDC     OREQ 'E'
    C           MATDM     CABNE*ZEROS    TAGC02     6262
X1  C                     ELSE
    C           MATDM     CABEQ*ZEROS    TAGC02         62
F1  C                     END
    C* TYPE MATERIEL BRAILLE
    C*-------------------------
D1  C           MATBC     IFNE *BLANKS
     C                     MOVEL'CMAT'    PXARGU
     C                     MOVE MATBC     PXVALE    P
     C           CLE3      CHAINPARAME               97
    C   97                GOTO TAGC02                     MESSAGE 46
     C                     MOVELPXLIBE    LIBBM
F1  C                     END
D1  C           MATBC     IFEQ *BLANKS
    C           MATBC     OREQ 'E'
    C           MATBM     CABNE*ZEROS    TAGC02     9797
X1  C                     ELSE
    C           MATBM     CABEQ*ZEROS    TAGC02         97
F1  C                     END
     *
    C                     GOTO FCTL02
     C           TAGC02    TAG
    C*          ---------------
     C                     SETON                     98
     *
    C           FCTL02    ENDSR
      /EJECT
     **********************************************************
     * S/PROGRAMME : CONTROLE COMMUN SOUS TRAITANCE           *
     **********************************************************
     C/SPACE 3
    C           CTLC03    BEGSR                                       E2*
     *          ---------------
     C                     SETOF                     98
     C                     MOVE *BLANK    GENCO1  1
     C                     MOVE *BLANK    GENCO2  1
     C/SPACE 1
    C* 1° SOUS TRAITANCE
    C*-------------------------
D1  C           STCOD1    IFNE *BLANKS
D2  C           STREG1    IFEQ *ZEROS
    C           STROU1    ANDEQ*ZEROS
    C           STDEC1    ANDEQ*ZEROS
     C                     SETON                     54     MESSAGE 113
    C                     GOTO TAGC03
F2  C                     END
    C*
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD1    PXVALE    P
     C           CLE3      CHAINPARAME               54
    C           *IN54     CABEQ'1'       TAGC03
     C                     MOVELPXLIBE    LIBST1
D2  C           PXMONT    IFGE 21
    C           STDEC1    ANDNE*ZEROS
     C                     SETON                     54     MESSAGE 113
    C                     GOTO TAGC03
F2  C                     END
D2  C           STCOD1    IFEQ 'A'
     C                     MOVE '*'       GENCO1
F2  C                     END
    C*
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBST1
D2  C           STREG1    IFNE *ZEROS
    C           STROU1    ORNE *ZEROS
    C           STDEC1    ORNE *ZEROS
     C                     SETON                     54     MESSAGE 113
    C                     GOTO TAGC03
F2  C                     END
    C*
D2  C           STPSO1    IFNE *ZEROS
     C           STPSO1    SETLLPRODUL18                 50
D3  C           *IN50     IFNE '1'
     C                     SETON                     54     MESSAGE 113
    C                     GOTO TAGC03
F3  C                     END
F2  C                     END
     *
F1  C                     END
     C/SPACE 2
    C* 2° SOUS TRAITANCE
    C*-------------------------
D1  C           STCOD2    IFNE *BLANKS
D2  C           STREG2    IFEQ *ZEROS
    C           STROU2    ANDEQ*ZEROS
    C           STDEC2    ANDEQ*ZEROS
     C                     SETON                     55     MESSAGE 114
    C                     GOTO TAGC03
F2  C                     END
    C*
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD2    PXVALE    P
     C           CLE3      CHAINPARAME               55
    C           *IN55     CABEQ'1'       TAGC03
     C                     MOVELPXLIBE    LIBST2
D2  C           PXMONT    IFGE 21
    C           STDEC2    ANDNE*ZEROS
     C                     SETON                     55     MESSAGE 114
    C                     GOTO TAGC03
F2  C                     END
D2  C           STCOD2    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBST2
D2  C           STREG2    IFNE *ZEROS
    C           STROU2    ORNE *ZEROS
    C           STDEC2    ORNE *ZEROS
     C                     SETON                     55     MESSAGE 114
    C                     GOTO TAGC03
F2  C                     END
    C*
D2  C           STPSO2    IFNE *ZEROS
     C           STPSO2    SETLLPRODUL18                 50
D3  C           *IN50     IFNE '1'
     C                     SETON                     55     MESSAGE 114
    C                     GOTO TAGC03
F3  C                     END
F2  C                     END
     *
F1  C                     END
     C/SPACE 2
    C* 3° SOUS TRAITANCE
    C*-------------------------
D1  C           STCOD3    IFNE *BLANKS
D2  C           STREG3    IFEQ *ZEROS
    C           STROU3    ANDEQ*ZEROS
    C           STDEC3    ANDEQ*ZEROS
     C                     SETON                     56     MESSAGE 115
    C                     GOTO TAGC03
F2  C                     END
    C*
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD3    PXVALE    P
     C           CLE3      CHAINPARAME               56
    C           *IN56     CABEQ'1'       TAGC03
     C                     MOVELPXLIBE    LIBST3
D2  C           PXMONT    IFGE 21
    C           STDEC3    ANDNE*ZEROS
     C                     SETON                     56     MESSAGE 115
    C                     GOTO TAGC03
F2  C                     END
D2  C           STCOD3    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBST3
D2  C           STREG3    IFNE *ZEROS
    C           STROU3    ORNE *ZEROS
    C           STDEC3    ORNE *ZEROS
     C                     SETON                     56     MESSAGE 115
    C                     GOTO TAGC03
F2  C                     END
    C*
D2  C           STPSO3    IFNE *ZEROS
     C           STPSO3    SETLLPRODUL18                 50
D3  C           *IN50     IFNE '1'
     C                     SETON                     56     MESSAGE 115
    C                     GOTO TAGC03
F3  C                     END
F2  C                     END
     *
F1  C                     END
     C/SPACE 2
    C* 4° SOUS TRAITANCE
    C*-------------------------
D1  C           STCOD4    IFNE *BLANKS
D2  C           STREG4    IFEQ *ZEROS
    C           STROU4    ANDEQ*ZEROS
    C           STDEC4    ANDEQ*ZEROS
     C                     SETON                     57     MESSAGE 116
    C                     GOTO TAGC03
F2  C                     END
    C*
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE STCOD4    PXVALE    P
     C           CLE3      CHAINPARAME               57
    C           *IN57     CABEQ'1'       TAGC03
     C                     MOVELPXLIBE    LIBST4
D2  C           PXMONT    IFGE 21
    C           STDEC1    ANDNE*ZEROS
     C                     SETON                     54     MESSAGE 113
    C                     GOTO TAGC03
F2  C                     END
D2  C           STCOD4    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBST4
D2  C           STREG4    IFNE *ZEROS
    C           STROU4    ORNE *ZEROS
    C           STDEC4    ORNE *ZEROS
     C                     SETON                     57     MESSAGE 116
    C                     GOTO TAGC03
F2  C                     END
    C*
D2  C           STPSO1    IFNE *ZEROS
     C           STPSO1    SETLLPRODUL18                 50
D3  C           *IN50     IFNE '1'
     C                     SETON                     57     MESSAGE 116
    C                     GOTO TAGC03
F3  C                     END
F2  C                     END
     *
F1  C                     END
     *
    C*
D1  C           GENCO1    IFEQ ' '
    C           AFFL1     ANDNE*ZEROS
    C           GENCO1    OREQ '*'
    C           AFFL1     ANDEQ*ZEROS
     C                     SETON                     61
    C                     GOTO TAGC03
F1  C                     END
D1  C           AFFL1     IFEQ *ZEROS
    C           AFFD1     ANDNE*ZEROS
    C           AFFL1     ORNE *ZEROS
    C           AFFD1     ANDEQ*ZEROS
     C                     SETON                     62
    C                     GOTO TAGC03
F1  C                     END
D1  C           GENCO2    IFEQ ' '
    C           AFFL2     ANDNE*ZEROS
    C           GENCO2    OREQ '*'
    C           AFFL2     ANDEQ*ZEROS
     C                     SETON                     63
    C                     GOTO TAGC03
F1  C                     END
D1  C           AFFL2     IFEQ *ZEROS
    C           AFFD2     ANDNE*ZEROS
    C           AFFL2     ORNE *ZEROS
    C           AFFD2     ANDEQ*ZEROS
     C                     SETON                     64
    C                     GOTO TAGC03
F1  C                     END
    C                     GOTO FCTL03
     C           TAGC03    TAG
    C*          ---------------
     C                     SETON                     98
     *
    C           FCTL03    ENDSR
      /EJECT
     **********************************************************
     * S/PROGRAMME : CONTROLE COMMUN QUANTITES                *
     **********************************************************
     C/SPACE 3
    C           CTLC04    BEGSR                                       E2*
     *          ---------------
     C                     SETOF                     98
D1  C           TYPDEV    IFEQ 1
    C           TYPDEV    OREQ 5
     C                     Z-ADD1         TYPD    10
X1  C                     ELSE
     C                     Z-ADD*ZEROS    TYPD
F1  C                     END
     C/SPACE 1
D1  C           QTTOT1    IFEQ *ZEROS
     C                     SETON                     71    MESSAGE 141
    C                     GOTO TAGC04
X1  C                     ELSE
D2  C           NBLIV1    IFEQ *ZEROS
     C                     Z-ADDNBFAC1    NBLIV   20
X2  C                     ELSE
     C                     Z-ADDNBLIV1    NBLIV
F2  C                     END
D2  C           FRLIV1    IFEQ *ZEROS
    C           NBLIV     ANDEQNBFAC1
    C           NBLIV     ANDGT1
     C                     Z-ADD1         FRLIV   20
X2  C                     ELSE
     C                     Z-ADDFRLIV1    FRLIV
F2  C                     END
     C           NBIMP1    ADD  NBIRE1    NBIT    20
D2  C           NBIT      IFNE *ZEROS
    C           *IN42     ANDEQ'0'
    C           NBIT      OREQ *ZEROS
    C           *IN42     ANDEQ'1'
    C           NBFAC1    ORLT NBIT
    C           *IN42     ANDEQ'1'
    C           NBFAC1    OREQ *ZEROS
    C           NBLIV     ORLT NBFAC1
    C           TYPD      ANDEQ1
    C           NBLIV     ORGT 1
    C           FRLIV     ANDEQ*ZEROS
    C           TYPD      ANDEQ1
     C                     SETON                     72    MESSAGE 142
    C                     GOTO TAGC04
F2  C                     END
     C           QTTOT1    DIV  NBLIV     QTLIVX  80
D2  C           QTLIVX    IFGE 10000000
     C                     SETON                     72    MESSAGE 142
    C                     GOTO TAGC04
F2  C                     END
F1  C                     END
     *
D1  C           QTTOT2    IFEQ *ZEROS
D2  C           NBIMP2    IFNE *ZEROS
    C           NBIRE2    ORNE *ZEROS
    C           NBFAC2    ORNE *ZEROS
    C           NBLIV2    ORNE *ZEROS
    C           FRLIV2    ORNE *ZEROS
    C           RASP21    ORNE *ZEROS
    C           RASP22    ORNE *ZEROS
    C           RASP23    ORNE *ZEROS
    C           RASP24    ORNE *ZEROS
    C           RASP25    ORNE *ZEROS
     C                     SETON                     73    MESSAGE 143
    C                     GOTO TAGC04
F2  C                     END
X1  C                     ELSE
D2  C           NBLIV2    IFEQ *ZEROS
     C                     Z-ADDNBFAC2    NBLIV
X2  C                     ELSE
     C                     Z-ADDNBLIV2    NBLIV
F2  C                     END
D2  C           FRLIV2    IFEQ *ZEROS
    C           NBLIV     ANDEQNBFAC2
    C           NBLIV     ANDGT1
     C                     Z-ADD1         FRLIV
X2  C                     ELSE
     C                     Z-ADDFRLIV2    FRLIV
F2  C                     END
     C           NBIMP2    ADD  NBIRE2    NBIT
D2  C           NBIT      IFNE *ZEROS
    C           *IN42     ANDEQ'0'
    C           NBIT      OREQ *ZEROS
    C           *IN42     ANDEQ'1'
    C           NBFAC2    ORLT NBIT
    C           *IN42     ANDEQ'1'
    C           NBFAC2    OREQ *ZEROS
    C           NBLIV     ORLT NBFAC2
    C           TYPD      ANDEQ1
    C           NBLIV     ORGT 1
    C           FRLIV     ANDEQ*ZEROS
    C           TYPD      ANDEQ1
     C                     SETON                     74    MESSAGE 144
    C                     GOTO TAGC04
F2  C                     END
     C           QTTOT2    DIV  NBLIV     QTLIVX  80
D2  C           QTLIVX    IFGE 10000000
     C                     SETON                     74    MESSAGE 144
    C                     GOTO TAGC04
F2  C                     END
F1  C                     END
     *
D1  C           QTTOT3    IFEQ *ZEROS
D2  C           NBIMP3    IFNE *ZEROS
    C           NBIRE3    ORNE *ZEROS
    C           NBFAC3    ORNE *ZEROS
    C           NBLIV3    ORNE *ZEROS
    C           FRLIV3    ORNE *ZEROS
    C           RASP31    ORNE *ZEROS
    C           RASP32    ORNE *ZEROS
    C           RASP33    ORNE *ZEROS
    C           RASP34    ORNE *ZEROS
    C           RASP35    ORNE *ZEROS
     C                     SETON                     75    MESSAGE 145
    C                     GOTO TAGC04
F2  C                     END
X1  C                     ELSE
D2  C           NBLIV3    IFEQ *ZEROS
     C                     Z-ADDNBFAC3    NBLIV
X2  C                     ELSE
     C                     Z-ADDNBLIV3    NBLIV
F2  C                     END
D2  C           FRLIV3    IFEQ *ZEROS
    C           NBLIV     ANDEQNBFAC3
    C           NBLIV     ANDGT1
     C                     Z-ADD1         FRLIV
X2  C                     ELSE
     C                     Z-ADDFRLIV3    FRLIV
F2  C                     END
     C           NBIMP3    ADD  NBIRE3    NBIT
D2  C           NBIT      IFNE *ZEROS
    C           *IN42     ANDEQ'0'
    C           NBIT      OREQ *ZEROS
    C           *IN42     ANDEQ'1'
    C           NBFAC3    ORLT NBIT
    C           *IN42     ANDEQ'1'
    C           NBFAC3    OREQ *ZEROS
    C           NBLIV     ORLT NBFAC3
    C           TYPD      ANDEQ1
    C           NBLIV     ORGT 1
    C           FRLIV     ANDEQ*ZEROS
    C           TYPD      ANDEQ1
     C                     SETON                     76    MESSAGE 146
    C                     GOTO TAGC04
F2  C                     END
     C           QTTOT3    DIV  NBLIV     QTLIVX
D2  C           QTLIVX    IFGE 10000000
     C                     SETON                     76    MESSAGE 146
    C                     GOTO TAGC04
F2  C                     END
F1  C                     END
     *
D1  C           QTTOT4    IFEQ *ZEROS
D2  C           NBIMP4    IFNE *ZEROS
    C           NBIRE4    ORNE *ZEROS
    C           NBFAC4    ORNE *ZEROS
    C           NBLIV4    ORNE *ZEROS
    C           FRLIV4    ORNE *ZEROS
    C           RASP41    ORNE *ZEROS
    C           RASP42    ORNE *ZEROS
    C           RASP43    ORNE *ZEROS
    C           RASP44    ORNE *ZEROS
    C           RASP45    ORNE *ZEROS
     C                     SETON                     77    MESSAGE 147
    C                     GOTO TAGC04
F2  C                     END
X1  C                     ELSE
D2  C           NBLIV4    IFEQ *ZEROS
     C                     Z-ADDNBFAC4    NBLIV
X2  C                     ELSE
     C                     Z-ADDNBLIV4    NBLIV
F2  C                     END
D2  C           FRLIV4    IFEQ *ZEROS
    C           NBLIV     ANDEQNBFAC4
    C           NBLIV     ANDGT1
     C                     Z-ADD1         FRLIV
X2  C                     ELSE
     C                     Z-ADDFRLIV4    FRLIV
F2  C                     END
     C           NBIMP4    ADD  NBIRE4    NBIT
D2  C           NBIT      IFNE *ZEROS
    C           *IN42     ANDEQ'0'
    C           NBIT      OREQ *ZEROS
    C           *IN42     ANDEQ'1'
    C           NBFAC4    ORLT NBIT
    C           *IN42     ANDEQ'1'
    C           NBFAC4    OREQ *ZEROS
    C           NBLIV     ORLT NBFAC4
    C           TYPD      ANDEQ1
    C           NBLIV     ORGT 1
    C           FRLIV     ANDEQ*ZEROS
    C           TYPD      ANDEQ1
     C                     SETON                     78    MESSAGE 148
    C                     GOTO TAGC04
F2  C                     END
     C           QTTOT4    DIV  NBLIV     QTLIVX
D2  C           QTLIVX    IFGE 10000000
     C                     SETON                     78    MESSAGE 148
    C                     GOTO TAGC04
F2  C                     END
F1  C                     END
     *
    C                     GOTO FCTL04
     C           TAGC04    TAG
    C*          ---------------
     C                     SETON                     98
     *
    C           FCTL04    ENDSR
      /EJECT
     **********************************************************
     * S/PROGRAMME : CONTROLE DIMENSIONS                      *
     **********************************************************
     C/SPACE 3
     *--------------------------------------------------------*
     * SI CANNELURES CROISSÉES
     *--------------------------------------------------------*
    C           CANCRO    BEGSR                                       E2*
     *
D1  C           FMINH     IFEQ *ZEROS
    C           FMINL     ANDEQ*ZEROS
    C                     GOTO SCANCR
F1  C                     END
     *
D1  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCANCR
F1  C                     END
     *
     C           ONDL      SUB  FMINL     X4A
     C           ONDH      SUB  FMINH     X4B
D1  C           ONDL      IFGT ONDH                       PRISE PINCE
D2  C           X4A       IFLT 0                            GRAND COTE
    C           X4A       ORGT 25                                     000
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
X1  C                     ELSE
D2  C           X4A       IFLT 0
    C           X4A       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END
    C*
D1  C           COUI3     IFEQ 1
D2  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
    C                     GOTO SCANCR
F2  C                     END
    C*
D2  C           ICEI3     IFEQ 'O'                        CROISSÉES
     C           FORL      SUB  ONDH      X4A
     C           FORH      SUB  ONDL      X4B
X2  C                     ELSE                            PAS CROISSEES
     C           FORL      SUB  ONDL      X4A
     C           FORH      SUB  ONDH      X4B
F2  C                     END
D2  C           X4A       IFNE 5
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFNE 5
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END                                        7
    C*
     C                     EXSR CALLAI
     C                     ADD  20        LALAIZ
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D1  C           X1        IFNE 0
     C                     MOVE '0'       X41
F1  C                     END
D1  C           LMINI     IFNE X41
     C                     ADD  1         X41
D2  C           LMINI     IFNE X41
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END
    C           LMINI     CABGT150       SCANCR
     *
    C                     GOTO FCANCR
    C*
     C           SCANCR    TAG
     *          ---------------
     C                     SETON                     9598  MESSAGE 180
    C           FCANCR    ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * SI CHABANAIS
     *--------------------------------------------------------*
    C           CCHA      BEGSR                                       E2*
     *
D1  C           FMINH     IFEQ *ZEROS
    C           FMINL     ANDEQ*ZEROS
    C                     GOTO FCHAX
F1  C                     END
     *
D1  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCHAX
F1  C                     END
     *
     C           ONDL      SUB  FMINL     X4A
     C           ONDH      SUB  FMINH     X4B
D1  C           ONDL      IFGT ONDH                       PRISE PINCE
D2  C           X4A       IFLT 0                            GRAND COTE
    C           X4A       ORGT 25                         RV LE 15/3/2000
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCHAX
F2  C                     END
X1  C                     ELSE
D2  C           X4A       IFLT 0
    C           X4A       ORGT 25
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCHAX
F2  C                     END
F1  C                     END
    C*
D1  C           CCOL      IFEQ 1
D2  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
    C                     GOTO SCHAX
F2  C                     END
    C*
     C           FORL      SUB  ONDL      X4A
     C           FORH      SUB  ONDH      X4B
D2  C           X4A       IFNE 5
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFNE 5
    C                     GOTO SCHAX
F2  C                     END
F1  C                     END
    C*
     C                     EXSR CALLAI
     C                     ADD  20        LALAIZ
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D1  C           X1        IFNE 0
     C                     MOVE '0'       X41
F1  C                     END
D1  C           LMINI     IFNE X41
     C                     ADD  1         X41
D2  C           LMINI     IFNE X41
    C                     GOTO SCHAX
F2  C                     END
F1  C                     END
    C           LMINI     CABGT180       SCHAX
     *
    C                     GOTO FCHAX
     *
     C           SCHAX     TAG
     *          ---------------
     C                     SETON                     9398  MESSAGE 172
    C           FCHAX     ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * COMPLEXE
     *--------------------------------------------------------*
    C           CPLX      BEGSR                                       E2*
     *
D1  C           CCOL      IFEQ 7
D2  C           GRA1      IFLT GRA2                       HELIO: + LEGER
D3  C           TIMPEX    IFGT 2
    C                     GOTO SCPLX
F3  C                     END
D3  C           TIMPIN    IFNE *ZERO                      MARQUAGE
    C           TIMPIN    ANDNE3
    C           TIMPIN    ANDNE2
    C                     GOTO SCPLX
F3  C                     END
     *
X2  C                     ELSE
D3  C           TIMPIN    IFGT 2
    C                     GOTO SCPLX
F3  C                     END
D3  C           TIMPEX    IFNE *ZERO                      MARQUAGE
    C           TIMPEX    ANDNE3
    C           TIMPEX    ANDNE2
    C                     GOTO SCPLX
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           CCOL      IFEQ 4
D2  C           COLRH     IFNE 'PE'
    C           COLRH     ANDNE'PL'
    C                     GOTO SCPLX
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 7
D2  C           COLRH     IFNE 'HM'
    C           COLRH     ANDNE'PE'
    C           COLRH     ANDNE'VY'
    C           COLRH     ANDNE'PL'
    C                     GOTO SCPLX
F2  C                     END
F1  C                     END
     *
D1  C           LMINI     IFNE *ZEROS
    C           FLPEAP    ANDNE*ZEROS
    C           LMINI     OREQ *ZEROS
    C           FLPEAP    ANDEQ*ZEROS
     C                     SETON                     9698  MESSAGE 182
    C                     GOTO FCPLX
F1  C                     END
     *
D1  C           IAEI2     IFEQ 'O'
    C           FLPEAP    ANDEQ*ZEROS
     C                     SETON                     1998  MESSAGE 183
    C                     GOTO FCPLX
F1  C                     END
     *
    C           LMINI     CABGT145       SCPLX
     *
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 4
D2  C           FACON     IFEQ 1
D3  C           DECH      IFNE *ZEROS
    C                     GOTO SCPLX
F3  C                     END
D3  C           FLPEAP    IFNE *ZEROS
    C                     GOTO SCPLX
F3  C                     END
F2  C                     END
     *
D2  C           FLPEAP    IFNE *ZEROS
D3  C           FLPEAP    IFLT DECL
    C           FHPEAP    ORLT DECH
    C                     GOTO SCPLX
F3  C                     END
X2  C                     ELSE
     C           LAIZUT    ADD  15        X4
    C           X4        CABNELMIMI     SCPLX
F2  C                     END
    C*
X1  C                     ELSE
D2  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCPLX
F2  C                     END
     *
     C                     MOVE ONDH      X1
D2  C           X1        IFNE 0
    C           X1        ANDNE5
    C                     GOTO SCPLX
F2  C                     END
     C           ONDL      SUB  FMINL     X4A
     C           ONDH      SUB  FMINH     X4B
D2  C           ONDL      IFGT ONDH                       PRISE PINCE
D3  C           X4A       IFLT 14                           + GRAND COTE
    C           X4A       ORGT 18
    C                     GOTO SCPLX
F3  C                     END
D3  C           X4B       IFLT 20
    C           X4B       ORGT 24
    C                     GOTO SCPLX
F3  C                     END
X2  C                     ELSE
D3  C           X4B       IFLT 14
    C           X4B       ORGT 18
    C                     GOTO SCPLX
F3  C                     END
D3  C           X4A       IFLT 20
    C           X4A       ORGT 24
    C                     GOTO SCPLX
F3  C                     END
F2  C                     END
    C*
     C                     MOVE LMINI     X1
D2  C           X1        IFNE 0
    C           X1        ANDNE5
    C                     GOTO SCPLX
F2  C                     END
    C*
     C           LMIMI     SUB  ONDL      X4
D2  C           X4        IFLT 15
    C           X4        ORGT 19
    C                     GOTO SCPLX
F2  C                     END
F1  C                     END
     *
    C                     GOTO FCPLX
     *
     C           SCPLX     TAG
     *          ---------------
     C                     SETON                     8198  MESSAGE 66
    C           FCPLX     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * SANS FACONNAGE
     *--------------------------------------------------------*
    C           DIM0      BEGSR
     *          ---------------
    C*          TIMPEX    IFEQ *ZEROS
    C*                    SETON                     6598  MESSAGE 50
    C*                    ELSE
D1  C           TIMPEX    IFEQ 4
D2  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
    C           LMINI     ORNE *ZEROS
     C                     SETON                     6598  MESSAGE 50
F2  C                     END
X1  C                     ELSE
D2  C           LMINI     IFEQ *ZEROS
    C           FORL      ORNE *ZEROS
    C           FORH      ORNE *ZEROS
     C                     SETON                     6598  MESSAGE 50
F2  C                     END
F1  C                     END
    C*                    END
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * ROULEAUX BOBINES
     *--------------------------------------------------------*
    C           DIM12     BEGSR
     *          ---------------
D1  C           NBPAP     IFEQ 1                          SUR COMPLEXE
    C           NCXH      ANDEQ1
D2  C           LMINI     IFNE *ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIM12
F2  C                     END
X1  C                     ELSE
D2  C           LMINI     IFEQ *ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIM12
F2  C                     END
F1  C                     END
    C*
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIM12
F1  C                     END
    C*
D1  C           *IN44     IFEQ '0'
    C           LONBOB    ANDEQ*ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIM12
F1  C                     END
    C*
D1  C           NBPAP     IFEQ 1                          SUR COMPLEXE
    C           NCXH      ANDEQ1
    C                     GOTO FDIM12
F1  C                     END
     C                     MOVE LAIZUT    X1      10
D1  C           X1        IFNE *ZEROS
     C                     ADD  10        LAIZUT
     C                     MOVELLAIZUT    X3      30
    C           X3        CABEQLMICM     FDIM12
     C                     SUB  10        LAIZUT
X1  C                     ELSE
     C                     MOVELLAIZUT    X3
    C           X3        CABEQLMICM     FDIM12
F1  C                     END
     C                     ADD  19        LAIZUT
     C                     MOVE LAIZUT    X1
D1  C           X1        IFNE *ZEROS
     C                     ADD  10        LAIZUT
F1  C                     END
     C                     MOVELLAIZUT    X3
    C           X3        CABEQLMICM     FDIM12
     C                     SETON                     6698  MESSAGE 51
    C           FDIM12    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * DECOUPES
     *--------------------------------------------------------*
    C           DIM4      BEGSR
     *          ---------------
D1  C           DECH      IFEQ *ZEROS
     C                     SETON                     6798  MESSAGE 52
    C                     GOTO FDIM4
F1  C                     END
    C*
     C                     EXSR DIM12
    C           FDIM4     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * GAUFRE SUR MASSICOT
     *--------------------------------------------------------*
    C           DIM5A     BEGSR
     *          ---------------
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     6898  MESSAGE 53
    C                     GOTO FDIM5A
F1  C                     END
    C*
D1  C           DECH      IFEQ *ZEROS
     C                     SETON                     6898  MESSAGE 53
    C                     GOTO FDIM5A
F1  C                     END
    C*
     C           ONDL      DIV  DECL      Z1      30
     C           DECL      MULT Z1        X4      40
     C                     ADD  19        X4
D1  C           X4        IFNE ONDL
     C                     SETON                     6898  MESSAGE 53
    C                     GOTO FDIM5A
F1  C                     END
    C*
     C           ONDH      SUB  30        X4
     C           X4        DIV  DECH      Z2      30
     C           DECH      MULT Z2        X4
     C                     ADD  30        X4
D1  C           X4        IFNE ONDH
     C                     SETON                     6898  MESSAGE 53
    C                     GOTO FDIM5A
F1  C                     END
    C*
     C                     MOVE ONDL      X1
D1  C           X1        IFNE *ZEROS
     C           ONDL      ADD  10        X4
F1  C                     END
     C                     MOVELX4        X3
D1  C           X3        IFNE LMICM
     C                     SETON                     6898  MESSAGE 53
F1  C                     END
    C*
     C           Z1        MULT Z2        POSF1A
     C                     Z-ADD*ZEROS    POSF1B
    C*
    C           FDIM5A    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * LUGANO MITRAILLEUSE
     *--------------------------------------------------------*
    C           DIM5B     BEGSR
     *          ---------------
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F1  C                     END
    C*
D1  C           DECH      IFEQ *ZEROS
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F1  C                     END
    C*
D1  C           ONDL      IFEQ *ZEROS
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F1  C                     END
    C*
     C                     Z-ADD*ZEROS    POSF1B
    C*
     C           ONDL      DIV  DECL      Z1
     C           DECL      MULT Z1        X4
     C           ONDH      DIV  DECH      Z2
     C           DECH      MULT Z2        X4A     40
     C                     SUB  1         Z2
    C*
D1  C           ONDL      IFEQ X4
D2  C           ONDH      IFEQ X4A
     C           Z1        MULT Z2        POSF1A
    C                     GOTO SDIM5B
     *
X2  C                     ELSE
     C                     ADD  19        X4A
D3  C           ONDH      IFNE X4A
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
X3  C                     ELSE
D4  C           Z1        IFGT 6
D5  C           ONDL      IFLT ONDH
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F5  C                     END
     C                     SUB  1         Z1
F4  C                     END
     C           Z1        MULT Z2        POSF1A
    C                     GOTO SDIM5B
F3  C                     END
F2  C                     END
     *
X1  C                     ELSE
     C                     ADD  19        X4
D2  C           ONDH      IFEQ X4A
D3  C           ONDL      IFNE X4
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F3  C                     END
D3  C           Z2        IFGT 6
D4  C           ONDL      IFGT ONDH
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F4  C                     END
F3  C                     END
     C           Z1        MULT Z2        POSF1A
    C                     GOTO SDIM5B
     *
X2  C                     ELSE
     C                     ADD  19        X4A
D3  C           ONDH      IFNE X4A
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F3  C                     END
D3  C           ONDL      IFNE X4
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F3  C                     END
     C           Z1        MULT Z2        POSF1A
    C                     GOTO SDIM5B
F2  C                     END
F1  C                     END
     *
     C           SDIM5B    TAG
     *
D1  C           ACOTE     IFNE *ZEROS
     C           ACOTE     DIV  DECL      Z3      30
     C           DECL      MULT Z3        X4B     40
D2  C           X4B       IFNE *ZEROS
     C                     ADD  19        X4B
D3  C           X4B       IFNE *ZEROS
     C                     SETON                     6998  MESSAGE 54
    C                     GOTO FDIM5B
F3  C                     END
     C           Z3        MULT Z2        POSF2A
F2  C                     END
    C*
F1  C                     END
     *
     C           LMIMI     DIV  ONDL      X3
     C           ONDL      MULT X3        X4
     C                     ADD  ACOTE     X4
     C                     MOVE X4        X1
D1  C           X1        IFNE *ZEROS
     C                     ADD  10        X4
F1  C                     END
     C                     MOVELX4        X3
D1  C           X3        IFNE LMICM
     C                     ADD  19        X4
     C                     MOVE X4        X1
D2  C           X1        IFNE *ZEROS
     C                     ADD  10        X4
F2  C                     END
     C                     MOVELX4        X3
D2  C           X3        IFNE LMICM
     C                     SETON                     6998  MESSAGE 54
F2  C                     END
F1  C                     END
     *
    C           FDIM5B    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * DECOUPES SUR FORME
     *--------------------------------------------------------*
    C           DIM678    BEGSR
     *          ---------------
D1  C           CCOL      IFEQ 1
D2  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
     C                     SETON                     8298  MESSAGE 67
    C                     GOTO FDIM67
F2  C                     END
    C*
     C           ONDL      ADD  5         X4
D2  C           X4        IFNE FORL
     C                     SETON                     8298  MESSAGE 67
    C                     GOTO FDIM67
F2  C                     END
    C*
     C                     MOVE '0'       AX1
D2  C           TIMPEX    IFEQ 1
    C           TIMPEX    OREQ 2
    C           TIMPIN    OREQ 1
    C           TIMPIN    OREQ 2
D3  C           COUPEX    IFEQ 'R'
    C           COUPIN    OREQ 'R'
     C                     MOVE '1'       AX1     1
F3  C                     END
F2  C                     END
D2  C           AX1       IFEQ '1'
     C           ONDH      ADD  10        X4
X2  C                     ELSE
     C           ONDH      ADD  5         X4
F2  C                     END
D2  C           X4        IFNE FORH
     C                     SETON                     8298  MESSAGE 67
    C                     GOTO FDIM67
F2  C                     END
F1  C                     END
     C/SPACE 5
     * CONTROLE COMMUN
D1  C           POSF1B    IFNE *ZEROS
    C           POSFO     ANDEQ*ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
    C*
D1  C           TDECO     IFEQ *BLANKS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
     *
D1  C           POSF1A    IFEQ *ZEROS
    C           POSFO     ANDEQ*ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
     *
D1  C           POSF1A    IFNE *ZEROS
D2  C           ACOTE     IFEQ *ZEROS
    C           POSF2A    ANDNE*ZEROS
    C           ACOTE     ORNE *ZEROS
    C           POSF2A    ANDEQ*ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F2  C                     END
F1  C                     END
    C*
D1  C           TDEC1     IFEQ 'F'
    C           TDEC3     ANDEQ'6'
D2  C           POSFO     IFGE 10
    C           POSF1A    ORGE 10
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F2  C                     END
F1  C                     END
    C*
D1  C           FMINL     IFEQ *ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
    C*
D1  C           FMINH     IFEQ *ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
    C*
D1  C           SOMPOS    IFNE *ZEROS
    C           SOMPOS    ANDNEPOSFO
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIM67
F1  C                     END
    C*
     C           ONDL      SUB  FMINL     RESTEL  40
     C           ONDH      SUB  FMINH     RESTEH  40
     * SI COMPACT
D1  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
     C                     EXSR CARCOM                     COMPACT
    C                     GOTO FDIM67
F1  C                     END
     * SI PRODUIT GAUFRE
D1  C           ONDUL     IFEQ 7                          GAUFRE
     C                     EXSR GAUFRE
    C                     GOTO FDIM67
F1  C                     END
     * SI ONDULE ACHETE
D1  C           CCOL      IFEQ 8                          ACHETE
     C                     EXSR ACHETE
    C                     GOTO FDIM67
F1  C                     END
     * SI FORMAT/BOBINE
D1  C           CCOL      IFEQ 5                          FORMAT/BOBIN
     C                     EXSR FORBOB
    C                     GOTO FDIM67
F1  C                     END
     * SI BOBINE/BOBINE
D1  C           CCOL      IFEQ 6                          BOBINE/BOBIN
     C                     EXSR BOBBOB
    C                     GOTO FDIM67
F1  C                     END
     * SI JUPE
     *
D1  C           TSOND     IFEQ 'JU'
     C                     EXSR JUPE
    C                     GOTO FDIM67
F1  C                     END
     *
     C                     MOVE '0'       IND01   1
     C                     Z-ADD*ZEROS    NBI     10
     C           TIMPIN    ADD  TIMPEX    TOTI    20
     C                     MOVE ' '       OFFOUI  1
D1  C           TIMPEX    IFGT 0
     C                     ADD  1         NBI
F1  C                     END
D1  C           TIMPIN    IFGT 0
     C                     ADD  1         NBI
F1  C                     END
D1  C           TIMPEX    IFEQ 4
     C                     MOVE '*'       OFFOUI
F1  C                     END
D1  C           TIMPIN    IFEQ 4
     C                     MOVE '*'       OFFOUI
F1  C                     END
     * SANS IMPRESSION ET NON CONTRECOLLE
D1  C           TOTI      IFEQ *ZERO
D2  C           CCOL      IFEQ *ZERO
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
     C                     EXSR SANIMP
    C                     GOTO FDIM67
F2  C                     END
F1  C                     END
     * SANS IMPRESSION ET CONTRECOLLE
     * OU IMPRIME HELIO/FLEXO ET CONTRECOLLE
     * OU 1 IMPRESSION TYPO + 1 IMPRESSION OFFSET
     * OU 1 IMPRESSION OFFSET
     * OU 2 IMPRESSIONS OFFSET
D1  C           TOTI      IFEQ *ZERO
    C           CCOL      ANDNE*ZERO
    C           CCOL      ANDNE2
    C           CCOL      ANDNE3
    C           CCOL      ANDNE8
    C           CCOL      ANDNE9
    C           TOTI      OREQ 1
    C           CCOL      ANDNE*ZERO
    C           CCOL      ANDNE2
    C           CCOL      ANDNE3
    C           CCOL      ANDNE8
    C           CCOL      ANDNE9
    C           TOTI      OREQ 2
    C           NBI       ANDEQ1
    C           CCOL      ANDNE*ZERO
    C           CCOL      ANDNE2
    C           CCOL      ANDNE3
    C           CCOL      ANDNE8
    C           CCOL      ANDNE9
    C           TOTI      OREQ 7
    C           TOTI      OREQ 4
    C           NBI       ANDEQ1
    C           TOTI      OREQ 8
     C                     EXSR OFFSET
    C                     GOTO FDIM67
F1  C                     END
     * 1 IMPRESSION TYPO
     * OU 2 IMPRESSIONS TYPO
D1  C           TOTI      IFEQ 3
    C           NBI       ANDEQ1
    C           TOTI      OREQ 6
    C           NBI       ANDEQ2
    C           OFFOUI    ANDEQ' '
     C                     EXSR TYPO
    C                     GOTO FDIM67
F1  C                     END
     * 1 IMPRESSION HELIO/FLEXO
     * OU 1 IMPRESSION TYPO + 1 IMPRESSION HELIO/FLEXO
     * OU 2 IMPRESSIONS HELIO/FLEXO
D1  C           TOTI      IFEQ 4
    C           NBI       ANDEQ2
    C           TOTI      OREQ 5
    C           NBI       ANDEQ2
    C           OFFOUI    ANDEQ' '
    C           TOTI      OREQ 2
    C           NBI       ANDEQ2
    C           TOTI      OREQ 3
    C           NBI       ANDEQ2
     C                     EXSR HELFLE
    C                     GOTO FDIM67
F1  C                     END
D1  C           TOTI      IFEQ 1
    C           TOTI      OREQ 2
    C           NBI       ANDEQ1
D2  C           CCOL      IFEQ *ZERO
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 8
    C           CCOL      OREQ 9
     C                     EXSR HELFLE
    C                     GOTO FDIM67
F2  C                     END
F1  C                     END
     * 1 IMPRESSION OFFSET + 1 IMPRESSION HELIO/FLEXO
D1  C           TOTI      IFEQ 5
    C           NBI       ANDEQ2
    C           OFFOUI    ANDEQ'*'
    C           TOTI      OREQ 6
    C           NBI       ANDEQ2
    C           OFFOUI    ANDEQ'*'
D2  C           COUPEX    IFEQ 'R'
    C           COUPIN    OREQ 'R'
     C                     MOVE '1'       IND01
F2  C                     END
     C                     EXSR OFFSET
    C                     GOTO FDIM67
F1  C                     END
    C*
    C           FDIM67    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * LUGANO
     *--------------------------------------------------------*
    C           DIM9      BEGSR
     *          ---------------
D1  C           ONDL      IFEQ *ZEROS
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIM9
F1  C                     END
    C*
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIM9
F1  C                     END
    C*
D1  C           *IN45     IFEQ '1'
    C           DECH      ANDNEONDH
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIM9
F1  C                     END
    C*
     C           ONDL      DIV  DECL      X3
     C           DECL      MULT X3        X4
     C                     ADD  19        X4
D1  C           X4        IFNE ONDL
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIM9
F1  C                     END
    C*
     C                     Z-ADDX3        POSF1A
     C                     Z-ADD*ZEROS    POSF1B
    C*
D1  C           ACOTE     IFNE *ZEROS
     C           ACOTE     DIV  DECL      X3
     C           DECL      MULT X3        X4
     C                     ADD  19        X4
D2  C           X4        IFNE ONDL
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIM9
F2  C                     END
     C                     Z-ADDX3        POSF2A
F1  C                     END
    C*
     C           LMIMI     DIV  ONDL      X3
     C           ONDL      MULT X3        X4
     C                     ADD  ACOTE     X4
     C                     MOVE X4        X1
D1  C           X1        IFNE *ZEROS
     C                     ADD  10        X4
F1  C                     END
     C                     MOVELX4        X3
D1  C           X3        IFNE LMICM
     C                     SETON                     7198  MESSAGE 56
F1  C                     END
    C*
    C           FDIM9     ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * COMPLEXE SIMPLIFIE
     *--------------------------------------------------------*
    C           CPLXS     BEGSR                                       E2*
     *
D1  C           CCOL      IFEQ 7
D2  C           GRA1      IFLT GRA2                       HELIO: + LEGER
D3  C           TIMPEX    IFGT 2
    C                     GOTO SCPLXS
F3  C                     END
D3  C           TIMPIN    IFNE *ZERO                      MARQUAGE
    C           TIMPIN    ANDNE3
    C                     GOTO SCPLXS
F3  C                     END
     *
X2  C                     ELSE
D3  C           TIMPIN    IFGT 2
    C                     GOTO SCPLXS
F3  C                     END
D3  C           TIMPEX    IFNE *ZERO                      MARQUAGE
    C           TIMPEX    ANDNE3
    C                     GOTO SCPLXS
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           CCOL      IFEQ 4
D2  C           COLRH     IFNE 'PE'
    C           COLRH     ANDNE'PL'
    C                     GOTO SCPLXS
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 7
D2  C           COLRH     IFNE 'HM'
    C           COLRH     ANDNE'PE'
    C           COLRH     ANDNE'VY'
    C           COLRH     ANDNE'PL'
    C                     GOTO SCPLXS
F2  C                     END
F1  C                     END
     *
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 4
D2  C           FACON     IFEQ 1
    C           DECH      ANDNE*ZEROS
    C                     GOTO SCPLXS
F2  C                     END
     *
X1  C                     ELSE
D2  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCPLXS
F2  C                     END
F1  C                     END
     *
    C                     GOTO FCPLXS
     *
     C           SCPLXS    TAG
     *          ---------------
     C                     SETON                     8198  MESSAGE 66
    C           FCPLXS    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * SANS FACONNAGE SIMPLIFIE
     *--------------------------------------------------------*
    C           DIS0      BEGSR
     *          ---------------
D1  C           TIMPEX    IFEQ *ZEROS
     C                     SETON                     6598  MESSAGE 50
X1  C                     ELSE
D2  C           TIMPEX    IFEQ 4
D3  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
    C           LMINI     ORNE *ZEROS
     C                     SETON                     6598  MESSAGE 50
F3  C                     END
X2  C                     ELSE
D3  C           LMINI     IFEQ *ZEROS
    C           FORL      ORNE *ZEROS
    C           FORH      ORNE *ZEROS
     C                     SETON                     6598  MESSAGE 50
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * ROULEAUX BOBINES SIMPLIFIE
     *--------------------------------------------------------*
    C           DIS12     BEGSR
     *          ---------------
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIS12
F1  C                     END
    C*
D1  C           *IN44     IFEQ '0'
    C           LONBOB    ANDEQ*ZEROS
     C                     SETON                     6698  MESSAGE 51
    C                     GOTO FDIS12
F1  C                     END
    C*
    C           FDIS12    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * DECOUPES  SIMPLIFIE
     *--------------------------------------------------------*
    C           DIS45     BEGSR
     *          ---------------
D1  C           DECH      IFEQ *ZEROS
    C           DECL      OREQ *ZEROS
     C                     SETON                     6798  MESSAGE 52
F1  C                     END
    C*
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * DECOUPES SUR FORME  SIMPLIFIE
     *--------------------------------------------------------*
    C           DIS678    BEGSR
     *          ---------------
D1  C           POSF1B    IFNE *ZEROS
    C           POSFO     ANDEQ*ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIS67
F1  C                     END
    C*
D1  C           TDECO     IFEQ *BLANKS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIS67
F1  C                     END
     *
D1  C           POSF1A    IFEQ *ZEROS
    C           POSFO     ANDEQ*ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIS67
F1  C                     END
     *
D1  C           TDEC1     IFEQ 'F'
    C           TDEC3     ANDEQ'6'
D2  C           POSFO     IFGE 10
    C           POSF1A    ORGE 10
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIS67
F2  C                     END
F1  C                     END
    C*
D1  C           FMINL     IFEQ *ZEROS
    C           FMINH     OREQ *ZEROS
     C                     SETON                     7098  MESSAGE 55
    C                     GOTO FDIS67
F1  C                     END
    C*
    C           FDIS67    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * LUGANO  SIMPLIFIE
     *--------------------------------------------------------*
    C           DIS9      BEGSR
     *          ---------------
D1  C           DECL      IFEQ *ZEROS
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIS9
F1  C                     END
    C*
D1  C           *IN45     IFEQ '1'
    C           DECH      ANDNEONDH
     C                     SETON                     7198  MESSAGE 56
    C                     GOTO FDIS9
F1  C                     END
    C*
    C           FDIS9     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SI GAUFRE             *
     *--------------------------------------------------------*
    C           GAUFRE    BEGSR
    C*          ---------------
     C           FMINL     ADD  22        X4
     C           ONDL      DIV  X4        Z1
     C                     MULT Z1        X4
    C           ONDL      CABNEX4        FGAUF      7272    MESSAGE 57
    C*
     C           FMINH     ADD  30        X4
     C           ONDH      DIV  X4        Z2
    C           Z2        CABEQ0         FGAUF          72
    C*
D1  C           Z2        IFGT 1
     C                     SUB  12        X4
     C           ONDH      SUB  30        X4A
     C           X4A       DIV  X4        X3
     C                     MULT X3        X4
     C                     ADD  30        X4
    C           ONDH      CABNEX4        FGAUF      7272  MESSAGE 57
F1  C                     END
    C*
     C           Z1        MULT Z2        X4
     C                     MULT POSFO     X4
    C           POSF1A    CABNEX4        FGAUF      7272  MESSAGE 57
    C*
     C                     EXSR CALLAI
     C                     EXSR CTRLM
     C   98                SETON                     72    MESSAGE 57
    C*
     C           FGAUF     TAG
    C*          ---------------
     C   72                SETON                     98
    C*
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SI ACHETE             *
     *--------------------------------------------------------*
    C           ACHETE    BEGSR
    C*          ---------------
D1  C           ONDL      IFEQ *ZEROS
D2  C           FORH      IFNE DECH
    C           FORL      ORNE DECL
     C                     SETON                     8398  MESSAGE 68
F2  C                     END
X1  C                     ELSE
    C*                    Z-ADDONDL      X4         SD N° 1419360
    C*                    MOVE ONDL      X1
    C*          X1        IFNE *ZERO
    C*                    ADD  10        X4
    C*                    MOVE '0'       X4
    C*                    END
    C*          X4        IFNE FORL
    C*                    SETON                     8398  MESSAGE 68
    C*                    END
    C*                    Z-ADDONDH      X4
    C*                    MOVE ONDH      X1
    C*          X1        IFNE *ZERO
    C*                    ADD  10        X4
    C*                    MOVE '0'       X4
    C*                    END
    C*          X4        IFNE FORH
    C*                    SETON                     8398  MESSAGE 68
    C*                    END
D2  C           RESTEL    IFNE 20
    C* TMAFBU INC0190906 23/10/2014
    C*          RESTEH    ORNE 20
    C           RESTEH    ORNE 22
     C                     SETON                     8398  MESSAGE 68
F2  C                     END
F1  C                     END
    C*
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SI CARTON COMPACT     *
     *--------------------------------------------------------*
    C           CARCOM    BEGSR
    C*          ---------------
D1  C                     SELEC
     C           RESTEL    WHEQ 25
D2  C           RESTEH    IFEQ 14
    C                     GOTO SCARCO
F2  C                     END
     C           RESTEH    WHGE 25
D2  C           RESTEL    IFEQ 14
    C                     GOTO SCARCO
F2  C                     END
F1  C                     ENDSL
    C*
     C                     SETON                     7498  MESSAGE 59
    C                     GOTO FCARCO
     *
     C           SCARCO    TAG
    C*          ---------------
D1  C           TIMPEX    IFNE 1
    C           NBPAP     OREQ 1
    C           NCXH      ANDEQ1
D2  C           LMINI     IFNE *ZEROS
     C                     SETON                     7498  MESSAGE 59
F2  C                     END
X1  C                     ELSE
     C                     EXSR CALLAI
     C                     EXSR CTRLM
D2  C           *IN98     IFEQ '1'
     C                     EXSR CALLAI
     C                     ADD  15        LALAIZ
     C                     EXSR CTRLM
F2  C                     END
     C   98                SETON                     74    MESSAGE 59
F1  C                     END
     *
D1  C           LMINI     IFEQ *ZEROS
    C*          NCXH      ANDNE1
D2  C           ONDL      IFNE *ZEROS
     C                     Z-ADDONDH      FORH
     C                     Z-ADDONDL      FORL
X2  C                     ELSE
     C                     Z-ADDDECH      FORH
     C                     Z-ADDDECL      FORL
F2  C                     END
F1  C                     END
    C*
    C           FCARCO    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SI JUPE               *
     *--------------------------------------------------------*
    C           JUPE      BEGSR
     C                     MOVE ONDH      X1      10
D1  C           X1        IFNE 5                          ARRONDI
    C           X1        ANDNE0                             CARCASSE
    C                     GOTO SJUPE
F1  C                     END
D1  C           NBDL      IFGT 1                          PERPENDICULAIRE
D2  C           RESTEL    IFNE 20
    C           RESTEL    ANDNE22
    C                     GOTO SJUPE
F2  C                     END
D2  C           RESTEH    IFLT 14
    C           RESTEH    ORGT 25
    C                     GOTO SJUPE
F2  C                     END
X1  C                     ELSE                            PARRALLELE
D2  C           RESTEL    IFNE 20
    C                     GOTO SJUPE
F2  C                     END
D2  C           RESTEH    IFLT 20
    C           RESTEH    ORGT 30
    C                     GOTO SJUPE
F2  C                     END
F1  C                     END
     *
     C                     MOVE ONDL      X1
D1  C           X1        IFEQ 0
    C           X1        OREQ 5
     C                     Z-ADDONDL      X4      40
X1  C                     ELSE
D2  C           X1        IFLT 5
     C           5         SUB  X1        PLUS    10
     C           ONDL      ADD  PLUS      X4
F2  C                     END
D2  C           X1        IFGT 5
     C           10        SUB  X1        PLUS
     C           ONDL      ADD  PLUS      X4
F2  C                     END
F1  C                     END
    C           X4        CABNELMIMI     SJUPE
     *
D1  C           NBDL      IFGT 1                          PERPENDICULAIRE
     C           FMINH     ADD  20        X4
X1  C                     ELSE
     C           FMINH     ADD  14        X4
F1  C                     END
     C                     MOVE X4        X1
D1  C           X1        IFNE 0
     C                     ADD  10        X4
     C                     MOVELX4        X3
     C           X3        MULT 10        DEVMIN
X1  C                     ELSE
     C                     MOVELX4        DEVMIN  40
F1  C                     END
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUPEX    IFEQ 'C'
    C           COUPIN    OREQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
    C                     GOTO FJUPE
     *
     C           SJUPE     TAG
    C*          ---------------
     C                     SETON                     9889  MESSAGE 156
     *
    C           FJUPE     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION FORMAT/BOBINE         *
     *--------------------------------------------------------*
    C           FORBOB    BEGSR
    C*          ---------------
     * CALL 581764 DU 07/02/2013
     C           *LIKE     DEFN FORH      WFH
     C           *LIKE     DEFN FORL      WFL
     C           *LIKE     DEFN LMINI     LMINI5
     * FORMAT OFFSET
     C           FMINH     ADD  30        WFH
    C           FORH      CABNEWFH       SUICT5     9898
     C           FMINL     ADD  19        WFL
    C           FORL      CABNEWFL       SUICT5     9898
     * FORMAT ONDULE
     C           FORH      SUB  5         WFL
    C           ONDL      CABNEWFL       SUICT5     9898
     C           FORL      SUB  5         WFH
    C           ONDH      CABNEWFH       SUICT5     9898
     * LAIZE MINI
     C                     MOVE FORH      LMINI5
     C                     MOVE FORH      WMIN    10
D1  C           WMIN      IFNE 0
     C                     ADD  1         LMINI5
     C                     MOVE '0'       LMINI5
F1  C                     END
    C           LMINI     CABNELMINI5    SUICT5     9898
    C*                    EXSR CALLAI
    C*                    EXSR CTRLM
     C           SUICT5    TAG
     C   98                SETON                     75    MESSAGE 60
    C*
    C                     ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SI BOBINE/BOBINE      *
     *--------------------------------------------------------*
    C           BOBBOB    BEGSR
    C*          ---------------
D1  C                     SELEC
     C           RESTEL    WHEQ 12
    C           RESTEL    OREQ 21
    C           RESTEL    OREQ 23
     C           FMINH     ADD  16        X4
     C           RESTEL    WHEQ 0
    C           RESTEL    OREQ 8
    C           RESTEL    OREQ 10
    C           RESTEL    OREQ 16
    C           RESTEL    OREQ 18
    C           RESTEL    OREQ 20
     C           FMINH     ADD  21        X4
     C                     OTHER
     C                     SETON                     7698  MESSAGE 61
    C                     GOTO FBOBBO
F1  C                     ENDSL
    C*
     C                     MOVE X4        X1
D1  C           X1        IFNE 0
     C                     ADD  10        X4
     C                     MOVELX4        X3      30
     C           X3        MULT 10        DEVMIN  40
X1  C                     ELSE
     C                     Z-ADDX4        DEVMIN
F1  C                     END
    C*
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUPEX    IFEQ 'C'
    C           COUPIN    OREQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
     *
     C                     EXSR CALLAI
     C                     EXSR CTRLM
     C   98                SETON                     76    MESSAGE 61
     *
    C           FBOBBO    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION SANS IMPRESION        *
     *--------------------------------------------------------*
    C           SANIMP    BEGSR
    C*          ---------------
D1  C                     SELEC
     C           RESTEH    WHEQ 14
    C           RESTEH    OREQ 18
D2  C           RESTEL    IFEQ 20
    C           RESTEL    OREQ 22
    C                     GOTO SSANIM
F2  C                     END
     C           RESTEH    WHEQ 20
    C           RESTEH    OREQ 22
D2  C           RESTEL    IFEQ 16
    C           RESTEL    OREQ 20
    C                     GOTO SSANIM
F2  C                     END
F1  C                     ENDSL
     C                     SETON                     7798  MESSAGE 62
    C                     GOTO FSANIM
    C*
     C           SSANIM    TAG
    C*          ---------------
     C                     EXSR CALLAI
D1  C           USINE     IFEQ 3
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
     C                     ADD  20        LALAIZ
X1  C                     ELSE
D2  C           RESTEH    IFLE 18                         PREPENDICULAIRE
D3  C                     SELEC
     C           LMIMI     WHGT 1200
     C                     ADD  10        LALAIZ
     C           LMIMI     WHGT 900
     C                     ADD  5         LALAIZ
F3  C                     ENDSL
F2  C                     END
F1  C                     END
     *
     C                     EXSR CTRLM
     C   98                SETON                     77    MESSAGE 62
     *
    C           FSANIM    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION OFFSET                *
     *--------------------------------------------------------*
    C           OFFSET    BEGSR
    C*          ---------------
D1  C                     SELEC
    C*
     C           IND01     WHEQ '0'
D2  C                     SELEC
     C           RESTEL    WHEQ 22
D3  C           RESTEH    IFEQ 19
    C                     GOTO SOFFSE
F3  C                     END
     C           RESTEL    WHEQ 15
D3  C           RESTEH    IFEQ 22
    C           ONDUL     ANDNE2
    C           RESTEH    OREQ 25
    C           ONDUL     ANDEQ2
    C                     GOTO SOFFSE
F3  C                     END
F2  C                     ENDSL
    C*
     C           IND01     WHEQ '1'
D2  C                     SELEC
     C           RESTEL    WHEQ 22
D3  C           RESTEH    IFGE 16
     C                     MOVE ONDH      X1
D4  C           X1        IFEQ 0
    C                     GOTO SOFFSE
F4  C                     END
F3  C                     END
     C           RESTEL    WHEQ 15
D3  C           RESTEH    IFGE 19
     C                     MOVE ONDH      X1
D4  C           X1        IFEQ 0
    C                     GOTO SOFFSE
F4  C                     END
F3  C                     END
F2  C                     ENDSL
F1  C                     ENDSL
     *
     C                     SETON                     7898  MESSAGE 63
    C                     GOTO FOFFSE
     *
     C           SOFFSE    TAG
    C*          ---------------
     C                     MOVE FORL      X1
     C                     Z-ADDFORL      X4
D1  C           X1        IFNE 0
     C                     ADD  10        X4
     C                     MOVE '0'       X4
F1  C                     END
D1  C           FORL      IFGT 1200
     C                     ADD  20        X4
X1  C                     ELSE
     C                     ADD  10        X4
F1  C                     END
D1  C           X4        IFNE LMIMI
     C                     SETON                     7898  MESSAGE 63
F1  C                     END
     *
    C           FOFFSE    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION IMPRESION HELIO FLEXO *
     *--------------------------------------------------------*
    C           HELFLE    BEGSR
    C*          ---------------
D1  C                     SELEC
     C           RESTEL    WHEQ 20
    C           RESTEL    OREQ 22
D2  C           RESTEH    IFGE 14
     C           FMINH     ADD  14        X4
    C                     GOTO SHELFL
F2  C                     END
     *
     C           RESTEL    WHGE 10
    C           RESTEH    ANDGE20
     C           FMINH     ADD  20        X4
    C                     GOTO SHELFL
F1  C                     ENDSL
     *
     C                     SETON                     7998  MESSAGE 64
    C                     GOTO FHELFL
     *
     C           SHELFL    TAG
    C*          ---------------
     C                     MOVE X4        X1
D1  C           X1        IFNE 0
     C                     ADD  10        X4
     C                     MOVELX4        X3      30
     C           X3        MULT 10        DEVMIN  40
X1  C                     ELSE
     C                     Z-ADDX4        DEVMIN
F1  C                     END
    C*
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUPEX    IFEQ 'C'
    C           COUPIN    OREQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
     *
     C                     EXSR CALLAI
D1  C           USINE     IFEQ 3
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
     C                     ADD  20        LALAIZ
X1  C                     ELSE
     C                     ADD  10        LALAIZ
F1  C                     END
     C                     EXSR CTRLM
D1  C           USINE     IFNE 3
    C           CCOL      ANDNE2
    C           CCOL      ANDNE3
D2  C           *IN98     IFEQ '1'
     C                     SUB  5         LALAIZ
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D3  C           X1        IFNE 0
     C                     ADD  1         X41
     C                     MOVE '0'       X41
F3  C                     END
D3  C           LMINI     IFNE X41
     C                     SETON                     98
F3  C                     END
F2  C                     END
F1  C                     END
     C   98                SETON                     79    MESSAGE 64
     *
D1  C           *IN98     IFEQ '1'                        VERIF SI 1C EN
D2  C           COUPEX    IFEQ 'C'                        CONTINU
    C           COUPIN    OREQ 'C'
     C                     SETOF                     9879
     C                     EXSR SANIMP
F2  C                     END
F1  C                     END
     *
    C           FHELFL    ENDSR
     C/SPACE 5
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE DIMENSION IMPRESION TYPO        *
     *--------------------------------------------------------*
    C           TYPO      BEGSR
    C*          ---------------
D1  C                     SELEC
     C           RESTEH    WHEQ 20
D2  C           RESTEL    IFEQ 16
    C           RESTEL    OREQ 20
    C           RESTEL    OREQ 22
    C                     GOTO STYPO
F2  C                     END
     *
     C           RESTEH    WHEQ 22
D2  C           RESTEL    IFEQ 20
    C                     GOTO STYPO
F2  C                     END
     *
     C           RESTEH    WHEQ 24
D2  C           RESTEL    IFEQ 20
    C           RESTEL    OREQ 22
    C                     GOTO STYPO
F2  C                     END
F1  C                     ENDSL
     *
     C                     SETON                     8098  MESSAGE 65
    C                     GOTO FTYPO
     *
     C           STYPO     TAG
    C*          ---------------
     C                     EXSR CALLAI
D1  C           USINE     IFEQ 3
    C           CCOL      OREQ 2
    C           CCOL      OREQ 3
     C                     ADD  20        LALAIZ
X1  C                     ELSE
     C                     ADD  10        LALAIZ
F1  C                     END
     C                     EXSR CTRLM
     C   98                SETON                     80    MESSAGE 65
     *
    C           FTYPO     ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE LAIZE MINI                      *
     *--------------------------------------------------------*
    C           CALLAI    BEGSR
     *          ---------------
     C           LMIMI     DIV  ONDL      X3
     C           ONDL      MULT X3        LALAIZ  40
     C                     ADD  ACOTE     LALAIZ
     *
    C                     ENDSR
     *
    C           CTRLM     BEGSR
     *          ---------------
     C                     SETOF                     98
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D1  C           X1        IFNE 0
     C                     ADD  1         X41
     C                     MOVE '0'       X41
F1  C                     END
D1  C           LMINI     IFNE X41
     C                     SETON                     98
F1  C                     END
     *
    C                     ENDSR
      /EJECT
     *--------------------------------------------------------*
     * S/PROGRAMME : TOUCHE CDE 4                             *
     *--------------------------------------------------------*
    C           TRTAID    BEGSR
     *          ---------------
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
     *
    C           ZONZON    CASEQ'TYPDEV'  AID1
    C           ZONZON    CASEQ'NOCLI '  AID2
    C           ZONZON    CASEQ'GROUP '  AID3
    C           ZONZON    CASEQ'AGENT '  AID4
    C           ZONZON    CASEQ'ETUPAR'  AID5
    C           ZONZON    CASEQ'TYPP1 '  AID6
    C           ZONZON    CASEQ'TYPP2 '  AID6
    C           ZONZON    CASEQ'TYPP3 '  AID6
    C           ZONZON    CASEQ'DIMVOL'  AID9
    C           ZONZON    CASEQ'FACON '  AID10
    C           ZONZON    CASEQ'ONDUL '  AID11
    C           ZONZON    CASEQ'CCOL  '  AID12
    C           ZONZON    CASEQ'TYPFEN'  AID13
    C           ZONZON    CASEQ'COSESA'  AID14
    C           ZONZON    CASEQ'COTAPE'  AID15
    C           ZONZON    CASEQ'TYPPOI'  AID16
    C           ZONZON    CASEQ'UVENT '  AID17
    C           ZONZON    CASEQ'USINE '  AID18
    C           ZONZON    CASEQ'USEXT '  AID18
    C           ZONZON    CASEQ'USINT '  AID18
    C           ZONZON    CASEQ'COLRH '  AID19
    C           ZONZON    CASEQ'GFRA  '  AID20
    C           ZONZON    CASEQ'GFRA2 '  AID20
    C           ZONZON    CASEQ'TDECO '  AID21
    C           ZONZON    CASEQ'COAS1 '  AID22
    C           ZONZON    CASEQ'COAS2 '  AID22
    C           ZONZON    CASEQ'TIMPEX'  AID23
    C           ZONZON    CASEQ'TIMPIN'  AID23
    C           ZONZON    CASEQ'RIMPEX'  AID23
    C           ZONZON    CASEQ'RIMPIN'  AID23
    C           ZONZON    CASEQ'MATFC '  AID24
    C           ZONZON    CASEQ'MATSC '  AID24
    C           ZONZON    CASEQ'MATGC '  AID24
    C           ZONZON    CASEQ'MATDC '  AID24
    C           ZONZON    CASEQ'MATEC '  AID24
    C           ZONZON    CASEQ'MATIC '  AID24
    C           ZONZON    CASEQ'MATERC'  AID24
    C           ZONZON    CASEQ'MATIRC'  AID24
    C           ZONZON    CASEQ'TSEXT '  AID25
    C           ZONZON    CASEQ'TSINT '  AID25
    C           ZONZON    CASEQ'TSEXTR'  AID25
    C           ZONZON    CASEQ'TSINTR'  AID25
    C           ZONZON    CASEQ'UVEXT '  AID26
    C           ZONZON    CASEQ'UVINT '  AID26
    C           ZONZON    CASEQ'UVEXTR'  AID26
    C           ZONZON    CASEQ'UVINTR'  AID26
    C           ZONZON    CASEQ'TVEEX '  AID27
    C           ZONZON    CASEQ'TVEIN '  AID27
    C           ZONZON    CASEQ'TVEEXR'  AID27
    C           ZONZON    CASEQ'TVEINR'  AID27
    C           ZONZON    CASEQ'ORALEX'  AID28
    C           ZONZON    CASEQ'ORALIN'  AID28
    C           ZONZON    CASEQ'ORAEXR'  AID28
    C           ZONZON    CASEQ'ORAINR'  AID28
    C           ZONZON    CASEQ'FLUEX '  AID29
    C           ZONZON    CASEQ'FLUIN '  AID29
    C           ZONZON    CASEQ'FLUEXR'  AID29
    C           ZONZON    CASEQ'FLUINR'  AID29
    C           ZONZON    CASEQ'DDEEX '  AID30
    C           ZONZON    CASEQ'DDEIN '  AID30
    C           ZONZON    CASEQ'DDEEXR'  AID30
    C           ZONZON    CASEQ'DDEINR'  AID30
    C           ZONZON    CASEQ'DAPEX '  AID31
    C           ZONZON    CASEQ'DAPIN '  AID31
    C           ZONZON    CASEQ'DAPEXR'  AID31
    C           ZONZON    CASEQ'DAPINR'  AID31
    C           ZONZON    CASEQ'COLA1 '  AID32
    C           ZONZON    CASEQ'COLA2 '  AID32
    C           ZONZON    CASEQ'STCOD1'  AID33
    C           ZONZON    CASEQ'STCOD2'  AID33
    C           ZONZON    CASEQ'STCOD3'  AID33
    C           ZONZON    CASEQ'STCOD4'  AID33
    C           ZONZON    CASEQ'EMBNAT'  AID35
    C           ZONZON    CASEQ'EMBTYP'  AID35
    C           ZONZON    CASEQ'PMBTYP'  AID35
    C           ZONZON    CASEQ'EMBCON'  AID36
    C           ZONZON    CASEQ'PMBCON'  AID36
    C           ZONZON    CASEQ'EMBQUA'  AID37
    C           ZONZON    CASEQ'PLATYP'  AID38
    C           ZONZON    CASEQ'HABIL1'  AID39
    C           ZONZON    CASEQ'HABIL2'  AID39
    C           ZONZON    CASEQ'HABIL3'  AID39
    C           ZONZON    CASEQ'PROTEC'  AID40
    C           ZONZON    CASEQ'TYPVEH'  AID41
    C           ZONZON    CASEQ'TYPOR '  AID42
    C           ZONZON    CASEQ'LIEU  '  AID43
    C           ZONZON    CASEQ'CPAYFO'  AID44
    C           ZONZON    CASEQ'COUPEX'  AID45
    C           ZONZON    CASEQ'COUPIN'  AID45
    C           ZONZON    CASEQ'NATEX '  AID46
    C           ZONZON    CASEQ'NATEXR'  AID46
    C           ZONZON    CASEQ'NATIN '  AID46
    C           ZONZON    CASEQ'NATINR'  AID46
    C           ZONZON    CASEQ'ADPA1 '  AID47
    C           ZONZON    CASEQ'ADPA2 '  AID47
    C           ZONZON    CASEQ'ADPA3 '  AID47
    C           ZONZON    CASEQ'ADPA4 '  AID47
    C           ZONZON    CASEQ'ADPA5 '  AID47
    C           ZONZON    CASEQ'TTRACE'  AID48
    C           ZONZON    CASEQ'TYPPCH'  AID49
    C           ZONZON    CASEQ'TYPOPR'  AID50
    C           ZONZON    CASEQ'DNATP1'  AID51
    C           ZONZON    CASEQ'DNATP2'  AID51
    C           ZONZON    CASEQ'DFPXF1'  AID52
    C           ZONZON    CASEQ'DFPXF2'  AID52
    C           ZONZON    CASEQ'DFPXF3'  AID52
    C           ZONZON    CASEQ'DFPXF4'  AID52
    C           ZONZON    CASEQ'DFPXF5'  AID52
    C           ZONZON    CASEQ'DFPXF6'  AID52
    C           ZONZON    CASEQ'DFPXF7'  AID52
    C           ZONZON    CASEQ'DFPXF8'  AID52
    C           ZONZON    CASEQ'DFPXF9'  AID52
    C           ZONZON    CASEQ'PTENC '  AID53
    C           ZONZON    CASEQ'PLIA1 '  AID54
    C           ZONZON    CASEQ'PLIA2 '  AID54
    C           ZONZON    CASEQ'LMINI '  AID55
    C           ZONZON    CASEQ'LUTIL '  AID55
    C           ZONZON    CASEQ'NIMPE1'  AID56
    C           ZONZON    CASEQ'NIMPE2'  AID56
    C           ZONZON    CASEQ'NIMPI1'  AID56
    C           ZONZON    CASEQ'NIMPI2'  AID56
    C                     CAS            AID0
    C                     END
    C                     ENDSR
      /SPACE 2
    C           AID0      BEGSR
     *          ---------------
     C                     WRITEWMINI
     C                     EXFMTWERR
    C                     ENDSR
      /SPACE 2
    C           AID1      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TYPD'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TYPDEV
     C                     MOVELLIBEL     LIBDEV
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID2      BEGSR
     *          ---------------
     C                     CLEARDSSC
     C                     MOVE 'N'       INTOBS
     C                     CALL 'CLIE10£'
     C                     PARM           DSSC
D1  C           STE       IFLE *ZERO
     C                     Z-ADD1         STE
     C                     Z-ADD*ZEROS    NOCLI
     C                     Z-ADD1         SEQACH
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID3      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'GRPS'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      GROUP
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID4      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TVRP'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      AGENT
     C                     MOVELLIBEL     NOMAG
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID5      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'ETUD'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      ETUPAR
     C                     MOVELLIBEL     NOMETU
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID6      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'PRTY'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'TYPP1'
     C                     MOVELCODE      TYPP1
     C                     MOVELLIBEL     LIBPR1
F2  C                     END
D2  C           ZONZON    IFEQ 'TYPP2'
     C                     MOVELCODE      TYPP2
     C                     MOVELLIBEL     LIBPR2
F2  C                     END
D2  C           ZONZON    IFEQ 'TYPP3'
     C                     MOVELCODE      TYPP3
     C                     MOVELLIBEL     LIBPR3
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID9      BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DEVO'    TBLNOM
     C                     Z-ADD5         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      DIMVOL
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID10     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'FACO'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      FACON
     C                     MOVELLIBEL     LIBFAC
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID11     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'ONDU'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      ONDUL
     C                     MOVELLIBEL     LIBOND
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID12     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'CCOL'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      CCOL
     C                     MOVELLIBEL     LIBCC
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID13     BEGSR
     *          ---------------
     C                     CLEARDSPARM
D1  C           TYPFE1    IFEQ 'B'
     C                     MOVEL' BIB'    TBLNOM
X1  C                     ELSE
D2  C           TYPFE1    IFEQ 'L'
     C                     MOVEL'LANG'    TBLNOM
X2  C                     ELSE
     C                     MOVEL'RHOD'    TBLNOM
F2  C                     END
F1  C                     END
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           TYPFE1    IFNE 'B'
D3  C           TYPFE1    IFEQ 'L'
     C                     MOVE 'L'       TYPFE1
X3  C                     ELSE
     C                     MOVE 'F'       TYPFE1
F3  C                     END
F2  C                     END
     C                     MOVELCODE      TYPFE2
     C                     MOVELLIBEL     LIBFEN
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID14     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'SESA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      COSESA
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID15     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TAPE'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      COTAPE
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID16     BEGSR
     *          ---------------
     C                     CLEARDSPARM
    C           TYPPO1    CABEQ'C'       FAID16
D1  C           TYPPO1    IFEQ 'P'
     C                     MOVEL'PLAS'    TBLNOM
X1  C                     ELSE
     C                     MOVEL'RINA'    TBLNOM
F1  C                     END
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           TYPPO1    IFEQ *BLANKS
     C                     MOVE 'R'       TYPPO1
F2  C                     END
     C                     MOVELCODE      TYPPO2
     C                     MOVELLIBEL     LIBPOI
X1  C                     ELSE
     C                     MOVE *BLANKS   LIBPOI
F1  C                     END
    C           FAID16    ENDSR
      /SPACE 2
    C           AID17     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'UVEN'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      UVENT
     C                     MOVELLIBEL     LIBUV
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID18     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'USDE'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'USINE'
     C                     MOVELCODE      USINE
F2  C                     END
D2  C           ZONZON    IFEQ 'USEXT'
     C                     MOVELCODE      USEXT
     C                     MOVELLIBEL     LIBUIE
F2  C                     END
D2  C           ZONZON    IFEQ 'USINT'
     C                     MOVELCODE      USINT
     C                     MOVELLIBEL     LIBUII
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID19     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TCOL'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      COLRH
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID20     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'GAUF'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'GFRA  '
     C                     MOVELCODE      GFRA
X2  C                     ELSE
     C                     MOVELCODE      GFRA2
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID21     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XDECOUPS'TBLNOM
     C                     Z-ADD0         LG
     C                     MOVE 'X'       FICH
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TDECO
     C                     MOVELLIBEL     LIBDEC
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID22     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'ASSB'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'COAS1'
     C                     MOVELCODE      COAS1
     C                     MOVELLIBEL     LIBAS1
F2  C                     END
D2  C           ZONZON    IFEQ 'COAS2'
     C                     MOVELCODE      COAS2
     C                     MOVELLIBEL     LIBAS2
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID23     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'IMPR'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'TIMPEX'
     C                     MOVELCODE      TIMPEX
     C                     MOVELLIBEL     LIBIME
D3  C           TIMPEX    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPEX    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIME
F3  C                     END
F2  C                     END
D2  C           ZONZON    IFEQ 'RIMPEX'
     C                     MOVELCODE      RIMPEX
     C                     MOVELLIBEL     LIBIER
F2  C                     END
D2  C           ZONZON    IFEQ 'TIMPIN'
     C                     MOVELCODE      TIMPIN
     C                     MOVELLIBEL     LIBIMI
D3  C           TIMPIN    IFEQ 3
    C           CCOL      ANDEQ4
    C           TIMPIN    OREQ 3
    C           CCOL      ANDEQ7
     C                     MOVEL'MARQU.'  LIBIMI
F3  C                     END
F2  C                     END
D2  C           ZONZON    IFEQ 'RIMPIN'
     C                     MOVELCODE      RIMPIN
     C                     MOVELLIBEL     LIBIIR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID24     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'CMAT'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'MATFC'
     C                     MOVELCODE      MATFC
     C                     MOVELLIBEL     LIBMF
F2  C                     END
D2  C           ZONZON    IFEQ 'MATSC'
     C                     MOVELCODE      MATSC
     C                     MOVELLIBEL     LIBMS
F2  C                     END
D2  C           ZONZON    IFEQ 'MATGC'
     C                     MOVELCODE      MATGC
     C                     MOVELLIBEL     LIBMG
F2  C                     END
D2  C           ZONZON    IFEQ 'MATDC'
     C                     MOVELCODE      MATDC
     C                     MOVELLIBEL     LIBMD
F2  C                     END
D2  C           ZONZON    IFEQ 'MATEC'
     C                     MOVELCODE      MATEC
     C                     MOVELLIBEL     LIBME
F2  C                     END
D2  C           ZONZON    IFEQ 'MATIC'
     C                     MOVELCODE      MATIC
     C                     MOVELLIBEL     LIBMI
F2  C                     END
D2  C           ZONZON    IFEQ 'MATERC'
     C                     MOVELCODE      MATERC
     C                     MOVELLIBEL     LIBMER
F2  C                     END
D2  C           ZONZON    IFEQ 'MATIRC'
     C                     MOVELCODE      MATIRC
     C                     MOVELLIBEL     LIBMIR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID25     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XTRAISEL'TBLNOM
     C                     Z-ADD1         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'TSEXT'
     C                     MOVELTIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TSINT'
     C                     MOVELTIMPIN    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TSEXTR'
     C                     MOVELRIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TSINTR'
     C                     MOVELRIMPIN    TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'TSEXT'
     C                     MOVELCODE      TSEXT
F2  C                     END
D2  C           ZONZON    IFEQ 'TSINT'
     C                     MOVELCODE      TSINT
F2  C                     END
D2  C           ZONZON    IFEQ 'TSEXTR'
     C                     MOVELCODE      TSEXTR
F2  C                     END
D2  C           ZONZON    IFEQ 'TSINTR'
     C                     MOVELCODE      TSINTR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID26     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XENCRESS'TBLNOM
     C                     Z-ADD1         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'UVEXT'
     C                     MOVELTIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'UVINT'
     C                     MOVELTIMPIN    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'UVEXTR'
     C                     MOVELRIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'UVINTR'
     C                     MOVELRIMPIN    TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'UVEXT'
     C                     MOVELCODE      UVEXT
F2  C                     END
D2  C           ZONZON    IFEQ 'UVINT'
     C                     MOVELCODE      UVINT
F2  C                     END
D2  C           ZONZON    IFEQ 'UVEXTR'
     C                     MOVELCODE      UVEXTR
F2  C                     END
D2  C           ZONZON    IFEQ 'UVINTR'
     C                     MOVELCODE      UVINTR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID27     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XVERNISS'TBLNOM
     C                     Z-ADD1         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'TVEEX'
     C                     MOVELTIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TVEIN'
     C                     MOVELTIMPIN    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TVEEXR'
     C                     MOVELRIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'TVEINR'
     C                     MOVELRIMPIN    TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'TVEEX'
     C                     MOVELCODE      TVEEX
F2  C                     END
D2  C           ZONZON    IFEQ 'TVEIN'
     C                     MOVELCODE      TVEIN
F2  C                     END
D2  C           ZONZON    IFEQ 'TVEEXR'
     C                     MOVELCODE      TVEEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'TVEINR'
     C                     MOVELCODE      TVEINR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID28     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XORCUALU'TBLNOM
     C                     Z-ADD1         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'ORALEX'
     C                     MOVELTIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'ORALIN'
     C                     MOVELTIMPIN    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'ORAEXR'
     C                     MOVELRIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'ORAINR'
     C                     MOVELRIMPIN    TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'ORALEX'
     C                     MOVELCODE      ORALEX
F2  C                     END
D2  C           ZONZON    IFEQ 'ORALIN'
     C                     MOVELCODE      ORALIN
F2  C                     END
D2  C           ZONZON    IFEQ 'ORAEXR'
     C                     MOVELCODE      ORAEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'ORAINR'
     C                     MOVELCODE      ORAINR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID29     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XFLUOSSS'TBLNOM
     C                     Z-ADD1         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'FLUEX'
     C                     MOVELTIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'FLUIN'
     C                     MOVELTIMPIN    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'FLUEXR'
     C                     MOVELRIMPEX    TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'FLUINR'
     C                     MOVELRIMPIN    TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'FLUEX'
     C                     MOVELCODE      FLUEX
F2  C                     END
D2  C           ZONZON    IFEQ 'FLUIN'
     C                     MOVELCODE      FLUIN
F2  C                     END
D2  C           ZONZON    IFEQ 'FLUEXR'
     C                     MOVELCODE      FLUEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'FLUINR'
     C                     MOVELCODE      FLUINR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID30     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DDEC'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DDEEX'
     C                     MOVELCODE      DDEEX
F2  C                     END
D2  C           ZONZON    IFEQ 'DDEIN'
     C                     MOVELCODE      DDEIN
F2  C                     END
D2  C           ZONZON    IFEQ 'DDEEXR'
     C                     MOVELCODE      DDEEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'DDEINR'
     C                     MOVELCODE      DDEINR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID31     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'APLA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DAPEX'
     C                     MOVELCODE      DAPEX
F2  C                     END
D2  C           ZONZON    IFEQ 'DAPIN'
     C                     MOVELCODE      DAPIN
F2  C                     END
D2  C           ZONZON    IFEQ 'DAPEXR'
     C                     MOVELCODE      DAPEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'DAPINR'
     C                     MOVELCODE      DAPINR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID32     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XCOLLESS'TBLNOM
     C                     Z-ADD2         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'COLA1 '
     C                     MOVEL'A1'      TBVAR
F1  C                     END
D1  C           ZONZON    IFEQ 'COLA2 '
     C                     MOVEL'A2'      TBVAR
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'COLA1 '
     C                     MOVELCODE      COLA1
F2  C                     END
D2  C           ZONZON    IFEQ 'COLA2 '
     C                     MOVELCODE      COLA2
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID33     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TDST'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'STCOD1'
     C                     MOVELCODE      STCOD1
     C                     MOVELLIBEL     LIBST1
F2  C                     END
D2  C           ZONZON    IFEQ 'STCOD2'
     C                     MOVELCODE      STCOD2
     C                     MOVELLIBEL     LIBST2
F2  C                     END
D2  C           ZONZON    IFEQ 'STCOD3'
     C                     MOVELCODE      STCOD3
     C                     MOVELLIBEL     LIBST3
F2  C                     END
D2  C           ZONZON    IFEQ 'STCOD4'
     C                     MOVELCODE      STCOD4
     C                     MOVELLIBEL     LIBST4
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID35     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMNT'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      W2      2
D2  C           ZONZON    IFEQ 'EMBNAT'
    C           ZONZON    OREQ 'EMBTYP'
     C                     MOVELW2        EMBNAT
     C                     MOVE W2        EMBTYP
F2  C                     END
D2  C           ZONZON    IFEQ 'PMBTYP'
     C                     MOVE W2        PMBTYP
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID36     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMCE'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'EMBCON'
     C                     MOVELCODE      W2
     C                     MOVE W2        EMBCON
F2  C                     END
D2  C           ZONZON    IFEQ 'PMBCON'
     C                     MOVELCODE      W2
     C                     MOVE W2        PMBCON
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID37     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMQU'    TBLNOM
     C                     Z-ADD5         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      EMBQUA
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID38     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMPL'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      PLATYP
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID39     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMHA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'HABIL1'
     C                     MOVELCODE      HABIL1
F2  C                     END
D2  C           ZONZON    IFEQ 'HABIL2'
     C                     MOVELCODE      HABIL2
F2  C                     END
D2  C           ZONZON    IFEQ 'HABIL3'
     C                     MOVELCODE      HABIL3
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID40     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EMPR'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      PROTEC
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID41     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'EXVE'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TYPVEH
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID42     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TPOR'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TYPOR
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID43     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DPTS'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      LIEU
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID44     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TPAY'    TBLNOM
     C                     Z-ADD5         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      CPAYFO
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID45     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'COUP'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'COUPEX'
     C                     MOVELCODE      COUPEX
F2  C                     END
D2  C           ZONZON    IFEQ 'COUPIN'
     C                     MOVELCODE      COUPIN
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID46     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'ENCR'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'NATEX'
     C                     MOVELCODE      NATEX
F2  C                     END
D2  C           ZONZON    IFEQ 'NATEXR'
     C                     MOVELCODE      NATEXR
F2  C                     END
D2  C           ZONZON    IFEQ 'NATIN'
     C                     MOVELCODE      NATIN
F2  C                     END
D2  C           ZONZON    IFEQ 'NATINR'
     C                     MOVELCODE      NATEXR
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID47     BEGSR
     *          ---------------
D1  C           ZONZON    IFEQ 'ADPA1 '
     C                     MOVE ADPA1     REFOUR
F1  C                     END
D1  C           ZONZON    IFEQ 'ADPA2 '
     C                     MOVE ADPA2     REFOUR
F1  C                     END
D1  C           ZONZON    IFEQ 'ADPA3 '
     C                     MOVE ADPA3     REFOUR
F1  C                     END
D1  C           ZONZON    IFEQ 'ADPA4 '
     C                     MOVE ADPA4     REFOUR
F1  C                     END
D1  C           ZONZON    IFEQ 'ADPA5 '
     C                     MOVE ADPA5     REFOUR
F1  C                     END
D1  C           CXH       IFNE 'CXH'
     C                     EXSR AID0
    C                     GOTO FAID47
F1  C                     END
     C                     MOVE ' '       PARM0
     C                     MOVEL*BLANKS   PAPCX
     C                     Z-ADD*ZEROS    GRACX
     C                     MOVEL*BLANKS   ADPCX
     C                     Z-ADD*ZEROS    ADGCX
     C                     CALL 'PRODU23£'
     C                     PARM           INTCXH
D1  C           PAPCX     IFNE *BLANKS
D2  C           ZONZON    IFEQ 'ADPA1 '
     C                     MOVELPAPCX     PAP1
     C                     Z-ADDGRACX     GRA1
     C                     MOVELADPCX     ADPA1
     C                     Z-ADDADGCX     ADGR1
F2  C                     END
D2  C           ZONZON    IFEQ 'ADPA2'
     C                     MOVELPAPCX     PAP2
     C                     Z-ADDGRACX     GRA2
     C                     MOVELADPCX     ADPA2
     C                     Z-ADDADGCX     ADGR3
F2  C                     END
D2  C           ZONZON    IFEQ 'ADPA3 '
     C                     MOVELPAPCX     PAP3
     C                     Z-ADDGRACX     GRA3
     C                     MOVELADPCX     ADPA3
     C                     Z-ADDADGCX     ADGR3
F2  C                     END
D2  C           ZONZON    IFEQ 'ADPA4 '
     C                     MOVELPAPCX     PAP4
     C                     Z-ADDGRACX     GRA4
     C                     MOVELADPCX     ADPA4
     C                     Z-ADDADGCX     ADGR4
F2  C                     END
D2  C           ZONZON    IFEQ 'ADPA5 '
     C                     MOVELPAPCX     PAP5
     C                     Z-ADDGRACX     GRA5
     C                     MOVELADPCX     ADPA5
     C                     Z-ADDADGCX     ADGR5
F2  C                     END
F1  C                     END
    C           FAID47    ENDSR
      /SPACE 2
    C           AID48     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'TTRA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TTRACE
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID49     BEGSR
     *          ---------------
     C                     MOVE 'I'       PII
     C                     CALL 'POIG01£'
     C                     PARM           APOIG
D1  C           TYPCHA    IFNE *BLANKS
     C                     MOVELTYPCHA    TYPPCH
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID50     BEGSR
     *          ---------------
     C                     MOVE 'I'       PIP
     C                     CALL 'TYPO01£'
     C                     PARM           ATYPP
D1  C           TYPPR     IFNE *BLANKS
     C                     MOVELTYPPR     TYPOPR
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID51     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DONA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DNATP1'
     C                     MOVELCODE      DNATP1
     C                     MOVELLIBEL     DLIBP1
F2  C                     END
D2  C           ZONZON    IFEQ 'DNATP2'
     C                     MOVELCODE      DNATP2
     C                     MOVELLIBEL     DLIBP2
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID52     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DOFF'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DFPXF1'
     C                     MOVELCODE      DFPXF1
     C                     MOVELLIBEL     LTFF1
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF2'
     C                     MOVELCODE      DFPXF2
     C                     MOVELLIBEL     LTFF2
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF3'
     C                     MOVELCODE      DFPXF3
     C                     MOVELLIBEL     LTFF3
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF4'
     C                     MOVELCODE      DFPXF4
     C                     MOVELLIBEL     LTFF4
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF5'
     C                     MOVELCODE      DFPXF5
     C                     MOVELLIBEL     LTFF5
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF6'
     C                     MOVELCODE      DFPXF6
     C                     MOVELLIBEL     LTFF6
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF7'
     C                     MOVELCODE      DFPXF7
     C                     MOVELLIBEL     LTFF7
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF8'
     C                     MOVELCODE      DFPXF8
     C                     MOVELLIBEL     LTFF8
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF9'
     C                     MOVELCODE      DFPXF9
     C                     MOVELLIBEL     LTFF9
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID53     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'XPTENCRE'TBLNOM
     C                     Z-ADD0         LG
     C                     MOVE 'X'       FICH
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      PTENC
F1  C                     END
    C                     ENDSR
     *   TABLE DPLI POUR DIFFICULTÉ PLIEUSE
    C           AID54     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DPLI'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPARM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'PLIA1 '
     C                     MOVELCODE      PLIA1
F2  C                     END
D2  C           ZONZON    IFEQ 'PLIA2 '
     C                     MOVELCODE      PLIA2
F2  C                     END
F1  C                     END
    C                     ENDSR
     *   ACCÉS LAIZES EN CONSULTATION SANS SELECTION
    C           AID55     BEGSR
     *          ---------------
     C                     CALL 'LAN019£'
    C                     ENDSR
     *   ACCÉS PREIMPRIMÉ EN CONSULTATION SANS SELECTION
    C           AID56     BEGSR
     *          ---------------
     C                     MOVE ' '       PARPI
     C                     Z-ADD0         STEPI
     C                     Z-ADD0         ETUPI
     C                     Z-ADD0         SEQPI
     C                     CALL 'LAN017£'
     C                     PARM           PIPARM
    C                     ENDSR
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires *
     *---------------------------------------------------------------
     * F7 : AFFICHAGE FENÊTRE POSE Accessoires
     *---------------------------------------------------------------
    C           FNC07     BEGSR
     *          ---------------
     C           EPOSE     IFEQ '*'
     *
     C                     MOVEL*BLANK    WCDRET
     C                     EXSR TRTPOS
     * - Si Retour par "F12"
     C           WCDRET    IFEQ 'PR'
     C                     GOTO TAG11
     C                     ENDIF
     *
     C                     ENDIF
     *          ---------------
    C           FFNC07    ENDSR
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires *
      /EJECT
     *--------------------------------------------------------*
     * S/PROGRAMME : TOUCHE CDE 4                             *
     *--------------------------------------------------------*
    C           BLK1      BEGSR
     *          ---------------
     C                     MOVE *BLANKS   NOMAG
     C                     MOVE *BLANKS   NOMETU
     C                     MOVE *BLANKS   LIBUV
     C                     MOVE *BLANKS   LIBFAC
     C                     MOVE *BLANKS   LIBOND
     C                     MOVE *BLANKS   LIBCC
     C                     MOVE *BLANKS   LIBTP
     C                     MOVE *BLANKS   LIBPOI
     C                     MOVE *BLANKS   LIBFEN
     C                     MOVE *BLANKS   LIBAS1
     C                     MOVE *BLANKS   LIBAS2
     C                     MOVE *BLANKS   LIBIME
     C                     MOVE *BLANKS   LIBIMI
     C                     MOVE *BLANKS   LIBIER
     C                     MOVE *BLANKS   LIBIIR
     C                     MOVE *BLANKS   LIBUIE
     C                     MOVE *BLANKS   LIBUII
     C                     MOVE *BLANKS   LIBDEV
     C                     MOVE *BLANKS   LIBMF
     C                     MOVE *BLANKS   LIBMS
     C                     MOVE *BLANKS   LIBMG
     C                     MOVE *BLANKS   LIBMD
     C                     MOVE *BLANKS   LIBME
     C                     MOVE *BLANKS   LIBMI
     C                     MOVE *BLANKS   LIBMER
     C                     MOVE *BLANKS   LIBMIR
     C                     MOVE *BLANKS   LIBCDC
     C                     MOVE *BLANKS   LIBCVR
     C                     MOVE *BLANKS   LIBCAF
     C                     MOVE *BLANKS   LIBST1
     C                     MOVE *BLANKS   LIBST2
     C                     MOVE *BLANKS   LIBST3
     C                     MOVE *BLANKS   LIBST4
     C                     MOVE *BLANKS   LIBAS1
     C                     MOVE *BLANKS   LIBAS2
     C                     MOVE *BLANKS   NOMCLI
     C                     MOVE *BLANKS   LIBDEC
     C                     MOVE *BLANKS   LIBIME
     C                     Z-ADD1         STE
     C                     Z-ADD1         SEQACH
     C                     MOVE *BLANKS   SVNC
     C                     MOVE *ZEROS    SIMPE1
     C                     MOVE *ZEROS    SIMPE2
     C                     MOVE '0'       IN99    1
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : MISE A BLANC IMPRESSION EXTERIEURE       *
     *--------------------------------------------------------*
    C           BLK2      BEGSR
     *          ---------------
     C                     Z-ADD*ZEROS    USEXT
     C                     Z-ADD*ZEROS    COUEX
     C                     Z-ADD*ZEROS    ENCEX
     C                     MOVE *BLANKS   TSEXT
     C                     Z-ADD*ZEROS    GRPEX
     C                     MOVE *BLANKS   UVEXT
     C                     MOVE *BLANKS   NATEX
     C                     MOVE *BLANKS   TVEEX
     C                     Z-ADD*ZEROS    CVEEX
     C                     MOVE *BLANKS   OREX
     C                     MOVE *BLANKS   FLUEX
     C                     Z-ADD*ZEROS    CFLEX
     C                     MOVE *BLANKS   ESPEX
     C                     MOVE *BLANKS   VSPEX
     C                     MOVE *BLANKS   DDEEX
     C                     MOVE *BLANKS   DAPEX
     C                     Z-ADD*ZEROS    GP1EX
     C                     Z-ADD*ZEROS    GP2EX
     C                     Z-ADD*ZEROS    GP3EX
     C                     MOVE *BLANKS   MATEC
     C                     Z-ADD*ZEROS    MATEM
     C                     Z-ADD*ZEROS    RIMPEX
     C                     Z-ADD*ZEROS    COUEXR
     C                     Z-ADD*ZEROS    ENCEXR
     C                     MOVE *BLANKS   TSEXTR
     C                     Z-ADD*ZEROS    GRPEXR
     C                     MOVE *BLANKS   UVEXTR
     C                     MOVE *BLANKS   NATEXR
     C                     MOVE *BLANKS   TVEEXR
     C                     Z-ADD*ZEROS    CVEEXR
     C                     MOVE *BLANKS   OREXR
     C                     MOVE *BLANKS   FLUEXR
     C                     Z-ADD*ZEROS    CFLEXR
     C                     MOVE *BLANKS   ESPEXR
     C                     MOVE *BLANKS   VSPEXR
     C                     MOVE *BLANKS   DDEEXR
     C                     MOVE *BLANKS   DAPEXR
     C                     Z-ADD*ZEROS    GP1EXR
     C                     Z-ADD*ZEROS    GP2EXR
     C                     MOVE *BLANKS   MATERC
     C                     Z-ADD*ZEROS    MATERM
     C                     SETOF                     30
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : MISE A BLANC IMPRESSION INTERIEURE       *
     *--------------------------------------------------------*
    C           BLK3      BEGSR
     *          ---------------
     C                     Z-ADD*ZEROS    USINT
     C                     Z-ADD*ZEROS    COUIN
     C                     Z-ADD*ZEROS    ENCIN
     C                     MOVE *BLANKS   TSINT
     C                     Z-ADD*ZEROS    GRPIN
     C                     MOVE *BLANKS   UVINT
     C                     MOVE *BLANKS   NATIN
     C                     MOVE *BLANKS   TVEIN
     C                     Z-ADD*ZEROS    CVEIN
     C                     MOVE *BLANKS   ORIN
     C                     MOVE *BLANKS   FLUIN
     C                     Z-ADD*ZEROS    CFLIN
     C                     MOVE *BLANKS   ESPIN
     C                     MOVE *BLANKS   VSPIN
     C                     MOVE *BLANKS   DDEIN
     C                     MOVE *BLANKS   DAPIN
     C                     Z-ADD*ZEROS    GP1IN
     C                     Z-ADD*ZEROS    GP2IN
     C                     Z-ADD*ZEROS    GP3IN
     C                     MOVE *BLANKS   MATIC
     C                     Z-ADD*ZEROS    MATIM
     C                     Z-ADD*ZEROS    RIMPIN
     C                     Z-ADD*ZEROS    COUINR
     C                     Z-ADD*ZEROS    ENCINR
     C                     MOVE *BLANKS   TSINTR
     C                     Z-ADD*ZEROS    GRPINR
     C                     MOVE *BLANKS   UVINTR
     C                     MOVE *BLANKS   NATINR
     C                     MOVE *BLANKS   TVEINR
     C                     Z-ADD*ZEROS    CVEINR
     C                     MOVE *BLANKS   ORINR
     C                     MOVE *BLANKS   FLUINR
     C                     Z-ADD*ZEROS    CFLINR
     C                     MOVE *BLANKS   ESPINR
     C                     MOVE *BLANKS   VSPINR
     C                     MOVE *BLANKS   DDEINR
     C                     MOVE *BLANKS   DAPINR
     C                     Z-ADD*ZEROS    GP1INR
     C                     Z-ADD*ZEROS    GP2INR
     C                     MOVE *BLANKS   MATIRC
     C                     Z-ADD*ZEROS    MATIRM
     C                     SETOF                     31
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE IMPRESSION SI COMMERCIAL        *
     *--------------------------------------------------------*
    C           CTLIC     BEGSR
     *          ---------------
     C                     MOVE ' '       PETIT   1
     C                     MOVE ' '       MOYEN   1
D1  C           FORL      IFGE FORH
     C                     Z-ADDFORL      DEFIL   40
     C                     Z-ADDFORH      OUVERT  40
X1  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F1  C                     END
D1  C           DEFIL     IFLE 730
    C           OUVERT    ANDLE1050
     C                     MOVE '*'       PETIT
X1  C                     ELSE
D2  C           OUVERT    IFLE 1420
    C           DEFIL     ANDLE1030
     C                     MOVE '*'       MOYEN
F2  C                     END
F1  C                     END
    C*
D1  C           TIMPEX    IFNE *ZEROS
D2  C           TIMPEX    IFEQ 4
    C           COUEX     ANDGT5
    C           PETIT     ANDEQ'*'
    C           TIMPEX    OREQ 4
    C           COUEX     ANDGT6
    C           MOYEN     ANDEQ'*'
    C           TIMPEX    OREQ 3
    C           COUEX     ANDGT2
    C           TIMPEX    OREQ 2
    C           COUEX     ANDNESCOUEX
    C           TIMPEX    OREQ 1
    C           COUEX     ANDNESCOUEX
     C                     SETON                     13
F2  C                     END
D2  C           TIMPEX    IFEQ 4
    C           TVEEX     ANDNETVERES
    C           TVEEX     ANDNE'N'
    C           TVEEX     ANDNE'K'
    C           TIMPEX    OREQ 3
    C           TVEEX     ANDNETVERES
    C           TIMPEX    OREQ 1
    C           TVEEX     ANDNETVERES
     C                     SETON                     13
F2  C                     END
     C                     MOVELPAPIE     PAPI
     C                     Z-ADDGRAME     GRAM
     C                     MOVELREFOUE    REFOUR
     C                     Z-ADDGRAREE    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEEX     ANDNETVERES
     C                     SETON                     13
F2  C                     END
D2  C           COUEX     IFEQ *ZEROS
    C           ENCEX     ANDNE*ZEROS
    C           COUEX     ORNE *ZEROS
    C           ENCEX     ANDEQ*ZEROS
     C                     SETON                     13
F2  C                     END
D2  C           COUEX     IFEQ *ZEROS
    C           TVEEX     ANDEQ*BLANKS
     C                     SETON                     13
F2  C                     END
     C                     Z-ADDCOUEX     GPEX    20
D2  C           GRPEX     IFNE *ZEROS
    C           GRPEX     ANDLTCOUEX
     C                     SETON                     13
F2  C                     END
D2  C           TVEEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             13
     C  N13      CVEEX     COMP *ZEROS                   13
     C  N13                MOVELTBVRES    XVER00
     C  N13                ADD  XVER05    GPEX
X2  C                     ELSE
     C           CVEEX     COMP *ZEROS               1313
F2  C                     END
D2  C           UVEXT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XENCA1
     C                     MOVE UVEXT     XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             13
F2  C                     END
     C   13                SETON                     98
F1  C                     END
    C*
D1  C           RIMPEX    IFNE *ZEROS
D2  C           RIMPEX    IFEQ 4
    C           COUEXR    ANDGT5
    C           PETIT     ANDEQ'*'
    C           RIMPEX    OREQ 4
    C           COUEXR    ANDGT6
    C           MOYEN     ANDEQ'*'
    C           RIMPEX    OREQ 3
    C           COUEXR    ANDGT2
    C           RIMPEX    OREQ 2
    C           COUEXR    ANDNESCOUER
    C           RIMPEX    OREQ 1
    C           COUEXR    ANDNESCOUER
     C                     SETON                     14
F2  C                     END
D2  C           RIMPEX    IFEQ 4
    C           TVEEXR    ANDNERVERES
    C           TVEEXR    ANDNE'N'
    C           TVEEXR    ANDNE'K'
    C           RIMPEX    OREQ 3
    C           TVEEXR    ANDNERVERES
    C           RIMPEX    OREQ 1
    C           TVEEXR    ANDNERVERES
     C                     SETON                     14
F2  C                     END
     C                     MOVELPAPIE     PAPI
     C                     Z-ADDGRAME     GRAM
     C                     MOVELREFOUE    REFOUR
     C                     Z-ADDGRAREE    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEEXR    ANDNERVERES
     C                     SETON                     14
F2  C                     END
D2  C           COUEXR    IFEQ *ZEROS
    C           ENCEXR    ANDNE*ZEROS
    C           COUEXR    ORNE *ZEROS
    C           ENCEXR    ANDEQ*ZEROS
     C                     SETON                     14
F2  C                     END
D2  C           COUEXR    IFEQ *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     14
F2  C                     END
     C                     Z-ADDCOUEXR    GPEXR   20
D2  C           GRPEXR    IFNE *ZEROS
    C           GRPEXR    ANDLTCOUEXR
     C                     SETON                     14
F2  C                     END
D2  C           TVEEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             14
     C  N14      CVEEXR    COMP *ZEROS                   14
     C  N14                MOVELTBVRES    XVER00
     C  N14                ADD  XVER05    GPEXR
X2  C                     ELSE
     C           CVEEXR    COMP *ZEROS               1414
F2  C                     END
D2  C           UVEXTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XENCA1
     C                     MOVE UVEXTR    XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             14
F2  C                     END
     C   14                SETON                     98
F1  C                     END
    C*
D1  C           TIMPIN    IFNE *ZEROS
D2  C           TIMPIN    IFEQ 4
    C           COUIN     ANDGT5
    C           PETIT     ANDEQ'*'
    C           TIMPIN    OREQ 4
    C           COUIN     ANDGT6
    C           MOYEN     ANDEQ'*'
    C           TIMPIN    OREQ 3
    C           COUIN     ANDGT2
    C           TIMPIN    OREQ 2
    C           COUIN     ANDNESCOUIN
    C           TIMPIN    OREQ 1
    C           COUIN     ANDNESCOUIN
     C                     SETON                     15
F2  C                     END
D2  C           TIMPIN    IFEQ 4
    C           TVEIN     ANDNETVERIS
    C           TVEIN     ANDNE'N'
    C           TVEIN     ANDNE'K'
    C           TIMPIN    OREQ 3
    C           TVEIN     ANDNETVERIS
    C           TIMPIN    OREQ 1
    C           TVEIN     ANDNETVERIS
     C                     SETON                     15
F2  C                     END
     C                     MOVELPAPII     PAPI
     C                     Z-ADDGRAMI     GRAM
     C                     MOVELREFOUI    REFOUR
     C                     Z-ADDGRAREI    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEIN     ANDNETVERIS
     C                     SETON                     15
F2  C                     END
D2  C           COUIN     IFEQ *ZEROS
    C           ENCIN     ANDNE*ZEROS
    C           COUIN     ORNE *ZEROS
    C           ENCIN     ANDEQ*ZEROS
     C                     SETON                     15
F2  C                     END
D2  C           COUIN     IFEQ *ZEROS
    C           TVEIN     ANDEQ*BLANKS
     C                     SETON                     15
F2  C                     END
     C                     Z-ADDCOUIN     GPIN    20
D2  C           GRPIN     IFNE *ZEROS
    C           GRPIN     ANDLTCOUIN
     C                     SETON                     15
F2  C                     END
D2  C           TVEIN     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XVERA1
     C                     MOVE TVEIN     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             15
     C  N15      CVEIN     COMP *ZEROS                   15
     C  N15                MOVELTBVRES    XVER00
     C  N15                ADD  XVER05    GPEX
X2  C                     ELSE
     C           CVEIN     COMP *ZEROS               1515
F2  C                     END
D2  C           UVINT     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XENCA1
     C                     MOVE UVINT     XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             15
F2  C                     END
     C   15                SETON                     98
F1  C                     END
    C*
D1  C           RIMPIN    IFNE *ZEROS
D2  C           RIMPIN    IFEQ 4
    C           COUINR    ANDGT5
    C           PETIT     ANDEQ'*'
    C           RIMPIN    OREQ 4
    C           COUINR    ANDGT6
    C           MOYEN     ANDEQ'*'
    C           RIMPIN    OREQ 3
    C           COUINR    ANDGT2
    C           RIMPIN    OREQ 2
    C           COUINR    ANDNESCOUIR
    C           RIMPIN    OREQ 1
    C           COUINR    ANDNESCOUIR
     C                     SETON                     16
F2  C                     END
D2  C           RIMPIN    IFEQ 4
    C           TVEINR    ANDNERVERIS
    C           TVEINR    ANDNE'N'
    C           TVEINR    ANDNE'K'
    C           RIMPIN    OREQ 3
    C           TVEINR    ANDNERVERIS
    C           RIMPIN    OREQ 1
    C           TVEINR    ANDNERVERIS
     C                     SETON                     16
F2  C                     END
     C                     MOVELPAPII     PAPI
     C                     Z-ADDGRAMI     GRAM
     C                     MOVELREFOUI    REFOUR
     C                     Z-ADDGRAREI    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEINR    ANDNERVERIS
     C                     SETON                     16
F2  C                     END
D2  C           COUINR    IFEQ *ZEROS
    C           ENCINR    ANDNE*ZEROS
    C           COUINR    ORNE *ZEROS
    C           ENCINR    ANDEQ*ZEROS
     C                     SETON                     16
F2  C                     END
D2  C           COUINR    IFEQ *ZEROS
    C           TVEINR    ANDEQ*BLANKS
     C                     SETON                     16
F2  C                     END
     C                     Z-ADDCOUINR    GPINR   20
D2  C           GRPINR    IFNE *ZEROS
    C           GRPINR    ANDLTCOUEXR
     C                     SETON                     16
F2  C                     END
D2  C           TVEINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE TVEINR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             16
     C  N16      CVEINR    COMP *ZEROS                   16
     C  N16                MOVELTBVRES    XVER00
     C  N16                ADD  XVER05    GPEXR
X2  C                     ELSE
     C           CVEINR    COMP *ZEROS               1616
F2  C                     END
D2  C           UVINTR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XENCA1
     C                     MOVE UVINTR    XENCA2
     C                     MOVELXENCKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XENCRESS'TBLNOM
     C           KTBA01    CHAINXTBASE01             16
F2  C                     END
     C   16                SETON                     98
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE FORMAT COMPLEXAGE               *
     *--------------------------------------------------------*
    C           CTLF8     BEGSR
     *          ---------------
     C                     SETOF                     61
D1  C           RSICX     IFEQ *ZEROS
    C           *IN60     ANDEQ'1'
     C                     SETON                     6561
F1  C                     END
D1  C           NBPCX     IFGT 1
     C           LMINI     MULT NBPCX     LCC     41
D2  C           LCC       IFGT 140
     C                     SETON                     6461
F2  C                     END
F1  C                     END
    C* SI PELCXH
D1  C           *IN24     IFEQ '1'
D2  C           LZPEUT    IFEQ *ZEROS
    C           LZPEAP    OREQ *ZEROS
     C                     SETON                     6761
F2  C                     END
D2  C           LZPEUT    IFGT LZPEAP
     C                     SETON                     6661
F2  C                     END
F1  C                     END
      * NZS 15/07/15 MESSAGE POUR MINI MAXI DE LA COMPLEXEUSE
      * RECHERCHE DU PLUS PETIT ET DU PLUS GRAND
      * OUVERT = LE PLUS GRAND, DEFIL = LE PLUS PETIT
     C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
     C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
     C                     END
     C           DEFIL     IFLT 720
     C           OUVERT    ORGT 1420
     C                     Z-ADDFORL      EFORL
     C                     Z-ADDFORH      EFORH
     C                     EXFMTWOFFSET
     C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 1                            *
     *--------------------------------------------------------*
    C           SPCXH1    BEGSR
     *          ---------------
     C                     SETOF                     606263
     C                     MOVE *BLANKS   IMPCX
     C           PASECX    COMP 2                    62  62
     C           PASECX    COMP 3                    63  63
D1  C           TIMPEX    IFEQ 1
     C                     SETON                     60
     C                     MOVE 'HELIO'   IMPCX
F1  C                     END
D1  C           TIMPEX    IFEQ 2
     C                     SETON                     60
     C                     MOVE 'FLEXO'   IMPCX
F1  C                     END
     C                     MOVE PAPECX    PAPCX
     C                     Z-ADDGRAECX    GRACX
     C                     MOVE REFECX    ADPCX
     C                     Z-ADDRELECX    ADGCX
     C                     Z-ADDPASECX    PASCX
     C                     MOVE RSIECX    RSICX
     C                     MOVE APIECX    APICX
     C                     Z-ADDNBPECX    NBPCX
     C                     MOVE SCOECX    SCOCX
D1  C           APICX     IFEQ *BLANK
    C           *IN60     ANDEQ'1'
     C                     MOVE 'O'       APICX
F1  C                     END
     C                     MOVELADPCX     REFX    3
     C           REFX      COMP 'PEL'                    24
     C                     MOVE CPECXH    CPCXH
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 2                            *
     *--------------------------------------------------------*
    C           SPCXH2    BEGSR
     *          ---------------
     C                     MOVE RSICX     RSIECX
     C                     MOVE APICX     APIECX
     C                     Z-ADDNBPCX     NBPECX
     C                     MOVE SCOCX     SCOECX
     C                     MOVE CPCXH     CPECXH
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 3                            *
     *--------------------------------------------------------*
    C           SPCXH3    BEGSR
     *          ---------------
     C                     SETOF                     606263
     C                     MOVE *BLANKS   IMPCX
     C           PASICX    COMP 2                    62  62
     C           PASICX    COMP 3                    63  63
D1  C           TIMPIN    IFEQ 1
     C                     SETON                     60
     C                     MOVE 'HELIO'   IMPCX
F1  C                     END
D1  C           TIMPIN    IFEQ 2
     C                     SETON                     60
     C                     MOVE 'FLEXO'   IMPCX
F1  C                     END
     C                     MOVE PAPICX    PAPCX
     C                     Z-ADDGRAICX    GRACX
     C                     MOVE REFICX    ADPCX
     C                     Z-ADDRELICX    ADGCX
     C                     Z-ADDPASICX    PASCX
     C                     MOVE RSIICX    RSICX
     C                     MOVE APIICX    APICX
     C                     Z-ADDNBPICX    NBPCX
     C                     MOVE SCOICX    SCOCX
D1  C           APICX     IFEQ *BLANK
    C           *IN60     ANDEQ'1'
     C                     MOVE 'O'       APICX
F1  C                     END
     C                     MOVELADPCX     REFX
     C           REFX      COMP 'PEL'                    24
     C                     MOVE CPICXH    CPCXH
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 4                            *
     *--------------------------------------------------------*
    C           SPCXH4    BEGSR
     *          ---------------
     C                     MOVE RSICX     RSIICX
     C                     MOVE APICX     APIICX
     C                     Z-ADDNBPCX     NBPICX
     C                     MOVE SCOCX     SCOICX
     C                     MOVE CPCXH     CPICXH
    C                     ENDSR
     *-----------------------------------------------------------*
     * S/PROGRAMME : CONTROLE IMPRESSION SI COMMERCIAL SIMPLIFIE *
     *-----------------------------------------------------------*
    C           CTLIS     BEGSR
     *          ---------------
     C                     MOVE ' '       PETIT   1
     C                     MOVE ' '       MOYEN   1
D1  C           FORL      IFGE FORH
     C                     Z-ADDFORL      DEFIL   40
     C                     Z-ADDFORH      OUVERT  40
X1  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F1  C                     END
D1  C           DEFIL     IFLE 730
    C           OUVERT    ANDLE1050
     C                     MOVE '*'       PETIT
X1  C                     ELSE
D2  C           OUVERT    IFLE 1420
    C           DEFIL     ANDLE1030
     C                     MOVE '*'       MOYEN
F2  C                     END
F1  C                     END
    C*
D1  C           TIMPEX    IFNE *ZEROS
D2  C           TIMPEX    IFEQ 4
    C           COUEX     ANDGT5
    C           PETIT     ANDEQ'*'
    C           TIMPEX    OREQ 4
    C           COUEX     ANDGT6
    C           MOYEN     ANDEQ'*'
    C           TIMPEX    OREQ 3
    C           COUEX     ANDGT2
    C           TIMPEX    OREQ 2
    C           COUEX     ANDNESCOUEX
    C           TIMPEX    OREQ 1
    C           COUEX     ANDNESCOUEX
     C                     SETON                     13
F2  C                     END
D2  C           TIMPEX    IFEQ 4
    C           TVEEX     ANDNETVERES
    C           TVEEX     ANDNE'N'
    C           TVEEX     ANDNE'K'
    C           TIMPEX    OREQ 3
    C           TVEEX     ANDNETVERES
    C           TIMPEX    OREQ 1
    C           TVEEX     ANDNETVERES
     C                     SETON                     13
F2  C                     END
     C                     MOVELPAPIE     PAPI
     C                     Z-ADDGRAME     GRAM
     C                     MOVELREFOUE    REFOUR
     C                     Z-ADDGRAREE    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEEX     ANDNETVERES
     C                     SETON                     13
F2  C                     END
D2  C           COUEX     IFEQ *ZEROS
    C           XAPEX     ANDNE*BLANK
     C                     SETON                     13
F2  C                     END
D2  C           COUEX     IFEQ *ZEROS
    C           TVEEX     ANDEQ*BLANKS
     C                     SETON                     13
F2  C                     END
D2  C           TVEEX     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPEX    XVERA1
     C                     MOVE TVEEX     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             13
F2  C                     END
     C   13                SETON                     98
F1  C                     END
    C*
D1  C           RIMPEX    IFNE *ZEROS
D2  C           RIMPEX    IFEQ 4
    C           COUEXR    ANDGT5
    C           PETIT     ANDEQ'*'
    C           RIMPEX    OREQ 4
    C           COUEXR    ANDGT6
    C           MOYEN     ANDEQ'*'
    C           RIMPEX    OREQ 3
    C           COUEXR    ANDGT2
    C           RIMPEX    OREQ 2
    C           COUEXR    ANDNESCOUER
    C           RIMPEX    OREQ 1
    C           COUEXR    ANDNESCOUER
     C                     SETON                     14
F2  C                     END
D2  C           RIMPEX    IFEQ 4
    C           TVEEXR    ANDNERVERES
    C           TVEEXR    ANDNE'N'
    C           TVEEXR    ANDNE'K'
    C           RIMPEX    OREQ 3
    C           TVEEXR    ANDNERVERES
    C           RIMPEX    OREQ 1
    C           TVEEXR    ANDNERVERES
     C                     SETON                     14
F2  C                     END
     C                     MOVELPAPIE     PAPI
     C                     Z-ADDGRAME     GRAM
     C                     MOVELREFOUE    REFOUR
     C                     Z-ADDGRAREE    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEEXR    ANDNERVERES
     C                     SETON                     14
F2  C                     END
D2  C           COUEXR    IFEQ *ZEROS
    C           XAPEXR    ANDNE*BLANK
     C                     SETON                     14
F2  C                     END
D2  C           COUEXR    IFEQ *ZEROS
    C           TVEEXR    ANDEQ*BLANKS
     C                     SETON                     14
F2  C                     END
D2  C           TVEEXR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPEX    XVERA1
     C                     MOVE TVEEXR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             14
F2  C                     END
     C   14                SETON                     98
F1  C                     END
    C*
D1  C           TIMPIN    IFNE *ZEROS
D2  C           TIMPIN    IFEQ 4
    C           COUIN     ANDGT5
    C           PETIT     ANDEQ'*'
    C           TIMPIN    OREQ 4
    C           COUIN     ANDGT6
    C           MOYEN     ANDEQ'*'
    C           TIMPIN    OREQ 3
    C           COUIN     ANDGT2
    C           TIMPIN    OREQ 2
    C           COUIN     ANDNESCOUIN
    C           TIMPIN    OREQ 1
    C           COUIN     ANDNESCOUIN
     C                     SETON                     15
F2  C                     END
D2  C           TIMPIN    IFEQ 4
    C           TVEIN     ANDNETVERIS
    C           TVEIN     ANDNE'N'
    C           TVEIN     ANDNE'K'
    C           TIMPIN    OREQ 3
    C           TVEIN     ANDNETVERIS
    C           TIMPIN    OREQ 1
    C           TVEIN     ANDNETVERIS
     C                     SETON                     15
F2  C                     END
     C                     MOVELPAPII     PAPI
     C                     Z-ADDGRAMI     GRAM
     C                     MOVELREFOUI    REFOUR
     C                     Z-ADDGRAREI    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEIN     ANDNETVERIS
     C                     SETON                     15
F2  C                     END
D2  C           COUIN     IFEQ *ZEROS
    C           XAPIN     ANDNE*BLANK
     C                     SETON                     15
F2  C                     END
D2  C           COUIN     IFEQ *ZEROS
    C           TVEIN     ANDEQ*BLANKS
     C                     SETON                     15
F2  C                     END
D2  C           TVEIN     IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE TIMPIN    XVERA1
     C                     MOVE TVEIN     XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             15
F2  C                     END
     C   15                SETON                     98
F1  C                     END
    C*
D1  C           RIMPIN    IFNE *ZEROS
D2  C           RIMPIN    IFEQ 4
    C           COUINR    ANDGT5
    C           PETIT     ANDEQ'*'
    C           RIMPIN    OREQ 4
    C           COUINR    ANDGT6
    C           MOYEN     ANDEQ'*'
    C           RIMPIN    OREQ 3
    C           COUINR    ANDGT2
    C           RIMPIN    OREQ 2
    C           COUINR    ANDNESCOUIR
    C           RIMPIN    OREQ 1
    C           COUINR    ANDNESCOUIR
     C                     SETON                     16
F2  C                     END
D2  C           RIMPIN    IFEQ 4
    C           TVEINR    ANDNERVERIS
    C           TVEINR    ANDNE'N'
    C           TVEINR    ANDNE'K'
    C           RIMPIN    OREQ 3
    C           TVEINR    ANDNERVERIS
    C           RIMPIN    OREQ 1
    C           TVEINR    ANDNERVERIS
     C                     SETON                     16
F2  C                     END
     C                     MOVELPAPII     PAPI
     C                     Z-ADDGRAMI     GRAM
     C                     MOVELREFOUI    REFOUR
     C                     Z-ADDGRAREI    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C  N50      CATEGO    IFGT 'B'
    C           TVEINR    ANDNERVERIS
     C                     SETON                     16
F2  C                     END
D2  C           COUINR    IFEQ *ZEROS
    C           XAPINR    ANDNE*BLANK
     C                     SETON                     16
F2  C                     END
D2  C           COUINR    IFEQ *ZEROS
    C           TVEINR    ANDEQ*BLANKS
     C                     SETON                     16
F2  C                     END
D2  C           TVEINR    IFNE *BLANKS
     C                     Z-ADD1         TBNSEG
     C                     MOVE RIMPIN    XVERA1
     C                     MOVE TVEINR    XVERA2
     C                     MOVELXVERKE    TBVARG
     C                     MOVE *BLANKS   TBVRES
     C                     MOVEL'XVERNISS'TBLNOM
     C           KTBA01    CHAINXTBASE01             16
F2  C                     END
     C   16                SETON                     98
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE - MISE A BLANC                  *
     *--------------------------------------------------------*
    C           SPCXH5    BEGSR
     *          ---------------
     C                     MOVE *BLANKS   RSIECX
     C                     MOVE *BLANKS   APIECX
     C                     Z-ADD*ZEROS    NBPECX
     C                     MOVE *BLANKS   SCOECX
     C                     MOVE *BLANKS   CPECXH
    C                     ENDSR
    C           SPCXH6    BEGSR
     *          ---------------
     C                     MOVE *BLANKS   RSIICX
     C                     MOVE *BLANKS   APIICX
     C                     Z-ADD*ZEROS    NBPICX
     C                     MOVE *BLANKS   SCOICX
     C                     MOVE *BLANKS   CPICXH
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE - COMPOSANT                     *
     *--------------------------------------------------------*
    C           COMCXH    BEGSR
     *          ---------------
     C           CLE4      SETLLCXHLIGL1
     C                     SETOF                     98
    C*
D1  C                     DO   *HIVAL
     C           CLE4      READECXHLIGL1                 50
    C   50                GOTO FCOMCX
D2  C           SUPCXH    IFNE 'F'
     C           CLE4B     CHAINMATPREL1             98
D3  C           CATEGO    IFGT 'B'
    C           *IN98     ANDEQ'0'
D4  C           UYEAR     IFGT VALAN
    C           UYEAR     OREQ VALAN
    C           UMONTH    ANDGTVALMOI
     C                     SETON                     98
F4  C                     END
F3  C                     END
    C   98                GOTO FCOMCX
F2  C                     END
F1  C                     END
    C           FCOMCX    ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : OFFSET   - CONTROLE FORMAT OFFSET        *
     *--------------------------------------------------------*
    C           CTLOFF    BEGSR
     *          ---------------
D1  C           FORL      IFNE *ZEROS
    C           FORH      ANDNE*ZEROS
     C                     Z-ADD0         WAFF    10
     * Recherche du plus petit et du plus grand
     * OUVERT = le plus grand, DEFIL = le plus petit
D2  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X2  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F2  C                     END
     * Test Mini Offset
D2  C           OUVERT    IFGE 850
    C           DEFIL     ANDGE620
X2  C                     ELSE
     C                     Z-ADD1         WAFF
F2  C                     END
     *
     * Impression offset en UV
D2  C           TIMPEX    IFEQ 4
    C           TVEEX     ANDEQ'U'
    C           TIMPEX    OREQ 4
    C           UVEXT     ANDEQ'U'
    C           TIMPIN    OREQ 4
    C           TVEIN     ANDEQ'U'
    C           TIMPIN    OREQ 4
    C           UVINT     ANDEQ'U'
D3  C           DEFIL     IFLE 1020
    C           OUVERT    ANDLE1420
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
X2  C                     ELSE
     *
     * impression offset en TRADI
D3  C           DEFIL     IFLE 1050
    C           OUVERT    ANDLE1450
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
F2  C                     END
     *
     * impression avec dorure
D2  C           CODDOR    IFEQ '*'
D3  C           OUVERT    IFGE 850
    C           DEFIL     ANDGE620
D4  C           DEFIL     IFLE 890
    C           OUVERT    ANDLE1260
X4  C                     ELSE
     C                     Z-ADD1         WAFF
F4  C                     END
X3  C                     ELSE
     C                     Z-ADD1         WAFF
F3  C                     END
F2  C                     END
     *
     * Affichage d'une fenetre avec alerte sur le format
D2  C           WAFF      IFEQ 1
     C                     Z-ADDFORL      EFORL
     C                     Z-ADDFORH      EFORH
     C                     EXFMTWOFFSET
F2  C                     END
     *
F1  C                     END
    C           FTLOFF    ENDSR
     *--- Début --- Philippe --- 02/11/2015 --- Pose Accessoires  *
     *-------------------------------------------------------------*
     * S/PROGRAMME : TRTPOS   - Saisie infos Accessoires .........
     *-------------------------------------------------------------*
    C           TRTPOS    BEGSR
     *          ---------------
     C                     CLEARACC002
     *          ---------------
     C                     MOVEL'CRT'     TYPAFF
     C** 40 07             MOVEL'MOD'     TYPAFF
     C   40                MOVEL'MOD'     TYPAFF
     C                     MOVELEYECOD    WCOD01
     C                     MOVELEYEMOD    WMOD01
     C                     MOVE EYENB     WNB01
     C                     MOVELCORCOD    WCOD02
     C                     MOVE CORDNB    WNB02
     C                     MOVELBTPCOD    WCOD03
     C                     MOVELBTPMOD    WMOD03
     C                     MOVE BTPNB     WNB03
     C                     MOVEL'DEV001£' WFROM
     C                     CALL 'ACC002£'
     C                     PARM           ACC002
     *          ---------------
     * Si Annulation par F12 demandée, on remet à blancs les différents champs
     *          ---------------
    C           WCDRET    IFEQ 'PR'
     C                     CLEAREPOSE
     C                     CLEARDEBACC
     C                     ENDIF
     *          ---------------
     * Si retour écran précédent, le code retour = 'OK', affectation des
     * nouvelles valeurs aux champs DEVIS
     *          ---------------
    C           WCDRET    IFEQ 'OK'
     C                     MOVELWCOD01    EYECOD
     C                     MOVELWMOD01    EYEMOD
     C                     MOVELWNB01     EYENB
     C                     MOVELWCOD02    CORCOD
     C                     MOVELWNB02     CORDNB
     C                     MOVELWCOD03    BTPCOD
     C                     MOVELWMOD03    BTPMOD
     C                     MOVELWNB03     BTPNB
     C                     ENDIF
     *          ---------------
    C           FTRPOS    ENDSR
     *--- Fin   --- Philippe --- 02/11/2015 --- Pose Accessoires  *
     ODEVISF1 E                MAJDES
     O                         TAG1
     O                         TAG2
     O                         TYPDEV
** TABLE VALIDATION FACON/CCOL --> NOMBRE PAPIER                        **
001
101
122
141
172
222
401
413
422
433
441
452
465
472
481
495
501
513
522
533
565
595
601
613
622
633
652
665
672
681
695
701
713
722
733
752
765
781
795
801
813
822
833
852
865
881
895
922
**
01IMP. EXT. PRINC
02IMP. EXT. REP.
03IMP. INT. PRINC
04IMP. INT. REP.
05COMPLEXAGE SOF.
06GAUFRAGE
07ONDULATION
08CONTRE COLLAGE
09POST PRINT
10DECOUPAGE
11DECORTICAGE
12POSE FENETRE
131° ASSEMBLAGE
142° ASSEMBLAGE
15COMPLEXAGE EXT.
16COMPLEXAGE INT.
17BOBST FLEXO EXT.
18BOBST FLEXO INT.
19GENCO 2° AFFICHE
20CONTRE COLLAGE
21AFFICHAGE EXT.
22AFFICHAGE INT.
23BANDE ADHESIVE
241° PELLICULAGE
252° PELLICULAGE
26DORURE 1° PASSAGE
27DORURE 2° PASSAGE
28OEILLETS
29BOUTONS PRESSIONS
662° GAUFRAGE
** OVR **
DLTOVR *ALL
OVRDBF FILE(DEVIS) MBR(DEVIS)
OVRDBF FILE(DEVIS) MBR(PANEL)
OVRDBF FILE(DEVIS) MBR(SIMULBE)
OVRDBF FILE(DEVIS) MBR(SIMUL)
COMMERCIAL
OVRDBF FILE(DEVIS) MBR(ENQUETE)
OVRDBF FILE(DEVIS) MBR(PANSOF)
OVRDBF FILE(DEVIS) MBR(PREIMP)
QUALITE
OVRDBF FILE(DEVIS2) MBR(DEVIS)
OVRDBF FILE(DEVIS2) MBR(PANEL)
OVRDBF FILE(DEVIS2) MBR(SIMULBE)
OVRDBF FILE(DEVIS2) MBR(SIMUL)
OVRDBF FILE(DEVIS2) MBR(ENQUETE)
OVRDBF FILE(DEVIS2) MBR(PANSOF)
OVRDBF FILE(DEVIS2) MBR(PREIMP)
LOGISTIQUE
FILM 1° PELLICULAGE ERRONÉ
FILM 2° PELLICULAGE ERRONÉ
ERREURS SUR 2° AFFICHAGE
1° PASSAGE DORURE OBLIGATOIRE
NATURE ET DIFFICULTE OBLIGATOIRE
NATURE DORURE INVALIDE
FAMILLE FILM ET SURFACE OBLIGATOIRE
FAMILLE FILM INVALIDE
1° FILM OBLIGATOIRE
N° PASSAGE INVALIDE
 LABELISE FSC
OVRDBF FILE(DEVAMLL1) MBR(DEVIS)
OVRDBF FILE(DEVAMLL1) MBR(SIMULBE)
OVRDBF FILE(DEVAMLL1) MBR(SIMUL)
DEFINITION, % ECONOMIQUE, NOMBRE OBLIGATOIRES
SECTION FIN QUE SI DEFINITION
DECOMPOSITION EN 2 ELEMENTS MINIMUM
PAS DE LIGNE BLANCHE
SOMME DES % ECONOMIQUE DIFFERENTE DE 100
TYPE D'ENCRE POUR PEINTURE SUR TRANCHE INVALIDE
**
DSDEVIS: SAISIE
DMDEVIS: MODIFICATION
DCDEVIS: CREATION/SIMPLIF
DEDEVIS: CREATION/ETIQ.
DVDEVIS: VARIANTE
PSPANEL: SAISIE
PMPANEL: MODIFICATION
PCPANEL: CREATION/SIMPLIF
PEPANEL: CREATION/ETIQ.
PVPANEL: VARIANTE
BSSIMULATION: SAISIE
BMSIMULATION: MODIFICATION
BCSIMUL: CREATION/SIMPLIF
BESIMUL: CREATION/ETIQ.
BVSIMULATION: VARIANTE
SSSIMULATION: SAISIE
SMSIMULATION: MODIFICATION
SCSIMUL: CREATION/SIMPLIF
SESIMUL: CREATION/ETIQ.
SVSIMULATION: VARIANTE
ESENQUETE: SAISIE
EMENQUETE: MODIFICATION
ECENQUETE: CREATION/SIMPLIF
EEENQUETE: CREATION/ETIQ.
EVENQUETE: VARIANTE
CSPANEL: SAISIE
CMPANEL: MODIFICATION
CCPANEL: CREATION/SIMPLIF
CEPANEL: CREATION/ETIQ.
CVPANEL: VARIANTE
ISPRE-IMPRIME: SAISIE
