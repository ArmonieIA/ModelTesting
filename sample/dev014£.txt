      *%CSTD===========================================================*
      ** Application. : EMAGE      Logiciel métier DS Smith            *
      ** Composant. . : DEV014£                       Type: RPG        *
      **===============================================================*
      ** Sous-système :                                                *
      ** Fonction . . :                                                *
      ** Sous-fonction:                                                *
      **%S=============================================================*
      ** Description des fonctionnalités:                              *
      **                                                               *
      **                                                               *
      **                                                               *
      **%E=============================================================*
      ** AUTEUR:                          00:00                        *
      ** MODIFS: 15 TMATPR     30/11/2023 16:38  97.40.01 FM 23/  191  *
      **           Amélioration Toury's Market                         *
      **         14 TMATPR     28/11/2023 08:52  01.10.37 FM 23/  184  *
      **           Modification du champ "Type de ramassage"           *
      **         13 NOUZIERES  24/08/2023 14:33  01.09.92 FM 23/  119  *
      **           nouveau fenetre papier blanc                        *
      **         12 NOUZIERES  21/08/2023 18:00  01.09.89 FM 23/  111  *
      **           gestion de la doreuse B23                           *
      **         11 TMAAQU     05/06/2023 11:47  01.09.54 FM 23/   23  *
      **           gestion du nouveau CCOL=6 COMPACT Format/format     *
      **         10 TMAAQU     28/03/2023 15:24  01.09.20 FM 23/   40  *
      **           Ajout Code H BRANO 80grs                            *
      **         09 NOUZIERES  07/11/2022 09:26  01.08.55 FM 22/  237  *
      **           vernis D = 2 groupes + E2A                          *
      **         08 NOUZIERES  03/11/2022 12:15  01.08.53 FM 22/  237  *
      **         07 NOUZIERES  02/03/2022 16:49  01.07.20 FM 22/   64  *
      **           projet Guerlain                                     *
      **         06 TMAAQU     10/02/2022 17:27  01.07.01 FM 22/   42  *
      **           supprimer profil ROUGIER_O                          *
      *%ECSTD==========================================================*
     *********************************************************
     *  PROJET : J.C.C.                                      *
     *  REALISATION : G.P. LE 22.12.81                       *
     *********************************************************
     *             * IBM 38 *  NOUVELLE VERSION 1984         *
     * EN REMPLACEMENT DES RPG : DU DEV002£ AU DEV009£       *
     * SAISIE DES DEVIS     *     ADAPTATION GP. AU 30/3/84  *
     *            SIMULATION-->23.7.84 (GP)                  *
     *            VARIANTE/CORRECTION-->25.7.84 (GP)         *
     *            MISE A JOUR D'UN PRODUIT-->31.7.84 (GP)    *
     * NORMALISATION DES FICHIERS LE 28.5.85 G.PUJOS         *
     *************************************************************
     **  HISTORIQUE                                              *
     **                                                          *
     **  AUTEUR !    DATE    ! OBJET DE LA MODIFICATION          *
     ** --------!------------!---------------------------------- *
     **  TMAGPI ! 04-04-2011 ! DEMANDE UTILISATEUR: CALL 1462390 *
     ** --------!------------!---------------------------------- *
     **  TMAGPI ! 25-11-2011 ! Passage 8 à 15 éléments           *
     **         !            ! par garniture                     *
     ** --------!------------!---------------------------------- *
     **  TMAFBU ! 19-03-2013 ! Test sur 3.0 au lieu de 2.0       *
     **         !            ! rapport de couverture d'encres    *
     ** --------!------------!---------------------------------- *
     **  TMAGPI ! 03-10-2013 ! IC 782217: Supress du msg envoyé  *
     **         !            ! à G.JAVELAUD                      *    4
     ** --------!------------!---------------------------------- *
     ** TMAFBU 23/10/2014 INC0190906 ONDH = FMINH+22 POUR        *
     ** ONDULE ACHETE                                            *
     ** --------!------------!---------------------------------- *
     ** PHILIPPE! 13-01-2015 ! INC0222477:Supress du msg envoyé  *
     **         !            ! à L.BALLIN                        *    4
     ** --------!------------!--------------------------------------- *
     ** PHILIPPE! 17-11-2015 ! Projet "Pose Accessoires":             *
     **         !            ! - Ajout du fichier des critères de     *
     **         !            ! pose d'accessoires en MAJ              *
     **         !            ! - Appel du pgm de création de la liste *
     **         !            ! des articles à créer le cas échéant    *
     ** --------!------------!--------------------------------------- *
     ** PHILIPPE! 06-01-2016 ! INC0324676:Ajout Possibilité de        *
     **         !            ! saisir un code conception pour l'usine *
     **         !            ! de Neuville                            *
     ** --------!------------!--------------------------------------- *
     **NOUZIERES! 10-03-2016 ! SUPPRESSION DES MODIF PLC MANX310      *
     ** --------!------------!--------------------------------------- *
     **NOUZIERES! 16-06-2016 ! OFFSET 3B                              *
     ** --------!------------!--------------------------------------- *
     **TMAFBU   ! 19-04-2017 ! ONDULEUSE 14 TOURY                     *
     ** --------!------------!--------------------------------------- *
     **TMAFME   ! 16-05-2017 ! INC0463463:Ajout Possibilité de        *
     **         !            ! saisir un type de produit pour client  *
     **         !            ! 8928                                   *
     ** --------!------------!--------------------------------------- *
     **NOUZIERES! 31-05-2017 ! AJOUT APPEL FT ONDULEUSE               *
     ** --------!------------!--------------------------------------- *
     **TMAFME   ! 21-09-2017 ! Remplacer NICOLLET par CONSUMER        *
     ** --------!------------!--------------------------------------- *
     **TMAFBU   ! 25/09/2017 ! AJOUT ENCRE TRADI 'T'                  *
     ******************************************************************
     F/SPACE 2
     FDEV014D CF  E                    WORKSTN
     F                                              KINFDS àINFDS
     FMATPREL1IF  E           K        DISK
     FPREIMP2 IF  E           K        DISK
     FPARAME  IF  E           K        DISK
    FPRODUI2 UF  E           K        DISK
    FPRODST2 UF  E           K        DISK
    FPRODST5 UF  E           K        DISK                      A
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     * - Fichier des critères définissant une pose d'accessoires         *
    FPRODST6 UF  E           K        DISK                      A
     *--- Fin   --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     FPRODUL11IF  E           K        DISK
     FPRODUL13IF  E           K        DISK
     FCLIENTS1IF  E           K        DISK
     FQUALIL3 IF  E           K        DISK
     FMACHIN  IF  E           K        DISK
     FFORDECL1IF  E           K        DISK
     FFORDECL6IF  E           K        DISK
     F            FORDECF1                          KRENAMEFORDL6
    FPRODUL14UF  E           K        DISK
     FPRODUL18IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODL18
     FPRODUL10IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODL10
     FPRODUL3 IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUF3
     F            PRODARF1                          KRENAMEPRODAF3
     FPRODUL4 IF  E           K        DISK
     F            PRODUIF1                          KRENAMEPRODUF4
     F            PRODARF1                          KRENAMEPRODAF4
    FOBSPROL1UF  E           K        DISK                      A
     FCDESL5  IF  E           K        DISK
     FMVTIMPLFIF  E           K        DISK
     FENCIMPL6IF  E           K        DISK
     FENCFACL5IF  E           K        DISK
     FLIEUST03IF  E           K        DISK                           UC
     FPLAMAL8 IF  E           K        DISK
     FCXHLIGL2IF  E           K        DISK
     FCOMPREL2IF  E           K        DISK
     F            COMPREF1                          KRENAMECOMPREF2
     FCOMPREL1IF  E           K        DISK
     FXTBASE01IF  E           K        DISK
     FTTREXP  IF  E           K        DISK
     FTRANSP  IF  E           K        DISK
     FPRODUL28IF  E           K        DISK
     FCALENAL4IF  E           K        DISK
     FCODBARL2IF  E           K        DISK
     FPOIGNEL1IF  E           K        DISK
     FLAIUTIL1IF  E           K        DISK
     FMNUUTIL1IF  E           K        DISK
     FMNUOPTL2IF  E           K        DISK
     FMNUAUTL1IF  E           K        DISK
     FCLEFIL1 IF  E           K        DISK
     FFTYPOPL1IF  E           K        DISK
     FPREACFI2IF  E           K        DISK
     FCLILOGL5IF  E           K        DISK
     F/SPACE 5
     ** TABLE DES MESSAGE INTERNE **********************
     **                  MESS    1  65 70
     E                    MESS    1  67 70
     ** TABLEAU INTERNE - CONTROLE SI MODIF.IMP.FEN.ASS.
     E                    IMP         7  6
     E                    FA          3  2 0
     ** CHANGEMENT DE TYPE DE FACONNAGE (VARIANTE/SIMUL.OUVERTE)
     E                    TAB8    1   6  2 0 TAB88   1
     ** OVRDBF POUR SELECTION DU FICHIER DE TRAVAIL ET DE CONTROLE .
     E                    OVR     1   1 40
    E*                   TGAR   25  45  2
     E                    TGAR   25 130  2
     E                    SB1    70 140  1
     E                    SB2    70 140  1
     E                    SB3    70 140  1
     E                    SB4    70 140  1
     *--- DÉBUT --- PHILIPPE 13/01/2015-- INC0222477 ---*
    E**                  SB5    70 140  1
     *--- FIN   --- PHILIPPE 13/01/2015-- INC0222477 ---*
     * TMAGPI - SD 1462390
     E                    SB6    70 140  1
     *
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
    E**                  TABCS   1  28  2 0 TABLS  14
     * - Suite ajout des 2 postes pour le post-assemblage
     E                    TABCS   1  32  2 0 TABLS  14
     *--- Fin   --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     E                    TN         16  2 0
     E                    SPRD       14  3 2
     E                    SPRG       14  3 2
     E                    SPRO       14  3 2
     E                    SPEF       14  1 0
     E                    SPDE       14  3 1
     E                    SROC       14  5 0
     E                    SRET       14  4 2
     E                    LSS        14 20
     E                    TSS        14  2 0
     E                    PRD        14  3 2
     E                    PRG        14  3 2
     E                    PRO        14  3 2
     E                    PEF        14  1 0
     E                    PDE        14  3 1
     E                    ROC        14  5 0
     E                    RET        14  4 2
     E                    UST         9  1
     E                    TU          5  1
     E                    TAB3    1  51  2   TAB33   1
     E                    TNOM    1   2 10
     E                    DERR    1  12 50
     E                    LIBMSG  1   5 15
     E/SPACE 5
     *
     IPF06
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRDI1                           PRD,1
     I              PRDI2                           PRD,2
     I              PRDI3                           PRD,3
     I              PRDI4                           PRD,4
     I              PRDI5                           PRD,5
     I              PRDI6                           PRD,6
     I              PRDI7                           PRD,7
     I              PRDI8                           PRD,8
     I              PRDI9                           PRD,9
     I              PRDI10                          PRD,10
     I              PRDI11                          PRD,11
     I              PRDI12                          PRD,12
     I              PRDI13                          PRD,13
     I              PRDI14                          PRD,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     I              PROU1                           PRO,1
     I              PROU2                           PRO,2
     I              PROU3                           PRO,3
     I              PROU4                           PRO,4
     I              PROU5                           PRO,5
     I              PROU6                           PRO,6
     I              PROU7                           PRO,7
     I              PROU8                           PRO,8
     I              PROU9                           PRO,9
     I              PROU10                          PRO,10
     I              PROU11                          PRO,11
     I              PROU12                          PRO,12
     I              PROU13                          PRO,13
     I              PROU14                          PRO,14
     I              PEFF1                           PEF,1
     I              PEFF2                           PEF,2
     I              PEFF3                           PEF,3
     I              PEFF4                           PEF,4
     I              PEFF5                           PEF,5
     I              PEFF6                           PEF,6
     I              PEFF7                           PEF,7
     I              PEFF8                           PEF,8
     I              PEFF9                           PEF,9
     I              PEFF10                          PEF,10
     I              PEFF11                          PEF,11
     I              PEFF12                          PEF,12
     I              PEFF13                          PEF,13
     I              PEFF14                          PEF,14
     I              PDEC1                           PDE,1
     I              PDEC2                           PDE,2
     I              PDEC3                           PDE,3
     I              PDEC4                           PDE,4
     I              PDEC5                           PDE,5
     I              PDEC6                           PDE,6
     I              PDEC7                           PDE,7
     I              PDEC8                           PDE,8
     I              PDEC9                           PDE,9
     I              PDEC10                          PDE,10
     I              PDEC11                          PDE,11
     I              PDEC12                          PDE,12
     I              PDEC13                          PDE,13
     I              PDEC14                          PDE,14
     I              ROCA1                           ROC,1
     I              ROCA2                           ROC,2
     I              ROCA3                           ROC,3
     I              ROCA4                           ROC,4
     I              ROCA5                           ROC,5
     I              ROCA6                           ROC,6
     I              ROCA7                           ROC,7
     I              ROCA8                           ROC,8
     I              ROCA9                           ROC,9
     I              ROCA10                          ROC,10
     I              ROCA11                          ROC,11
     I              ROCA12                          ROC,12
     I              ROCA13                          ROC,13
     I              ROCA14                          ROC,14
     I              RETP1                           RET,1
     I              RETP2                           RET,2
     I              RETP3                           RET,3
     I              RETP4                           RET,4
     I              RETP5                           RET,5
     I              RETP6                           RET,6
     I              RETP7                           RET,7
     I              RETP8                           RET,8
     I              RETP9                           RET,9
     I              RETP10                          RET,10
     I              RETP11                          RET,11
     I              RETP12                          RET,12
     I              RETP13                          RET,13
     I              RETP14                          RET,14
     ILIEUSTF1
     I              NCONF                           LICONF
     I              SEQFAB                          LISEQF
     I              LIEUST                          LILIEU
     I              EXPEDM                          LIPEDM
     I              EXPEDJ                          LIPEDJ
     I              USINE                           LIUSIN
     I              NBCAIS                          LINBCA
     *
     IPRODUIF1
     I              EMBA1                           STCTDF
     I              EMBA2                           STCTDE
     I              CAIS1                           STCTDI
     IPRODSTF1
     I              SS1                             TSS,1
     I              SS2                             TSS,2
     I              SS3                             TSS,3
     I              SS4                             TSS,4
     I              SS5                             TSS,5
     I              SS6                             TSS,6
     I              SS7                             TSS,7
     I              SS8                             TSS,8
     I              SS9                             TSS,9
     I              SS10                            TSS,10
     I              SS11                            TSS,11
     I              SS12                            TSS,12
     I              SS13                            TSS,13
     I              SS14                            TSS,14
     I              PRDI1                           PRD,1
     I              PRDI2                           PRD,2
     I              PRDI3                           PRD,3
     I              PRDI4                           PRD,4
     I              PRDI5                           PRD,5
     I              PRDI6                           PRD,6
     I              PRDI7                           PRD,7
     I              PRDI8                           PRD,8
     I              PRDI9                           PRD,9
     I              PRDI10                          PRD,10
     I              PRDI11                          PRD,11
     I              PRDI12                          PRD,12
     I              PRDI13                          PRD,13
     I              PRDI14                          PRD,14
     I              PRGR1                           PRG,1
     I              PRGR2                           PRG,2
     I              PRGR3                           PRG,3
     I              PRGR4                           PRG,4
     I              PRGR5                           PRG,5
     I              PRGR6                           PRG,6
     I              PRGR7                           PRG,7
     I              PRGR8                           PRG,8
     I              PRGR9                           PRG,9
     I              PRGR10                          PRG,10
     I              PRGR11                          PRG,11
     I              PRGR12                          PRG,12
     I              PRGR13                          PRG,13
     I              PRGR14                          PRG,14
     I              PROU1                           PRO,1
     I              PROU2                           PRO,2
     I              PROU3                           PRO,3
     I              PROU4                           PRO,4
     I              PROU5                           PRO,5
     I              PROU6                           PRO,6
     I              PROU7                           PRO,7
     I              PROU8                           PRO,8
     I              PROU9                           PRO,9
     I              PROU10                          PRO,10
     I              PROU11                          PRO,11
     I              PROU12                          PRO,12
     I              PROU13                          PRO,13
     I              PROU14                          PRO,14
     I              PEFF1                           PEF,1
     I              PEFF2                           PEF,2
     I              PEFF3                           PEF,3
     I              PEFF4                           PEF,4
     I              PEFF5                           PEF,5
     I              PEFF6                           PEF,6
     I              PEFF7                           PEF,7
     I              PEFF8                           PEF,8
     I              PEFF9                           PEF,9
     I              PEFF10                          PEF,10
     I              PEFF11                          PEF,11
     I              PEFF12                          PEF,12
     I              PEFF13                          PEF,13
     I              PEFF14                          PEF,14
     I              PDEC1                           PDE,1
     I              PDEC2                           PDE,2
     I              PDEC3                           PDE,3
     I              PDEC4                           PDE,4
     I              PDEC5                           PDE,5
     I              PDEC6                           PDE,6
     I              PDEC7                           PDE,7
     I              PDEC8                           PDE,8
     I              PDEC9                           PDE,9
     I              PDEC10                          PDE,10
     I              PDEC11                          PDE,11
     I              PDEC12                          PDE,12
     I              PDEC13                          PDE,13
     I              PDEC14                          PDE,14
     I              ROCA1                           ROC,1
     I              ROCA2                           ROC,2
     I              ROCA3                           ROC,3
     I              ROCA4                           ROC,4
     I              ROCA5                           ROC,5
     I              ROCA6                           ROC,6
     I              ROCA7                           ROC,7
     I              ROCA8                           ROC,8
     I              ROCA9                           ROC,9
     I              ROCA10                          ROC,10
     I              ROCA11                          ROC,11
     I              ROCA12                          ROC,12
     I              ROCA13                          ROC,13
     I              ROCA14                          ROC,14
     I              RETP1                           RET,1
     I              RETP2                           RET,2
     I              RETP3                           RET,3
     I              RETP4                           RET,4
     I              RETP5                           RET,5
     I              RETP6                           RET,6
     I              RETP7                           RET,7
     I              RETP8                           RET,8
     I              RETP9                           RET,9
     I              RETP10                          RET,10
     I              RETP11                          RET,11
     I              RETP12                          RET,12
     I              RETP13                          RET,13
     I              RETP14                          RET,14
     I              ICEE3                           PTDIF
     I              IAEE3                           PTENC
     IPRODSTF5
     I              PAPI                            PAPCX
     I              GRAMM                           GRACX
     I              REFOUR                          ADPCX
     I              GRAREL                          ADGCX
     IQUALIF1
     I              GRAMM                           GRA
     I              SUIVI                           SUI
     IMATPREF1
     I              MM                              MMMMMM
     I              PAPI                            PAPIMM
     ICLIENTF1
     I              ANNUL                           WWW10
     IMACHINF1
     I              USINE                           USMACH
     IFORDECF1
     I              ANDEV                           ZB18
     I              ETUDE                           ZB19
     I              USINE                           ZB20
     I              ZB15                            FZB15
     I              TDECO                           FTDEC
     I              POSFO                           FPOSF
     I              KDEC                            FKDEC
     IFORDL6
     I              ANDEV                           ZB18
     I              ETUDE                           ZB19
     I              USINE                           ZB20
     IPREIMPF1
     I              FORLST                          ZB21
     I              FORHST                          ZB22
     I              PASFST                          ZB23
     I              TSS                             TSSS
     IENCFACF1
     I              SEQ                             ZSEQ
     I              ABRCLI                          ZBRCLI
     IMVTIMPF1
     I              USINE                           ZUSINE
     I              NCONF                           ZCONF
     I              ANDEV                           ZNDEV
     I              ETUDE                           ZTUDE
     I              SEQDE                           ZEQDE
     I              UVENT                           ZVENT
     I              FACON                           ZACON
     I              PAPI                            ZAPI
     I              GRAMM                           ZRAMM
     I              REFOUR                          ZEFOUR
     I              GRAREL                          ZRAREL
     I              LAIZE                           ZAIZE
     I              COUL                            ZCOUL
     ICDESF1
     I              AGENT                           ZAGEN
     I              GROUPE                          ZGROUP
     I              POSTE                           ZPOSTE
     ICXHLIGF1
     I              GRAMM                           GRAM
     IPLAMAF1
     I              IMP                             WWW12
     I              SUP01                           WWW13
     I              SUP02                           WWW14
     I              SUP03                           WWW15
     I              SUP04                           WWW16
     IPRODF1
     I              STE                             SOFSTE
     I              NOCLI                           SOFCLI
     I              NOPRO                           SOFPRO
     I              INDPCL                          SOFIND
     I              DECL                            SOFDL
     I              DECH                            SOFDH
     I              ANNUL                           SOFANN
     I              NOFOR                           SOFFOR
     I              CCOL                            SOFCC
     IMNUOPTF1
     I              PARAME                          ZPARXX
     ICLEFICF1
     I              F1                              WWW1
     I              F2                              WWW2
     I              F3                              WWW3
     I              X1                              WWW4
     I              X2                              WWW5
     I              Y1                              WWW6
     I              S2                              WWW7
     I              S3                              WWW8
     I              B2                              WWW9
     I              B3                              WWW10
     I              T2                              WWW11
     I              B4                              WWW17
     *
     IPREACFIF
     I              SECT                            SECTFT
     I              SSECT                           SSECFT
     I              CLINO                           CLICHX
     I              LAIZE                           LAIZEX
     *
     I/COPY QRPGSRC,XPTEDS
     I/COPY QRPGSRC,XTIMDS
    I*/COPY QRPGSRC,XPOODS
     IXPOOAR      DS
     I                                       01  01 XPOOA1                USINE
     I                                       02  02 XPOOA2                SECTIO
     I                                       03  03 XPOOA3                SOUS S
     I                                       04  05 XPOOA4                N° POO
     I                                        1  10 XPOOKE
     I                                        2   2 SECT
     I                                        3   3 SSECT
     I                                        4   5 NOMAC
     IXPOOS1      DS
     I                                       02  03 XPOO01                MAC 1
     I                                       05  06 XPOO02                MAC 2
     I                                       08  09 XPOO03                MAC 3
     I                                       11  12 XPOO04                MAC 4
     I                                       14  15 XPOO05                MAC 5
     I                                        1  65 XPOO00
     I            DS
     I                                        1   7 DEMAN
     I                                        1   6 RIREP
     I/SPACE 1
     * information pour les erreurs d'exceptions .
     I           SDS
     I                                       21  28 SGAP
     I                                      244 244 POSTE1
     I                                      249 249 POSTE2
     I                                      254 263 USRNAM
     I/SPACE 1
     I            DS
     I                                        1   60QTEM1
     I                                        3   60PROSOE
     I            DS
     I                                        1   60QTEM2
     I                                        3   60PROSOI
     I/SPACE 2
     IKDIFA       DS
     I                                        1   21KDIF1
     IKDIFB       DS
     I                                        1   21KDIF2
     IKDIFC       DS
     I                                        1   21KDIF3
     IKDIFD       DS
     I                                        1   21KDIF4
     IKDIFE       DS
     I                                        1   21KDIF5
     IKDIFF       DS
     I                                        1   21KDIF6
     IKDIFG       DS
     I                                        1   21KDIF7
     I/SPACE 2
     ILAIUTI      DS
     I                                        1   40LAICLI
     I                                        5   80LAIPRO
     I I            ' '                       9   9 INT
     I            DS
     I                                        1   30FAOND
     I                                        1   10USOND
     I                                        2   30AFOND
     I            DS
     I                                        1   30FACOL
     I                                        1   10USCOL
     I                                        2   30AFCOL
     I            DS
     I                                        1   30FADEC
     I                                        1   10USDEC
     I                                        2   30AFDEC
     I            DS
     I                                        1   30FAAUT
     I                                        1   10USAUT
     I                                        2   30AFAUT
     I            DS
     I                                        1   30FAFEN
     I                                        1   10USFEN
     I                                        2   30AFFEN
     I            DS
     I                                        1   30FAAS1
     I                                        1   10USAS1
     I                                        2   30AFAS1
     I            DS
     I                                        1   30FAAS2
     I                                        1   10USAS2
     I                                        2   30AFAS2
     I            DS
     I                                        1   3 FAIMES
     I                                        1   10USEXT
     I                                        2   30FAIMER
     I            DS
     I                                        1   3 FAIMIS
     I                                        1   10USINT
     I                                        2   30FAIMIR
     I            DS
     I                                        1   6 CLII1
     I                                        1   1 FIOND
     I                                        2   3 GFRA2
     I                                        4   5 TYPPCH
     I I            '0'                       6   6 NBPCHA
     I            DS
     I                                        1   10COUI1
     I                                        2   31ENCI1
     I                                        1   30PTNBR
     I            DS
     I                                        1   60DATAR
     I                                        1   30STNBR3
     I                                        4   60STNBR6
     I            DS
     I                                        1  40 B240B
     I                                        1  27 B227
     I                                       29  40 B212
     *
     INOMFA       DS
     I                                        1  35 NOMFA1
     I                                       36  40 NOMFA2
     IBLOC1       DS
     I                                        1  40 BLOC11
     IDSPARM      DS
     I                                        1   2 PARMGP
     I                                        3   3 PARM0
     I                                        4   40STENO
     I                                        5   80CLINO
     I                                        9  120PRONO
     I                                       13  20 MPASSS
     IDSPOP       DS
     I                                        1   1 OP0
     I                                        2   20STPOP
     I                                        3   60NOCPOP
     I                                        7  100NOPPOP
     I                                       11  18 MPASSE
     IDSQUA       DS
     I                                        1   10STQUA
     I                                        2   50NOCQUA
     I                                        6   90NOPQUA
     I/SPACE 2
     I            DS
     I                                        1   50NOF
     I                                        6  13 MPASS
     I                                       16  16 FVIR
     I                                        1  16 DSNOF
     I/SPACE 2
     I            DS
     I                                        1   5 ZB83
     I                                        1   1 ZB831
     I                                        2   2 ZB8322
     I            DS
     I I            0                         1   20COUL1B
     I                                        1   10COULD1
     I                                        2   20COUL1
     I            DS
     I                                        1   20COUL2B
     I                                        1   10COULD2
     I                                        2   20COUL2
     I            DS
     I                                        1   20COUL3B
     I                                        1   10COULD3
     I                                        2   20COUL3
     I            DS
     I                                        1   20COUL4B
     I                                        1   10COULD4
     I                                        2   20COUL4
     I            DS
     I                                        1   20COUL5B
     I                                        1   10COULD5
     I                                        2   20COUL5
     I            DS
     I                                        1   20COUL6B
     I                                        1   10COULD6
     I                                        2   20COUL6
     I            DS
     I I            0                         1   20COUL7B
     I                                        1   10COULD7
     I                                        2   20COUL7
     I            DS
     I                                        1   20COULSB
     I I            0                         1   10COULDS
     I                                        2   20COULS
     *
     I            DS
     I I            0                         1   10ONDUL
     I I            0                         2   20CCOL
     I I            '  '                      3   4 CNDD
     I                                        1   20CCOND
     I                                        1   4 SIDD
     I            DS
     I                                        1  16 QUAPP1
     I                                        1   3 PAFIL1
     I                                        4   60GRFIL1
     I                                        7  12 REFIL1
     I                                       13  150GFFIL1
     I                                       16  16 INVPP1
     I            DS
     I                                        1  16 QUAPP2
     I                                        1   3 PAFIL2
     I                                        4   60GRFIL2
     I                                        7  12 REFIL2
     I                                       13  150GFFIL2
     I                                       16  16 INVPP2
     I/SPACE 2
     ICDEC58      DS
     I                                        1   1 BID58
     I                                        2   20STE58
     I                                        3   60NOCL58
     I                                        7  100NOPR58
     I                                       11  140FORLST
     I                                       15  180FORHST
     I                                       19  19 ERRE58
     I                                       20  22 PAPI58
     I                                       23  250GRAM58
     I                                       26  31 REFO58
     I I            0                        32  340GRAR58
     I/SPACE 2
     ILAN017      DS
     I I            'N'                       1   1 LAN171
     I I            0                         2   20LAN172
     I                                        3   60STK171
     I                                        7  100STK172
     I/SPACE 2
     IEMB001      DS
     I                                        1   10USIE1
     I                                        2   20STEE1
     I                                        3   60NOCLE1
     I                                        7  100NOPRE1
     I/SPACE 2
     IEMB006      DS
     I                                        1   10STEE6
     I                                        2   50NOCLE6
     I                                        6  45 NOME6
     I                                       46  470ANNEE6
     I                                       48  510ETUDE6
     I                                       52  550SEQE6
     I                                       56  560USIE6
     I                                       57  57 ANNUE6
     I                                       58  58 MBR6
     I/SPACE 2
     IEMB010      DS
     I                                        1   10USINE
     I                                        2   20FABETS
     I                                        3   30STEE10
     I                                        4   70NOCE10
     I                                        8  110NOPE10
     I/SPACE 2
     IPROD70      DS
     I                                        1   10STE70
     I                                        2   50NOCL70
     I                                        6   90NOPR70
     I                                       10  29 INDPCL
     I/SPACE 2
     IPROD71      DS
     I                                        1   10STE71
     I                                        2   50NOCL71
     I                                        6   90NOPR71
     I                                       10  140NOFOR
     I/SPACE 2
     IPROD77      DS
     I                                        1   50NOFOR1
     I                                        6   6 ON
     I/SPACE 2
     IDEV059      DS
     I                                        1   40CL59
     I                                        5   80PR59
     I                                        9  32 BL59
     I/SPACE 2
     IDEV019      DS
     I                                        1   40CL19
     I                                        5   80PR19
     I                                        9  32 BL19
     *
     IDEV113      DS
     I                                        1   10STE113
     I                                        2   50CLI113
     I                                        6   90PRO113
     *  POUR APPEL TYPO01£
     IATYPP       DS
     I                                        1   1 PIP
     I                                        2   2 TYPPR
     *
     IPRODU6      DS
     I I            'M'                       1   1 MAJ
     I                                        2   20STE60
     I                                        3   60NOC60
     I                                        7  100NOP60
     I I            'O'                      11  11 NONINT
     *
     I            DS
     I                                        1 280 LSS
     I                                        1  20 LSS1
     I                                       21  40 LSS2
     I                                       41  60 LSS3
     I                                       61  80 LSS4
     I                                       81 100 LSS5
     I                                      101 120 LSS6
     I                                      121 140 LSS7
     I                                      141 160 LSS8
     I                                      161 180 LSS9
     I                                      181 200 LSS10
     I                                      201 220 LSS11
     I                                      221 240 LSS12
     I                                      241 260 LSS13
     I                                      261 280 LSS14
     *
     I            DS
     I                                        1   1 APLA7
     I                                        2   3 ORCU7
     I                                        4   4 RUV7
     I                                        5   5 UV7
     I                                        6  10 ZB87
     I                                        1  106SUVENT
     *
     I            DS
     I                                        1   52POSF1
     I                                        1   30POSF1A
     I                                        4   50POSF1B
     I            DS
     I                                        1   52POSF2
     I                                        1   30POSF2A
     I                                        4   50POSF2B
     *
     I            DS
     I                                        1   6 REFOUR
     I                                        4   6 CXH
     IINTCXH      DS
     I                                        1   1 PARMCX
     I                                        2   4 PAPCX
     I                                        5   70GRACX
     I                                        8  13 ADPCX
     I                                       14  160ADGCX
     IDSPAR2      DS
     I                                        1   4 TBLNO2
     I                                        5  12 TBVAR
     I                                       13  52 LIBEL
     I                                       53  53 RET2
     *
     I            DS
     I                                        1  10 DTDEST
     I I            0                         1   20JDESTF
     I I            '/'                       3   3 BARRE1
     I I            0                         4   50MDESTF
     I I            '/'                       6   6 BARRE2
     I I            0                         7   80ADESTF
     *
     I            DS
     I                                        1   5 TU
     I                                        1   1 UST1
     I                                        2   2 UST2
     I                                        3   3 UST3
     I                                        4   4 UST4
     I                                        5   5 UST5
     I            DS
     I                                        1  81 DSPMMM
     I                                        1   8 TBLNOM
     I                                        9  18 TBVVR
     I                                       19  200LG
     I                                       21  30 CODE
     I                                       31  80 LIBELM
     I                                       81  81 FICH
     I            DS
     I                                        1  20 DSINDP
     I                                        1   3 SPAPI
     I                                        5   70SGRAMM
     I                                        9  14 SREFOU
     I                                       16  180SGRARE
     I                                       20  20 SFOUB
     I            DS
     I                                        1   60DTTIR
     I                                        1   20JJTIR
     I                                        3   40MMTIR
     I                                        5   60AATIR
     *  APPEL AFFICHE
     *
     I            DS
     I                                        1   1 NATMAI
     I                                        1   1 AFFI
     *
     I            DS
     I                                        1  100NOETU
     I                                        2   20STEZZ
     I                                        3   60NOCLZZ
     I                                        7  100NOPRZZ
     *
     I            DS
     I                                        1   6 CLIE1
     I                                        1   3 TMINAZ
     I                                        4   6 TMAXAZ
     *
     IDEV013      DS
     I I            'PM'                      1   2 DMX
     I                                        3  120SVNOEX
     I                                       13  13 PELLIX
     I                                       14  14 AFFIX
     I                                       15  15 AFFICX
     I                                       16  16 AUTCO
     I                                       17  24 PAS013
     I I            0                        25  250TCOEP
     I I            0                        26  260USIEO
     I I            '  '                     27  28 MACEP
     I                                        1  12 DEV035
     IDEV026      DS                             35
     I I            'P'                       1   1 ODP
     I I            'I'                       2   2 IM
     I                                        3  120SVNOEZ
     I                                       13  14 PELAFF
     I                                       15  15 AFFIC
     I I            0                        16  190LA1
     I I            0                        20  230HA1
     I I            0                        24  270LA2
     I I            0                        28  310HA2
     I I            0                        32  320WIA1
     I I            0                        33  330WIAR1
     I I            0                        34  340WIA2
     I I            0                        35  350WIAR2
     *  AFFIC: 1 = EXT , 2 = INT, 3 = EXT + INT, 4 = INT + EXT
     * DS Pour récupération des infos écran
     IàINFDS      DS
     I                                    B 370 3710£CURSO
    **
     IDSREF       DS
     I                                        1   6 REFE
     I                                        7  12 REFI
     I                                       13  13 OK
     *
     ITYPPOI      DS
     I                                        1   1 TYPPO1
     I                                        2   2 TYPPO2
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     * - Paramètres pour appel ACC002£ ==> Affichage des critères Pose
     * Accessoire
     IACC002      DS
     I                                        1   3 TYPAFF
     I                                        4  41 ACCNEW
     I I                                      4  13 WCOD01
     I I                                     14  14 WMOD01
     I I            0                        15  160WNB01
     I I                                     17  26 WCOD02
     I I            0                        27  280WNB02
     I I                                     29  38 WCOD03
     I I                                     39  39 WMOD03
     I I            0                        40  410WNB03
     I                                       42  43 WCDRET
     * - Paramètres pour appel MANX300£ ==> Génération nomenclature
     * Produit / Matières Annexes
     IMAN300      DS
     I                                        1   10STE3
     I                                        2   50NOCLI3
     I                                        6   90NOPRO3
     * -
     I            DS
     I                                        1   1 WPOSE
     I I            'N'                       2   2 WANNUL
     * - DS de sauvegarde état avant modification pour les accessoires
     IACCOLD      DS
     I I                                      1  10 SCOD01
     I I                                     11  11 SMOD01
     I I            0                        12  130SNB01
     I I                                     14  23 SCOD02
     I I            0                        24  250SNB02
     I I                                     26  35 SCOD03
     I I                                     36  36 SMOD03
     I I            0                        37  380SNB03
     * - DS
     IDSPRD6      DS
     I I                                      1  10 EYECOD
     I I                                     11  11 EYEMOD
     I I            0                        12  130EYENB
     I I                                     14  23 CORCOD
     I I            0                        24  250CORDNB
     I I                                     26  35 BTPCOD
     I I                                     36  36 BTPMOD
     I I            0                        37  380BTPNB
     *
     *  MATERM USINE OFFSET EXT + INT + NB COULEUR EXT REPIQUAGE
     I            DS
     I I            00000                     1   50MATERM
     I I            0                         1   10USIMAC
     I I            00                        2   30NOTUSE
     I I            00                        4   50ONBCER
     IDS120       DS
     I                                      001 025 LIBTRA
     I                                      026 035 LIBDEV
     I                                      036 065 NOMCLP
     I                                      066 0670ANDEV
     I                                      068 0710ETUDE
     I                                      072 0750SEQDE
     I                                      076 115 BLOC1P
     I                                      116 116 MAJVIS
    I*****************  EXTPRI
     I                                      117 1170UOEXT
     I                                      118 120 PAPI3
     I                                      121 1230GRAM3
     I                                      124 129 ADPAP3
     I                                      130 1320ADGRA3
     I                                      133 1340COUL3P
     I                                      135 136 OCOMEI
     I                                      137 1370OTCO3P
     I                                      138 139 OMAC35
     I                                      140 1410OGE3P1
     I                                      142 1430OGE3P2
     I                                      144 1450OGE3P3
     I                                      146 146 OTE13P
     I                                      147 147 ONE13P
     I                                      148 1491OPE13P
     I                                      150 150 OTE23P
     I                                      151 151 ONE23P
     I                                      152 1531OPE23P
     I                                      154 155 OTOA3P
     I                                      156 1571OPOA3P
     I                                      158 158 OTEF3P
     I                                      159 1601OPEF3P
     I                                      161 1621OMES3P
     I                                      163 163 OTEM3P
     I                                      164 1651OPEM3P
     I                                      166 1660ODP3P
     I                                      167 168 ODF13P
     I                                      169 170 ODF23P
     I                                      171 172 ODF33P
     I                                      173 1770ODS13P
     I                                      178 1820ODS23P
     I                                      183 1870ODS33P
     I                                      188 188 OTV13P
     I                                      189 1901OPV13P
     I                                      191 1921OMV13P
     I                                      193 193 OV13P1
     I                                      194 194 OV13P2
     I                                      195 195 OV13P3
     I                                      196 196 OTV23P
     I                                      197 1981OPV23P
     I                                      199 2001OMV23P
     I                                      201 201 OV23P1
     I                                      202 202 OV23P2
     I                                      203 203 OV23P3
     I                                      204 204 OTV33P
     I                                      205 2061OPV33P
     I                                      207 2081OMV33P
     I                                      209 209 OV33P1
     I                                      210 210 OV33P2
     I                                      211 211 OV33P3
     I                                      212 212 ODPR3P
     I                                      213 213 OTG3P
     I                                      214 214 OGG3P
     I                                      215 215 ODD3P
     I                                      216 216 ODA3P
     I                                      217 217 OTSS3P
     I                                      218 218 OTM3P
    I*****************  EXTREP
     I                                      219 2200OGE3R1
     I                                      221 2220OGE3R2
     I                                      223 2240OGE3R3
     I                                      225 225 OTE13R
     I                                      226 226 ONE13R
     I                                      227 2281OPE13R
     I                                      229 229 OTE23R
     I                                      230 230 ONE23R
     I                                      231 2321OPE23R
     I                                      233 234 OTOA3R
     I                                      235 2361OPOA3R
     I                                      237 237 OTEF3R
     I                                      238 2391OPEF3R
     I                                      240 2411OMES3R
     I                                      242 242 OTEM3R
     I                                      243 2441OPEM3R
     I                                      245 2450ODP3R
     I                                      246 247 ODF13R
     I                                      248 249 ODF23R
     I                                      250 251 ODF33R
     I                                      252 2560ODS13R
     I                                      257 2610ODS23R
     I                                      262 2660ODS33R
     I                                      267 267 OTV13R
     I                                      268 2691OPV13R
     I                                      270 2711OMV13R
     I                                      272 272 OV13R1
     I                                      273 273 OV13R2
     I                                      274 274 OV13R3
     I                                      275 275 OTV23R
     I                                      276 2771OPV23R
     I                                      278 2791OMV23R
     I                                      280 280 OV23R1
     I                                      281 281 OV23R2
     I                                      282 282 OV23R3
     I                                      283 283 OTV33R
     I                                      284 2851OPV33R
     I                                      286 2871OMV33R
     I                                      288 288 OV33R1
     I                                      289 289 OV33R2
     I                                      290 290 OV33R3
     I                                      291 291 ODPR3R
     I                                      292 292 OTG3R
     I                                      293 293 OGG3R
     I                                      294 294 ODD3R
     I                                      295 295 ODA3R
     I                                      296 296 OTSS3R
     I                                      297 297 OTM3R
    I*****************  INTPRI
     I                                      298 2980UOINT
     I                                      299 301 PAPI5
     I                                      302 3040GRAM5
     I                                      305 310 ADPAP5
     I                                      311 3130ADGRA5
     I                                      314 3150COUL5P
     I                                      316 3170OGE5P1
     I                                      318 3190OGE5P2
     I                                      320 3210OGE5P3
     I                                      322 322 OTE15P
     I                                      323 323 ONE15P
     I                                      324 3251OPE15P
     I                                      326 326 OTE25P
     I                                      327 327 ONE25P
     I                                      328 3291OPE25P
     I                                      330 331 OTOA5P
     I                                      332 3331OPOA5P
     I                                      334 334 OTEF5P
     I                                      335 3361OPEF5P
     I                                      337 3381OMES5P
     I                                      339 339 OTEM5P
     I                                      340 3411OPEM5P
     I                                      342 3420ODP5P
     I                                      343 344 ODF15P
     I                                      345 346 ODF25P
     I                                      347 348 ODF35P
     I                                      349 3530ODS15P
     I                                      354 3580ODS25P
     I                                      359 3630ODS35P
     I                                      364 364 OTV15P
     I                                      365 3661OPV15P
     I                                      367 3681OMV15P
     I                                      369 369 OV15P1
     I                                      370 370 OV15P2
     I                                      371 371 OV15P3
     I                                      372 372 OTV25P
     I                                      373 3741OPV25P
     I                                      375 3761OMV25P
     I                                      377 377 OV25P1
     I                                      378 378 OV25P2
     I                                      379 379 OV25P3
     I                                      380 380 OTV35P
     I                                      381 3821OPV35P
     I                                      383 3841OMV35P
     I                                      385 385 OV35P1
     I                                      386 386 OV35P2
     I                                      387 387 OV35P3
     I                                      388 388 OTG5P
     I                                      389 389 OGG5P
     I                                      390 390 ODD5P
     I                                      391 391 ODA5P
     I                                      392 392 OTSS5P
     I                                      393 393 OTM5P
    I*****************  INTREP
     I                                      394 3950OGE5R1
     I                                      396 396 OTE15R
     I                                      397 397 ONE15R
     I                                      398 3991OPE15R
     I                                      400 4011OMES5R
     I                                      402 402 OTV15R
     I                                      403 4041OPV15R
     I                                      405 4061OMV15R
    I*****************  DIVERS
     I                                      407 4100FORL
     I                                      411 4140FORH
     I                                      415 4150TIMP3
     I                                      416 4160TIMP5
     I                                      417 4170ZNBCER
     I                                      418 418 CODDOR
     I                                      419 420 CODRET
     I                                      421 421 DEAFPR
     I                                      422 4220OUSI35
     I                                      423 423 UV1
    I*****************  DORURE A FROID PRODUITS
     I                                      424 427 ODT13P
     I                                      428 4300ODL13P
     I                                      431 434 ODT23P
     I                                      435 4370ODL23P
     I                                      438 441 ODT33P
     I                                      442 4440ODL33P
     I                                      445 448 ODT15P
     I                                      449 4510ODL15P
     I                                      452 455 ODT25P
     I                                      456 4580ODL25P
     I                                      459 462 ODT35P
     I                                      463 4650ODL35P
     I                                      466 469 ODT13R
     I                                      470 4720ODL13R
     I                                      473 476 ODT23R
     I                                      477 4790ODL23R
     I                                      480 483 ODT33R
     I                                      484 4860ODL33R
     *
     I              'MAJ PRODUITS'        C         LIB120
     *
     I            DS
     I                                        1   3 OUMEP
     I                                        1   10OUCOEP
     I                                        2   3 OMACEP
     * FILST2
     * POSITION 1: SAUVEGARDE DU TYPE DE CONFIG INITIAL
     I            DS
     I                                        1  40 FILST2
     I                                        1   1 STCO35
     I                                        2   2 SUSI35
     I                                        3   4 SMAC35
     *
     IFTOPRM      DS
     I                                        1   5 FTOND1
     I                                        6   90FTONDC
     I                                       10  130FTONDP
     I                                       14  14 FTOND2
     *--- Fin   --- Philippe ---  7/11/2015 --- Projet "Pose Accessoires "---*
     *
     I              'EN ATTENTE DE NUMERO-C         CSTOB1
     I              ' DE SPECIFICATION'
     I              'PAS DE SPECIFICATION'C         CSTOB2
     C/EJECT
     C           *ENTRY    PLIST
     C                     PARM           DSPARM
    C*
     C           CLEMAC    KLIST
     C                     KFLD           USZ     10
     C                     KFLD           SECT
     C                     KFLD           SSECT
     C                     KFLD           NOMAC
     *
     C           CLELIE    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     *
     C           CLEAPP    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOAPP
     *
     C           CLECLI    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     *
     C           CLEOBS    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           DEST
     C           CLEOB1    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           DEST
     C                     KFLD           EMET
     *
     C           CLEGR2    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           SVPRO2
     *
     C           CLECDE    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NCONF
     *
     C           CLEAE     KLIST
     C                     KFLD           ANDEV
     C                     KFLD           ETUDE
    C*
     C           CLECLE    KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
    C*
     C           STOSTO    KLIST
     C                     KFLD           FORLL
     C                     KFLD           FORHH
    C*
     C           STOC      KLIST
     C                     KFLD           ETUDE
     C                     KFLD           SEQDE
    C*
     C           QUALIL    KLIST
     C                     KFLD           PAPI
     C                     KFLD           GRAM
     C                     KFLD           ADPAP
     C                     KFLD           ADGRA
    C*
     C           NOSTOC    KLIST
     C                     KFLD           FORL
     C                     KFLD           FORH
    C*
     C           NOSTO1    KLIST
     C                     KFLD           Z4
     C                     KFLD           ZO4
    C*
     C           CLEPAR    KLIST
     C                     KFLD           PXARGU
     C                     KFLD           PXVALE
    C*
     C           CLE4B     KLIST
     C                     KFLD           QUACXH
     C                     KFLD           GRACXH
     C                     KFLD           ADPCXH
     C                     KFLD           ADGCXH
     *  CLE D'ACCES FICHIER XTBASE01
     C           KTBA01    KLIST
     C                     KFLD           TBLNOM
     C                     KFLD           TBVARG
     C                     KFLD           TBNSEG
     * CLES D'ACCES FICHIER TTREXP
     C           CLETTR    KLIST
     C                     KFLD           CPAYFO
     C                     KFLD           RPAYS
     *  CLE PRODUITS SOFHUNIC
     C           CLESOF    KLIST
     C                     KFLD           DSINDP
     C                     KFLD           NOFOR
     *
     C           CLECAL    KLIST
     C                     KFLD           JJTIR
     C                     KFLD           MMTIR
     C                     KFLD           AATIR
     *
     C           CLEAUT    KLIST
     C                     KFLD           USRNAM
     C                     KFLD           NOMENU
     C                     KFLD           NOPTIO
     *  CLE D'ACCES FICHIER MATPRE
     C           CLE4      KLIST
     C                     KFLD           PAPI    3
     C                     KFLD           GRAM    30
     C                     KFLD           REFOUR  6
     C                     KFLD           GRAREL  30
     *  CLE D'ACCES PRODST5
     C           KPST5     KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           PAPCX
     C                     KFLD           GRACX
     C                     KFLD           ADPCX
     C                     KFLD           ADGCX
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires" ---*
     * - Clé d'accès à PRODST6
     C           KPST6     KLIST
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     *--- Fin   --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires" ---*
     * - Clé d'accès à PREACFI
     C           KPREAC    KLIST
     C                     KFLD           STE
     C                     KFLD           NOCLI
     C                     KFLD           NOPRO
     C                     KFLD           SECTFT
     C                     KFLD           SSECFT
     *
     C                     CALL 'DEV113LC'
    C*
     C                     Z-ADD*ZEROS    STE
     C                     Z-ADD*ZEROS    COULSB
     C                     Z-ADD*ZEROS    NOCLI
     C                     Z-ADD*ZEROS    ANDEV
     C                     Z-ADD*ZEROS    ETUDE
     C                     Z-ADD*ZEROS    SEQDE
     C                     Z-ADD*ZEROS    NOPRO
     C                     MOVELPOSTE1    POSTE3  2
     C                     MOVE POSTE2    POSTE3
     * TMAGPI - SD 1462390
     *  CLE D'ACCES FICHIER FTYPOP
     C           CLEFTY    KLIST
     C                     KFLD           NATMAD
     * ------------------------------------------------------------- *
     C                     CLEARDS120
     * ------------------------------------------------------------- *
     C/SPACE 1
     C           USRNAM    CHAINMNUUTIL1             99
    C           *IN99     CABEQ'1'       FINALA
     C                     MOVE *BLANKS   MPASSE
     C           USRNAM    CHAINCLEFIL1              99
     C  N99                MOVELCLEAC     MPASSE
     * SI APPEL DE LA DUPLICATION DE PRODUIT
     * -------------------------------------
D1  C           PARM0     IFNE 'O'
     * AUTORISATION
     C                     MOVE *BLANK    NOMPGM 10
     C                     MOVEL'DEV014£' NOMPGM
     C           NOMPGM    CHAINMNUOPTL2             99
D2  C           *IN99     DOWEQ'0'
    C           *IN85     ANDEQ'0'
     C           CLEAUT    SETLLMNUAUTL1                 85
     C           NOMPGM    READEMNUOPTL2                 99
F2  C                     END
    C           *IN85     CABEQ'0'       FINALA
F1  C                     END
    **
     * mise a jour d'un produit NY+RT
     C                     EXSR MPRODU
     * APPEL DU PROGRAMME DU SUIVI DES DEMANDES DE CREATION
D1  C           NOCLI     IFNE *ZEROS
    C           NOPRO     ANDNE*ZEROS
     C                     Z-ADDSTE       STE113
     C                     Z-ADDNOCLI     CLI113
     C                     Z-ADDNOPRO     PRO113
     C                     CALL 'DEV113L'
     C                     PARM           DEV113
F1  C                     END
     *
    C                     GOTO FINALA
     C/SPACE 1
     C           FINALA    TAG
     C                     SETON                     LR
     C/SPACE 5
     *********************
     ** M.A J. PRODUITS **********************************************
     *********************
    C           MPRODU    BEGSR
     * SI APPEL DE LA DUPLICATION DE PRODUIT
     * -------------------------------------
D1  C           PARM0     IFEQ 'O'
     C                     MOVE STENO     STE
     C                     MOVE CLINO     NOCLI
     C                     MOVE PRONO     NOPRO
    C                     GOTO AFPF01
F1  C                     END
     C/SPACE 2
    C                     GOTO BMP15
    C** AFFICHAGE ET, VALIDATION DU FORMAT 15 *********
    C**
     C           B9        TAG
     * APPEL DU PROGRAMME DU SUIVI DES DEMANDES DE CREATION
     C                     Z-ADDSTE       STE113
     C                     Z-ADDNOCLI     CLI113
     C                     Z-ADDNOPRO     PRO113
     C                     CALL 'DEV113L'
     C                     PARM           DEV113
     *
     C                     MOVE '0'       *IN
     C                     MOVE '0'       IN68    1
     *--- Début --- Philippe --- 07/12/2015 --- Projet "Pose Accessoires" ---*
     * - Restauration de l'état d'avant modification car on demande via F11
     * une sortie sans valorisation de la modification si les infos mémorisées
     * sont différentes de celles en cours
D1  C           WANNUL    IFEQ 'O'
D2  C           ACCOLD    IFNE ACCNEW
     C           KPST6     CHAINPRODST6              95
     * - Si Inexistence de critères avant intervention ==> on supprime
     *   l'enregistrement qui vient d'être crée
D3  C           SCOD01    IFEQ *BLANK
    C           SCOD02    ANDEQ*BLANK
    C           SCOD03    ANDEQ*BLANK
     C  N95                DELETPRODST6F
     C                     CLEARDSPRD6
X3  C                     ELSE
     * - Sur une existence, 2 cas sont possibles:
     *   Cas 1 : Existence de critères après intervention ==> on remet à
     *   jour avec les anciennes valeurs
     *   Cas 2 : Inexistence de critères après intervention ==> on écrit
     *   les anciennes valeurs
     C                     MOVELSCOD01    EYECOD
     C                     MOVELSMOD01    EYEMOD
     C                     MOVE SNB01     EYENB
     C                     MOVELSCOD02    CORCOD
     C                     MOVE SNB02     CORDNB
     C                     MOVELSCOD03    BTPCOD
     C                     MOVELSMOD03    BTPMOD
     C                     MOVE SNB03     BTPNB
     C  N95                UPDATPRODST6F
     C   95                WRITEPRODST6F
F3  C                     ENDIF
F2  C                     ENDIF
F1  C                     ENDIF
     *--- Fin   --- Philippe --- 07/12/2015 --- Projet "Pose Accessoires" ---*
     C                     EXSR ZERO
     C           BMP15     TAG
     C           *LOVAL    SETLLPRODUI2
     C           *LOVAL    SETLLPRODST2
     *
     C                     EXFMTPF15
     C   76                Z-ADD*ZEROS    NOCLI
     C   76                Z-ADD*ZEROS    NOPRO
    C   76                GOTO FINPRO
     C           AFPF01    TAG
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVE '0'       *IN
     C           CLECLE    CHAINPRODUI2              9080
D1  C           *IN80     IFEQ '1'
     C                     MOVE MESS,36   MSGMSG
     C                     SETON                     90
    C                     GOTO BMP15
F1  C                     END
     C  N90      GARNT     COMP 'PP'                     90
     C   90                MOVE MESS,17   MSGMSG
    C   90                GOTO BMP15
     *
     C                     MOVE NATMAI    SVNATM  1
    C*
     C                     MOVE REFEX     WEFEX   6
     C                     MOVE REFIN     WEFIN   6
     C           CLECLE    CHAINPRODST2              9080
D1  C           *IN80     IFEQ '1'
     C                     MOVE MESS,36   MSGMSG
     C                     SETON                     90
    C                     GOTO BMP15
F1  C                     END
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires" ---*
     * - Recherche & mémoristaiotn des critères de pose accessoires
     C                     MOVEL'N'       WPOSE
     C                     MOVEL*BLANK    EPOSAC
     C           KPST6     CHAINPRODST6              95
     * - Mémorisation de l'état avant modification
     C  N95                MOVELEYECOD    SCOD01
     C  N95                Z-ADDEYENB     SNB01
     C  N95                MOVELEYEMOD    SMOD01
     C  N95                MOVELCORCOD    SCOD02
     C  N95                Z-ADDCORDNB    SNB02
     C  N95                MOVELBTPCOD    SCOD03
     C  N95                MOVELBTPMOD    SMOD03
     C  N95                Z-ADDBTPNB     SNB03
     *
     C  N95                MOVEL'*'       EPOSAC
     C  N95                MOVEL'O'       WPOSE
     C   95                CLEARDSPRD6
     *--- Fin   --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires" ---*
    C*
     C                     Z-ADD*ZEROS    NOETU
     C                     Z-ADDSTE       STEZZ
     C                     Z-ADDNOCLI     NOCLZZ
     C                     Z-ADDNOPRO     NOPRZZ
    C*
     C                     MOVE CLIE3     AFFL1
     C                     MOVE CLII3     AFFD1
     C                     MOVE CLIE2     AFFL2
     C                     MOVE CLII2     AFFD2
D1  C           CVEI3     IFNE *ZEROS
     C                     MOVE CVEI3     CNDD
X1  C                     ELSE
     C                     MOVE *BLANKS   CNDD
F1  C                     END
     C           NOFOR     CHAINFORDECL1             90
     C                     MOVE *BLANKS   LBFORM
D1  C           *IN90     IFEQ '0'
     * FORME EN SUSPENS ALERTE SUR FORMAT 8
     * ZONE 29 = INDICATEUR 29
     * ------------------------------------
     C                     MOVE ' '       ZON29
D2  C           MODIFO    IFNE ' '
     C                     MOVE '1'       ZON29   1
     C                     MOVELMESS,50   LBFORM
F2  C                     END
D2  C           ACCORD    IFNE ' '
     C                     MOVELMESS,51   LBFORM
F2  C                     END
D2  C           JDESTF    IFNE *ZEROS
     C                     MOVELMESS,52   LBFORM
     C                     MOVE DTDEST    LBFORM
F2  C                     END
     *
D2  C           TDECBI    IFEQ *BLANK
     C                     MOVE FZB15     ZB15
     C                     MOVE FTDEC     TDECO
     C                     MOVE FPOSF     POSFO
     C                     MOVE FKDEC     KDEC
F2  C                     END
D2  C           USDEC     IFEQ 2
     C                     MOVE PRES1R    MADEC1
     C                     MOVE PRES2R    MADEC2
     C                     MOVE PRES3R    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 3
     C                     MOVE PRES1T    MADEC1
     C                     MOVE PRES2T    MADEC2
     C                     MOVE PRES3T    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 4
     C                     MOVE PRES1N    MADEC1
     C                     MOVE PRES2N    MADEC2
     C                     MOVE PRES3N    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 5
     C                     MOVE PRES1C    MADEC1
     C                     MOVE PRES2C    MADEC2
     C                     MOVE PRES3C    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 7
     C                     MOVE PRES1F    MADEC1
     C                     MOVE PRES2F    MADEC2
     C                     MOVE PRES3F    MADEC3
F2  C                     END
D2  C           MADEC1    IFEQ '00'
     C                     MOVE '  '      MADEC1
F2  C                     END
D2  C           MADEC2    IFEQ '00'
     C                     MOVE '  '      MADEC2
F2  C                     END
D2  C           MADEC3    IFEQ '00'
     C                     MOVE '  '      MADEC3
F2  C                     END
F1  C                     END
     * UNITE DE VENTE
     C                     MOVE *BLANK    LIBUV
     C                     MOVE *BLANK    LIBUNI
     C                     MOVE *BLANK    PXARGU
     C                     MOVE *BLANK    PXVALE
     C                     MOVE 'UVEN'    PXARGU
     C                     MOVE UVENT     PXVALE
     C           CLEPAR    CHAINPARAME               99
D1  C           *IN99     IFEQ '0'
     C                     MOVELPXABRG    LIBUV
     C                     MOVELPXLIBE    LIBUNI
F1  C                     END
     *
     C                     MOVE ANNUL     ANNULS  1
     C           CLECLI    CHAINCLIENTS1             0505
     C                     MOVE *BLANKS   NOMFA2
     C                     MOVELNOMCLI    NOMFA
    C**
    C** AFFICHAGE ET, VALIDATION DU FORMAT 16 *********
    C**
     C                     MOVE '0'       *IN
     C                     MOVE FACON     FACFAC  10
     C                     WRITEPF16
     * RECHERCHE DES OBSPRO DEST=MODIF
     * -------------------------------
     C                     MOVE 'MODIF '  DEST
     C                     MOVE *BLANKS   OBSP1
     C                     MOVE *BLANKS   OBSP2
     C           CLEOBS    CHAINOBSPROL1             07
D1  C           *IN07     IFEQ '0'
     C                     MOVE OBSLIB    OBSP1
F1  C                     END
     C           CLEOBS    READEOBSPROL1                 07
D1  C           *IN07     IFEQ '0'
     C                     MOVE OBSLIB    OBSP2
F1  C                     END
     C           *LOVAL    SETLLOBSPROL1                   POUR LIBERER
     * RECHERCHE STOCK ET COMMANDE
     * -------------------------------
     C                     EXSR SPSTK
     *
     C           BMP16     TAG
     C                     EXFMTPF16B
    C   76                GOTO FINPRO
    C   22                GOTO B9
    C   05                GOTO BMP16
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVE '0'       *IN
     *
D1  C           STCTDF    IFEQ 'S'
     C                     EXSR SPSTIN
     C           *LOVAL    SETLLPRODUI2                    POUR LIBERER
     C                     Z-ADDUSINE     USIE1
     C                     Z-ADDSTE       STEE1
     C                     Z-ADDNOCLI     NOCLE1
     C                     Z-ADDNOPRO     NOPRE1
     C                     CALL 'EMB001£'
     C                     PARM           EMB001
    C           PARM0     CABEQ'O'       FINPRO
    C                     GOTO B9
F1  C                     END
    C*
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
    C**
    C* AFFICHAGE ET, VALIDATION DU FORMAT 01 **************
    C**
     C           B1        TAG
     C                     MOVE '0'       *IN
     C                     MOVE INDPCL    SINDPC 20
     C           ANNULS    COMP *BLANKS              2121
     C                     MOVE USINE     FABETS  10
     C                     MOVE *BLANKS   PROMO1
     C                     MOVE *BLANKS   ZERO1
    C           PROTO     CABEQ*BLANKS   BMP01A
     C                     MOVELPROTO     PROTO1  1
     C           PROTO1    COMP 'P'                      80
     C   80                MOVE 'X'       PROMO1
     C           PROTO1    COMP 'T'                      80
     C   80                MOVE 'X'       ZERO1
     C           BMP01A    TAG
     C           GARNT     COMP '  '                     80
     C                     MOVELGARNT     GARNT1  1
     C           GARNT1    COMP 'M'                      81
     C  N80N81             SETON                     99
     C                     MOVE 'N'       MAJFTI
     C                     MOVE 'N'       MAJQU
     C                     MOVE 'N'       MAJSCO
     *
     C           ICEI2     COMP '*'                  272726
     *
     C                     MOVELSTOCK6    Z9W     9
     C                     MOVEAZ9W       UST,1
     C                     Z-ADD0         Y       10
D1  C           1         DO   9         Z
D2  C           UST,Z     IFNE '0'
    C           UST,Z     ANDNE' '
     C                     ADD  1         Y
     C                     MOVELUST,Z     TU,Y
F2  C                     END
F1  C                     END
     *
     C                     MOVE 'N'       OP
D1  C           NOCLI     IFEQ 8928                       SOFHUNIC
D2  C           CCOL      IFEQ 4                          COMPLEXAGE
    C           CCOL      OREQ 7
     C                     SETON                         23
F2  C                     END
F1  C                     END
     * TMAGPI - SD 1462390
     C                     MOVE NATMAD    WNATMA  1
     *
     C           BMP01     TAG
     *
     * TMAGPI - SD 1462390
     C           CODUTI    LOKUPTNOM                     90
     C   90                SETOF                     10
     C  N90                SETON                     10
     *
     *
     C   27                MOVE BLOC2     B240
     C   26                MOVE BLOC2     B240B
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'INDP'    PXARGU
     C                     MOVE NOCLI     PXVALE
     C           CLEPAR    CHAINPARAME               33
     C                     EXFMTPF01
     *
    C           *IN04     CASEQ'1'       TRTAID         78
    C                     END
    C           *IN78     CABEQ'1'       BMP01
     C                     SETOF                     78
     *
     C   90 13             MOVE '0'       *IN,M
     C                     MOVE *BLANKS   MSGMSG
     C                     SETOF                     90
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
     *
     C                     EXSR VALF01
    C   90                GOTO BMP01
     C                     EXSR POST01
     C   27                MOVE B240      BLOC2
     C   26                MOVE B240B     BLOC2
D1  C           USINE     IFNE FABETS
     C                     EXSR ZEROZZ
X1  C                     ELSE
     C                     EXSR ECRIT
F1  C                     END
     * TMAGPI - SD 1462390
    C* SI MODIF NATMAD MESSAGE GUY
D1  C           NATMAD    IFNE WNATMA
     C                     MOVE NOCLI     NOCSB6  4
     C                     MOVE NOPRO     NOPSB6  4
     C                     MOVE STE       STESB6  1
     C                     MOVEANOCSB6    SB6,71
     C                     MOVEANOPSB6    SB6,49
     C                     MOVEASTESB6    SB6,69
     C                     Z-ADD140       LONG
     C                     CALL 'QCAEXEC'
     C                     PARM           SB6
     C                     PARM           LONG
     C                     MOVE NATMAD    WNATMA
F1  C                     END
     *
     *
    C* APPEL PROD70£ POUR METTRE A JOUR INDPCL
D1  C           SINDPC    IFNE INDPCL
     C                     Z-ADDSTE       STE70
     C                     Z-ADDNOCLI     NOCL70
     C                     Z-ADDNOPRO     NOPR70
     C                     MOVEAPROD70    SB1,99
     C                     Z-ADD140       LONG   155
     C                     CALL 'QCAEXEC'
     C                     PARM           SB1
     C                     PARM           LONG
F1  C                     END
     *
D1  C           MAJFTI    IFEQ 'O'
     C                     MOVE 'O'       OP0
     C                     MOVE STE       STPOP
     C                     MOVE NOCLI     NOCPOP
     C                     MOVE NOPRO     NOPPOP
     C           *LOVAL    SETLLPRODST2
     C                     CALL 'LAN020£'
     C                     PARM           DSPOP
     C           CLECLE    CHAINPRODST2              80
    C                     GOTO B1
F1  C                     END
     *
D1  C           MAJQU     IFEQ 'O'
     C                     MOVE STE       STQUA
     C                     MOVE NOCLI     NOCQUA
     C                     MOVE NOPRO     NOPQUA
     C                     CALL 'MALF09'
     C                     PARM           DSQUA
    C                     GOTO B1
F1  C                     END
     *
D1  C           OP        IFEQ 'O'
     C           *LOVAL    SETLLPRODUI2                    POUR LIBERER
     C                     MOVE 'M'       OP0
     C                     MOVE STE       STPOP
     C                     MOVE NOCLI     NOCPOP
     C                     MOVE NOPRO     NOPPOP
     C                     CALL 'LAN015£'
     C                     PARM           DSPOP
     * On sauvegarde les données de l' écran car on doit faire un
     * CHAIN sur PRODUI2 pour voir si prod. annulé. (ag1)
     * ag1 début
     C                     MOVE *BLANKS   GARNTX  2
     C                     MOVE *BLANKS   INDPCX 40
     C                     MOVE *BLANKS   BLOC1X 40
     C                     MOVE *BLANKS   BLOC2X 40
     C                     MOVE *BLANKS   BLOC4X 40
     C                     MOVE *BLANKS   BLOC5X 40
     C                     MOVE *BLANKS   PROMOX  1
     C                     MOVE *BLANKS   ZERO1X  1
     C                     MOVE *BLANKS   OBSI1X 40
     C                     MOVE *BLANKS   OBSI2X 40
     C                     MOVE *BLANKS   OBSI3X 40
     C                     Z-ADDUSINE     USINX   10
     C                     Z-ADDMACLI     MACLIX  42
     C                     Z-ADDMICLI     MICLIX  42
     C                     MOVE GARNT     GARNTX
     C                     MOVE INDPCL    INDPCX
     C                     MOVE BLOC11    BLOC1X
     C                     MOVE BLOC2     BLOC2X
     C                     MOVE BLOC4     BLOC4X
     C                     MOVE BLOC5     BLOC5X
     C                     MOVE PROMO1    PROMOX
     C                     MOVE ZERO1     ZERO1X
     C                     MOVE OBSI1     OBSI1X
     C                     MOVE OBSI2     OBSI2X
     C                     MOVE OBSI3     OBSI3X
     C           CLECLE    CHAINPRODUI2              9080
     C                     MOVE ANNUL     ANNULS  1
     C                     Z-ADDUSINX     USINE
     C                     Z-ADDMACLIX    MACLI
     C                     Z-ADDMICLIX    MICLI
     C                     MOVE GARNTX    GARNT
     C                     MOVE INDPCX    INDPCL
     C                     MOVE BLOC1X    BLOC11
     C                     MOVE BLOC2X    BLOC2
     C                     MOVE BLOC4X    BLOC4
     C                     MOVE BLOC5X    BLOC5
     C                     MOVE PROMOX    PROMO1
     C                     MOVE ZERO1X    ZERO1
     C                     MOVE OBSI1X    OBSI1
     C                     MOVE OBSI2X    OBSI2
     C                     MOVE OBSI3X    OBSI3
     * ag1 fin
    C                     GOTO B1
F1  C                     END
     *
D1  C           MAJSCO    IFEQ 'O'
     C                     MOVE STE       STE60
     C                     MOVE NOCLI     NOC60
     C                     MOVE NOPRO     NOP60
     C                     CALL 'PRODU60£'
     C                     PARM           PRODU6
    C                     GOTO B1
F1  C                     END
    C*
    C           USINE     CABNEFABETS    B8
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C* AFFICHAGE ET, VALIDATION DU FORMAT 1BIS ***********
     C           B2        TAG
     C                     MOVE '0'       *IN
     C                     EXSR RAZ
     C                     EXSR B1BIS
     C                     MOVE *BLANKS   MSGMSG
    C* AFFICHAGE ET, VALIDATION DU FORMAT 2 *************
    C*
     C                     EXSR PREF02
    C*
     C           NOFOR     SETLLFORDECL6                 98
    C*
     C                     MOVE PASFST    ST1
     C                     Z-ADDFORLST    ST2
     C                     Z-ADDFORHST    ST3
     C                     MOVE REFO58    ST4     6
     C                     MOVE GRAR58    ST5     30
     C                     MOVE ZB84      FMASL
     C                     MOVE ZB85      FMASD
D1  C           *IN68     IFEQ '1'
     C                     Z-ADD1         INN68   10
X1  C                     ELSE
     C                     Z-ADD*ZERO     INN68
F1  C                     END
     C                     MOVELTDECO     TDECA   1
     C                     Z-ADD*ZERO     INN24   10
     C                     SETON                     24
     C                     Z-ADDFACON     SVFC    10
D1  C           FACON     IFEQ 7
    C           FACON     OREQ 8
     C                     SETOF                     24
     C                     Z-ADD1         INN24
F1  C                     END
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
     C                     SETON                     74
     C                     MOVELZB86      MANDLG
     C                     MOVE ZB86      MANDNB
F1  C                     END
D1  C           NOCLI     IFEQ 8928                       SOFHUNIC
D2  C           CCOL      IFEQ 4                          COMPLEXAGE
    C           CCOL      OREQ 7
     C                     SETON                         62
F2  C                     END
F1  C                     END
     C                     MOVE *BLANK    ERRE58
     *
     C           BMP02X    TAG
     C                     EXSR B1BISA
     C           BMP02A    TAG
     * GESTION DE LA CONFIG OFFSET 3B
D1  C           *IN03     IFEQ '1'
    C           PAPI3     ANDNE*BLANKS
    C           TIMP3     ANDEQ4
    C           *IN05     OREQ '1'
    C           PAPI5     ANDNE*BLANKS
    C           TIMP5     ANDEQ4
D2  C           ZTCO35    IFEQ *BLANK
     C                     MOVE OTCO35    ZTCO35
F2  C                     END
     C                     MOVEL'OFCO'    PXARGU
     C                     MOVE ZTCO35    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVELPXLIBE    OLCO35
     C                     MOVE '1'       *IN69
X1  C                     ELSE
     C                     MOVE *BLANK    ZTCO35
     C                     MOVE '0'       *IN69
F1  C                     END
     *
     C                     EXFMTPF02
     C         KW          MOVE '2'       IN22    1
     C        NKW          MOVE '1'       IN22
     C                     MOVE *BLANKS   MSGMSG
     * AFFICHAGE DE LA FT OND 14
D1  C           *IN07     IFEQ '1'
    C           FAOND     ANDEQ321
D2  C           MAOND1    IFEQ 14
    C           MAOND2    OREQ 14
     C                     MOVE '32114'   FTOND1
     C                     MOVE NOCLI     FTONDC
     C                     MOVE NOPRO     FTONDP
     C                     MOVE ' '       FTOND2
     C                     CALL 'FTOND01£'
     C                     PARM           FTOPRM
F2  C                     END
F1  C                     END
     * AIDE SUR CONFIG OFFSET
D1  C           *IN04     IFEQ '1'
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
    C           ZONZON    CASEQ'ZTCO35'  AID54
    C                     END
F1  C                     END
     *
D1  C           TIMP3     IFEQ 4
    C           TIMP5     OREQ 4
     * SI CONFIG OFFSET > 0, ELLE DOIT RESTER > 0
D2  C           OTCO35    IFNE 0
    C           ZTCO35    ANDEQ'0'
    C           OTCO35    OREQ 0
    C           ZTCO35    ANDNE'0'
     C                     MOVE OTCO35    ZTCO35
    C                     GOTO BMP02A
F2  C                     END
     * SI PAS D'AFFICHE, LA CONFIG OFFSET DOIT RESTER IDENTIQUE
D2  C           AFFI      IFEQ ' '
D3  C           OTCO35    IFEQ 1
    C           ZTCO35    ANDNE'1'
    C           OTCO35    OREQ 2
    C           ZTCO35    ANDNE'2'
    C           OTCO35    OREQ 3
    C           ZTCO35    ANDNE'3'
     C                     MOVE OTCO35    ZTCO35
    C                     GOTO BMP02A
F3  C                     END
F2  C                     END
     * SIL EXISTE UNE FICHE TECHNIQUE, LA CONFIG NE DOIT PAS CHANGER
D2  C           OTCO35    IFNE 0
     C                     MOVE '1'       SECTFT
     C                     MOVE '4'       SSECFT
     C           KPREAC    SETLLPREACFI2                 50
D3  C           *IN50     IFEQ '1'
D4  C           OTCO35    IFEQ 1
    C           ZTCO35    ANDNE'1'
    C           OTCO35    OREQ 2
    C           ZTCO35    ANDNE'2'
    C           OTCO35    OREQ 3
    C           ZTCO35    ANDNE'3'
     C                     MOVE OTCO35    ZTCO35
    C                     GOTO BMP02A
F4  C                     END
F3  C                     END
F2  C                     END
     * MESSAGE POUR MINI MAXI EN OFFSET STANDARD
D2  C           TIMP3     IFEQ 4
D3  C           FORH3     IFGE FORL3
    C           FORL3     ANDGE1020
    C           FORH3     ORGE FORL3
    C           FORH3     ANDGE1420
    C           FORL3     ORGE FORH3
    C           FORH3     ANDGE1020
    C           FORL3     ORGE FORH3
    C           FORL3     ANDGE1420
     C                     MOVE LIBMSG,1  WMSGOF
     C                     Z-ADDFORL3     EFORL
     C                     Z-ADDFORH3     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
D3  C           FORH3     IFGE FORL3
    C           FORL3     ANDLE600
    C           FORH3     ORGE FORL3
    C           FORH3     ANDLE800
    C           FORL3     ORGE FORH3
    C           FORH3     ANDLE600
    C           FORL3     ORGE FORH3
    C           FORL3     ANDLE800
     C                     MOVE LIBMSG,2  WMSGOF
     C                     Z-ADDFORL3     EFORL
     C                     Z-ADDFORH3     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
     * MESSAGE  OFFSET ET CONTRE COLLAGE
D3  C           CCOL      IFEQ 1
    C           FORH3     ANDGE1430
     C                     MOVE LIBMSG,4  WMSGOF
     C                     Z-ADDFORL3     EFORL
     C                     Z-ADDFORH3     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
D3  C           FORH3     IFLE 550
    C           ZTCO35    ANDEQ'2'
     C                     MOVE LIBMSG,5  WMSGOF
     C                     Z-ADDFORL3     EFORL
     C                     Z-ADDFORH3     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
F2  C                     END
D2  C           TIMP5     IFEQ 4
D3  C           FORH5     IFGE FORL5
    C           FORL5     ANDGE1020
    C           FORH5     ORGE FORL5
    C           FORH5     ANDGE1420
    C           FORL5     ORGE FORH5
    C           FORH5     ANDGE1020
    C           FORL5     ORGE FORH5
    C           FORL5     ANDGE1420
     C                     MOVE LIBMSG,1  WMSGOF
     C                     Z-ADDFORL5     EFORL
     C                     Z-ADDFORH5     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
D3  C           FORH3     IFGE FORL3
    C           FORL3     ANDLE600
    C           FORH3     ORGE FORL3
    C           FORH3     ANDLE800
    C           FORL3     ORGE FORH3
    C           FORH3     ANDLE600
    C           FORL3     ORGE FORH3
    C           FORL3     ANDLE800
     C                     MOVE LIBMSG,2  WMSGOF
     C                     Z-ADDFORL5     EFORL
     C                     Z-ADDFORH5     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
     * MESSAGE  OFFSET ET CONTRE COLLAGE
D3  C           CCOL      IFEQ 1
    C           FORH5     ANDGE1430
     C                     MOVE LIBMSG,4  WMSGOF
     C                     Z-ADDFORL5     EFORL
     C                     Z-ADDFORH5     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
D3  C           FORH5     IFLE 550
    C           ZTCO35    ANDEQ'2'
     C                     MOVE LIBMSG,5  WMSGOF
     C                     Z-ADDFORL5     EFORL
     C                     Z-ADDFORH5     EFORH
     C                     EXFMTDOFFSET
F3  C                     END
F2  C                     END
F1  C                     END
    C           *IN30     CABEQ'1'       BMP02X
D1  C           *IN08     IFEQ '1'
     C                     MOVE NOCLI     LAICLI
     C                     MOVE NOPRO     LAIPRO
     C                     CALL 'LAIUTI£'
     C                     PARM           LAIUTI
    C                     GOTO BMP02A
F1  C                     END
     C   80 90
     COR 81 90
     COR 82 90
     COR 83 90
     COR 85 90
     COR 86 90
    COR 67 90             GOTO S2A
     C      90             MOVE '0'       *IN,M
     C           S2A       TAG
     C                     EXSR RAZ
     C                     SETOF                     67
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
     C                     MOVEA*IN       ZZ99   99
     C                     EXSR VALF02
     C                     MOVE *IN90     IN1     1
     C                     EXSR RAZ
     C                     MOVE IN1       *IN90
     C   90      MSG       COMP 3                        80
    C   90 80             GOTO BMP02A
     C   90      MSG       COMP 4                        81
    C   90 81             GOTO BMP02A
     C   90      MSG       COMP 6                        82
    C   90 82             GOTO BMP02A
     C   90      MSG       COMP 7                        83
    C   90 83             GOTO BMP02A
     C   90      MSG       COMP 13                       85
    C   90 85             GOTO BMP02A
     C   90      MSG       COMP 5                        86
    C   90 86             GOTO BMP02A
     C   90      MSG       COMP 65                       67
    C   90 67             GOTO BMP02A
     C   90                EXSR MESSAG
    C   90                GOTO BMP02A
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
     C                     MOVELMANDLG    ZB86
     C                     MOVE MANDNB    ZB86
     C                     Z-ADDDECH      LONBOB
F1  C                     END
D1  C           CCOL      IFEQ 9
    C*          CCOL      OREQ 6
    C           CCOL      OREQ 8
    C           ONDUL     ANDEQ9
     C                     MOVELCNDD      CVEI3
F1  C                     END
    C* PEINTURE SUR TRANCHE
    C*-------------------------
D1  C           CODPT     IFEQ '*'
D2  C           FACON     IFLT 6
     C                     SETON                     90
     C                     MOVEAMESS,62   MSGMSG
    C                     GOTO BMP02X
F2  C                     END
F1  C                     END
    C* DORURE
    C*-------------------------
D1  C           CODDOR    IFEQ '*'
D2  C           FORL3     IFEQ *ZEROS
    C           FORL5     ANDEQ*ZEROS
     C                     SETON                     90
     C                     MOVEAMESS,64   MSGMSG
    C                     GOTO BMP02X
F2  C                     END
F1  C                     END
    C* PELLICULAGE
    C*-------------------------
D1  C           EDTFTI    IFEQ '*'
D2  C           FORL3     IFEQ *ZEROS
    C           FORL5     ANDEQ*ZEROS
     C                     SETON                     90
     C                     MOVEAMESS,65   MSGMSG
    C                     GOTO BMP02X
F2  C                     END
F1  C                     END
    C* VERIF LAIZE UTILISE ET DEV. IMPRESSION
D1  C           DEVIMP    IFGT *ZEROS
    C           DEVIMP    ANDGEONDH
     C                     SETON                     73
    C                     GOTO BMP02X
F1  C                     END
    C*
D1  C           LUTIL     IFGT *ZEROS
    C           LUTIL     ANDLTLMINI
     C                     SETON                     73
    C                     GOTO BMP02X
F1  C                     END
    C* RECHERCHE FORMAT STANDARD
D1  C           COUP3     IFEQ 'O'
    C           COUP5     OREQ 'O'
     C                     Z-ADD*ZEROS    XXPP
F1  C                     END
D1  C           FML       IFNE *ZEROS
     C                     Z-ADDFML       FMLZ4
     C                     Z-ADDFMH       FMHZ4
X1  C                     ELSE
     C                     Z-ADDONDL      FMLZ4   40       POUR OND. ACHET
     C                     Z-ADDONDH      FMHZ4   40
F1  C                     END
    C*          CCOL      IFEQ 6
    C*                    Z-ADDONDH      FMLZ4                        HET
    C*                    Z-ADDONDL      FMHZ4
    C*                    END
    C*
D1  C           XXPP      IFEQ 2
     C                     MOVE ADPAP2    ST4N    6
     C                     Z-ADDADGRA2    ST5N    30
F1  C                     END
D1  C           XXPP      IFEQ 3
     C                     MOVE ADPAP3    ST4N    6
     C                     Z-ADDADGRA3    ST5N    30
F1  C                     END
D1  C           XXPP      IFEQ 4
     C                     MOVE ADPAP4    ST4N    6
     C                     Z-ADDADGRA4    ST5N    30
F1  C                     END
D1  C           XXPP      IFEQ 5
     C                     MOVE ADPAP5    ST4N    6
     C                     Z-ADDADGRA5    ST5N    30
F1  C                     END
D1  C           TS3       IFEQ 'I'
    C           TS5       OREQ 'I'
    C           TS2       OREQ 'I'
     C                     Z-ADDFMHZ4     FZ4     40
     C                     Z-ADDFMLZ4     FMHZ4
     C                     Z-ADDFZ4       FMLZ4
F1  C                     END
     C                     MOVE FMHZ4     FMHZ1   10
D1  C           FMHZ1     IFEQ 1
    C           FMHZ1     OREQ 2
     C                     MOVE '0'       FMHZ4
F1  C                     END
D1  C           INN68     IFEQ 1
D2  C           PASFST    IFNE ST1
    C           FORLST    ORNE ST2
    C           FORHST    ORNE ST3
    C           ST4N      ORNE ST4
    C           ST5N      ORNE ST5
    C           FORLST    OREQ *ZEROS
    C           ERRE58    ANDNE'C'
    C           FORHST    OREQ *ZEROS
    C           ERRE58    ANDNE'C'
D3  C           PASFST    IFEQ '*'
    C           FORLST    ANDEQ*ZEROS
    C           PASFST    OREQ '*'
    C           FORHST    ANDEQ*ZEROS
    C           PASFST    OREQ '*'
    C           FORLST    ANDLTFMLZ4
    C           FORLST    ANDLTFMHZ4
    C           PASFST    OREQ '*'
    C           FORHST    ANDLTFMHZ4
    C           FORHST    ANDLTFMLZ4
     C                     SETON                     907068
     C                     Z-ADD70        M
    C                     GOTO BMP02A
F3  C                     END
D3  C           PASFST    IFEQ *BLANK
    C           ERRE58    ANDNE'C'
     C                     MOVE '*'       FST     1
     C                     EXSR ECRIT
     C                     MOVE *BLANKS   FST
     C                     MOVE ' '       BID58
     C                     Z-ADDSTE       STE58
     C                     Z-ADDNOCLI     NOCL58
     C                     Z-ADDNOPRO     NOPR58
     C                     Z-ADD*ZEROS    FORLST
     C                     Z-ADD*ZEROS    FORHST
     C                     MOVE *BLANK    ERRE58
     C                     Z-ADDSELECT    SVSELE  10
     C                     CALL 'CDEC58£'
     C                     PARM           CDEC58
     C           CLECLE    CHAINPRODUI2              80
     C           CLECLE    CHAINPRODST2              80
     C                     EXSR B1BISA
     C                     EXSR PREF02
     C                     SETOF                     80
D4  C           ERRE58    IFEQ '*'
     C                     SETON                     7090
     C                     Z-ADD70        M
     C                     MOVE *BLANKS   ST1
     C                     Z-ADD*ZEROS    ST2
     C                     Z-ADD*ZEROS    ST3
     C                     WRITEPF02
X4  C                     ELSE
     C                     MOVE PASFST    ST1     1
     C                     Z-ADDFORLST    ST2     40
     C                     Z-ADDFORHST    ST3     40
F4  C                     END
     C                     SETON                     68
     C                     Z-ADDSVSELE    SELECT
     C                     MOVEAZZ99      *IN
    C                     GOTO BMP02A
F3  C                     END
F2  C                     END
F1  C                     END
    C* FORMAT MASSICOTE
D1  C           FMASL     IFGT *ZEROS
    C           FMASD     ORGT *ZEROS
D2  C           FMASL     IFGT *ZEROS
    C           FMASD     ANDEQ*ZEROS
    C           FMASL     OREQ *ZEROS
    C           FMASD     ANDGT*ZEROS
    C           FMASL     OREQ FORLST
    C           FMASD     ANDEQFORHST
    C           FMASL     ORGT FORLST
    C           FMASD     ORGT FORHST
    C           FMASL     ORLT FMLZ4
    C           FMLZ4     ANDGT*ZEROS
    C           FMASD     ORLT FMHZ4
    C           FMHZ4     ANDGT*ZEROS
     C                     SETON                     7290
     C                     Z-ADD72        M
    C                     GOTO BMP02A
F2  C                     END
F1  C                     END
     C                     MOVE FMASL     ZB84
     C                     MOVE FMASD     ZB85
    C* BANDE ADHESIVE
D1  C           COSESA    IFEQ 'A'
    C           COSESA    OREQ 'B'
    C           COSESA    OREQ 'C'
    C           COSESA    OREQ 'D'
     C                     MOVE FSFAC     LGBA
     C           SWBA      TAG
     C                     EXFMTWBA
D2  C           LGBA      IFNE *ZEROS
D3  C           RETS7     IFNE 'N'
    C           RETS7     ANDNE'O'
    C                     GOTO SWBA
F3  C                     END
F2  C                     END
     C                     MOVE LGBA      FSFAC
F1  C                     END
    C* ENDUCTION - COMPLEXAGE
D1  C           CCOL      IFEQ 7
    C           CCOL      OREQ 4
     C           NOCLI     COMP 8928                     60
     C                     Z-ADDLMINI     LPEAP
     C           SWLP      TAG
     C                     EXFMTWLP
D2  C           *IN60     IFEQ '0'
D3  C           LPEAP     IFNE *ZEROS
    C           FLPEAP    ANDNE*ZEROS
     C                     SETON                     51
    C                     GOTO SWLP
F3  C                     END
D3  C           FLPEAP    IFNE *ZEROS
    C           FHPEAP    ANDEQ*ZEROS
    C           FLPEAP    OREQ *ZEROS
    C           FHPEAP    ANDNE*ZEROS
     C                     SETON                     52
    C                     GOTO SWLP
F3  C                     END
F2  C                     END
D2  C           IAEI2     IFEQ 'O'
    C           FLPEAP    ANDEQ*ZEROS
     C                     SETON                     53    MESSAGE 183
    C                     GOTO SWLP
F2  C                     END
D2  C           LPEAP     IFNE *ZEROS
D3  C           LZPEUT    IFNE *ZEROS
    C           LZPEAP    ORNE *ZEROS
     C                     SETON                     55
    C                     GOTO SWLP
F3  C                     END
     C                     Z-ADDLPEAP     LMINI
X2  C                     ELSE
D3  C           IAEI2     IFEQ ' '
     C           FLPEAP    DIV  10        FLPECM  41
    C           LZPEUT    CABGTLZPEAP    SWLP       54
X3  C                     ELSE
     C           FHPEAP    DIV  10        FLPECM  41
    C           LZPEUT    CABGTLZPEAP    SWLP       54
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C                     Z-ADD0         INN25
     C                     MOVELTDECO     TDEC    1
D1  C           TDECA     IFNE TDEC
D2  C           TDECA     IFEQ 'G'
    C           TDEC      OREQ 'G'
D3  C           TDEC      IFEQ 'G'
     C                     Z-ADD52        FADEC
X3  C                     ELSE
     C                     Z-ADD51        FADEC
F3  C                     END
     C                     MOVE *BLANKS   MADEC1
     C                     MOVE *BLANKS   MADEC2
     C                     MOVE *BLANKS   MADEC3
     C                     Z-ADD1         INN25   10
F2  C                     END
F1  C                     END
     C                     MOVE *BLANK    APPEX
     C                     MOVE *BLANK    APPIN
D1  C           COUP2     IFNE ' '
D2  C           COUP2     IFEQ 'F'
    C           COUP2     OREQ 'B'
    C           COUP2     OREQ 'O'
     C                     MOVE COUP2     APPEX
F2  C                     END
X1  C                     ELSE
D2  C           COUP3     IFNE ' '
D3  C           COUP3     IFEQ 'F'
    C           COUP3     OREQ 'B'
    C           COUP3     OREQ 'O'
     C                     MOVE COUP3     APPEX
     C                     MOVE COUP3     COUPEX
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           COUP6     IFNE ' '
D2  C           COUP6     IFEQ 'F'
    C           COUP6     OREQ 'B'
    C           COUP6     OREQ 'O'
     C                     MOVE COUP6     APPIN
F2  C                     END
X1  C                     ELSE
D2  C           COUP5     IFNE ' '
D3  C           COUP5     IFEQ 'F'
    C           COUP5     OREQ 'B'
    C           COUP5     OREQ 'O'
     C                     MOVE COUP5     APPIN
F3  C                     END
X2  C                     ELSE
D3  C           COUP4     IFNE ' '
D4  C           COUP4     IFEQ 'F'
    C           COUP4     OREQ 'B'
    C           COUP4     OREQ 'O'
     C                     MOVE COUP4     APPIN
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C                     MOVE '*'       CSV     1        CALCUL SURFACE
    C*
D1  C           GFRA2     IFEQ *BLANKS
     C                     Z-ADD*ZEROS    DECA1
     C                     Z-ADD*ZEROS    DECA2
F1  C                     END
    C*
     C                     EXSR ECRIT
    C*
     C                     Z-ADD*ZEROS    INN24
D1  C           FACON     IFNE SVFC
     C                     Z-ADD1         INN24
    C                     GOTO B4
F1  C                     END
    C* SI MODIF LAIZE UTILE MESSAGE GUY
D1  C           LUTIL     IFNE LUTILS
     C                     MOVE NOCLI     NOCSB4  4
     C                     MOVE NOPRO     NOPSB4  4
     C                     MOVEANOCSB4    SB4,68
     C                     MOVEANOPSB4    SB4,73
     C                     Z-ADD140       LONG
    C*                    CALL 'QCAEXEC'                   Tmagpi IC782217
    C*                    PARM           SB4
    C*                    PARM           LONG
     C                     Z-ADDLUTIL     LUTILS
F1  C                     END
     *
    C*          CCOL      IFEQ 6
    C*                    MOVE NOCLI     LAICLI
    C*                    MOVE NOPRO     LAIPRO
    C*                    CALL 'LAIUTI£'
    C*                    PARM           LAIUTI
    C*                    END
     C/SPACE 3
    C* SI PEINTURE SUR TRANCHE
    C*------------------------------
D1  C           CODPT     IFEQ '*'
     C                     MOVE *BLANKS   PTERR
     C           SWPT      TAG
     *          ---------------
     C                     EXFMTWPT
    C           *IN12     CABEQ'1'       B2
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       SWPT
     *
     C                     MOVE PTENC     XPTEA1
     C                     MOVELXPTEKE    TBVARG
     C                     MOVEL'XPTENCRE'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             50
D2  C           *IN50     IFEQ '1'
     C                     MOVELMESS,63   PTERR
    C                     GOTO SWPT
F2  C                     END
F1  C                     END
    C* SI PELLICULAGE
    C*------------------------------
D1  C           EDTFTI    IFEQ '*'
D2  C           PAFIL1    IFEQ *BLANKS
     C                     Z-ADD*ZEROS    GRFIL1
     C                     Z-ADD*ZEROS    GFFIL1
F2  C                     END
D2  C           PAFIL2    IFEQ *BLANKS
     C                     Z-ADD*ZEROS    GRFIL2
     C                     Z-ADD*ZEROS    GFFIL2
F2  C                     END
D2  C           CODPP1    IFEQ 'A'
     C                     MOVE 'PL'      COD2P1
F2  C                     END
D2  C           CODPP2    IFEQ 'A'
     C                     MOVE 'PL'      COD2P2
F2  C                     END
     C                     MOVE *BLANKS   ERRPEL
     C           SWPEL     TAG
     *          ---------------
     C                     EXFMTWPEL
    C           *IN12     CABEQ'1'       B2
     *
     C                     MOVELPAFIL1    PAPI
     C                     Z-ADDGRFIL1    GRAM
     C                     MOVELREFIL1    REFOUR
     C                     Z-ADDGFFIL1    GRAREL
     C           CLE4      CHAINMATPREL1             50
D2  C           *IN50     IFEQ '1'
     C                     MOVELDERR,9    ERRPEL
    C                     GOTO SWPEL
F2  C                     END
D2  C           PAFIL2    IFNE *BLANKS
     C                     MOVELPAFIL2    PAPI
     C                     Z-ADDGRFIL2    GRAM
     C                     MOVELREFIL2    REFOUR
     C                     Z-ADDGFFIL1    GRAREL
     C           CLE4      CHAINMATPREL1             50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,10   ERRPEL
    C                     GOTO SWPEL
F3  C                     END
D3  C           LZPUP2    IFEQ *ZEROS
    C           COD2P2    OREQ *BLANKS
    C           DECPP2    OREQ *ZEROS
     C                     MOVELDERR,11   ERRPEL
    C                     GOTO SWPEL
F3  C                     END
X2  C                     ELSE
D3  C           LZPUP2    IFNE *ZEROS
    C           COD2P2    ORNE *BLANKS
    C           DECPP2    ORNE *ZEROS
     C                     MOVELDERR,11   ERRPEL
    C                     GOTO SWPEL
F3  C                     END
F2  C                     END
     *
D2  C           COD2P1    IFEQ 'PL'
     C                     MOVE 'A'       CODPP1
F2  C                     END
D2  C           COD2P2    IFEQ 'PL'
     C                     MOVE 'A'       CODPP2
F2  C                     END
F1  C                     END
     *--- Début --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     * - Test sur l'existence d'une pose accessoire ou de sa suppression
D1  C           EPOSAC    IFEQ *BLANK
    C           WPOSE     ANDEQ'O'
    C           EPOSAC    OREQ '*'
     *
     * - Suppression physique de la pose accessoires
D2  C           EPOSAC    IFEQ *BLANK
    C           WPOSE     ANDEQ'O'
     C                     DELETPRODST6F
     C                     CLEARDSPRD6
F2  C                     ENDIF
     *
     * - Affichage des critères de pose accessoires définis pour ce produit
D2  C           EPOSAC    IFEQ '*'
     C                     CLEARACC002
     C                     MOVEL'MOD'     TYPAFF
     C                     MOVELEYECOD    WCOD01
     C                     MOVELEYEMOD    WMOD01
     C                     MOVE EYENB     WNB01
     C                     MOVELCORCOD    WCOD02
     C                     MOVE CORDNB    WNB02
     C                     MOVELBTPCOD    WCOD03
     C                     MOVELBTPMOD    WMOD03
     C                     MOVE BTPNB     WNB03
     C                     CALL 'ACC002£'
     C                     PARM           ACC002
     *
     * - Au retour de l'appel si un des critères a changé, mettre à jour
D3  C           WCOD01    IFNE EYECOD
    C           WMOD01    ORNE EYEMOD
    C           WNB01     ORNE EYENB
    C           WCOD02    ORNE CORCOD
    C           WNB02     ORNE CORDNB
    C           WCOD03    ORNE BTPCOD
    C           WMOD03    ORNE BTPMOD
    C           WNB03     ORNE BTPNB
     C           KPST6     CHAINPRODST6              95
     C                     MOVELWCOD01    EYECOD
     C                     MOVELWMOD01    EYEMOD
     C                     MOVE WNB01     EYENB
     C                     MOVELWCOD02    CORCOD
     C                     MOVE WNB02     CORDNB
     C                     MOVELWCOD03    BTPCOD
     C                     MOVELWMOD03    BTPMOD
     C                     MOVE WNB03     BTPNB
     C  N95                UPDATPRODST6F
     C   95                WRITEPRODST6F
F3  C                     ENDIF
F2  C                     ENDIF
     *
     * - Appel du programme de génération de la nomenclature pour mise
     * à jour de cette dernière avec les dernières infos connues
     C                     Z-ADDSTE       STE3
     C                     Z-ADDNOCLI     NOCLI3
     C                     Z-ADDNOPRO     NOPRO3
     C                     CALL 'MANX300£'
     C                     PARM           MAN300
F1  C                     ENDIF
     *--- Fin   --- Philippe --- 17/11/2015 --- Projet "Pose Accessoires "---*
     C/SPACE 3
    C* SI DORURE
    C*------------------------------
D1  C           CODDOR    IFEQ '*'
     C                     MOVE *BLANKS   DLIBP1
     C                     MOVE *BLANKS   DLIBP2
     C                     MOVE *BLANKS   DLIBP3
     C                     MOVE *BLANKS   DLIBP4
     C                     MOVE *BLANKS   LTFF1
     C                     MOVE *BLANKS   LTFF2
     C                     MOVE *BLANKS   LTFF3
     C                     MOVE *BLANKS   LTFF4
     C                     MOVE *BLANKS   LTFF5
     C                     MOVE *BLANKS   LTFF6
     C                     MOVE *BLANKS   LTFF7
     C                     MOVE *BLANKS   LTFF8
     C                     MOVE *BLANKS   LTFF9
     C                     MOVE *BLANKS   LTFFA
     C                     MOVE *BLANKS   LTFFB
     C                     MOVE *BLANKS   LTFFC
     C                     MOVE *BLANKS   LTYF1
     C                     MOVE *BLANKS   LTYF2
     C                     MOVE *BLANKS   LTYF3
     C                     MOVE *BLANKS   LTYF4
     C                     MOVE *BLANKS   LTYF5
     C                     MOVE *BLANKS   LTYF6
     C                     MOVE *BLANKS   LTYF7
     C                     MOVE *BLANKS   LTYF8
     C                     MOVE *BLANKS   LTYF9
     C                     MOVE *BLANKS   LTYFA
     C                     MOVE *BLANKS   LTYFB
     C                     MOVE *BLANKS   LTYFC
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP1
     C                     MOVE DNATP2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP2
     C                     MOVE DNATP3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP3
     C                     MOVE DNATP4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    DLIBP4
     *
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF1
     C                     MOVE DFPXF2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF2
     C                     MOVE DFPXF3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF3
     C                     MOVE DFPXF4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF4
     C                     MOVE DFPXF5    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF5
     C                     MOVE DFPXF6    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF6
     C                     MOVE DFPXF7    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF7
     C                     MOVE DFPXF8    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF8
     C                     MOVE DFPXF9    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFF9
     C                     MOVE DFPXFA    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFFA
     C                     MOVE DFPXFB    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFFB
     C                     MOVE DFPXFC    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTFFC
     *
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF1
     C                     MOVE DTYPF2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF2
     C                     MOVE DTYPF3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF3
     C                     MOVE DTYPF4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF4
     C                     MOVE DTYPF5    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF5
     C                     MOVE DTYPF6    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF6
     C                     MOVE DTYPF7    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF7
     C                     MOVE DTYPF8    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF8
     C                     MOVE DTYPF9    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYF9
     C                     MOVE DTYPFA    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYFA
     C                     MOVE DTYPFB    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYFB
     C                     MOVE DTYPFC    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVE PXABRG    LTYFC
     C                     Z-ADD2         DUSP1
    C*                    Z-ADD1         DMACP1
D2  C           DNATP2    IFNE *BLANKS
     C                     Z-ADD2         DUSP2
    C*                    Z-ADD1         DMACP2
F2  C                     END
D2  C           DNATP3    IFNE *BLANKS
     C                     Z-ADD2         DUSP3
    C*                    Z-ADD1         DMACP3
F2  C                     END
D2  C           DNATP4    IFNE *BLANKS
     C                     Z-ADD2         DUSP4
    C*                    Z-ADD1         DMACP4
F2  C                     END
     *
     C                     MOVE *BLANKS   ERRDOR
     C           SWDOR     TAG
     C                     EXFMTWDOR
    C           *IN12     CABEQ'1'       B2
    C           *IN04     CASEQ'1'       TRTAID         25
    C                     END
    C           *IN25     CABEQ'1'       SWDOR
     *
D2  C           DNATP1    IFNE *BLANKS
D3  C           DDIFP1    IFEQ *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,3    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP1
     C                     MOVE '1'       NPDOR   1
D3  C           DMACP1    IFEQ 0
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
     C                     MOVELDERR,1    ERRDOR
    C                     GOTO SWDOR
F2  C                     END
    C*
D2  C           DNATP2    IFNE *BLANKS
D3  C           DDIFP2    IFEQ *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,3    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP2
     C                     MOVE '2'       NPDOR
D3  C           DMACP2    IFEQ 0
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DDIFP2    IFNE *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   DLIBP2
     C                     Z-ADD0         DMACP2
F2  C                     END
     *
D2  C           DNATP3    IFNE *BLANKS
D3  C           DDIFP3    IFEQ *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,3    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP3
     C                     MOVE '3'       NPDOR
D3  C           DMACP3    IFEQ 0
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DDIFP3    IFNE *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   DLIBP3
     C                     Z-ADD0         DMACP3
F2  C                     END
    C*
D2  C           DNATP4    IFNE *BLANKS
D3  C           DDIFP4    IFEQ *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DONA'    PXARGU
     C                     MOVE DNATP4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,3    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    DLIBP4
     C                     MOVE '4'       NPDOR
D3  C           DMACP4    IFEQ 0
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DDIFP4    IFNE *BLANKS
     C                     MOVELDERR,2    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   DLIBP4
     C                     Z-ADD0         DMACP4
F2  C                     END
    C* TEST MACHINE A DORER
D2  C           DMACP1    IFNE 0
     C                     Z-ADD2         USZ
     C                     MOVE 2         XPOOA1
     C                     MOVEL'1'       SECT
     C                     MOVEL'6'       SSECT
     C                     MOVE DMACP1    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C   38                MOVEL'XPOOLMAC'TBLNOM
     C   38                Z-ADD1         TBNSEG
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
D3  C           *IN38     IFEQ '1'
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
F2  C                     END
D2  C           DMACP2    IFNE 0
     C                     Z-ADD2         USZ
     C                     MOVE 2         XPOOA1
     C                     MOVEL'1'       SECT
     C                     MOVEL'6'       SSECT
     C                     MOVE DMACP2    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C   38                MOVEL'XPOOLMAC'TBLNOM
     C   38                Z-ADD1         TBNSEG
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
D3  C           *IN38     IFEQ '1'
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
F2  C                     END
D2  C           DMACP3    IFNE 0
     C                     Z-ADD2         USZ
     C                     MOVE 2         XPOOA1
     C                     MOVEL'1'       SECT
     C                     MOVEL'6'       SSECT
     C                     MOVE DMACP3    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C   38                MOVEL'XPOOLMAC'TBLNOM
     C   38                Z-ADD1         TBNSEG
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
D3  C           *IN38     IFEQ '1'
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
F2  C                     END
D2  C           DMACP4    IFNE 0
     C                     Z-ADD2         USZ
     C                     MOVE 2         XPOOA1
     C                     MOVEL'1'       SECT
     C                     MOVEL'6'       SSECT
     C                     MOVE DMACP4    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C   38                MOVEL'XPOOLMAC'TBLNOM
     C   38                Z-ADD1         TBNSEG
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
D3  C           *IN38     IFEQ '1'
     C                     MOVELDERR,12   ERRDOR
    C                     GOTO SWDOR
F3  C                     END
F2  C                     END
     *
D2  C           DTYPF1    IFNE *BLANKS
D3  C           DSFF1     IFEQ *ZEROS
    C           DLZF1     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF1
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       DFPXF1
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF1    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF1
D3  C           DNPAF1    IFGT NPDOR
    C           DNPAF1    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
     C                     MOVELDERR,6    ERRDOR
    C                     GOTO SWDOR
F2  C                     END
    C*
D2  C           DTYPF2    IFNE *BLANKS
D3  C           DSFF2     IFEQ *ZEROS
    C           DLZF2     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF2
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF2
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF2    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF2
D3  C           DNPAF2    IFGT NPDOR
    C           DNPAF2    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF2     IFNE *ZEROS
    C           DNPAF2    ORNE *BLANK
    C           DTYPF2    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF2
     C                     MOVE *BLANKS   DFPXF2
F2  C                     END
    C*
D2  C           DTYPF3    IFNE *BLANKS
D3  C           DSFF3     IFEQ *ZEROS
    C           DLZF3     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF3
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF3
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF3    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF3
D3  C           DNPAF3    IFGT NPDOR
    C           DNPAF3    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF3     IFNE *ZEROS
    C           DNPAF3    ORNE *BLANK
    C           DTYPF3    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF3
     C                     MOVE *BLANKS   DFPXF3
F2  C                     END
    C*
D2  C           DTYPF4    IFNE *BLANKS
D3  C           DSFF4     IFEQ *ZEROS
    C           DLZF4     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF4
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF4
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF4    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF4
D3  C           DNPAF4    IFGT NPDOR
    C           DNPAF4    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF4     IFNE *ZEROS
    C           DNPAF4    ORNE *BLANK
    C           DTYPF4    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF4
     C                     MOVE *BLANKS   DFPXF4
F2  C                     END
    C*
D2  C           DTYPF5    IFNE *BLANKS
D3  C           DSFF5     IFEQ *ZEROS
    C           DLZF5     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF5    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF5
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF5
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF5    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF5
D3  C           DNPAF5    IFGT NPDOR
    C           DNPAF5    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF5     IFNE *ZEROS
    C           DNPAF5    ORNE *BLANK
    C           DTYPF5    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF5
     C                     MOVE *BLANKS   DFPXF5
F2  C                     END
    C*
D2  C           DTYPF6    IFNE *BLANKS
D3  C           DSFF6     IFEQ *ZEROS
    C           DLZF6     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF6    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF6
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF6
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF6    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF6
D3  C           DNPAF6    IFGT NPDOR
    C           DNPAF6    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF6     IFNE *ZEROS
    C           DNPAF6    ORNE *BLANK
    C           DTYPF6    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF6
     C                     MOVE *BLANKS   DFPXF6
F2  C                     END
    C*
D2  C           DTYPF7    IFNE *BLANKS
D3  C           DSFF7     IFEQ *ZEROS
    C           DLZF7     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF7    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF7
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF7
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF7    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF7
D3  C           DNPAF7    IFGT NPDOR
    C           DNPAF7    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF7     IFNE *ZEROS
    C           DNPAF7    ORNE *BLANK
    C           DTYPF7    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF7
     C                     MOVE *BLANKS   DFPXF7
F2  C                     END
    C*
D2  C           DTYPF8    IFNE *BLANKS
D3  C           DSFF8     IFEQ *ZEROS
    C           DLZF8     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF8    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF8
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF8
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF8    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF8
D3  C           DNPAF8    IFGT NPDOR
    C           DNPAF8    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF8     IFNE *ZEROS
    C           DNPAF8    ORNE *BLANK
    C           DTYPF8    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF8
     C                     MOVE *BLANKS   DFPXF8
F2  C                     END
    C*
D2  C           DTYPF9    IFNE *BLANKS
D3  C           DSFF9     IFEQ *ZEROS
    C           DLZF9     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPF9    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYF9
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXF9
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXF9    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFF9
D3  C           DNPAF9    IFGT NPDOR
    C           DNPAF9    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFF9     IFNE *ZEROS
    C           DNPAF9    ORNE *BLANK
    C           DTYPF9    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFF9
     C                     MOVE *BLANKS   DFPXF9
F2  C                     END
     *
D2  C           DTYPFA    IFNE *BLANKS
D3  C           DSFFA     IFEQ *ZEROS
    C           DLZFA     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFA    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYFA
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       DFPXFA
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFA    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFFA
D3  C           DNPAFA    IFGT NPDOR
    C           DNPAFA    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFFA     IFNE *ZEROS
    C           DNPAFA    ORNE *BLANK
    C           DTYPFA    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFFA
     C                     MOVE *BLANKS   DFPXFA
F2  C                     END
    C*
D2  C           DTYPFB    IFNE *BLANKS
D3  C           DSFFB     IFEQ *ZEROS
    C           DLZFB     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFB    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYFB
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXFB
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFB    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFFB
D3  C           DNPAFB    IFGT NPDOR
    C           DNPAFB    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFFB     IFNE *ZEROS
    C           DNPAFB    ORNE *BLANK
    C           DTYPFB    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFFB
     C                     MOVE *BLANKS   DFPXFB
F2  C                     END
    C*
D2  C           DTYPFC    IFNE *BLANKS
D3  C           DSFFC     IFEQ *ZEROS
    C           DLZFC     OREQ *ZEROS
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE 'DOTF'    PXARGU
     C                     MOVE DTYPFC    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,8    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTYFC
     C                     Z-ADDPXMONT    ZZ1
     C                     MOVE ZZ1       DFPXFC
     C                     MOVE 'DOFF'    PXARGU
     C                     MOVE DFPXFC    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
D3  C           *IN50     IFEQ '1'
     C                     MOVELDERR,5    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE PXABRG    LTFFC
D3  C           DNPAFC    IFGT NPDOR
    C           DNPAFC    OREQ *BLANK
     C                     MOVELDERR,7    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
X2  C                     ELSE
D3  C           DSFFC     IFNE *ZEROS
    C           DNPAFC    ORNE *BLANK
    C           DTYPFC    ORNE *BLANK
     C                     MOVELDERR,4    ERRDOR
    C                     GOTO SWDOR
F3  C                     END
     C                     MOVE *BLANKS   LTFFC
     C                     MOVE *BLANKS   DFPXFC
F2  C                     END
     *
X1  C                     ELSE
     C                     EXSR ZEROD
F1  C                     END
     C/SPACE 3
    C*
    C* SI PELLICULAGE / AFFICHAGE
    C*------------------------------
    C*          PELLI     IFEQ '*'
D1  C           NATMAI    IFNE ' '
     C                     Z-ADDNOETU     SVNOEX
    C*                    MOVE PELLI     PELLIX
     C                     MOVE AFFI      AFFIX
     C                     MOVE ' '       AUTCO
     C           CODUTI    LOKUPTNOM                     90
     C   90                MOVE '*'       AUTCO
     C                     MOVELMPASSE    PAS013
     * SI LA CONFIG A CHANGÉ AU PRODUIT , ON LA FORCE A L'AFFICHE, SI NON LIBRE
D2  C           STCO35    IFEQ '1'
    C           ZTCO35    ANDNE'1'
    C           STCO35    OREQ '2'
    C           ZTCO35    ANDNE'2'
    C           STCO35    OREQ '3'
    C           ZTCO35    ANDNE'3'
     C                     MOVE STCO35    TCOEP
X2  C                     ELSE
     C                     MOVE 9         TCOEP            SERA EN SAISIE LIBRE
F2  C                     END
     * PAS DE MACHINE POUR LES PRODUITS
     C                     Z-ADD*ZEROS    USIEO
     C                     MOVE *BLANK    MACEP
     C                     CALL 'DEV013£'
     C                     PARM           DEV013
F1  C                     END
    C*                    CALL 'DEV013£'
    C*                    PARM           DEV013
    C*                    END
D1  C           NATMAI    IFEQ ' '
    C           SVNATM    ANDEQ'*'
     C                     Z-ADDNOETU     SVNOEX
     C                     CALL 'DEV035£'
     C                     PARM           DEV035
F1  C                     END
     C/SPACE 3
    C* SI COMPLEXE CXH
    C*------------------------------
     C                     EXSR PRE03
D1  C           PAPECX    IFNE *BLANKS
    C           PAPICX    ORNE *BLANKS
     C                     Z-ADDSELECT    NF
    C*
D2  C           PAPECX    IFNE *BLANKS
     C                     EXSR SPCXH1
     C           TAG81     TAG
     C                     EXFMTPF10
D3  C           *IN77     IFEQ '1'
     C                     MOVEL'O'       WANNUL
    C           PARM0     CABEQ'O'       FINPRO
    C                     GOTO B9
F3  C                     END
    C           *IN12     CABEQ'1'       B2
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARMCX
     C                     CALL 'PRODU24£'
     C                     PARM           INTCXH
     C                     WRITEPF02
    C                     GOTO TAG81
F3  C                     END
     C                     EXSR CTLF10
    C   61                GOTO TAG81
     C                     EXSR SPCXH2
F2  C                     END
    C*
D2  C           PAPICX    IFNE *BLANKS
     C                     EXSR SPCXH3
     C           TAG82     TAG
     C                     EXFMTPF10
D3  C           *IN07     IFEQ '1'
    C           PARM0     CABEQ'O'       FINPRO
    C                     GOTO B9
F3  C                     END
    C           *IN12     CABEQ'1'       B2
D3  C           *IN04     IFEQ '1'
     C                     MOVE 'O'       PARMCX
     C                     CALL 'PRODU24£'
     C                     PARM           INTCXH
     C                     WRITEPF02
    C                     GOTO TAG82
F3  C                     END
     C                     EXSR CTLF10
    C   61                GOTO TAG82
     C                     EXSR SPCXH4
F2  C                     END
    C*
     C                     EXSR ECRIT
     C                     Z-ADDNF        SELECT
F1  C                     END
     C/SPACE 3
    C*
    C           INN25     CABEQ1         B8
    C*
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C* AFFICHAGE ET, VALIDATION DU FORMAT 3****************
     C           B3        TAG
     C                     Z-ADD0         SELECT           PASSER AU FMT SUIVANT
     * SI ON ARRIVE D'UN AUTRE FORMAT QUE LE 2, INIT DE ZTCO35
D1  C           ZTCO35    IFEQ *BLANK
     C                     MOVE OTCO35    ZTCO35
F1  C                     END
     *--------------------------------------------------------*
     *   FORMAT OFFSET 3B : OTCO35 > 0
     *--------------------------------------------------------*
     *
     * Détermination du nombre d'impression
     C                     Z-ADD0         NBRIMP  10
D1  C           TIMP1     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP2     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP3     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP4     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP5     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP6     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           TIMP7     IFNE 0
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           NIMPE1    IFNE *BLANKS
     C                     ADD  1         NBRIMP
F1  C                     END
D1  C           NIMPI1    IFNE *BLANKS
     C                     ADD  1         NBRIMP
F1  C                     END
     *
D1  C           TIMP3     IFEQ 4
    C           ZTCO35    ANDGE'1'
    C           TIMP5     OREQ 4
    C           ZTCO35    ANDGE'1'
     C                     MOVE 'M'       MAJVIS           MODIFICATION
     C                     MOVE 'P'       DEAFPR           PRODUIT
     C                     MOVE LIB120    LIBTRA
     C                     MOVELNOMFA1    NOMCLP
     C                     MOVE BLOC1     BLOC1P
     C                     MOVE ZTCO35    OTCO3P
D2  C           TIMP3     IFEQ 4
D3  C           ZTCO35    IFGE '1'
     *                    impression extérieur pour autre que 3B
     C                     SUB  1         NBRIMP
F3  C                     END
     C                     Z-ADDUSEXT     UOEXT
     C                     Z-ADDFORL3     FORL
     C                     Z-ADDFORH3     FORH
     C                     Z-ADDCOUL3B    COUL3P
     C                     Z-ADDONBCER    ZNBCER
F2  C                     END
D2  C           TIMP5     IFEQ 4
D3  C           ZTCO35    IFGE '1'
     *                    impression intérieure pour autre que 3B
     C                     SUB  1         NBRIMP
F3  C                     END
     C                     Z-ADDUSINT     UOINT
     C                     Z-ADDFORL5     FORL
     C                     Z-ADDFORH5     FORH
     C                     Z-ADDCOUL5B    COUL5P
F2  C                     END
     C                     MOVE ANDEV     ANSAV   2
     C                     MOVE ETUDE     ETSAV   4
     C                     MOVE SEQDE     SESAV   4
     C                     MOVE STE       ANDEV
     C                     MOVE NOCLI     ETUDE
     C                     MOVE NOPRO     SEQDE
     C                     CALL 'DEV120£'
     C                     PARM           DS120
     C                     MOVE ANSAV     ANDEV
     C                     MOVE ETSAV     ETUDE
     C                     MOVE SESAV     SEQDE
    C           CODRET    CABEQ'KO'      BMP02X
     C                     MOVE OTCO3P    OTCO35
D2  C           TIMP3     IFEQ 4
     C                     Z-ADDUOEXT     USEXT
     C                     Z-ADDCOUL3P    COUL3B
     C                     Z-ADDZNBCER    ONBCER
D3  C           OTV13R    IFNE ' '
    C           OTE13R    ORNE ' '
     C                     MOVE TIMP3     TREP3
X3  C                     ELSE
     C                     MOVE *BLANK    TREP3
F3  C                     END
X2  C                     ELSE
     C                     MOVE *BLANK    TREP3
F2  C                     END
D2  C           TIMP5     IFEQ 4
     C                     Z-ADDUOINT     USINT
     C                     Z-ADDCOUL5P    COUL5B
D3  C           OTV15R    IFNE ' '
    C           OTE15R    ORNE ' '
     C                     MOVE TIMP5     TREP5
X3  C                     ELSE
     C                     MOVE *BLANK    TREP5
F3  C                     END
X2  C                     ELSE
     C                     MOVE *BLANK    TREP5
F2  C                     END
     *
F1  C                     END
     *
     * Affichage de l'ancien écran s'il reste de l'impression
D1  C           NBRIMP    IFGE 1
     C                     MOVE '0'       *IN
     C                     EXSR PRE03
    C   79                GOTO B4
     *
     C           BMP03     TAG
     C                     SETON                     72
     * ON BLOQUE L'EXTERIEUR SI OFFSET 3 CONFIG > 0
     *           L'INTERIEUR    OFFSET 5 CONFIG > 0
     C                     MOVE *IN30     SV30    1
     C                     MOVE *IN31     SV31    1
D2  C           TIMP3     IFEQ 4
    C           ZTCO35    ANDGT'0'
     C                     MOVE '1'       *IN30
F2  C                     END
D2  C           TIMP5     IFEQ 4
    C           ZTCO35    ANDGT'0'
     C                     MOVE '1'       *IN31
F2  C                     END
     *
     C                     EXFMTPF03
     C                     MOVE SV30      *IN30
     C                     MOVE SV31      *IN31
D2  C           *IN34     IFEQ '1'
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
D3  C           ZONZON    IFEQ 'TIMEX'
    C           TIMEX     ANDEQ'STOCKE'
     C                     MOVE 'N'       LAN171
     C                     MOVE NIMPE1    STK171
     C                     MOVE NIMPE2    STK172
     C                     CALL 'LAN017£'
     C                     PARM           LAN017
F3  C                     END
D3  C           ZONZON    IFEQ 'TIMIN'
    C           TIMIN     ANDEQ'STOCKE'
     C                     MOVE 'N'       LAN171
     C                     MOVE NIMPI1    STK171
     C                     MOVE NIMPI2    STK172
     C                     CALL 'LAN017£'
     C                     PARM           LAN017
F3  C                     END
    C                     GOTO BMP03
F2  C                     END
     *
     C                     MOVE *BLANKS   MSGMSG
     C   80 90
     COR 81 90
     COR 82 90
     COR 51 90
     COR 52 90
    COR 83 90             GOTO S3A
     C      90             MOVE '0'       *IN,M
     C           S3A       TAG
     C                     EXSR RAZ
     C                     SETOF                     5152
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
     C                     EXSR VALF03
     C                     MOVE *IN90     IN1
     C                     EXSR RAZ
     C                     MOVE IN1       *IN90
     C                     SETOF                     5152
     C   90      MSG       COMP 11                       80
    C   90 80             GOTO BMP03
     C   90      MSG       COMP 12                       81
    C   90 81             GOTO BMP03
     C   90      MSG       COMP 17                       82
    C   90 82             GOTO BMP03
     C   90      MSG       COMP 16                       83
    C   90 83             GOTO BMP03
     C   90      MSG       COMP 2                        52
    C   90 52             GOTO BMP03
     C   90      MSG       COMP 1                        51
    C   90 51             GOTO BMP03
     C   90                EXSR MESSAG
    C   90                GOTO BMP03
    C*
D2  C           TREPEX    IFEQ 0
     C                     Z-ADD*ZEROS    FAIMER
     C                     Z-ADD*ZEROS    MIMRE1
     C                     Z-ADD*ZEROS    MIMRE2
     C                     Z-ADD*ZEROS    MIMRE3
     C                     Z-ADD*ZEROS    MIMRE4
     C                     Z-ADD*ZEROS    MIMRE5
     C                     Z-ADD*ZEROS    RMIRE1
     C                     Z-ADD*ZEROS    RMIRE2
     C                     Z-ADD*ZEROS    RMIRE3
     C                     Z-ADD*ZEROS    RMIRE4
     C                     Z-ADD*ZEROS    RMIRE5
X2  C                     ELSE
D3  C           USEXT     IFEQ *ZEROS
    C           USPIE     ANDNE*ZEROS
     C                     Z-ADDUSPIE     USEXT
F3  C                     END
D3  C           TREPEX    IFEQ 1
     C                     Z-ADD11        FAIMER
F3  C                     END
D3  C           TREPEX    IFEQ 2
     C                     Z-ADD12        FAIMER
F3  C                     END
D3  C           TREPEX    IFEQ 4
     C                     Z-ADD14        FAIMER
F3  C                     END
F2  C                     END
D2  C           TREPIN    IFEQ 0
     C                     Z-ADD*ZEROS    FAIMIR
     C                     Z-ADD*ZEROS    MIMRI1
     C                     Z-ADD*ZEROS    MIMRI2
     C                     Z-ADD*ZEROS    MIMRI3
     C                     Z-ADD*ZEROS    MIMRI4
     C                     Z-ADD*ZEROS    MIMRI5
     C                     Z-ADD*ZEROS    RMIRI1
     C                     Z-ADD*ZEROS    RMIRI2
     C                     Z-ADD*ZEROS    RMIRI3
     C                     Z-ADD*ZEROS    RMIRI4
     C                     Z-ADD*ZEROS    RMIRI5
X2  C                     ELSE
D3  C           USINT     IFEQ *ZEROS
    C           USPII     ANDNE*ZEROS
     C                     Z-ADDUSPII     USINT
F3  C                     END
D3  C           TREPIN    IFEQ 1
     C                     Z-ADD11        FAIMIR
F3  C                     END
D3  C           TREPIN    IFEQ 2
     C                     Z-ADD12        FAIMIR
F3  C                     END
D3  C           TREPIN    IFEQ 4
     C                     Z-ADD14        FAIMIR
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C                     EXSR ECRIT
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
     *
    C* AFFICHAGE ET, VALIDATION DU FORMAT 4 **************
     C           B4        TAG
     C                     MOVE '0'       *IN
     C                     EXSR PRE04
    C   79                GOTO B5
     C           BMP04     TAG
     C                     Z-ADD0         HLIG
     C                     Z-ADD0         HCOL
     C                     EXFMTPF04
    C           *IN04     CASEQ'1'       TRTAID         30
    C                     END
    C           *IN30     CABEQ'1'       BMP04
     C                     SETOF                     78
     C                     MOVE *BLANKS   MSGMSG
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77      INN24     CABEQ1         BMP04
    C   77                GOTO B9
     C   90                MOVE '0'       *IN,M
     C   90                SETOF                     90
     C                     EXSR VALF04
     C                     MOVE *IN90     IN1
     C                     EXSR RAZ
     C                     MOVE IN1       *IN90
     C   90                EXSR MESSAG
    C   90                GOTO BMP04
    C*
D1  C           RHODOA    IFEQ 'A'
     C                     Z-ADD-1        RHODO
X1  C                     ELSE
D2  C           RHODOA    IFEQ 'B'
     C                     Z-ADD-2        RHODO
X2  C                     ELSE
D3  C           RHODOA    IFEQ 'C'
     C                     Z-ADD-3        RHODO
X3  C                     ELSE
D4  C           RHODOA    IFEQ 'D'
     C                     Z-ADD-4        RHODO
X4  C                     ELSE
D5  C           RHODOA    IFEQ 'E'
     C                     Z-ADD-5        RHODO
X5  C                     ELSE
D6  C           RHODOA    IFEQ 'F'
     C                     Z-ADD-6        RHODO
X6  C                     ELSE
D7  C           RHODOA    IFEQ 'G'
     C                     Z-ADD-7        RHODO
X7  C                     ELSE
D8  C           RHODOA    IFEQ 'H'
     C                     Z-ADD-8        RHODO
X8  C                     ELSE
D9  C           RHODOA    IFEQ 'I'
     C                     Z-ADD-9        RHODO
X9  C                     ELSE
     C                     MOVE RHODOA    RHODO
F9  C                     END
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C                     EXSR ECRIT
     C                     Z-ADD*ZERO     INN24
    C*
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C* AFFICHAGE ET, VALIDATION DU FORMAT 5 **************
     C           B5        TAG
     C                     MOVE '0'       *IN
     C                     MOVELPDUNI     PDUNI1  40
     C                     MOVE PDUNI     PDUNI2  10
     C                     MOVE *BLANK    LIBST1
     C                     MOVE *BLANK    LIBST2
     C                     MOVE *BLANK    LIBST3
     C                     MOVE *BLANK    LIBST4
D1  C           STCTDF    IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE STCTDF    PXVALE
     C                     MOVE 'TDST'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST1
F1  C                     END
D1  C           STCTDE    IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE STCTDE    PXVALE
     C                     MOVE 'TDST'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST2
F1  C                     END
D1  C           STCTDI    IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE STCTDI    PXVALE
     C                     MOVE 'TDST'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST3
F1  C                     END
D1  C           STCOD4    IFNE ' '
     C                     MOVE *BLANK    PXVALE
     C                     MOVE *BLANK    PXARGU
     C                     MOVE STCOD4    PXVALE
     C                     MOVE 'TDST'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBST4
F1  C                     END
D1  C           CODDOR    IFEQ '*'
     C                     MOVE *BLANKS   REFDSS
X1  C                     ELSE
     C                     MOVE REFDOR    REFDSS
F1  C                     END
     C                     Z-ADD0         LIGNE
     C                     Z-ADD0         COLON
     C           BMP05     TAG
     C                     EXFMTPF05
     C                     Z-ADDLIG       LIGNE
     C                     Z-ADDCOL       COLON
D1  C           *IN04     IFEQ '1'
D2  C           ZONE      IFEQ 'LIEU'
     C                     MOVEL'DPTS'    TBLNO2
     C                     CALL 'FENPAR'
     C                     PARM           DSPAR2
D3  C           RET2      IFEQ '0'
     C                     MOVE TBVAR     LIEU
F3  C                     ENDIF
F2  C                     ENDIF
D2  C           ZONE      IFEQ 'CPAYFO'
     C                     MOVEL'TPAY'    TBLNO2
     C                     CALL 'FENPAR'
     C                     PARM           DSPAR2
D3  C           RET2      IFEQ '0'
     C                     MOVE TBVAR     CPAYFO
F3  C                     ENDIF
F2  C                     ENDIF
    C                     GOTO BMP05
     C                     SETOF                     04
F1  C                     ENDIF
     C                     MOVE 'R'       MOPOR
     C                     MOVE *BLANKS   MSGMSG
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
    C*
     C   90                MOVE '0'       *IN,M
     C   90                SETOF                     90
     C                     EXSR VALF05
     C                     MOVE *IN90     IN1
     C                     EXSR RAZ
     C                     MOVE IN1       *IN90
     C   90                EXSR MESSAG
    C   90                GOTO BMP05
    C*
D1  C           REFDSS    IFNE *BLANKS
     C                     MOVE REFDSS    REFDOR
F1  C                     END
    C*
     C                     MOVE '*'       MAJ59   1
     C                     EXSR ECRIT
     C                     MOVE ' '       MAJ59
     C                     MOVELGARNT     GARNT1
D1  C           GARNT1    IFNE ' '
    C           GARNT1    ANDNE'M'
     C                     EXSR SPDSRE
F1  C                     END
    C* EMBALLAGE
    C*------------------
     C                     MOVE '*'       FST     1
     C                     EXSR ECRIT
     C                     MOVE *BLANKS   FST
     C                     Z-ADDUSINE     USIE1
     C                     Z-ADDSTE       STEE1
     C                     Z-ADDNOCLI     NOCLE1
     C                     Z-ADDNOPRO     NOPRE1
     C                     CALL 'EMB001£'
     C                     PARM           EMB001
     C           CLECLE    CHAINPRODUI2              80
     C           CLECLE    CHAINPRODST2              80
    C*
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C* AFFICHAGE ET, VALIDATION DU FORMAT 6 **************
     C           B6        TAG
     C                     MOVE '0'       *IN
     C                     EXSR AVANT1
     C           BMP06     TAG
     C                     EXFMTPF06
     C                     MOVE *BLANKS   MSGMSG
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
D1  C           SIGAF     IFEQ '-'
     C                     Z-SUBAUTFRB    AUTFRB
F1  C                     END
     C                     EXSR ECRIT
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
     *
     * AFFICHAGE ET VALIDATION DU FORMAT 7
     * -----------------------------------
     C           B7        TAG
     C                     MOVE '0'       *IN
D1  C           CCOL      IFEQ 2
     C                     MOVE '1'       *IN11
F1  C                     END
     *
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 3
     C                     MOVE '1'       *IN11
     C                     MOVE '1'       *IN12
F1  C                     END
     *
D1  C           CCOL      IFEQ 9
    C*          CCOL      OREQ 6
     C                     MOVE '1'       *IN11
     C                     MOVE '1'       *IN12
     C                     MOVE '1'       *IN13
F1  C                     END
     *
     C           CCOL      COMP 1                        14
     C           COAS1     COMP 0                    1515
     C           COAS2     COMP 0                    1616
     C           FAIME     COMP 0                    1717
     C           FAIMI     COMP 0                    1818
     C           FAIMER    COMP 0                    1919
     C           FAIMIR    COMP 0                    2020
     C           GFRA      COMP *BLANK               2121
     C   21      GFRA      COMP 'GD'                 2121
     C           GFRA2     COMP *BLANK               2222
     C   22      GFRA2     COMP 'GD'                 2222
     *
     C           BMP07     TAG
     *          -----     ---
     C                     EXSR PREF07
D1  C           *IN93     IFEQ '1'
    C           IN93      OREQ '1'
     C           CODUTI    LOKUPTNOM                     93
F1  C                     END
     C                     EXFMTPF07
     *
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
     *
    C           *IN04     CASEQ'1'       TRTAID         78
    C                     END
    C           *IN78     CABEQ'1'       BMP07
     C                     SETOF                     78
     *
    C           HUMOMN    CABGTHUMOMX    BMP07      30
     **
     C                     MOVEL'XPOOLMAC'TBLNOM
     C                     Z-ADD1         TBNSEG
D1  C           *IN21     IFEQ '1'
     C                     Z-ADDRCOU1     USZ
     C                     MOVEL'5'       SECT
     C                     MOVEL'1'       SSECT
     C                     MOVE MAGAU1    NOMAC
     C           CLEMAC    CHAINMACHIN               38
    C           *IN38     CABEQ'1'       BMP07
D2  C           MAGAU2    IFNE *ZEROS
     C                     Z-ADDRCOU1     USZ
     C                     MOVE FADEC     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE RCOU1     XPOOA1
     C                     MOVE MAGAU2    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
    C           *IN39     CABEQ'1'       BMP07
F2  C                     END
F1  C                     END
D1  C           *IN22     IFEQ '1'
     C                     Z-ADDRCOU1     USZ
     C                     MOVEL'5'       SECT
     C                     MOVEL'1'       SSECT
     C                     MOVE DECA1     NOMAC
     C           CLEMAC    CHAINMACHIN               36
    C           *IN36     CABEQ'1'       BMP07
D2  C           DECA2     IFNE *ZEROS
     C                     Z-ADDRCOU1     USZ
     C                     MOVE FADEC     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE RCOU1     XPOOA1
     C                     MOVE DECA2     NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
    C           *IN37     CABEQ'1'       BMP07
F2  C                     END
F1  C                     END
     *
D1  C           FAIME     IFNE 0
     C                     Z-ADDUSEXT     USZ
     C                     MOVE FAIME     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USEXT     XPOOA1
D2  C           RMIME1    IFNE 0
     C                     MOVE RMIME1    NOMAC
     C           CLEMAC    CHAINMACHIN               50
     C  N50      ANNMAC    COMP *BLANK               5050
     C   50                MOVELXPOOKE    TBVARG
     C   50      KTBA01    CHAINXTBASE01             50
F2  C                     END
D2  C           RMIME2    IFNE 0
     C                     MOVE RMIME2    NOMAC
     C           CLEMAC    CHAINMACHIN               51
     C  N51      ANNMAC    COMP *BLANK               5151
     C   51                MOVELXPOOKE    TBVARG
     C   51      KTBA01    CHAINXTBASE01             51
F2  C                     END
D2  C           RMIME3    IFNE *ZEROS
     C                     MOVE RMIME3    NOMAC
     C           CLEMAC    CHAINMACHIN               52
     C  N52      ANNMAC    COMP *BLANK               5252
     C   52                MOVELXPOOKE    TBVARG
     C   52      KTBA01    CHAINXTBASE01             52
F2  C                     END
D2  C           RMIME4    IFNE *ZEROS
     C                     MOVE RMIME4    NOMAC
     C           CLEMAC    CHAINMACHIN               53
     C  N53      ANNMAC    COMP *BLANK               5353
     C   53                MOVELXPOOKE    TBVARG
     C   53      KTBA01    CHAINXTBASE01             53
F2  C                     END
D2  C           RMIME5    IFNE 0
     C                     MOVE RMIME5    NOMAC
     C           CLEMAC    CHAINMACHIN               54
     C  N54      ANNMAC    COMP *BLANK               5454
     C   54                MOVELXPOOKE    TBVARG
     C   54      KTBA01    CHAINXTBASE01             54
F2  C                     END
F1  C                     END
     *
D1  C           FAIMI     IFNE 0
     C                     Z-ADDUSINT     USZ
     C                     MOVE FAIMI     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USINT     XPOOA1
D2  C           RMIMI1    IFNE 0
     C                     MOVE RMIMI1    NOMAC
     C           CLEMAC    CHAINMACHIN               60
     C  N60      ANNMAC    COMP *BLANK               6060
     C   60                MOVELXPOOKE    TBVARG
     C   60      KTBA01    CHAINXTBASE01             60
F2  C                     END
D2  C           RMIMI2    IFNE 0
     C                     MOVE RMIMI2    NOMAC
     C           CLEMAC    CHAINMACHIN               61
     C  N61      ANNMAC    COMP *BLANK               6161
     C   61                MOVELXPOOKE    TBVARG
     C   61      KTBA01    CHAINXTBASE01             61
F2  C                     END
D2  C           RMIMI3    IFNE *ZEROS
     C                     MOVE RMIMI3    NOMAC
     C           CLEMAC    CHAINMACHIN               62
     C  N62      ANNMAC    COMP *BLANK               6262
     C   62                MOVELXPOOKE    TBVARG
     C   62      KTBA01    CHAINXTBASE01             62
F2  C                     END
D2  C           RMIMI4    IFNE *ZEROS
     C                     MOVE RMIMI4    NOMAC
     C           CLEMAC    CHAINMACHIN               63
     C  N63      ANNMAC    COMP *BLANK               6363
     C   63                MOVELXPOOKE    TBVARG
     C   63      KTBA01    CHAINXTBASE01             63
F2  C                     END
D2  C           RMIMI5    IFNE *ZEROS
     C                     MOVE RMIMI5    NOMAC
     C           CLEMAC    CHAINMACHIN               64
     C  N64      ANNMAC    COMP *BLANK               6464
     C   64                MOVELXPOOKE    TBVARG
     C   64      KTBA01    CHAINXTBASE01             64
F2  C                     END
F1  C                     END
     *
D1  C           FAIMER    IFNE 0
     C                     Z-ADDUSEXT     USZ
D2  C           USZ       IFEQ *ZERO                      ET SI PREIMP
D3  C           FAIMER    IFEQ 14
     C                     Z-ADDUSINE     USZ              NON TY = RT
X3  C                     ELSE
     C                     Z-ADD3         USZ              NON TY ?
F3  C                     END
F2  C                     END
     C                     MOVE FAIMER    ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USEXT     XPOOA1
D2  C           MIMRE1    IFNE 0
     C                     MOVE MIMRE1    NOMAC
     C           CLEMAC    CHAINMACHIN               40
     C  N40      ANNMAC    COMP *BLANK               4040
     C   40                MOVELXPOOKE    TBVARG
     C   40      KTBA01    CHAINXTBASE01             40
     *OFFSET 3B
D3  C           TREP3     IFEQ 4
    C           ZTCO35    ANDGT'0'
D4  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F4  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSEXT     OUCOEP
     C                     MOVE NOMAC     OMACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLEPAR    SETLLPARAME
     C           CLEPAR    READEPARAME                   40
    C           *IN40     CABEQ'1'       RIENR3
D4  C           *IN40     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ZTCO35    YYY1    1
    C           ZZZ1      CABEQYYY1                     40
     C  N40      CLEPAR    READEPARAME                   40
F4  C                     END
     C                     MOVE '0'       *IN40
D4  C           ZZZ1      IFNE YYY1
     C           RIENR3    TAG
     C                     MOVE '1'       *IN40
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           OGE3R1    IFGT 0
     C                     MOVE '1'       *IN40
F3  C                     END
     *
F2  C                     END
D2  C           MIMRE2    IFNE 0
     C                     MOVE MIMRE2    NOMAC
     C           CLEMAC    CHAINMACHIN               41
     C  N41      ANNMAC    COMP *BLANK               4141
     C   41                MOVELXPOOKE    TBVARG
     C   41      KTBA01    CHAINXTBASE01             41
X2  C                     ELSE
D3  C           OGE3R2    IFGT 0
     C                     MOVE '1'       *IN41
F3  C                     END
F2  C                     END
D2  C           MIMRE3    IFNE *ZEROS
     C                     MOVE MIMRE3    NOMAC
     C           CLEMAC    CHAINMACHIN               42
     C  N42      ANNMAC    COMP *BLANK               4242
     C   42                MOVELXPOOKE    TBVARG
     C   42      KTBA01    CHAINXTBASE01             42
X2  C                     ELSE
D3  C           OGE3R3    IFGT 0
     C                     MOVE '1'       *IN42
F3  C                     END
F2  C                     END
D2  C           MIMRE4    IFNE *ZEROS
     C                     MOVE MIMRE4    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
F2  C                     END
D2  C           MIMRE5    IFNE *ZEROS
     C                     MOVE MIMRE5    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
F2  C                     END
D2  C           RMIRE1    IFNE 0
     C                     MOVE RMIRE1    NOMAC
     C           CLEMAC    CHAINMACHIN               55
     C  N55      ANNMAC    COMP *BLANK               5555
     C   55                MOVELXPOOKE    TBVARG
     C   55      KTBA01    CHAINXTBASE01             55
F2  C                     END
D2  C           RMIRE2    IFNE 0
     C                     MOVE RMIRE2    NOMAC
     C           CLEMAC    CHAINMACHIN               56
     C  N56      ANNMAC    COMP *BLANK               5656
     C   56                MOVELXPOOKE    TBVARG
     C   56      KTBA01    CHAINXTBASE01             56
F2  C                     END
D2  C           RMIRE3    IFNE *ZEROS
     C                     MOVE RMIRE3    NOMAC
     C           CLEMAC    CHAINMACHIN               57
     C  N57      ANNMAC    COMP *BLANK               5757
     C   57                MOVELXPOOKE    TBVARG
     C   57      KTBA01    CHAINXTBASE01             56
F2  C                     END
D2  C           RMIRE4    IFNE *ZEROS
     C                     MOVE RMIRE4    NOMAC
     C           CLEMAC    CHAINMACHIN               58
     C  N58      ANNMAC    COMP *BLANK               5858
     C   58                MOVELXPOOKE    TBVARG
     C   58      KTBA01    CHAINXTBASE01             58
F2  C                     END
D2  C           RMIRE5    IFNE *ZEROS
     C                     MOVE RMIRE5    NOMAC
     C           CLEMAC    CHAINMACHIN               59
     C  N59      ANNMAC    COMP *BLANK               5959
     C   59                MOVELXPOOKE    TBVARG
     C   59      KTBA01    CHAINXTBASE01             59
F2  C                     END
F1  C                     END
     *
D1  C           FAIMIR    IFNE 0
     C                     Z-ADDUSINT     USZ
D2  C           USZ       IFEQ *ZERO                      ET SI PREIMP
D3  C           FAIMIR    IFEQ 14
     C                     Z-ADDUSINE     USZ              NON TY = RT
X3  C                     ELSE
     C                     Z-ADD3         USZ              NON TY ?
F3  C                     END
F2  C                     END
     C                     MOVE FAIMIR    ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USINT     XPOOA1
D2  C           MIMRI1    IFNE 0
     C                     MOVE MIMRI1    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
     *OFFSET 3B
D3  C           TREP5     IFEQ 4
    C           ZTCO35    ANDGT'0'
D4  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F4  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSINT     OUCOEP
     C                     MOVE NOMAC     OMACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLEPAR    SETLLPARAME
     C           CLEPAR    READEPARAME                   45
    C           *IN45     CABEQ'1'       RIENR5
D4  C           *IN45     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ZTCO35    YYY1    1
    C           ZZZ1      CABEQYYY1                     45
     C  N45      CLEPAR    READEPARAME                   45
F4  C                     END
     C                     MOVE '0'       *IN45
D4  C           ZZZ1      IFNE YYY1
     C           RIENR5    TAG
     C                     MOVE '1'       *IN45
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           OGE5R1    IFGT 0
     C                     MOVE '1'       *IN45
F3  C                     END
F2  C                     END
     *
D2  C           MIMRI2    IFNE 0
     C                     MOVE MIMRI2    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
F2  C                     END
D2  C           MIMRI3    IFNE *ZEROS
     C                     MOVE MIMRI3    NOMAC
     C           CLEMAC    CHAINMACHIN               47
     C  N47      ANNMAC    COMP *BLANK               4747
     C   47                MOVELXPOOKE    TBVARG
     C   47      KTBA01    CHAINXTBASE01             50
F2  C                     END
D2  C           MIMRI4    IFNE *ZEROS
     C                     MOVE MIMRI4    NOMAC
     C           CLEMAC    CHAINMACHIN               48
     C  N48      ANNMAC    COMP *BLANK               4848
     C   48                MOVELXPOOKE    TBVARG
     C   48      KTBA01    CHAINXTBASE01             48
F2  C                     END
D2  C           MIMRI5    IFNE *ZEROS
     C                     MOVE MIMRI5    NOMAC
     C           CLEMAC    CHAINMACHIN               49
     C  N49      ANNMAC    COMP *BLANK               4949
     C   49                MOVELXPOOKE    TBVARG
     C   49      KTBA01    CHAINXTBASE01             49
F2  C                     END
D2  C           RMIRI1    IFNE 0
     C                     MOVE RMIRI1    NOMAC
     C           CLEMAC    CHAINMACHIN               65
     C  N65      ANNMAC    COMP *BLANK               6565
     C   65                MOVELXPOOKE    TBVARG
     C   65      KTBA01    CHAINXTBASE01             65
F2  C                     END
D2  C           RMIRI2    IFNE 0
     C                     MOVE RMIRI2    NOMAC
     C           CLEMAC    CHAINMACHIN               66
     C  N66      ANNMAC    COMP *BLANK               6666
     C   66                MOVELXPOOKE    TBVARG
     C   66      KTBA01    CHAINXTBASE01             66
F2  C                     END
D2  C           RMIRI3    IFNE *ZEROS
     C                     MOVE RMIRI3    NOMAC
     C           CLEMAC    CHAINMACHIN               67
     C  N67      ANNMAC    COMP *BLANK               6767
     C   67                MOVELXPOOKE    TBVARG
     C   67      KTBA01    CHAINXTBASE01             67
F2  C                     END
D2  C           RMIRI4    IFNE *ZEROS
     C                     MOVE RMIRI4    NOMAC
     C           CLEMAC    CHAINMACHIN               68
     C  N68      ANNMAC    COMP *BLANK               6868
     C   68                MOVELXPOOKE    TBVARG
     C   68      KTBA01    CHAINXTBASE01             68
F2  C                     END
D2  C           RMIRI5    IFNE *ZEROS
     C                     MOVE RMIRI5    NOMAC
     C           CLEMAC    CHAINMACHIN               69
     C  N69      ANNMAC    COMP *BLANK               6969
     C   69                MOVELXPOOKE    TBVARG
     C   69      KTBA01    CHAINXTBASE01             69
F2  C                     END
F1  C                     END
D1  C           NOAPP1    IFNE *ZEROS
     C                     Z-ADDNOAPP1    NOAPP   40
     C           CLEAPP    SETLLPRODUL10                 72
     C  N72                SETON                     70
F1  C                     END
D1  C           NOAPP2    IFNE *ZEROS
     C                     Z-ADDNOAPP2    NOAPP   40
     C           CLEAPP    SETLLPRODUL10                 72
     C  N72                SETON                     71
F1  C                     END
     *
D1  C           40        DO   71        I
    C           *IN,I     CABNE'0'       BMP07
F1  C                     END
     *
     C                     Z-ADDNOAPP1    STOCK2
     C                     Z-ADDNOAPP2    STOCK3
     C                     MOVE ECHPAL    RVER7
     C                     EXSR ECRIT
     *
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C*
    C* AFFICHAGE ET,VALIDATION DU FORMAT 8 ***************
     C           B8        TAG
     C                     MOVE '0'       *IN
     C                     EXSR PREF08
     C           ANNULS    COMP *BLANKS              2121
     C                     MOVE ANNULS    ANNUL
     C                     Z-ADDNOFOR     SNOFOR  50
     C                     Z-ADDNOFOR     SNOFO1  50
     C                     Z-ADDNOFOR     SNOFO2  50
     *
     C                     MOVE 'N'       MAJF
     *
     C                     SETOF                     23
     C           BMP08     TAG
    C*          ---------------
     *
D1  C           ZON29     IFEQ '1'
     C                     MOVE '1'       *IN29
F1  C                     END
     C                     EXFMTPF08
     *
     C                     MOVE SV70      *IN70
     C                     SETOF                     90
     C   77                MOVEL'O'       WANNUL
    C         77PARM0     CABEQ'O'       FINPRO
    C   77                GOTO B9
     *
    C           *IN04     CASEQ'1'       TRTAID         78
    C                     END
    C           *IN78     CABEQ'1'       BMP08
     C                     SETOF                     78
     *  ag2 début
     * Spécification client
     *
D1  C           *IN05     IFEQ '1'
     C                     EXFMTPF081
D2  C                     SELEC
     C           CHOIX1    WHEQ '1'
     C                     MOVE *BLANKS   OBSU1
     C                     MOVELCSTOB1    OBSU1
     C           CHOIX2    WHEQ '1'
     C                     MOVE *BLANKS   OBSU1
     C                     MOVELCSTOB2    OBSU1
     C           NOBSU     WHNE *BLANKS
     C                     MOVE *BLANKS   OBSU1
     C           'N° :'    CAT  NOBSU:1   OBSU1
F2  C                     ENDSL
    C                     GOTO BMP08
F1  C                     END
     *
     C                     MOVE *BLANKS   TOTO1
     C           2         SUBSTOBSU1:1   TOTO1   2
D1  C           USINE     IFEQ 3
    C           OBSU1     ANDEQ*BLANKS
     C                     MOVELCSTOB2    OBSU1
F1  C                     ENDIF
D1  C           USINE     IFEQ 4
    C           OBSU1     ANDEQ*BLANKS
     C                     MOVELCSTOB2    OBSU1
F1  C                     ENDIF
D1  C           OBSU1     IFNE CSTOB1
    C           OBSU1     ANDNECSTOB2
    C           TOTO1     ANDNE'N°'
     C                     SETON                     90
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVELMESS,47   MSGMSG
    C                     GOTO BMP08
F1  C                     END
     *
     C                     MOVE *BLANKS   TOTO1
     C           2         SUBSTOBSU1:1   TOTO1   2
D1  C           TOTO1     IFNE 'N°'
    C           OBSU2     ANDNE*BLANKS
     C                     SETON                     90
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVELMESS,48   MSGMSG
    C                     GOTO BMP08
F1  C                     END
     *
     *  ag2 fin
     *
     *
D1  C           NOFOR     IFNE *ZEROS
     C           NOFOR     SETLLFORDECL1                 80
D2  C           *IN80     IFEQ '0'
     C                     SETON                     6790
     C                     MOVE 'N'       MAJF
    C                     GOTO BMP08
F2  C                     END
F1  C                     END
     *
D1  C           MAJF      IFEQ 'O'
    C           SNOFO1    ORNE NOFOR
D2  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
     C                     MOVE *BLANKS   FVIR
X2  C                     ELSE
     C                     MOVE '*'       FVIR
F2  C                     END
     C                     MOVE NOFOR     NOF
     C                     MOVE MPASSE    MPASS
     C                     CALL 'FORM01L'
     C                     PARM           DSNOF
     C                     MOVE NOF       NOFOR
     C                     EXSR PREF08
     C                     MOVE 'N'       MAJF
     C                     Z-ADDNOFOR     SNOFO1
    C                     GOTO BMP08
F1  C                     END
     *
D1  C           WEFEX     IFNE REFEX
    C           WEFIN     ORNE REFIN
     C                     SETOF                     23
D2  C           WEFEX     IFNE REFEX
     C           REFEX     SETLLPRODUL3                  23
     C                     MOVE REFEX     REFE
F2  C                     END
D2  C           WEFIN     IFNE REFIN
     C           REFIN     SETLLPRODUL4                  23
     C                     MOVE REFIN     REFI
F2  C                     END
D2  C           *IN23     IFEQ '1'
     C                     MOVE ' '       OK
     C   23                CALL 'DEV018£'
     C                     PARM           DSREF
D3  C           OK        IFEQ ' '
     C                     SETON                     90
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVELMESS,49   MSGMSG
     C                     SETOF                     23
    C                     GOTO BMP08
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C                     MOVE *BLANKS   PDL     1        PREVENIR DL
D1  C           ANNUL     IFNE ' '
    C           ANNULS    ANDEQ' '
     C                     MOVEA*IN       SAVIN  99
     C                     MOVE '0'       *IN
     C                     EXSR SPSTK
     *
     * Recherche si PRODUIT en-cours de façonnage
     * ------------------------------------------
     C           CLECLE    SETLLENCFACL5                 13
     *
     * Recherche si produit en-cours d'impression
     * ------------------------------------------
     C           CLECLE    SETLLENCIMPL6                 14
     C  N10N11N12
     CANN13N14N15
    CANN16                GOTO SUITAN
     C                     MOVE 'NON'     CONFAN
     C                     EXFMTPF09
D2  C           CONFAN    IFEQ 'NON'
     C                     MOVE *BLANK    ANNUL
X2  C                     ELSE
     C   16                MOVE '*'       PDL
F2  C                     END
     C                     MOVE '*'       TAGEC9
     C           SUITAN    TAG
     C                     MOVEASAVIN     *IN
F1  C                     END
     *
     C                     EXSR VALF08
     *
D1  C           TAGEC9    IFEQ '*'
     C   90                WRITEPF16
F1  C                     END
     C                     MOVE ' '       TAGEC9  1
    C   90                GOTO BMP08
     *
     C                     MOVE VALINV    ZB
     C           NOFOR     SETLLPRODUL11                 81
D1  C           *IN81     IFEQ '1'
     C                     MOVE '*'       ZB11
F1  C                     END
     C           CLEAE     SETLLPRODUL13                 81
D1  C           *IN81     IFEQ '1'
     C                     MOVE '*'       ZB11
F1  C                     END
    C*          ANNUL     IFEQ ' '
    C*          ZB17      ANDEQ'*'
    C*                    MOVE '*'       ANNUL
    C*                    END
     C                     MOVE ANNUL     ANNULS
    C*
D1  C           TMINAF    IFNE *ZEROS
     C                     MOVE TMINAF    TMINAZ
X1  C                     ELSE
     C                     MOVE *BLANKS   TMINAZ
F1  C                     END
D1  C           TMINAF    IFNE *ZEROS
     C                     MOVE TMAXAF    TMAXAZ
X1  C                     ELSE
     C                     MOVE *BLANKS   TMAXAZ
F1  C                     END
    C*
     C                     EXSR ECRIT
     *
     *--- DÉBUT --- PHILIPPE 13/01/2015-- INC0222477 ---*
     * - MISE EN COMMENTAIRE À LA DEMANDE DU DSTINATAIRE
    C**         PDL       IFEQ '*'
    C**                   MOVE NOCLI     NOCSB4  4
    C**                   MOVE NOPRO     NOPSB4  4
    C**                   MOVEANOCSB4    SB5,68
    C**                   MOVEANOPSB4    SB5,73
    C**                   Z-ADD140       LONG
    C**                   CALL 'QCAEXEC'
    C**                   PARM           SB5
    C**                   PARM           LONG
    C**                   MOVE *BLANKS   PDL
    C**                   END
     *--- FIN   --- PHILIPPE 13/01/2015-- INC0222477 ---*
    C* APPEL FORM06£
D1  C           SNOFO2    IFNE NOFOR
D2  C           SNOFO2    IFNE *ZEROS
     C                     Z-ADDSNOFO2    NFAPP   50
     C                     CALL 'FORM06£'
     C                     PARM           NFAPP
F2  C                     END
D2  C           NOFOR     IFNE *ZEROS
     C                     Z-ADDNOFOR     NFAPP   50
     C                     CALL 'FORM06£'
     C                     PARM           NFAPP
F2  C                     END
F1  C                     END
    C* APPEL PROD71£ POUR METTRE A JOUR NOFOR
D1  C           SNOFOR    IFNE NOFOR
     C                     Z-ADDSTE       STE71
     C                     Z-ADDNOCLI     NOCL71
     C                     Z-ADDNOPRO     NOPR71
     C                     MOVEAPROD71    SB2,99
     C                     Z-ADD140       LONG   155
     C                     CALL 'QCAEXEC'
     C                     PARM           SB2
     C                     PARM           LONG
F1  C                     END
    C* APPEL PROD77£ POUR METTRE A JOUR FORME SOFHUNIC
D1  C           NOCLI     IFEQ 8928
    C           SNOFOR    ANDNENOFOR
D2  C           NOFOR     IFNE *ZEROS
     C                     MOVE 'O'       ON
F2  C                     END
D2  C           NOFOR     IFEQ *ZEROS
     C                     MOVE 'N'       ON
F2  C                     END
     C                     Z-ADDNOFOR     NOFOR1
     C                     MOVEAPROD77    SB3,99
     C                     Z-ADD140       LONG   155
     C                     CALL 'QCAEXEC'
     C                     PARM           SB3
     C                     PARM           LONG
F1  C                     END
     *----------------------------------------------------
    C* SI FOURREAUX
    C*--------------------
D1  C           TS1       IFEQ 'F'
    C           NOCLI     ANDEQ8928
D2  C           STOCK4    IFEQ *ZEROS
     C                     Z-ADD10000     STOCK4
F2  C                     END
     C                     EXFMTPF13
     C                     EXSR ECRIT
F1  C                     END
    C* SI APLAT 508
    C*--------------------
     C                     Z-ADD*ZEROS    DTTIR1
     C                     Z-ADD*ZEROS    DTTIR2
     C                     Z-ADD*ZEROS    DTTIR3
     C                     Z-ADD*ZEROS    DTTIR4
     C                     MOVE *IN71     I71     1
     C                     MOVE *IN72     I72     1
     C                     MOVE *IN73     I73     1
     C                     MOVE *IN74     I74     1
     C                     MOVE *IN75     I75     1
     C                     MOVE *IN76     I76     1
     C                     MOVE *IN77     I77     1
     C                     MOVE *IN78     I78     1
     C                     MOVEA'0000'    *IN,71
     C                     MOVE 'TIRELL'  DEST
D1  C           REFEX     IFEQ '   508'
     C                     SETON                         71
     C                     MOVE 'IMPEPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'OUI'     OKTIR1
     C                     Z-ADD*ZEROS    DTTIR1
F2  C                     END
     C                     MOVE 'IMPEPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'NON'     OKTIR1
     C                     MOVE OBSLIB    DTTIR1
F2  C                     END
F1  C                     END
D1  C           REREP     IFEQ '   508'
     C                     SETON                         72
     C                     MOVE 'IMPERO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'OUI'     OKTIR2
     C                     Z-ADD*ZEROS    DTTIR2
F2  C                     END
     C                     MOVE 'IMPERN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'NON'     OKTIR2
     C                     MOVE OBSLIB    DTTIR2
F2  C                     END
F1  C                     END
D1  C           REFIN     IFEQ '   508'
     C                     SETON                         73
     C                     MOVE 'IMPIPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'OUI'     OKTIR3
     C                     Z-ADD*ZEROS    DTTIR3
F2  C                     END
     C                     MOVE 'IMPIPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'NON'     OKTIR3
     C                     MOVE OBSLIB    DTTIR3
F2  C                     END
F1  C                     END
D1  C           RIREP     IFEQ '   508'
     C                     SETON                         74
     C                     MOVE 'IMPIRO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'OUI'     OKTIR4
     C                     Z-ADD*ZEROS    DTTIR4
F2  C                     END
     C                     MOVE 'IMPIRN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
D2  C           *IN99     IFEQ '0'
     C                     MOVE 'NON'     OKTIR4
     C                     MOVE OBSLIB    DTTIR4
F2  C                     END
F1  C                     END
D1  C           *IN71     IFEQ '1'
    C           *IN72     OREQ '1'
    C           *IN73     OREQ '1'
    C           *IN74     OREQ '1'
     C           APF12     TAG
     C                     EXFMTPF12
     *
D2  C           *IN71     IFEQ '1'
     C                     MOVE 'P'       NATOBS
D3  C           OKTIR1    IFEQ 'OUI'
    C           DTTIR1    CABNE*ZEROS    APF12      7575
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPEPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPEPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVELMESS,1    OBSLIB
     C                     Z-ADDI         SEQOBS
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM      20
     C                     MOVE UDAY      JJ
     C   99                WRITEOBSPROF1
F3  C                     END
D3  C           OKTIR1    IFEQ 'NON'
D4  C           DTTIR1    IFNE *ZEROS
     C                     Z-ADDDTTIR1    DTTIR
     C           CLECAL    CHAINCALENAL4             75
    C   75                GOTO APF12
F4  C                     END
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPEPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPEPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
D4  C           *IN99     IFEQ '1'
     C                     Z-ADDI         SEQOBS
     C                     MOVELMESS,2    OBSLIB
     C                     MOVE DTTIR1    OBSLIB
     C                     WRITEOBSPROF1
X4  C                     ELSE
     C                     MOVE DTTIR1    OBSLIB
     C                     UPDATOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           *IN72     IFEQ '1'
     C                     MOVE 'P'       NATOBS
D3  C           OKTIR2    IFEQ 'OUI'
    C           DTTIR2    CABNE*ZEROS    APF12      7676
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPERN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPERO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE MESS,1    OBSLIB
     C                     Z-ADDI         SEQOBS
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
     C   99                WRITEOBSPROF1
F3  C                     END
D3  C           OKTIR2    IFEQ 'NON'
D4  C           DTTIR2    IFNE *ZEROS
     C                     Z-ADDDTTIR2    DTTIR
     C           CLECAL    CHAINCALENAL4             76
    C   76                GOTO APF12
F4  C                     END
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPERO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPERN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
D4  C           *IN99     IFEQ '1'
     C                     Z-ADDI         SEQOBS
     C                     MOVELMESS,2    OBSLIB
     C                     MOVE DTTIR2    OBSLIB
     C                     WRITEOBSPROF1
X4  C                     ELSE
     C                     MOVE DTTIR2    OBSLIB
     C                     UPDATOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           *IN73     IFEQ '1'
     C                     MOVE 'P'       NATOBS
D3  C           OKTIR3    IFEQ 'OUI'
    C           DTTIR3    CABNE*ZEROS    APF12      7777
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPIPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPIPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVELMESS,1    OBSLIB
     C                     Z-ADDI         SEQOBS
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
     C   99                WRITEOBSPROF1
F3  C                     END
D3  C           OKTIR3    IFEQ 'NON'
D4  C           DTTIR3    IFNE *ZEROS
     C                     Z-ADDDTTIR3    DTTIR
     C           CLECAL    CHAINCALENAL4             77
    C   77                GOTO APF12
F4  C                     END
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPIPO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPIPN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
D4  C           *IN99     IFEQ '1'
     C                     Z-ADDI         SEQOBS
     C                     MOVELMESS,2    OBSLIB
     C                     MOVE DTTIR3    OBSLIB
     C                     WRITEOBSPROF1
X4  C                     ELSE
     C                     MOVE DTTIR3    OBSLIB
     C                     UPDATOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           *IN74     IFEQ '1'
     C                     MOVE 'P'       NATOBS
D3  C           OKTIR4    IFEQ 'OUI'
    C           DTTIR4    CABNE*ZEROS    APF12      7878
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPIRN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPIRO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE MESS,1    OBSLIB
     C                     Z-ADDI         SEQOBS
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
     C   99                WRITEOBSPROF1
F3  C                     END
D3  C           OKTIR4    IFEQ 'NON'
D4  C           DTTIR4    IFNE *ZEROS
     C                     Z-ADDDTTIR4    DTTIR
     C           CLECAL    CHAINCALENAL4             78
    C   78                GOTO APF12
F4  C                     END
     C                     MOVE 'TIRELL'  DEST
     C                     MOVE 'IMPIRO'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C  N99                DELETOBSPROF1
     C                     MOVE 'IMPIRN'  EMET
     C           CLEOB1    CHAINOBSPROL1             99
     C                     MOVE INITIA    INICRE
     C                     MOVE UYEAR     AA
     C                     MOVE UMONTH    MM
     C                     MOVE UDAY      JJ
D4  C           *IN99     IFEQ '1'
     C                     Z-ADDI         SEQOBS
     C                     MOVELMESS,2    OBSLIB
     C                     MOVE DTTIR4    OBSLIB
     C                     WRITEOBSPROF1
X4  C                     ELSE
     C                     MOVE DTTIR4    OBSLIB
     C                     UPDATOBSPROF1
F4  C                     END
F3  C                     END
F2  C                     END
     *
F1  C                     END
     C           *LOVAL    SETLLOBSPROL1                   POUR LIBERER
     C                     MOVE I71       *IN71
     C                     MOVE I72       *IN72
     C                     MOVE I73       *IN73
     C                     MOVE I74       *IN74
     C                     MOVE I75       *IN75
     C                     MOVE I76       *IN76
     C                     MOVE I77       *IN77
     C                     MOVE I78       *IN78
     *----------------------------------------------------
    C*
     C                     MOVE *BLANK    ZB
     C                     MOVE *BLANK    ZB11
    C   76                GOTO FINPRO
    C           SELECT    CABEQ1         B1
    C           SELECT    CABEQ2         B2
    C           SELECT    CABEQ3         B3
    C           SELECT    CABEQ4         B4
    C           SELECT    CABEQ5         B5
    C           SELECT    CABEQ6         B6
    C           SELECT    CABEQ7         B7
    C           SELECT    CABEQ8         B8
D1  C           PARM0     IFEQ 'O'
    C           SELECT    CABEQ9         FINPRO
F1  C                     END
    C           SELECT    CABEQ9         B9
    C           PARM0     CABEQ'O'       FINPRO
    C                     GOTO B9
     C/SPACE 2
    C           FINPRO    ENDSR
     C/SPACE 5
     **  PRE-TRAITEMENT DU FORMAT 08 **
    C           PREF08    BEGSR
     C                     MOVE ZB        VALINV
     C           NOFOR     SETLLPRODUL11                 81
    C*
     C                     MOVE TMINAZ    TMINAF
     C                     MOVE TMAXAZ    TMAXAF
    C*
     C           FAIME     COMP 0                        99
     C           FAIMI     COMP 0                        98
     C           FAIMER    COMP 0                        73
     C           FAIMIR    COMP 0                        74
     C           FATYE     COMP 0                        97
     C           FATYI     COMP 0                        96
     C           FAOND     COMP 0                        95
     C           FACOL     COMP 0                        94
     C           FADEC     COMP 0                        93
     C           FAAUT     COMP 0                        92
     C           FAFEN     COMP 0                        91
     C           FAAS1     COMP 0                        88
     C           FAAS2     COMP 0                        89
     C   97 99             SETON                     87
     C   96 98             SETON                     86
     C   93                SETON                     79
     C                     SETOF                     85
D1  C           NOCLI     IFEQ 8928
    C           CCOL      ANDEQ4
    C           NOCLI     OREQ 8928
    C           CCOL      ANDEQ7
     C                     SETOF                     93
F1  C                     END
    C*
D1  C           TIMP3     IFEQ 5
    C           TIMP2     OREQ 5
     C                     SETOF                     87
     C                     SETOF                     73
F1  C                     END
D1  C           TIMP6     IFEQ 5
    C           TIMP5     OREQ 5
    C           TIMP4     OREQ 5
     C                     SETOF                     86
     C                     SETOF                     74
F1  C                     END
    C*
     C           NOFOR     CHAINFORDECL1             90
D1  C           *IN90     IFEQ '0'
     C                     SETON                     79
D2  C           TDECBI    IFEQ *BLANK
     C                     MOVE FZB15     ZB15
     C                     MOVE FTDEC     TDECO
     C                     MOVE FPOSF     POSFO
     C                     MOVE FKDEC     KDEC
F2  C                     END
D2  C           USDEC     IFEQ 2
     C                     MOVE PRES1R    MADEC1
     C                     MOVE PRES2R    MADEC2
     C                     MOVE PRES3R    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 3
     C                     MOVE PRES1T    MADEC1
     C                     MOVE PRES2T    MADEC2
     C                     MOVE PRES3T    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 4
     C                     MOVE PRES1N    MADEC1
     C                     MOVE PRES2N    MADEC2
     C                     MOVE PRES3N    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 5
     C                     MOVE PRES1C    MADEC1
     C                     MOVE PRES2C    MADEC2
     C                     MOVE PRES3C    MADEC3
F2  C                     END
D2  C           USDEC     IFEQ 7
     C                     MOVE PRES1F    MADEC1
     C                     MOVE PRES2F    MADEC2
     C                     MOVE PRES3F    MADEC3
F2  C                     END
D2  C           MADEC1    IFEQ '00'
     C                     MOVE '  '      MADEC1
F2  C                     END
D2  C           MADEC2    IFEQ '00'
     C                     MOVE '  '      MADEC2
F2  C                     END
D2  C           MADEC3    IFEQ '00'
     C                     MOVE '  '      MADEC3
F2  C                     END
F1  C                     END
    C*
     C           GFRA      COMP *BLANKS                  84
    C* N84      GFRA      COMP 'GD'                     84SD 1267642
     C           USINE     COMP 3                    8383
     C                     MOVE *BLANKS   NOMUSI
     C                     MOVE USINE     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               80
     C                     MOVELPXLIBE    NOMUSI
     C                     SETON                     82
    C*
    C*          CCOL      IFEQ 6
    C*          COUI3     ANDEQ1
    C*                    MOVELMESS,61   LONDCC
    C*                    ELSE
     C                     MOVELMESS,60   LONDCC
    C*                    END
     *
     C                     MOVE *IN70     SV70    1
D1  C           OCOMEI    IFEQ 'EI'
     C                     MOVE '1'       *IN70
X1  C                     ELSE
     C                     MOVE '0'       *IN70
F1  C                     END
     *
    C                     ENDSR
     C/SPACE 5
     ** VALIDATION DU FORMAT 08 **
    C           VALF08    BEGSR
     C                     MOVE *IN50     SV50    1
     C                     Z-ADDUYEAR     ANMAJ
     C                     Z-ADDUMONTH    MMMAJ
     C                     Z-ADDUDAY      JJMAJ
     C                     MOVEL'XPOOLMAC'TBLNOM
     C                     Z-ADD1         TBNSEG
    C*
D1  C           FAIME     IFNE *ZEROS
     C                     Z-ADDUSEXT     USZ
     C                     MOVE FAIME     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USEXT     XPOOA1
D2  C           MAIME1    IFNE *ZEROS
     C                     MOVE MAIME1    NOMAC
     C           CLEMAC    CHAINMACHIN               30
     C  N30      ANNMAC    COMP *BLANK               3030
     C   30                MOVELXPOOKE    TBVARG
     C   30      KTBA01    CHAINXTBASE01             30
     * OFFSET 3B
D3  C           TIMP3     IFEQ 4
    C           ZTCO35    ANDGT'0'
D4  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F4  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSEXT     OUCOEP
     C                     MOVE NOMAC     OMACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLEPAR    SETLLPARAME
     C           CLEPAR    READEPARAME                   50
    C           *IN50     CABEQ'1'       RIEN3
D4  C           *IN50     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ZTCO35    YYY1    1
    C           ZZZ1      CABEQYYY1                     50
     C  N50      CLEPAR    READEPARAME                   50
F4  C                     END
D4  C           ZZZ1      IFNE YYY1
     C           RIEN3     TAG
     C                     MOVE '1'       *IN30
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           OGE3P1    IFGT 0
     C                     MOVE '1'       *IN30
F3  C                     END
F2  C                     END
D2  C           MAIME2    IFNE *ZEROS
     C                     MOVE MAIME2    NOMAC
     C           CLEMAC    CHAINMACHIN               31
     C  N31      ANNMAC    COMP *BLANK               3131
     C   31                MOVELXPOOKE    TBVARG
     C   31      KTBA01    CHAINXTBASE01             31
X2  C                     ELSE
D3  C           OGE3P2    IFGT 0
    C           OTG3P     OREQ 'X'
     C                     MOVE '1'       *IN31
F3  C                     END
F2  C                     END
D2  C           MAIME3    IFNE *ZEROS
     C                     MOVE MAIME3    NOMAC
     C           CLEMAC    CHAINMACHIN               32
     C  N32      ANNMAC    COMP *BLANK               3232
     C   32                MOVELXPOOKE    TBVARG
     C   32      KTBA01    CHAINXTBASE01             32
X2  C                     ELSE
D3  C           OGE3P3    IFGT 0
    C           OGE3P2    ORGT 0
    C           OTG3P     ANDEQ'X'
     C                     MOVE '1'       *IN32
F3  C                     END
F2  C                     END
D2  C           MAIME4    IFNE *ZEROS
     C                     MOVE MAIME4    NOMAC
     C           CLEMAC    CHAINMACHIN               33
     C  N33      ANNMAC    COMP *BLANK               3333
     C   33                MOVELXPOOKE    TBVARG
     C   33      KTBA01    CHAINXTBASE01             33
X2  C                     ELSE
D3  C           OGE3P3    IFGT 0
    C           OTG3P     ANDEQ'X'
     C                     MOVE '1'       *IN33
F3  C                     END
F2  C                     END
D2  C           MAIME5    IFNE *ZEROS
     C                     MOVE MAIME5    NOMAC
     C           CLEMAC    CHAINMACHIN               34
     C  N34      ANNMAC    COMP *BLANK               3434
     C   34                MOVELXPOOKE    TBVARG
     C   34      KTBA01    CHAINXTBASE01             34
F2  C                     END
F1  C                     END
    C*
D1  C           FAIMI     IFNE *ZEROS
     C                     Z-ADDUSINT     USZ
     C                     MOVE FAIMI     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USINT     XPOOA1
D2  C           MAIMI1    IFNE *ZEROS
     C                     MOVE MAIMI1    NOMAC
     C           CLEMAC    CHAINMACHIN               35
     C  N35      ANNMAC    COMP *BLANK               3535
     C   35                MOVELXPOOKE    TBVARG
     C   35      KTBA01    CHAINXTBASE01             35
     * OFFSET 3B
D3  C           TIMP5     IFEQ 4
    C           ZTCO35    ANDGT'0'
D4  C           NOMAC     IFGE '60'                       POOL PAS MACHINE
     C                     MOVELTBVRES    XPOOS1
     C                     MOVE XPOO01    NOMAC
F4  C                     END
     C                     MOVEL'OFMP'    PXARGU
     C                     Z-ADDUSINT     OUCOEP
     C                     MOVE NOMAC     OMACEP
     C                     MOVE OUMEP     PXVALE    P
     C           CLEPAR    SETLLPARAME
     C           CLEPAR    READEPARAME                   50
    C           *IN50     CABEQ'1'       RIENI
D4  C           *IN50     DOWEQ'0'
     C                     Z-ADDPXMONT    ZZ1     10
     C                     MOVE ZZ1       ZZZ1    1
     C                     MOVE ZTCO35    YYY1    1
    C           ZZZ1      CABEQYYY1                     50
     C  N50      CLEPAR    READEPARAME                   50
F4  C                     END
D4  C           ZZZ1      IFNE YYY1
     C           RIENI     TAG
     C                     MOVE '1'       *IN35
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           OGE5P1    IFGT 0
     C                     MOVE '1'       *IN35
F3  C                     END
F2  C                     END
D2  C           MAIMI2    IFNE *ZEROS
     C                     MOVE MAIMI2    NOMAC
     C           CLEMAC    CHAINMACHIN               36
     C  N36      ANNMAC    COMP *BLANK               3636
     C   36                MOVELXPOOKE    TBVARG
     C   36      KTBA01    CHAINXTBASE01             36
X2  C                     ELSE
D3  C           OGE5P2    IFGT 0
    C           OGE5P1    ORGT 0
    C           OTG5P     ANDEQ'X'
     C                     MOVE '1'       *IN36
F3  C                     END
F2  C                     END
D2  C           MAIMI3    IFNE *ZEROS
     C                     MOVE MAIMI3    NOMAC
     C           CLEMAC    CHAINMACHIN               37
     C  N37      ANNMAC    COMP *BLANK               3737
     C   37                MOVELXPOOKE    TBVARG
     C   37      KTBA01    CHAINXTBASE01             37
X2  C                     ELSE
D3  C           OGE5P3    IFGT 0
    C           OGE5P2    ORGT 0
    C           OTG5P     ANDEQ'X'
     C                     MOVE '1'       *IN37
F3  C                     END
F2  C                     END
D2  C           MAIMI4    IFNE *ZEROS
     C                     MOVE MAIMI4    NOMAC
     C           CLEMAC    CHAINMACHIN               38
     C  N38      ANNMAC    COMP *BLANK               3838
     C   38                MOVELXPOOKE    TBVARG
     C   38      KTBA01    CHAINXTBASE01             38
X2  C                     ELSE
D3  C           OGE5P3    IFGT 0
    C           OTG5P     ANDEQ'X'
     C                     MOVE '1'       *IN38
F3  C                     END
F2  C                     END
D2  C           MAIMI5    IFNE *ZEROS
     C                     MOVE MAIMI5    NOMAC
     C           CLEMAC    CHAINMACHIN               39
     C  N39      ANNMAC    COMP *BLANK               3939
     C   39                MOVELXPOOKE    TBVARG
     C   39      KTBA01    CHAINXTBASE01             39
F2  C                     END
F1  C                     END
     C                     MOVE SV50      *IN50
    C*
D1  C           FATYE     IFNE *ZEROS
     C                     Z-ADDUSEXT     USZ
     C                     MOVE FATYE     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USEXT     XPOOA1
D2  C           MATYE1    IFNE *ZEROS
     C                     MOVE MATYE1    NOMAC
     C           CLEMAC    CHAINMACHIN               40
     C  N40      ANNMAC    COMP *BLANK               4040
     C   40                MOVELXPOOKE    TBVARG
     C   40      KTBA01    CHAINXTBASE01             40
F2  C                     END
D2  C           MATYE2    IFNE *ZEROS
     C                     MOVE MATYE2    NOMAC
     C           CLEMAC    CHAINMACHIN               41
     C  N41      ANNMAC    COMP *BLANK               4141
     C   41                MOVELXPOOKE    TBVARG
     C   41      KTBA01    CHAINXTBASE01             41
F2  C                     END
D2  C           MATYE3    IFNE *ZEROS
     C                     MOVE MATYE3    NOMAC
     C           CLEMAC    CHAINMACHIN               42
     C  N42      ANNMAC    COMP *BLANK               4242
     C   42                MOVELXPOOKE    TBVARG
     C   42      KTBA01    CHAINXTBASE01             42
F2  C                     END
F1  C                     END
    C*
D1  C           FATYI     IFNE *ZEROS
     C                     Z-ADDUSINT     USZ
     C                     MOVE FATYI     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USINT     XPOOA1
D2  C           MATYI1    IFNE *ZEROS
     C                     MOVE MATYI1    NOMAC
     C           CLEMAC    CHAINMACHIN               43
     C  N43      ANNMAC    COMP *BLANK               4343
     C   43                MOVELXPOOKE    TBVARG
     C   43      KTBA01    CHAINXTBASE01             43
F2  C                     END
D2  C           MATYI2    IFNE *ZEROS
     C                     MOVE MATYI2    NOMAC
     C           CLEMAC    CHAINMACHIN               44
     C  N44      ANNMAC    COMP *BLANK               4444
     C   44                MOVELXPOOKE    TBVARG
     C   44      KTBA01    CHAINXTBASE01             44
F2  C                     END
D2  C           MATYI3    IFNE *ZEROS
     C                     MOVE MATYI3    NOMAC
     C           CLEMAC    CHAINMACHIN               45
     C  N45      ANNMAC    COMP *BLANK               4545
     C   45                MOVELXPOOKE    TBVARG
     C   45      KTBA01    CHAINXTBASE01             45
F2  C                     END
F1  C                     END
    C*
D1  C           FAOND     IFNE *ZEROS
     C                     Z-ADDUSOND     USZ
     C                     MOVE FAOND     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USOND     XPOOA1
D2  C           MAOND1    IFNE *ZEROS
     C                     MOVE MAOND1    NOMAC
     C           CLEMAC    CHAINMACHIN               46
     C  N46      ANNMAC    COMP *BLANK               4646
     C   46                MOVELXPOOKE    TBVARG
     C   46      KTBA01    CHAINXTBASE01             46
F2  C                     END
D2  C           MAOND2    IFNE *ZEROS
     C                     MOVE MAOND2    NOMAC
     C           CLEMAC    CHAINMACHIN               47
     C  N47      ANNMAC    COMP *BLANK               4747
     C   47                MOVELXPOOKE    TBVARG
     C   47      KTBA01    CHAINXTBASE01             47
F2  C                     END
D2  C           MAOND3    IFNE *ZEROS
     C                     MOVE MAOND3    NOMAC
     C           CLEMAC    CHAINMACHIN               48
     C  N48      ANNMAC    COMP *BLANK               4848
     C   48                MOVELXPOOKE    TBVARG
     C   48      KTBA01    CHAINXTBASE01             48
F2  C                     END
    C* Ondulation Toury machine 14
D2  C           SECT      IFEQ '2'
    C           SSECT     ANDEQ'1'
    C           USOND     ANDEQ3
D3  C           COTAPE    IFNE *BLANK
    C           COSESA    ORNE *BLANK
    C           FACON     OREQ 1
    C           FACON     OREQ 2
D4  C           MAOND1    IFEQ 14
     C                     SETON                     25
F4  C                     END
D4  C           MAOND2    IFEQ 14
     C                     SETON                     26
F4  C                     END
D4  C           MAOND3    IFEQ 14
     C                     SETON                     27
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           FACOL     IFNE *ZEROS
     C                     Z-ADDUSCOL     USZ
     C                     MOVE FACOL     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USCOL     XPOOA1
D2  C           MACOL1    IFNE *ZEROS
     C                     MOVE MACOL1    NOMAC
     C           CLEMAC    CHAINMACHIN               49
     C  N49      ANNMAC    COMP *BLANK               4949
     C   49                MOVELXPOOKE    TBVARG
     C   49      KTBA01    CHAINXTBASE01             49
F2  C                     END
D2  C           MACOL2    IFNE *ZEROS
     C                     MOVE MACOL2    NOMAC
     C           CLEMAC    CHAINMACHIN               50
     C  N50      ANNMAC    COMP *BLANK               5050
     C   50                MOVELXPOOKE    TBVARG
     C   50      KTBA01    CHAINXTBASE01             50
F2  C                     END
D2  C           MACOL3    IFNE *ZEROS
     C                     MOVE MACOL3    NOMAC
     C           CLEMAC    CHAINMACHIN               51
     C  N51      ANNMAC    COMP *BLANK               5151
     C   51                MOVELXPOOKE    TBVARG
     C   51      KTBA01    CHAINXTBASE01             51
F2  C                     END
F1  C                     END
    C*
D1  C           FADEC     IFNE *ZEROS
     C                     Z-ADDUSDEC     USZ
     C                     MOVE FADEC     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USDEC     XPOOA1
D2  C           MADEC1    IFNE *BLANKS
     C                     MOVE MADEC1    NOMAC
     C           CLEMAC    CHAINMACHIN               52
     C  N52      ANNMAC    COMP *BLANK               5252
     C   52                MOVELXPOOKE    TBVARG
     C   52      KTBA01    CHAINXTBASE01             52
F2  C                     END
D2  C           MADEC2    IFNE *BLANKS
     C                     MOVE MADEC2    NOMAC
     C           CLEMAC    CHAINMACHIN               53
     C  N53      ANNMAC    COMP *BLANK               5353
     C   53                MOVELXPOOKE    TBVARG
     C   53      KTBA01    CHAINXTBASE01             53
F2  C                     END
D2  C           MADEC3    IFNE *BLANKS
     C                     MOVE MADEC3    NOMAC
     C           CLEMAC    CHAINMACHIN               54
     C  N54      ANNMAC    COMP *BLANK               5454
     C   54                MOVELXPOOKE    TBVARG
     C   54      KTBA01    CHAINXTBASE01             54
F2  C                     END
F1  C                     END
    C*
D1  C           FAAUT     IFNE *ZEROS
     C                     Z-ADDUSAUT     USZ
     C                     MOVE FAAUT     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USAUT     XPOOA1
D2  C           MAAUT1    IFNE *ZEROS
     C                     MOVE MAAUT1    NOMAC
     C           CLEMAC    CHAINMACHIN               55
     C  N55      ANNMAC    COMP *BLANK               5555
     C   55                MOVELXPOOKE    TBVARG
     C   55      KTBA01    CHAINXTBASE01             55
F2  C                     END
D2  C           MAAUT2    IFNE *ZEROS
     C                     MOVE MAAUT2    NOMAC
     C           CLEMAC    CHAINMACHIN               56
     C  N56      ANNMAC    COMP *BLANK               5656
     C   56                MOVELXPOOKE    TBVARG
     C   56      KTBA01    CHAINXTBASE01             56
F2  C                     END
D2  C           MAAUT3    IFNE *ZEROS
     C                     MOVE MAAUT3    NOMAC
     C           CLEMAC    CHAINMACHIN               57
     C  N57      ANNMAC    COMP *BLANK               5757
     C   57                MOVELXPOOKE    TBVARG
     C   57      KTBA01    CHAINXTBASE01             57
F2  C                     END
F1  C                     END
    C*
D1  C           FAFEN     IFNE *ZEROS
     C                     Z-ADDUSFEN     USZ
     C                     MOVE FAFEN     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USFEN     XPOOA1
D2  C           MAFEN1    IFNE *ZEROS
     C                     MOVE MAFEN1    NOMAC
     C           CLEMAC    CHAINMACHIN               58
     C  N58      ANNMAC    COMP *BLANK               5858
     C   58                MOVELXPOOKE    TBVARG
     C   58      KTBA01    CHAINXTBASE01             58
F2  C                     END
D2  C           MAFEN2    IFNE *ZEROS
     C                     MOVE MAFEN2    NOMAC
     C           CLEMAC    CHAINMACHIN               59
     C  N59      ANNMAC    COMP *BLANK               5959
     C   59                MOVELXPOOKE    TBVARG
     C   59      KTBA01    CHAINXTBASE01             59
F2  C                     END
D2  C           MAFEN3    IFNE *ZEROS
     C                     MOVE MAFEN3    NOMAC
     C           CLEMAC    CHAINMACHIN               60
     C  N60      ANNMAC    COMP *BLANK               6060
     C   60                MOVELXPOOKE    TBVARG
     C   60      KTBA01    CHAINXTBASE01             60
F2  C                     END
F1  C                     END
    C*
D1  C           FAAS1     IFNE *ZEROS
     C                     Z-ADDUSAS1     USZ
     C                     MOVE FAAS1     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USAS1     XPOOA1
D2  C           MAAS11    IFNE *ZEROS
     C                     MOVE MAAS11    NOMAC
     C           CLEMAC    CHAINMACHIN               61
     C  N61      ANNMAC    COMP *BLANK               6161
     C   61                MOVELXPOOKE    TBVARG
     C   61      KTBA01    CHAINXTBASE01             61
F2  C                     END
D2  C           MAAS12    IFNE *ZEROS
     C                     MOVE MAAS12    NOMAC
     C           CLEMAC    CHAINMACHIN               62
     C  N62      ANNMAC    COMP *BLANK               6262
     C   62                MOVELXPOOKE    TBVARG
     C   62      KTBA01    CHAINXTBASE01             62
F2  C                     END
D2  C           MAAS13    IFNE *ZEROS
     C                     MOVE MAAS13    NOMAC
     C           CLEMAC    CHAINMACHIN               63
     C  N63      ANNMAC    COMP *BLANK               6363
     C   63                MOVELXPOOKE    TBVARG
     C   63      KTBA01    CHAINXTBASE01             63
F2  C                     END
F1  C                     END
    C*
D1  C           FAAS2     IFNE *ZEROS
     C                     Z-ADDUSAS2     USZ
     C                     MOVE FAAS2     ZZ2     2
     C                     MOVELZZ2       SECT
     C                     MOVE ZZ2       SSECT
     C                     MOVE USAS2     XPOOA1
D2  C           MAAS21    IFNE *ZEROS
     C                     MOVE MAAS21    NOMAC
     C           CLEMAC    CHAINMACHIN               64
     C   64                MOVE '2'       SSECT
     C   64      CLEMAC    CHAINMACHIN               64
     C  N64      ANNMAC    COMP *BLANK               6464
     C   64                MOVELXPOOKE    TBVARG
     C   64      KTBA01    CHAINXTBASE01             64
F2  C                     END
D2  C           MAAS22    IFNE *ZEROS
     C                     MOVE ZZ2       SSECT
     C                     MOVE MAAS22    NOMAC
     C           CLEMAC    CHAINMACHIN               65
     C   65                MOVE '2'       SSECT
     C   65      CLEMAC    CHAINMACHIN               65
     C  N65      ANNMAC    COMP *BLANK               6565
     C   65                MOVELXPOOKE    TBVARG
     C   65      KTBA01    CHAINXTBASE01             65
F2  C                     END
D2  C           MAAS23    IFNE *ZEROS
     C                     MOVE ZZ2       SSECT
     C                     MOVE MAAS23    NOMAC
     C           CLEMAC    CHAINMACHIN               66
     C   66                MOVE '2'       SSECT
     C   66      CLEMAC    CHAINMACHIN               66
     C  N66      ANNMAC    COMP *BLANK               6666
     C   66                MOVELXPOOKE    TBVARG
     C   66      KTBA01    CHAINXTBASE01             66
F2  C                     END
F1  C                     END
    C*
D1  C           30        DO   66        I       20
     C           *IN,I     COMP '1'                      90
F1  C  N90                END
    C* Ondulation Toury machine 14
     C  N90      *IN25     COMP '1'                      90
     C  N90      *IN26     COMP '1'                      90
     C  N90      *IN27     COMP '1'                      90
     *
     C                     Z-ADD*ZERO     USF1    10
     C                     Z-ADD*ZERO     USF2    10
D1  C           USAS2     IFNE *ZERO
     C                     Z-ADDUSAS2     USF1
D2  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F2  C                     END
F1  C                     END
D1  C           USAS1     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSAS1     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USFEN     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSFEN     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USAUT     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSAUT     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USDEC     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSDEC     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USCOL     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSCOL     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           USOND     IFNE *ZERO
D2  C           USF1      IFEQ *ZERO
     C                     Z-ADDUSOND     USF1
D3  C           USF1      IFNE USINE
     C                     SETON                     9069
    C                     GOTO VF081
F3  C                     END
F2  C                     END
F1  C                     END
     *
    C           VF081     ENDSR
     C/SPACE 5
     **  UPDATE PRODUITS ** FORMAT A FORMAT **
    C           ECRIT     BEGSR
D1  C           IN68      IFEQ '1'
     C                     Z-ADD0         W       10
D2  C                     DO   7         W
D3  C           IMP,W     IFEQ 'STOCKE'
D4  C           W         IFEQ 1
     C                     MOVE *BLANK    COUL1
    C*                    MOVE *BLANK    COUP1
F4  C                     END
D4  C           W         IFEQ 2
     C                     MOVE *BLANK    COUL2
     C                     MOVE *BLANK    COUP2
F4  C                     END
D4  C           W         IFEQ 3
     C                     MOVE *BLANK    COUL3
     C                     MOVE *BLANK    COUP3
F4  C                     END
D4  C           W         IFEQ 4
     C                     MOVE *BLANK    COUL4
     C                     MOVE *BLANK    COUP4
F4  C                     END
D4  C           W         IFEQ 5
     C                     MOVE *BLANK    COUL5
     C                     MOVE *BLANK    COUP5
F4  C                     END
D4  C           W         IFEQ 6
     C                     MOVE *BLANK    COUL6
     C                     MOVE *BLANK    COUP6
F4  C                     END
D4  C           W         IFEQ 7
     C                     MOVE *BLANK    COUL7
     C                     MOVE *BLANK    COUP7
F4  C                     END
F3  C                     END
F2  C                     END
    C*
F1  C                     END
     C                     MOVE '0'       IN68
D1  C           TYPPO1    IFEQ 'R'
     C                     MOVE RINAL     TYPPO2
F1  C                     END
D1  C           TYPPO1    IFEQ 'P'
D2  C           COAS1     IFEQ 31
    C           COAS1     OREQ 33
     C                     MOVE COLA1     TYPPO2
X2  C                     ELSE
     C                     MOVE COLA2     TYPPO2
F2  C                     END
F1  C                     END
    C*
     C                     UPDATPRODUIF1
     C                     UPDATPRODSTF1
    C*
D1  C           MAJ59     IFEQ '*'
D2  C           STCTDF    IFEQ 'A'
    C           STCTDE    OREQ 'A'
    C           STCTDI    OREQ 'A'
    C           STCOD4    OREQ 'A'
     C                     Z-ADDNOCLI     CL59
     C                     Z-ADDNOPRO     PR59
     C                     MOVE *BLANKS   BL59
     C                     CALL 'DEV059£'
     C                     PARM           DEV059
F2  C                     END
F1  C                     END
    C*
D1  C           CSV       IFEQ '*'
     C                     Z-ADDNOCLI     CL19
     C                     Z-ADDNOPRO     PR19
     C                     MOVE *BLANKS   BL19
     C                     CALL 'DEV019£'
     C                     PARM           DEV019
     C                     MOVE *BLANKS   CSV
F1  C                     END
     *
     * FORMATAGE DE INDPCL POUR SITE WEB
     * TROUVÉ DANS INDP OU TROUVÉ DANS CLILOGL5
     C                     MOVELINDPCL    INDP19 19
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'INDP'    PXARGU
     C                     MOVE NOCLI     PXVALE
     C           CLEPAR    CHAINPARAME               33
D1  C           *IN33     IFEQ '1'
     C           CLECLI    SETLLCLILOGL5                 33
D2  C           *IN33     IFEQ '1'
     C                     MOVE '0'       *IN33
X2  C                     ELSE
     C                     MOVE '1'       *IN33
F2  C                     END
F1  C                     END
     *
D1  C           *IN33     IFEQ '0'
    C           INDP19    ANDEQ*BLANK
     C                     MOVELNOCLI     Z94£    8
     C                     MOVE NOPRO     Z94£    8
     C                     CALL 'PROD94£'
     C                     PARM           Z94£
F1  C                     END
    C*
D1  C           FST       IFEQ ' '
     C           CLECLE    CHAINPRODUI2              80
     C           CLECLE    CHAINPRODST2              80
D2  C           MAJ59     IFEQ '*'
     C                     MOVE CLIE3     AFFL1
     C                     MOVE CLII3     AFFD1
     C                     MOVE CLIE2     AFFL2
     C                     MOVE CLII2     AFFD2
F2  C                     END
F1  C                     END
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     ** FIN DE L'ENCHAINEMENT DES FORMATS ****************************
     *****************************************************************
     C/SPACE 5
     * PRE-TRAITEMENT FORMAT2
    C           PREF02    BEGSR
     *
     * PREIMPRIME STOCKE
     C                     SETOF                     353738  RECHERCHE DU
     C                     SETOF                     394041 OU DES PRE-
     C                     SETOF                     424344 IMPRIME STOCKE
     C                     SETOF                     6890
     C                     MOVE '1'       IN68             IMP CHARGE
     C                     MOVE *BLANKS   IMP
     C                     MOVE *ZEROS    FA
     C                     MOVE *BLANKS   TIMP1A
     C                     MOVE *BLANKS   TIMP2A
     C                     MOVE *BLANKS   TIMP3A
     C                     MOVE *BLANKS   TIMP4A
     C                     MOVE *BLANKS   TIMP5A
     C                     MOVE *BLANKS   TIMP6A
     C                     MOVE *BLANKS   TIMP7A
     C                     MOVE *BLANKS   LIBTP
     *
     C                     MOVE 'TOND'    PXARGU
     C                     MOVELSIDD      PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXLIBE    LIBTP
D1  C           PAPI2     IFEQ 'XXX'
    C           GRAM2     ANDEQ999
    C           PAPI6     OREQ 'XXX'
    C           GRAM6     ANDEQ999
     C                     MOVEL'Simple'  LIBTP
F1  C                     END
     *
     C                     Z-ADD*ZERO     XXPP    10
     C                     SETON                     34
     C                     MOVE PAPI1     PAPI    3         1ER SUPPORT
     C                     MOVE GRAM1     GRAM    30
     C                     MOVE FORL1     FORLL   40
     C                     MOVE FORH1     FORHH   40
     C                     MOVE LAIZ1     LAIZZ   3
     C                     Z-ADD1         XXPPXX  10
     C                     EXSR STOCKE
D1  C           *IN35     IFEQ '0'
    C           FORL1     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI1     PAPI58
     C                     Z-ADDGRAM1     GRAM58
     C                     MOVE ADPAP1    REFO58
     C                     Z-ADDADGRA1    GRAR58
     C                     Z-ADDFORL1     FML     40
     C                     Z-ADDFORH1     FMH     40
     C                     Z-ADD1         XXPP
F1  C                     END
     C         35          SETON                     38
     C   35                MOVE FORLL     FORL1
     C   35                MOVE FORHH     FORH1
     C   35                MOVE COULSB    COUL1B
    C*  35                MOVE COUPS     COUP1
    C         35          GOTO YUITE2
     *
     C                     MOVE PAPI2     PAPI              2EME SUPPORT
     C                     MOVE GRAM2     GRAM
     C                     MOVE FORL2     FORLL
     C                     MOVE FORH2     FORHH
     C                     MOVE LAIZ2     LAIZZ
     C                     Z-ADD2         XXPPXX
     C                     EXSR STOCKE
D1  C           *IN35     IFEQ '0'
    C           FORL2     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI2     PAPI58
     C                     Z-ADDGRAM2     GRAM58
     C                     MOVE ADPAP2    REFO58
     C                     Z-ADDADGRA2    GRAR58
     C                     Z-ADDFORL2     FML
     C                     Z-ADDFORH2     FMH
     C                     Z-ADD2         XXPP
F1  C                     END
     C         35          SETON                     39
     C   35                MOVE FORLL     FORL2
     C   35                MOVE FORHH     FORH2
     C   35                MOVE COULSB    COUL2B
     C   35                MOVE COUPS     COUP2
    C         35          GOTO YUITE2
     *
     C                     MOVE PAPI3     PAPI              3EME SUPPORT
     C                     MOVE GRAM3     GRAM
     C                     MOVE FORL3     FORLL
     C                     MOVE FORH3     FORHH
     C                     MOVE LAIZ3     LAIZZ
     C                     Z-ADD3         XXPPXX
     C                     EXSR STOCKE
D1  C           *IN35     IFEQ '0'
    C           FORL3     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI3     PAPI58
     C                     Z-ADDGRAM3     GRAM58
     C                     MOVE ADPAP3    REFO58
     C                     Z-ADDADGRA3    GRAR58
     C                     Z-ADDFORL3     FML
     C                     Z-ADDFORH3     FMH
     C                     Z-ADD3         XXPP
F1  C                     END
     C         35          SETON                     40
     C   35                MOVE FORLL     FORL3
     C   35                MOVE FORHH     FORH3
     C   35                MOVE COULSB    COUL3B
     C   35                MOVE COUPS     COUP3
     C           YUITE2    TAG
     C                     SETOF                     34
     *
     C                     SETON                     36
     C                     MOVE PAPI4     PAPI              4EME SUPPORT
     C                     MOVE GRAM4     GRAM
     C                     MOVE FORL4     FORLL
     C                     MOVE FORH4     FORHH
     C                     MOVE LAIZ4     LAIZZ
     C                     Z-ADD4         XXPPXX
     C                     EXSR STOCKE
D1  C           *IN37     IFEQ '0'
    C           FORL4     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI4     PAPI58
     C                     Z-ADDGRAM4     GRAM58
     C                     MOVE ADPAP4    REFO58
     C                     Z-ADDADGRA4    GRAR58
     C                     Z-ADDFORL4     FML
     C                     Z-ADDFORH4     FMH
     C                     Z-ADD4         XXPP
F1  C                     END
     C         37          SETON                     41
     C   37                MOVE FORLL     FORL4
     C   37                MOVE FORHH     FORH4
     C   37                MOVE COULSB    COUL4B
     C   37                MOVE COUPS     COUP4
    C         37          GOTO YUITE3
     *
     C                     MOVE PAPI5     PAPI              5EME SUPPORT
     C                     MOVE GRAM5     GRAM
     C                     MOVE FORL5     FORLL
     C                     MOVE FORH5     FORHH
     C                     MOVE LAIZ5     LAIZZ
     C                     Z-ADD5         XXPPXX
     C                     EXSR STOCKE
D1  C           *IN37     IFEQ '0'
    C           FORL5     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI5     PAPI58
     C                     Z-ADDGRAM5     GRAM58
     C                     MOVE ADPAP5    REFO58
     C                     Z-ADDADGRA5    GRAR58
     C                     Z-ADDFORL5     FML
     C                     Z-ADDFORH5     FMH
     C                     Z-ADD5         XXPP
F1  C                     END
     C         37          SETON                     42
     C   37                MOVE FORLL     FORL5
     C   37                MOVE FORHH     FORH5
     C   37                MOVE COULSB    COUL5B
     C   37                MOVE COUPS     COUP5
    C         37          GOTO YUITE3
     *
     C                     MOVE PAPI6     PAPI              6EME SUPPORT
     C                     MOVE GRAM6     GRAM
     C                     MOVE FORL6     FORLL
     C                     MOVE FORH6     FORHH
     C                     MOVE LAIZ6     LAIZZ
     C                     Z-ADD6         XXPPXX
     C                     EXSR STOCKE
D1  C           *IN37     IFEQ '0'
    C           FORL6     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI6     PAPI58
     C                     Z-ADDGRAM6     GRAM58
     C                     MOVE ADPAP6    REFO58
     C                     Z-ADDADGRA6    GRAR58
     C                     Z-ADDFORL6     FML
     C                     Z-ADDFORH6     FMH
     C                     Z-ADD6         XXPP
F1  C                     END
     C         37          SETON                     43
     C   37                MOVE FORLL     FORL6
     C   37                MOVE FORHH     FORH6
     C   37                MOVE COULSB    COUL6B
     C   37                MOVE COUPS     COUP6
    C         37          GOTO YUITE3
     *
     C                     MOVE PAPI7     PAPI              7EME SUPPORT
     C                     MOVE GRAM7     GRAM
     C                     MOVE FORL7     FORLL
     C                     MOVE FORH7     FORHH
     C                     MOVE LAIZ7     LAIZZ
     C                     Z-ADD7         XXPPXX  10
     C                     EXSR STOCKE
D1  C           *IN37     IFEQ '0'
    C           FORL7     ANDNE*ZEROS
    C           *IN90     ANDEQ'0'
     C                     SETON                     9068
     C                     MOVE PAPI7     PAPI58
     C                     Z-ADDGRAM7     GRAM58
     C                     MOVE ADPAP7    REFO58
     C                     Z-ADDADGRA7    GRAR58
     C                     Z-ADDFORL7     FML
     C                     Z-ADDFORH7     FMH
     C                     Z-ADD7         XXPP
F1  C                     END
     C         37          SETON                     44
     C   37                MOVE FORLL     FORL7
     C   37                MOVE FORHH     FORH7
     C   37                MOVE COULSB    COUL7B
     C   37                MOVE COUPS     COUP7
     C           YUITE3    TAG
     **
     C   35 38             MOVE *BLANKS   PAPI1
     C   35 38             MOVE *ZEROS    GRAM1
     C   35 38             MOVE *BLANKS   LAIZ1
     C   35 38             MOVE 'STOCKE'  IMP,1
     C   35 38             MOVE 'STOCKE'  TIMP1A
     C   35 39             MOVE *BLANKS   PAPI2
     C   35 39             MOVE *ZEROS    GRAM2
     C   35 39             MOVE *BLANKS   LAIZ2
     C   35 39             MOVE 'STOCKE'  IMP,2
     C   35 39             MOVE 'STOCKE'  TIMP2A
     C   35 40             MOVE *BLANKS   PAPI3
     C   35 40             MOVE *ZEROS    GRAM3
     C   35 40             MOVE *BLANKS   LAIZ3
     C   35 40             MOVE 'STOCKE'  IMP,3
     C   35 40             MOVE 'STOCKE'  TIMP3A
     C   37 41             MOVE *BLANKS   PAPI4
     C   37 41             MOVE *ZEROS    GRAM4
     C   37 41             MOVE *BLANKS   LAIZ4
     C   37 41             MOVE 'STOCKE'  IMP,4
     C   37 41             MOVE 'STOCKE'  TIMP4A
     C   37 42             MOVE *BLANKS   PAPI5
     C   37 42             MOVE *ZEROS    GRAM5
     C   37 42             MOVE *BLANKS   LAIZ5
     C   37 42             MOVE 'STOCKE'  IMP,5
     C   37 42             MOVE 'STOCKE'  TIMP5A
     C   37 43             MOVE *BLANKS   PAPI6
     C   37 43             MOVE *ZEROS    GRAM6
     C   37 43             MOVE *BLANKS   LAIZ6
     C   37 43             MOVE 'STOCKE'  IMP,6
     C   37 43             MOVE 'STOCKE'  TIMP6A
     C   37 44             MOVE *BLANKS   PAPI7
     C   37 44             MOVE *ZEROS    GRAM7
     C   37 44             MOVE *BLANKS   LAIZ7
     C   37 44             MOVE 'STOCKE'  IMP,7
     C   37 44             MOVE 'STOCKE'  TIMP7A
     *
     C                     SETOF                     343638
     C                     SETOF                     394041
     C                     SETOF                     424344            CKE
     C                     SETOF                     90
     **
     C                     MOVE 'IMPR'    PXARGU
D1  C           *IN35     IFEQ '0'
D2  C           *IN01     IFEQ '1'
    C           PAPI1     ANDNE*BLANKS
    C           TIMP1     ANDNE*ZEROS
     C                     MOVE TIMP1     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,1
     C                     MOVELPXABRG    TIMP1A
D3  C           TIMP1     IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,1
     C                     MOVEL'GENCO   'TIMP1A
F3  C                     END
F2  C                     END
D2  C           *IN02     IFEQ '1'
    C           PAPI2     ANDNE*BLANKS
    C           TIMP2     ANDNE*ZEROS
     C                     MOVE TIMP2     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,2
     C                     MOVELPXABRG    TIMP2A
D3  C           TIMP2     IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,2
     C                     MOVEL'GENCO   'TIMP2A
F3  C                     END
F2  C                     END
D2  C           *IN03     IFEQ '1'
    C           PAPI3     ANDNE*BLANKS
    C           TIMP3     ANDNE*ZEROS
     C                     MOVE TIMP3     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,3
     C                     MOVELPXABRG    TIMP3A
D3  C           TIMP3     IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,3
     C                     MOVEL'GENCO   'TIMP3A
F3  C                     END
F2  C                     END
F1  C                     END
D1  C           *IN37     IFEQ '0'
D2  C           *IN04     IFEQ '1'
    C           PAPI4     ANDNE*BLANKS
    C           TIMP4     ANDNE*ZEROS
     C                     MOVE TIMP4     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,4
     C                     MOVELPXABRG    TIMP4A
D3  C           TIMP4     IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,4
     C                     MOVEL'GENCO   'TIMP4A
F3  C                     END
F2  C                     END
D2  C           *IN05     IFEQ '1'
    C           PAPI5     ANDNE*BLANKS
    C           TIMP5     ANDNE*ZEROS
     C                     MOVE TIMP5     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,5
     C                     MOVELPXABRG    TIMP5A
D3  C           TIMP5     IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,5
     C                     MOVEL'GENCO   'TIMP5A
F3  C                     END
F2  C                     END
D2  C           *IN06     IFEQ '1'
    C           PAPI6     ANDNE*BLANKS
    C           TIMP6     ANDNE*ZEROS
     C                     MOVE TIMP6     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,6
     C                     MOVELPXABRG    TIMP6A
D3  C           TIMP6     IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,6
     C                     MOVEL'GENCO   'TIMP6A
F3  C                     END
F2  C                     END
D2  C           *IN07     IFEQ '1'
    C           PAPI7     ANDNE*BLANKS
    C           TIMP7     ANDNE*ZEROS
     C                     MOVE TIMP7     PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    IMP,7
     C                     MOVELPXABRG    TIMP7A
D3  C           TIMP7     IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'IMP,7
     C                     MOVEL'GENCO   'TIMP7A
F3  C                     END
F2  C                     END
F1  C                     END
     C                     MOVE COFEN     FA,1
     C                     MOVE COAS1     FA,2
     C                     MOVE COAS2     FA,3
     C                     Z-ADDLUTIL     LUTILS  41
    C*
     C           CLECLE    SETLLLAIUTIL1                 79
    C*
     C                     EXSR PRESOF
    C*
     C                     MOVE *BLANKS   CODPT
D1  C           PTDIF     IFNE *BLANKS
     C                     MOVE '*'       CODPT
F1  C                     END
    C                     ENDSR
     ***
     *********************
     ***
    C           STOCKE    BEGSR                            MODUL COMMUN
D1  C           XXPPXX    IFGE 1
    C           XXPPXX    ANDLE3
D2  C           PAPI      IFNE *BLANKS
    C           PAPI      ANDGE'000'
    C           NIMPE1    ANDNE*BLANKS
    C           *IN35     ANDEQ'0'
     C                     MOVE NIMPE1    FORLL
     C                     MOVE NIMPE2    FORHH
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C           STOSTO    CHAINPREIMP2              80
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C   34                SETON                     35
F2  C                     END
F1  C                     END
D1  C           XXPPXX    IFGE 4
    C           XXPPXX    ANDLE7
D2  C           PAPI      IFNE *BLANKS
    C           PAPI      ANDGE'000'
    C           NIMPI1    ANDNE*BLANKS
    C           *IN37     ANDEQ'0'
     C                     MOVE NIMPI1    FORLL
     C                     MOVE NIMPI2    FORHH
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C           STOSTO    CHAINPREIMP2              80
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C   36                SETON                     37
F2  C                     END
F1  C                     END
    C                     ENDSR
     *
     ********************************************************************
     *****************************************************************
     C/SPACE 5
     **********************************DEBUT DES SOUS PROGRAMMES*********
     ** VALIDATION DU FORMAT 1   *************************************
     *
    C           VALF01    BEGSR
     *
     C                     MOVE ANDEV     ANSV    20
     C                     MOVE ETUDE     ETUSV   40
     C                     MOVE SEQDE     SEQDSV  40
     C                     SETOF                     99
     *
D1  C           INDPCL    IFEQ *BLANKS
    C           *IN33     ANDEQ'1'
     C                     MOVELMESS,42   MSGMSG
     C                     SETON                     90
    C                     GOTO PLUS31
F1  C                     END
     C           ''''      SCAN INDPCL                   90
D1  C           *IN90     IFEQ '1'
    C           *IN33     ANDEQ'1'
     C                     MOVELMESS,42   MSGMSG
    C                     GOTO PLUS31
F1  C                     END
     C                     SETOF                     90
     *
     C                     MOVE USINE     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99      PXMONT    COMP 999                      99
D1  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,4    MSGMSG
    C                     GOTO PLUS31
F1  C                     END
     *
D1  C           1         DO   5         Y
D2  C           TU,Y      IFNE ' '
     C                     MOVELTU,Y      UUU     10
D3  C           UUU       IFEQ USINE
     C                     SETON                     90
     C                     MOVELMESS,53   MSGMSG
    C                     GOTO PLUS31
F3  C                     END
     C                     MOVE TU,Y      PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99      PXMONT    COMP 999                      99
D3  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,53   MSGMSG
    C                     GOTO PLUS31
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           ZB3       IFNE *BLANKS
     C                     MOVE ZB3       PXVALE    P
     C                     MOVE 'GTYP'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,54   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           TS1       IFNE *BLANKS
     C                     MOVE TS1       PXVALE    P
D2  C           NOCLI     IFEQ 8928
     C                     MOVE 'TYPN'    PXARGU    P
X2  C                     ELSE
     C                     MOVE 'TYPC'    PXARGU    P
F2  C                     END
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,55   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
D2  C           NOCLI     IFNE 8928
    C           TS1       ANDEQ'S'
    C           STOCK5    ANDEQ0
     C                     SETON                     90
     C                     MOVELMESS,6    MSGMSG
    C                     GOTO PLUS31
F2  C                     END
D2  C           NOCLI     IFNE 8928
    C           TS1       ANDEQ'C'
    C           STOCK5    ANDEQ0
     C                     SETON                     90
     C                     MOVELMESS,6    MSGMSG
    C                     GOTO PLUS31
F2  C                     END
X1  C                     ELSE
D2  C           STOCK5    IFNE 0
     C                     SETON                     90
     C                     MOVELMESS,7    MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           NOCLI     IFEQ 8928
     C           CLELIE    SETLLCODBARL2                 99
D2  C           TS1       IFEQ 'M'
    C           *IN99     ANDEQ'0'
     C                     SETON                     90
     C                     MOVELMESS,3    MSGMSG
    C                     GOTO PLUS31
F2  C                     END
D2  C           TS1       IFNE 'M'
    C           *IN99     ANDEQ'1'
     C                     SETON                     90
     C                     MOVELMESS,5    MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           GRAP1     IFNE *BLANKS
     C                     MOVE GRAP1     PXVALE    P
     C                     MOVE 'TUTC'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,56   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           COUP1     IFNE *BLANKS
     C                     MOVE COUP1     PXVALE    P
     C                     MOVE 'TCON'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,57   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           NATE1     IFNE *BLANKS
     C                     MOVE NATE1     PXVALE    P
     C                     MOVE 'TQUA'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,58   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
D1  C           ADGRA1    IFNE *ZEROS
     C                     MOVE ADGRA1    PXVALE    P
     C                     MOVE 'TGPC'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,59   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
D2  C           ADGRA1    IFEQ 892
     C           TS1       ANDNE'N'
     C                     SETON                     90
     C                     MOVELMESS,67   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
     C                     MOVE *BLANKS   LEGAR
D1  C           GARNT     IFNE '  '
     C                     MOVELGARNT     GARNT1  1
     C           GARNT     LOKUPTGAR                     82
     C  N82                MOVELMESS,23   MSGMSG
     C  N82                SETON                     90
    C  N82                GOTO PLUS31
D2  C           GARNT1    IFNE 'M'
     C                     MOVE 'G'       LEGAR
F2  C                     END
D2  C           GARNT     IFEQ 'MD'
     C                     MOVE '*'       ZB
F2  C                     END
F1  C                     END
     *
     * TMAGPI - SD 1462390
     * SI ZONE NATMAD EST NON PROTEGE (IN10 = 0)
D1  C           *IN10     IFEQ '0'
     C           CLEFTY    CHAINFTYPOPL1             99
D2  C           *IN99     IFEQ '1'
     C                     SETON                     90
     C                     MOVELMESS,66   MSGMSG
    C                     GOTO PLUS31
F2  C                     END
F1  C                     END
     *
     *
     C           PROMO1    COMP ' '                  8282
     C           ZERO1     COMP ' '                  8383
D1  C           MICLI     IFNE 0
     C   82
     COR 83                SETON                     90
F1  C                     END
D1  C           MACLI     IFNE 0
     C   82
     COR 83                SETON                     90
F1  C                     END
     C   82 83             SETON                     90
     C   90                MOVELMESS,9    MSGMSG
    C   90                GOTO PLUS31
    C*          MICLI     IFNE 0                      JLL DE 19/11/03
    C*          MICLI     ANDLT1,00
    C*                    SETON                     90
    C*                    MOVELMESS,44   MSGMSG
    C*                    GOTO PLUS31
    C*                    END
    C*          MACLI     IFNE 0
    C*          MACLI     ANDLT1,00
    C*                    SETON                     90
    C*                    MOVELMESS,44   MSGMSG
    C*                    GOTO PLUS31
    C*                    END
     *
     C                     Z-ADD0         Y
     C                     MOVE '0'       UST
D1  C           1         DO   5         Y
D2  C                     SELEC
     C           TU,Y      WHEQ '2'
     C                     MOVE TU,Y      UST,2
     C           TU,Y      WHEQ '3'
     C                     MOVE TU,Y      UST,3
     C           TU,Y      WHEQ '4'
     C                     MOVE TU,Y      UST,4
     C           TU,Y      WHEQ '5'
     C                     MOVE TU,Y      UST,5
     C           TU,Y      WHEQ '6'
     C                     MOVE TU,Y      UST,7
F2  C                     ENDSL
F1  C                     END
     C                     MOVEAUST,1     Z9W
     C                     MOVELZ9W       STOCK6
     *
     C           PLUS31    TAG
     C                     MOVE SEQDSV    SEQDE
     C                     MOVE ANSV      ANDEV
     C                     MOVE ETUSV     ETUDE
     *
    C           FINF01    ENDSR
     C/SPACE 3
    C* CALCUL DE LA TOLERANCE
    C*------------------------
    C           POST01    BEGSR
     *
     C                     Z-ADD*ZEROS    GROUPA
     C                     MOVE *BLANKS   HOMOL
D1  C           GARNT     IFNE *BLANKS
     C                     MOVE GARNT     GARN1   1
D2  C           GARN1     IFGT '1'
     C                     MOVE GARN1     GROUPA
F2  C                     END
D2  C           GARN1     IFEQ 'H'
    C           GARN1     OREQ 'D'
     C                     MOVE GARN1     HOMOL
F2  C                     END
F1  C                     END
    C*
     C                     MOVE *BLANKS   PROTO
D1  C           PROMO1    IFEQ 'X'
     C                     MOVEL'P'       PROTO
F1  C                     END
D1  C           ZERO1     IFEQ 'X'
     C                     MOVEL'T'       PROTO
F1  C                     END
    C           PROTO     CABEQ*BLANKS   OTORP
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 2
D2  C           TIMP3     IFNE 0
     C                     MOVE '4'       PROTO
    C                     GOTO OTORP
F2  C                     END
D2  C           TIMP4     IFNE 0
     C                     MOVE '4'       PROTO
    C                     GOTO OTORP
X2  C                     ELSE
     C                     MOVE '3'       PROTO
    C                     GOTO OTORP
F2  C                     END
F1  C                     END
     C           ONDUL     COMP 0                        80
     C  N80      ONDUL     COMP 7                        80
     C  N80      CCOL      COMP 8                        80
D1  C           *IN80     IFEQ '1'
D2  C           TIMP3     IFEQ 0
     C                     MOVE '3'       PROTO
    C                     GOTO OTORP
F2  C                     END
D2  C           TIMP3     IFEQ 3
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F2  C                     END
D2  C           FACON     IFEQ 8
     C                     MOVE '1'       PROTO
    C                     GOTO OTORP
X2  C                     ELSE
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F2  C                     END
X1  C                     ELSE
D2  C           CCOL      IFEQ 9
D3  C           TIMP2     IFNE 0
    C           TIMP2     CABEQ3         OTOR1
D4  C           TIMP2     IFNE 3
D5  C           FACON     IFEQ 8
     C                     MOVE '1'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C           OTOR1     TAG
D4  C           TIMP6     IFEQ 0
D5  C           TIMP2     IFEQ 3
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
     C                     MOVE '3'       PROTO
    C                     GOTO OTORP
F5  C                     END
X4  C                     ELSE
D5  C           TIMP6     IFEQ 3
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
D6  C           FACON     IFEQ 8
     C                     MOVE '1'       PROTO
    C                     GOTO OTORP
X6  C                     ELSE
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           TIMP3     IFNE 0
    C           TIMP3     CABEQ3         OTOR2
D4  C           TIMP3     IFNE 3
D5  C           FACON     IFEQ 8
     C                     MOVE '1'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C           OTOR2     TAG
D4  C           TIMP5     IFEQ 0
D5  C           TIMP3     IFEQ 3
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
     C                     MOVE '3'       PROTO
    C                     GOTO OTORP
F5  C                     END
X4  C                     ELSE
D5  C           TIMP5     IFEQ 3
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
X5  C                     ELSE
D6  C           FACON     IFEQ 8
     C                     MOVE '1'       PROTO
    C                     GOTO OTORP
X6  C                     ELSE
     C                     MOVE '2'       PROTO
    C                     GOTO OTORP
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C           OTORP     TAG
     C/SPACE 1
     *
    C                     ENDSR
     C/SPACE 5
     ** CONTROLE VALIDATION FORMAT 1BIS * SELECTION DES SUPPORTS ********
    C           B1BIS     BEGSR
     C                     EXSR RAZ
     *
D1  C           *IN72     IFEQ '1'
    C           FACON     CABEQFACFAC    RSGEB
     C                     MOVELFACFAC    CTRFAC  20
     C                     MOVE FACON     CTRFAC
     C           CTRFAC    LOKUPTAB8      TAB88          81
D2  C           *IN81     IFEQ '0'
     C                     SETON                     90
     C                     MOVELMESS,37   MSGMSG
    C                     GOTO PLUBB
X2  C                     ELSE
D3  C           TAB88     IFEQ 'B'
     C                     Z-ADD0         COAS1
     C                     Z-ADD0         COAS2
     C                     EXSR ZERO1I                     RAZ.1ER.ASS.
     C                     EXSR ZERO1J                      "  2EME "
F3  C                     END
F2  C                     END
F1  C                     END
     C           RSGEB     TAG
     *
     C                     EXSR B1BISA
    C           PLUBB     ENDSR
     *
    C           RAZIND    BEGSR
     C                     SETOF                     010203
     C                     SETOF                     040506
     C                     SETOF                     071213
     C                     SETOF                     141516
     C                     SETOF                     919293
     C                     SETOF                     949697
     C                     SETOF                     989990
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION DU FORMAT 2  ** DEVIS *****************
     *
    C           VALF02    BEGSR
     *
     C                     EXSR RAZ
     C                     SETOF                     3537
     C                     EXSR ZERZER                     RAZ ZONES TRAV.
     C                     EXSR ZERO2
     *
D1  C           USINE     IFEQ 3
    C           COLRH     ANDEQ*BLANKS
     C                     MOVELMESS,12   MSGMSG
    C                     GOTO FINF2
F1  C                     END
D1  C           COLRH     IFEQ 'RH'
D2  C           CCOL      IFEQ 0
    C           CCOL      OREQ 8
    C           ONDUL     OREQ 7
     C                     MOVELMESS,12   MSGMSG
    C                     GOTO FINF2
F2  C                     END
F1  C                     END
     *
     C                     EXSR SUPPOR                      CONTROLE DES
    C      90             GOTO FINF2                        SUPPORTS .
     *
     C                     EXSR RAZ
     *
    C*          CCOL      IFEQ 6
    C*                    EXSR CANCRO
    C*                    GOTO FINF2
    C*                    ELSE
     *
    C*          USINE     IFEQ 5
    C*                    EXSR CCHA
    C*                    GOTO FINF2
    C*                    END
    C*                    END
     *
D1  C           CCOL      IFEQ 4                          COMPLEXE
    C           CCOL      OREQ 7
     C                     EXSR CPLX
    C                     GOTO FINF2
F1  C                     END
     *
     C           FACON     COMP 6                      8180*ORDINO.PG. H *
     C     N80N81FACON     COMP 7                        80
     C     N80N81FACON     COMP 8                    82  80
    C   80                GOTO SUIT19
    C   82                GOTO SUIT20
     C      81   FACON     COMP 4                    818280
    C   81                GOTO SUIT21
    C   82                GOTO SUIT22
    C   80                GOTO SUIT23
     *
     C           SUIT19    TAG                             *
     C                     EXSR FORM                        DEC-SUR FORME
    C                     GOTO FINF2
     C           SUIT20    TAG                             *
     C                     EXSR LUGANO                      DEC.RLX.LUGANO
    C                     GOTO FINF2
     C           SUIT21    TAG                             *
     C           CCOL      COMP 3                    808180
    C      81             GOTO SUIT20
     C         80ONDUL     COMP 7                    818180
    C      81             GOTO SUIT24
     C         80          EXSR MASSIC                      GAUFRE SUR
    C                     GOTO FINF2                         MASSICOT
     C           SUIT22    TAG                             *
     C           FACON     COMP 0                    81  80
    C      80             GOTO SUIT25
     C         81          EXSR RLXBOB                      RLX.BOB.
    C                     GOTO FINF2
     C           SUIT23    TAG                             *
     C                     EXSR DECO
    C                     GOTO FINF2                       DECOUPAGE
     C           SUIT24    TAG
     C                     EXSR DFLUG                       DF. LUGANO
    C                     GOTO FINF2                         MITRAILLEUSE
     C           SUIT25    TAG                             *
     C                     EXSR FACON0
     *
     C           FINF2     TAG
D1  C           *IN74     IFEQ '1'
D2  C           MANDLG    IFEQ *ZEROS
    C           MANDNB    ANDNE*ZEROS
    C           MANDLG    ORNE *ZEROS
    C           MANDNB    ANDEQ*ZEROS
     C                     SETON                       90
     C                     Z-ADD75        MSG
F2  C                     END
F1  C                     END
     *
D1  C           GFRA2     IFNE *BLANKS
D2  C           GFRA      IFEQ *BLANKS
     C                     SETON                       90
     C                     Z-ADD33        MSG
F2  C                     END
D2  C           GFRA      IFEQ 'GD'
    C           GFRA2     ANDEQ'GD'
     C                     SETON                       90
     C                     Z-ADD33        MSG
F2  C                     END
     C                     MOVELGFRA      XG1     1
     C                     MOVELGFRA2     XG2     1
D2  C           XG2       IFEQ 'G'
    C           XG1       ANDEQ'X'
    C           GFRA2     ANDNE'GD'
     C                     SETON                       90
     C                     Z-ADD33        MSG
F2  C                     END
F1  C                     END
    C*
D1  C           FIOND     IFNE *BLANKS
    C           FACON     ANDNE4
     C                     SETON                       90
     C                     Z-ADD34        MSG
F1  C                     END
     * GESTION DE LA CONFIG OFFSET 3B
D1  C           *IN03     IFEQ '1'
    C           PAPI3     ANDNE*BLANKS
    C           TIMP3     ANDEQ4
    C           *IN05     OREQ '1'
    C           PAPI5     ANDNE*BLANKS
    C           TIMP5     ANDEQ4
D2  C           ZTCO35    IFEQ *BLANK
     C                     MOVE OTCO35    ZTCO35
F2  C                     END
     C                     MOVEL'OFCO'    PXARGU
     C                     MOVE ZTCO35    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVELPXLIBE    OLCO35
     C   50                MOVE OTCO35    ZTCO35
     C   50                MOVE ZTCO35    PXVALE    P
     C           CLEPAR    CHAINPARAME               50
     C  N50                MOVELPXLIBE    OLCO35
F1  C                     END
     *
     C                     MOVE 'TOND'    PXARGU
     C                     MOVELSIDD      PXVALE    P
     C           CLEPAR    CHAINPARAME               99
D1  C           *IN99     IFEQ '1'
     C                     Z-ADD63        MSG
     C                     SETON                     90
F1  C                     END
     C  N63                MOVELPXLIBE    LIBTP
    C*
     C                     SETOF                     343638
     C                     SETOF                     6162
    C      90             GOTO SUIT66
     C                     EXSR POST02                     POST.TRAIT. 2
     C                     MOVE 0         *IN               IIND. OFF
     *                                                     RAZ ZONES TRAV
    C           SUIT66    ENDSR
     ********************************************************************
     ***********  FIN  DE  LA  VALIDATION  DU  FORMAT 2   ***************
     ********************************************************************
     C/SPACE 5
     ** POST-TRAITEMENT DU FORMAT 2 *************************************
     *
    C           POST02    BEGSR
     *
     C                     EXSR RAZ
     *
D1  C           IMP,1     IFNE TIMP1A
     C                     EXSR ZERO1A
F1  C                     END
D1  C           IMP,2     IFNE TIMP2A
     C                     EXSR ZERO1B
F1  C                     END
D1  C           IMP,3     IFNE TIMP3A
     C                     EXSR ZERO1C
F1  C                     END
D1  C           IMP,4     IFNE TIMP4A
     C                     EXSR ZERO1D
F1  C                     END
D1  C           IMP,5     IFNE TIMP5A
     C                     EXSR ZERO1E
F1  C                     END
D1  C           IMP,6     IFNE TIMP6A
     C                     EXSR ZERO1F
F1  C                     END
D1  C           IMP,7     IFNE TIMP7A
     C                     EXSR ZERO1G
F1  C                     END
    C*
D1  C           FA,1      IFNE COFEN
    C           COFEN     ANDEQ*ZEROS
     C                     EXSR ZERO1H
F1  C                     END
D1  C           FA,3      IFNE COAS2
    C           COAS2     ANDEQ*ZEROS
     C                     MOVE *BLANKS   JUMEL
     C                     EXSR ZERO1J
F1  C                     END
     *
     C                     EXSR RAZ
     *
D1  C           TIMP1A    IFEQ 'STOCKE'
     C                     MOVELFORL1     PAPI1
     C                     MOVE FORL1     ZON1    1
     C                     MOVELFORH1     ZON2    2
     C                     MOVE ZON2      GRAM1
     C                     MOVELZON1      GRAM1
     C                     MOVE FORH1     ZON2
     C                     MOVE ' '       LAIZ1
     C                     MOVELZON2      LAIZ1
     C                     Z-ADD0         FORL1
     C                     Z-ADD0         FORH1
    C                     GOTO SUIT70
F1  C                     END
D1  C           TIMP2A    IFEQ 'STOCKE'
     C                     MOVELFORL2     PAPI2
     C                     MOVE FORL2     ZON1
     C                     MOVELFORH2     ZON2
     C                     MOVE ZON2      GRAM2
     C                     MOVELZON1      GRAM2
     C                     MOVE FORH2     ZON2
     C                     MOVE ' '       LAIZ2
     C                     MOVELZON2      LAIZ2
     C                     Z-ADD0         FORL2
     C                     Z-ADD0         FORH2
    C                     GOTO SUIT70
F1  C                     END
D1  C           TIMP3A    IFEQ 'STOCKE'
     C                     MOVELFORL3     PAPI3
     C                     MOVE FORL3     ZON1
     C                     MOVELFORH3     ZON2
     C                     MOVE ZON2      GRAM3
     C                     MOVELZON1      GRAM3
     C                     MOVE FORH3     ZON2
     C                     MOVE ' '       LAIZ3
     C                     MOVELZON2      LAIZ3
     C                     Z-ADD0         FORL3
     C                     Z-ADD0         FORH3
F1  C                     END
     *
     C           SUIT70    TAG
D1  C           TIMP4A    IFEQ 'STOCKE'
     C                     MOVELFORL4     PAPI4
     C                     MOVE FORL4     ZON1
     C                     MOVELFORH4     ZON2
     C                     MOVE ZON2      GRAM4
     C                     MOVELZON1      GRAM4
     C                     MOVE FORH4     ZON2
     C                     MOVE ' '       LAIZ4
     C                     MOVELZON2      LAIZ4
     C                     Z-ADD0         FORL4
     C                     Z-ADD0         FORH4
    C                     GOTO SUIT65
F1  C                     END
D1  C           TIMP5A    IFEQ 'STOCKE'
     C                     MOVELFORL5     PAPI5
     C                     MOVE FORL5     ZON1
     C                     MOVELFORH5     ZON2
     C                     MOVE ZON2      GRAM5
     C                     MOVELZON1      GRAM5
     C                     MOVE FORH5     ZON2
     C                     MOVE ' '       LAIZ5
     C                     MOVELZON2      LAIZ5
     C                     Z-ADD0         FORL5
     C                     Z-ADD0         FORH5
    C                     GOTO SUIT65
F1  C                     END
D1  C           TIMP6A    IFEQ 'STOCKE'
     C                     MOVELFORL6     PAPI6
     C                     MOVE FORL6     ZON1
     C                     MOVELFORH6     ZON2
     C                     MOVE ZON2      GRAM6
     C                     MOVELZON1      GRAM6
     C                     MOVE FORH6     ZON2
     C                     MOVE ' '       LAIZ6
     C                     MOVELZON2      LAIZ6
     C                     Z-ADD0         FORL6
     C                     Z-ADD0         FORH6
    C                     GOTO SUIT65
F1  C                     END
D1  C           TIMP7A    IFEQ 'STOCKE'
     C                     MOVELFORL7     PAPI7
     C                     MOVE FORL7     ZON1
     C                     MOVELFORH7     ZON2
     C                     MOVE ZON2      GRAM7
     C                     MOVELZON1      GRAM7
     C                     MOVE FORH7     ZON2
     C                     MOVE ' '       LAIZ7
     C                     MOVELZON2      LAIZ7
     C                     Z-ADD0         FORL7
     C                     Z-ADD0         FORH7
F1  C                     END
     C           SUIT65    TAG
     *
     C                     EXSR ZERZER
     C                     EXSR ZERO2
     *
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DES PAPIERS *****************************
    C           SUPPOR    BEGSR                           *ORDINO.PG. C *
     *
     C                     EXSR RAZ
     C                     Z-ADD*ZEROS    NBPAP   10
     C                     Z-ADD*ZEROS    NCXH    10
     C                     MOVE *BLANKS   PAPECX  3
     C                     Z-ADD*ZEROS    GRAECX  30
     C                     MOVE *BLANKS   REFECX  6
     C                     Z-ADD*ZEROS    RELECX  30
     C                     Z-ADD*ZEROS    PASECX  10
     C                     MOVE *BLANKS   PAPICX  3
     C                     Z-ADD*ZEROS    GRAICX  30
     C                     MOVE *BLANKS   REFICX  6
     C                     Z-ADD*ZEROS    RELICX  30
     C                     Z-ADD*ZEROS    PASICX  10
     C                     MOVE '0'       IN93    1
     *                                                    *           D *
     C                     MOVE '3'       TEST    1
     C   01                EXSR SUP01                      *           E *
     C   01                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   01 38             MOVE LAIZ      LAIZ1
     *
     C   02                EXSR SUP02
     C   02                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   02 38             MOVE LAIZ      LAIZ2
     *
     C   03                EXSR SUP03
     C   03                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   03 38             MOVE LAIZ      LAIZ3
     *
     C                     MOVE '4'       TEST
     C   04                EXSR SUP04
     C   04                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   04 38             MOVE LAIZ      LAIZ4
     *
     C   05                EXSR SUP05
     C   05                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   05 38             MOVE LAIZ      LAIZ5
     *
     C   06                EXSR SUP06
     C   06                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   06 38             MOVE LAIZ      LAIZ6
     *
     C   07                EXSR SUP07
     C   07                EXSR SUPPOC
    C      90             GOTO FINSUP
     C   07 38             MOVE LAIZ      LAIZ7
     *
     C           FACON     COMP 6                        80*ORDINO.PG. E *
     C     N80   FACON     COMP 7                        80
     C     N80   FACON     COMP 8                        80
    C        N80          GOTO FINSUP
     *
D1  C           CCOL      IFEQ 8
    C           CCOL      ORNE 8
    C           LMINI     ANDEQ0
     C                     EXSR FORMA                      *ORDINO.PG. E2*
F1  C                     END
    C*
D1  C           CCOL      IFEQ 1
     C                     EXSR SUPSTO                     *ORDINO.PG. E1*
F1  C                     END
     *
    C           FINSUP    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DES SUPPORTS PAR SUPPORT  ***************
    C           SUPPOC    BEGSR                           *ORDINO. PG. C*
     *
     C                     EXSR RAZ
     *
     C                     ADD  1         NBPAP
     C           PAPI      COMP *BLANKS                  90
     C   90      GRAM      COMP *ZEROS                   90
    C     N90             GOTO OKQUAL
     C                     MOVE ETUDE     ETUDSV  40
     C                     MOVE SEQDE     SEQDSV
     C           TIMPA     COMP 'STOCKE'             9090
     C         90          Z-ADD3         MSG     20        ERREUR  3
    C         90          GOTO FINPOC
    C*          NOSTOC    CHAINPREIMP2              9090
    C*     90             Z-ADD3         MSG               ERREUR 3
    C*     90             GOTO FINPOC
     C   35N34             EXSR PRIMPE                     PRE.IMP.EXT.
     C   37N36             EXSR PRIMPI                     PRE.IMP.INT.
     C                     EXSR SUPPOF                     *ORDINO.PG. F *
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
    C                     GOTO FINPOC
     *
     C           OKQUAL    TAG                             *ORDINO PG. D *
     C                     MOVE ADPAP     REFOUR
     *
D1  C           CXH       IFNE 'CXH'
D2  C           PAPI      IFNE 'XXX'
    C           GRAM      ANDNE999
     C           QUALIL    CHAINMATPREL1             9090
     C      90             Z-ADD4         MSG               MSG. 4
    C      90             GOTO FINPOC
     C           QUALIL    CHAINQUALIL3              9090
D3  C           *IN90     IFEQ '0'
     C           CODSTU    COMP 2                        90
     C  N90      CODSTU    COMP 3                        90
F3  C                     END
     C      90             Z-ADD4         MSG               MSG. 4
    C      90             GOTO FINPOC
     *
D3  C           CATEGO    IFGT 'B'
D4  C           VALAN     IFGT 90
     C                     MOVEL'19'      VALSA
X4  C                     ELSE
     C                     MOVEL'20'      VALSA
F4  C                     END
     C                     MOVE VALAN     VALSA   40
D4  C           *YEAR     IFGT VALSA
    C           *YEAR     OREQ VALSA
    C           UMONTH    ANDGTVALMOI
     C                     Z-ADD84        MSG               MESSAGE 84
     C                     SETON                     90
    C                     GOTO FINPOC
F4  C                     END
F3  C                     END
F2  C                     END
     *
X1  C                     ELSE
     C           QUALIL    CHAINCXHLIGL2             90
     C      90             Z-ADD4         MSG               MSG. 4
    C      90             GOTO FINPOC
     C                     ADD  1         NCXH
D2  C           TEST      IFEQ '3'
     C                     Z-ADDPASCXH    PASECX
X2  C                     ELSE
     C                     Z-ADDPASCXH    PASICX
F2  C                     END
     C                     EXSR COMCXH
F1  C                     END
     *
     C           FORL      COMP *ZEROS                   88
     C           FORH      COMP *ZEROS                   89
     C           TIMP      COMP 1                        87
     C        N87TIMP      COMP 2                        87
     C        N87TIMP      COMP 3                        87
     C        N87TIMP      COMP 5                        87
     C           TIMP      COMP 4                        86
     *
    C           ONDUL     CABEQ0         SUONDU
    C           CCOL      CABEQ8         SUONDU
     C           CCOL      COMP 0                        85
     C  N88N89N86
     CANN87 85             SETON                     90
     C   90                Z-ADD5         MSG
    C   90                GOTO FINPOC
    C*          CCOL      IFEQ 6
    C*          COUI3     ANDEQ3
    C*          *IN88     IFEQ '0'
    C*          *IN89     OREQ '0'
    C*                    SETON                     90
    C*                    Z-ADD5         MSG
    C*                    GOTO FINPOC
    C*                    END
    C*                    END
     C           SUONDU    TAG
     C                     SETOF                     85
     *
D1  C           COUP      IFEQ 'O'
D2  C           TIMP      IFNE 4
D3  C           CCOL      IFNE 3
    C           CCOL      ORNE 5
    C           CCOL      ORNE 6
     C                     Z-ADD32        MSG
     C                     SETON                     90
    C                     GOTO FINPOC
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           *IN88     IFEQ '0'
    C           *IN89     ANDEQ'0'
    C           *IN87     ANDEQ'1'
D2  C           TIMP      IFEQ 1
    C           COUP      ANDEQ'C'
    C           COUL      ANDNE0
    C                     GOTO OFF38
F2  C                     END
D2  C           COUP      IFNE 'R'
     C                     SETON                     90
     C                     Z-ADD5         MSG
    C                     GOTO FINPOC
F2  C                     END
F1  C                     END
     *
     C   88N89
     CORN88 89             SETON                     90
     C         90          Z-ADD5         MSG               ERREUR 5
    C         90          GOTO FINPOC
D1  C           COUP      IFEQ 'F'
    C           COUP      OREQ 'B'
     C   88 89 86          SETON                     90
     C         90          Z-ADD6         MSG               ERREUR 6
    C         90          GOTO FINPOC
F1  C                     END
     C                     SETOF                     38
D1  C           NCXH      IFGE 1
     C   88 89N86LMINI     COMP *ZEROS                   90
     C   90                Z-ADD6         MSG                MSG.6
    C   90                GOTO FINPOC
F1  C                     END
     C   88 89N86          MOVELLMINI     LAIZ    3
     C   88 89N86          SETON                     38
     C                     EXSR SUPPOF                     *ORDINO.PG. F *
     C           COUL      COMP 0                    898988
     C           COUP      COMP 'F'                      87
     C     N87   COUP      COMP 'B'                      87
     C     N87   COUP      COMP 'O'                      87
     C           COUP      COMP *BLANK               8585
     *
    C         38          GOTO ON38
     C/SPACE 1
D1  C           TIMP      IFEQ 4
D2  C           COUL      IFNE 0
D3  C           CCOL      IFEQ 0
D4  C           TREPX     IFEQ 2
    C           TREPX     OREQ 1
     C                     MOVE 'B'       COUP
     C                     MOVE 'B'       COUP3
F4  C                     END
     C                     EXSR FORMA
    C                     GOTO FINPOC
F3  C                     END
F2  C                     END
F1  C                     END
     C/SPACE 1
D1  C           CCOL      IFNE 8
     C   86   N87
     CORN86 88N87          SETON                     90     ERREUR 7
     C      90             Z-ADD7         MSG
     *
D2  C           COUL      IFEQ 0
D3  C           IN22      IFNE '2'
     C                     MOVELMESS,15   MSGMSG
     C                     Z-ADD87        MSG              MSG.ERREUR
     C                     SETON                     90
    C                     GOTO FINPOC
F3  C                     END
F2  C                     END
F1  C                     END
    C                     GOTO OFF38
     *
     C           ON38      TAG
     *
D1  C           TIMP      IFEQ 0
    C           COUL      CABNE0         PGERR7
D2  C           CCOL      IFNE 7
    C           COUP      CABNE' '       PGERR7
F2  C                     END
    C                     GOTO OFF38
F1  C                     END
D1  C           TIMP      IFNE 0
D2  C           COUL      IFNE 0
D3  C           TIMP      IFEQ 3
D4  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C           COUP      COMP 'R'                  9090
     C         90COUP      COMP 'C'                  9090
    C         90          GOTO PGERR7
X4  C                     ELSE
    C           COUP      CABNE' '       PGERR7
F4  C                     END
F3  C                     END
F2  C                     END
D2  C           COUL      IFEQ 0
     C           TIMP      COMP 1                    9090
     C         90TIMP      COMP 2                    9090
     C         90TIMP      COMP 5                    9090
    C         90          GOTO PGERR7
     C           COUP      COMP 'R'                  9090
     C         90COUP      COMP 'C'                  9090
     C         90COUP      COMP 'V'                  9090
     C         90COUP      COMP 'F'                  9090
     C         90COUP      COMP 'O'                  9090
     C         90COUP      COMP ' '                  9090
    C         90          GOTO PGERR7
D3  C           IN22      IFNE '2'
     C                     MOVELMESS,15   MSGMSG
     C                     Z-ADD87        MSG              MSG.ERREUR
     C                     SETON                     90
    C                     GOTO FINPOC
F3  C                     END
F2  C                     END
     *
D2  C           COUL      IFNE 0
D3  C           TIMP      IFNE 3
    C           TIMP      ANDNE5
D4  C           COUP      IFEQ 'F'
    C           COUP      OREQ 'O'
     C           TIMP      COMP 1                    9090
     C  N90      CCOL      COMP 1                    9090
    C   90                GOTO PGERR7
F4  C                     END
F3  C                     END
F2  C                     END
     *
D2  C           TIMP      IFNE 0
D3  C           TIMP      IFNE 3
    C           TIMP      ANDNE5
    C           COUP      CABEQ'R'       PGDA
    C           COUP      CABEQ'C'       PGDA
    C           COUP      CABEQ'V'       PGDA
    C           COUP      CABEQ'F'       PGDA
    C           COUP      CABEQ'O'       PGDA
    C           COUP      CABEQ' '       PGDB
    C                     GOTO PGERR7
     C           PGDB      TAG
    C           CCOL      CABNE1         PGERR7
    C                     GOTO PGDA
     C           PGERR7    TAG
     C                     SETON                     90       MSG.7
     C                     Z-ADD7         MSG
    C                     GOTO OFF38
F3  C                     END
F2  C                     END
F1  C                     END
     C           PGDA      TAG
     *
     *
     C           OFF38     TAG
    C      90             GOTO FINPOC
     *
D1  C           COSESA    IFEQ 'S'
    C           COSESA    OREQ 'E'
    C           COSESA    OREQ 'V'
    C           COSESA    OREQ 'A'
    C           COSESA    OREQ 'B'
    C           COSESA    OREQ 'C'
    C           COSESA    OREQ 'D'
     C           NBSESA    COMP 0                        90
     C   90                MOVE 88        MSG              MSG.ERREUR
     C   90                MOVE MESS,16   MSGMSG
    C   90                GOTO FINPOC
F1  C                     END
D1  C           NBSESA    IFNE 0
     C           COSESA    COMP ' '                      90
     C   90                MOVE 88        MSG              MSG.ERREUR
     C   90                MOVE MESS,16   MSGMSG
    C   90                GOTO FINPOC
F1  C                     END
D1  C           COTAPE    IFEQ 'T'
    C           COTAPE    OREQ 'L'
    C           COTAPE    OREQ 'R'
    C           COTAPE    OREQ 'M'
    C           COTAPE    OREQ 'G'
    C           COTAPE    OREQ 'P'
    C           COTAPE    OREQ 'Q'
     C           NBTAPE    COMP 0                        90
     C   90                MOVE 88        MSG              MSG.ERREUR
     C   90                MOVE MESS,16   MSGMSG
    C   90                GOTO FINPOC
F1  C                     END
D1  C           NBTAPE    IFNE 0
     C           COTAPE    COMP ' '                      90
     C   90                MOVE 88        MSG              MSG.ERREUR
     C   90                MOVE MESS,16   MSGMSG
    C   90                GOTO FINPOC
F1  C                     END
    C*          TDOCF     IFNE *BLANKS
    C*                    MOVE 'TTRA'    PXARGU
    C*                    MOVE TDOCF     PXVALE    P
    C*          CLEPAR    CHAINPARAME               90
    C*     90             GOTO FINPOC                      ANO. 8
    C*                    END
     *
    C           FINPOC    ENDSR
     C/SPACE 3
     ********************************************************************
     ** FORMATAGE POUR CONTROLE DES FORMATS D'IMPRESSION *
    C           SUPSTO    BEGSR                           *ORDINO.PG. E1*
     *
D1  C           *IN35     IFEQ '0'                        PAS PRE-IMPRIME
D2  C           FORL3     IFNE *ZEROS
    C           FORH3     ANDNE*ZEROS
     C                     Z-ADDFORL3     FORLA
     C                     Z-ADDFORH3     FORHA
D3  C           *IN37     IFEQ '0'                                    IME
    C           FORL5     ANDNE*ZEROS
    C           *IN37     OREQ '0'                                    IME
    C           FORH5     ANDNE*ZEROS
     C                     Z-ADD19        MSG               MSG.19
     C                     SETON                     90
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           *IN37     IFEQ '0'                        PAS PRE-IMPRIME
D2  C           FORL5     IFNE *ZEROS
    C           FORH5     ANDNE*ZEROS
     C                     Z-ADDFORL5     FORLA
     C                     Z-ADDFORH5     FORHA
D3  C           *IN35     IFEQ '0'                                    IME
    C           FORL3     ANDNE*ZEROS
    C           *IN35     OREQ '0'                                    IME
    C           FORH3     ANDNE*ZEROS
     C                     Z-ADD19        MSG               MSG.19
     C                     SETON                     90
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C                     EXSR FORMA
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DES COMPLEXES
    C           CPLX      BEGSR                                       E2*
     *
D1  C           CCOL      IFEQ 7
D2  C           GRAM3     IFLT GRAM4                      HELIO: + LEGER
D3  C           TIMP3A    IFNE *BLANKS
D4  C           TIMP3A    IFNE 'HELIO'
    C           TIMP3A    ANDNE'FLEXO'
    C           TIMP3A    ANDNE'STOCKE'
     C                     SETON                     71
    C                     GOTO FCPLX
F4  C                     END
F3  C                     END
D3  C           TIMP4A    IFNE *BLANKS                    MARQUAGE
D4  C           TIMP4A    IFNE 'TYPO '
    C           TIMP4A    ANDNE'FLEXO'
     C                     SETON                     71
    C                     GOTO FCPLX
F4  C                     END
F3  C                     END
D3  C           TIMP4A    IFEQ 'TYPO   '
    C           COUL4     ANDNE1
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
     *
X2  C                     ELSE
D3  C           TIMP4A    IFNE *BLANKS
D4  C           TIMP4A    IFNE 'HELIO'
    C           TIMP4A    ANDNE'FLEXO'
    C           TIMP4A    ANDNE'STOCKE'
     C                     SETON                     71
    C                     GOTO FCPLX
F4  C                     END
F3  C                     END
D3  C           TIMP3A    IFNE *BLANKS                    MARQUAGE
D4  C           TIMP3A    IFNE 'TYPO '
    C           TIMP3A    ANDNE'STOCKE'
     C                     SETON                     71
    C                     GOTO FCPLX
F4  C                     END
F3  C                     END
D3  C           TIMP3A    IFEQ 'TYPO   '
    C           COUL3     ANDNE1
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           CCOL      IFEQ 4
D2  C           COLRH     IFNE 'PE'
    C           COLRH     ANDNE'PL'
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
F1  C                     END
D1  C           CCOL      IFEQ 7
D2  C           COLRH     IFNE 'HM'
    C           COLRH     ANDNE'PE'
    C           COLRH     ANDNE'VY'
    C           COLRH     ANDNE'PL'
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
F1  C                     END
     *
    C           LMINI     CABGT145       FCPLX      71
     *
D1  C           FACON     IFEQ 1
    C           FACON     OREQ 4
     *
D2  C           FACON     IFEQ 4                          APPRO FORMAT
    C           LMINI     ANDEQ*ZEROS
    C                     GOTO FCPLX
F2  C                     END
D2  C           FACON     IFEQ 1
    C           DECH      ANDNE*ZEROS
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
     *
     C                     MOVE LMINI     LAIZL
     C           LAIZL     DIV  DECL      POSLA   20
     C           DECL      MULT POSLA     LONGA
D2  C           COLRH     IFEQ 'PE'
    C           TIMP3A    ANDNE'TYPO'
    C           TIMP4A    ANDNE'TYPO'
    C           COLRH     OREQ 'PL'
    C           TIMP3A    ANDNE'TYPO'
    C           TIMP4A    ANDNE'TYPO'
     C                     ADD  15        LONGA            AVANT 0 (ZERO)
X2  C                     ELSE
     C                     ADD  15        LONGA
F2  C                     END
     C           LONGA     COMP LAIZL                7171
    C                     GOTO FCPLX
    C*
X1  C                     ELSE
D2  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
D2  C           ZB12      IFEQ 'P'
    C           ZB12      OREQ ' '
     C           ONDL      SUB  FMINL     RESTE1
D3  C           RESTE1    IFLT 14
    C           RESTE1    ORGT 18
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
     C           ONDH      SUB  FMINH     RESTE1
D3  C           RESTE1    IFLT 20
    C           RESTE1    ORGT 24
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
X2  C                     ELSE
     C           ONDL      SUB  FMINL     RESTE1
D3  C           RESTE1    IFLT 20
    C           RESTE1    ORGT 24
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
     C           ONDH      SUB  FMINH     RESTE1
D3  C           RESTE1    IFLT 14
    C           RESTE1    ORGT 18
     C                     SETON                     71
    C                     GOTO FCPLX
F3  C                     END
F2  C                     END
    C*
     C                     MOVE LMINI     LAIZMM
D2  C           LAIZMM    IFNE 0
    C           LAIZMM    ANDNE5
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
     C                     MOVE LMINI     LAIZL
     C           LAIZL     SUB  ONDL      RESTE1
D2  C           RESTE1    IFLT 10
    C           RESTE1    ORGT 19
     C                     SETON                     71
    C                     GOTO FCPLX
F2  C                     END
F1  C                     END
     *
     C           FCPLX     TAG
     C   71                SETON                     90
     C   71                Z-ADD71        MSG
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DES FORMATS D'IMPRESSION
    C           FORMA     BEGSR                           *ORDINO.PG. E2*
     *
     C                     EXSR RAZ
     *
    C           TIMEX     CABEQ'STOCKE'  FINMAT           COMPACT STOCKE
     *
D1  C           CCOL      IFEQ 8
D2  C           ONDL      IFNE *ZEROS
    C*                    MOVE ONDL      FORMM            SD N° 1419360
    C*          FORMM     IFNE *ZEROS
    C*          ONDL      ADD  10        FORM1   40
    C*                    MOVE '0'       FORM1
    C*                    ELSE
    C*                    Z-ADDONDL      FORM1
    C*                    END
    C*          FORM1     COMP FORL3                9090
    C*     90             Z-ADD43        MSG
    C*     90             GOTO FINMAT
    C*                    MOVE ONDH      FORMM
    C*          FORMM     IFNE *ZEROS
    C*          ONDH      ADD  10        FORM1   40
    C*                    MOVE '0'       FORM1
    C*                    ELSE
    C*                    Z-ADDONDH      FORM1
    C*                    END
    C*          FORM1     COMP FORH3                9090
    C*     90             Z-ADD43        MSG
    C                     GOTO FINMAT
X2  C                     ELSE
D3  C           FORH3     IFNE DECH
    C           FORL3     ORNE DECL
     C                     SETON                     90
     C                     Z-ADD43        MSG
F3  C                     END
    C                     GOTO FINMAT
F2  C                     END
F1  C                     END
     *
    C* COMPACT
    C*--------------------
D1  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
    C           NCXH      CABEQ1         FINMAT
D2  C           ONDL      IFNE *ZEROS
     C           ONDL      COMP FORL3                9090
     C     N90   ONDH      COMP FORH3                9090
     C      90             Z-ADD43        MSG
X2  C                     ELSE
     C           FORL3     COMP DECL                 9090
     C     N90   FORH3     COMP DECH                 9090
     C      90             Z-ADD43        MSG
F2  C                     END
    C                     GOTO FINMAT
F1  C                     END
     *
     C           ONDL      ADD  5         FORM1   40
     C           FORM1     COMP FORLA                9090
     C      90             Z-ADD41        MSG
    C      90             GOTO FINMAT
     *
D1  C           *IN61     IFEQ '1'
     C           ONDH      ADD  5         FORM2   40       10 AVANT 241001
     C           FORM2     COMP FORHA                9090
     C      90             Z-ADD18        MSG
    C      90             GOTO FINMAT
X1  C                     ELSE
    C*
     C           ONDH      ADD  5         FORM2
     C           FORM2     COMP FORHA                9090
     C      90             Z-ADD18        MSG
    C      90             GOTO FINMAT
F1  C                     END
     *
    C           FINMAT    ENDSR
     C/SPACE 5
     ********************************************************************
     ** FORMATAGE DES CTRS EN FONCTION DU TYPE D'IMPRESSION *
    C           SUPPOF    BEGSR                           *ORDINO.PG.F  *
     *
     C           FACON     COMP 6                        80
     C        N80FACON     COMP 7                        80
     C        N80FACON     COMP 8                        80
    C     N80             GOTO FINPOF
    C           TIMPA     CABEQ'STOCKE'  SUIPOF
     *
    C           TEST      CABLE'3'       SPOF
    C           TIMPIN    CABEQ0         SUIPOF
    C           COUINB    CABEQ0         SUIPOF
    C*                                                     INTERIEUR
     C           TIMPIN    COMP 3                    828081        STOCKE
     C           COUPIN    COMP 'C'                      83
     C           COUINB    COMP 1                        84
     C        N84COUINB    COMP 0                        84
     C      80N83          SETON                     61
     C      80N83
     COR 80 83N84          Z-ADD1         CTB     10
     C   81                Z-ADD2         CTB
     C      82             Z-ADD3         CTB
    C                     GOTO FINPOF
    C*
     C           SPOF      TAG                              EXTERIEUR
    C           TIMPEX    CABEQ0         SUIPOF
    C           COUEXB    CABEQ0         SUIPOF
     C           TIMPEX    COMP 3                    828081        STOCKE
     C           COUPEX    COMP 'C'                      83
     C           COUEXB    COMP 1                        84
     C        N84COUEXB    COMP 0                        84
     C      80N83          SETON                     61
     C      80N83
     COR 80 83N84          Z-ADD1         CTA     10
     C   81                Z-ADD2         CTA
     C      82             Z-ADD3         CTA
    C                     GOTO FINPOF
     *
     C           SUIPOF    TAG
    C           TIMP      CABEQ0         FINPOF
     *
     C           TIMP      COMP 3                    828081
     C           TEST      COMP '3'                    8383
     * POST PRINT
D1  C           TIMP      IFEQ 5
     C   83                Z-ADD2         CTA
     C  N83                Z-ADD2         CTB
    C                     GOTO FINPOF
F1  C                     END
     * OFFSET
     C   82 83             Z-ADD3         CTA
     C   82N83             Z-ADD3         CTB
    C   82                GOTO FINPOF
     * TYPO
     C   81 83             Z-ADD2         CTA
     C   81N83             Z-ADD2         CTB
    C   81                GOTO FINPOF
     * HELIO/FLEXO
D1  C   80      COUL      IFEQ 0
    C                     GOTO FINPOF
F1  C                     END
     C   80      COUP      COMP 'C'                      84
     C   80N84             SETON                     61
     C   80 84   COUL      COMP 1                        85
     C   80 84N85COUL      COMP 0                        85
    C   80 84 85          GOTO FINPOF
     C   80 83             Z-ADD1         CTA
     C   80N83             Z-ADD1         CTB
     *
    C           FINPOF    ENDSR
     C/SPACE 5
     ********************************************************************
     ** FORMATAGE DE ZONE COMMUNE POUR CONTROLE DES SUPPORTS *
    C           SUP01     BEGSR                            FORMATAGE DES
     *
     C                     EXSR RAZ
     *
     C                     MOVE PAPI1     PAPI    3         SUPPORTS POUR
     C                     MOVE GRAM1     GRAM              CONTROLE .
     C                     MOVE FORL1     FORL    40
     C                     MOVE FORH1     FORH    40
     C                     MOVE TIMP1A    TIMPA   6
     C                     MOVE TREP1     TREPX   10
     C                     MOVE COUL1B    COUL    20
    C*                    MOVE COUP1     COUP    1
     C                     MOVE LAIZ1     LAIZ    3
     C                     MOVELADPAP1    ADPAP   6
     C                     MOVELADGRA1    ADGRA   30
     C                     Z-ADDTIMP1     TIMP
     C  N35      TIMPA     COMP 'STOCKE'                 35
     C                     MOVELADPAP1    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPECX
     C                     Z-ADDGRAM      GRAECX
     C                     MOVELADPAP     REFECX
     C                     Z-ADDADGRA     RELECX
     C                     Z-ADDFORL1     FLCXHE  40
     C                     Z-ADDFORH1     FHCXHE  40
F1  C                     END
    C                     ENDSR
     *
    C           SUP02     BEGSR                            2EME SUPPORT
     C                     MOVE PAPI2     PAPI
     C                     MOVE GRAM2     GRAM
     C                     MOVE FORL2     FORL
     C                     MOVE FORH2     FORH
     C                     MOVE TIMP2A    TIMPA
     C                     MOVE TREP2     TREPX
     C                     MOVE COUL2B    COUL
     C                     MOVE COUP2     COUP
     C                     MOVE LAIZ2     LAIZ
     C                     MOVELADPAP2    ADPAP
     C                     MOVELADGRA2    ADGRA
     C                     Z-ADDTIMP2     TIMP
     C  N35      TIMPA     COMP 'STOCKE'                 35
     C                     MOVELADPAP2    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPECX
     C                     Z-ADDGRAM      GRAECX
     C                     MOVELADPAP     REFECX
     C                     Z-ADDADGRA     RELECX
     C                     Z-ADDFORL2     FLCXHE
     C                     Z-ADDFORH2     FHCXHE
F1  C                     END
    C                     ENDSR
     *
    C           SUP03     BEGSR                            3EME SUPPORT
     C                     MOVE PAPI3     PAPI
     C                     MOVE GRAM3     GRAM
     C                     MOVE FORL3     FORL
     C                     MOVE FORH3     FORH
     C                     MOVE TIMP3A    TIMPA
     C                     MOVE TREP3     TREPX
     C                     MOVE COUL3B    COUL
     C                     MOVE COUP3     COUP
     C                     MOVE LAIZ3     LAIZ
     C                     MOVELADPAP3    ADPAP
     C                     MOVELADGRA3    ADGRA
     C                     Z-ADDTIMP3     TIMP
     C  N35      TIMPA     COMP 'STOCKE'                 35
     C                     MOVELADPAP3    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPECX
     C                     Z-ADDGRAM      GRAECX
     C                     MOVELADPAP     REFECX
     C                     Z-ADDADGRA     RELECX
     C                     Z-ADDPASCXH    PASECX
     C                     Z-ADDFORL3     FLCXHE
     C                     Z-ADDFORH3     FHCXHE
F1  C                     END
    C                     ENDSR
     *
    C           SUP04     BEGSR                            4EME SUPPORT
     C                     MOVE PAPI4     PAPI
     C                     MOVE GRAM4     GRAM
     C                     MOVE FORL4     FORL
     C                     MOVE FORH4     FORH
     C                     MOVE TIMP4A    TIMPA
     C                     MOVE TREP4     TREPX
     C                     MOVE COUL4B    COUL
     C                     MOVE COUP4     COUP
     C                     MOVE LAIZ4     LAIZ
     C                     MOVELADPAP4    ADPAP
     C                     MOVELADGRA4    ADGRA
     C                     Z-ADDTIMP4     TIMP
     C  N37      TIMPA     COMP 'STOCKE'                 37
     C                     MOVELADPAP4    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPICX
     C                     Z-ADDGRAM      GRAICX
     C                     MOVELADPAP     REFICX
     C                     Z-ADDADGRA     RELICX
     C                     Z-ADDFORL1     FLCXHI  40
     C                     Z-ADDFORH1     FHCXHI  40
F1  C                     END
    C                     ENDSR
     *
    C           SUP05     BEGSR                            5EME SUPPORT
     C                     MOVE PAPI5     PAPI
     C                     MOVE GRAM5     GRAM
     C                     MOVE FORL5     FORL
     C                     MOVE FORH5     FORH
     C                     MOVE TIMP5A    TIMPA
     C                     MOVE TREP5     TREPX
     C                     MOVE COUL5B    COUL
     C                     MOVE COUP5     COUP
     C                     MOVE LAIZ5     LAIZ
     C                     MOVELADPAP5    ADPAP
     C                     MOVELADGRA5    ADGRA
     C                     Z-ADDTIMP5     TIMP
     C  N37      TIMPA     COMP 'STOCKE'                 37
     C                     MOVELADPAP5    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPICX
     C                     Z-ADDGRAM      GRAICX
     C                     MOVELADPAP     REFICX
     C                     Z-ADDADGRA     RELICX
     C                     Z-ADDFORL5     FLCXHI
     C                     Z-ADDFORH5     FHCXHI
F1  C                     END
    C                     ENDSR
     *
    C           SUP06     BEGSR                            6EME SUPPORT
     C                     MOVE PAPI6     PAPI
     C                     MOVE GRAM6     GRAM
     C                     MOVE FORL6     FORL
     C                     MOVE FORH6     FORH
     C                     MOVE TIMP6A    TIMPA
     C                     MOVE TREP6     TREPX
     C                     MOVE COUL6B    COUL
     C                     MOVE COUP6     COUP
     C                     MOVE LAIZ6     LAIZ
     C                     MOVELADPAP6    ADPAP
     C                     MOVELADGRA6    ADGRA
     C                     Z-ADDTIMP6     TIMP
     C  N37      TIMPA     COMP 'STOCKE'                 37
     C                     MOVELADPAP6    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPICX
     C                     Z-ADDGRAM      GRAICX
     C                     MOVELADPAP     REFICX
     C                     Z-ADDADGRA     RELICX
     C                     Z-ADDFORL6     FLCXHI
     C                     Z-ADDFORH6     FHCXHI
F1  C                     END
    C                     ENDSR
     *
    C           SUP07     BEGSR                            7EME SUPPORT
     C                     MOVE PAPI7     PAPI
     C                     MOVE GRAM7     GRAM
     C                     MOVE FORL7     FORL
     C                     MOVE FORH7     FORH
     C                     MOVE TIMP7A    TIMPA
     C                     MOVE TREP7     TREPX
     C                     MOVE COUL7B    COUL
     C                     MOVE COUP7     COUP
     C                     MOVE LAIZ7     LAIZ
     C                     MOVELADPAP7    ADPAP
     C                     MOVELADGRA7    ADGRA
     C                     Z-ADDTIMP7     TIMP
     C  N37      TIMPA     COMP 'STOCKE'                 37
     C                     MOVELADPAP7    REFOUR
D1  C           CXH       IFEQ 'CXH'
     C                     MOVELPAPI      PAPICX
     C                     Z-ADDGRAM      GRAICX
     C                     MOVELADPAP     REFICX
     C                     Z-ADDADGRA     RELICX
     C                     Z-ADDFORL7     FLCXHI
     C                     Z-ADDFORH7     FHCXHI
F1  C                     END
    C                     ENDSR
     *
     C/SPACE 5
     ********************************************************************
     ** CHARGEMENT DES ZONES SI PRE-IMPRIME  STOCKE  *****
    C           PRIMPI    BEGSR                           FORMATAGE   S
     C                     MOVE TIMPS     TIMPIN  10
     C                     MOVE COULSB    COUINB
     C                     MOVE COUPS     COUPIN
     C                     MOVE 'STOCKE'  TIMIN
     C                     Z-ADDFORLS     FORLA
     C                     Z-ADDFORHS     FORHA
     C                     Z-ADDFORLS     FORLA2
     C                     Z-ADDFORHS     FORHA2
     C                     SETON                     36
    C                     ENDSR
     *
    C           PRIMPE    BEGSR                           FORMATAGE
     C                     MOVE TIMPS     TIMPEX  10
     C                     MOVE COULSB    COUEXB
     C                     MOVE COUPS     COUPEX
     C                     MOVE 'STOCKE'  TIMEX
     C                     Z-ADDFORLS     FORLA
     C                     Z-ADDFORHS     FORHA
     C                     Z-ADDFORLS     FORLA1
     C                     Z-ADDFORHS     FORHA1
     C                     SETON                     34
    C                     ENDSR
    C*
     C/SPACE 5
     ********************************************************************
     * POSE ET TYPE DE DECOUPAGE  ************************
    C           FORM      BEGSR                           *ORDINO.PG. A *
     *
     C                     EXSR RAZ
    C*
D1  C           INN24     IFEQ 1
D2  C           FACON     IFNE 7
    C           FACON     ANDNE8
     C                     SETON                     90
     C                     Z-ADD55        MSG                MESSAGE 96
    C                     GOTO FINFOR
F2  C                     END
F1  C                     END
     *
     C           POSF1B    COMP 0                        80
     C           POSFO     COMP 0                        81
     C           POSF2B    COMP 0                        82
     C           TDECO     COMP '   '                    83
    C   80N83             GOTO SUIT26
     C  N80 81
     CORN80N81N82          SETON                     90      ERREUR MSG 36
     C   90                Z-ADD36        MSG
    C   90                GOTO FINFOR
     C   80 83
     CORN80N81 82
     CAN 83                SETON                     90      ERREUR MSG 31
     C   90                Z-ADD31        MSG
    C                     GOTO FINFOR
     C           SUIT26    TAG
     *
    C           POSF1A    CABEQ0         OK80           80*ORDINO.PG. B *
     C           ACOTE     COMP 0                    828281
     C           POSF2A    COMP 0                    838384
     C           POSF2B    COMP 0                    858586
     C   81 83
     COR 81 84 85
     COR 82 84 86          SETON                     90
     C   90                Z-ADD36        MSG               MSG.36
    C   90                GOTO FINFOR
     C           OK80      TAG
     *
     C      80   POSFO     COMP 0                        81
     C      80 81          SETON                     90      ERREUR MSG 31
     C   90                Z-ADD31        MSG
    C      80 81          GOTO FINFOR
     ** VENTILATION MACHINE/DECOUPAGE/DECORTICAGE **
     C                     MOVELTDECO     MACHIZ  1
     C                     MOVE TDECO     DECORT  1
     C                     MOVELTDECO     ZOH2    2
     C                     MOVE ZOH2      DECOUP  1
     ** MACHINE **********
D1  C           MACHIZ    IFGT 'L'
     C                     Z-ADD31        MSG        90
    C                     GOTO FINFOR
F1  C                     END
     C           MACHIZ    COMP 'F'                  808182.MACHINE.
     C           MACHIZ    COMP 'A'                  838483
     C           POSFO     COMP 9                    868787
     C           POSF1A    COMP 9                    888989
     C   81 84             SETON                     90     MSG 31
     C   90                Z-ADD31        MSG
    C         90          GOTO FINFOR
    C     N80             GOTO SUIT27
     C           MACHIZ    COMP 'G'                  80  81
     C           TDECO     COMP 'G10'                    82
     C           TDECO     COMP 'G11'                    82
     C           TDECO     COMP 'G40'                    83
D1  C           MACHIZ    IFEQ 'I'
     C           USINE     COMP 2                    9090
F1  C                     END
     C   81N82N83          SETON                     90     MSG 31
     C   90                Z-ADD31        MSG
    C   90                GOTO FINFOR
     C           SUIT27    TAG
     ** DECOUPAGE ********
     C           MACHIZ    COMP 'L'                      81
     C  N81      DECOUP    COMP '0'                      90
     C  N90      DECOUP    COMP ' '                      90
     C   90N81             Z-ADD31        MSG                MSG.31
    C   90N81             GOTO FINFOR
     ** DECORTICAGE ******
D1  C           DECORT    IFEQ 'A'
    C           DECORT    OREQ 'B'
D2  C           MACHIZ    IFNE 'J'
     C                     Z-ADD31        MSG        90
    C                     GOTO FINFOR
F2  C                     END
F1  C                     END
     *B22 L10 À L79
D1  C           MACHIZ    IFEQ 'L'
     C           DECOUP    COMP '1'                    82
     C  N82      DECOUP    COMP '7'                  82
     C  N82      DECORT    COMP '0'                    82
     C  N82      DECORT    COMP '9'                  82
     C   82                Z-ADD31        MSG        90
    C                     GOTO FINFOR
F1  C                     END
     *********************
     C           FMINL     COMP 0                        90*ORDINO.PG. T *
     C   90                Z-ADD38        MSG                MSG.38
    C   90                GOTO FINFOR
     C           FMINH     COMP 0                        90
     C   90                Z-ADD38        MSG                MSG.38
    C   90                GOTO FINFOR
    C*
     C           ONDUL     COMP 7                        80
    C      80             GOTO SUIT28                      GAUFRE
     C           ONDH      SUB  FMINH     RESTE2  40
     C           ONDL      SUB  FMINL     RESTE1  40
    C           CCOL      CABEQ8         SUIT29         80 ONDULE ACHETE
     *
D1  C           ONDL      IFLE *ZEROS
     C                     Z-ADD66        MSG        90     ANO. 64
    C                     GOTO FINFOR
F1  C                     END
     C           LMINI     MULT 10        LMIMI
     C           LMIMI     DIV  ONDL      ZONEX   30       *ORDINO.PG. U *
     C           ONDL      MULT ZONEX     LALAIZ  40
     C           LALAIZ    ADD  ACOTE     LALAIZ
D1  C           ONDUL     IFEQ 0
    C           CCOL      ANDEQ0
     C           CCOL      COMP 5                    8080   CARTON COMPACT
     C         80CCOL      COMP 6                    8080
    C         80          GOTO SUIT30
    C                     GOTO FORMF2
F1  C                     END
     *
     C           FORMF2    TAG
D1  C           CCOL      IFEQ 5
     C                     EXSR FORBOB
    C                     GOTO SUIT38
F1  C                     END
     *
D1  C           CCOL      IFEQ 6
     C                     EXSR FORFOR
    C*                    EXSR BORBOB
    C                     GOTO SUIT38
F1  C                     END
     *
D1  C           TSOND     IFEQ 'JU'
     C                     EXSR JUPE
    C                     GOTO SUIT38
F1  C                     END
     *
     C           CTA       ADD  CTB       TOTAB   10       *ORDINO.PG. I *
     C           CTA       COMP 0                        80
     C           CTB       COMP 0                        81
    C   80                GOTO SUIT31
    C  N80 81             GOTO SUIT31
    C  N80N81             GOTO SUIT32
     C           SUIT31    TAG
     C           TOTAB     COMP 1                    808182
     C           CCOL      COMP 1                    8383
    C   82 83             GOTO SUIT33                      HELIO FLEXO
    C   82N83             GOTO SUIT35                      OFFSET1
    C   81 83             GOTO SUIT34                      SANS IMPRESSIO
    C   81N83             GOTO SUIT35                      OFFSET1
     C           TOTAB     COMP 3                        84
    C   80 84             GOTO SUIT35                      OFFSET1
    C   80N84             GOTO SUIT36                      TYPO
     C           SUIT32    TAG
     C           TOTAB     COMP 4                    808182
    C   81                GOTO SUIT33                      HELIO FLEXO
    C      80             GOTO SUIT35                      OFFSET1
     C           CTA       COMP 2                        83
    C   82 83             GOTO SUIT36                      TYPO
    C   82N83             GOTO SUIT37                      OFFSET2
     C           SUIT33    TAG
     C                     EXSR HELFLE
    C                     GOTO SUIT38                      ASSEMBLAGE
     C           SUIT34    TAG
     C                     EXSR SANIMP
    C                     GOTO SUIT38
     C           SUIT35    TAG
D1  C           TIMPA     IFEQ 'STOCKE'
    C           COUPEX    ANDEQ'R'
    C           TIMPA     OREQ 'STOCKE'
    C           COUPIN    ANDEQ'R'
     C                     SETON                     62
X1  C                     ELSE
     C                     SETOF                     62
F1  C                     END
     C                     EXSR OFFSET
    C                     GOTO SUIT38
     C           SUIT36    TAG
     C                     EXSR TYPO
    C                     GOTO SUIT38
     C           SUIT37    TAG
     C   61                SETON                     62
     C                     EXSR OFFSET
    C                     GOTO SUIT38
     *
     C           SUIT28    TAG
     C                     EXSR GAUFRE
    C                     GOTO SUIT38
     C           SUIT29    TAG
     C                     EXSR ONDACH
    C                     GOTO SUIT38
     C           SUIT30    TAG
     C                     EXSR CARCOM
    C                     GOTO SUIT38
     *
     C           SUIT38    TAG
     C  N90                EXSR ASSEM
    C           FINFOR    ENDSR
     C/SPACE 5
     *****************************************************************
     ** -plainboard- forf/bob ******************** COMPACT LOURD
     C/SPACE 1
    C           FORBOB    BEGSR
     *
     * CALL 581764 DU 07/02/2013
     C           *LIKE     DEFN FORH      WFH
     C           *LIKE     DEFN FORL      WFL
     C           *LIKE     DEFN LMINI     LMINI5
     * FORMAT OFFSET
D1  C           ZB12      IFEQ '/'
     C           FMINH     ADD  30        WFH
    C           FORH3     CABNEWFH       SUICT5     9898
     C           FMINL     ADD  19        WFL
    C           FORL3     CABNEWFL       SUICT5     9898
X1  C                     ELSE
     C           FMINH     ADD  19        WFH
    C           FORH3     CABNEWFH       SUICT5     9898
     C           FMINL     ADD  30        WFL
    C           FORL3     CABNEWFL       SUICT5     9898
F1  C                     END
     * FORMAT ONDULE
     C           FORH3     SUB  5         WFL
    C           ONDL      CABNEWFL       SUICT5     9898
     C           FORL3     SUB  5         WFH
    C           ONDH      CABNEWFH       SUICT5     9898
     * LAIZE MINI
     C                     MOVE FORH3     LMINI5
     C                     MOVE FORH3     WMIN    10
D1  C           WMIN      IFNE 0
     C                     ADD  1         LMINI5
     C                     MOVE '0'       LMINI5
F1  C                     END
     C                     SETOF                     98
D1  C           TDOCF     IFNE 'T'
    C           LMINI     CABNELMINI5    SUICT5     9898
F1  C                     END
    C                     GOTO FORB3
     C           SUICT5    TAG
     C                     SETON                     90    ERREUR.93
     C                     Z-ADD9         MSG              F.MESSAGE.
     *
    C           FORB3     ENDSR
     C/SPACE 5
    C           FORFOR    BEGSR
     *
     * FORMAT OFFSET
D1  C           ZB12      IFEQ '/'
     C           FMINH     ADD  30        WFH
    C           FORH3     CABNEWFH       SUICT6     9898
    C           FORH4     CABNEWFH       SUICT6     9898
     C           FMINL     ADD  19        WFL
    C           FORL3     CABNEWFL       SUICT6     9898
    C           FORL4     CABNEWFL       SUICT6     9898
X1  C                     ELSE
     C           FMINH     ADD  19        WFH
    C           FORH3     CABNEWFH       SUICT6     9898
    C           FORH4     CABNEWFH       SUICT6     9898
     C           FMINL     ADD  30        WFL
    C           FORL3     CABNEWFL       SUICT6     9898
    C           FORL4     CABNEWFL       SUICT6     9898
F1  C                     END
    C                     GOTO FORB4
     C           SUICT6    TAG
     C                     SETON                     90    ERREUR.93
     C                     Z-ADD9         MSG              F.MESSAGE.
     *
    C           FORB4     ENDSR
     *****************************************************************
     ** -plainboard- bob/bob ********************
     C/SPACE 1
    C           BORBOB    BEGSR
    C*
    C           RESTE1    CABEQ13        BOBB1
    C           RESTE1    CABEQ21        BOBB1
    C           RESTE1    CABEQ23        BOBB1
    C           RESTE1    CABEQ0         BOBB2
    C           RESTE1    CABEQ8         BOBB2
    C           RESTE1    CABEQ10        BOBB2
    C           RESTE1    CABEQ16        BOBB2
    C           RESTE1    CABEQ18        BOBB2
    C           RESTE1    CABEQ20        BOBB2
    C                     GOTO MSG94                      MSG.10
     C           BOBB1     TAG
     C           FMINH     ADD  16        FTHEOR  40
    C                     GOTO BOBB3
     C           BOBB2     TAG
     C           FMINH     ADD  21        FTHEOR
     C           BOBB3     TAG
     C                     MOVE FTHEOR    THEO
D1  C           THEO      IFNE 0
     C                     ADD  10        FTHEOR
     C                     MOVELFTHEOR    DEV     30
     C           DEV       MULT 10        DEVMIN  40
X1  C                     ELSE
     C                     Z-ADDFTHEOR    DEVMIN
F1  C                     END
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUP      IFEQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
     *
    C*                    END
     C                     MOVE ONDL      LALAI2  40
     C                     MOVE LALAI2    LAIZMM
D1  C           LAIZMM    IFNE 0
     C                     ADD  10        LALAI2
F1  C                     END
     C                     MOVELLALAI2    LHTEOR  30
D1  C           TDOCF     IFNE 'T'
    C           LHTEOR    CABNELMINI     MSG94            MSG.10
F1  C                     END
    C                     GOTO BOBB4
     C           MSG94     TAG
     C                     SETON                     90    ERREUR.94
     C                     Z-ADD10        MSG              F.MESSAGE.
     C           BOBB4     TAG
     *
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     ** -ondule- jupe ************************
     C/SPACE 1
    C           JUPE      BEGSR
    C*
     C           ONDL      SUB  FMINL     RESTE1
     C           ONDH      SUB  FMINH     RESTE2
     C                     MOVE ONDH      MMM     10
D1  C           MMM       IFNE 5                          ARRONDI
    C           MMM       ANDNE0                             CARCASSE
    C                     GOTO MSG95
F1  C                     END
D1  C           ZB12      IFEQ 'P'                        PERPENDICULAIRE
D2  C           RESTE1    IFNE 20
    C           RESTE1    ANDNE22
    C                     GOTO MSG95
F2  C                     END
D2  C           RESTE2    IFLT 14
    C           RESTE2    ORGT 25
    C                     GOTO MSG95
F2  C                     END
X1  C                     ELSE                            PARRALLELE
D2  C           RESTE1    IFNE 20
    C                     GOTO MSG95
F2  C                     END
D2  C           RESTE2    IFLT 20
    C           RESTE2    ORGT 30
    C                     GOTO MSG95
F2  C                     END
F1  C                     END
     *
     C           JUPEA     TAG
     C                     MOVE ONDL      LAIZMM
D1  C           LAIZMM    IFEQ 0
    C           LAIZMM    OREQ 5
     C                     Z-ADDONDL      LI      40
X1  C                     ELSE
D2  C           LAIZMM    IFLT 5
     C           5         SUB  LAIZMM    PLUS    10
     C           ONDL      ADD  PLUS      LI
F2  C                     END
D2  C           LAIZMM    IFGT 5
     C           10        SUB  LAIZMM    PLUS
     C           ONDL      ADD  PLUS      LI
F2  C                     END
F1  C                     END
     C                     MOVELLI        LTHEO   41
    C           LTHEO     CABNELMINI     MSG95
    C                     GOTO JUPE5
     *
     C           MSG95     TAG
     C                     SETON                     90    ERREUR.95
     C                     Z-ADD11        MSG              F.MESSAGE
     *
     C           JUPE5     TAG
D1  C           ZB12      IFEQ 'P'
     C           FMINH     ADD  20        FTHEO   40
X1  C                     ELSE
     C           FMINH     ADD  14        FTHEO
F1  C                     END
     C                     MOVE FTHEO     THEO    10
D1  C           THEO      IFNE 0
     C                     ADD  10        FTHEO
     C                     MOVELFTHEO     DEVCM   30
     C           DEVCM     MULT 10        DEVMIN
X1  C                     ELSE
     C                     MOVELFTHEO     DEVMIN  40
F1  C                     END
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUP      IFEQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE  GAUFRE  ********************************
    C           GAUFRE    BEGSR                           *ORDINO.PG. V *
    C*
     C                     EXSR RAZ
     *
     C           FMINL     ADD  22        THEOR1  40
     C           ONDL      DIV  THEOR1    NB1     40
     C           THEOR1    MULT NB1       THEOR1
     C           ONDL      COMP THEOR1               9090
     C      90             Z-ADD59        MSG                ERREUR 59
    C      90             GOTO FINFRE
     C           FMINH     ADD  30        THEOR2  40
     C           ONDH      DIV  THEOR2    NB2     40
     C           NB2       COMP 1                      9080
     C      90             Z-ADD60        MSG                ERREUR 60
    C      90             GOTO FINFRE
    C         80          GOTO SUIT39
     C           THEOR2    SUB  12        THEOR2
     C           ONDH      SUB  30        THEORN  40
     C           THEORN    DIV  THEOR2    NB2
     C           THEOR2    MULT NB2       THEOR3  50
     C           THEOR3    ADD  30        THEOR3
     C           THEOR3    COMP ONDH                 9090
     C      90             Z-ADD60        MSG                ERREUR 60
    C      90             GOTO FINFRE
     C           SUIT39    TAG
     C           NB1       MULT NB2       NBTOT   40
     C           POSFO     MULT NBTOT     POSTOT  40
     C           POSTOT    COMP POSF1A               9090
     C      90             Z-ADD61        MSG                ERREUR 61
    C      90             GOTO FINFRE
    C*                    END
     C                     MOVE ONDL      LAIZMM  10
     C           LAIZMM    COMP 0                        80
     C     N80   ONDL      ADD  10        LAIZE   40
     C         80          Z-ADDONDL      LAIZE
     C                     MOVELLAIZE     LAIZC   30
     C           LAIZC     COMP LMINI                9090
     C      90             Z-ADD61        MSG                ERREUR 61
    C      90             GOTO FINFRE
     *
    C           FINFRE    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE ONDULE ACHETE ***************************
    C           ONDACH    BEGSR                           *ORDINO.PG. X *
     *
     C                     EXSR RAZ
     *
    C* TMAFBU INC0190906 23/10/2014
    C*          RESTE2    COMP 20                   9090
     C           RESTE2    COMP 22                   9090
     C     N90   RESTE1    COMP 20                   9090
     C         90          Z-ADD28        MSG                ERREUR 28
    C         90          GOTO SUIT41
    C*
     C           LMINI     COMP 0                    9090
     C         90          Z-ADD28        MSG                ERREUR 28
     *
    C           SUIT41    ENDSR
     *
     C/SPACE 5
     ********************************************************************
     ** CONTROLE CARTON COMPACT  *************************
    C           CARCOM    BEGSR                           *ORDINO.PG. Y *
     *
     C                     EXSR RAZ
     *
     C           RESTE2    COMP 10                   869080
    C   90                GOTO SUIT42
     C         86RESTE2    COMP 14                   869080
    C   90                GOTO SUIT42
     C         80RESTE1    COMP 25                   8190
    C   90                GOTO SUIT42
     C      80 81RESTE1    COMP 25                   9090
    C   90                GOTO SUIT42
     C      86   RESTE2    COMP 25                   829083
    C   90                GOTO SUIT42
     C      86 82RESTE2    COMP 25                   839083
    C   90                GOTO SUIT42
     C      86 83RESTE1    COMP 10                   8590
    C   90                GOTO SUIT42
     C      86 85RESTE1    COMP 14                   9090
    C   90                GOTO SUIT42
     *
    C           NCXH      CABEQ1         SUIT43
     C           TIMP3     COMP 1                    8080
     C   80      LMINI     COMP 0                    9090
    C   80 90             GOTO SUIT42
    C   80                GOTO SUIT43
     C                     Z-ADDONDL      LALAIZ
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                    9999
     C   99      LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C           LTHEOR    COMP LMINI                    80
    C   80                GOTO SUIT43
     C   99      LALAIZ    SUB  10        LALAIZ
     C           LALAIZ    ADD  15        LALAIZ
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                    9999
     C   99      LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C           LTHEOR    COMP LMINI                9090
    C   90                GOTO SUIT42
     *
    C                     GOTO SUIT43
     C           SUIT42    TAG
     C                     Z-ADD29        MSG                ERREUR  29
    C           SUIT43    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE SANS IMPRESSION  ************************
    C           SANIMP    BEGSR                           *ORDINO.PG. II*
     *
     C                     EXSR RAZ
     *
     C           RESTE2    COMP 14                   819080
    C   90                GOTO SUIT44
     C      81   RESTE2    COMP 18                   819080
    C   90                GOTO SUIT44
     C      80   RESTE1    COMP 20                   829086
    C   90                GOTO SUIT44
     C      80 82RESTE1    COMP 22                   909086
    C   90                GOTO SUIT44
     C      81   RESTE2    COMP 20                   839084
    C   90                GOTO SUIT44
     C      81 83RESTE2    COMP 22                   909084
    C   90                GOTO SUIT44
     C      81 84RESTE1    COMP 16                   859087
    C   90                GOTO SUIT44
     C      81 85RESTE1    COMP 20                   909087
    C   90                GOTO SUIT44
     *
    C   80 86             GOTO SUIT45
     *
    C   84 87             GOTO SUIT46
     *
    C                     GOTO SUIT44
     *
     C           SUIT45    TAG                             *ORDINO.PG.III*
     *
     C           SUIT46    TAG
D1  C           USOND     IFEQ 3
     C           LALAIZ    ADD  20        LALAIZ
F1  C                     END
     C                     MOVE LALAIZ    LAIZMM  10
     C           LAIZMM    COMP 0                    838384
     C      84             MOVELLALAIZ    LTHEOR  30
     C         83LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C                     SETOF                     90
D1  C           TDOCF     IFNE 'T'
     C           LTHEOR    COMP LMINI                9090
F1  C                     END
    C      90             GOTO SUIT44
    C                     GOTO SUIT47
     *
     C           SUIT44    TAG
     C                     Z-ADD39        MSG                ERREUR 39
    C           SUIT47    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE HELIO FLEXO *****************************
    C           HELFLE    BEGSR                           *ORDINO.PG. IV*
     *
     C                     EXSR RAZ
     *
     C           RESTE1    COMP 20                   808182
     C      81   RESTE1    COMP 10                   819081
    C   90                GOTO SUIT48
     C      81   RESTE2    COMP 20                   819081
    C   90                GOTO SUIT48
     C      80   RESTE1    COMP 22                   909082
    C   90                GOTO SUIT48
     C      82   RESTE2    COMP 14                     90
    C   90                GOTO SUIT48
     *
     C   81      FMINH     ADD  20        FTHEO   40
     C   82      FMINH     ADD  14        FTHEO
     C                     MOVE FTHEO     THEO    10
D1  C           THEO      IFNE 0
     C                     ADD  10        FTHEO
     C                     MOVELFTHEO     DEVCM   30
     C           DEVCM     MULT 10        DEVMIN
X1  C                     ELSE
     C                     MOVELFTHEO     DEVMIN  40
F1  C                     END
D1  C           ONDH      IFLT DEVMIN
     C                     Z-ADDONDH      DEVMIN
F1  C                     END
D1  C           COUP      IFEQ 'C'
     C                     Z-ADD*ZEROS    DEVMIN
F1  C                     END
     *
D1  C           USOND     IFEQ 3
     C           LALAIZ    ADD  20        LALAIZ
X1  C                     ELSE
     C           LALAIZ    ADD  10        LALAIZ
F1  C                     END
     C                     MOVE LALAIZ    LAIZMM  10
     C           LAIZMM    COMP 0                    9999
     C      99   LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     *
D1  C           TDOCF     IFNE 'T'
     C           LTHEOR    COMP LMINI                909080*ORDINO.PG.  V*
F1  C                     END
    C      80             GOTO SUIT49
     *
D1  C           USOND     IFNE 3
     C           LALAIZ    SUB  10        LALAIZ
     C      99   LALAIZ    SUB  10        LALAIZ
     C           LALAIZ    ADD  5         LALAIZ
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                        80*ORDINO.PG. VI*
     C     N80   LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C                     SETOF                     8190
D2  C           TDOCF     IFNE 'T'
     C           LTHEOR    COMP LMINI                909081
X2  C                     ELSE
    C                     GOTO SUIT49
F2  C                     END
    C      81             GOTO SUIT49
F1  C                     END
     C   90                Z-ADD27        MSG               ERREUR 27
    C   90                GOTO SUIT49
     *
     C           SUIT48    TAG
     C                     Z-ADD40        MSG               ERREUR 40
    C           SUIT49    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE TYPO ************************************
    C           TYPO      BEGSR                           *ORDINO.PG.VII*
     *
     C                     EXSR RAZ
     *
     C           RESTE2    COMP 20                   809082
    C   90                GOTO SUIT50
     C      82   RESTE1    COMP 20                   838485
     C      83   RESTE1    COMP 22                   909085
    C         85          GOTO SUIT51
    C   90                GOTO SUIT50
     C      80   RESTE2    COMP 22                   819087
     C      87   RESTE1    COMP 20                   848485
    C   90                GOTO SUIT50
    C         85          GOTO SUIT51
     C      84   RESTE1    COMP 10                   909085
    C   90                GOTO SUIT50
    C         85          GOTO SUIT51
     C      81   RESTE2    COMP 24                   9090
    C   90                GOTO SUIT50
     C      81   RESTE1    COMP 20                     9085
    C   90                GOTO SUIT50
    C         85          GOTO SUIT51
     C           RESTE1    COMP 22                   9090
    C   90                GOTO SUIT50
     *
     C           SUIT51    TAG                             *ORDIN.PG.VIII*
D1  C           USOND     IFEQ 3
     C           LALAIZ    ADD  20        LALAIZ
X1  C                     ELSE
     C           LALAIZ    ADD  10        LALAIZ
F1  C                     END
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                    8080
     C      80   LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C                     SETOF                     90
D1  C           TDOCF     IFNE 'T'
     C           LTHEOR    COMP LMINI                9090
F1  C                     END
    C   90                GOTO SUIT50
    C                     GOTO SUIT52
     *
     C           SUIT50    TAG
     C                     Z-ADD26        MSG               ERREUR 26
    C           SUIT52    ENDSR
     C/SPACE 5
     ********************************************************************
     **  0FFSET SEUL OU AVEC TYPO    *********************
     **  OFFSET AVEC HELIO OU FLEXO  *********************
    C           OFFSET    BEGSR                           *ORDINO.PG. IX*
     *
     C                     EXSR RAZ
    C      37   TIMPIN    CABEQ4         SUIT54
    C      35   TIMPEX    CABEQ4         SUIT54
     *
D1  C           *IN62     IFEQ '0'
D2  C           RESTE1    IFEQ 22
D3  C           RESTE2    IFEQ 19
    C                     GOTO SUIT55
X3  C                     ELSE
    C                     GOTO SUIT53
F3  C                     END
X2  C                     ELSE
D3  C           RESTE1    IFNE 15
    C                     GOTO SUIT53
X3  C                     ELSE
D4  C           ONDUL     IFEQ 2
D5  C           RESTE2    IFEQ 25
    C                     GOTO SUIT55
X5  C                     ELSE
    C                     GOTO SUIT53
F5  C                     END
X4  C                     ELSE
D5  C           RESTE2    IFEQ 22
    C                     GOTO SUIT55
X5  C                     ELSE
    C                     GOTO SUIT53
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
    C*
X1  C                     ELSE
D2  C           RESTE1    IFEQ 22
D3  C           RESTE2    IFLT 16
    C                     GOTO SUIT53
X3  C                     ELSE
     C                     MOVE ONDH      MMM     10
D4  C           MMM       IFEQ 0
    C                     GOTO SUIT55
X4  C                     ELSE
    C                     GOTO SUIT53
F4  C                     END
F3  C                     END
X2  C                     ELSE
D3  C           RESTE1    IFNE 15
    C                     GOTO SUIT53
X3  C                     ELSE
D4  C           RESTE2    IFLT 19
    C                     GOTO SUIT53
X4  C                     ELSE
     C                     MOVE ONDH      MMM     10
D5  C           MMM       IFEQ 0
    C                     GOTO SUIT55
X5  C                     ELSE
    C                     GOTO SUIT53
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
     C           SUIT55    TAG
    C* SI MODIF CALCUL NORMES LAIZE MINI
D1  C           FORLA     IFEQ *ZEROS
     C                     Z-ADDONDL      FORLA
F1  C                     END
     C                     MOVE FORLA     FORMM   10
     C                     MOVE FORLA     LTHEO
D1  C           FORMM     IFNE 0
     C                     ADD  1         LTHEO
     C                     MOVE '0'       LTHEO
F1  C                     END
D1  C           USCOL     IFNE 4
    C           USCOL     OREQ 4
    C           TIMP3     ANDEQ2
    C           USCOL     OREQ 4
    C           TIMP5     ANDEQ2
    C           USCOL     OREQ 4
    C           TIMPEX    ANDEQ2
    C           USCOL     OREQ 4
    C           TIMPIN    ANDEQ2
D2  C           FORLA     IFGT 1200
     C                     ADD  2         LTHEO
X2  C                     ELSE
     C                     ADD  1         LTHEO
F2  C                     END
F1  C                     END
D1  C           LTHEO     IFNE LMINI
     C           SUIT53    TAG
     C                     Z-ADD25        MSG
     C                     SETON                     90
F1  C                     END
    C           SUIT54    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DES CODES ASSEMBLAGES *******************
    C           ASSEM     BEGSR
     *
     C                     EXSR RAZ
     *
     C           COFEN     COMP 0                    8080
     C   80      COFEN     COMP 21                   9090
     C   80 90   COFEN     COMP 22                   9090
     C   80 90   COFEN     COMP 20                   9090
    C   90                GOTO SUIT59
     *
     C           FACON     COMP 7                    808182
    C      81             GOTO SUIT58                     * OK FIN SP.
     C         82COAS1     COMP 20                   90  90
    C   90                GOTO SUIT59                      ANO- 8
     C      80   COAS1     COMP 21                     9090
    C   90                GOTO SUIT59                      ANO. 8
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE COAS1     PXVALE
     C           CLEPAR    CHAINPARAME               8390
     C      83             SETON                     90
    C      90             GOTO SUIT59                      ANO. 8
     C           COAS2     COMP 0                        84
    C      84             GOTO SUIT58                     * OK FIN SP
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE COAS2     PXVALE
     C           CLEPAR    CHAINPARAME               8390
     C      83             SETON                     90
    C      90             GOTO SUIT59                      ANO. 8
     *
     C           SUIT59    TAG
     C                     Z-ADD8         MSG
    C           SUIT58    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE  BOBINETTE  DECOUPE  REGUL.   ***********
    C           RLXBOB    BEGSR                           *ORDINO.PG. I *
     *
     C                     EXSR RAZ
D1  C           NBPAP     IFEQ 1                          SUR COMPLEXE
    C           NCXH      ANDEQ1
D2  C           LMINI     IFNE *ZEROS
     C                     SETON                       90
     C                     Z-ADD42        MSG               ANO. 42
    C                     GOTO SUIT60
F2  C                     END
X1  C                     ELSE
D2  C           LMINI     IFEQ *ZEROS
     C                     SETON                       90
     C                     Z-ADD42        MSG               ANO. 42
    C                     GOTO SUIT60
F2  C                     END
F1  C                     END
D1  C           DECH      IFLE *ZEROS
     C                     Z-ADD62        MSG        90     ANO. 62
    C                     GOTO SUIT60
F1  C                     END
D1  C           DECL      IFLE *ZEROS
     C                     Z-ADD65        MSG        90
    C                     GOTO SUIT60
F1  C                     END
     *
     C           LMINI     MULT 10        LMIMI   40       LAIZE EN MM.
     C           LMIMI     DIV  DECL      X       40
     C           DECL      MULT X         LALAIZ
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                    999980
     C      99   LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C           LTHEOR    COMP LMINI                    80
    C      80             GOTO SUIT60                     * OK FIN SP.
     C      99   LALAIZ    SUB  10        LALAIZ
     C           LALAIZ    ADD  19        LALAIZ
     C                     MOVE LALAIZ    LAIZMM
     C           LAIZMM    COMP 0                    999980
     C      99   LALAIZ    ADD  10        LALAIZ
     C                     MOVELLALAIZ    LTHEOR
     C           LTHEOR    COMP LMINI                909080
    C      80             GOTO SUIT60
     C         90          Z-ADD42        MSG               ANO. 42
     *
    C           SUIT60    ENDSR
     C/SPACE 5
     ********************************************************************
     ** SF. SUR LUGANO 5  * RLX DECOUPE LUGANO 9 *********
    C           LUGANO    BEGSR                           *ORDINO.PG. K *
     *
     C                     EXSR RAZ
D1  C           ONDL      IFLE *ZEROS
     C                     Z-ADD66        MSG        90     ANO. 64
    C                     GOTO SUIT61
F1  C                     END
D1  C           DECL      IFLE *ZEROS
     C                     Z-ADD65        MSG        90     ANO. 63
    C                     GOTO SUIT61
F1  C                     END
     *
     C           FACON     COMP 5                        80
     C      80   ONDH      COMP DECH                 9090
     C   90                Z-ADD44        MSG               ANO. 44
    C   90                GOTO SUIT61
     C           ONDL      DIV  DECL      X1      30
     C           DECL      MULT X1        LONGA   40
     C           LONGA     ADD  19        LONGA
     C           LONGA     COMP ONDL                 9090
     C   90                Z-ADD45        MSG               ANO. 45
    C   90                GOTO SUIT61
     C                     Z-ADDX1        POSF1A
     C                     Z-ADD0         POSF1B
     C           ACOTE     COMP 0                    8080
     C      80   ACOTE     DIV  DECL      X2      30
     C      80   DECL      MULT X2        LONGB   40
     C      80   LONGB     ADD  19        LONGB
     C      80   LONGB     COMP ACOTE                9090  *ORDINO.PG. L *
     C   90                Z-ADD46        MSG               ANO. 46
    C   90                GOTO SUIT61
     C      80             Z-ADDX2        POSF2A
     C      80             Z-ADD0         POSF2B
     C           LMINI     MULT 10        LMIMI
     C           LMIMI     DIV  ONDL      X
     C           ONDL      MULT X         LAIZL   40
     C           LAIZL     ADD  ACOTE     LAIZL
     C                     MOVE LAIZL     LAIZMM
     C           LAIZMM    COMP 0                    8080
     C      80   LAIZL     ADD  10        LAIZL
     C                     MOVELLAIZL     LTHEOR
     C           LTHEOR    COMP LMINI                9090
     C   90                Z-ADD58        MSG               ANO. 58
     *
    C           SUIT61    ENDSR
     C/SPACE 5
     ********************************************************************
     **  CONTROLE  GAUFRE MASSICOT 5  ********************
    C           MASSIC    BEGSR                           *ORDINO.PG. M *
     *
     C                     EXSR RAZ
D1  C           DECH      IFLE *ZEROS
     C                     Z-ADD62        MSG        90     ANO. 62
    C                     GOTO SUIT62
F1  C                     END
D1  C           DECL      IFLE *ZEROS
     C                     Z-ADD65        MSG        90     ANO. 63
    C                     GOTO SUIT62
F1  C                     END
     *
     C           ONDL      DIV  DECL      X1
     C           DECL      MULT X1        LONGA
     C           LONGA     ADD  19        LONGA
     C           LONGA     COMP ONDL                 9090
     C   90                Z-ADD45        MSG               ANO. 45
    C   90                GOTO SUIT62
     C           ONDH      SUB  30        ONDHA   40
     C           ONDHA     DIV  DECH      X2
     C           DECH      MULT X2        LONGB
     C           LONGB     ADD  30        LONGB
     C           LONGB     COMP ONDH                 9090  *ORDINO.PG. N *
     C   90                Z-ADD47        MSG               ANO. 47
    C   90                GOTO SUIT62
     C                     MOVE ONDL      LAIZMM
     C           LAIZMM    COMP 0                    8080
     C      80   ONDL      ADD  10        LAIZL
     C     N80             Z-ADDONDL      LAIZL
     C                     MOVELLAIZL     LTHEOR
     C           LTHEOR    COMP LMINI                9090
     C   90                Z-ADD48        MSG               ANO. 48
    C   90                GOTO SUIT62
     C           X1        MULT X2        POSF1A
     C                     Z-ADD0         POSF1B
     *
    C           SUIT62    ENDSR
     C/SPACE 5
     ********************************************************************
     ** DF SUR LUGANO OU MITRAILLEUSE FACONNAGE 5 ********
    C           DFLUG     BEGSR                           *ORDINO.PG. 0 *
     *
     C                     EXSR RAZ
     C                     Z-ADD0         ER58
D1  C           ONDL      IFLE *ZEROS
     C                     Z-ADD66        MSG        90     ANO. 64
    C                     GOTO SUIT64
F1  C                     END
D1  C           DECH      IFLE *ZEROS
     C                     Z-ADD62        MSG        90     ANO. 62
    C                     GOTO SUIT64
F1  C                     END
D1  C           DECL      IFLE *ZEROS
     C                     Z-ADD65        MSG        90     ANO. 63
    C                     GOTO SUIT64
F1  C                     END
     *
     C           ONDL      DIV  DECL      X1
     C           DECL      MULT X1        LONGA
     C           ONDH      DIV  DECH      X2
     C           DECH      MULT X2        LONGB
     C           LONGA     COMP ONDL                     80
     C   80      LONGB     COMP ONDH                     81
    C   80 81             GOTO SUIT64
     C   80N81   LONGB     ADD  19        LONGB
    C   80N81             GOTO SUITA
     C  N80      LONGA     ADD  19        LONGA
     C  N80      LONGB     COMP ONDH                     81
    C  N80 81             GOTO SUITB
     C  N80N81   LONGB     ADD  19        LONGB
    C  N80N81             GOTO SUITC
     C           SUITA     TAG                             *ORDINO.PG. P *
     C           LONGB     COMP ONDH                 9090
     C   90                Z-ADD49        MSG               AHO- 49
    C   90                GOTO SUIT63
     C           X1        COMP 6                    82
     C      82   ONDL      COMP ONDH                   90
     C   90                Z-ADD50        MSG               ANO. 50
    C   90                GOTO SUIT63
     C      82   X1        SUB  1         X1
    C      82             GOTO SUIT64
     *
     C           SUITB     TAG
     C           LONGA     COMP ONDL                 9090
     C   90                Z-ADD51        MSG               ANO. 51
    C   90                GOTO SUIT63
     C           LONGB     COMP DECH                     89
    C      89             GOTO SUIT64
     C           X2        COMP 6                    828989
    C      89             GOTO SUIT64
     C         82ONDL      COMP ONDH                 90
     C   90                Z-ADD52        MSG               ANO. 52
    C   90                GOTO SUIT63
     *
     C           SUIT64    TAG
     C           X2        SUB  1         X2                AVANT SI + 6 (82)
     C           X1        MULT X2        POSF1A
     C                     Z-ADD0         POSF1B
    C                     GOTO SUITD
     *
     C           SUITC     TAG                             *ORDINO.PG. Q *
     C           LONGA     COMP ONDL                 9090
     C   90                Z-ADD53        MSG               ANO. 53
     C     N90   LONGB     COMP ONDH                 9090
     C   90                Z-ADD53        MSG               ANO. 53
    C   90                GOTO SUIT63
    C                     GOTO SUIT64
     *
     C           SUITD     TAG
     C           ACOTE     COMP 0                        89
    C      89             GOTO SUITE1
     C           ACOTE     DIV  DECL      Y1      30
     C           DECL      MULT Y1        LONGB   40
     C      80   LONGB     COMP ACOTE                9090
     C   90                Z-ADD56        MSG               ANO. 56
    C   90                GOTO SUIT63
    C      80             GOTO SUITE2
     C           LONGB     ADD  19        LONGB
     C           LONGB     COMP ACOTE                9090
     C      90             Z-ADD57        MSG
    C      90             GOTO SUIT63                      ANO. 57
    C                     GOTO SUITE2
     *
     C           SUITE2    TAG                             *ORDINO.PG. R *
     C     N82   Y1        MULT X2        POSF2A
     C     N82             Z-ADD0         POSF2B
    C     N82             GOTO SUITE1
     C   82 80N81Y1        SUB  1         Y1
     C   82 80N81Y1        MULT X2        POSF2A
     C   82 80N81          Z-ADD0         POSF2B
    C   82 80N81          GOTO SUITE1
     C   82N80 81X2        SUB  1         X2
     C   82N80 81X2        MULT Y1        POSF2A
     C   82N80 81          Z-ADD0         POSF2B
    C   82N80 81          GOTO SUITE1
     *
     C           SUITE1    TAG
     C           LMINI     MULT 10        LMIMI
     C           LMIMI     DIV  ONDL      X
     C           ONDL      MULT X         LAIZL
     C           LAIZL     ADD  ACOTE     LAIZL
     C   80 81   LAIZL     ADD  19        LAIZL
     C                     Z-ADDLAIZL     LAIB    40
     C                     MOVE LAIZL     LAIZMM  10
     C           LAIZMM    COMP 0                    8989
     C      89   LAIZL     ADD  10        LAIZL
     C                     MOVELLAIZL     LTHEOR
     C           LTHEOR    COMP LMINI                    89
    C      89             GOTO SUIT63
     *
     C                     Z-ADD1         ER58    10       *ORDINO.PG.S
     C     N80
     COR    80 81
    COR 80N81 82          GOTO SUIT63
     C                     Z-ADD0         ER58
     C           LAIB      ADD  19        LAIB
     C                     MOVE LAIB      LAIZMM
     C           LAIZMM    COMP 0                    8989
     C      89   LAIB      ADD  10        LAIB
     C                     MOVELLAIB      LTHEOR
     C           LTHEOR    COMP LMINI                    89
    C      89             GOTO SUIT63
     C                     Z-ADD1         ER58
     C           SUIT63    TAG
     C           ER58      COMP 0                    9090
     C      90             Z-ADD54        MSG               ANO. 54
     *
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE DECOUPES REGULIERS  *********************
    C           DECO      BEGSR                           *ORDINO-PG. J *
     *
     C                     EXSR RAZ
     *
     C           DECH      COMP *ZEROS                   90
     C         90          Z-ADD30        MSG               ANO. 30
     C     N90             EXSR RLXBOB                     *ORDINO.PG. I *
     *
    C                     ENDSR
     C/SPACE 5
    C********************************************************************
     ** CONTROLE FACONNAGE ZERO **************************
    C           FACON0    BEGSR                           *ORDINO.PG. XI*
     *
     C                     EXSR RAZ
     *
     C           FORL3     COMP *ZEROS                   80
     C      80   LMINI     COMP 0                        90
     C     N80   LMINI     COMP 0                    9090
     C   90                Z-ADD23        MSG               ANO. 15
     *
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** PRE-TRAITEMENT DU FORMAT 3 ** FORMATAGE DES ZONES *
     *                                                    *ORDINO.PG. 3A*
    C           PRE03     BEGSR
     C                     EXSR ZERO3
     C                     SETOF                     262793
     C                     SETOF                     535455
     C                     SETOF                     565758
     C                     SETOF                     5960
     C                     SETOF                     2223
     *
     C                     MOVE *BLANKS   TIMEX   6
     C                     MOVE *BLANKS   TREEX   6
     C                     MOVE *BLANKS   TIMIN   6
     C                     MOVE *BLANKS   TREIN   6
     C                     MOVE *BLANKS   USIEXT
     C                     MOVE *BLANKS   USPIE   10
     C                     MOVE *BLANKS   USPII   10
D1  C           USEXT     IFNE 0
     C                     MOVE USEXT     ETSEXT  10
     C                     MOVE USEXT     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    USIEXT
F1  C                     END
     *
     C                     MOVE *BLANKS   USIINT
D1  C           USINT     IFNE 0
     C                     MOVE USINT     ETSINT  10
     C                     MOVE USINT     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    USIINT
F1  C                     END
     *
     C                     SETOF                     28
     C           PAPI1     COMP *BLANKS                  89  1ER SUPPORT
    C   89                GOTO PLUS1                          EXTERIEUR
     C           TIMP1     COMP 0                    8989
    C      89             GOTO PLU1
D1  C           NIMPE1    IFEQ *BLANKS
    C           NIMPE1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS1
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPE1    Z4      40
     C                     MOVE NIMPE2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMEX
     C                     MOVE USINEP    USPIE
     C                     MOVE COULSB    COUEXB
     C                     MOVE COUPS     COUPEX
     C                     MOVE TSSS      TSEXT
     C                     MOVE GRAPS     GRAPEX
     C                     MOVE TVERS     TVEREX
     C                     MOVE ENCRS     ENCREX
     C                     MOVE CVERS     CVEREX
     C                     MOVE ENSPS     ENSPEX
     C                     MOVE APLAS     APLAEX
     C                     MOVE ORCUS     ORCUEX
     C                     MOVE UVS       UVEXT
     C                     MOVE NATES     NATEEX
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1E
     C                     MOVE OFPA2S    OFPA2E
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     011113
     C                     SETON                     151735
     C                     SETON                     19
     C                     EXSR SPLUSP
     C                     MOVE TREP1     TREPEX
     C                     MOVE RCOU1     RCOUEX
     C                     MOVE RENC1     RENCEX
     C                     MOVE RETS1     RETSEX
     C                     MOVE RGRA1     RGRAEX
     C                     MOVE RVER1     RVEREX
     C                     MOVE RCVE1     RCVERE
     C                     MOVE RUV1      RUVEX
    C*                    MOVE RNAT1     RNATEX
    C                     GOTO PLUS1
     C           PLU1      TAG
    C*                    MOVE GRAP1     GRAPEX
     C                     MOVE UV1       UVEXT
    C*                    MOVE NATE1     NATEEX
     C                     MOVE ESPE1     FLUOEX
     C                     MOVE CESPE1    CFLUOE
     C                     MOVE RESPE1    FLUORE
     C                     MOVE RCESP1    CFLURE
     C                     MOVE RAPLA1    APLARE
     C                     MOVE OFPA11    OFPA1E
     C                     MOVE OFPA21    OFPA2E
     C                     MOVE ROFP11    OFPR1E
     C                     MOVE ROFP21    OFPR2E
     C                     MOVE RETS1     RETSEX
     C                     MOVE RGRA1     RGRAEX
     C                     MOVE RUV1      RUVEX
    C*                    MOVE RNAT1     RNATEX
     C           TIMP1     COMP 1                        10
     C           TIMP1     COMP 2                        20
     C           TIMP1     COMP 3                        30
     C           TIMP1     COMP 4                        40
     C   10                SETON                     13
     C      20             SETON                     13
     C         30          SETON                     13  17
     C                     SETON                     01
     C                     MOVE TS1       TSEXT   1
     C                     MOVE ENCR1     ENCREX  21
     C                     MOVE TVER1     TVEREX  1
     C                     MOVE CVER1     CVEREX  21
     C                     MOVE ENSP1     ENSPEX  21
     C                     MOVE APLA1     APLAEX  1
    C*                    MOVE ORCU1     ORCUEX  2
     C                     MOVE COUL1B    COUEXB
    C*                    MOVE COUP1     COUPEX
     C                     MOVE TREP1     TREPEX  10
     C                     MOVE RCOU1     RCOUEX  10
     C                     MOVE RENC1     RENCEX  21
     C                     MOVE RVER1     RVEREX  1
     C                     MOVE RCVE1     RCVERE  21
     C                     MOVE TIMP1     TIMPEX
     C                     MOVE KDIF1     KDIFEX  21
     C                     MOVE RDIF1     RDIFEX  21
     C           PLUS1     TAG
     **
     ** 2EME SUPPORT                                       EXTERIEUR
     **
     C           PAPI2     COMP *BLANKS                  89
    C   89                GOTO PLUS2
     C           TIMP2     COMP 0                    8989
    C      89             GOTO PLU2
D1  C           NIMPE1    IFEQ *BLANKS
    C           NIMPE1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS2
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPE1    Z4      40
     C                     MOVE NIMPE2    ZO4     40
     C                     MOVE ZON2      ZO4
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMEX
     C                     MOVE USINEP    USPIE
     C                     MOVE COULSB    COUEXB
     C                     MOVE COUPS     COUPEX
     C                     MOVE TSSS      TSEXT
     C                     MOVE GRAPS     GRAPEX
     C                     MOVE TVERS     TVEREX
     C                     MOVE ENCRS     ENCREX
     C                     MOVE CVERS     CVEREX
     C                     MOVE ENSPS     ENSPEX
     C                     MOVE APLAS     APLAEX
     C                     MOVE ORCUS     ORCUEX
     C                     MOVE UVS       UVEXT
     C                     MOVE NATES     NATEEX
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1E
     C                     MOVE OFPA2S    OFPA2E
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     021113
     C                     SETON                     151735
     C                     SETON                     19
     C                     EXSR SPLUSP
     C                     MOVE TREP2     TREPEX
     C                     MOVE RCOU2     RCOUEX
     C                     MOVE RENC2     RENCEX
     C                     MOVE RETS2     RETSEX
     C                     MOVE RGRA2     RGRAEX
     C                     MOVE RVER2     RVEREX
     C                     MOVE RCVE2     RCVERE
     C                     MOVE RUV2      RUVEX
     C                     MOVE RNAT2     RNATEX
    C                     GOTO PLUS2
     C           PLU2      TAG
     C                     MOVE GRAP2     GRAPEX
     C                     MOVE UV2       UVEXT
     C                     MOVE NATE2     NATEEX
     C                     MOVE ESPE2     FLUOEX
     C                     MOVE CESPE2    CFLUOE
     C                     MOVE RESPE2    FLUORE
     C                     MOVE RCESP2    CFLURE
     C                     MOVE RAPLA2    APLARE
     C                     MOVE OFPA12    OFPA1E
     C                     MOVE OFPA22    OFPA2E
     C                     MOVE ROFP12    OFPR1E
     C                     MOVE ROFP22    OFPR2E
     C                     MOVE RETS2     RETSEX
     C                     MOVE RGRA2     RGRAEX
     C                     MOVE RUV2      RUVEX
     C                     MOVE RNAT2     RNATEX
     C           TIMP2     COMP 1                        10
     C           TIMP2     COMP 2                        20
     C           TIMP2     COMP 3                        30
     C           TIMP2     COMP 4                        40
     C   10                SETON                     13
     C      20             SETON                     13
     C         30          SETON                     13  17
     C                     SETON                     02
     C                     MOVE TS2       TSEXT
     C                     MOVE ENCR2     ENCREX
     C                     MOVE TVER2     TVEREX
     C                     MOVE CVER2     CVEREX
     C                     MOVE ENSP2     ENSPEX
     C                     MOVE APLA2     APLAEX
     C                     MOVE ORCU2     ORCUEX
     C                     MOVE COUL2B    COUEXB
     C                     MOVE COUP2     COUPEX
     C                     MOVE TREP2     TREPEX
     C                     MOVE RCOU2     RCOUEX
     C                     MOVE RENC2     RENCEX
     C                     MOVE RVER2     RVEREX
     C                     MOVE RCVE2     RCVERE
     C                     MOVE TIMP2     TIMPEX
     C                     MOVE KDIF2     KDIFEX  21
     C                     MOVE RDIF2     RDIFEX  21
     C           PLUS2     TAG
     **
     ** 3EME SUPPORT                                       EXTERIEUR
     **
     C           PAPI3     COMP *BLANKS                  89
    C   89                GOTO PLUS3
     C           TIMP3     COMP 0                    8989
    C      89             GOTO PLU3
D1  C           NIMPE1    IFEQ *BLANKS
    C           NIMPE1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS3
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPE1    Z4      40
     C                     MOVE NIMPE2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMEX
     C                     MOVE USINEP    USPIE
     C                     MOVE COULSB    COUEXB
     C                     MOVE COUPS     COUPEX
     C                     MOVE TSSS      TSEXT
     C                     MOVE GRAPS     GRAPEX
     C                     MOVE TVERS     TVEREX
     C                     MOVE ENCRS     ENCREX
     C                     MOVE CVERS     CVEREX
     C                     MOVE ENSPS     ENSPEX
     C                     MOVE APLAS     APLAEX
     C                     MOVE ORCUS     ORCUEX
     C                     MOVE UVS       UVEXT
     C                     MOVE NATES     NATEEX
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1E
     C                     MOVE OFPA2S    OFPA2E
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     031113
     C                     SETON                     151735
     C                     SETON                     19
     C                     EXSR SPLUSP
     C                     MOVE TREP3     TREPEX
     C                     MOVE RCOU3     RCOUEX
     C                     MOVE RENC3     RENCEX
     C                     MOVE RETS3     RETSEX
     C                     MOVE RGRA3     RGRAEX
     C                     MOVE RVER3     RVEREX
     C                     MOVE RCVE3     RCVERE
     C                     MOVE RUV3      RUVEX
     C                     MOVE RNAT3     RNATEX
    C                     GOTO PLUS3
     C           PLU3      TAG
     C                     MOVE GRAP3     GRAPEX
     C                     MOVE UV3       UVEXT
     C                     MOVE NATE3     NATEEX
     C                     MOVE ESPE3     FLUOEX
     C                     MOVE CESPE3    CFLUOE
     C                     MOVE RESPE3    FLUORE
     C                     MOVE RCESP3    CFLURE
     C                     MOVE RAPLA3    APLARE
     C                     MOVE OFPA13    OFPA1E
     C                     MOVE OFPA23    OFPA2E
     C                     MOVE ROFP13    OFPR1E
     C                     MOVE ROFP23    OFPR2E
     C                     MOVE RETS3     RETSEX
     C                     MOVE RGRA3     RGRAEX
     C                     MOVE RUV3      RUVEX
     C                     MOVE RNAT3     RNATEX
     C           TIMP3     COMP 1                        10
     C           TIMP3     COMP 2                        20
     C           TIMP3     COMP 3                        30
     C           TIMP3     COMP 4                        40
     C   10                SETON                     13
     C      20             SETON                     13
     C         30          SETON                     13  17
     C                     SETON                     03
     C                     MOVE TS3       TSEXT
     C                     MOVE ENCR3     ENCREX
     C                     MOVE TVER3     TVEREX
     C                     MOVE CVER3     CVEREX
     C                     MOVE ENSP3     ENSPEX
     C                     MOVE APLA3     APLAEX
     C                     MOVE ORCU3     ORCUEX
     C                     MOVE COUL3B    COUEXB
     C                     MOVE COUP3     COUPEX
     C                     MOVE TREP3     TREPEX
     C                     MOVE RCOU3     RCOUEX
     C                     MOVE RENC3     RENCEX
     C                     MOVE RVER3     RVEREX
     C                     MOVE RCVE3     RCVERE
     C                     MOVE TIMP3     TIMPEX
     C                     MOVE KDIF3     KDIFEX  21
     C                     MOVE RDIF3     RDIFEX  21
     C           PLUS3     TAG
     C                     SETOF                     28
     **
     ** 7EME SUPPORT                                        INTERIEUR
     **
     C           PAPI7     COMP *BLANKS                  89
    C   89                GOTO PLUS7
     C           TIMP7     COMP 0                    8989
    C      89             GOTO PLU7
D1  C           NIMPI1    IFEQ *BLANKS
    C           NIMPI1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS7
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPI1    Z4      40
     C                     MOVE NIMPI2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMIN
     C                     MOVE USINEP    USPII
     C                     MOVE COULSB    COUINB
     C                     MOVE COUPS     COUPIN
     C                     MOVE TSSS      TSINT
     C                     MOVE GRAPS     GRAPIN
     C                     MOVE TVERS     TVERIN
     C                     MOVE ENCRS     ENCRIN
     C                     MOVE CVERS     CVERIN
     C                     MOVE ENSPS     ENSPIN
     C                     MOVE APLAS     APLAIN
     C                     MOVE ORCUS     ORCUIN
     C                     MOVE UVS       UVINT
     C                     MOVE NATES     NATEIN
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1I
     C                     MOVE OFPA2S    OFPA2I
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     071214
     C                     SETON                     161837
     C                     SETON                     21
     C                     EXSR SPLUSP
     C                     MOVE TREP7     TREPIN
     C                     MOVE RCOU7     RCOUIN
     C                     MOVE RENC7     RENCIN
     C                     MOVE RETS7     RETSIN
     C                     MOVE RGRA7     RGRAIN
     C                     MOVE RVER7     RVERIN
     C                     MOVE RCVE7     RCVERI
     C                     MOVE RUV7      RUVIN
     C                     MOVE RNAT7     RNATIN
    C                     GOTO PLUS7
     C           PLU7      TAG
     C                     MOVE GRAP7     GRAPIN
     C                     MOVE UV7       UVINT
     C                     MOVE NATE7     NATEIN
     C                     MOVE ESPE7     FLUOIN
     C                     MOVE CESPE7    CFLUOI
     C                     MOVE RESPE7    FLUORI
     C                     MOVE RCESP7    CFLURI
     C                     MOVE RAPLA7    APLARI
     C                     MOVE OFPA17    OFPA1I
     C                     MOVE OFPA27    OFPA2I
     C                     MOVE ROFP17    OFPR1E
     C                     MOVE ROFP27    OFPR2E
     C                     MOVE RETS7     RETSIN
     C                     MOVE RGRA7     RGRAIN
     C                     MOVE RUV7      RUVIN
     C                     MOVE RNAT7     RNATIN
     C           TIMP7     COMP 1                        10
     C           TIMP7     COMP 2                        20
     C           TIMP7     COMP 3                        30
     C           TIMP7     COMP 4                        40
     C   10                SETON                     14
     C      20             SETON                     14
     C         30          SETON                     14  18
     C                     SETON                     07
     C                     MOVE TS7       TSINT
     C                     MOVE ENCR7     ENCRIN
     C                     MOVE TVER7     TVERIN
     C                     MOVE CVER7     CVERIN
     C                     MOVE ENSP7     ENSPIN
     C                     MOVE APLA7     APLAIN
    C*                    MOVE ORCU7     ORCUIN
     C                     MOVE COUL7B    COUINB
     C                     MOVE COUP7     COUPIN
     C                     MOVE TREP7     TREPIN
     C                     MOVE RCOU7     RCOUIN
     C                     MOVE RENC7     RENCIN
     C                     MOVE RVER7     RVERIN
     C                     MOVE RCVE7     RCVERI
     C                     MOVE TIMP7     TIMPIN
     C                     MOVE KDIF7     KDIFIN
     C                     MOVE RDIF7     RDIFIN
     C           PLUS7     TAG
     **
     ** 6EME SUPPORT                                       INTERIEUR
     **
     C           PAPI6     COMP *BLANKS                  89
    C   89                GOTO PLUS6
     C           TIMP6     COMP 0                    8989
    C      89             GOTO PLU6
D1  C           NIMPI1    IFEQ *BLANKS
    C           NIMPI1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS6
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPI1    Z4      40
     C                     MOVE NIMPI2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMIN
     C                     MOVE USINEP    USPII
     C                     MOVE COULSB    COUINB
     C                     MOVE COUPS     COUPIN
     C                     MOVE TSSS      TSINT
     C                     MOVE GRAPS     GRAPIN
     C                     MOVE TVERS     TVERIN
     C                     MOVE ENCRS     ENCRIN
     C                     MOVE CVERS     CVERIN
     C                     MOVE ENSPS     ENSPIN
     C                     MOVE APLAS     APLAIN
     C                     MOVE ORCUS     ORCUIN
     C                     MOVE UVS       UVINT
     C                     MOVE NATES     NATEIN
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1I
     C                     MOVE OFPA2S    OFPA2I
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     061214
     C                     SETON                     161837
     C                     SETON                     21
     C                     EXSR SPLUSP
     C                     MOVE TREP6     TREPIN
     C                     MOVE RCOU6     RCOUIN
     C                     MOVE RENC6     RENCIN
     C                     MOVE RETS6     RETSIN
     C                     MOVE RGRA6     RGRAIN
     C                     MOVE RVER6     RVERIN
     C                     MOVE RCVE6     RCVERI
     C                     MOVE RUV6      RUVIN
     C                     MOVE RNAT6     RNATIN
    C                     GOTO PLUS6
     C           PLU6      TAG
     C                     MOVE GRAP6     GRAPIN
     C                     MOVE UV6       UVINT
     C                     MOVE NATE6     NATEIN
     C                     MOVE ESPE6     FLUOIN
     C                     MOVE CESPE6    CFLUOI
     C                     MOVE RESPE6    FLUORI
     C                     MOVE RCESP6    CFLURI
     C                     MOVE RAPLA6    APLARI
     C                     MOVE OFPA16    OFPA1I
     C                     MOVE OFPA26    OFPA2I
     C                     MOVE ROFP16    OFPR1E
     C                     MOVE ROFP26    OFPR2E
     C                     MOVE RETS6     RETSIN
     C                     MOVE RGRA6     RGRAIN
     C                     MOVE RUV6      RUVIN
     C                     MOVE RNAT6     RNATIN
     C           TIMP6     COMP 1                        10
     C           TIMP6     COMP 2                        20
     C           TIMP6     COMP 3                        30
     C           TIMP6     COMP 4                        40
     C   10                SETON                     14
     C      20             SETON                     14
     C         30          SETON                     14  18
     C                     SETON                     06
     C                     MOVE TS6       TSINT
     C                     MOVE ENCR6     ENCRIN
     C                     MOVE TVER6     TVERIN
     C                     MOVE CVER6     CVERIN
     C                     MOVE ENSP6     ENSPIN
     C                     MOVE APLA6     APLAIN
     C                     MOVE ORCU6     ORCUIN
     C                     MOVE COUL6B    COUINB
     C                     MOVE COUP6     COUPIN
     C                     MOVE TREP6     TREPIN
     C                     MOVE RCOU6     RCOUIN
     C                     MOVE RENC6     RENCIN
     C                     MOVE RVER6     RVERIN
     C                     MOVE RCVE6     RCVERI
     C                     MOVE TIMP6     TIMPIN
     C                     MOVE KDIF6     KDIFIN
     C                     MOVE RDIF6     RDIFIN
     C           PLUS6     TAG
     **
     ** 5EME SUPPORT                                       INTERIEUR
     **
     C           PAPI5     COMP *BLANKS                  89
    C   89                GOTO PLUS5
     C           TIMP5     COMP 0                    8989
    C      89             GOTO PLU5
D1  C           NIMPI1    IFEQ *BLANKS
    C           NIMPI1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS5
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPI1    Z4      40
     C                     MOVE NIMPI2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
     C                     MOVE 'STOCKE'  TIMIN
     C                     MOVE USINEP    USPII
     C                     MOVE COULSB    COUINB
     C                     MOVE COUPS     COUPIN
     C                     MOVE TSSS      TSINT
     C                     MOVE GRAPS     GRAPIN
     C                     MOVE TVERS     TVERIN
     C                     MOVE ENCRS     ENCRIN
     C                     MOVE CVERS     CVERIN
     C                     MOVE ENSPS     ENSPIN
     C                     MOVE APLAS     APLAIN
     C                     MOVE ORCUS     ORCUIN
     C                     MOVE UVS       UVINT
     C                     MOVE NATES     NATEIN
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1I
     C                     MOVE OFPA2S    OFPA2I
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     051214
     C                     SETON                     161837
     C                     SETON                     21
     C                     EXSR SPLUSP
     C                     MOVE TREP5     TREPIN
     C                     MOVE RCOU5     RCOUIN
     C                     MOVE RENC5     RENCIN
     C                     MOVE RETS5     RETSIN
     C                     MOVE RGRA5     RGRAIN
     C                     MOVE RVER5     RVERIN
     C                     MOVE RCVE5     RCVERI
     C                     MOVE RUV5      RUVIN
     C                     MOVE RNAT5     RNATIN
    C                     GOTO PLUS5
     C           PLU5      TAG
     C                     MOVE GRAP5     GRAPIN
     C                     MOVE UV5       UVINT
     C                     MOVE NATE5     NATEIN
     C                     MOVE ESPE5     FLUOIN
     C                     MOVE CESPE5    CFLUOI
     C                     MOVE RESPE5    FLUORI
     C                     MOVE RCESP5    CFLURI
     C                     MOVE RAPLA5    APLARI
     C                     MOVE OFPA15    OFPA1I
     C                     MOVE OFPA25    OFPA2I
     C                     MOVE ROFP15    OFPR1E
     C                     MOVE ROFP25    OFPR2E
     C                     MOVE RETS5     RETSIN
     C                     MOVE RGRA5     RGRAIN
     C                     MOVE RUV5      RUVIN
     C                     MOVE RNAT5     RNATIN
     C           TIMP5     COMP 1                        10
     C           TIMP5     COMP 2                        20
     C           TIMP5     COMP 3                        30
     C           TIMP5     COMP 4                        40
     C   10                SETON                     14
     C      20             SETON                     14
     C         30          SETON                     14  18
     C                     SETON                     05
     C                     MOVE TS5       TSINT
     C                     MOVE ENCR5     ENCRIN
     C                     MOVE TVER5     TVERIN
     C                     MOVE CVER5     CVERIN
     C                     MOVE ENSP5     ENSPIN
     C                     MOVE APLA5     APLAIN
     C                     MOVE ORCU5     ORCUIN
     C                     MOVE COUL5B    COUINB
     C                     MOVE COUP5     COUPIN
     C                     MOVE TREP5     TREPIN
     C                     MOVE RCOU5     RCOUIN
     C                     MOVE RENC5     RENCIN
     C                     MOVE RVER5     RVERIN
     C                     MOVE RCVE5     RCVERI
     C                     MOVE TIMP5     TIMPIN
     C                     MOVE KDIF5     KDIFIN
     C                     MOVE RDIF5     RDIFIN
     C           PLUS5     TAG
     **
     ** 4EME SUPPORT  (INTERIEUR)                          INTERIEUR
     **
     C           PAPI4     COMP *BLANKS                  89
    C   89                GOTO PLUS4
     C           TIMP4     COMP 0                    8989
    C      89             GOTO PLU4
D1  C           NIMPI1    IFEQ *BLANKS
    C           NIMPI1    ORNE *BLANKS
    C           *IN28     ANDEQ'1'
    C                     GOTO PLUS4
F1  C                     END
     C                     SETON                     28
     C                     MOVE ETUDE     ETUDSV
     C                     MOVE SEQDE     SEQDSV
     C                     MOVE NIMPI1    Z4      40
     C                     MOVE NIMPI2    ZO4     40
     C           NOSTO1    CHAINPREIMP2              8790
     C   90                MOVE MESS,10   MSGMSG
    C   90                GOTO FINF03
    C*                    MOVE 'STOCKE'  TIMIN
     C                     MOVE USINEP    USPII
     C                     MOVE COULSB    COUINB
     C                     MOVE COUPS     COUPIN
     C                     MOVE TSSS      TSINT
     C                     MOVE GRAPS     GRAPIN
     C                     MOVE TVERS     TVERIN
     C                     MOVE ENCRS     ENCRIN
     C                     MOVE CVERS     CVERIN
     C                     MOVE ENSPS     ENSPIN
     C                     MOVE APLAS     APLAIN
     C                     MOVE ORCUS     ORCUIN
     C                     MOVE UVS       UVINT
     C                     MOVE NATES     NATEIN
     C                     MOVE ESPES     FLUOEX
     C                     MOVE CESPES    CFLUOE
     C                     MOVE RESPES    FLUORE
     C                     MOVE RCESPS    CFLURE
     C                     MOVE OFPA1S    OFPA1I
     C                     MOVE OFPA2S    OFPA2I
     C                     MOVE ETUDSV    ETUDE
     C                     MOVE SEQDSV    SEQDE
     C                     SETON                     041214
     C                     SETON                     161837
     C                     SETON                     19
     C                     EXSR SPLUSP
     C                     MOVE TREP4     TREPIN
     C                     MOVE RCOU4     RCOUIN
     C                     MOVE RENC4     RENCIN
     C                     MOVE RETS4     RETSIN
     C                     MOVE RGRA4     RGRAIN
     C                     MOVE RVER4     RVERIN
     C                     MOVE RCVE4     RCVERI
     C                     MOVE RUV4      RUVIN
     C                     MOVE RNAT4     RNATIN
    C                     GOTO PLUS4
     C           PLU4      TAG
     C                     MOVE GRAP4     GRAPIN
     C                     MOVE UV4       UVINT
     C                     MOVE NATE4     NATEIN
     C                     MOVE ESPE4     FLUOIN
     C                     MOVE CESPE4    CFLUOI
     C                     MOVE RESPE4    FLUORI
     C                     MOVE RCESP4    CFLURI
     C                     MOVE RAPLA4    APLARI
     C                     MOVE OFPA14    OFPA1I
     C                     MOVE OFPA24    OFPA2I
     C                     MOVE ROFP14    OFPR1E
     C                     MOVE ROFP24    OFPR2E
     C                     MOVE RETS4     RETSIN
     C                     MOVE RGRA4     RGRAIN
     C                     MOVE RUV4      RUVIN
     C                     MOVE RNAT4     RNATIN
     C           TIMP4     COMP 1                        10
     C           TIMP4     COMP 2                        20
     C           TIMP4     COMP 3                        30
     C           TIMP4     COMP 4                        40
     C   10                SETON                     14
     C      20             SETON                     14
     C         30          SETON                     14  18
     C                     SETON                     04
     C                     MOVE TS4       TSINT   1
     C                     MOVE ENCR4     ENCRIN  21
     C                     MOVE TVER4     TVERIN  1
     C                     MOVE CVER4     CVERIN  21
     C                     MOVE ENSP4     ENSPIN  21
     C                     MOVE APLA4     APLAIN  1
     C                     MOVE ORCU4     ORCUIN  2
     C                     MOVE COUL4B    COUINB
     C                     MOVE COUP4     COUPIN
     C                     MOVE TREP4     TREPIN  10
     C                     MOVE RCOU4     RCOUIN  10
     C                     MOVE RENC4     RENCIN  21
     C                     MOVE RVER4     RVERIN  1
     C                     MOVE RCVE4     RCVERI  21
     C                     MOVE TIMP4     TIMPIN
     C                     MOVE KDIF4     KDIFIN  21
     C                     MOVE RDIF4     RDIFIN  21
     C           PLUS4     TAG
     **
     C  N01N02N03          SETON                     111315
     C  N01N02N03          SETON                     1719
     C  N04N05N06
     CANN07                SETON                     121416
     C  N04N05N06
     CANN07                SETON                     1821
     C                     SETOF                     102030
     C                     SETOF                     40
     **
     C                     SETOF                     82
     *                                                    *ORDINO.PG. 3B*
     C           TIMPEX    COMP 0                        80
     C           TIMPIN    COMP 0                        81
     **  ALABLE POUR TRAITEMENT AUTRE QUE LA SAISIE *******
     C   80 81   SELECT    COMP 03                       82
     C   80 81 82          SETON                     90
     C   80 81 82          Z-ADD17        MSG               MSG. 17
    C   80 81 82          GOTO FINF03
     *
     C   80 81N82          SETON                     79     FIN.SP.APPEL
    C   80 81N82          GOTO FINF03                         DU FORMAT 4
     *
     *
     C                     MOVE 'IMPR'    PXARGU
D1  C           *IN35     IFEQ '1'
     C                     MOVE 'STOCKE'  TIMEX
X1  C                     ELSE
     C                     MOVE TIMPEX    PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXABRG    TIMEX
D2  C  N99      TIMPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'TIMEX
F2  C                     END
F1  C                     END
D1  C           TREPEX    IFNE 0
     C                     SETON                     22
     C                     MOVE TREPEX    PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    TREEX
D2  C           TREPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'TREEX
F2  C                     END
F1  C                     END
D1  C           *IN37     IFEQ '1'
     C                     MOVE 'STOCKE'  TIMIN
X1  C                     ELSE
     C                     MOVE TIMPIN    PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C  N99                MOVELPXABRG    TIMIN
D2  C  N99      TIMPIN    IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'TIMIN
F2  C                     END
F1  C                     END
D1  C           TREPIN    IFNE 0
     C                     SETON                     23
     C                     MOVE TREPIN    PXVALE    P
     C           CLEPAR    CHAINPARAME               99
     C                     MOVELPXABRG    TREIN
D2  C           TREPIN    IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'TREIN
F2  C                     END
F1  C                     END
    C*
     C                     SETOF                     08
D1  C           TIMPEX    IFEQ 4
    C           TREPEX    ANDEQ4
    C           CCOL      ANDEQ0
     C                     SETON                     08
F1  C                     END
    C*
     C           FINF03    TAG
    C*
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     ** CONTROLE DU FORMAT 3 ET, VALIDATION **************
     *
    C           VALF03    BEGSR
     C                     SETOF                     09
     C                     EXSR RAZ
     C                     Z-ADD0         GROUPE
     *
D1  C           TREPEX    IFNE *ZEROS
     C                     MOVE TREPEX    PXVALE    P
     C                     MOVE 'IMPR'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     Z-ADD16        MSG               MSG.16
     C                     SETON                     90
    C                     GOTO FIN03
X2  C                     ELSE
     C                     MOVELPXABRG    TREEX
D3  C           TREPEX    IFEQ 3
    C           USEXT     ANDEQ2
     C                     MOVEL'GENCO   'TREEX
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TREPIN    IFNE *ZEROS
     C                     MOVE TREPIN    PXVALE    P
     C                     MOVE 'IMPR'    PXARGU
     C           CLEPAR    CHAINPARAME               99
D2  C           *IN99     IFEQ '1'
     C                     Z-ADD16        MSG               MSG.16
     C                     SETON                     90
    C                     GOTO FIN03
X2  C                     ELSE
     C                     MOVELPXABRG    TREIN
D3  C           TREPIN    IFEQ 3
    C           USINT     ANDEQ2
     C                     MOVEL'GENCO   'TREIN
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TIMP3     IFEQ 4
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
     C   35                EXSR REPIEX
    C   35 90             GOTO FIN03
F1  C                     END
D1  C           TIMP5     IFEQ 4
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
     C   37                EXSR REPIIN
    C   37 90             GOTO FIN03
    C   35 37             GOTO SUIPOS
F1  C                     END
     *
     C                     MOVE *BLANKS   USIEXT
     C           TIMEX     COMP 'STOCKE'                 80
     C  N80      TIMPEX    COMP 0                        80
     C  N80      TIMPEX    COMP 3                        80
    C* N80      TIMPEX    COMP 5                        80
     C  N80      TREPEX    COMP 0                        80
D1  C           *IN80     IFEQ '0'
     C                     MOVE USEXT     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99      PXMONT    COMP 999                      99
D2  C           *IN99     IFEQ '1'
     C                     Z-ADD88        MSG               MSG.88
     C                     SETON                     90
    C                     GOTO FIN03
F2  C                     END
     C                     MOVELPXABRG    USIEXT
F1  C                     END
     *
     C                     SETOF                     8081
     C                     MOVE *BLANKS   USIINT
     C           TIMIN     COMP 'STOCKE'                 80
     C  N80      TIMPIN    COMP 0                        80
     C  N80      TIMPIN    COMP 3                        80
    C* N80      TIMPIN    COMP 5                        80
     C  N80      TREPIN    COMP 0                        80
D1  C           *IN80     IFEQ '0'
     C                     MOVE USINT     PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C  N99      PXMONT    COMP 999                      99
D2  C           *IN99     IFEQ '1'
     C                     Z-ADD89        MSG               MSG.88
     C                     SETON                     90
    C                     GOTO FIN03
F2  C                     END
     C                     MOVELPXABRG    USIINT
F1  C                     END
     *
     C                     EXSR RAZ
     C                     SETOF                     102030
     C                     SETOF                     405121
     C                     SETOF                     3141
     *
     C  N35      TIMPEX    COMP 1                        10  HELIO
     C  N35      TIMPEX    COMP 2                        20  FLEXO
     C  N35      TIMPEX    COMP 3                        30  TYPO
    C* N35      TIMPEX    COMP 5                        30  POST PRINT
     C  N35      TIMPEX    COMP 4                        40  OFFSET
     C  N37      TIMPIN    COMP 1                        51
     C  N37      TIMPIN    COMP 2                        21
     C  N37      TIMPIN    COMP 3                        31
    C* N37      TIMPIN    COMP 5                        31
     C  N37      TIMPIN    COMP 4                        41
     *
D1  C           TIMPEX    IFNE 0
    C           TIMEX     ANDNE'STOCKE'
     C                     MOVE TIMPEX    XTIMA1
     C                     MOVE USEXT     XTIMA2
     C                     MOVELXTIMKE    TBVARG
     C                     MOVEL'XTIMPUSI'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             90
    C*  90      TIMPEX    IFEQ 4
    C*          USEXT     ANDEQ5
    C*                    SETOF                     90
    C*                    END
D2  C           *IN90     IFEQ '1'
     C                     Z-ADD88        MSG               MSG.88
    C                     GOTO FIN03
F2  C                     END
F1  C                     END
D1  C           TIMPIN    IFNE 0
    C           TIMIN     ANDNE'STOCKE'
     C                     MOVE TIMPIN    XTIMA1
     C                     MOVE USINT     XTIMA2
     C                     MOVELXTIMKE    TBVARG
     C                     MOVEL'XTIMPUSI'TBLNOM
     C                     Z-ADD1         TBNSEG
     C           KTBA01    CHAINXTBASE01             90
    C*  90      TIMPIN    IFEQ 4
    C*          USINT     ANDEQ5
    C*                    SETOF                     90
    C*                    END
D2  C           *IN90     IFEQ '1'
     C                     Z-ADD89        MSG               MSG.88
    C                     GOTO FIN03
F2  C                     END
F1  C                     END
     *
     C                     EXSR RAZ
     * controle des valeurs pour les rapports de couverture
     * d'encres et de vernis
     C                     MOVE 01        TEST1   21
     * TMAFBU le 19/03/2013 TEST2 passe de 2,0 à 3,0
     C                     MOVE 30        TEST2   21
     *                               <---- EXTERIEUR --->
D1  C           TIMP3     IFEQ 4                            PAS D'OFFSET 3B EXT
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
D2  C           RCVERE    IFNE 0                             REPIQUAGE
     C           RCVERE    COMP TEST1                  90       VERNIS
     C        N90RCVERE    COMP TEST2                90
     C         90          Z-ADD16        MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           CVEREX    IFNE 0                             PRINCIPAL
     C           CVEREX    COMP TEST1                  90       VERNIS
     C        N90CVEREX    COMP TEST2                90
     C         90          Z-ADD10        MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           ENCREX    IFNE 0                           PRINCIPAL
     C           ENCREX    COMP TEST1                  90    ENCRES
     C        N90ENCREX    COMP TEST2                90
     C         90          Z-ADD9         MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           RENCEX    IFNE 0                           REPIQUAGE
     C           RENCEX    COMP TEST1                  90     ENCRES
     C        N90RENCEX    COMP TEST2                90
     C         90          Z-ADD9         MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           CFLUOE    IFGE ENCREX                     FLUO > TOTAL
    C           ENCREX    ANDNE*ZEROS
    C           CFLURE    ORGE RENCEX
    C           RENCEX    ANDNE*ZEROS
     C                     Z-ADD16        MSG
     C                     SETON                     90
    C                     GOTO FIN03
F2  C                     END
F1  C                     END
     *                                <---- INTERIEUR ---->
D1  C           TIMP5     IFEQ 4                            PAS D'OFFSET 3B INT
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
D2  C           RCVERI    IFNE 0                            REPIQUAGE
     C           RCVERI    COMP TEST1                  90      VERNIS
     C        N90RCVERI    COMP TEST2                90
     C         90          Z-ADD16        MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           CVERIN    IFNE 0                          PRINCIPAL
     C           CVERIN    COMP TEST1                  90    VERNIS
     C        N90CVERIN    COMP TEST2                90
     C         90          Z-ADD10        MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           ENCRIN    IFNE 0                          PRINCIPAL
     C           ENCRIN    COMP TEST1                  90    ENCRES
     C        N90ENCRIN    COMP TEST2                90
     C         90          Z-ADD9         MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           RENCIN    IFNE 0                          REPIQUAGE
     C           RENCIN    COMP TEST1                  90    ENCRES
     C        N90RENCIN    COMP TEST2                90
     C         90          Z-ADD9         MSG
    C      90             GOTO FIN03
F2  C                     END
D2  C           CFLUOI    IFGE ENCRIN                     FLUO > TOTAL
    C           ENCRIN    ANDNE*ZEROS
    C           CFLURI    ORGE RENCIN
    C           RENCIN    ANDNE*ZEROS
     C                     Z-ADD16        MSG
     C                     SETON                     90
    C                     GOTO FIN03
F2  C                     END
F1  C                     END
     * controle par type d'impression (helio/flexo/typo/offset) .
     C   10                EXSR HELIEX                      CONTROLE HELIO
    C      90             GOTO FIN03
     C   10                EXSR REPIEX
    C      90             GOTO FIN03
     C   51                EXSR HELIIN
    C      90             GOTO FIN03
     C   51                EXSR REPIIN
    C      90             GOTO FIN03
     *
     C   20                EXSR FLEXEX                      CONTROLE FLEXO
    C      90             GOTO FIN03
     C   20                EXSR REPIEX
    C      90             GOTO FIN03
     C   21                EXSR FLEXIN
    C      90             GOTO FIN03
     C   21                EXSR REPIIN
    C      90             GOTO FIN03
     *
     C   30                EXSR TYPOEX                      CONTROLE TYPO
    C      90             GOTO FIN03
     C   30                EXSR REPIEX
    C      90             GOTO FIN03
     C   31                EXSR TYPOIN
    C      90             GOTO FIN03
     C   31                EXSR REPIIN
    C      90             GOTO FIN03
     *
D1  C           TIMP3     IFEQ 4
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
     C   40                EXSR OFFSEX                      CONTROLE
    C      90             GOTO FIN03                             OFFSET
     C   40                EXSR REPIEX
    C      90             GOTO FIN03
F1  C                     END
D1  C           TIMP5     IFEQ 4
    C           ZTCO35    ANDGT'0'
X1  C                     ELSE
     C   41                EXSR OFFSIN
    C      90             GOTO FIN03
     C   41                EXSR REPIIN
    C      90             GOTO FIN03
F1  C                     END
     *
     ** formatage pour ecriture sur le fichier "devsai" .
     C           SUIPOS    TAG
     *                                                      DU FORMAT 3
    C  N01                GOTO PLUS11
D1  C           TREPEX    IFEQ 0
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECRE
     C                     Z-ADD0         RDIF1
F1  C                     END
D1  C           *IN35     IFEQ '0'
     C                     MOVE TSEXT     TS1
     C                     MOVE ENCREX    ENCR1
     C                     MOVE TVEREX    TVER1
     C                     MOVE CVEREX    CVER1
     C                     MOVE ENSPEX    ENSP1
     C                     MOVE APLAEX    APLA1
    C*                    MOVE ORCUEX    ORCU1
     C                     MOVE UVEXT     UV1
    C*                    MOVE GRAPEX    GRAP1
    C*                    MOVE NATEEX    NATE1
     C                     MOVE OFPA1E    OFPA11
     C                     MOVE OFPA2E    OFPA21
     C                     MOVE COUEXB    COUL1B
     C                     MOVE FLUOEX    ESPE1
     C                     MOVE CFLUOE    CESPE1
F1  C                     END
     C                     MOVE TREPEX    TREP1
     C                     MOVE RCOUEX    RCOU1
     C                     MOVE RENCEX    RENC1
     C                     MOVE RVEREX    RVER1
     C                     MOVE RCVERE    RCVE1
     C                     MOVE RETSEX    RETS1
     C                     MOVE RGRAEX    RGRA1
     C                     MOVE RUVEX     RUV1
    C*                    MOVE RNATEX    RNAT1
     C                     MOVE FLUORE    RESPE1
     C                     MOVE CFLURE    RCESP1
     C                     MOVE APLARE    RAPLA1
     C                     MOVE OFPR1E    ROFP11
     C                     MOVE OFPR2E    ROFP21
    C                     GOTO PLUS10
     C           PLUS11    TAG
    C  N02                GOTO PLUS12
D1  C           TREPEX    IFEQ 0
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECRE
     C                     Z-ADD0         RDIF2
F1  C                     END
D1  C           *IN35     IFEQ '0'
     C                     MOVE TSEXT     TS2
     C                     MOVE ENCREX    ENCR2
     C                     MOVE TVEREX    TVER2
     C                     MOVE CVEREX    CVER2
     C                     MOVE ENSPEX    ENSP2
     C                     MOVE APLAEX    APLA2
     C                     MOVE ORCUEX    ORCU2
     C                     MOVE UVEXT     UV2
     C                     MOVE NATEEX    NATE2
     C                     MOVE OFPA1E    OFPA12
     C                     MOVE OFPA2E    OFPA22
     C                     MOVE GRAPEX    GRAP2
     C                     MOVE COUEXB    COUL2B
     C                     MOVE FLUOEX    ESPE2
     C                     MOVE CFLUOE    CESPE2
F1  C                     END
     C                     MOVE TREPEX    TREP2
     C                     MOVE RCOUEX    RCOU2
     C                     MOVE RENCEX    RENC2
     C                     MOVE RVEREX    RVER2
     C                     MOVE RCVERE    RCVE2
     C                     MOVE RETSEX    RETS2
     C                     MOVE RGRAEX    RGRA2
     C                     MOVE RUVEX     RUV2
     C                     MOVE RNATEX    RNAT2
     C                     MOVE FLUORE    RESPE2
     C                     MOVE CFLURE    RCESP2
     C                     MOVE APLARE    RAPLA2
     C                     MOVE OFPR1E    ROFP12
     C                     MOVE OFPR2E    ROFP22
    C                     GOTO PLUS10
     C           PLUS12    TAG
    C  N03                GOTO PLUS10
D1  C           TREPEX    IFEQ 0
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECRE
     C                     Z-ADD0         RDIF3
F1  C                     END
D1  C           *IN35     IFEQ '0'
     C                     MOVE ENCREX    ENCR3
     C                     MOVE TVEREX    TVER3
     C                     MOVE CVEREX    CVER3
     C                     MOVE ENSPEX    ENSP3
     C                     MOVE APLAEX    APLA3
     C                     MOVE ORCUEX    ORCU3
     C                     MOVE UVEXT     UV3
     C                     MOVE NATEEX    NATE3
     C                     MOVE OFPA1E    OFPA13
     C                     MOVE OFPA2E    OFPA23
     C                     MOVE TSEXT     TS3
     C                     MOVE GRAPEX    GRAP3
     C                     MOVE COUEXB    COUL3B
     C                     MOVE FLUOEX    ESPE3
     C                     MOVE CFLUOE    CESPE3
F1  C                     END
     C                     MOVE TREPEX    TREP3
     C                     MOVE RCOUEX    RCOU3
     C                     MOVE RENCEX    RENC3
     C                     MOVE RVEREX    RVER3
     C                     MOVE RCVERE    RCVE3
     C                     MOVE RETSEX    RETS3
     C                     MOVE RGRAEX    RGRA3
     C                     MOVE RUVEX     RUV3
     C                     MOVE RNATEX    RNAT3
     C                     MOVE FLUORE    RESPE3
     C                     MOVE CFLURE    RCESP3
     C                     MOVE APLARE    RAPLA3
     C                     MOVE OFPR1E    ROFP13
     C                     MOVE OFPR2E    ROFP23
     *
     C           PLUS10    TAG
     *
    C  N04                GOTO PLUS14
D1  C           TREPIN    IFEQ 0
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECRI
     C                     Z-ADD0         RDIF4
F1  C                     END
D1  C           *IN37     IFEQ '0'
     C                     MOVE ENCRIN    ENCR4
     C                     MOVE TVERIN    TVER4
     C                     MOVE CVERIN    CVER4
     C                     MOVE ENSPIN    ENSP4
     C                     MOVE APLAIN    APLA4
     C                     MOVE ORCUIN    ORCU4
     C                     MOVE RETSIN    RETS4
     C                     MOVE TSINT     TS4
     C                     MOVE GRAPIN    GRAP4
     C                     MOVE UVINT     UV4
     C                     MOVE NATEIN    NATE4
     C                     MOVE OFPA1I    OFPA14
     C                     MOVE OFPA2I    OFPA24
     C                     MOVE COUINB    COUL4B
     C                     MOVE FLUOIN    ESPE4
     C                     MOVE CFLUOI    CESPE4
F1  C                     END
     C                     MOVE TREPIN    TREP4
     C                     MOVE RCOUIN    RCOU4
     C                     MOVE RENCIN    RENC4
     C                     MOVE RVERIN    RVER4
     C                     MOVE RCVERI    RCVE4
     C                     MOVE RETSIN    RETS4
     C                     MOVE RGRAIN    RGRA4
     C                     MOVE RUVIN     RUV4
     C                     MOVE RNATIN    RNAT4
     C                     MOVE FLUORI    RESPE4
     C                     MOVE CFLURI    RCESP4
     C                     MOVE APLARI    RAPLA4
     C                     MOVE OFPR1E    ROFP14
     C                     MOVE OFPR2E    ROFP24
    C                     GOTO PLUS13
     C           PLUS14    TAG
    C  N05                GOTO PLUS15
D1  C           TREPIN    IFEQ 0
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECRI
     C                     Z-ADD0         RDIF5
F1  C                     END
D1  C           *IN37     IFEQ '0'
     C                     MOVE ENCRIN    ENCR5
     C                     MOVE TVERIN    TVER5
     C                     MOVE CVERIN    CVER5
     C                     MOVE ENSPIN    ENSP5
     C                     MOVE APLAIN    APLA5
     C                     MOVE ORCUIN    ORCU5
     C                     MOVE TSINT     TS5
     C                     MOVE UVINT     UV5
     C                     MOVE NATEIN    NATE5
     C                     MOVE OFPA1I    OFPA15
     C                     MOVE OFPA2I    OFPA25
     C                     MOVE GRAPIN    GRAP5
     C                     MOVE COUINB    COUL5B
     C                     MOVE FLUOIN    ESPE5
     C                     MOVE CFLUOI    CESPE5
F1  C                     END
     C                     MOVE TREPIN    TREP5
     C                     MOVE RCOUIN    RCOU5
     C                     MOVE RENCIN    RENC5
     C                     MOVE RVERIN    RVER5
     C                     MOVE RCVERI    RCVE5
     C                     MOVE RETSIN    RETS5
     C                     MOVE RGRAIN    RGRA5
     C                     MOVE RUVIN     RUV5
     C                     MOVE RNATIN    RNAT5
     C                     MOVE FLUORI    RESPE5
     C                     MOVE CFLURI    RCESP5
     C                     MOVE APLARI    RAPLA5
     C                     MOVE OFPR1E    ROFP15
     C                     MOVE OFPR2E    ROFP25
    C                     GOTO PLUS13
     C           PLUS15    TAG
    C  N06                GOTO PLUS16
D1  C           TREPIN    IFEQ 0
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECRI
     C                     Z-ADD0         RDIF6
F1  C                     END
D1  C           *IN37     IFEQ '0'
     C                     MOVE ENCRIN    ENCR6
     C                     MOVE TVERIN    TVER6
     C                     MOVE CVERIN    CVER6
     C                     MOVE ENSPIN    ENSP6
     C                     MOVE APLAIN    APLA6
     C                     MOVE ORCUIN    ORCU6
     C                     MOVE TSINT     TS6
     C                     MOVE GRAPIN    GRAP6
     C                     MOVE UVINT     UV6
     C                     MOVE NATEIN    NATE6
     C                     MOVE OFPA1I    OFPA16
     C                     MOVE OFPA2I    OFPA26
     C                     MOVE COUINB    COUL6B
     C                     MOVE FLUOIN    ESPE6
     C                     MOVE CFLUOI    CESPE6
F1  C                     END
     C                     MOVE TREPIN    TREP6
     C                     MOVE RCOUIN    RCOU6
     C                     MOVE RENCIN    RENC6
     C                     MOVE RVERIN    RVER6
     C                     MOVE RCVERI    RCVE6
     C                     MOVE RETSIN    RETS6
     C                     MOVE RGRAIN    RGRA6
     C                     MOVE RUVIN     RUV6
     C                     MOVE RNATIN    RNAT6
     C                     MOVE FLUORI    RESPE6
     C                     MOVE CFLURI    RCESP6
     C                     MOVE APLARI    RAPLA6
     C                     MOVE OFPR1E    ROFP16
     C                     MOVE OFPR2E    ROFP26
    C                     GOTO PLUS13
     C           PLUS16    TAG
    C  N07                GOTO PLUS13
D1  C           TREPIN    IFEQ 0
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECRI
     C                     Z-ADD0         RDIF7
F1  C                     END
D1  C           *IN37     IFEQ '0'
     C                     MOVE ENCRIN    ENCR7
     C                     MOVE TVERIN    TVER7
     C                     MOVE CVERIN    CVER7
     C                     MOVE ENSPIN    ENSP7
     C                     MOVE APLAIN    APLA7
    C*                    MOVE ORCUIN    ORCU7
     C                     MOVE TSINT     TS7
     C                     MOVE GRAPIN    GRAP7
     C                     MOVE UVINT     UV7
     C                     MOVE NATEIN    NATE7
     C                     MOVE OFPA1I    OFPA17
     C                     MOVE OFPA2I    OFPA27
     C                     MOVE COUINB    COUL7B
     C                     MOVE FLUOIN    ESPE7
     C                     MOVE CFLUOI    CESPE7
F1  C                     END
     C                     MOVE TREPIN    TREP7
     C                     MOVE RCOUIN    RCOU7
     C                     MOVE RENCIN    RENC7
     C                     MOVE RVERIN    RVER7
     C                     MOVE RCVERI    RCVE7
     C                     MOVE RETSIN    RETS7
     C                     MOVE RGRAIN    RGRA7
     C                     MOVE RUVIN     RUV7
     C                     MOVE RNATIN    RNAT7
     C                     MOVE FLUORI    RESPE7
     C                     MOVE CFLURI    RCESP7
     C                     MOVE APLARI    RAPLA7
     C                     MOVE OFPR1E    ROFP17
     C                     MOVE OFPR2E    ROFP27
     *
     C           PLUS13    TAG
     *
     C           USEXT     COMP ETSEXT                   80*
     C  N80      TIMPEX    COMP 3                        81*
    C* N80N81   TIMPEX    COMP 5                        81*
     C  N80 81             Z-ADD0         MATYE1           *
     C  N80 81             Z-ADD0         MATYE2           *
     C  N80 81             Z-ADD0         MATYE3           *
     C  N80N81             Z-ADD0         MAIME1           *
     C  N80N81             Z-ADD0         MAIME2           *
     C  N80N81             Z-ADD0         MAIME3           *
     C  N80N81             Z-ADD0         MAIME4           *
     C  N80N81             Z-ADD0         MAIME5           *
     *
     C           USINT     COMP ETSINT                   80*
     C  N80      TIMPIN    COMP 3                        81*
    C* N80N81   TIMPIN    COMP 5                        81*
     C  N80 81             Z-ADD0         MATYI1           *
     C  N80 81             Z-ADD0         MATYI2           *
     C  N80 81             Z-ADD0         MATYI3           *
     C  N80N81             Z-ADD0         MAIMI1           *
     C  N80N81             Z-ADD0         MAIMI2           *
     C  N80N81             Z-ADD0         MAIMI3           *
     C  N80N81             Z-ADD0         MAIMI4           *
     C  N80N81             Z-ADD0         MAIMI5           *
     *                                                     RAZ.ZONES DR
     C                     MOVE 0         *IN               IND. OFF
     *                                                     RAZ.ZONES DR
     C           FIN03     TAG
     C                     SETOF                     102030
     C                     SETOF                     402131
     C                     SETOF                     415109
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION  FLEXO * IMPRESSION EXTERIEUR *********
     * <--PAGE-31-->
    C           FLEXEX    BEGSR
     *
D1  C           COUEXB    IFEQ 0
    C           ORCUEX    CABNE' '       PG31A
    C           TVEREX    CABNE' '       PG31B
    C                     GOTO MSG1
F1  C                     END
D1  C           COUEXB    IFNE 0
D2  C           ENCREX    IFEQ 0
     C                     SETON                     90
     C                     Z-ADD9         MSG              MSG.9
    C                     GOTO PG31E
F2  C                     END
     C           PG31A     TAG
D2  C           TVEREX    IFEQ ' '
    C           CVEREX    CABNE0         MSG10
    C           CVEREX    CABEQ0         PG31F
F2  C                     END
D2  C           TVEREX    IFNE ' '
    C           TVEREX    CABEQ'B'       PG31B
    C           TVEREX    CABEQ'G'       PG31B
    C           TVEREX    CABEQ'A'       PG31B
    C           TVEREX    CABEQ'S'       PG31B
    C           TVEREX    CABEQ'P'       PG31B
    C           TVEREX    CABEQ'M'       PG31B
    C           TVEREX    CABEQ'E'       PG31B
    C           TVEREX    CABEQ'D'       PG31B
    C           TVEREX    CABEQ'Q'       PG31B
    C           TVEREX    CABEQ'H'       PG31B
    C           TVEREX    CABEQ'I'       PG31B
    C           TVEREX    CABEQ'L'       PG31B
    C           TVEREX    CABEQ'R'       PG31B
    C           TVEREX    CABEQ'C'       PG31B
    C           TVEREX    CABEQ'X'       PG31B
    C                     GOTO MSG10
     C           PG31B     TAG
    C           CVEREX    CABEQ0         MSG10
     C           PG31F     TAG
    C           UVEXT     CABEQ' '       PG31C
    C           UVEXT     CABEQ'E'       PG31C
    C           UVEXT     CABEQ'P'       PG31C
     C                     Z-ADD9         MSG              MSG.9
     C                     SETON                     90
    C                     GOTO PG31E
F2  C                     END
     C           PG31C     TAG
D2  C           TSEXT     IFEQ ' '
     C                     EXSR ROTAEX
    C                     GOTO PG31E
F2  C                     END
D2  C           TSEXT     IFNE ' '
     C                     Z-ADD2         MSG              MSG.2
     C                     SETON                     90
    C                     GOTO PG31E
F2  C                     END
F1  C                     END
    C                     GOTO PG31E
     C           MSG10     TAG
     C                     Z-ADD10        MSG              MSG.10
     C                     SETON                     90
    C                     GOTO PG31E
     C           MSG1      TAG
     C                     Z-ADD1         MSG              MSG.1
     C                     SETON                     90
     *
    C           PG31E     ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION FLEXO  * IMPRESSION INTERIEUR *********
     * <---PAGE-31--->
    C           FLEXIN    BEGSR
     *
D1  C           COUINB    IFEQ 0
    C           ORCUIN    CABNE' '       PG31AA
    C           TVERIN    CABNE' '       PG31BB
    C                     GOTO MSG1A
F1  C                     END
D1  C           COUINB    IFNE 0
D2  C           ENCRIN    IFEQ 0
     C                     SETON                     90
     C                     Z-ADD9         MSG              MSG.9
    C                     GOTO PG31EE
F2  C                     END
     C           PG31AA    TAG
D2  C           TVERIN    IFEQ ' '
    C           CVERIN    CABNE0         MSG10A
    C           CVERIN    CABEQ0         PG31FF
F2  C                     END
D2  C           TVERIN    IFNE ' '
    C           TVERIN    CABEQ'B'       PG31BB
    C           TVERIN    CABEQ'G'       PG31BB
    C           TVERIN    CABEQ'A'       PG31BB
    C           TVERIN    CABEQ'S'       PG31BB
    C           TVERIN    CABEQ'P'       PG31BB
    C           TVERIN    CABEQ'M'       PG31BB
    C           TVERIN    CABEQ'E'       PG31BB
    C           TVERIN    CABEQ'D'       PG31BB
    C           TVERIN    CABEQ'Q'       PG31BB
    C           TVERIN    CABEQ'H'       PG31BB
    C           TVERIN    CABEQ'I'       PG31BB
    C           TVERIN    CABEQ'L'       PG31BB
    C           TVERIN    CABEQ'R'       PG31BB
    C           TVERIN    CABEQ'C'       PG31BB
    C           TVERIN    CABEQ'X'       PG31BB
    C                     GOTO MSG10A
     C           PG31BB    TAG
    C           CVERIN    CABEQ0         MSG10A
     C           PG31FF    TAG
    C           UVINT     CABEQ' '       PG31CC
    C           UVINT     CABEQ'E'       PG31CC
    C           UVINT     CABEQ'P'       PG31CC
     C                     Z-ADD9         MSG              MSG.9
     C                     SETON                     90
    C                     GOTO PG31EE
F2  C                     END
     C           PG31CC    TAG
D2  C           TSINT     IFEQ ' '
     C                     EXSR ROTAIN
    C                     GOTO PG31EE
F2  C                     END
D2  C           TSINT     IFNE ' '
     C                     Z-ADD2         MSG              MSG.2
     C                     SETON                     90
    C                     GOTO PG31EE
F2  C                     END
F1  C                     END
    C                     GOTO PG31EE
     C           MSG10A    TAG
     C                     Z-ADD10        MSG              MSG.10
     C                     SETON                     90
    C                     GOTO PG31EE
     C           MSG1A     TAG
     C                     Z-ADD1         MSG              MSG.1
     C                     SETON                     90
     *
    C           PG31EE    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION HELIO ** IMPRESSION EXTERIEUR *********
     * <---PAGE-32--->
    C           HELIEX    BEGSR
     *
D1  C           UVEXT     IFNE ' '
    C           UVEXT     ANDNE'I'
    C           UVEXT     ANDNE'P'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
    C                     GOTO PLUS20
F1  C                     END
     *
D1  C           COUEXB    IFEQ 0
D2  C           TVEREX    IFEQ ' '
    C           ORCUEX    ANDEQ*BLANKS
     C                     Z-ADD1         MSG              MSG.1
     C                     SETON                     90
    C                     GOTO PLUS20
F2  C                     END
F1  C                     END
     *
    C           TSEXT     CABEQ'T'       PG32A
    C           TSEXT     CABEQ'S'       PG32A
     C                     Z-ADD2         MSG               MSG.2.
     C                     SETON                     90
    C                     GOTO PLUS20
     C           PG32A     TAG
D1  C           TVEREX    IFEQ ' '
D2  C           CVEREX    IFNE 0
     C           PG32C     TAG
     C                     Z-ADD10        MSG                MSG.10
     C                     SETON                     90
    C                     GOTO PLUS20
X2  C                     ELSE
    C                     GOTO PG32B
F2  C                     END
X1  C                     ELSE
    C           TVEREX    CABEQ'B'       PG32D
    C           TVEREX    CABEQ'G'       PG32D
    C           TVEREX    CABEQ'H'       PG32D
    C           TVEREX    CABEQ'S'       PG32D
    C           TVEREX    CABEQ'T'       PG32D
    C           TVEREX    CABEQ'L'       PG32D
    C           TVEREX    CABEQ'E'       PG32D
    C           TVEREX    CABEQ'D'       PG32D
    C           TVEREX    CABEQ'P'       PG32D
    C                     GOTO PG32C
     C           PG32D     TAG
    C           CVEREX    CABEQ0         PG32C
F1  C                     END
     C           PG32B     TAG
     C                     EXSR ROTAEX
     *
    C           PLUS20    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION HELIO ** IMPRESSION INTERIEUR *********
     * <---PAGE-32--->
    C           HELIIN    BEGSR
     *
D1  C           UVINT     IFNE ' '
    C           UVINT     ANDNE'I'
    C           UVINT     ANDNE'P'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
    C                     GOTO PLUS21
F1  C                     END
     *
D1  C           COUINB    IFEQ 0
D2  C           TVERIN    IFEQ ' '
    C           ORCUIN    ANDEQ*BLANKS
     C                     Z-ADD1         MSG              MSG.1
     C                     SETON                     90
    C                     GOTO PLUS21
F2  C                     END
F1  C                     END
     *
    C           TSINT     CABEQ'T'       PG32AA
    C           TSINT     CABEQ'S'       PG32AA
     C                     Z-ADD2         MSG               MSG.2.
     C                     SETON                     90
    C                     GOTO PLUS21
     C           PG32AA    TAG
D1  C           TVERIN    IFEQ ' '
D2  C           CVERIN    IFNE 0
     C           PG32CC    TAG
     C                     Z-ADD10        MSG                MSG.10
     C                     SETON                     90
    C                     GOTO PLUS21
X2  C                     ELSE
    C                     GOTO PG32BB
F2  C                     END
X1  C                     ELSE
    C           TVERIN    CABEQ'B'       PG32DD
    C           TVERIN    CABEQ'G'       PG32DD
    C           TVERIN    CABEQ'H'       PG32DD
    C           TVERIN    CABEQ'S'       PG32DD
    C           TVERIN    CABEQ'T'       PG32DD
    C           TVERIN    CABEQ'L'       PG32DD
    C           TVERIN    CABEQ'E'       PG32DD
    C           TVERIN    CABEQ'D'       PG32DD
    C           TVERIN    CABEQ'P'       PG32DD
    C                     GOTO PG32CC
     C           PG32DD    TAG
    C           CVERIN    CABEQ0         PG32CC
F1  C                     END
     C           PG32BB    TAG
     C                     EXSR ROTAIN
     *
    C           PLUS21    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION ROTATIVES ** IMPRESSION EXTERIEUR *****
     * <---PAGE-32-->
    C           ROTAEX    BEGSR
     *
     C                     EXSR RAZ
     C                     Z-ADD0         GROUPE
     *
D1  C           ORCUEX    IFNE *BLANKS
     C                     MOVELORCUEX    ALPHA   1
     C                     MOVE ORCUEX    NUM     1
D2  C           NUM       IFLT '0'
    C           NUM       ORGT '9'
     C                     Z-ADD11        MSG                  MSG.11
     C                     SETON                     90
    C                     GOTO PLUS22
F2  C                     END
     * <---PAGE-33--->
D2  C           ALPHA     IFEQ 'O'
    C           ALPHA     OREQ 'A'
     C                     Z-ADD1         GROUPE  10
X2  C                     ELSE
D3  C           ALPHA     IFNE 'C'
     C                     Z-ADD11        MSG                  MSG.11
     C                     SETON                     90
    C                     GOTO PLUS22
X3  C                     ELSE
D4  C           TIMPEX    IFEQ 1
     C                     Z-ADD2         GROUPE
X4  C                     ELSE
     C                     Z-ADD1         GROUPE  10
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TIMPEX    IFEQ 2
D2  C           OFPA1E    IFNE *ZERO
     C                     ADD  OFPA1E    GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
X1  C                     ELSE
D2  C           TVEREX    IFEQ 'S'
    C           TVEREX    OREQ 'H'
    C           TVEREX    OREQ 'A'
    C           TVEREX    OREQ 'C'
     C                     ADD  1         GROUPE
F2  C                     END
D2  C           TVEREX    IFEQ 'B'
    C           TVEREX    OREQ 'G'
    C           TVEREX    OREQ 'L'
    C           TVEREX    OREQ 'D'
     C                     ADD  2         GROUPE
F2  C                     END
D2  C           TVEREX    IFEQ 'E'
     C                     ADD  3         GROUPE
F2  C                     END
F1  C                     END
     *
     C                     ADD  COUEXB    GROUPE
     *
D1  C           GROUPE    IFGT 8
    C           GROUPE    OREQ 8
    C           TIMPEX    ANDNE1
    C           GROUPE    OREQ 8
    C           TIMPEX    ANDEQ1
    C           USEXT     ANDNE2
    C           GROUPE    ORLT 8
    C           TIMPEX    ANDEQ2
    C           USEXT     ANDEQ2
    C           GROUPE    ANDGT5
    C           GROUPE    ORLT 8
    C           TIMPEX    ANDEQ2
    C           USEXT     ANDNE2
    C           GROUPE    ANDGT7
     C                     Z-ADD20        MSG                 MSG.20
     C                     SETON                     90
F1  C                     END
     *
    C           PLUS22    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION ROTATIVES ** IMPRESSION INTERIEUR *****
     * <---PAGE-32--->
    C           ROTAIN    BEGSR
     *
     C                     EXSR RAZ
     C                     Z-ADD0         GROUPE
     *
D1  C           ORCUIN    IFNE *BLANKS
     C                     MOVELORCUIN    ALPHA   1
     C                     MOVE ORCUIN    NUM     1
D2  C           NUM       IFLT '0'
    C           NUM       ORGT '9'
     C                     Z-ADD11        MSG                  MSG.11
     C                     SETON                     90
    C                     GOTO PLUS23
F2  C                     END
     * <---PAGE-33--->
D2  C           ALPHA     IFEQ 'O'
    C           ALPHA     OREQ 'A'
     C                     Z-ADD1         GROUPE  10
X2  C                     ELSE
D3  C           ALPHA     IFNE 'C'
     C                     Z-ADD11        MSG                  MSG.11
     C                     SETON                     90
    C                     GOTO PLUS23
X3  C                     ELSE
D4  C           TIMPIN    IFEQ 1
     C                     Z-ADD2         GROUPE
X4  C                     ELSE
     C                     Z-ADD1         GROUPE  10
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TIMPIN    IFEQ 2
D2  C           OFPA1I    IFNE *ZERO
     C                     ADD  OFPA1I    GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
X1  C                     ELSE
D2  C           TVERIN    IFEQ 'S'
    C           TVERIN    OREQ 'H'
    C           TVERIN    OREQ 'A'
    C           TVERIN    OREQ 'C'
     C                     ADD  1         GROUPE
F2  C                     END
D2  C           TVERIN    IFEQ 'B'
    C           TVERIN    OREQ 'G'
    C           TVERIN    OREQ 'L'
    C           TVERIN    OREQ 'D'
     C                     ADD  2         GROUPE
F2  C                     END
D2  C           TVERIN    IFEQ 'E'
     C                     ADD  3         GROUPE
F2  C                     END
F1  C                     END
     *
     C                     ADD  COUINB    GROUPE
     *
D1  C           GROUPE    IFGT 8
    C           GROUPE    OREQ 8
    C           TIMPIN    ANDNE1
    C           GROUPE    OREQ 8
    C           TIMPIN    ANDEQ1
    C           USEXT     ANDNE2
    C           GROUPE    ORLT 8
    C           TIMPIN    ANDEQ2
    C           USEXT     ANDEQ2
    C           GROUPE    ANDGT5
    C           GROUPE    ORLT 8
    C           TIMPIN    ANDEQ2
    C           USEXT     ANDNE2
    C           GROUPE    ANDGT7
     C                     Z-ADD20        MSG                 MSG.20
     C                     SETON                     90
F1  C                     END
     *
    C           PLUS23    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION TYPO ** IMPRESSION EXTERIEUR **********
     *                                                    *ORDINO.PG. 35*
    C           TYPOEX    BEGSR
     *
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C           COUEXB    COMP 1                    9090
     C   90                Z-ADD85        MSG               MSG. 85
    C   90                GOTO PLUS24
F1  C                     END
D1  C           USEXT     IFNE 2
     C           COUEXB    COMP 4                    90
     C   90                Z-ADD85        MSG               MSG. 85
    C   90                GOTO PLUS24
     C           ENCREX    COMP 0                        90
     C         90          Z-ADD9         MSG               MSG. 9
    C         90          GOTO PLUS24
     C           TREPEX    COMP 0                    9090
     C         90          Z-ADD16        MSG               MSG. 16
X1  C                     ELSE
     C           TREPEX    COMP 0                    9090
    C*  90      TREPEX    COMP 5                    9090
     C   90                Z-ADD16        MSG               MSG. 16
F1  C                     END
     *
    C           PLUS24    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION TYPO ** IMRESSION INTERIEUR ***********
     *                                                    *ORDINO-PG. 35*
    C           TYPOIN    BEGSR
     *
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C           COUINB    COMP 1                    9090
     C   90                Z-ADD85        MSG               MSG. 85
    C   90                GOTO PLUS25
F1  C                     END
D1  C           USINT     IFNE 2
     C           COUINB    COMP 4                    90
     C   90                Z-ADD85        MSG               MSG. 85
    C   90                GOTO PLUS25
     C           ENCRIN    COMP 0                        90
     C         90          Z-ADD9         MSG               MSG. 9
    C         90          GOTO PLUS25
     C           TREPIN    COMP 0                    9090
     C         90          Z-ADD16        MSG               MSG. 16
X1  C                     ELSE
     C           TREPIN    COMP 0                    9090
    C*  90      TREPIN    COMP 5                    9090
     C   90                Z-ADD16        MSG               MSG. 16
F1  C                     END
     *
    C           PLUS25    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION OFFSET  ** IMPRESSION EXTERIEUR *******
     *                                                    *ORDINO.PG. 35*
    C           OFFSEX    BEGSR
     *
     C                     EXSR RAZ
     *
D1  C           COUEXB    IFEQ *ZEROS
D2  C           TVEREX    IFEQ *BLANK
    C           ORCUEX    ANDEQ*BLANKS
    C           ENCREX    ORNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS26
F2  C                     END
F1  C                     END
    C*
D1  C           TSEXT     IFNE *BLANKS
    C           TSEXT     ANDNE'X'
    C           TSEXT     ANDNE'I'
     C                     SETON                     90
     C                     Z-ADD2         MSG               MSG. 2
    C                     GOTO PLUS26
F1  C                     END
    C*
D1  C           TVEREX    IFEQ *BLANK
D2  C           CVEREX    IFNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS26
F2  C                     END
X1  C                     ELSE
D2  C           TVEREX    IFNE 'R'
    C           TVEREX    ANDNE'U'
    C           TVEREX    ANDNE'K'
    C           TVEREX    ANDNE'F'
    C           TVEREX    ANDNE'D'
    C           TVEREX    ANDNE'L'
    C           TVEREX    ANDNE'M'
    C           TVEREX    ANDNE'P'
    C           TVEREX    ANDNE'O'
    C           TVEREX    ANDNE'N'
    C           TVEREX    ANDNE'X'
    C           TVEREX    ANDNE'G'
    C           TVEREX    ANDNE'Z'
    C           TVEREX    ANDNE'T'
    C           TVEREX    ANDNE'A'                        FB 10/06.14
    C           TVEREX    ANDNE'H'                        FB 10/06.14
    C           TVEREX    ANDNE'B'                        FB 10/06.14
    C           TVEREX    ANDNE'C'                        FB 10/06.14
    C           TVEREX    ANDNE'Q'                        FB 10/06.14
    C           TVEREX    ANDNE'E'                        FB 10/06.14
    C           TVEREX    ANDNE'J'                        FB 10/06.14
    C           TVEREX    ANDNE'I'                        FB 10/06.14
    C           TVEREX    ANDNE'R'                        FB 10/06.14
    C           TVEREX    ANDNE'S'                        FB 17/07.14
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS26
F2  C                     END
D2  C           CVEREX    IFEQ *ZEROS
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS26
F2  C                     END
F1  C                     END
     *
    C           ORCUEX    CABEQ*BLANK    PG36A
     *
     C                     MOVELORCUEX    ALPHA
     C                     MOVE ORCUEX    NUM
     C           ALPHA     COMP 'O'                  9090
     C      90   ALPHA     COMP 'A'                  9090
     C         90          Z-ADD11        MSG               MSG.11
    C         90          GOTO PLUS26
     C           NUM       COMP '0'                    90
     C     N90   NUM       COMP '9'                  90
     C         90          Z-ADD11        MSG               MSG.11
    C         90          GOTO PLUS26
     *
     C           PG36A     TAG
D1  C           UVEXT     IFNE ' '
    C           UVEXT     ANDNE'V'
    C           UVEXT     ANDNE'U'
    C           UVEXT     ANDNE'P'
    C           UVEXT     ANDNE'O'
    C           UVEXT     ANDNE'N'
    C           UVEXT     ANDNE'T'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F1  C                     END
     *
    C           PLUS26    ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION OFFSET ** IMPRESSION INTERIEUR  *******
     *                                                    *ORDINO.PG. 35*
    C           OFFSIN    BEGSR
     *
     C                     EXSR RAZ
D1  C           COUINB    IFEQ *ZEROS
D2  C           TVERIN    IFEQ *BLANK
    C           ORCUIN    ANDEQ*BLANKS
    C           ENCRIN    ORNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS28
F2  C                     END
F1  C                     END
    C*
D1  C           TSINT     IFNE *BLANKS
    C           TSINT     ANDNE'X'
    C           TSINT     ANDNE'I'
     C                     SETON                     90
     C                     Z-ADD2         MSG               MSG. 2
    C                     GOTO PLUS28
F1  C                     END
    C*
D1  C           TVERIN    IFEQ *BLANK
D2  C           CVERIN    IFNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS28
F2  C                     END
X1  C                     ELSE
D2  C           TVERIN    IFNE 'R'
    C           TVERIN    ANDNE'U'
    C           TVERIN    ANDNE'K'
    C           TVERIN    ANDNE'F'
    C           TVERIN    ANDNE'D'
    C           TVERIN    ANDNE'L'
    C           TVERIN    ANDNE'M'
    C           TVERIN    ANDNE'P'
    C           TVERIN    ANDNE'O'
    C           TVERIN    ANDNE'N'
    C           TVERIN    ANDNE'X'
    C           TVERIN    ANDNE'G'
    C           TVERIN    ANDNE'Z'
    C           TVERIN    ANDNE'T'
    C           TVERIN    ANDNE'A'                        FB 10/06.14
    C           TVERIN    ANDNE'H'                        FB 10/06.14
    C           TVERIN    ANDNE'B'                        FB 10/06.14
    C           TVERIN    ANDNE'C'                        FB 10/06.14
    C           TVERIN    ANDNE'Q'                        FB 10/06.14
    C           TVERIN    ANDNE'E'                        FB 10/06.14
    C           TVERIN    ANDNE'J'                        FB 10/06.14
    C           TVERIN    ANDNE'I'                        FB 10/06.14
    C           TVERIN    ANDNE'R'                        FB 10/06.14
    C           TVERIN    ANDNE'S'                        FB 17/07.14
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS28
F2  C                     END
D2  C           CVERIN    IFEQ *ZEROS
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS28
F2  C                     END
F1  C                     END
     *
    C           ORCUIN    CABEQ*BLANK    PG36AA
     *
     C                     MOVELORCUIN    ALPHA
     C                     MOVE ORCUIN    NUM
     C           ALPHA     COMP 'O'                  9090
     C      90   ALPHA     COMP 'A'                  9090
     C         90          Z-ADD11        MSG               MSG. 11
    C   90                GOTO PLUS28
     C           NUM       COMP '0'                    90
     C     N90   NUM       COMP '9'                  90
     C         90          Z-ADD11        MSG                SG. 11
    C         90          GOTO PLUS28
     *
     C           PG36AA    TAG
D1  C           UVINT     IFNE ' '
    C           UVINT     ANDNE'V'
    C           UVINT     ANDNE'U'
    C           UVINT     ANDNE'P'
    C           UVINT     ANDNE'O'
    C           UVINT     ANDNE'N'
    C           UVINT     ANDNE'T'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F1  C                     END
     *
    C           PLUS28    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE REPIQUAGE  **  IMPRESSION EXTERIEUR *****
     * <---PAGE-37--->
    C           REPIEX    BEGSR
     *
D1  C           TREPEX    IFEQ *ZEROS
D2  C           RCOUEX    IFNE *ZEROS
    C           RVEREX    ORNE *BLANKS
    C           RUVEX     ORNE *BLANKS
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PLUS82
F2  C                     END
F1  C                     END
    C*
    C           TREPEX    CASEQ1         RHELEX           EXT.HELIO
    C           TREPEX    CASEQ2         RFLEEX            "  FLEXO
    C           TREPEX    CASEQ3         RTYPEX            "  TYPO
    C*          TREPEX    CASEQ5         RTYPEX            "  POST PRINT
    C           TREPEX    CASEQ4         ROFFEX            "  OFFSET
    C                     END
     *
D1  C           TREPEX    IFEQ 1
D2  C           RUVEX     IFNE ' '
D3  C           RUVEX     IFNE 'I'
D4  C           RUVEX     IFNE 'P'
     C                     SETON                       90
     C                     MOVE 9         MSG                 MSG.9
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TREPEX    IFEQ 2
D2  C           RUVEX     IFNE ' '
D3  C           RUVEX     IFNE 'E'
D4  C           RUVEX     IFNE 'P'
     C                     SETON                       90
     C                     MOVE 9         MSG                 MSG.9
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           CCOL      IFEQ 0
D2  C           TREPEX    IFEQ 2
    C           TREPEX    OREQ 1
     C                     MOVE 'B'       COUP3
F2  C                     END
F1  C                     END
     *
    C           PLUS82    ENDSR
     C/SPACE 5
     ********************************************************************
     ** CONTROLE REPIQUAGE  **  IMPRESSION INTERIEUR *****
     * <---PAGE-37--->
    C           REPIIN    BEGSR
     *
D1  C           TREPIN    IFEQ *ZEROS
D2  C           RCOUIN    IFNE *ZEROS
    C           RVERIN    ORNE *BLANKS
    C           RUVIN     ORNE *BLANKS
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PLUS83
F2  C                     END
F1  C                     END
     *
    C           TREPIN    CASEQ1         RHELIN           INT.HELIO
    C           TREPIN    CASEQ2         RFLEIN            "  FLEXO
    C           TREPIN    CASEQ3         RTYPIN            "  TYPO
    C*          TREPIN    CASEQ5         RTYPIN            "  POST PRINT
    C           TREPIN    CASEQ4         ROFFIN            "  OFFSET
    C                     END
     *
D1  C           TREPIN    IFEQ 1
D2  C           RUVIN     IFNE ' '
D3  C           RUVIN     IFNE 'I'
D4  C           RUVIN     IFNE 'P'
     C                     SETON                       90
     C                     MOVE 9         MSG                 MSG.9
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TREPIN    IFEQ 2
D2  C           RUVIN     IFNE ' '
D3  C           RUVIN     IFNE 'E'
D4  C           RUVIN     IFNE 'P'
     C                     SETON                       90
     C                     MOVE 9         MSG                 MSG.9
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     *
    C           PLUS83    ENDSR
     C/SPACE 5
    C********************************************************************
    C** FLEXO REPIQUAGE ** EXTERIEUR *********************
     * <---PAGE-38--->
    C           RFLEEX    BEGSR
     *
D1  C           RVEREX    IFEQ ' '
    C           RCVERE    CABNE0         PG38A
X1  C                     ELSE
    C           RVEREX    CABEQ'G'       PG38C
    C           RVEREX    CABEQ'B'       PG38C
    C           RVEREX    CABEQ'A'       PG38C
    C           RVEREX    CABEQ'S'       PG38C
    C           RVEREX    CABEQ'P'       PG38C
    C           RVEREX    CABEQ'P'       PG38C
    C           RVEREX    CABEQ'E'       PG38C
    C           RVEREX    CABEQ'D'       PG38C
    C           RVEREX    CABEQ'Q'       PG38C
    C           RVEREX    CABEQ'H'       PG38C
    C           RVEREX    CABEQ'I'       PG38C
    C           RVEREX    CABEQ'L'       PG38C
    C           RVEREX    CABEQ'R'       PG38C
    C                     GOTO PG38A
     C           PG38C     TAG
    C           RCVERE    CABEQ0         PG38A
F1  C                     END
    C                     GOTO PG38B
     C           PG38A     TAG
     C                     SETON                     90
     C                     Z-ADD16        MSG
     C           PG38B     TAG
D1  C           RETSEX    IFEQ ' '
     C           PG38D     TAG
     C                     EXSR RROTEX
    C                     GOTO PG38E
X1  C                     ELSE
D2  C           RETSEX    IFNE 'P'
     C                     SETON                     90
     C                     Z-ADD2         MSG
X2  C                     ELSE
    C                     GOTO PG38D
F2  C                     END
F1  C                     END
     *
    C           PG38E     ENDSR
     C/SPACE 5
    C********************************************************************
    C** FLEXO REPIQUAGE ** INTERIEUR *********************
     * <---PAGE-38--->
    C           RFLEIN    BEGSR
     *
D1  C           RVERIN    IFEQ ' '
    C           RCVERI    CABNE0         PG38AA
X1  C                     ELSE
    C           RVERIN    CABEQ'B'       PG38CC
    C           RVERIN    CABEQ'G'       PG38CC
    C           RVERIN    CABEQ'A'       PG38CC
    C           RVERIN    CABEQ'S'       PG38CC
    C           RVERIN    CABEQ'P'       PG38CC
    C           RVERIN    CABEQ'M'       PG38CC
    C           RVERIN    CABEQ'E'       PG38CC
    C           RVERIN    CABEQ'D'       PG38CC
    C           RVERIN    CABEQ'Q'       PG38CC
    C           RVERIN    CABEQ'H'       PG38CC
    C           RVERIN    CABEQ'I'       PG38CC
    C           RVERIN    CABEQ'L'       PG38CC
    C           RVERIN    CABEQ'R'       PG38CC
    C                     GOTO PG38AA
     C           PG38CC    TAG
    C           RCVERI    CABEQ0         PG38AA
F1  C                     END
    C                     GOTO PG38BB
     C           PG38AA    TAG
     C                     SETON                     90
     C                     Z-ADD16        MSG
     C           PG38BB    TAG
D1  C           RETSIN    IFEQ ' '
     C           PG38DD    TAG
     C                     EXSR RROTIN
    C                     GOTO PG38EE
X1  C                     ELSE
D2  C           RETSIN    IFNE 'P'
     C                     SETON                     90
     C                     Z-ADD2         MSG
X2  C                     ELSE
    C                     GOTO PG38DD
F2  C                     END
F1  C                     END
     *
    C           PG38EE    ENDSR
     C/SPACE 5
     ********************************************************************
     ** HELIO REPIQUAGE ** EXTERIEUR *********************
     * <---PAGE-38--->
    C           RHELEX    BEGSR
     *
    C           RETSEX    CABEQ'S'       PG38F
    C           RETSEX    CABEQ'T'       PG38F
     C                     SETON                     90
     C                     Z-ADD2         MSG
    C                     GOTO PG38I
     C           PG38F     TAG
D1  C           RVEREX    IFEQ ' '
    C           RCVERE    CABNE0         PG38G
    C           RCVERE    CABEQ0         PG38H
X1  C                     ELSE
    C           RVEREX    CABEQ'B'       PG38J
    C           RVEREX    CABEQ'G'       PG38J
    C           RVEREX    CABEQ'H'       PG38J
    C           RVEREX    CABEQ'S'       PG38J
    C           RVEREX    CABEQ'T'       PG38J
    C           RVEREX    CABEQ'L'       PG38J
    C           RVEREX    CABEQ'E'       PG38J
    C           RVEREX    CABEQ'D'       PG38J
    C                     GOTO PG38G
     C           PG38J     TAG
    C           RCVERE    CABEQ0         PG38G
    C           RCVERE    CABNE0         PG38H
F1  C                     END
     C           PG38G     TAG
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PG38I
     C           PG38H     TAG
     C                     EXSR RROTEX
     *
    C           PG38I     ENDSR
     *
     C/SPACE 5
     ********************************************************************
     ** HELIO REPIQUAGE ** INTERIEUR *********************
     * <---PAGE-38--->
    C           RHELIN    BEGSR
     *
    C           RETSIN    CABEQ'S'       PG38FF
    C           RETSIN    CABEQ'T'       PG38FF
     C                     SETON                     90
     C                     Z-ADD2         MSG
    C                     GOTO PG38II
     C           PG38FF    TAG
D1  C           RVERIN    IFEQ ' '
    C           RCVERI    CABNE0         PG38GG
    C           RCVERI    CABEQ0         PG38HH
X1  C                     ELSE
    C           RVERIN    CABEQ'B'       PG38JJ
    C           RVERIN    CABEQ'G'       PG38JJ
    C           RVERIN    CABEQ'H'       PG38JJ
    C           RVERIN    CABEQ'S'       PG38JJ
    C           RVERIN    CABEQ'T'       PG38JJ
    C           RVERIN    CABEQ'L'       PG38JJ
    C           RVERIN    CABEQ'E'       PG38JJ
    C           RVERIN    CABEQ'D'       PG38JJ
    C                     GOTO PG38GG
     C           PG38JJ    TAG
    C           RCVERI    CABEQ0         PG38GG
    C           RCVERI    CABNE0         PG38HH
F1  C                     END
     C           PG38GG    TAG
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PG38II
     C           PG38HH    TAG
     C                     EXSR RROTIN
     *
    C           PG38II    ENDSR
     C/SPACE 5
     ********************************************************************
     ** ROTATIVE REPIQUAGE ** EXTERIEUR ******************
     * <---PAGE-39--->
    C           RROTEX    BEGSR
     *
D1  C           RVEREX    IFEQ ' '
D2  C           RCOUEX    IFEQ 0
    C           RENCEX    OREQ 0
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PG39E
F2  C                     END
F1  C                     END
     *
     C                     Z-ADD0         GROUPE
     *
D1  C           TREPEX    IFEQ 2
D2  C           OFPR1E    IFNE *ZERO
     C                     ADD  OFPR1E    GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
X1  C                     ELSE
D2  C           RVEREX    IFEQ 'S'
    C           RVEREX    OREQ 'H'
    C           RVEREX    OREQ 'A'
     C                     ADD  1         GROUPE
F2  C                     END
D2  C           RVEREX    IFEQ 'B'
    C           RVEREX    OREQ 'G'
    C           RVEREX    OREQ 'L'
    C           RVEREX    OREQ 'D'
     C                     ADD  2         GROUPE
F2  C                     END
D2  C           RVEREX    IFEQ 'E'
     C                     ADD  3         GROUPE
F2  C                     END
F1  C                     END
     *
     C                     ADD  RCOUEX    GROUPE
     *
D1  C           GROUPE    IFGT 8
    C           GROUPE    OREQ 8
    C           TREPEX    ANDNE1
    C           GROUPE    OREQ 8
    C           TREPEX    ANDEQ1
    C           USEXT     ANDNE2
    C           GROUPE    ORLT 8
    C           TREPEX    ANDEQ2
    C           USEXT     ANDEQ2
    C           GROUPE    ANDGT5
    C           GROUPE    ORLT 8
    C           TREPEX    ANDEQ2
    C           USEXT     ANDNE2
    C           GROUPE    ANDGT6
     C                     Z-ADD20        MSG                 MSG.20
     C                     SETON                     90
F1  C                     END
     *
    C           PG39E     ENDSR
     C/SPACE 5
     ********************************************************************
     ** ROTATIVE REPIQUAGE ** INTERIEUR ******************
     * <---PAGE-39--->
    C           RROTIN    BEGSR
     *
D1  C           RVERIN    IFEQ ' '
D2  C           RCOUIN    IFEQ 0
    C           RENCIN    OREQ 0
     C                     SETON                     90
     C                     Z-ADD16        MSG
    C                     GOTO PG39EE
F2  C                     END
F1  C                     END
     *
     C                     Z-ADD0         GROUPE
     *
D1  C           TREPIN    IFEQ 2
D2  C           OFPR1I    IFNE *ZERO
     C                     ADD  OFPR1I    GROUPE
X2  C                     ELSE
     C                     ADD  1         GROUPE
F2  C                     END
X1  C                     ELSE
D2  C           RVERIN    IFEQ 'S'
    C           RVERIN    OREQ 'H'
    C           RVERIN    OREQ 'A'
     C                     ADD  1         GROUPE
F2  C                     END
D2  C           RVERIN    IFEQ 'B'
    C           RVERIN    OREQ 'G'
    C           RVERIN    OREQ 'L'
    C           RVERIN    OREQ 'D'
     C                     ADD  2         GROUPE
F2  C                     END
D2  C           RVERIN    IFEQ 'E'
     C                     ADD  3         GROUPE
F2  C                     END
F1  C                     END
     *
     C                     ADD  RCOUIN    GROUPE
     *
D1  C           GROUPE    IFGT 8
    C           GROUPE    OREQ 8
    C           TREPIN    ANDNE1
    C           GROUPE    OREQ 8
    C           TREPIN    ANDEQ1
    C           USEXT     ANDNE2
    C           GROUPE    ORLT 8
    C           TREPIN    ANDEQ2
    C           USEXT     ANDEQ2
    C           GROUPE    ANDGT5
    C           GROUPE    ORLT 8
    C           TREPIN    ANDEQ2
    C           USEXT     ANDNE2
    C           GROUPE    ANDGT6
     C                     Z-ADD20        MSG                 MSG.20
     C                     SETON                     90
F1  C                     END
     *
    C           PG39EE    ENDSR
     C/SPACE 5
     ********************************************************************
     ** TYPO REPIQUAGE ** EXTERIEUR **********************
     * <---PAGE-3/10--->
    C           RTYPEX    BEGSR
     *
    C           RCOUEX    CABEQ0         PG310A
D1  C           RCOUEX    IFGT 2
     C                     SETON                     90
     C                     Z-ADD85        MSG
    C                     GOTO PG310B
X1  C                     ELSE
    C           RENCEX    CABEQ0         PG310A
    C           RVEREX    CABNE' '       PG310A
    C                     GOTO PG310B
F1  C                     END
     C           PG310A    TAG
     C                     SETON                       90
     C                     Z-ADD16        MSG
     *
    C           PG310B    ENDSR
     C/SPACE 5
     ********************************************************************
     ** TYPO REPIQUAGE ** INTERIEUR **********************
     * <---PAGE-3/10--->
    C           RTYPIN    BEGSR
     *
    C           RCOUIN    CABEQ0         PG310C
D1  C           RCOUIN    IFGT 2
     C                     SETON                     90
     C                     Z-ADD85        MSG
    C                     GOTO PG310D
X1  C                     ELSE
    C           RENCIN    CABEQ0         PG310C
    C           RVERIN    CABNE' '       PG310C
    C                     GOTO PG310D
F1  C                     END
     C           PG310C    TAG
     C                     SETON                       90
     C                     Z-ADD16        MSG
     *
    C           PG310D    ENDSR
     C/SPACE 5
    C********************************************************************
    C** OFFSET REPIQUAGE ** EXTERIEUR *********************
    C           ROFFEX    BEGSR
     *
     *
D1  C           TIMEX     IFEQ 'STOCKE'
D2  C           TVEREX    IFNE *BLANKS
    C           RVEREX    ANDNE*BLANKS
     C                     SETON                     90
     C                     Z-ADD32        MSG              MSG. 32
    C                     GOTO PLUS80
F2  C                     END
F1  C                     END
    C*
D1  C           RCOUEX    IFEQ *ZEROS
D2  C           RVEREX    IFEQ *BLANK
    C           RENCEX    ORNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS80
F2  C                     END
X1  C                     ELSE
D2  C           RENCEX    IFEQ *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS80
F2  C                     END
F1  C                     END
    C*
D1  C           RETSEX    IFNE *BLANKS
    C           RETSEX    ANDNE'X'
    C           RETSEX    ANDNE'I'
     C                     SETON                     90
     C                     Z-ADD2         MSG               MSG. 2
    C                     GOTO PLUS80
F1  C                     END
    C*
D1  C           RVEREX    IFEQ *BLANK
D2  C           RCVERE    IFNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS80
F2  C                     END
X1  C                     ELSE
D2  C           USEXT     IFEQ 2
    C           USEXT     OREQ 7
D3  C           RVEREX    IFNE 'R'
    C           RVEREX    ANDNE'U'
    C           RVEREX    ANDNE'K'
    C           RVEREX    ANDNE'F'
    C           RVEREX    ANDNE'D'
    C           RVEREX    ANDNE'L'
    C           RVEREX    ANDNE'M'
    C           RVEREX    ANDNE'O'
    C           RVEREX    ANDNE'N'
    C           RVEREX    ANDNE'G'
    C           RVEREX    ANDNE'X'
    C           RVEREX    ANDNE'Z'
    C           RVEREX    ANDNE'T'
    C           RVEREX    ANDNE'A'                        FB 10/06.14
    C           RVEREX    ANDNE'H'                        FB 10/06.14
    C           RVEREX    ANDNE'B'                        FB 10/06.14
    C           RVEREX    ANDNE'C'                        FB 10/06.14
    C           RVEREX    ANDNE'Q'                        FB 10/06.14
    C           RVEREX    ANDNE'E'                        FB 10/06.14
    C           RVEREX    ANDNE'J'                        FB 10/06.14
    C           RVEREX    ANDNE'I'                        FB 10/06.14
    C           RVEREX    ANDNE'R'                        FB 10/06.14
    C           RVEREX    ANDNE'S'                        FB 17/07.14
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS80
F3  C                     END
F2  C                     END
D2  C           USEXT     IFEQ 4
D3  C           RVEREX    IFNE 'R'
    C           RVEREX    ANDNE'K'
    C           RVEREX    ANDNE'F'
    C           RVEREX    ANDNE'U'
    C           RVEREX    ANDNE'O'
    C           RVEREX    ANDNE'N'
    C           RVEREX    ANDNE'G'
    C           RVEREX    ANDNE'M'
    C           RVEREX    ANDNE'D'
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS80
F3  C                     END
F2  C                     END
    C*
D2  C           RCVERE    IFEQ *ZEROS
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS80
F2  C                     END
F1  C                     END
     *
D1  C           USEXT     IFEQ 2
    C           USEXT     OREQ 7
D2  C           RUVEX     IFNE ' '
    C           RUVEX     ANDNE'V'
    C           RUVEX     ANDNE'U'
    C           RUVEX     ANDNE'P'
    C           RUVEX     ANDNE'N'
    C           RUVEX     ANDNE'O'
    C           RUVEX     ANDNE'T'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F2  C                     END
F1  C                     END
D1  C           USEXT     IFEQ 4
D2  C           RUVEX     IFNE ' '
    C           RUVEX     ANDNE'V'
    C           RUVEX     ANDNE'P'
    C           RUVEX     ANDNE'N'
    C           RUVEX     ANDNE'O'
    C           RUVEX     ANDNE'T'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
    C           PLUS80    ENDSR
     C/SPACE 5
    C********************************************************************
    C** OFFSET REPIQUAGE ** INTERIEUR *********************
    C           ROFFIN    BEGSR
     *
D1  C           TIMIN     IFEQ 'STOCKE'
D2  C           TVERIN    IFNE *BLANKS
    C           RVERIN    ANDNE*BLANKS
     C                     SETON                     90
     C                     Z-ADD32        MSG              MSG. 32
    C                     GOTO PLUS81
F2  C                     END
F1  C                     END
    C*
D1  C           RCOUIN    IFEQ *ZEROS
D2  C           RVERIN    IFEQ *BLANK
    C           RENCIN    ORNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS81
F2  C                     END
X1  C                     ELSE
D2  C           RENCIN    IFEQ *ZEROS
     C                     SETON                     90
     C                     Z-ADD9         MSG               MSG. 9
    C                     GOTO PLUS81
F2  C                     END
F1  C                     END
    C*
D1  C           RETSIN    IFNE *BLANKS
    C           RETSIN    ANDNE'X'
    C           RETSIN    ANDNE'I'
     C                     SETON                     90
     C                     Z-ADD2         MSG               MSG. 2
    C                     GOTO PLUS81
F1  C                     END
    C*
D1  C           RVERIN    IFEQ *BLANK
D2  C           RCVERI    IFNE *ZEROS
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS81
F2  C                     END
X1  C                     ELSE
D2  C           USINT     IFEQ 2
    C           USINT     OREQ 7
D3  C           RVERIN    IFNE 'R'
    C           RVERIN    ANDNE'U'
    C           RVERIN    ANDNE'K'
    C           RVERIN    ANDNE'F'
    C           RVERIN    ANDNE'D'
    C           RVERIN    ANDNE'L'
    C           RVERIN    ANDNE'M'
    C           RVERIN    ANDNE'O'
    C           RVERIN    ANDNE'N'
    C           RVERIN    ANDNE'G'
    C           RVERIN    ANDNE'X'
    C           RVERIN    ANDNE'Z'
    C           RVERIN    ANDNE'T'
    C           RVERIN    ANDNE'A'                        FB 10/06.14
    C           RVERIN    ANDNE'H'                        FB 10/06.14
    C           RVERIN    ANDNE'B'                        FB 10/06.14
    C           RVERIN    ANDNE'C'                        FB 10/06.14
    C           RVERIN    ANDNE'Q'                        FB 10/06.14
    C           RVERIN    ANDNE'E'                        FB 10/06.14
    C           RVERIN    ANDNE'J'                        FB 10/06.14
    C           RVERIN    ANDNE'I'                        FB 10/06.14
    C           RVERIN    ANDNE'R'                        FB 10/06.14
    C           RVERIN    ANDNE'S'                        FB 17/07.14
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS81
F3  C                     END
F2  C                     END
D2  C           USINT     IFEQ 4
D3  C           RVERIN    IFNE 'R'
    C           RVERIN    ANDNE'K'
    C           RVERIN    ANDNE'F'
    C           RVERIN    ANDNE'U'
    C           RVERIN    ANDNE'O'
    C           RVERIN    ANDNE'N'
    C           RVERIN    ANDNE'G'
    C           RVERIN    ANDNE'M'
    C           RVERIN    ANDNE'D'
     C                     SETON                     90
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS81
F3  C                     END
F2  C                     END
    C*
D2  C           RCVERI    IFEQ *ZEROS
     C                     Z-ADD10        MSG               MSG.10
    C                     GOTO PLUS81
F2  C                     END
F1  C                     END
     *
D1  C           USINT     IFEQ 2
    C           USINT     OREQ 7
D2  C           RUVIN     IFNE ' '
    C           RUVIN     ANDNE'V'
    C           RUVIN     ANDNE'U'
    C           RUVIN     ANDNE'P'
    C           RUVIN     ANDNE'N'
    C           RUVIN     ANDNE'O'
    C           RUVIN     ANDNE'T'
    C           RUVIN     ANDNE'D'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F2  C                     END
F1  C                     END
D1  C           USINT     IFEQ 4
D2  C           RUVIN     IFNE ' '
    C           RUVIN     ANDNE'V'
    C           RUVIN     ANDNE'P'
    C           RUVIN     ANDNE'N'
    C           RUVIN     ANDNE'O'
    C           RUVIN     ANDNE'T'
    C           RUVIN     ANDNE'D'
     C                     Z-ADD9         MSG               MSG.9
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
    C           PLUS81    ENDSR
     C/SPACE 5
     ********************************************************************
     ** PRE-TRAITEMENT DU FORMAT 4  **********************
     *
    C           PRE04     BEGSR
     *
    C*
D1  C           RHODO     IFNE 0
D2  C           RHODO     IFEQ -1
     C                     MOVE 'A'       RHODOA
X2  C                     ELSE
D3  C           RHODO     IFEQ -2
     C                     MOVE 'B'       RHODOA
X3  C                     ELSE
D4  C           RHODO     IFEQ -3
     C                     MOVE 'C'       RHODOA
X4  C                     ELSE
D5  C           RHODO     IFEQ -4
     C                     MOVE 'D'       RHODOA
X5  C                     ELSE
D6  C           RHODO     IFEQ -5
     C                     MOVE 'E'       RHODOA
X6  C                     ELSE
D7  C           RHODO     IFEQ -6
     C                     MOVE 'F'       RHODOA
X7  C                     ELSE
D8  C           RHODO     IFEQ -7
     C                     MOVE 'G'       RHODOA
X8  C                     ELSE
D9  C           RHODO     IFEQ -8
     C                     MOVE 'H'       RHODOA
X9  C                     ELSE
D10 C           RHODO     IFEQ -9
     C                     MOVE 'I'       RHODOA
X10 C                     ELSE
     C                     MOVE RHODO     RHODOA
F10 C                     END
F9  C                     END
F8  C                     END
F7  C                     END
F6  C                     END
F5  C                     END
F4  C                     END
F3  C                     END
F2  C                     END
X1  C                     ELSE
     C                     MOVE *BLANKS   RHODOA
F1  C                     END                                         MAT
    C*
     C                     SETOF                     979899
     C                     SETOF                     96
     C                     MOVE *BLANKS   COFENA
D1  C           COFEN     IFNE 0
     C                     SETON                     9996
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE COFEN     PXVALE
     C           CLEPAR    CHAINPARAME               8090
     C      80             MOVE MESS,11   MSGMSG
    C      80             GOTO PLUS32
     C        N80          MOVELPXLIBE    COFENA
     C           COAS1     COMP 0                    9898
    C         98          GOTO PLUS33
    C        N98          GOTO PLUS32
F1  C                     END
     *
     ** TRAITEMENT AUTRE QUE SAISIE OU INTERRO **************
     *
     C           COAS1     COMP 0                    9898
     C           SELECT    COMP 4                        90
     C     N98             Z-ADD21        MSG              * PAS DE FOR
    C     N98             GOTO PLUS32                     *       NO. 4
    C*
     C     N98             SETON                     79
    C     N98             GOTO PLUS32                     *       NO. 5
     C           PLUS33    TAG
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE COAS1     PXVALE
     C           CLEPAR    CHAINPARAME               8090
     C      90             MOVE MESS,11   MSGMSG
    C      90             GOTO PLUS32
     C        N80          MOVELPXLIBE    COAS1A
D1  C           COAS2     IFNE 0
     C                     MOVE 'ASSB'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE COAS2     PXVALE
     C           CLEPAR    CHAINPARAME               8090
     C      90             MOVE MESS,11   MSGMSG
    C      90             GOTO PLUS32
     C        N80          MOVELPXLIBE    COAS2A
     C        N80          SETON                     9796
F1  C                     END
     C           PLUS32    TAG
     C  N99N98N97          SETON                     9079
     C      79 90          Z-ADD21        MSG
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION DU FORMAT 4 ***************************
     *                                                    *ORDINO.PG. 4C*
    C           VALF04    BEGSR                           *           4D*
     C                     EXSR RAZ
     *
    C     N99             GOTO PLUS34                      ASSEMBLAGE
     *
     C           PASFE     COMP 0                        90 FENETRE
D1  C           COFEN     IFNE 20
     C     N90   LCOUP     COMP 0                        90
     C     N90   COLFE     COMP 0                        90
     C     N90   LAIZB     COMP 0                        90
     C     N90   NBRFE     COMP 0                        90
F1  C                     END
     C     N90   RHODOA    COMP ' '                      90
     C         90          Z-ADD22        MSG               MSG. 22
    C         90          GOTO PLU35
     * controle RHODO    .
D1  C           RHODOA    IFNE ' '
     C                     MOVEL'RHOD'    PXARGU
     C                     MOVE RHODOA    PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD22        MSG                MSG.22
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
     C           COLFE     COMP 0                    8080
     C   80      COLFE     COMP 1                    9090
     C   80 90             Z-ADD22        MSG               MSG.22
    C   80 90             GOTO PLU35
     *
    C     N98             GOTO PLUS35
     C           PLUS34    TAG                              ASSEMBLAGE
     *
     C           PASS1     COMP 0                        90
     C     N90   LPAT1     COMP 0                        90
     C         90          Z-ADD34        MSG               MSG. 34
    C         90          GOTO PLU35
D1  C           COAS1     IFEQ 31
    C           COAS1     OREQ 33
     C           COLA1     COMP 'G'                  9090
     C         90COLA1     COMP 'M'                  9090
     C         90COLA1     COMP 'F'                  9090
     C         90COLA1     COMP 'P'                  9090
     C         90COLA1     COMP 'H'                  9090
X1  C                     ELSE
D2  C           COAS1     IFEQ 44
     C           COLA1     COMP ' '                  9090
X2  C                     ELSE
     C           COLA1     COMP 'H'                  9090
     C         90COLA1     COMP 'V'                  9090
     C         90COLA1     COMP 'M'                  9090
     C         90COLA1     COMP 'P'                  9090
F2  C                     END
F1  C                     END
     C   90                Z-ADD34        MSG               MSG. 34
    C   90                GOTO PLU35
     C           COAS1     COMP 23                       80
     C      80   PASS1     COMP 400                  90
     C   90                Z-ADD35        MSG               MSG. 35
    C   90                GOTO PLU35
     *
     C  N97
    COR 97 96             GOTO PLUS35
     *
     C                     SETOF                     96
     *                                                    2EME.ASSEMBLAGE
     C           PASS2     COMP 0                        90
     C     N90   LPAT2     COMP 0                        90
     C         90          Z-ADD34        MSG               MSG. 34
    C         90          GOTO PLU35
D1  C           COAS2     IFEQ 31
    C           COAS2     OREQ 33
     C           COLA2     COMP 'G'                  9090
     C         90COLA2     COMP 'M'                  9090
     C         90COLA2     COMP 'F'                  9090
     C         90COLA2     COMP 'P'                  9090
X1  C                     ELSE
     C           COLA2     COMP 'H'                  9090
     C         90COLA2     COMP 'V'                  9090
     C         90COLA2     COMP 'M'                  9090
     C         90COLA2     COMP 'P'                  9090
F1  C                     END
     C   90                Z-ADD34        MSG               MSG. 34
    C   90                GOTO PLU35
     C           COAS2     COMP 23                       80
     C      80   PASS2     COMP 400                  90
     C   90                Z-ADD35        MSG               MSG. 35
    C   90                GOTO PLU35
     *
     C           PLUS35    TAG
     * controle RINALDO  .
D1  C           RINAL     IFNE ' '
     C                     MOVEL'RINA'    PXARGU
     C                     MOVE RINAL     PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD34        MSG                MSG.34
     C                     SETON                     90
F2  C                     END
D2  C           COAS2     IFEQ *ZEROS
D3  C           COAS1     IFNE 30
    C           COAS1     ANDNE41
     C                     Z-ADD34        MSG                MSG.34
     C                     SETON                     90
F3  C                     END
X2  C                     ELSE
D3  C           COAS2     IFNE 30
    C           COAS2     ANDNE41
    C           COAS2     ANDNE40
     C                     Z-ADD34        MSG                MSG.34
     C                     SETON                     90
F3  C                     END
F2  C                     END
X1  C                     ELSE
D2  C           COAS1     IFEQ 30
    C           COAS1     OREQ 41
    C           COAS2     OREQ 30
    C           COAS2     OREQ 41
     C                     Z-ADD34        MSG                MSG.34
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
     * controle CHAMPION .
D1  C           COAS1     IFEQ 44
     C           TYPPCH    CHAINPOIGNEL1             80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD36        MSG                MSG.133
     C                     SETON                     90
F2  C                     END
X1  C                     ELSE
D2  C           TYPPCH    IFNE *BLANKS
D3  C           RINAL     IFNE *BLANKS                      PAS RINA
    C           COAS1     OREQ 31                           PAS PLAST.
    C           COAS1     OREQ 33
    C           COAS2     OREQ 31
    C           COAS2     OREQ 33
     C                     Z-ADD36        MSG                MSG.133
     C                     SETON                     90
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           USINE     IFEQ 3
D2  C           COAS1     IFEQ 27
    C           ETIQ1     ANDEQ' '
    C           COAS2     OREQ 27
    C           ETIQ2     ANDEQ' '
     C                     Z-ADD78        MSG                MSG.78
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
D1  C           CONDI     IFNE ' '
     C                     MOVEL'RAMA'    PXARGU
     C           1         SUBSTCONDI:2   WCONDI  1
     C                     MOVE WCONDI    PXVALE    P
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD31        MSG                MSG.34
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
D1  C           ORCU1     IFNE '  '
     C                     MOVELORCU1     CONC1   1 P
     C                     MOVE ORCU1     CONC2   10P
D2  C           USINE     IFNE 3
     *--- Début --- PHILIPPE 06/01/2016-- INC0324676 ---*
    C           USINE     ANDNE4
     *--- Fin   --- PHILIPPE 06/01/2016-- INC0324676 ---*
    C           COAS1     ORNE 26
    C           COAS1     ANDNE45
    C           COAS1     ANDNE46
    C           COAS1     ANDNE47
    C           CONC1     ORLT 'A'
    C           CONC1     ORGT 'I'
    C           CONC2     OREQ 0
     C                     Z-ADD29        MSG                MSG.34
     C                     SETON                     90
F2  C                     END
F1  C                     END
     *
    C           PLU35     ENDSR
     *
     C/SPACE 5
     ********************************************************************
     ** VALIDATION DU FORMAT 5  **************************
     *                                                    *ORDINO.PG. 5A*
    C           VALF05    BEGSR
     C                     EXSR RAZ
     *
D1  C           PDUNI1    IFEQ 0
    C           PDUNI2    ANDEQ0
     C                     Z-ADD37        MSG               MSG. 37
    C                     GOTO PLUS37
     C                     SETON                     90
F1  C                     END
     *
     C                     MOVE 'TPOR'    PXARGU
     C                     MOVE TYPOR     PXVALE    P
     C           CLEPAR    CHAINPARAME               90
    C           *IN90     CABEQ'1'       MSG79
     *
D1  C           TYPOR     IFLE 2
D2  C           LIEU      IFNE *ZEROS
     C                     MOVE 'DPTS'    PXARGU
     C                     MOVE LIEU      PXVALE    P
     C           CLEPAR    CHAINPARAME               90
     C                     MOVE LIEU      LIEUA   2
     C  N90      LIEUA     CHAINTRANSP               90
    C           *IN90     CABEQ'1'       MSG79
    C           CPAYFO    CABNE*ZEROS    MSG79      9090
X2  C                     ELSE
D3  C           CPAYFO    IFNE *ZEROS
    C           RPAYS     ORNE *BLANKS
     C                     MOVE 'TPAY'    PXARGU
     C                     MOVE CPAYFO    PXVALE    P
     C           CLEPAR    CHAINPARAME               90
     C  N90      CLETTR    CHAINTTREXP               90
    C           *IN90     CABEQ'1'       MSG79
F3  C                     END
F2  C                     END
     *
D2  C           PORKG     IFEQ *ZEROS
    C           LIEU      ANDEQ*ZEROS
    C           CPAYFO    ANDEQ*ZEROS
     C                     SETON                     90
    C                     GOTO MSG79
F2  C                     END
    C*
X1  C                     ELSE
    C           LIEU      CABNE*ZEROS    MSG79      9090
    C           CPAYFO    CABNE*ZEROS    MSG79      9090
    C           PORKG     CABNE*ZEROS    MSG79      9090
F1  C                     END
    C                     GOTO PLUS37
     *
     C           MSG79     TAG
     C                     Z-ADD79        MSG
     C                     SETON                     90
     *
     C           PLUS37    TAG
     C     N90             MOVELPDUNI1    PDUNI            *POIDS  A L'
     C     N90             MOVE PDUNI2    PDUNI             UNITE DE VENTE
     *
     C                     EXSR VALF06
     *
    C                     ENDSR
     C/SPACE 5
     ********************************************************************
     ** VALIDATION DU FORMAT 6  **************************
     *
    C           VALF06    BEGSR
     *
     C                     MOVE *BLANK    GENCO1  1
     C                     MOVE *BLANK    GENCO2  1
     C                     Z-ADD*ZEROS    PROAF1  40
     C                     Z-ADD*ZEROS    PROAF2  40
     *
D1  C           STCTDF    IFNE *BLANKS
D2  C           STREFA    IFEQ *ZEROS
    C           STROFA    ANDEQ*ZEROS
     C                     Z-ADD62        MSG
     C                     SETON                     6290
    C                     GOTO FVAL06
F2  C                     END
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE STCTDF    PXVALE
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD61        MSG
     C                     SETON                     6190
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDF    IFEQ 'A'
     C                     MOVE '*'       GENCO1
     C                     Z-ADDPROSOF    PROAF1
F2  C                     END
F1  C                     END
    C*
D1  C           NOPRUF    IFNE *BLANKS
    C           PROSOF    ANDEQ*ZEROS
     *
    C           PROSOF    OREQ *ZEROS
    C           LONG1     ANDNE*ZEROS
     C                     Z-ADD64        MSG
     C                     SETON                     6490
    C                     GOTO FVAL06
F1  C                     END
    C*
D1  C           PROSOF    IFNE *ZEROS
     C           PROSOF    SETLLPRODUL18                 80
D2  C           *IN80     IFEQ '0'
     C                     Z-ADD63        MSG
     C                     SETON                     6390
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDF    IFEQ 'F'
    C           STCTDF    OREQ 'G'
D3  C           LONG1     IFEQ *ZEROS
     C                     Z-ADD66        MSG
     C                     SETON                     6690
    C                     GOTO FVAL06
F3  C                     END
F2  C                     END
F1  C                     END
    C*          LONG1     IFNE *ZEROS
    C*          STCTDF    IFNE 'F'
    C*          STCTDF    ANDNE'G'
    C*                    Z-ADD65        MSG
    C*                    SETON                     6590
    C*                    GOTO FVAL06
    C*                    END
    C*                    END
     *
D1  C           STCTDE    IFNE *BLANKS
D2  C           STREEX    IFEQ *ZEROS
    C           STROEX    ANDEQ*ZEROS
     C                     Z-ADD62        MSG
     C                     SETON                     6290
    C                     GOTO FVAL06
F2  C                     END
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE STCTDE    PXVALE
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD61        MSG
     C                     SETON                     6190
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDE    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
     C                     Z-ADDPROSOE    PROAF1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
     C                     Z-ADDPROSOE    PROAF2
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           NOPRUE    IFNE *BLANKS
    C           PROSOE    ANDEQ*ZEROS
     *
    C           PROSOE    OREQ *ZEROS
    C           LARG1     ANDNE*ZEROS
     C                     Z-ADD64        MSG
     C                     SETON                     6490
    C                     GOTO FVAL06
F1  C                     END
    C*
D1  C           PROSOE    IFNE *ZEROS
     C           PROSOE    SETLLPRODUL18                 80
D2  C           *IN80     IFEQ '0'
     C                     Z-ADD63        MSG
     C                     SETON                     6390
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDE    IFEQ 'F'
    C           STCTDE    OREQ 'G'
D3  C           LARG1     IFEQ *ZEROS
     C                     Z-ADD66        MSG
     C                     SETON                     6690
    C                     GOTO FVAL06
F3  C                     END
F2  C                     END
F1  C                     END
    C*          LARG1     IFNE *ZEROS
    C*          STCTDE    IFNE 'F'
    C*          STCTDE    ANDNE'G'
    C*                    Z-ADD65        MSG
    C*                    SETON                     6590
    C*                    GOTO FVAL06
    C*                    END
    C*                    END
     *
D1  C           STCTDI    IFNE *BLANKS
D2  C           STREIN    IFEQ *ZEROS
    C           STROIN    ANDEQ*ZEROS
     C                     Z-ADD62        MSG
     C                     SETON                     6290
    C                     GOTO FVAL06
F2  C                     END
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE STCTDI    PXVALE
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD61        MSG
     C                     SETON                     6190
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDI    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
     C                     Z-ADDPROSOI    PROAF1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
     C                     Z-ADDPROSOI    PROAF2
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           NOPRUI    IFNE *BLANKS
    C           PROSOI    ANDEQ*ZEROS
     *
    C           STNBR3    ORNE *ZEROS
    C           PROSOI    ANDEQ*ZEROS
     C                     Z-ADD64        MSG
     C                     SETON                     6490
    C                     GOTO FVAL06
F1  C                     END
    C*
D1  C           PROSOI    IFNE *ZEROS
     C           PROSOI    SETLLPRODUL18                 80
D2  C           *IN80     IFEQ '0'
     C                     Z-ADD63        MSG
     C                     SETON                     6390
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCTDI    IFEQ 'F'
    C           STCTDI    OREQ 'G'
D3  C           STNBR3    IFEQ *ZEROS
     C                     Z-ADD66        MSG
     C                     SETON                     6690
    C                     GOTO FVAL06
F3  C                     END
F2  C                     END
F1  C                     END
    C*          STNBR3    IFNE *ZEROS
    C*          STCTDI    IFNE 'F'
    C*          STCTDI    ANDNE'G'
    C*                    Z-ADD65        MSG
    C*                    SETON                     6590
    C*                    GOTO FVAL06
    C*                    END
    C*                    END
    C*
D1  C           STCOD4    IFNE *BLANKS
D2  C           STREG4    IFEQ *ZEROS
    C           STROU4    ANDEQ*ZEROS
     C                     Z-ADD62        MSG
     C                     SETON                     6290
    C                     GOTO FVAL06
F2  C                     END
     C                     MOVE 'TDST'    PXARGU
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE STCOD4    PXVALE
     C           CLEPAR    CHAINPARAME               80
D2  C           *IN80     IFEQ '1'
     C                     Z-ADD61        MSG
     C                     SETON                     6190
    C                     GOTO FVAL06
F2  C                     END
D2  C           STCOD4    IFEQ 'A'
D3  C           GENCO1    IFEQ *BLANK
     C                     MOVE '*'       GENCO1
     C                     Z-ADDSTPSO4    PROAF1
X3  C                     ELSE
     C                     MOVE '*'       GENCO2
     C                     Z-ADDSTPSO4    PROAF2
F3  C                     END
F2  C                     END
    C*
D2  C           STCSO4    IFNE *BLANKS
    C           STPSO4    ANDEQ*ZEROS
     *
    C           STNBR4    ORNE *ZEROS
    C           STPSO4    ANDEQ*ZEROS
     C                     Z-ADD64        MSG
     C                     SETON                     6490
    C                     GOTO FVAL06
F2  C                     END
    C*
D2  C           STPSO4    IFNE *ZEROS
     C           STPSO4    SETLLPRODUL18                 80
D3  C           *IN80     IFEQ '0'
     C                     Z-ADD63        MSG
     C                     SETON                     6390
    C                     GOTO FVAL06
F3  C                     END
D3  C           STCOD4    IFEQ 'F'
    C           STCOD4    OREQ 'G'
D4  C           STNBR4    IFEQ *ZEROS
     C                     Z-ADD66        MSG
     C                     SETON                     6690
    C                     GOTO FVAL06
F4  C                     END
F3  C                     END
F2  C                     END
    C*          STNBR4    IFNE *ZEROS
    C*          STCOD4    IFNE 'F'
    C*          STCOD4    ANDNE'G'
    C*                    Z-ADD65        MSG
    C*                    SETON                     6590
    C*                    GOTO FVAL06
    C*                    END
    C*                    END
F1  C                     END
    C*
D1  C           GENCO1    IFEQ ' '
    C           AFFL1     ANDNE*ZEROS
    C           GENCO1    OREQ '*'
    C           AFFL1     ANDEQ*ZEROS
    C           PROAF1    ANDEQ*ZEROS
     C                     Z-ADD67        MSG
     C                     SETON                     6790
    C                     GOTO FVAL06
F1  C                     END
D1  C           AFFL1     IFEQ *ZEROS
    C           AFFD1     ANDNE*ZEROS
    C           AFFL1     ORNE *ZEROS
    C           AFFD1     ANDEQ*ZEROS
     C                     Z-ADD68        MSG
     C                     SETON                     6890
    C                     GOTO FVAL06
F1  C                     END
D1  C           GENCO2    IFEQ ' '
    C           AFFL2     ANDNE*ZEROS
    C           GENCO2    OREQ '*'
    C           AFFL2     ANDEQ*ZEROS
    C           PROAF2    ANDEQ*ZEROS
     C                     Z-ADD69        MSG
     C                     SETON                     6990
    C                     GOTO FVAL06
F1  C                     END                                       Z-
D1  C           AFFL2     IFEQ *ZEROS
    C           AFFD2     ANDNE*ZEROS
    C           AFFL2     ORNE *ZEROS
    C           AFFD2     ANDEQ*ZEROS
     C                     Z-ADD70        MSG
     C                     SETON                     7090
    C                     GOTO FVAL06
F1  C                     END
    C*
D1  C           STCTDF    IFEQ 'O'
    C           STCTDE    OREQ 'O'
    C           STCTDI    OREQ 'O'
    C           STCOD4    OREQ 'O'
D2  C           REFDSS    IFEQ *BLANKS
     C                     Z-ADD71        MSG
     C                     SETON                     7190
    C                     GOTO FVAL06
F2  C                     END
F1  C                     END
D1  C           REFDSS    IFNE *BLANKS
D2  C           STCTDF    IFNE 'O'
    C           STCTDE    ANDNE'O'
    C           STCTDI    ANDNE'O'
    C           STCOD4    ANDNE'O'
     C                     Z-ADD71        MSG
     C                     SETON                     7190
    C                     GOTO FVAL06
F2  C                     END
F1  C                     END
    C*
    C           FVAL06    ENDSR
     C/SPACE 5
     *****************************************************************
     * PRE-TRAITEMENT DU FORMAT 7 ************************************
     *
    C           PREF07    BEGSR
     *                                                    *ORDINO.PG.72 *
     C                     SETON                     969594
     C                     SETOF                     92
    C*
     C                     Z-ADDSTOCK2    NOAPP1
     C                     Z-ADDSTOCK3    NOAPP2
    C*
     C                     MOVE RVER7     ECHPAL
     * NE PLUS RENDRE LA ZONE OBLIGATOIRE POUR TOURY (TMAOCL)
    C***        USINE     IFNE 3
D1  C           ECHPAL    IFEQ *BLANK
     C                     MOVE 'N'       ECHPAL
F1  C                     END
     *
     C           PAPI1     COMP *BLANKS                  80
    C   80                GOTO PLU57
     C                     MOVE GRAM1     GRAM
     C                     MOVE PAPI1     PAPI
     C                     MOVE ADPAP1    ADPAP
     C                     MOVE ADGRA1    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP1     IFNE 0
    C           TIMP1     ANDNE3
    C           TIMP1     ANDNE5
    C           TREP1     ORNE 0
    C           TREP1     ANDNE3
    C           TREP1     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU57     TAG
     *
     C           PAPI2     COMP *BLANKS                  80
    C   80                GOTO PLU59
     C                     MOVE GRAM2     GRAM
     C                     MOVE PAPI2     PAPI
     C                     MOVE ADPAP2    ADPAP
     C                     MOVE ADGRA2    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP2     IFNE 0
    C           TIMP2     ANDNE3
    C           TIMP2     ANDNE5
    C           TREP2     ORNE 0
    C           TREP2     ANDNE3
    C           TREP2     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU59     TAG
     *
     *
     C           PAPI3     COMP *BLANKS                  80
    C   80                GOTO PLU60
     C                     MOVE GRAM3     GRAM
     C                     MOVE PAPI3     PAPI
     C                     MOVE ADPAP3    ADPAP
     C                     MOVE ADGRA3    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP3     IFNE 0
    C           TIMP3     ANDNE3
    C           TIMP3     ANDNE5
    C           TREP3     ORNE 0
    C           TREP3     ANDNE3
    C           TREP3     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU60     TAG
     *
     *
     C           PAPI4     COMP *BLANKS                  80
    C   80                GOTO PLU61
     C                     MOVE GRAM4     GRAM
     C                     MOVE PAPI4     PAPI
     C                     MOVE ADPAP4    ADPAP
     C                     MOVE ADGRA4    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP4     IFNE 0
    C           TIMP4     ANDNE3
    C           TIMP4     ANDNE5
    C           TREP4     ORNE 0
    C           TREP4     ANDNE3
    C           TREP4     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU61     TAG
     *
     *
     C           PAPI5     COMP *BLANKS                  80
    C   80                GOTO PLU62
     C                     MOVE GRAM5     GRAM
     C                     MOVE PAPI5     PAPI
     C                     MOVE ADPAP5    ADPAP
     C                     MOVE ADGRA5    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP5     IFNE 0
    C           TIMP5     ANDNE3
    C           TIMP5     ANDNE3
    C           TREP5     ORNE 5
    C           TREP5     ANDNE3
    C           TREP5     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU62     TAG
     *
     *
     C           PAPI6     COMP *BLANKS                  80
    C   80                GOTO PLU63
     C                     MOVE GRAM6     GRAM
     C                     MOVE PAPI6     PAPI
     C                     MOVE ADPAP6    ADPAP
     C                     MOVE ADGRA6    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP6     IFNE 0
    C           TIMP6     ANDNE3
    C           TIMP6     ANDNE5
    C           TREP6     ORNE 0
    C           TREP6     ANDNE3
    C           TREP6     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
    C   92 93             GOTO PLU58
     C           PLU63     TAG
     *
     *
     C           PAPI7     COMP *BLANKS                  80
    C   80                GOTO PLU58
     C                     MOVE GRAM7     GRAM
     C                     MOVE PAPI7     PAPI
     C                     MOVE ADPAP7    ADPAP
     C                     MOVE ADGRA7    ADGRA
     C           QUALIL    CHAINMATPREL1             80
     C  N80      CATEGO    COMP 'A'                      81
     C  N80N81N93CATEGO    COMP 'B'                  9393
D1  C           *IN92     IFEQ '0'
D2  C           TIMP7     IFNE 0
    C           TIMP7     ANDNE3
    C           TIMP7     ANDNE5
    C           TREP7     ORNE 0
    C           TREP7     ANDNE3
    C           TREP7     ANDNE5
     C                     SETON                     92
F2  C                     END
F1  C                     END
     *
    C           PLU58     ENDSR
     C/SPACE 5
     *****************************************************************
     *  CALCUL POIDS GANITURE          *******************
    C           SPDSRE    BEGSR
     C                     UPDATPRODUIF1
     C                     UPDATPRODSTF1
     C                     Z-ADDNOPRO     SVPRO   40
     C                     MOVE GARNT     SVGAR   2
     C           CLECLE    CHAINCOMPREL2             90
    C           *IN90     CABEQ'1'       FSPDSR
     *
     C                     Z-ADDNOPRO     SVPRO3  40
     C                     Z-ADD0         PDRE    51
     C           CLECLE    SETLLCOMPREL1
     C           CLECLE    READECOMPREL1                 90
D1  C           *IN90     DOWEQ'0'
     C                     Z-ADDNOPGAR    SVPRO2  40
     C           CLEGR2    CHAINPRODUL14             90
D2  C           *IN90     IFEQ '0'
     C                     ADD  PDUNI     PDRE
F2  C                     END
     C                     MOVELGARNT     GARNT2  1
D2  C           GARNT2    IFEQ 'A'
     C                     Z-ADDNOPGAR    SVPRO1  40
F2  C                     END
     C                     Z-ADDSVPRO3    NOPRO
     C           CLECLE    READECOMPREL1                 90
F1  C                     END
     C                     Z-ADDSVPRO1    NOPRO            ELEMENT A
     C           CLECLE    CHAINPRODUL14             90
D1  C           *IN90     IFEQ '0'
     C                     Z-ADDPDRE      PDSRE
     C                     UPDATPRODUIF
F1  C                     END
     *
     C           FSPDSR    TAG
     C                     Z-ADDSVPRO     NOPRO
     C                     MOVE SVGAR     GARNT   2
     C           CLECLE    CHAINPRODUI2              80
     C           CLECLE    CHAINPRODST2              80
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     * seton de l'indicateur d'erreur .
    C           MESSAG    BEGSR
     C                     Z-ADDMSG       M       50
     C                     MOVE 1         *IN,M
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     *  raz des indicateurs de travail *******************
    C           RAZ       BEGSR
     C                     Z-ADD0         ZZ11   110
     C                     MOVE ZZ11      ZZZ11  11
     C                     MOVEAZZZ11     *IN,80
    C                     ENDSR
     C/SPACE 5
     *****************************************************************
     ** mise a zero ou a blanc des zones de travail *******
     **
    C           ZERO      BEGSR
     * FORMAT 21
     C                     Z-ADD0         STE
     C                     Z-ADD0         NOCLI
     * FORMAT 1BIS
     C                     Z-ADD0         CCOL
     C                     Z-ADD0         ONDUL
     C                     Z-ADD0         FACON
     C                     MOVE *BLANKS   NATMAD
     C                     MOVE *BLANKS   NATMAI
     * FORMAT 01 *
     C                     Z-ADD0         USINE
     C                     MOVE *BLANKS   MICLI
     C                     MOVE *BLANKS   MACLI
     *  RAZ ZONES STOCKE **
     C                     EXSR ZERO2
     *
     * ECLATEMENT DE ZONE NUMERIQUE *
     C                     MOVE *ZEROS    POSF1A
     C                     MOVE *ZEROS    POSF1B
     C                     MOVE *ZEROS    POSF2A
     C                     MOVE *ZEROS    POSF2B
     C                     MOVE *ZEROS    PDUNI1
     C                     MOVE *ZEROS    PDUNI2
     * FORMAT 2
     C                     Z-ADD0         COUL1
     C                     Z-ADD0         COULD1
     C                     Z-ADD0         COUL2
     C                     Z-ADD0         COULD2
     C                     Z-ADD0         COUL3
     C                     Z-ADD0         COULD3
     C                     Z-ADD0         COUL4
     C                     Z-ADD0         COULD4
     C                     Z-ADD0         COUL5
     C                     Z-ADD0         COULD5
     C                     Z-ADD0         COUL6
     C                     Z-ADD0         COULD6
     C                     Z-ADD0         COUL7
     C                     Z-ADD0         COULD7
     C                     MOVE *BLANKS   COSESA
     C                     Z-ADD0         NBSESA
     C                     MOVE *BLANKS   COTAPE
     C                     Z-ADD0         NBTAPE
     C                     MOVE *BLANKS   GFRA
     C                     EXSR ZERZER
     * FORMAT 3
     C                     EXSR ZERO3
     * FORMAT 4
     C                     MOVE *BLANKS   COFENA 27
     C                     MOVE *BLANKS   COAS1A 27
     C                     MOVE *BLANKS   COAS2A 27
     * FORMAT 6
     C                     MOVE *ZEROS    KDIFA
     C                     MOVE *ZEROS    KDIFB
     C                     MOVE *ZEROS    KDIFC
     C                     MOVE *ZEROS    KDIFD
     C                     MOVE *ZEROS    KDIFE
     C                     MOVE *ZEROS    KDIFF
     C                     MOVE *ZEROS    KDIFG
     **
    C                     ENDSR
     **
     C/SPACE 2
    C           ZERO2     BEGSR
     C/SPACE 2
     * ZONE POUR LES SUPPORTS EXTRIEUR OU INTERIEUR *
     C                     MOVE *BLANKS   TIMEX
     C                     MOVE *BLANKS   TIMIN
     C                     MOVE *ZEROS    COUEXB
     C                     MOVE *ZEROS    COUINB
     C                     MOVE *BLANKS   COUPEX
     C                     MOVE *BLANKS   COUPIN
     C                     MOVE *ZEROS    TIMPEX
     C                     MOVE *ZEROS    TIMPIN
    C                     ENDSR
     C/SPACE 2
    C           ZERO3     BEGSR                            RAZ ZONE
     C                     MOVE *BLANKS   TSEXT             TRAVAIL
     C                     MOVE *ZEROS    ENCREX            FORMAT 3
     C                     MOVE *BLANKS   TVEREX
     C                     MOVE *BLANKS   CVEREX
     C                     MOVE *ZEROS    ENSPEX
     C                     MOVE *BLANKS   APLAEX
     C                     MOVE *BLANKS   ORCUEX
     C                     MOVE *ZEROS    TREPEX
     C                     MOVE *ZEROS    RCOUEX
     C                     MOVE *ZEROS    RENCEX
     C                     MOVE *BLANKS   RVEREX
     C                     MOVE *ZEROS    RCVERE
     C                     MOVE *BLANKS   GRAPEX
     C                     MOVE *BLANKS   UVEXT
     C                     MOVE *BLANKS   RETSEX
     C                     MOVE *BLANKS   RGRAEX
     C                     MOVE *BLANKS   USIEXT
     C                     MOVE *BLANKS   RUVEX
     C                     MOVE *BLANKS   NATEEX
     C                     MOVE *BLANKS   RNATEX
     C                     MOVE *ZEROS    OFPA1E
     C                     MOVE *ZEROS    OFPA2E
     *
     C                     MOVE *BLANKS   TSINT
     C                     MOVE *ZEROS    ENCRIN
     C                     MOVE *BLANKS   TVERIN
     C                     MOVE *BLANKS   CVERIN
     C                     MOVE *ZEROS    ENSPIN
     C                     MOVE *BLANKS   APLAIN
     C                     MOVE *BLANKS   ORCUIN
     C                     MOVE *ZEROS    TREPIN
     C                     MOVE *ZEROS    RCOUIN
     C                     MOVE *ZEROS    RENCIN
     C                     MOVE *BLANKS   RVERIN
     C                     MOVE *ZEROS    RCVERI
     C                     MOVE *BLANKS   USIINT
     C                     MOVE *BLANKS   GRAPIN
     C                     MOVE *BLANKS   UVINT
     C                     MOVE *BLANKS   RETSIN
     C                     MOVE *BLANKS   RGRAIN
     C                     MOVE *BLANKS   RUVIN
     C                     MOVE *BLANKS   NATEIN
     C                     MOVE *BLANKS   RNATIN
     C                     MOVE *ZEROS    OFPA1I
     C                     MOVE *ZEROS    OFPA2I
     *
    C                     ENDSR
     C/SPACE 2
    C           ZERZER    BEGSR                           RAZ ZONES DE
     C                     MOVE *ZEROS    TIMP    10       TRAVAIL
     C                     Z-ADD0         CTA     10       FORMAT 2
     C                     Z-ADD0         CTB     10
     C                     Z-ADD0         TOTAB   10
     C                     Z-ADD0         FORLA   40
     C                     Z-ADD0         FORHA   40
     C                     Z-ADD0         FORLA1  40
     C                     Z-ADD0         FORHA1  40
     C                     Z-ADD0         FORLA2  40
     C                     Z-ADD0         FORHA2  40
     C                     MOVE *BLANKS   TIMPA   6
     C                     Z-ADD0         FORM1   40
     C                     Z-ADD0         FORMM   10
     C                     Z-ADD0         FORTH1  30
     C                     Z-ADD0         THFOR1  40
     C                     Z-ADD0         FORM2   40
     C                     Z-ADD0         FORM2B  40
     C                     MOVE *BLANKS   PAPI    3
     C                     Z-ADD0         GRAM    30
     C                     Z-ADD0         FORL    40
     C                     Z-ADD0         FORH    40
     C                     Z-ADD0         COUL
     C                     MOVE *BLANKS   COUP    1
     C                     MOVE *BLANKS   LAIZ    3
     C                     MOVE *BLANKS   MACHIZ  1
     C                     MOVE *BLANKS   DECORT  1
     C                     MOVE *BLANKS   DECOUP  1
    C                     ENDSR
    C*****************************************************************
    C*
    C*  1ER SUPPORT IMPRESSION
    C           ZERO1A    BEGSR
D1  C           TIMP1A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP1
     C                     MOVE *BLANKS   TIMP1A
F1  C                     END
     C                     MOVE *BLANKS   USEXT
     C                     MOVE *ZEROS    USIEXT
     C                     MOVE *ZEROS    ENCR1
     C                     MOVE *BLANKS   TS1
     C                     MOVE *BLANKS   TVER1
     C                     MOVE *ZEROS    CVER1
     C                     MOVE *ZEROS    ENSP1
     C                     MOVE *BLANKS   APLA1
     C                     MOVE *BLANKS   ORCU1
     C                     MOVE *ZEROS    KDIF1
     C                     MOVE *ZEROS    TREP1
     C                     MOVE *ZEROS    RENC1
     C                     MOVE *BLANKS   RVER1
     C                     MOVE *ZEROS    RCVE1
     C                     MOVE *ZEROS    RDIF1
    C*                    MOVE *BLANKS   GRAP1
     C                     MOVE *BLANKS   UV1
     C                     MOVE *BLANKS   RUV1
     C                     MOVE *BLANKS   RETS1
     C                     MOVE *BLANKS   RGRA1
    C*                    MOVE *BLANKS   RNAT1
    C*                    MOVE *BLANKS   NATE1
     C                     MOVE *ZEROS    OFPA11
     C                     MOVE *ZEROS    OFPA21
     C                     Z-ADD0         PREXT
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFEXT
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECEX
     C                     Z-ADD0         DECRE
    C                     ENDSR
    C* 2EME SUPPORT  IMPRESSION
    C           ZERO1B    BEGSR
D1  C           TIMP2A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP2
     C                     MOVE *BLANKS   TIMP2A
F1  C                     END
     C                     MOVE *BLANKS   USEXT
     C                     MOVE *ZEROS    USIEXT
     C                     MOVE *ZEROS    ENCR2
     C                     MOVE *BLANKS   TS2
     C                     MOVE *BLANKS   TVER2
     C                     MOVE *ZEROS    CVER2
     C                     MOVE *ZEROS    ENSP2
     C                     MOVE *BLANKS   APLA2
     C                     MOVE *BLANKS   ORCU2
     C                     MOVE *ZEROS    KDIF2
     C                     MOVE *ZEROS    TREP2
     C                     MOVE *ZEROS    RCOU2
     C                     MOVE *ZEROS    RENC2
     C                     MOVE *BLANKS   RVER2
     C                     MOVE *ZEROS    RCVE2
     C                     MOVE *ZEROS    RDIF2
     C                     MOVE *BLANKS   GRAP2
     C                     MOVE *BLANKS   UV2
     C                     MOVE *BLANKS   RUV2
     C                     MOVE *BLANKS   RETS2
     C                     MOVE *BLANKS   RGRA2
     C                     MOVE *BLANKS   RNAT2
     C                     MOVE *BLANKS   NATE2
     C                     MOVE *ZEROS    OFPA12
     C                     MOVE *ZEROS    OFPA22
     C                     Z-ADD0         PREXT
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFEXT
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECEX
     C                     Z-ADD0         DECRE
    C                     ENDSR
    C*
    C*  3EME SUPPORT  IMPRESSION
    C           ZERO1C    BEGSR
D1  C           TIMP3A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP3
     C                     MOVE *BLANKS   TIMP3A
F1  C                     END
     C                     MOVE *BLANKS   USEXT
     C                     MOVE *ZEROS    USIEXT
     C                     MOVE *ZEROS    ENCR3
     C                     MOVE *BLANKS   TS3
     C                     MOVE *BLANKS   TVER3
     C                     MOVE *ZEROS    CVER3
     C                     MOVE *ZEROS    ENSP3
     C                     MOVE *BLANKS   APLA3
     C                     MOVE *BLANKS   ORCU3
     C                     MOVE *ZEROS    KDIF3
     C                     MOVE *ZEROS    TREP3
     C                     MOVE *ZEROS    RCOU3
     C                     MOVE *ZEROS    RENC3
     C                     MOVE *BLANKS   RVER3
     C                     MOVE *ZEROS    RCVE3
     C                     MOVE *ZEROS    RDIF3
     C                     MOVE *BLANKS   GRAP3
     C                     MOVE *BLANKS   UV3
     C                     MOVE *BLANKS   RUV3
     C                     MOVE *BLANKS   RETS3
     C                     MOVE *BLANKS   RGRA3
     C                     MOVE *BLANKS   RNAT3
     C                     MOVE *BLANKS   NATE3
     C                     MOVE *ZEROS    OFPA13
     C                     MOVE *ZEROS    OFPA23
     C                     Z-ADD0         PREXT
     C                     Z-ADD0         PRREX
     C                     Z-ADD0         EFEXT
     C                     Z-ADD0         EFREX
     C                     Z-ADD0         DECEX
     C                     Z-ADD0         DECRE
    C                     ENDSR
    C*
    C*  4EME SUPPORT  IMPRESSION
    C           ZERO1D    BEGSR
D1  C           TIMP4A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP4
     C                     MOVE *BLANKS   TIMP4A
F1  C                     END
     C                     MOVE *BLANKS   USINT
     C                     MOVE *ZEROS    USIINT
     C                     MOVE *ZEROS    ENCR4
     C                     MOVE *BLANKS   TS4
     C                     MOVE *BLANKS   TVER4
     C                     MOVE *ZEROS    CVER4
     C                     MOVE *ZEROS    ENSP4
     C                     MOVE *BLANKS   APLA4
     C                     MOVE *BLANKS   ORCU4
     C                     MOVE *ZEROS    KDIF4
     C                     MOVE *ZEROS    TREP4
     C                     MOVE *ZEROS    RCOU4
     C                     MOVE *ZEROS    RENC4
     C                     MOVE *BLANKS   RVER4
     C                     MOVE *ZEROS    RCVE4
     C                     MOVE *ZEROS    RDIF4
     C                     MOVE *BLANKS   GRAP4
     C                     MOVE *BLANKS   UV4
     C                     MOVE *BLANKS   RUV4
     C                     MOVE *BLANKS   RETS4
     C                     MOVE *BLANKS   RGRA4
     C                     MOVE *BLANKS   RNAT4
     C                     MOVE *BLANKS   NATE4
     C                     MOVE *ZEROS    OFPA14
     C                     MOVE *ZEROS    OFPA24
     C                     Z-ADD0         PRINT
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFINT
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECIN
     C                     Z-ADD0         DECRI
    C                     ENDSR
    C*
    C* 5EME SUPPORT  IMPRESSION
    C           ZERO1E    BEGSR
D1  C           TIMP5A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP5
     C                     MOVE *BLANKS   TIMP5A
F1  C                     END
     C                     MOVE *BLANKS   USINT
     C                     MOVE *ZEROS    USIINT
     C                     MOVE *ZEROS    ENCR5
     C                     MOVE *BLANKS   TS5
     C                     MOVE *BLANKS   TVER5
     C                     MOVE *ZEROS    CVER5
     C                     MOVE *ZEROS    ENSP5
     C                     MOVE *BLANKS   APLA5
     C                     MOVE *BLANKS   ORCU5
     C                     MOVE *ZEROS    KDIF5
     C                     MOVE *ZEROS    TREP5
     C                     MOVE *ZEROS    RCOU5
     C                     MOVE *ZEROS    RENC5
     C                     MOVE *BLANKS   RVER5
     C                     MOVE *ZEROS    RCVE5
     C                     MOVE *ZEROS    RDIF5
     C                     MOVE *BLANKS   GRAP5
     C                     MOVE *BLANKS   UV5
     C                     MOVE *BLANKS   RUV5
     C                     MOVE *BLANKS   RETS5
     C                     MOVE *BLANKS   RGRA5
     C                     MOVE *BLANKS   RNAT5
     C                     MOVE *BLANKS   NATE5
     C                     MOVE *ZEROS    OFPA15
     C                     MOVE *ZEROS    OFPA25
     C                     Z-ADD0         PRINT
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFINT
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECIN
     C                     Z-ADD0         DECRI
    C                     ENDSR
    C*
    C*
    C*  6EME SUPPORT  IMPRESSION
    C           ZERO1F    BEGSR
D1  C           TIMP6A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP6
     C                     MOVE *BLANKS   TIMP6A
F1  C                     END
     C                     MOVE *BLANKS   USINT
     C                     MOVE *ZEROS    USIINT
     C                     MOVE *ZEROS    ENCR6
     C                     MOVE *BLANKS   TS6
     C                     MOVE *BLANKS   TVER6
     C                     MOVE *ZEROS    CVER6
     C                     MOVE *ZEROS    ENSP6
     C                     MOVE *BLANKS   APLA6
     C                     MOVE *BLANKS   ORCU6
     C                     MOVE *ZEROS    KDIF6
     C                     MOVE *ZEROS    TREP6
     C                     MOVE *ZEROS    RCOU6
     C                     MOVE *ZEROS    RENC6
     C                     MOVE *BLANKS   RVER6
     C                     MOVE *ZEROS    RCVE6
     C                     MOVE *ZEROS    RDIF6
     C                     MOVE *BLANKS   GRAP6
     C                     MOVE *BLANKS   UV6
     C                     MOVE *BLANKS   RUV6
     C                     MOVE *BLANKS   RETS6
     C                     MOVE *BLANKS   RGRA6
     C                     MOVE *BLANKS   RNAT6
     C                     MOVE *BLANKS   NATE6
     C                     MOVE *ZEROS    OFPA16
     C                     MOVE *ZEROS    OFPA26
     C                     Z-ADD0         PRINT
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFINT
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECIN
     C                     Z-ADD0         DECRI
    C                     ENDSR
    C*
    C*
    C* 7EME SUPPORT  IMPRESSION
    C           ZERO1G    BEGSR
D1  C           TIMP7A    IFEQ *BLANKS
     C                     MOVE *ZERO     TIMP7
     C                     MOVE *BLANKS   TIMP7A
F1  C                     END
     C                     MOVE *BLANKS   USINT
     C                     MOVE *ZEROS    USIINT
     C                     MOVE *ZEROS    ENCR7
     C                     MOVE *BLANKS   TS7
     C                     MOVE *BLANKS   TVER7
     C                     MOVE *ZEROS    CVER7
     C                     MOVE *ZEROS    ENSP7
     C                     MOVE *BLANKS   APLA7
    C*                    MOVE *BLANKS   ORCU7
     C                     MOVE *ZEROS    KDIF7
     C                     MOVE *ZEROS    TREP7
     C                     MOVE *ZEROS    RCOU7
     C                     MOVE *ZEROS    RENC7
     C                     MOVE *BLANKS   RVER7
     C                     MOVE *ZEROS    RCVE7
     C                     MOVE *ZEROS    RDIF7
     C                     MOVE *BLANKS   GRAP7
     C                     MOVE *BLANKS   UV7
     C                     MOVE *BLANKS   RUV7
     C                     MOVE *BLANKS   RETS7
     C                     MOVE *BLANKS   RGRA7
     C                     MOVE *BLANKS   RNAT7
     C                     MOVE *BLANKS   NATE7
     C                     MOVE *ZEROS    OFPA17
     C                     MOVE *ZEROS    OFPA27
     C                     Z-ADD0         PRINT
     C                     Z-ADD0         PRRIN
     C                     Z-ADD0         EFINT
     C                     Z-ADD0         EFRIN
     C                     Z-ADD0         DECIN
     C                     Z-ADD0         DECRI
    C                     ENDSR
    C* FENETRE
    C           ZERO1H    BEGSR
     C                     MOVE *ZEROS    PASFE
     C                     MOVE *ZEROS    LCOUP
     C                     MOVE *ZEROS    COLFE
     C                     MOVE *ZEROS    KFEN
     C                     MOVE *ZEROS    AGRAF
     C                     MOVE *ZEROS    LAIZB
     C                     MOVE *ZEROS    NBRFE
     C                     MOVE *ZEROS    RHODO
     C                     MOVE *ZEROS    PRFEN
     C                     MOVE *ZEROS    EFFEN
    C                     ENDSR
    C* 1ER ASSEMBLAGE
    C           ZERO1I    BEGSR
     C                     MOVE *BLANKS   PLIA1
     C                     MOVE *ZEROS    PASS1
     C                     MOVE *ZEROS    AXES1
     C                     MOVE *ZEROS    LPAT1
     C                     MOVE *ZEROS    COLA1
     C                     MOVE *ZEROS    PIST1
     C                     MOVE *BLANKS   PATS1
     C                     MOVE *BLANKS   CONDI
     C                     MOVE *ZEROS    PRAS1
     C                     MOVE *ZEROS    KASS1
     C                     MOVE *ZEROS    EFAS1
     C                     MOVE *ZEROS    DECA1
     C                     MOVE *BLANKS   MTPS1
     C                     MOVE *BLANKS   COLV1
     C                     MOVE *BLANKS   RELC1
     C                     MOVE *BLANKS   ETIQ1
     C                     MOVE *BLANKS   JUMEL
     C                     MOVE *BLANKS   RINAL
    C                     ENDSR
    C* 2EME ASSEMBLAGE
    C           ZERO1J    BEGSR
     C                     MOVE *BLANKS   PLIA2
     C                     MOVE *ZEROS    PASS2
     C                     MOVE *ZEROS    AXES2
     C                     MOVE *ZEROS    LPAT2
     C                     MOVE *ZEROS    COLA2
     C                     MOVE *ZEROS    PIST2
     C                     MOVE *BLANKS   PATS2
     C                     MOVE *ZEROS    PRAS2
     C                     MOVE *ZEROS    KASS2
     C                     MOVE *ZEROS    EFAS2
     C                     MOVE *ZEROS    DECA2
     C                     MOVE *BLANKS   MTPS2
     C                     MOVE *BLANKS   COLV2
     C                     MOVE *BLANKS   RELC2
     C                     MOVE *BLANKS   ETIQ2
    C                     ENDSR
    C* DORURE
    C           ZEROD     BEGSR
     C                     MOVE *BLANKS   DNATP1
     C                     MOVE *BLANKS   DDIFP1
     C                     MOVE *BLANKS   DNATP2
     C                     MOVE *BLANKS   DDIFP2
     C                     MOVE *BLANKS   DNATP3
     C                     MOVE *BLANKS   DDIFP3
     C                     MOVE *BLANKS   DNATP4
     C                     MOVE *BLANKS   DDIFP4
     C                     Z-ADD*ZEROS    DSMIP1
     C                     Z-ADD*ZEROS    DSMAP1
     C                     Z-ADD*ZEROS    DSMIP2
     C                     Z-ADD*ZEROS    DSMAP2
     C                     Z-ADD*ZEROS    DSMIP3
     C                     Z-ADD*ZEROS    DSMAP3
     C                     Z-ADD*ZEROS    DSMIP4
     C                     Z-ADD*ZEROS    DSMAP4
     C                     MOVE *BLANKS   REFDOR
     C                     MOVE *BLANKS   REFDO2
     C                     MOVE *BLANKS   REFDO3
     C                     MOVE *BLANKS   REFDO4
     C                     MOVE *BLANKS   DFPXF1
     C                     MOVE *BLANKS   DTYPF1
     C                     Z-ADD*ZEROS    DSFF1
     C                     Z-ADD*ZEROS    DLZF1
     C                     MOVE *BLANKS   DNPAF1
     C                     MOVE *BLANKS   DFPXF2
     C                     MOVE *BLANKS   DTYPF2
     C                     Z-ADD*ZEROS    DSFF2
     C                     Z-ADD*ZEROS    DLZF2
     C                     MOVE *BLANKS   DNPAF2
     C                     MOVE *BLANKS   DFPXF3
     C                     MOVE *BLANKS   DTYPF3
     C                     Z-ADD*ZEROS    DSFF3
     C                     Z-ADD*ZEROS    DLZF3
     C                     MOVE *BLANKS   DNPAF3
     C                     MOVE *BLANKS   DFPXF4
     C                     MOVE *BLANKS   DTYPF4
     C                     Z-ADD*ZEROS    DSFF4
     C                     Z-ADD*ZEROS    DLZF4
     C                     MOVE *BLANKS   DNPAF4
     C                     MOVE *BLANKS   DFPXF5
     C                     MOVE *BLANKS   DTYPF5
     C                     Z-ADD*ZEROS    DSFF5
     C                     Z-ADD*ZEROS    DLZF5
     C                     MOVE *BLANKS   DNPAF5
     C                     MOVE *BLANKS   DFPXF6
     C                     MOVE *BLANKS   DTYPF6
     C                     Z-ADD*ZEROS    DSFF6
     C                     Z-ADD*ZEROS    DLZF6
     C                     MOVE *BLANKS   DNPAF6
     C                     MOVE *BLANKS   DFPXF7
     C                     MOVE *BLANKS   DTYPF7
     C                     Z-ADD*ZEROS    DSFF7
     C                     Z-ADD*ZEROS    DLZF7
     C                     MOVE *BLANKS   DNPAF7
     C                     MOVE *BLANKS   DFPXF8
     C                     MOVE *BLANKS   DTYPF8
     C                     Z-ADD*ZEROS    DSFF8
     C                     Z-ADD*ZEROS    DLZF8
     C                     MOVE *BLANKS   DNPAF8
     C                     MOVE *BLANKS   DFPXF9
     C                     MOVE *BLANKS   DTYPF9
     C                     Z-ADD*ZEROS    DSFF9
     C                     Z-ADD*ZEROS    DLZF9
     C                     MOVE *BLANKS   DNPAF9
     C                     MOVE *BLANKS   DFPXFA
     C                     MOVE *BLANKS   DTYPFA
     C                     Z-ADD*ZEROS    DSFFA
     C                     Z-ADD*ZEROS    DLZFA
     C                     MOVE *BLANKS   DNPAFA
     C                     MOVE *BLANKS   DFPXFB
     C                     MOVE *BLANKS   DTYPFB
     C                     Z-ADD*ZEROS    DSFFB
     C                     Z-ADD*ZEROS    DLZFB
     C                     MOVE *BLANKS   DNPAFB
     C                     MOVE *BLANKS   DFPXFC
     C                     MOVE *BLANKS   DTYPFC
     C                     Z-ADD*ZEROS    DSFFC
     C                     Z-ADD*ZEROS    DLZFC
     C                     MOVE *BLANKS   DNPAFC
    C                     ENDSR
    C*
    C*** EN MAJ PRODUITS RAZ DES ZONES MACHINES POUR LE FACONNAGE .**
    C***  POST-TRAITEMENT DU FORMAT 01 **
    C           ZEROZZ    BEGSR
     C                     Z-ADD0         MAOND1
     C                     Z-ADD0         MAOND2
     C                     Z-ADD0         MAOND3
     C                     Z-ADD0         MACOL1
     C                     Z-ADD0         MACOL2
     C                     Z-ADD0         MACOL3
     C                     MOVE *BLANKS   MADEC1
     C                     MOVE *BLANKS   MADEC2
     C                     MOVE *BLANKS   MADEC3
     C                     Z-ADD0         MAAUT1
     C                     Z-ADD0         MAAUT2
     C                     Z-ADD0         MAAUT3
     C                     Z-ADD0         MAFEN1
     C                     Z-ADD0         MAFEN2
     C                     Z-ADD0         MAFEN3
     C                     Z-ADD0         MAAS11
     C                     Z-ADD0         MAAS12
     C                     Z-ADD0         MAAS13
     C                     Z-ADD0         MAAS21
     C                     Z-ADD0         MAAS22
     C                     Z-ADD0         MAAS23
D1  C           FAOND     IFNE *ZEROS
     C                     MOVELUSINE     FAOND
F1  C                     END
D1  C           FACOL     IFNE *ZEROS
     C                     MOVELUSINE     FACOL
F1  C                     END
D1  C           FADEC     IFNE *ZEROS
     C                     MOVELUSINE     FADEC
F1  C                     END
D1  C           FAAUT     IFNE *ZEROS
     C                     MOVELUSINE     FAAUT
F1  C                     END
D1  C           FAFEN     IFNE *ZEROS
     C                     MOVELUSINE     FAFEN
F1  C                     END
D1  C           FAAS1     IFNE *ZEROS
     C                     MOVELUSINE     FAAS1
F1  C                     END
D1  C           FAAS2     IFNE *ZEROS
     C                     MOVELUSINE     FAAS2
F1  C                     END
     C                     MOVE '*'       FST     1
     C                     EXSR ECRIT
    C* EMBALLAGE
    C*------------------
     C                     MOVE *BLANKS   FST
     C                     Z-ADDSTE       STEE10
     C                     Z-ADDNOCLI     NOCE10
     C                     Z-ADDNOPRO     NOPE10
     C                     CALL 'EMB010£'
     C                     PARM           EMB010
     C                     Z-ADDUSINE     USIE1
     C                     Z-ADDSTE       STEE1
     C                     Z-ADDNOCLI     NOCLE1
     C                     Z-ADDNOPRO     NOPRE1
     C                     CALL 'EMB001£'
     C                     PARM           EMB001
     C           CLECLE    CHAINPRODUI2              80
     C           CLECLE    CHAINPRODST2              80
    C                     ENDSR
    C*****************************************************************
    C*** ABANDON SIASIE - SUPPRESSION EMBALLAGE                    ***
    C*****************************************************************
    C           ABAN21    BEGSR
     C                     Z-ADDUSINE     USIE6
     C                     Z-ADDSTE       STEE6
     C                     Z-ADDNOCLI     NOCLE6
     C                     Z-ADDANDEV     ANNEE6
     C                     Z-ADDETUDE     ETUDE6
     C                     Z-ADDSEQDE     SEQE6
     C                     MOVELNOMFA1    NOME6
     C                     CALL 'EMB006L'
     C                     PARM           EMB006
    C                     ENDSR
     C/EJECT
     *--------------------------------------------------------*
     *   PREPARATION AFFICHAGE PONDERATION                    *
     *--------------------------------------------------------*
    C           AVANT1    BEGSR
     *          ---------------
     C                     EXSR PRE03                      SI DIRECT
     *
D1  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X1  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F1  C                     END
     *
     C                     MOVE *BLANKS   AFFIC
D1  C           AFFI      IFEQ '*'
     C                     Z-ADDNOETU     SVNOEZ
     C                     CALL 'DEV026£'
     C                     PARM           DEV026
F1  C                     END
     *
     C                     MOVE *BLANK    TCXHE   1
     C                     MOVE *BLANK    TCXHI   1
     C                     MOVELADPAP1    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHE
F1  C                     END
     C                     MOVELADPAP2    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHE
F1  C                     END
     C                     MOVELADPAP3    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHE
F1  C                     END
     C                     MOVELADPAP7    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F1  C                     END
     C                     MOVELADPAP6    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F1  C                     END
     C                     MOVELADPAP5    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F1  C                     END
     C                     MOVELADPAP4    REFOUR
D1  C           CXH       IFEQ 'CXH'
    C           CXH       OREQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVE '*'       TCXHI
F1  C                     END
     *
     C                     Z-ADDPRD       SPRD
     C                     Z-ADDPRG       SPRG
     C                     Z-ADDPRO       SPRO
     C                     Z-ADDPEF       SPEF
     C                     Z-ADDPDE       SPDE
     C                     Z-ADDROC       SROC
     C                     Z-ADDRET       SRET
     C                     Z-ADD*ZEROS    PRD
     C                     Z-ADD*ZEROS    PRG
     C                     Z-ADD*ZEROS    PRO
     C                     Z-ADD*ZEROS    PEF
     C                     Z-ADD*ZEROS    PDE
     C                     Z-ADD*ZEROS    ROC
     C                     Z-ADD*ZEROS    RET
     C                     Z-ADD*ZEROS    TN
     C                     Z-ADD*ZEROS    K       20
D1  C           TIMPEX    IFNE *ZEROS
    C           TIMPEX    ANDNE3
    C*          TIMPEX    ANDNE5
     C                     ADD  1         K
     C                     Z-ADD1         TN,K
F1  C                     END
D1  C           TREPEX    IFNE *ZEROS
    C           TREPEX    ANDNE3
    C*          TREPEX    ANDNE5
     C                     ADD  1         K
     C                     Z-ADD2         TN,K
F1  C                     END
D1  C           TIMPIN    IFNE *ZEROS
    C           TIMPIN    ANDNE3
    C*          TIMPIN    ANDNE5
     C                     ADD  1         K
     C                     Z-ADD3         TN,K
F1  C                     END
D1  C           TREPIN    IFNE *ZEROS
    C           TREPIN    ANDNE3
    C*          TREPIN    ANDNE5
     C                     ADD  1         K
     C                     Z-ADD4         TN,K
F1  C                     END
D1  C           DNATP1    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD26        TN,K
F1  C                     END
D1  C           DNATP2    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD27        TN,K
F1  C                     END
D1  C           DNATP3    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD30        TN,K
F1  C                     END
D1  C           DNATP4    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD31        TN,K
F1  C                     END
    C*          PAFIL1    IFNE *BLANKS
    C*                    ADD  1         K
    C*                    Z-ADD24        TN,K
    C*                    END
    C*          PAFIL2    IFNE *BLANKS
    C*                    ADD  1         K
    C*                    Z-ADD25        TN,K
    C*                    END
D1  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     ADD  1         K
     C                     Z-ADD5         TN,K
F1  C                     END
D1  C           TCXHE     IFEQ '*'
     C                     ADD  1         K
     C                     Z-ADD15        TN,K
F1  C                     END
D1  C           TCXHI     IFEQ '*'
     C                     ADD  1         K
     C                     Z-ADD16        TN,K
F1  C                     END
D1  C           GFRA      IFNE *BLANKS
     C                     MOVELGFRA      XG1     1
D2  C           XG1       IFEQ 'G'
     C                     ADD  1         K
     C                     Z-ADD6         TN,K
F2  C                     END
F1  C                     END
D1  C           GFRA2     IFNE *BLANKS
     C                     MOVELGFRA2     XG1     1
D2  C           XG1       IFEQ 'G'
     C                     ADD  1         K
     C                     Z-ADD66        TN,K
F2  C                     END
F1  C                     END
    C*          CCOL      IFEQ 6
    C*          COUI3     IFEQ 1
    C*                    ADD  1         K
    C*                    Z-ADD21        TN,K
    C*                    ELSE
    C*                    ADD  1         K
    C*                    Z-ADD7         TN,K
    C*                    END
    C*                    ADD  1         K
    C*                    Z-ADD8         TN,K
    C*                    END
D1  C           CCOL      IFEQ 2
    C           CCOL      OREQ 3
    C           CCOL      OREQ 9
     C                     ADD  1         K
     C                     Z-ADD7         TN,K
F1  C                     END
D1  C           CCOL      IFEQ 1
    C           CCOL      OREQ 5
    C*          CCOL      OREQ 6
     C                     ADD  1         K
     C                     Z-ADD8         TN,K
F1  C                     END
D1  C           TIMPEX    IFEQ 3
    C           TREPEX    OREQ 3
    C           TIMPIN    OREQ 3
    C           TREPIN    OREQ 3
D2  C           CCOL      IFNE 4
    C           CCOL      ANDNE7
     C                     ADD  1         K
     C                     Z-ADD9         TN,K
F2  C                     END
F1  C                     END
D1  C           AFFD1     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD9         TN,K
F1  C                     END
D1  C           AFFD2     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD19        TN,K
F1  C                     END
    C*          TREPEX    IFEQ 5
    C*          TIMPEX    ANDEQ5
    C*                    ADD  1         K
    C*                    Z-ADD17        TN,K
    C*                    END
    C*          TREPIN    IFEQ 5
    C*          TIMPIN    ANDEQ5
    C*                    ADD  1         K
    C*                    Z-ADD18        TN,K
    C*                    END
    C*          TIMPEX    IFEQ 2
    C*          TIMPIN    ANDEQ5
    C*                    ADD  1         K
    C*                    Z-ADD18        TN,K
    C*                    END
     *
D1  C           AFFIC     IFEQ '1'
    C           CCOL      OREQ 6
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '2'
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '3'
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
F1  C                     END
D1  C           AFFIC     IFEQ '4'
     C                     ADD  1         K
     C                     Z-ADD22        TN,K
     C                     ADD  1         K
     C                     Z-ADD21        TN,K
F1  C                     END
D1  C           GFRA      IFNE *BLANKS
     C                     MOVELGFRA      XG1     1
D2  C           XG1       IFEQ 'X'
     C                     ADD  1         K
     C                     Z-ADD6         TN,K
F2  C                     END
F1  C                     END
D1  C           GFRA2     IFNE *BLANKS
     C                     MOVELGFRA2     XG1     1
D2  C           XG1       IFEQ 'X'
     C                     ADD  1         K
     C                     Z-ADD66        TN,K
F2  C                     END
F1  C                     END
     *
D1  C           FACON     IFEQ 6
    C           FACON     OREQ 7
    C           FACON     OREQ 8
     C                     ADD  1         K
     C                     Z-ADD10        TN,K
     C                     MOVE TDECO     TDEC3   1
D2  C           TDEC3     IFNE '0'
    C           TDEC3     ANDNE'7'
    C           TDEC3     ANDNE'8'
     C                     ADD  1         K
     C                     Z-ADD11        TN,K
F2  C                     END
D2  C           RETS7     IFEQ 'O'
     C                     ADD  1         K
     C                     Z-ADD23        TN,K
F2  C                     END
D2  C           TYPFEN    IFNE *BLANKS
     C                     ADD  1         K
     C                     Z-ADD12        TN,K
F2  C                     END
D2  C           COAS1     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD13        TN,K
F2  C                     END
D2  C           COAS2     IFNE *ZEROS
     C                     ADD  1         K
     C                     Z-ADD14        TN,K
F2  C                     END
     *--- Début --- Philippe --- 17/11/2015 --- Pose Accssoires  *
     * - Gestion de la pose Accessoires en Post-Assemblage
     * 2 Cas de figure : 1 - Modification par ajout d'une pose
     *                   2 - Modification par suppression d'une Pose
D2  C           EPOSAC    IFEQ '*'
     * Cas 1 - Modification par ajout d'une pose
D3  C           EYECOD    IFNE *BLANK
     C                     ADD  1         K
     C                     Z-ADD28        TN,K
F3  C                     END
D3  C           BTPCOD    IFNE *BLANK
     C                     ADD  1         K
     C                     Z-ADD29        TN,K
F3  C                     END
F2  C                     END
     *--- Fin   --- Philippe --- 17/11/2015 --- Pose Accssoires  *
F1  C                     END
     *
     C                     MOVEA'00000000'*IN,51
     C                     MOVEA'000000'  *IN,59
     C                     Z-ADD*ZEROS    K
D1  C                     DO   14        K
D2  C           TN,K      IFNE *ZEROS
     C           TN,K      LOKUPTABCS     TABLS          50
     C                     MOVELTABLS     LSS,K
     * AJOUT LIBELLÉ COMPACT EI SI E AVANT I OU I AVANT E
D3  C           ZTCO35    IFGE '1'
    C           OCOMEI    ANDEQ'EI'
    C           TN,K      ANDLE02
D4  C           TN,K      IFEQ 01
D5  C           UV1       IFNE 'O'
     C                     MOVE 'CExt'    LSS,K
X5  C                     ELSE
     C                     MOVE 'CInt'    LSS,K
F5  C                     END
X4  C                     ELSE
D5  C           UV1       IFNE 'O'
     C                     MOVE 'CInt'    LSS,K
X5  C                     ELSE
     C                     MOVE 'CExt'    LSS,K
F5  C                     END
F4  C                     END
X3  C                     ELSE
     C                     MOVE '    '    LSS,K
F3  C                     END
     *
     C           50        ADD  K         J       20
     C                     MOVEA'1'       *IN,J
     C                     Z-ADD1         Z       20
     C           TN,K      LOKUPTSS,Z                    50
D3  C           *IN50     IFEQ '1'
     C                     Z-ADDSPRD,Z    PRD,K
     C                     Z-ADDSPRG,Z    PRG,K
     C                     Z-ADDSPRO,Z    PRO,K
     C                     Z-ADDSPEF,Z    PEF,K
     C                     Z-ADDSPDE,Z    PDE,K
     C                     Z-ADDSROC,Z    ROC,K
     C                     Z-ADDSRET,Z    RET,K
F3  C                     END
F2  C                     END
F1  C                     END
     C                     Z-ADDTN        TSS
     *
    C                     ENDSR
     **  SELECTION POUR LE FORMAT 2  *********                        ***
    C           B1BISA    BEGSR
     *
     C                     EXSR RAZ
     C                     EXSR RAZIND
     *
     C                     MOVELFACON     ZON2    2
     C                     MOVE CCOL      ZON2
     C           ZON2      LOKUPTAB3      TAB33          99
D1  C           TAB33     IFEQ 'A'
     C                     SETON                     03
F1  C                     END
D1  C           TAB33     IFEQ 'B'
     C                     SETON                     0313
F1  C                     END
D1  C           TAB33     IFEQ 'C'
     C                     SETON                     0304
F1  C                     END
D1  C           TAB33     IFEQ 'D'
     C                     SETON                     030405
     C                     SETON                     14
F1  C                     END
D1  C           TAB33     IFEQ 'F'
     C                     SETON                     020304
     C                     SETON                     0506
     C                     SETON                     131415
F1  C                     END
     *
D1  C           FACON     IFEQ 0
    C           FACON     OREQ 1
     C                     SETON                     949798
     C                     SETON                     99
D2  C           CCOL      IFEQ 4
    C           CCOL      OREQ 7
     C                     SETOF                     94
F2  C                     END
F1  C                     END
    C*
D1  C           CCOL      IFEQ 9
    C*          CCOL      OREQ 6
    C           CCOL      OREQ 8
    C           ONDUL     ANDEQ9
     C                     SETON                     95
     C                     MOVELCVEI3     CNDD
X1  C                     ELSE
     C                     SETOF                     95
     C                     MOVE *BLANKS   CNDD
F1  C                     END
    C*          CCOL      COMP 6                        64
    C*
D1  C           FACON     IFEQ 2
     C                     SETON                     949798
     C                     SETON                     99
F1  C                     END
D1  C           FACON     IFEQ 5
     C                     SETON                     9899
F1  C                     END
D1  C           FACON     IFEQ 6
     C                     SETON                     9399
F1  C                     END
D1  C           FACON     IFEQ 7
    C           FACON     OREQ 8
     C                     SETON                     99
F1  C                     END
D1  C           FACON     IFEQ 9
     C                     SETON                     919294
     C                     SETON                     9899
F1  C                     END
D1  C           FACON     IFEQ 4
     C                     SETON                     9798
F1  C                     END
    C*
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : CONTROLE FORMAT COMPLEXAGE               *
     *--------------------------------------------------------*
    C           CTLF10    BEGSR
     *          ---------------
     C                     SETOF                     61
    C* SI PELCXH
D1  C           *IN64     IFEQ '1'
D2  C           LZPEUT    IFEQ *ZEROS
    C           LZPEAP    OREQ *ZEROS
     C                     SETON                     6561
F2  C                     END
D2  C           LZPEUT    IFGT LZPEAP
     C                     SETON                     6661
F2  C                     END
F1  C                     END
    C* APPRO PAPIER
D1  C           LZAPPX    IFNE *ZEROS
     C           LZAPPX    MULT 10        LZAPPC  40
D2  C           LZAPPC    IFLT FLCXH
     C                     SETON                     5161
F2  C                     END
F1  C                     END
D1  C           FLAPPX    IFNE *ZEROS
    C           FHAPPX    ANDEQ*ZEROS
    C           FLAPPX    OREQ *ZEROS
    C           FHAPPX    ANDNE*ZEROS
     C                     SETON                     5261
F1  C                     END
D1  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ANDNE*ZEROS
     C                     SETON                     5461
F1  C                     END
D1  C           FLAPPX    IFNE *ZEROS
D2  C           FLAPPX    IFLT FLCXH
    C           FHAPPX    ORLT FHCXH
    C           FLAPPX    OREQ FLCXH
    C           FHAPPX    ANDEQFHCXH
     C                     SETON                     5361
F2  C                     END
F1  C                     END
     * MESSAGE POUR MINI MAXI DE LA COMPLEXEUSE
     * RECHERCHE DU PLUS PETIT ET DU PLUS GRAND
     * OUVERT = LE PLUS GRAND, DEFIL = LE PLUS PETIT
D1  C           FORL      IFLT FORH
     C                     Z-ADDFORH      OUVERT  40
     C                     Z-ADDFORL      DEFIL   40
X1  C                     ELSE
     C                     Z-ADDFORL      OUVERT
     C                     Z-ADDFORH      DEFIL
F1  C                     END
D1  C           DEFIL     IFLT 720
    C           OUVERT    ORGT 1420
     C                     MOVE LIBMSG,3  WMSGOF
     C                     Z-ADDFORL      EFORL
     C                     Z-ADDFORH      EFORH
     C                     EXFMTDOFFSET
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 1                            *
     *--------------------------------------------------------*
    C           SPCXH1    BEGSR
     *          ---------------
     C                     SETOF                     606263
     C                     MOVE *BLANKS   IMPCX
     C           PASECX    COMP 2                    62  62
     C           PASECX    COMP 3                    63  63
D1  C           TIMPEX    IFEQ 1
     C                     SETON                     60
     C                     MOVE 'HELIO'   IMPCX
F1  C                     END
D1  C           TIMPEX    IFEQ 2
     C                     SETON                     60
     C                     MOVE 'FLEXO'   IMPCX
F1  C                     END
     C                     MOVE PAPECX    PAPCX
     C                     Z-ADDGRAECX    GRACX
     C                     MOVE REFECX    ADPCX
     C                     Z-ADDRELECX    ADGCX
     C                     Z-ADDPASECX    PASCX
     C                     MOVE RSIECX    RSICX
     C                     MOVE APIECX    APICX
     C                     Z-ADDNBPECX    NBPCX
     C                     MOVE SCOECX    SCOCX
D1  C           APICX     IFEQ *BLANK
    C           *IN60     ANDEQ'1'
     C                     MOVE 'O'       APICX
F1  C                     END
     C                     MOVE CPECXH    CPCXH
     C                     MOVELADPCX     REFX    3
     C           REFX      COMP 'PEL'                    64
D1  C           *IN64     IFEQ '1'
     C           KPST5     CHAINPRODST5              99
D2  C           *IN99     IFEQ '0'
     C                     Z-ADDLZAPP     LZAPPX
     C                     Z-ADDFLAPP     FLAPPX
     C                     Z-ADDFHAPP     FHAPPX
F2  C                     END
     C                     Z-ADDFLCXHE    FLCXH   40
     C                     Z-ADDFHCXHE    FHCXH   40
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 2                            *
     *--------------------------------------------------------*
    C           SPCXH2    BEGSR
     *          ---------------
     C                     MOVE RSICX     RSIECX
     C                     MOVE APICX     APIECX
     C                     Z-ADDNBPCX     NBPECX
     C                     MOVE SCOCX     SCOECX
     C                     MOVE CPCXH     CPECXH
D1  C           *IN64     IFEQ '1'
     C           KPST5     CHAINPRODST5              99
D2  C           *IN99     IFEQ '0'
D3  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ORNE *ZEROS
     C                     Z-ADDLZAPPX    LZAPP
     C                     Z-ADDFLAPPX    FLAPP
     C                     Z-ADDFHAPPX    FHAPP
     C                     UPDATPRODSTF5
X3  C                     ELSE
     C                     DELETPRODSTF5
F3  C                     END
X2  C                     ELSE
D3  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ORNE *ZEROS
     C                     Z-ADDLZAPPX    LZAPP
     C                     Z-ADDFLAPPX    FLAPP
     C                     Z-ADDFHAPPX    FHAPP
     C                     WRITEPRODSTF5
F3  C                     END
F2  C                     END
F1  C                     END
    C*
     C                     MOVE ' '       TVEI2
D1  C           LZAPPX    IFNE *ZEROS
     C                     MOVE 'B'       TVEI2
F1  C                     END
D1  C           FLAPPX    IFNE *ZEROS
D2  C           FLAPPX    IFNE FLCXH
    C           FHAPPX    ANDNEFLCXH
     C                     MOVE 'N'       TVEI2
X2  C                     ELSE
     C                     MOVE 'M'       TVEI2
F2  C                     END
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 3                            *
     *--------------------------------------------------------*
    C           SPCXH3    BEGSR
     *          ---------------
     C                     SETOF                     606263
     C           PASICX    COMP 2                    62  62
     C           PASICX    COMP 3                    63  63
D1  C           TIMPIN    IFEQ 1
    C           TIMPIN    OREQ 2
     C                     SETON                     60
F1  C                     END
     C                     MOVE PAPICX    PAPCX
     C                     Z-ADDGRAICX    GRACX
     C                     MOVE REFICX    ADPCX
     C                     Z-ADDRELICX    ADGCX
     C                     Z-ADDPASICX    PASCX
     C                     MOVE RSIICX    RSICX
     C                     MOVE APIICX    APICX
     C                     Z-ADDNBPICX    NBPCX
     C                     MOVE SCOICX    SCOCX
D1  C           APICX     IFEQ *BLANK
    C           *IN60     ANDEQ'1'
     C                     MOVE 'O'       APICX
F1  C                     END
     C                     MOVE CPICXH    CPCXH
     C                     MOVELADPCX     REFX    3
     C           REFX      COMP 'PEL'                    64
D1  C           *IN64     IFEQ '1'
     C           KPST5     CHAINPRODST5              99
D2  C           *IN99     IFEQ '0'
     C                     Z-ADDLZAPP     LZAPPX
     C                     Z-ADDFLAPP     FLAPPX
     C                     Z-ADDFHAPP     FHAPPX
F2  C                     END
     C                     Z-ADDFLCXHI    FLCXH
     C                     Z-ADDFHCXHI    FHCXH
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE N° 4                            *
     *--------------------------------------------------------*
    C           SPCXH4    BEGSR
     *          ---------------
     C                     MOVE RSICX     RSIICX
     C                     MOVE APICX     APIICX
     C                     Z-ADDNBPCX     NBPICX
     C                     MOVE SCOCX     SCOICX
     C                     MOVE CPCXH     CPICXH
D1  C           *IN64     IFEQ '1'
     C           KPST5     CHAINPRODST5              99
D2  C           *IN99     IFEQ '0'
D3  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ORNE *ZEROS
     C                     Z-ADDLZAPPX    LZAPP
     C                     Z-ADDFLAPPX    FLAPP
     C                     Z-ADDFHAPPX    FHAPP
     C                     UPDATPRODSTF5
X3  C                     ELSE
     C                     DELETPRODSTF5
F3  C                     END
X2  C                     ELSE
D3  C           LZAPPX    IFNE *ZEROS
    C           FLAPPX    ORNE *ZEROS
     C                     Z-ADDLZAPPX    LZAPP
     C                     Z-ADDFLAPPX    FLAPP
     C                     Z-ADDFHAPPX    FHAPP
     C                     WRITEPRODSTF5
F3  C                     END
F2  C                     END
F1  C                     END
    C*
D1  C           TVEI2     IFEQ ' '
D2  C           LZAPPX    IFNE *ZEROS
     C                     MOVE 'B'       TVEI2
F2  C                     END
D2  C           FLAPPX    IFNE *ZEROS
D3  C           FLAPPX    IFNE FLCXH
    C           FHAPPX    ANDNEFLCXH
     C                     MOVE 'N'       TVEI2
X3  C                     ELSE
     C                     MOVE 'M'       TVEI2
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : VERIFICATION STOCK ET COMMANDE           *
     *--------------------------------------------------------*
    C           SPSTK     BEGSR
     *          ---------------
D1  C           NCONF     IFNE 0
     C           CLECDE    SETLLCDESL5                   10
F1  C                     END
     C                     Z-ADD0         STKPRO
     C                     Z-ADD0         IMPEXT
     C                     Z-ADD0         IMPINT
     *
     C                     MOVELOVR,1     OVRDB  40
     C                     Z-ADD40        LONG
     C                     CALL 'QCAEXEC'
     C                     PARM           OVRDB
     C                     PARM           LONG
     C                     OPEN LIEUST03
     *
     C           CLELIE    CHAINLIEUST03             95
D1  C           *IN95     DOWEQ'0'
D2  C           ORD       IFEQ 0
     C                     ADD  STOLIE    STKPRO     15
F2  C                     END
     C           CLELIE    READELIEUST03                 95
F1  C        N95          END
     C                     SETOF                     95
     C                     CLOSELIEUST03
     *
     * Calcul Stock Papier Imprimé
     * ---------------------------
     *
     * Test si plus d'une Impréssion
     *
     C                     Z-ADD0         EX      10
     C                     Z-ADD0         IN      10
     *
D1  C           TIMP3     IFGT 0
    C           TIMP3     ANDNE3
    C           TIMP3     ANDNE5
     C                     Z-ADD3         EX
X1  C                     ELSE
D2  C           TIMP2     IFGT 0
    C           TIMP2     ANDNE3
    C           TIMP2     ANDNE5
     C                     Z-ADD2         EX
X2  C                     ELSE
D3  C           TIMP1     IFGT 0
    C           TIMP1     ANDNE3
    C           TIMP1     ANDNE5
     C                     Z-ADD1         EX
F3  C                     END
F2  C                     END
F1  C                     END
     *
D1  C           TIMP4     IFGT 0
    C           TIMP4     ANDNE3
    C           TIMP4     ANDNE5
     C                     Z-ADD4         IN
X1  C                     ELSE
D2  C           TIMP5     IFGT 0
    C           TIMP5     ANDNE3
    C           TIMP5     ANDNE5
     C                     Z-ADD5         IN
X2  C                     ELSE
D3  C           TIMP6     IFGT 0
    C           TIMP6     ANDNE3
    C           TIMP6     ANDNE5
     C                     Z-ADD6         IN
X3  C                     ELSE
D4  C           TIMP7     IFGT 0
    C           TIMP7     ANDNE3
    C           TIMP7     ANDNE5
     C                     Z-ADD7         IN
F4  C                     END
F3  C                     END
F2  C                     END
F1  C                     END
     C                     Z-ADD0         IMPEXT
     C                     Z-ADD0         IMPINT
     C           CLELIE    CHAINMVTIMPLF             99
     *
D1  C           *IN99     DOWEQ'0'
D2  C           SUIMP     IFEQ EX
     C                     ADD  PROFIN    IMPEXT     11
X2  C                     ELSE
     C                     ADD  PROFIN    IMPINT     12
F2  C                     END
     C           CLELIE    READEMVTIMPLF                 99
F1  C                     END
     * Planning Matériel
     * ---------------------------
     C           CLELIE    SETLLPLAMAL8                  16
    C                     ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : COMPLEXE - COMPOSANT                     *
     *--------------------------------------------------------*
    C           COMCXH    BEGSR
     *          ---------------
     C                     MOVE '0'       IN93
     C                     MOVE '0'       *IN50
    C*
D1  C           *IN50     DOWEQ'0'
D2  C           SUPCXH    IFNE 'F'
     C           CLE4B     CHAINMATPREL1             98
D3  C           CATEGO    IFGT 'B'
    C           *IN98     ANDEQ'0'
     C                     MOVE '1'       IN93
F3  C                     END
    C           IN93      CABEQ'1'       FCOMCX
F2  C                     END
     C           QUALIL    READECXHLIGL2                 50
F1  C  N50                END
    C           FCOMCX    ENDSR
     *--------------------------------------------------------*
     * S/PROGRAMME : USINE PRE IMPRIME                        *
     *--------------------------------------------------------*
    C           SPLUSP    BEGSR
     *          ---------------
D1  C           USINEP    IFNE 0
     C                     MOVE USINEP    PXVALE    P
     C                     MOVE 'USDE'    PXARGU
     C           CLEPAR    CHAINPARAME               99
     C   35                MOVELPXABRG    USIEXT
     C   35                MOVE USINEP    ETSEXT
     C   37                MOVELPXABRG    USIINT
     C   37                MOVE USINEP    ETSINT
F1  C                     END
    C                     ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * SI CHABANAIS
     *--------------------------------------------------------*
    C           CCHA      BEGSR                                       E2*
     *
D1  C           FORL3     IFNE *ZEROS
     C                     Z-ADDFORL3     FORL
X1  C                     ELSE
D2  C           FORL5     IFNE *ZEROS
     C                     Z-ADDFORL5     FORL
F2  C                     END
F1  C                     END
D1  C           FORH3     IFNE *ZEROS
     C                     Z-ADDFORH3     FORH
X1  C                     ELSE
D2  C           FORH5     IFNE *ZEROS
     C                     Z-ADDFORH5     FORH
F2  C                     END
F1  C                     END
     *
D1  C           FMINH     IFEQ *ZEROS
    C           FMINL     ANDEQ*ZEROS
    C                     GOTO FCHAX
F1  C                     END
     *
D1  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCHAX
F1  C                     END
     *
     C           ONDL      SUB  FMINL     X4A     40
     C           ONDH      SUB  FMINH     X4B     40
D1  C           ONDL      IFGT ONDH                       PRISE PINCE
D2  C           X4A       IFLT 0                            GRAND COTE
    C           X4A       ORGT 32                         RV 15/3/2000
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 32
    C                     GOTO SCHAX
F2  C                     END
X1  C                     ELSE
D2  C           X4A       IFLT 0
    C           X4A       ORGT 32
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 32
    C                     GOTO SCHAX
F2  C                     END
F1  C                     END
    C*
D1  C           CCOL      IFEQ 1
D2  C           FORL      IFEQ *ZEROS
    C           FORH      OREQ *ZEROS
    C                     GOTO SCHAX
F2  C                     END
    C*
     C           FORL      SUB  ONDL      X4A
     C           FORH      SUB  ONDH      X4B
D2  C           X4A       IFLT 3
    C           X4A       ORGT 7
    C                     GOTO SCHAX
F2  C                     END
D2  C           X4B       IFLT 3
    C           X4A       ORGT 7
    C                     GOTO SCHAX
F2  C                     END
F1  C                     END
    C*
     C           LMINI     MULT 10        LMIMI
     C           LMIMI     DIV  ONDL      X3      30
     C           ONDL      MULT X3        LALAIZ
     C                     ADD  ACOTE     LALAIZ
     C                     ADD  20        LALAIZ
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D1  C           X1        IFNE 0
     C                     MOVE '0'       X41
F1  C                     END
D1  C           LMINI     IFNE X41
     C                     ADD  1         X41
D2  C           LMINI     IFNE X41
     C                     ADD  1         X41
D3  C           LMINI     IFNE X41
    C                     GOTO SCHAX
F3  C                     END
F2  C                     END
F1  C                     END
    C           LMINI     CABGT180       SCHAX
     *
    C                     GOTO FCHAX
     *
     C           SCHAX     TAG
     *          ---------------
     C                     Z-ADD76        MSG
     C                     SETON                     90    MESSAGE 66
    C           FCHAX     ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * SI CANNELURES CROISSÉES
     *--------------------------------------------------------*
    C           CANCRO    BEGSR                                       E2*
     *
D1  C           FMINH     IFEQ *ZEROS
    C           FMINL     ANDEQ*ZEROS
    C                     GOTO SCANCR
F1  C                     END
     *
D1  C           DECL      IFGT FMINL
    C           DECH      ORGT FMINH
    C                     GOTO SCANCR
F1  C                     END
     *
     C           ONDL      SUB  FMINL     X4A
     C           ONDH      SUB  FMINH     X4B
D1  C           ONDL      IFGT ONDH                       PRISE PINCE
D2  C           X4A       IFLT 0                            GRAND COTE
    C           X4A       ORGT 25                                     000
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
X1  C                     ELSE
D2  C           X4A       IFLT 0
    C           X4A       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFLT 0
    C           X4B       ORGT 25
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END
    C*
D1  C           COUI3     IFEQ 1
D2  C           FORL2     IFEQ *ZEROS
    C           FORH2     OREQ *ZEROS
    C                     GOTO SCANCR
F2  C                     END
    C*
D2  C           ICEI3     IFEQ 'O'                        CROISSÉES
     C           FORL2     SUB  ONDH      X4A
     C           FORH2     SUB  ONDL      X4B
X2  C                     ELSE                            PAS CROISSEES
     C           FORL2     SUB  ONDL      X4A
     C           FORH2     SUB  ONDH      X4B
F2  C                     END
D2  C           X4A       IFNE 5
    C                     GOTO SCANCR
F2  C                     END
D2  C           X4B       IFNE 5
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END                                        7
    C*
     C           LMINI     MULT 10        LMIMI
     C           LMIMI     DIV  ONDL      X3      30
     C           ONDL      MULT X3        LALAIZ
     C                     ADD  ACOTE     LALAIZ
     C                     ADD  20        LALAIZ
     C           LALAIZ    DIV  10        X41     41
     C                     MOVE LALAIZ    X1
D1  C           X1        IFNE 0
     C                     MOVE '0'       X41
F1  C                     END
D1  C           LMINI     IFNE X41
     C                     ADD  1         X41
D2  C           LMINI     IFNE X41
    C                     GOTO SCANCR
F2  C                     END
F1  C                     END
    C           LMINI     CABGT150       SCANCR
     *
    C                     GOTO FCANCR
    C*
     C           SCANCR    TAG
     *          ---------------
     C                     Z-ADD66        MSG
     C                     SETON                     90    MESSAGE 65
    C           FCANCR    ENDSR
     C/SPACE 3
     *--------------------------------------------------------*
     * SI SOUS TRAITANCE
     *--------------------------------------------------------*
    C           SPSTIN    BEGSR                                       E2*
     *
     C           B11       TAG
     *          ---------------
     C                     MOVE '0'       *IN
     C                     MOVE INDPCL    SINDPC 20
     C           ANNULS    COMP *BLANKS              2121
     C                     MOVE USINE     FABETS  10
     C                     MOVE *BLANKS   PROMO1
     C                     MOVE *BLANKS   ZERO1
    C           PROTO     CABEQ*BLANKS   BMP11A
     C                     MOVELPROTO     PROTO1  1
     C           PROTO1    COMP 'P'                      80
     C   80                MOVE 'X'       PROMO1
     C           PROTO1    COMP 'T'                      80
     C   80                MOVE 'X'       ZERO1
     C           BMP11A    TAG
     C           GARNT     COMP '  '                     80
     C                     MOVELGARNT     GARNT1  1
     C           GARNT1    COMP 'M'                      81
     C  N80N81             SETON                     99
     *
     C                     MOVE 'N'       OP
D1  C           NOCLI     IFEQ 8928                       SOFHUNIC
D2  C           CCOL      IFEQ 4                          COMPLEXAGE
    C           CCOL      OREQ 7
     C                     SETON                         23
F2  C                     END
F1  C                     END
     *
     * INC0463463  LE 16/05/17 FME
     *
D1  C           NOCLI     IFEQ 8928
     C                     SETON                         70
     C                     MOVE TS1       TPRD
X1  C                     ELSE
     C                     SETOF                         70
F1  C                     END
     *
D1  C           AUTFRB    IFLT *ZEROS
     C                     MOVE '-'       SIGAF
     C                     Z-SUBAUTFRB    AUTFRB
X1  C                     ELSE
     C                     MOVE *BLANKS   SIGAF
F1  C                     END
     *
     C           BMP11     TAG
     *
     C                     MOVE *BLANKS   PXVALE
     C                     MOVE 'INDP'    PXARGU
     C                     MOVE NOCLI     PXVALE
     C           CLEPAR    CHAINPARAME               33
     C                     EXFMTPF11
     *
D1  C           OP        IFEQ 'O'
     C           *LOVAL    SETLLPRODUI2                    POUR LIBERER
     C                     MOVE 'O'       OP0
     C                     MOVE STE       STPOP
     C                     MOVE NOCLI     NOCPOP
     C                     MOVE NOPRO     NOPPOP
     C                     CALL 'LAN015£'
     C                     PARM           DSPOP
     * On sauvegarde les données de l' écran car on doit faire un
     * CHAIN sur PRODUI2 pour voir si prod. annulé. (ag1)
     * ag1 début
     C                     MOVE *BLANKS   GARNTX  2
     C                     MOVE *BLANKS   INDPCX 40
     C                     MOVE *BLANKS   BLOC1X 40
     C                     MOVE *BLANKS   BLOC2X 40
     C                     MOVE *BLANKS   BLOC4X 40
     C                     MOVE *BLANKS   BLOC5X 40
     C                     MOVE *BLANKS   PROMOX  1
     C                     MOVE *BLANKS   ZERO1X  1
     C                     MOVE *BLANKS   OBSI1X 40
     C                     MOVE *BLANKS   OBSI2X 40
     C                     MOVE *BLANKS   OBSI3X 40
     C                     Z-ADDUSINE     USINX   10
     C                     Z-ADDMACLI     MACLIX  42
     C                     Z-ADDMICLI     MICLIX  42
     C                     MOVE GARNT     GARNTX
     C                     MOVE INDPCL    INDPCX
     C                     MOVE BLOC11    BLOC1X
     C                     MOVE BLOC2     BLOC2X
     C                     MOVE BLOC4     BLOC4X
     C                     MOVE BLOC5     BLOC5X
     C                     MOVE PROMO1    PROMOX
     C                     MOVE ZERO1     ZERO1X
     C                     MOVE OBSI1     OBSI1X
     C                     MOVE OBSI2     OBSI2X
     C                     MOVE OBSI3     OBSI3X
     C           CLECLE    CHAINPRODUI2              9080
     C                     MOVE ANNUL     ANNULS  1
     C                     Z-ADDUSINX     USINE
     C                     Z-ADDMACLIX    MACLI
     C                     Z-ADDMICLIX    MICLI
     C                     MOVE GARNTX    GARNT
     C                     MOVE INDPCX    INDPCL
     C                     MOVE BLOC1X    BLOC11
     C                     MOVE BLOC2X    BLOC2
     C                     MOVE BLOC4X    BLOC4
     C                     MOVE BLOC5X    BLOC5
     C                     MOVE PROMOX    PROMO1
     C                     MOVE ZERO1X    ZERO1
     C                     MOVE OBSI1X    OBSI1
     C                     MOVE OBSI2X    OBSI2
     C                     MOVE OBSI3X    OBSI3
     * ag1 fin
    C                     GOTO B11
F1  C                     END
     *
     C   70                MOVE TPRD      TS1
     C   90 13             MOVE '0'       *IN,M
     C                     MOVE *BLANKS   MSGMSG
     C                     MOVE *BLANKS   TU
     C                     SETOF                     90
     C   77                MOVEL'O'       WANNUL
    C   77                GOTO FSPSTI
     *
     C                     EXSR VALF01
    C   90                GOTO BMP11
    C* SURFACE
    C*------------------------------------
D1  C           SUVENT    IFEQ *ZEROS
     C                     SETON                     71
    C                     GOTO BMP11
F1  C                     END
    C* SOUS TRAITANCE REGLAGE ET ROULAGE
    C*------------------------------------
D1  C           STREFA    IFEQ *ZEROS
    C           STROFA    ANDEQ*ZEROS
     C                     SETON                     72    MESSAGE 167
    C                     GOTO BMP11
F1  C                     END
    C* AUTRES FRAIS
    C*-------------------------
D1  C           AUTFRB    IFEQ *ZEROS
    C           LIBCAF    ANDNE*BLANKS
    C           AUTFRB    ORNE *ZEROS
    C           LIBCAF    ANDEQ*BLANKS
     C                     SETON                     74    MESSAGE 120
    C                     GOTO BMP11
F1  C                     END
    C* VALEUR RELATIVE
    C*-------------------------
D1  C           RELAT     IFEQ *ZEROS
    C           LIBCVR    ANDNE*BLANKS
    C           RELAT     ORNE *ZEROS
    C           LIBCVR    ANDEQ*BLANKS
     C                     SETON                     78    MESSAGE 119
    C                     GOTO BMP11
F1  C                     END
     * TRANSPORT
     *------------------------
D1  C           PDUNI     IFEQ *ZEROS
     C                     SETON                     75    MESSAGE 135
    C                     GOTO BMP11
F1  C                     END
    C*
     C                     MOVE 'TPOR'    PXARGU
     C                     MOVE TYPOR     PXVALE    P
     C           CLEPAR    CHAINPARAME               76    MESSAGE 137
    C           *IN76     CABEQ'1'       BMP11
     *
D1  C           TYPOR     IFLE 2
    C           PORKG     ANDEQ*ZEROS
     C                     SETON                     77    MESSAGE 140
    C                     GOTO BMP11
F1  C                     END
     *
D1  C           SIGAF     IFEQ '-'
     C                     Z-SUBAUTFRB    AUTFRB
F1  C                     END
     *
     C                     EXSR POST01
D1  C           USINE     IFNE FABETS
     C                     EXSR ZEROZZ
X1  C                     ELSE
     C                     EXSR ECRIT
F1  C                     END
    C* APPEL PROD70£ POUR METTRE A JOUR INDPCL
D1  C           SINDPC    IFNE INDPCL
     C                     Z-ADDSTE       STE70
     C                     Z-ADDNOCLI     NOCL70
     C                     Z-ADDNOPRO     NOPR70
     C                     MOVEAPROD70    SB1,99
     C                     Z-ADD140       LONG   155
     C                     CALL 'QCAEXEC'
     C                     PARM           SB1
     C                     PARM           LONG
F1  C                     END
    C           FSPSTI    ENDSR
     *--------------------------------------------------------*
     *   PREPARATION CXH                                      *
     *--------------------------------------------------------*
    C           PRESOF    BEGSR
     *          ---------------
     C                     Z-ADD*ZEROS    NPSOF2
     C                     Z-ADD*ZEROS    NPSOF3
     C                     Z-ADD*ZEROS    NPSOF4
     C                     Z-ADD*ZEROS    NPSOF5
     C                     Z-ADD*ZEROS    NPSOF6
    C* 1° PAPIER
    C*-------------------------
D1  C           PAPI2     IFNE *BLANKS
     C                     MOVE ADPAP2    CXH     3
D2  C           CXH       IFEQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVELPAPI2     SPAPI
     C                     Z-ADDGRAM2     SGRAMM
     C                     MOVELADPAP2    SREFOU
     C                     Z-ADDADGRA2    SGRARE
D3  C           FORL2     IFNE *ZEROS
     C                     MOVE 'F'       SFOUB
X3  C                     ELSE
     C                     MOVE 'B'       SFOUB
F3  C                     END
     C           CLESOF    CHAINPRODUL28             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDSOFPRO    NPSOF2
     C                     ADD  89280000  NPSOF2
F3  C                     END
F2  C                     END
F1  C                     END
    C* 2° PAPIER
    C*-------------------------
D1  C           PAPI3     IFNE *BLANKS
     C                     MOVE ADPAP3    CXH     3
D2  C           CXH       IFEQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVELPAPI3     SPAPI
     C                     Z-ADDGRAM3     SGRAMM
     C                     MOVELADPAP3    SREFOU
     C                     Z-ADDADGRA3    SGRARE
D3  C           FORL3     IFNE *ZEROS
     C                     MOVE 'F'       SFOUB
X3  C                     ELSE
     C                     MOVE 'B'       SFOUB
F3  C                     END
     C           CLESOF    CHAINPRODUL28             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDSOFPRO    NPSOF3
     C                     ADD  89280000  NPSOF3
F3  C                     END
F2  C                     END
F1  C                     END
    C* 3° PAPIER
    C*-------------------------
D1  C           PAPI4     IFNE *BLANKS
     C                     MOVE ADPAP4    CXH     3
D2  C           CXH       IFEQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVELPAPI4     SPAPI
     C                     Z-ADDGRAM4     SGRAMM
     C                     MOVELADPAP4    SREFOU
     C                     Z-ADDADGRA4    SGRARE
D3  C           FORL4     IFNE *ZEROS
     C                     MOVE 'F'       SFOUB
X3  C                     ELSE
     C                     MOVE 'B'       SFOUB
F3  C                     END
     C           CLESOF    CHAINPRODUL28             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDSOFPRO    NPSOF4
     C                     ADD  89280000  NPSOF4
F3  C                     END
F2  C                     END
F1  C                     END
    C* 4° PAPIER
    C*-------------------------
D1  C           PAPI5     IFNE *BLANKS
     C                     MOVE ADPAP5    CXH     3
D2  C           CXH       IFEQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVELPAPI5     SPAPI
     C                     Z-ADDGRAM5     SGRAMM
     C                     MOVELADPAP5    SREFOU
     C                     Z-ADDADGRA5    SGRARE
D3  C           FORL5     IFNE *ZEROS
     C                     MOVE 'F'       SFOUB
X3  C                     ELSE
     C                     MOVE 'B'       SFOUB
F3  C                     END
     C           CLESOF    CHAINPRODUL28             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDSOFPRO    NPSOF5
     C                     ADD  89280000  NPSOF5
F3  C                     END
F2  C                     END
F1  C                     END
    C* 5° PAPIER
    C*-------------------------
D1  C           PAPI6     IFNE *BLANKS
     C                     MOVE ADPAP6    CXH     3
D2  C           CXH       IFEQ 'SOF'
    C           CXH       OREQ 'PEL'
     C                     MOVELPAPI6     SPAPI
     C                     Z-ADDGRAM6     SGRAMM
     C                     MOVELADPAP6    SREFOU
     C                     Z-ADDADGRA6    SGRARE
D3  C           FORL6     IFNE *ZEROS
     C                     MOVE 'F'       SFOUB
X3  C                     ELSE
     C                     MOVE 'B'       SFOUB
F3  C                     END
     C           CLESOF    CHAINPRODUL28             99
D3  C           *IN99     IFEQ '0'
     C                     Z-ADDSOFPRO    NPSOF6
     C                     ADD  89280000  NPSOF6
F3  C                     END
F2  C                     END
F1  C                     END
    C                     ENDSR
      /EJECT
     *--------------------------------------------------------*
     * S/PROGRAMME : TOUCHE CDE 4                             *
     *--------------------------------------------------------*
    C           TRTAID    BEGSR
     *          ---------------
     C           £CURSO    DIV  256       HLIG
     C                     MVR            HCOL
     *
    C           ZONZON    CASEQ'TS1   '  AID1
    C           ZONZON    CASEQ'ZB3   '  AID2
    C           ZONZON    CASEQ'GRAP1 '  AID3
    C           ZONZON    CASEQ'COUP1 '  AID4
    C           ZONZON    CASEQ'NATE1 '  AID5
    C           ZONZON    CASEQ'MAGAU1'  AID6
    C           ZONZON    CASEQ'MAGAU2'  AID6
    C           ZONZON    CASEQ'DECA1 '  AID6
    C           ZONZON    CASEQ'DECA2 '  AID6
    C           ZONZON    CASEQ'RMIME1'  AID6
    C           ZONZON    CASEQ'RMIME2'  AID6
    C           ZONZON    CASEQ'RMIME3'  AID6
    C           ZONZON    CASEQ'RMIME4'  AID6
    C           ZONZON    CASEQ'RMIME5'  AID6
    C           ZONZON    CASEQ'RMIMI1'  AID6
    C           ZONZON    CASEQ'RMIMI2'  AID6
    C           ZONZON    CASEQ'RMIMI3'  AID6
    C           ZONZON    CASEQ'RMIMI4'  AID6
    C           ZONZON    CASEQ'RMIMI5'  AID6
    C           ZONZON    CASEQ'MIMRE1'  AID6
    C           ZONZON    CASEQ'MIMRE2'  AID6
    C           ZONZON    CASEQ'MIMRE3'  AID6
    C           ZONZON    CASEQ'MIMRE4'  AID6
    C           ZONZON    CASEQ'MIMRE5'  AID6
    C           ZONZON    CASEQ'MIMRI1'  AID6
    C           ZONZON    CASEQ'MIMRI2'  AID6
    C           ZONZON    CASEQ'MIMRI3'  AID6
    C           ZONZON    CASEQ'MIMRI4'  AID6
    C           ZONZON    CASEQ'MIMRI5'  AID6
    C           ZONZON    CASEQ'RMIRE1'  AID6
    C           ZONZON    CASEQ'RMIRE2'  AID6
    C           ZONZON    CASEQ'RMIRE3'  AID6
    C           ZONZON    CASEQ'RMIRE4'  AID6
    C           ZONZON    CASEQ'RMIRE5'  AID6
    C           ZONZON    CASEQ'RMIRI1'  AID6
    C           ZONZON    CASEQ'RMIRI2'  AID6
    C           ZONZON    CASEQ'RMIRI3'  AID6
    C           ZONZON    CASEQ'RMIRI4'  AID6
    C           ZONZON    CASEQ'RMIRI5'  AID6
    C           ZONZON    CASEQ'MAIME1'  AID6
    C           ZONZON    CASEQ'MAIME2'  AID6
    C           ZONZON    CASEQ'MAIME3'  AID6
    C           ZONZON    CASEQ'MAIME4'  AID6
    C           ZONZON    CASEQ'MAIME5'  AID6
    C           ZONZON    CASEQ'MAIMI1'  AID6
    C           ZONZON    CASEQ'MAIMI2'  AID6
    C           ZONZON    CASEQ'MAIMI3'  AID6
    C           ZONZON    CASEQ'MAIMI4'  AID6
    C           ZONZON    CASEQ'MAIMI5'  AID6
    C           ZONZON    CASEQ'MATYE1'  AID6
    C           ZONZON    CASEQ'MATYE2'  AID6
    C           ZONZON    CASEQ'MATYE3'  AID6
    C           ZONZON    CASEQ'MATYI1'  AID6
    C           ZONZON    CASEQ'MATYI2'  AID6
    C           ZONZON    CASEQ'MATYI3'  AID6
    C           ZONZON    CASEQ'MAOND1'  AID6
    C           ZONZON    CASEQ'MAOND2'  AID6
    C           ZONZON    CASEQ'MAOND3'  AID6
    C           ZONZON    CASEQ'MACOL1'  AID6
    C           ZONZON    CASEQ'MACOL2'  AID6
    C           ZONZON    CASEQ'MACOL3'  AID6
    C           ZONZON    CASEQ'MADEC1'  AID6
    C           ZONZON    CASEQ'MADEC2'  AID6
    C           ZONZON    CASEQ'MADEC3'  AID6
    C           ZONZON    CASEQ'MAAUT1'  AID6
    C           ZONZON    CASEQ'MAAUT2'  AID6
    C           ZONZON    CASEQ'MAAUT3'  AID6
    C           ZONZON    CASEQ'MAFEN1'  AID6
    C           ZONZON    CASEQ'MAFEN2'  AID6
    C           ZONZON    CASEQ'MAFEN3'  AID6
    C           ZONZON    CASEQ'MAAS11'  AID6
    C           ZONZON    CASEQ'MAAS12'  AID6
    C           ZONZON    CASEQ'MAAS13'  AID6
    C           ZONZON    CASEQ'MAAS21'  AID6
    C           ZONZON    CASEQ'MAAS22'  AID6
    C           ZONZON    CASEQ'MAAS23'  AID6
    C           ZONZON    CASEQ'CONDI '  AID7
    C           ZONZON    CASEQ'ADGRA1'  AID8
    C           ZONZON    CASEQ'NATMAD'  AID50
    C           ZONZON    CASEQ'DNATP1'  AID51
    C           ZONZON    CASEQ'DNATP2'  AID51
    C           ZONZON    CASEQ'DNATP3'  AID51
    C           ZONZON    CASEQ'DNATP4'  AID51
    C           ZONZON    CASEQ'DFPXF1'  AID52
    C           ZONZON    CASEQ'DFPXF2'  AID52
    C           ZONZON    CASEQ'DFPXF3'  AID52
    C           ZONZON    CASEQ'DFPXF4'  AID52
    C           ZONZON    CASEQ'DFPXF5'  AID52
    C           ZONZON    CASEQ'DFPXF6'  AID52
    C           ZONZON    CASEQ'DFPXF7'  AID52
    C           ZONZON    CASEQ'DFPXF8'  AID52
    C           ZONZON    CASEQ'DFPXF9'  AID52
    C           ZONZON    CASEQ'DFPXFA'  AID52
    C           ZONZON    CASEQ'DFPXFB'  AID52
    C           ZONZON    CASEQ'DFPXFC'  AID52
    C           ZONZON    CASEQ'DTYPF1'  AID53
    C           ZONZON    CASEQ'DTYPF2'  AID53
    C           ZONZON    CASEQ'DTYPF3'  AID53
    C           ZONZON    CASEQ'DTYPF4'  AID53
    C           ZONZON    CASEQ'DTYPF5'  AID53
    C           ZONZON    CASEQ'DTYPF6'  AID53
    C           ZONZON    CASEQ'DTYPF7'  AID53
    C           ZONZON    CASEQ'DTYPF8'  AID53
    C           ZONZON    CASEQ'DTYPF9'  AID53
    C           ZONZON    CASEQ'DTYPFA'  AID53
    C           ZONZON    CASEQ'DTYPFB'  AID53
    C           ZONZON    CASEQ'DTYPFC'  AID53
    C           ZONZON    CASEQ'ZTCO35'  AID54
    C                     CAS            AID0
    C                     END
    C                     ENDSR
      /SPACE 2
    C           AID0      BEGSR
     *          ---------------
     C                     WRITEWMINI
     C                     EXFMTWERR
    C                     ENDSR
      /SPACE 2
    C           AID1      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
D1  C           NOCLI     IFEQ 8928
     C                     MOVEL'TYPN'    TBLNOM    P
X1  C                     ELSE
     C                     MOVEL'TYPC'    TBLNOM    P
F1  C                     END
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      TS1
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID2      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'GTYP'    TBLNOM
     C                     Z-ADD5         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      ZB3
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID3      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'TUTC'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      GRAP1
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID4      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'TCON'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      COUP1
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID5      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'TQUA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      NATE1
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID6      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'XPOOLMAC'TBLNOM
     C                     Z-ADD3         LG
     C                     MOVE 'X'       FICH
D1  C           ZONZON    IFEQ 'MAGAU1'
    C           ZONZON    OREQ 'MAGAU2'
    C           ZONZON    OREQ 'DECA1 '
    C           ZONZON    OREQ 'DECA2 '
     C                     MOVELRCOU1     FADEC
     C                     MOVELFADEC     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'RMIME1'
    C           ZONZON    OREQ 'RMIME2'
    C           ZONZON    OREQ 'RMIME3'
    C           ZONZON    OREQ 'RMIME4'
    C           ZONZON    OREQ 'RMIME5'
     C                     MOVELUSEXT     FAIME
     C                     MOVELFAIME     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'RMIMI1'
    C           ZONZON    OREQ 'RMIMI2'
    C           ZONZON    OREQ 'RMIMI3'
    C           ZONZON    OREQ 'RMIMI4'
    C           ZONZON    OREQ 'RMIMI5'
     C                     MOVELUSINT     FAIMI
     C                     MOVELFAIMI     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MIMRE1'
    C           ZONZON    OREQ 'MIMRE2'
    C           ZONZON    OREQ 'MIMRE3'
    C           ZONZON    OREQ 'MIMRE4'
    C           ZONZON    OREQ 'MIMRE5'
     C                     MOVELFAIMES    TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MIMRI1'
    C           ZONZON    OREQ 'MIMRI2'
    C           ZONZON    OREQ 'MIMRI3'
    C           ZONZON    OREQ 'MIMRI4'
    C           ZONZON    OREQ 'MIMRI5'
     C                     MOVELFAIMIS    TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'RMIRE1'
    C           ZONZON    OREQ 'RMIRE2'
    C           ZONZON    OREQ 'RMIRE3'
    C           ZONZON    OREQ 'RMIRE4'
    C           ZONZON    OREQ 'RMIRE5'
     C                     MOVELFAIMES    TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'RMIRI1'
    C           ZONZON    OREQ 'RMIRI2'
    C           ZONZON    OREQ 'RMIRI3'
    C           ZONZON    OREQ 'RMIRI4'
    C           ZONZON    OREQ 'RMIRI5'
     C                     MOVELFAIMIS    TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAIME1'
    C           ZONZON    OREQ 'MAIME2'
    C           ZONZON    OREQ 'MAIME3'
    C           ZONZON    OREQ 'MAIME4'
    C           ZONZON    OREQ 'MAIME5'
     C                     MOVELUSEXT     FAIME
     C                     MOVELFAIME     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAIMI1'
    C           ZONZON    OREQ 'MAIMI2'
    C           ZONZON    OREQ 'MAIMI3'
    C           ZONZON    OREQ 'MAIMI4'
    C           ZONZON    OREQ 'MAIMI5'
     C                     MOVELUSINT     FAIMI
     C                     MOVELFAIMI     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MATYE1'
    C           ZONZON    OREQ 'MATYE2'
    C           ZONZON    OREQ 'MATYE3'
     C                     MOVELFATYE     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MATYI1'
    C           ZONZON    OREQ 'MATYI2'
    C           ZONZON    OREQ 'MATYI3'
     C                     MOVELFATYI     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAOND1'
    C           ZONZON    OREQ 'MAOND2'
    C           ZONZON    OREQ 'MAOND3'
     C                     MOVELFAOND     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MACOL1'
    C           ZONZON    OREQ 'MACOL2'
    C           ZONZON    OREQ 'MACOL3'
     C                     MOVELFACOL     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MADEC1'
    C           ZONZON    OREQ 'MADEC2'
    C           ZONZON    OREQ 'MADEC3'
     C                     MOVELFADEC     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAAUT1'
    C           ZONZON    OREQ 'MAAUT2'
    C           ZONZON    OREQ 'MAAUT3'
     C                     MOVELFAAUT     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAFEN1'
    C           ZONZON    OREQ 'MAFEN2'
    C           ZONZON    OREQ 'MAFEN3'
     C                     MOVELFAFEN     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAAS11'
    C           ZONZON    OREQ 'MAAS12'
    C           ZONZON    OREQ 'MAAS13'
     C                     MOVELFAAS1     TBVVR     P
F1  C                     END
D1  C           ZONZON    IFEQ 'MAAS21'
    C           ZONZON    OREQ 'MAAS22'
    C           ZONZON    OREQ 'MAAS23'
     C                     MOVELFAAS2     TBVVR     P
F1  C                     END
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
     C                     MOVEL' '       FAIME
     C                     MOVEL' '       FAIMI
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'MAGAU1'
     C                     MOVELCODE      MAGAU1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAGAU2'
     C                     MOVELCODE      MAGAU2
F2  C                     END
D2  C           ZONZON    IFEQ 'DECA1 '
     C                     MOVELCODE      DECA1
F2  C                     END
D2  C           ZONZON    IFEQ 'DECA2 '
     C                     MOVELCODE      DECA2
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIME1'
     C                     MOVELCODE      RMIME1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIME2'
     C                     MOVELCODE      RMIME2
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIME3'
     C                     MOVELCODE      RMIME3
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIME4'
     C                     MOVELCODE      RMIME4
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIME5'
     C                     MOVELCODE      RMIME5
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIMI1'
     C                     MOVELCODE      RMIMI1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIMI2'
     C                     MOVELCODE      RMIMI2
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIMI3'
     C                     MOVELCODE      RMIMI3
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIMI4'
     C                     MOVELCODE      RMIMI4
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIMI5'
     C                     MOVELCODE      RMIMI5
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRE1'
     C                     MOVELCODE      MIMRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRE2'
     C                     MOVELCODE      MIMRE2
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRE3'
     C                     MOVELCODE      MIMRE3
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRE4'
     C                     MOVELCODE      MIMRE4
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRE5'
     C                     MOVELCODE      MIMRE5
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRI1'
     C                     MOVELCODE      MIMRI1
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRI2'
     C                     MOVELCODE      MIMRI2
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRI3'
     C                     MOVELCODE      MIMRI3
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRI4'
     C                     MOVELCODE      MIMRI4
F2  C                     END
D2  C           ZONZON    IFEQ 'MIMRI5'
     C                     MOVELCODE      MIMRI5
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRE1'
     C                     MOVELCODE      RMIRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRE2'
     C                     MOVELCODE      RMIRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRE3'
     C                     MOVELCODE      RMIRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRE4'
     C                     MOVELCODE      RMIRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRE5'
     C                     MOVELCODE      RMIRE1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRI1'
     C                     MOVELCODE      RMIRI1
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRI2'
     C                     MOVELCODE      RMIRI2
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRI3'
     C                     MOVELCODE      RMIRI3
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRI4'
     C                     MOVELCODE      RMIRI4
F2  C                     END
D2  C           ZONZON    IFEQ 'RMIRI5'
     C                     MOVELCODE      RMIRI5
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIME1'
     C                     MOVELCODE      MAIME1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIME2'
     C                     MOVELCODE      MAIME2
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIME3'
     C                     MOVELCODE      MAIME3
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIME4'
     C                     MOVELCODE      MAIME4
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIME5'
     C                     MOVELCODE      MAIME5
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIMI1'
     C                     MOVELCODE      MAIMI1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIMI2'
     C                     MOVELCODE      MAIMI2
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIMI3'
     C                     MOVELCODE      MAIMI3
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIMI4'
     C                     MOVELCODE      MAIMI4
F2  C                     END
D2  C           ZONZON    IFEQ 'MAIMI5'
     C                     MOVELCODE      MAIMI5
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYE1'
     C                     MOVELCODE      MATYE1
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYE2'
     C                     MOVELCODE      MATYE2
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYE3'
     C                     MOVELCODE      MATYE3
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYI1'
     C                     MOVELCODE      MATYE1
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYI2'
     C                     MOVELCODE      MATYI2
F2  C                     END
D2  C           ZONZON    IFEQ 'MATYI3'
     C                     MOVELCODE      MATYI3
F2  C                     END
D2  C           ZONZON    IFEQ 'MAOND1'
     C                     MOVELCODE      MAOND1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAOND2'
     C                     MOVELCODE      MAOND2
F2  C                     END
D2  C           ZONZON    IFEQ 'MAOND3'
     C                     MOVELCODE      MAOND3
F2  C                     END
D2  C           ZONZON    IFEQ 'MACOL1'
     C                     MOVELCODE      MACOL1
F2  C                     END
D2  C           ZONZON    IFEQ 'MACOL2'
     C                     MOVELCODE      MACOL2
F2  C                     END
D2  C           ZONZON    IFEQ 'MACOL3'
     C                     MOVELCODE      MACOL3
F2  C                     END
    C*          ZONZON    IFEQ 'MADEC1'
    C*                    MOVELCODE      MADEC1
    C*                    END
    C*          ZONZON    IFEQ 'MADEC2'
    C*                    MOVELCODE      MADEC2
    C*                    END
    C*          ZONZON    IFEQ 'MADEC3'
    C*                    MOVELCODE      MADEC3
    C*                    END
D2  C           ZONZON    IFEQ 'MAAUT1'
     C                     MOVELCODE      MAAUT1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAUT2'
     C                     MOVELCODE      MAAUT2
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAUT3'
     C                     MOVELCODE      MAAUT3
F2  C                     END
D2  C           ZONZON    IFEQ 'MAFEN1'
     C                     MOVELCODE      MAFEN1
F2  C                     END
D2  C           ZONZON    IFEQ 'MAFEN2'
     C                     MOVELCODE      MAFEN2
F2  C                     END
D2  C           ZONZON    IFEQ 'MAFEN3'
     C                     MOVELCODE      MAFEN3
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS11'
     C                     MOVELCODE      MAAS11
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS12'
     C                     MOVELCODE      MAAS12
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS13'
     C                     MOVELCODE      MAAS13
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS21'
     C                     MOVELCODE      MAAS21
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS22'
     C                     MOVELCODE      MAAS22
F2  C                     END
D2  C           ZONZON    IFEQ 'MAAS23'
     C                     MOVELCODE      MAAS23
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID7      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'RAMA'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      CONDI
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID8      BEGSR
     *          ---------------
     C                     CLEARDSPMMM
     C                     MOVEL'TGPC'    TBLNOM
     C                     Z-ADD5         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
     C                     MOVELCODE      ADGRA1
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID50     BEGSR
     *          ---------------
     C                     MOVE 'I'       PIP
     C                     CALL 'TYPO01£'
     C                     PARM           ATYPP
D1  C           TYPPR     IFNE *BLANKS
     C                     MOVELTYPPR     NATMAD
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID51     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DONA'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DNATP1'
     C                     MOVELCODE      DNATP1
     C                     MOVELLIBELM    DLIBP1
F2  C                     END
D2  C           ZONZON    IFEQ 'DNATP2'
     C                     MOVELCODE      DNATP2
     C                     MOVELLIBELM    DLIBP2
F2  C                     END
D2  C           ZONZON    IFEQ 'DNATP3'
     C                     MOVELCODE      DNATP3
     C                     MOVELLIBELM    DLIBP3
F2  C                     END
D2  C           ZONZON    IFEQ 'DNATP4'
     C                     MOVELCODE      DNATP4
     C                     MOVELLIBELM    DLIBP4
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID52     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DOFF'    TBLNOM
     C                     Z-ADD6         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DFPXF1'
     C                     MOVELCODE      DFPXF1
     C                     MOVELLIBELM    LTFF1
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF2'
     C                     MOVELCODE      DFPXF2
     C                     MOVELLIBELM    LTFF2
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF3'
     C                     MOVELCODE      DFPXF3
     C                     MOVELLIBELM    LTFF3
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF4'
     C                     MOVELCODE      DFPXF4
     C                     MOVELLIBELM    LTFF4
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF5'
     C                     MOVELCODE      DFPXF5
     C                     MOVELLIBELM    LTFF5
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF6'
     C                     MOVELCODE      DFPXF6
     C                     MOVELLIBELM    LTFF6
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF7'
     C                     MOVELCODE      DFPXF7
     C                     MOVELLIBELM    LTFF7
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF8'
     C                     MOVELCODE      DFPXF8
     C                     MOVELLIBELM    LTFF8
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXF9'
     C                     MOVELCODE      DFPXF9
     C                     MOVELLIBELM    LTFF9
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXFA'
     C                     MOVELCODE      DFPXFA
     C                     MOVELLIBELM    LTFFA
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXFB'
     C                     MOVELCODE      DFPXFB
     C                     MOVELLIBELM    LTFFB
F2  C                     END
D2  C           ZONZON    IFEQ 'DFPXFC'
     C                     MOVELCODE      DFPXFC
     C                     MOVELLIBELM    LTFFC
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID53     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'DOTF'    TBLNOM
     C                     Z-ADD4         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           CODE      IFNE *BLANKS
D2  C           ZONZON    IFEQ 'DTYPF1'
     C                     MOVELCODE      DTYPF1
     C                     MOVELLIBELM    LTYF1
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF2'
     C                     MOVELCODE      DTYPF2
     C                     MOVELLIBELM    LTYF2
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF3'
     C                     MOVELCODE      DTYPF3
     C                     MOVELLIBELM    LTYF3
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF4'
     C                     MOVELCODE      DTYPF4
     C                     MOVELLIBELM    LTYF4
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF5'
     C                     MOVELCODE      DTYPF5
     C                     MOVELLIBELM    LTYF5
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF6'
     C                     MOVELCODE      DTYPF6
     C                     MOVELLIBELM    LTYF6
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF7'
     C                     MOVELCODE      DTYPF7
     C                     MOVELLIBELM    LTYF7
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF8'
     C                     MOVELCODE      DTYPF8
     C                     MOVELLIBELM    LTYF8
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPF9'
     C                     MOVELCODE      DTYPF9
     C                     MOVELLIBELM    LTYF9
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPFA'
     C                     MOVELCODE      DTYPFA
     C                     MOVELLIBELM    LTYFA
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPFB'
     C                     MOVELCODE      DTYPFB
     C                     MOVELLIBELM    LTYFB
F2  C                     END
D2  C           ZONZON    IFEQ 'DTYPFC'
     C                     MOVELCODE      DTYPFC
     C                     MOVELLIBELM    LTYFC
F2  C                     END
F1  C                     END
    C                     ENDSR
      /SPACE 2
    C           AID54     BEGSR
     *          ---------------
     C                     CLEARDSPARM
     C                     MOVEL'OFCO'    TBLNOM
     C                     Z-ADD7         LG
     C                     CALL 'DEV002£'
     C                     PARM           DSPMMM
D1  C           LIBELM    IFNE *BLANKS
     C                     MOVELCODE      ZTCO35
     C                     MOVELLIBELM    OLCO35
F1  C                     END
    C                     ENDSR
     *--- DÉBUT --- PHILIPPE 13/01/2015-- INC0222477 ---*
     * MIS EN COMMENTAIRE À LA DEMANDE DU DESTINATAIRE
     ** SB5
     * SNDNETMSG MSG(' ATTENTION: dossier matériel et annulation produit: XXX
     * X/XXXX') TOUSRID(('BALLIN.L' 'NEUILLY'))
     *--- FIN   --- PHILIPPE 13/01/2015-- INC0222477 ---*
** TABLE DES MESSAGES INTERNE ** MESS **  SAISIE DEVIS
TEINTE VALIDE                                                                  1
ATTENTE ACCORD TEINTE - PREVUE LE                                              2
Type de produit = M et pas décomposition amalgame. Faire décomposition         3
Erreur de frappe sur usine.  Corrigez SVP.                                     4
Produit avec décomposition amalgame et Type de produit différent de M          5
Type de produit / client égal à S et stock sécurité non renseigné              6
Type de produit / client différent de S et stock sécurité renseigné            7
Incompatibilite Faconnage/Ondulation/Contrecollage .                           8
Incompatibilite promo/tolerance . Corrigez SVP.                                9
ANOMALIE AU FORMATAGE DU FORMAT 3 REPRENDRE LA SAISIE AU DEBUT   (PREIMP)     10
ANOMALIE AU FORMATAGE DU FORMAT 4 REPRENDRE LA SAISIE AU DEBUT   (ASSEMB)     11
Code ondule et colle RH incompatible .    Corrigez SVP.                       12
                                                                              13
Nature du materiel de decoupage (valeur:1,2,3)  Corrigez SVP .                14
Impression sans couleur est-ce normal?   CDE et 22 pour accord .              15
Incompatibilite sesame/nombre ou tear-tape/nombre .  Modifiez SVP.            16
Client/Produits  inconnu      Corrigez SVP.                                   17
Incompatibilite faconnage/Ondulation/Contrecollage .   Rectifiez SVP.         18
Simulation   offres                                                           19
Simulation produits                                                           20
Erreur de touche de fonction .                                                21
Desirez vous le stockage ? reponse obligatoire .                              22
Erreur de frappe sur lettre de garniture .     Corrigez SVP.                  23
Incompatibilite colle RH et ondulation .   Corrigez SVP.                      24
Enregistrement non trouve sur le disque pour M.a J.; Annuler la M.a J.        25
Variante      devis                                                           26
Correction    devis                                                           27
Fichier mot de passe non disponible reprendre la M.a J. au debut .            28
Mot de passe inconnu .      Modifiez SVP.                                     29
Selection du premier format obligatoire .         Rectifiez SVP.              30
Erreur de selection .                                                         31
Rubrique erronee : Annee/Etude/Sequence .                                     32
Rubrique erronee : Numero du client/Numero du produit .                       33
Touche de fonction erronee .                                                  34
Suppression du devis non aboutie .                                            35
(  ) Enregistrement non disponible; Reprendre le travail au debut .           36
(  ) Code faconnage errone;(6a7,6a8,7a8,7a6,8a7,8a6). Rectifiez SVP.          37
Variante  sim.tarif                                                           38
Simul.tarif  M.a J.                                                           39
Variante  informat.                                                           40
Variante  simul.                                                              41
Appellation client obligatoire.                                               42
Annulation impossible en simulation de panel société                          43
Les zones tolérances mini et maxi ne peuvent être inférieures à 1,00          44
Annulation et suppression annulation renseignées ?                            45
PAPIER HORS STANDARD ------> VOIR SERVICE STATISTIQUE                         46
Spécification invalide (F5 pour Liste)                                        47
Spécification ligne 2 interdite                                               48
Vous devez valider la modification du cliché                                  49
 FORME EN SUSPENS                                                             50
ACCORD DESTRUCTION DE LA FORME                                                51
 FORME DETRUITE LE:                                                           52
Usine transférable invalide                                                   53
N° de type de gamme invalide                                                  54
Type de produit chez le client invalide                                       55
Utilisation client invalide                                                   56
Conception invalide                                                           57
Qualité invalide                                                              58
Gamme Produit Client invalide                                                 59
Ondulation
C/collage
Peinture sur tranche uniquement si découpes
Type d'encre pour Peinture sur Tranche invalide
Dorure uniquement si format
Pelliculage uniquement si format
Typologie produit invalide                                                    66
Gamme Produit Client invalide avec le type de produit/client                  67
** TAB8/TAB88 ** CONTROLE DU CODE FACONNAGE EN VARIANTE/SIMUL.OUVERTE.
67A
68A
78A
76B         RAZ DES BLOCS 1ER./2EME. ASSEMBLAGE .
87A
86B         RAZ DES BLOCS 1ER./2EME. ASSEMBLAGE .
** OVR **
OVRDBF FILE(LIEUST03) MBR(LESDEUX)
**
M1M2M3M4M5M6M7M8M9MDMHABACADAEAFAGAHAIAJAKALAMANAO
BBBCBDBEBFBGBHBIBJBKBLBMBNBOCCCDCECFCGCHCICJCKCLCM
CNCODDDEDFDGDHDIDJDKDLDMDNDOEEEFEGEHEIEJEKELEMENEO
FFFGFHFIFJFKFLFMFNFOGGGHGIGJGKGLGMGNGOHHHIHJHKHLHM
HNHOIIIJIKILIMINIOJJJKJLJMJNJOKKKLKMKNKOLLLMLNLOMM
MNMONNNOOO
** SB1
SBMJOB JOB(MAJINDPCL ) JOBD(QBATCH) OUTQ(QPRINT) MSGQ(*NONE)
RQSDTA('CALL PROD70L PARM(''                              '')')
** SB2
SBMJOB JOB(MAJNOFOR  ) JOBD(QBATCH) OUTQ(QPRINT) MSGQ(*NONE)
RQSDTA('CALL PROD71L PARM(''                              '')')
** SB3
SBMJOB JOB(MAJFORSOF ) JOBD(QBATCH) OUTQ(QPRINT) MSGQ(*NONE)
RQSDTA('CALL PROD77£ PARM(''                              '')')
** SB4
SNDNETMSG MSG(' ATTENTION: modification laize utilisée sur produit XXX
X/XXXX') TOUSRID(('JAVELA.G' 'NEUILLY'))
** SB6
SNDNETMSG MSG(' ATTENTION: typologie du produit XXXX pour le client X/
XXXX modifiée') TOUSRID((MESSAGE RESPBE))
**
01IMP. EXT. PRINC
02IMP. EXT. REP.
03IMP. INT. PRINC
04IMP. INT. REP.
05COMPLEXAGE
06GAUFRAGE
07ONDULATION
08CONTRE COLLAGE
09POST P. / GENCO
10DECOUPAGE
11DECORTICAGE
12POSE FENETRE
131° ASSEMBLAGE
142° ASSEMBLAGE
15COMPLEXAGE EXT.
16COMPLEXAGE INT.
17BOBST FLEXO EXT.
18BOBST FLEXO INT.
19GENCO 2° AFFICHE
20CONTRE COLLAGE
21AFFICHAGE EXT.
22AFFICHAGE INT.
23BANDE ADHESIVE
241° PELLICULAGE
252° PELLICULAGE
26DORURE 1° PASSAGE
27DORURE 2° PASSAGE
28OEILLETS
29BOUTONS PRESSIONS
30DORURE 3° PASSAGE
31DORURE 4° PASSAGE
662° GAUFRAGE
** TABLE VALIDATION FACON/CCOL **                                       **
00A
10A
12C
14A
17C
22C
40A
41D
42C
43D
44A
45C
47C
48A
49F
46F
50A
51D
52C
53D
60A
61D
62C
63D
64A
65C
67B
68A
69F
66C
70A
71D
72C
73D
74A
75C
77C
78A
79F
76F
80A
81D
82C
83D
84A
85C
87C
88A
89F
86C
92C
**  TNOM
NAVAUD_A
LASVERG_JL
**  DERR
1° PASSAGE DORURE OBLIGATOIRE
NATURE ET DIFFICULTE OBLIGATOIRE
NATURE DORURE INVALIDE
FAMILLE FILM, SURFACE ET LAIZE OBLIGATOIRE
FAMILLE FILM INVALIDE
1° FILM OBLIGATOIRE
N° PASSAGE INVALIDE
TYPE FILM INVALIDE
FILM 1° PELLICULAGE ERRONÉ
FILM 2° PELLICULAGE ERRONÉ
ERREURS SUR 2° PELLICULAGE
MACHINE INVALIDE
** LIBMSG
OFFSET MAX
OFFSET MIN
COMPLEXEUSE
C.COLLAGE MAX
C.COLLAGE MIN
